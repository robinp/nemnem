<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module         : Data.ByteString.Lazy.Search.KarpRabin</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright      : (c) 2010 Daniel Fischer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence        : BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer     : Daniel Fischer &lt;daniel.is.fischer@googlemail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability      : Provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability    : non-portable (BangPatterns)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Simultaneous search for multiple patterns in a lazy &#39;L.ByteString&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using the Karp-Rabin algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A description of the algorithm for a single pattern can be found at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www-igm.univ-mlv.fr/~lecroq/string/node5.html#SECTION0050&gt;.</span></span><span class="mpre">
module Data.ByteString.Lazy.Search.KarpRabin ( </span><span class="hl_comment"><span class="mpre">-- * Overview</span></span><span class="mpre">
                                               </span><span class="hl_comment"><span class="mpre">-- $overview</span></span><span class="mpre">

                                               </span><span class="hl_comment"><span class="mpre">-- ** Caution</span></span><span class="mpre">
                                               </span><span class="hl_comment"><span class="mpre">-- $caution</span></span><span class="mpre">

                                               </span><span class="hl_comment"><span class="mpre">-- * Function</span></span><span class="mpre">
                                               indicesOfAny
                                             ) where

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/KarpRabin.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/KarpRabin.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import Data.ByteString.Unsafe (</span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="mpre">unsafeIndex</span></a><span class="mpre">)

import qualified Data.IntMap as IM

import Data.Array
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/KarpRabin.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 8, srcSpanEndLine = 32, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.Array.Base&quot;"><span class="mpre">Data.Array.Base</span></span><span class="mpre"> (unsafeAt)

import Data.Word (Word8)
import Data.Int (</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="mpre">Int64</span></a><span class="mpre">)
import Data.Bits
import Data.List (</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- $overview</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The Karp-Rabin algorithm works by calculating a hash of the pattern and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- comparing that hash with the hash of a slice of the target string with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the same length as the pattern. If the hashes are equal, the slice of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- target is compared to the pattern character by character (since the hash</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function generally isn&#39;t injective).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For a single pattern, this tends to be more efficient than the na&amp;#239;ve</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- algorithm, but it cannot compete with algorithms like</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Knuth-Morris-Pratt or Boyer-Moore.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- However, the algorithm can be generalised to search for multiple patterns</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- simultaneously. If the shortest pattern has length @k@, hash the prefix of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- length @k@ of all patterns and compare the hash of the target&#39;s slices of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- length @k@ to them. If there&#39;s a match, check whether the slice is part</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of an occurrence of the corresponding pattern.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- With a hash-function that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * allows to compute the hash of one slice in constant time from the hash</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     of the previous slice, the new and the dropped character, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * produces few spurious matches,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- searching for occurrences of any of @n@ patterns has a best-case complexity</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of /O/(@targetLength@ * @lookup n@). The worst-case complexity is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /O/(@targetLength@ * @lookup n@ * @sum patternLengths@), the average is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- not much worse than the best case.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The functions in this module store the hashes of the patterns in an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;IM.IntMap&#39;, so the lookup is /O/(@log n@). Re-hashing is done in constant</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- time and spurious matches of the hashes /should be/ sufficiently rare.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The maximal length of the prefixes to be hashed is 32.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $caution</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unfortunately, the constant factors are high, so these functions are slow.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unless the number of patterns to search for is high (larger than 50 at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- least), repeated search for single patterns using Boyer-Moore or DFA and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- manual merging of the indices is faster. /Much/ faster for less than 40</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or so patterns.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;indicesOfAny&#39; has the advantage over multiple single-pattern searches that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it doesn&#39;t hold on to large parts of the string (which is likely to happen</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for multiple searches), however, so in contrast to the strict version, it</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- may be useful for relatively few patterns already.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Nevertheless, this module seems more of an interesting curiosity than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- anything else.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;indicesOfAny&#39;@ finds all occurrences of any of several non-empty strict</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   patterns in a lazy target string. If no non-empty patterns are given,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the result is an empty list. Otherwise the result list contains</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the pairs of all indices where any of the (non-empty) patterns start</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   and the list of all patterns starting at that index, the patterns being</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   represented by their (zero-based) position in the pattern list.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Empty patterns are filtered out before processing begins.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_101_1_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_13&#39;)"><span class="mpre">indicesOfAny</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_101_1_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_13&#39;)"><span class="mpre">indicesOfAny</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ List of non-empty patterns</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ String to search</span></span><span class="mpre">
             -&gt; [(</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">])]   </span><span class="hl_comment"><span class="mpre">-- ^ List of matches</span></span><span class="mpre">
</span><a name="loc_101_1_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_13&#39;)"><span class="hl_fundecl"><span class="mpre">indicesOfAny</span></span></a><span class="mpre"> </span><a name="loc_101_14_101_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_18&#39;)"><span class="hl_vardecl"><span class="mpre">pats</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_105_9_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_15&#39;)"><span class="hl_varref"><span class="mpre">nepats</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> []
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_132_1_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_12&#39;)"><span class="hl_varref"><span class="mpre">lazyMatcher</span></span></a><span class="mpre"> </span><a href="#loc_105_9_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_15&#39;)"><span class="hl_varref"><span class="mpre">nepats</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
      where
        </span><a name="loc_105_9_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_15&#39;)"><span class="hl_vardecl"><span class="mpre">nepats</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre">) </span><a href="#loc_101_14_101_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_18&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                 Workers                                 --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_113_1_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_8&#39;)"><span class="mpre">rehash1</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_113_1_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_8&#39;)"><span class="mpre">rehash1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_113_1_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_8&#39;)"><span class="hl_fundecl"><span class="mpre">rehash1</span></span></a><span class="mpre"> </span><a name="loc_113_9_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_113_13_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_113_15_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_15_113_16&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_113_17_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
    (</span><a href="#loc_113_13_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_113_15_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_15_113_16&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_113_9_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_113_17_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="mpre">rehash2</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="mpre">rehash2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="hl_fundecl"><span class="mpre">rehash2</span></span></a><span class="mpre"> </span><a name="loc_118_9_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_118_13_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_13_118_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_118_15_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_16&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_118_17_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_17_118_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
    (</span><a href="#loc_118_13_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_13_118_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_118_15_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_16&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_118_9_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_118_17_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_17_118_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_123_1_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_8&#39;)"><span class="mpre">rehash3</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_123_1_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_8&#39;)"><span class="mpre">rehash3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_123_1_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_8&#39;)"><span class="hl_fundecl"><span class="mpre">rehash3</span></span></a><span class="mpre"> </span><a name="loc_123_9_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_9_123_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_123_13_123_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_123_15_123_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_15_123_16&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_123_17_123_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_17_123_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
    (</span><a href="#loc_123_13_123_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_123_15_123_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_15_123_16&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_123_9_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_9_123_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_123_17_123_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_17_123_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="mpre">rehash4</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="mpre">rehash4</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="hl_fundecl"><span class="mpre">rehash4</span></span></a><span class="mpre"> </span><a name="loc_128_9_128_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_9_128_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_128_13_128_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_13_128_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_128_15_128_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_15_128_16&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_128_17_128_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_17_128_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
    (</span><a href="#loc_128_13_128_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_13_128_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_128_15_128_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_15_128_16&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_128_9_128_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_9_128_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_128_17_128_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_17_128_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><a href="#loc_132_1_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_12&#39;)"><span class="mpre">lazyMatcher</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [(</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">])]
</span><a name="loc_132_1_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_12&#39;)"><span class="hl_fundecl"><span class="mpre">lazyMatcher</span></span></a><span class="mpre"> </span><a name="loc_132_13_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_13_132_17&#39;)"><span class="hl_vardecl"><span class="mpre">pats</span></span></a><span class="mpre"> = </span><a href="#loc_153_5_153_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_5_153_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
  where
    !</span><a name="loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_vardecl"><span class="mpre">hLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">minimum</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_132_13_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_13_132_17&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">)
    !</span><a name="loc_135_6_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_6_135_10&#39;)"><span class="hl_vardecl"><span class="mpre">shDi</span></span></a><span class="mpre"> = case </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre"> of
              </span><a name="loc_136_15_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_16&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> | </span><a href="#loc_136_15_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_16&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> -&gt; </span><a href="#loc_136_15_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_16&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
    !</span><a name="loc_138_6_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_10&#39;)"><span class="hl_vardecl"><span class="mpre">outS</span></span></a><span class="mpre"> = </span><a href="#loc_135_6_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_6_135_10&#39;)"><span class="hl_varref"><span class="mpre">shDi</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">
    !</span><a name="loc_139_6_139_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_12&#39;)"><span class="hl_vardecl"><span class="mpre">patNum</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_132_13_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_13_132_17&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">
    !</span><a name="loc_140_6_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_6_140_12&#39;)"><span class="hl_vardecl"><span class="mpre">patArr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">listArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="#loc_139_6_139_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_12&#39;)"><span class="hl_varref"><span class="mpre">patNum</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_132_13_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_13_132_17&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="mpre">rehash</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="mpre">rehash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a name="loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_vardecl"><span class="mpre">rehash</span></span></a><span class="mpre"> = case </span><a href="#loc_135_6_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_6_135_10&#39;)"><span class="hl_varref"><span class="mpre">shDi</span></span></a><span class="mpre"> of
                </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> -&gt; </span><a href="#loc_113_1_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_8&#39;)"><span class="hl_varref"><span class="mpre">rehash1</span></span></a><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">
                </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> -&gt; </span><a href="#loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="hl_varref"><span class="mpre">rehash2</span></span></a><span class="mpre"> </span><a href="#loc_138_6_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_10&#39;)"><span class="hl_varref"><span class="mpre">outS</span></span></a><span class="mpre">
                </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> -&gt; </span><a href="#loc_123_1_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_8&#39;)"><span class="hl_varref"><span class="mpre">rehash3</span></span></a><span class="mpre"> </span><a href="#loc_138_6_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_10&#39;)"><span class="hl_varref"><span class="mpre">outS</span></span></a><span class="mpre">
                _ -&gt; </span><a href="#loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="hl_varref"><span class="mpre">rehash4</span></span></a><span class="mpre"> </span><a href="#loc_138_6_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_10&#39;)"><span class="hl_varref"><span class="mpre">outS</span></span></a><span class="mpre">
    </span><a href="#loc_149_5_149_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_5_149_9&#39;)"><span class="mpre">hash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a name="loc_149_5_149_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_5_149_9&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.foldl&#39;</span></span><span class="mpre"> (\</span><a name="loc_149_23_149_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_23_149_24&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_149_25_149_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_25_149_26&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_149_23_149_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_23_149_24&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_135_6_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_6_135_10&#39;)"><span class="hl_varref"><span class="mpre">shDi</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_149_25_149_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_25_149_26&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">
    !</span><a name="loc_150_6_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_6_150_13&#39;)"><span class="hl_vardecl"><span class="mpre">hashMap</span></span></a><span class="mpre"> =
        </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> (\</span><a name="loc_151_18_151_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_18_151_20&#39;)"><span class="hl_vardecl"><span class="mpre">mp</span></span></a><span class="mpre"> (</span><a name="loc_151_22_151_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_22_151_23&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">,</span><a name="loc_151_24_151_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_24_151_25&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">IM.insertWith</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(++)</span></span><span class="mpre">) </span><a href="#loc_151_22_151_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_22_151_23&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> [</span><a href="#loc_151_24_151_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_24_151_25&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">] </span><a href="#loc_151_18_151_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_18_151_20&#39;)"><span class="hl_varref"><span class="mpre">mp</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">IM.empty</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_149_5_149_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_5_149_9&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_132_13_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_13_132_17&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">) </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/KarpRabin.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 53, srcSpanEndLine = 152, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/KarpRabin.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 53, srcSpanEndLine = 152, srcSpanEndColumn = 54},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pu"><span class="mpre">[0 :: Int .. ]</span></span><span class="mpre">
    </span><a name="loc_153_5_153_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_5_153_11&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> _ _ _ [] = []
    </span><a href="#loc_153_5_153_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_5_153_11&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> !</span><a name="loc_154_13_154_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_13_154_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> !</span><a name="loc_154_16_154_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_16_154_18&#39;)"><span class="hl_vardecl"><span class="mpre">rm</span></span></a><span class="mpre"> !</span><a name="loc_154_20_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_20_154_24&#39;)"><span class="hl_vardecl"><span class="mpre">prev</span></span></a><span class="mpre"> (!</span><a name="loc_154_27_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_27_154_30&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_154_33_154_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_33_154_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)
      | </span><a href="#loc_166_12_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_12_166_18&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_154_16_154_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_16_154_18&#39;)"><span class="hl_varref"><span class="mpre">rm</span></span></a><span class="mpre"> =
          let !</span><a name="loc_156_16_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_16_156_18&#39;)"><span class="hl_vardecl"><span class="mpre">h&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.foldl&#39;</span></span><span class="mpre"> (\</span><a name="loc_156_32_156_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_32_156_33&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_156_34_156_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_34_156_35&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_156_32_156_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_32_156_33&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_156_34_156_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_34_156_35&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><a href="#loc_154_13_154_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_13_154_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_154_27_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_27_154_30&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
              !</span><a name="loc_157_16_157_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_16_157_21&#39;)"><span class="hl_vardecl"><span class="mpre">prev&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.append</span></span><span class="mpre"> </span><a href="#loc_154_20_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_20_154_24&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre"> </span><a href="#loc_154_27_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_27_154_30&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
          in </span><a href="#loc_153_5_153_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_5_153_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><a href="#loc_156_16_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_16_156_18&#39;)"><span class="hl_varref"><span class="mpre">h&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_154_16_154_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_16_154_18&#39;)"><span class="hl_varref"><span class="mpre">rm</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_166_12_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_12_166_18&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">) </span><a href="#loc_157_16_157_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_16_157_21&#39;)"><span class="hl_varref"><span class="mpre">prev&#39;</span></span></a><span class="mpre"> </span><a href="#loc_154_33_154_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_33_154_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
          let !</span><a name="loc_160_16_160_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_16_160_18&#39;)"><span class="hl_vardecl"><span class="mpre">h&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.foldl&#39;</span></span><span class="mpre"> (\</span><a name="loc_160_32_160_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_32_160_33&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_160_34_160_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_34_160_35&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_160_32_160_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_32_160_33&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_160_34_160_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_34_160_35&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><a href="#loc_154_13_154_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_13_154_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
                                                (</span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_154_16_154_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_16_154_18&#39;)"><span class="hl_varref"><span class="mpre">rm</span></span></a><span class="mpre"> </span><a href="#loc_154_27_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_27_154_30&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
          in if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_154_20_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_20_154_24&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre">
                then </span><a href="#loc_168_5_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_11&#39;)"><span class="hl_varref"><span class="mpre">noPast</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_154_33_154_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_33_154_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_154_27_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_27_154_30&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_160_16_160_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_16_160_18&#39;)"><span class="hl_varref"><span class="mpre">h&#39;</span></span></a><span class="mpre">
                else </span><a href="#loc_214_5_214_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_9&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_154_33_154_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_33_154_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_154_20_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_20_154_24&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_154_27_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_27_154_30&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_154_16_154_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_16_154_18&#39;)"><span class="hl_varref"><span class="mpre">rm</span></span></a><span class="mpre"> </span><a href="#loc_160_16_160_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_16_160_18&#39;)"><span class="hl_varref"><span class="mpre">h&#39;</span></span></a><span class="mpre">
        where
          !</span><a name="loc_166_12_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_12_166_18&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_154_27_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_27_154_30&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">

    </span><a name="loc_168_5_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_11&#39;)"><span class="hl_fundecl"><span class="mpre">noPast</span></span></a><span class="mpre"> !</span><a name="loc_168_13_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_13_168_18&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a name="loc_168_19_168_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_23&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> !</span><a name="loc_168_25_168_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_25_168_28&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><a name="loc_168_29_168_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_29_168_32&#39;)"><span class="hl_vardecl"><span class="mpre">hsh</span></span></a><span class="mpre"> = </span><a href="#loc_174_9_174_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_168_29_168_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_29_168_32&#39;)"><span class="hl_varref"><span class="mpre">hsh</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      where
        !</span><a name="loc_170_10_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_16&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_168_25_168_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_25_168_28&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
        !</span><a name="loc_171_10_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_10_171_16&#39;)"><span class="hl_vardecl"><span class="mpre">maxIdx</span></span></a><span class="mpre"> = </span><a href="#loc_170_10_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">
        </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_173_9_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_9_173_14&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
        </span><a name="loc_173_9_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_9_173_14&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> !</span><a name="loc_173_16_173_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_16_173_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_168_25_168_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_25_168_28&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_173_16_173_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_16_173_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
        </span><a name="loc_174_9_174_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_174_13_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_13_174_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_vardecl"><span class="mpre">sI</span></span></a><span class="mpre"> =
          case </span><span class="hl_varref"><span class="mpre">IM.lookup</span></span><span class="mpre"> </span><a href="#loc_174_13_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_13_174_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_150_6_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_6_150_13&#39;)"><span class="hl_varref"><span class="mpre">hashMap</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt;
              if </span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_171_10_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_10_171_16&#39;)"><span class="hl_varref"><span class="mpre">maxIdx</span></span></a><span class="mpre">
                then case </span><a href="#loc_168_19_168_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_23&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> of
                        [] -&gt; []
                        (</span><a name="loc_180_26_180_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_26_180_29&#39;)"><span class="hl_vardecl"><span class="mpre">nxt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_180_32_180_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_32_180_36&#39;)"><span class="hl_vardecl"><span class="mpre">more</span></span></a><span class="mpre">) -&gt;
                          let !</span><a name="loc_181_32_181_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_32_181_34&#39;)"><span class="hl_vardecl"><span class="mpre">h&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_varref"><span class="mpre">rehash</span></span></a><span class="mpre"> </span><a href="#loc_174_13_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_13_174_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_173_9_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_9_173_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">) (</span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_180_26_180_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_26_180_29&#39;)"><span class="hl_varref"><span class="mpre">nxt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
                              !</span><a name="loc_182_32_182_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_32_182_38&#39;)"><span class="hl_vardecl"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_168_13_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_13_168_18&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_170_10_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">
                              !</span><a name="loc_183_32_183_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_32_183_36&#39;)"><span class="hl_vardecl"><span class="mpre">prev</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_168_25_168_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_25_168_28&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
                          in if </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                                then </span><a href="#loc_168_5_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_11&#39;)"><span class="hl_varref"><span class="mpre">noPast</span></span></a><span class="mpre"> </span><a href="#loc_182_32_182_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_32_182_38&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_180_32_180_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_32_180_36&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre"> </span><a href="#loc_180_26_180_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_26_180_29&#39;)"><span class="hl_varref"><span class="mpre">nxt</span></span></a><span class="mpre"> </span><a href="#loc_181_32_181_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_32_181_34&#39;)"><span class="hl_varref"><span class="mpre">h&#39;</span></span></a><span class="mpre">
                                else </span><a href="#loc_214_5_214_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_9&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_182_32_182_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_32_182_38&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_180_32_180_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_32_180_36&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre"> </span><a href="#loc_183_32_183_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_32_183_36&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_180_26_180_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_26_180_29&#39;)"><span class="hl_varref"><span class="mpre">nxt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_181_32_181_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_32_181_34&#39;)"><span class="hl_varref"><span class="mpre">h&#39;</span></span></a><span class="mpre">
                else </span><a href="#loc_174_9_174_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_varref"><span class="mpre">rehash</span></span></a><span class="mpre"> </span><a href="#loc_174_13_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_13_174_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_173_9_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_9_173_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">) (</span><a href="#loc_173_9_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_9_173_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">))) (</span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_188_18_188_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_18_188_20&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt;
              let !</span><a name="loc_189_20_189_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_20_189_23&#39;)"><span class="hl_vardecl"><span class="mpre">rst</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><a href="#loc_168_25_168_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_25_168_28&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
                  !</span><a name="loc_190_20_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_24&#39;)"><span class="hl_vardecl"><span class="mpre">rLen</span></span></a><span class="mpre"> = </span><a href="#loc_170_10_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">
                  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_192_19_192_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_19_192_21&#39;)"><span class="mpre">hd</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                  </span><a name="loc_192_19_192_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_19_192_21&#39;)"><span class="hl_vardecl"><span class="mpre">hd</span></span></a><span class="mpre"> = </span><a href="#loc_173_9_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_9_173_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">
                  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_194_19_194_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_19_194_23&#39;)"><span class="mpre">more</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                  </span><a name="loc_194_19_194_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_19_194_23&#39;)"><span class="hl_vardecl"><span class="mpre">more</span></span></a><span class="mpre"> =
                    if </span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_171_10_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_10_171_16&#39;)"><span class="hl_varref"><span class="mpre">maxIdx</span></span></a><span class="mpre">
                      then case </span><a href="#loc_168_19_168_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_23&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> of
                            [] -&gt; []
                            (</span><a name="loc_198_30_198_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_30_198_33&#39;)"><span class="hl_vardecl"><span class="mpre">nxt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_198_36_198_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_36_198_39&#39;)"><span class="hl_vardecl"><span class="mpre">fut</span></span></a><span class="mpre">) -&gt;
                              let !</span><a name="loc_199_36_199_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_36_199_38&#39;)"><span class="hl_vardecl"><span class="mpre">h&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_varref"><span class="mpre">rehash</span></span></a><span class="mpre"> </span><a href="#loc_174_13_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_13_174_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_192_19_192_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_19_192_21&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_198_30_198_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_30_198_33&#39;)"><span class="hl_varref"><span class="mpre">nxt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
                                  !</span><a name="loc_200_36_200_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_36_200_42&#39;)"><span class="hl_vardecl"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_168_13_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_13_168_18&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_170_10_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">
                              in if </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                                    then </span><a href="#loc_168_5_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_11&#39;)"><span class="hl_varref"><span class="mpre">noPast</span></span></a><span class="mpre"> </span><a href="#loc_200_36_200_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_36_200_42&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_198_36_198_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_36_198_39&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre"> </span><a href="#loc_198_30_198_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_30_198_33&#39;)"><span class="hl_varref"><span class="mpre">nxt</span></span></a><span class="mpre"> </span><a href="#loc_199_36_199_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_36_199_38&#39;)"><span class="hl_varref"><span class="mpre">h&#39;</span></span></a><span class="mpre">
                                    else </span><a href="#loc_214_5_214_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_9&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_200_36_200_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_36_200_42&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_198_36_198_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_36_198_39&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre"> </span><a href="#loc_189_20_189_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_20_189_23&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_198_30_198_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_30_198_33&#39;)"><span class="hl_varref"><span class="mpre">nxt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_199_36_199_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_36_199_38&#39;)"><span class="hl_varref"><span class="mpre">h&#39;</span></span></a><span class="mpre">
                      else </span><a href="#loc_174_9_174_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_varref"><span class="mpre">rehash</span></span></a><span class="mpre"> </span><a href="#loc_174_13_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_13_174_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_192_19_192_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_19_192_21&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre"> (</span><a href="#loc_173_9_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_9_173_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">))) (</span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                  </span><a name="loc_205_19_205_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_19_205_23&#39;)"><span class="hl_fundecl"><span class="mpre">okay</span></span></a><span class="mpre"> </span><a name="loc_205_24_205_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_24_205_26&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
                    | </span><a href="#loc_190_20_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_24&#39;)"><span class="hl_varref"><span class="mpre">rLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_205_24_205_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_24_205_26&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.isPrefixOf</span></span><span class="mpre"> </span><a href="#loc_189_20_189_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_20_189_23&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre"> </span><a href="#loc_205_24_205_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_24_205_26&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
                            </span><a href="#loc_246_1_246_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_9&#39;)"><span class="hl_varref"><span class="mpre">checkFut</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_190_20_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_24&#39;)"><span class="hl_varref"><span class="mpre">rLen</span></span></a><span class="mpre"> </span><a href="#loc_205_24_205_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_24_205_26&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a href="#loc_168_19_168_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_23&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.isPrefixOf</span></span><span class="mpre"> </span><a href="#loc_205_24_205_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_24_205_26&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_189_20_189_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_20_189_23&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre">
              in case </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><a href="#loc_205_19_205_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_19_205_23&#39;)"><span class="hl_varref"><span class="mpre">okay</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_140_6_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_6_140_12&#39;)"><span class="hl_varref"><span class="mpre">patArr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`unsafeAt`</span></span><span class="mpre">)) </span><a href="#loc_188_18_188_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_18_188_20&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> of
                    [] -&gt; </span><a href="#loc_194_19_194_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_19_194_23&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">
                    </span><a name="loc_211_21_211_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_21_211_23&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_211_21_211_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_21_211_23&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                            (</span><a href="#loc_168_13_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_13_168_18&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_174_15_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_15_174_17&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">,</span><a href="#loc_211_21_211_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_21_211_23&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_194_19_194_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_19_194_23&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">

    </span><a name="loc_214_5_214_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_9&#39;)"><span class="hl_fundecl"><span class="mpre">past</span></span></a><span class="mpre"> !</span><a name="loc_214_11_214_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_11_214_16&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a name="loc_214_17_214_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_17_214_21&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> !</span><a name="loc_214_23_214_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_23_214_27&#39;)"><span class="hl_vardecl"><span class="mpre">prev</span></span></a><span class="mpre"> !</span><a name="loc_214_29_214_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_29_214_31&#39;)"><span class="hl_vardecl"><span class="mpre">pI</span></span></a><span class="mpre"> !</span><a name="loc_214_33_214_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_33_214_36&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> !</span><a name="loc_214_38_214_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_38_214_40&#39;)"><span class="hl_vardecl"><span class="mpre">sI</span></span></a><span class="mpre"> !</span><a name="loc_214_42_214_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_42_214_45&#39;)"><span class="hl_vardecl"><span class="mpre">hsh</span></span></a><span class="mpre">
      | </span><a href="#loc_221_12_221_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_12_221_18&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4040</span></span><span class="mpre"> =
        let !</span><a name="loc_216_14_216_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_14_216_20&#39;)"><span class="hl_vardecl"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_214_11_214_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_11_214_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_214_38_214_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_38_214_40&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">)
            !</span><a name="loc_217_14_217_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_14_217_18&#39;)"><span class="hl_vardecl"><span class="mpre">curr</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">S.append</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_214_29_214_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_29_214_31&#39;)"><span class="hl_varref"><span class="mpre">pI</span></span></a><span class="mpre"> </span><a href="#loc_214_23_214_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_23_214_27&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre">) </span><a href="#loc_214_33_214_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_33_214_36&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
        in </span><a href="#loc_168_5_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_11&#39;)"><span class="hl_varref"><span class="mpre">noPast</span></span></a><span class="mpre"> </span><a href="#loc_216_14_216_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_14_216_20&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_214_17_214_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_17_214_21&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_217_14_217_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_14_217_18&#39;)"><span class="hl_varref"><span class="mpre">curr</span></span></a><span class="mpre"> </span><a href="#loc_214_42_214_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_42_214_45&#39;)"><span class="hl_varref"><span class="mpre">hsh</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_226_11_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_11_226_13&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_214_42_214_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_42_214_45&#39;)"><span class="hl_varref"><span class="mpre">hsh</span></span></a><span class="mpre"> </span><a href="#loc_214_29_214_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_29_214_31&#39;)"><span class="hl_varref"><span class="mpre">pI</span></span></a><span class="mpre"> </span><a href="#loc_214_38_214_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_38_214_40&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">
        where
          !</span><a name="loc_221_12_221_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_12_221_18&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_214_33_214_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_33_214_36&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
          </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_223_11_223_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_11_223_16&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
          </span><a name="loc_223_11_223_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_11_223_16&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> !</span><a name="loc_223_18_223_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_18_223_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_214_33_214_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_33_214_36&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_223_18_223_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_18_223_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
          </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_225_11_225_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_11_225_17&#39;)"><span class="mpre">prevAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
          </span><a name="loc_225_11_225_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_11_225_17&#39;)"><span class="hl_fundecl"><span class="mpre">prevAt</span></span></a><span class="mpre"> !</span><a name="loc_225_19_225_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_19_225_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_214_23_214_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_23_214_27&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre"> </span><a href="#loc_225_19_225_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_19_225_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
          </span><a name="loc_226_11_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_11_226_13&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_226_15_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_15_226_16&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> !</span><a name="loc_226_18_226_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_18_226_19&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> !</span><a name="loc_226_21_226_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_21_226_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">
            | </span><a href="#loc_226_21_226_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_21_226_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre"> = </span><a href="#loc_168_5_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_11&#39;)"><span class="hl_varref"><span class="mpre">noPast</span></span></a><span class="mpre"> </span><a href="#loc_214_11_214_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_11_214_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a href="#loc_214_17_214_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_17_214_21&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_214_33_214_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_33_214_36&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_226_15_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_15_226_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
              case </span><span class="hl_varref"><span class="mpre">IM.lookup</span></span><span class="mpre"> </span><a href="#loc_226_15_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_15_226_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_150_6_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_6_150_13&#39;)"><span class="hl_varref"><span class="mpre">hashMap</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt;
                  let </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_232_23_232_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_23_232_25&#39;)"><span class="mpre">h&#39;</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                      </span><a name="loc_232_23_232_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_23_232_25&#39;)"><span class="hl_vardecl"><span class="mpre">h&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_varref"><span class="mpre">rehash</span></span></a><span class="mpre"> </span><a href="#loc_226_15_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_15_226_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_225_11_225_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_11_225_17&#39;)"><span class="hl_varref"><span class="mpre">prevAt</span></span></a><span class="mpre"> </span><a href="#loc_226_18_226_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_18_226_19&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) (</span><a href="#loc_223_11_223_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_11_223_16&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_226_21_226_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_21_226_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                  in </span><a href="#loc_226_11_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_11_226_13&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_232_23_232_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_23_232_25&#39;)"><span class="hl_varref"><span class="mpre">h&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_226_18_226_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_18_226_19&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_226_21_226_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_21_226_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_234_22_234_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_22_234_24&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt;
                  let !</span><a name="loc_235_24_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_24_235_28&#39;)"><span class="hl_vardecl"><span class="mpre">prst</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_226_18_226_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_18_226_19&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_214_23_214_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_23_214_27&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre">
                      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_237_23_237_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_23_237_27&#39;)"><span class="mpre">more</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                      </span><a name="loc_237_23_237_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_23_237_27&#39;)"><span class="hl_vardecl"><span class="mpre">more</span></span></a><span class="mpre"> = </span><a href="#loc_226_11_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_11_226_13&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_varref"><span class="mpre">rehash</span></span></a><span class="mpre"> </span><a href="#loc_226_15_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_15_226_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_225_11_225_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_11_225_17&#39;)"><span class="hl_varref"><span class="mpre">prevAt</span></span></a><span class="mpre"> </span><a href="#loc_226_18_226_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_18_226_19&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) (</span><a href="#loc_223_11_223_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_11_223_16&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_226_21_226_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_21_226_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)) (</span><a href="#loc_226_18_226_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_18_226_19&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_226_21_226_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_21_226_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                      </span><a name="loc_238_23_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_23_238_27&#39;)"><span class="hl_fundecl"><span class="mpre">okay</span></span></a><span class="mpre"> </span><a name="loc_238_28_238_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_28_238_30&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_246_1_246_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_9&#39;)"><span class="hl_varref"><span class="mpre">checkFut</span></span></a><span class="mpre"> </span><a href="#loc_238_28_238_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_28_238_30&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> (</span><a href="#loc_235_24_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_24_235_28&#39;)"><span class="hl_varref"><span class="mpre">prst</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_214_33_214_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_33_214_36&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_214_17_214_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_17_214_21&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
                  in case </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><a href="#loc_238_23_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_23_238_27&#39;)"><span class="hl_varref"><span class="mpre">okay</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_140_6_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_6_140_12&#39;)"><span class="hl_varref"><span class="mpre">patArr</span></span></a><span class="mpre">)) </span><a href="#loc_234_22_234_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_22_234_24&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> of
                        [] -&gt; </span><a href="#loc_237_23_237_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_23_237_27&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">
                        </span><a name="loc_241_25_241_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_25_241_27&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_241_25_241_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_25_241_27&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                (</span><a href="#loc_214_11_214_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_11_214_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_226_21_226_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_21_226_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_134_6_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">), </span><a href="#loc_241_25_241_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_25_241_27&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_237_23_237_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_23_237_27&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_246_1_246_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_9&#39;)"><span class="mpre">checkFut</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_246_1_246_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_9&#39;)"><span class="mpre">checkFut</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_246_1_246_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_9&#39;)"><span class="hl_fundecl"><span class="mpre">checkFut</span></span></a><span class="mpre"> _ [] = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_246_1_246_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_9&#39;)"><span class="hl_fundecl"><span class="mpre">checkFut</span></span></a><span class="mpre"> !</span><a name="loc_247_11_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_11_247_13&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> (!</span><a name="loc_247_16_247_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_16_247_17&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_247_20_247_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_20_247_21&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">)
    | </span><a href="#loc_251_10_251_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_10_251_14&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_247_11_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_11_247_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.isPrefixOf</span></span><span class="mpre"> </span><a href="#loc_247_16_247_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_16_247_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_247_11_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_11_247_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_246_1_246_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_9&#39;)"><span class="hl_varref"><span class="mpre">checkFut</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_251_10_251_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_10_251_14&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre"> </span><a href="#loc_247_11_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_11_247_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a href="#loc_247_20_247_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_20_247_21&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.isPrefixOf</span></span><span class="mpre"> </span><a href="#loc_247_11_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_11_247_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_247_16_247_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_16_247_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
      where
        !</span><a name="loc_251_10_251_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_10_251_14&#39;)"><span class="hl_vardecl"><span class="mpre">hLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_247_16_247_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_16_247_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
</span></div></body></html>