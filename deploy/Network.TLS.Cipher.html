<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS_HADDOCK hide #-}
{-# LANGUAGE ExistentialQuantification #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Cipher</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Cipher
    ( BulkFunctions(..)
    , CipherKeyExchangeType(..)
    , Bulk(..)
    , Hash(..)
    , Cipher(..)
    , CipherID
    , Key
    , IV
    , cipherKeyBlockSize
    , cipherAllowedForVersion
    , cipherExchangeNeedMoreData
    ) where

import Network.TLS.Types (CipherID)
import Network.TLS.Struct (</span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="mpre">Version</span></a><span class="mpre">(..))

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 18, srcSpanEndLine = 27, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B

</span><span class="hl_comment"><span class="mpre">-- FIXME convert to newtype</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 30, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 30, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 30, srcSpan"><span class="mpre">type Key = B.ByteString</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 1, srcSpanEndLine = 31, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 1, srcSpanEndLine = 31, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 31, srcSpan"><span class="mpre">type IV = B.ByteString</span></span><span class="mpre">

data </span><a name="loc_33_6_33_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_6_33_19&#39;)"><span class="hl_tycondecl"><span class="mpre">BulkFunctions</span></span></a><span class="mpre"> =
      </span><a name="loc_34_7_34_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_17&#39;)"><span class="hl_condecl"><span class="mpre">BulkBlockF</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Key</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
                 (</span><span class="hl_tyconref"><span class="mpre">Key</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
    | </span><a name="loc_36_7_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_18&#39;)"><span class="hl_condecl"><span class="mpre">BulkStreamF</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Key</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IV</span></span><span class="mpre">)
                  (</span><span class="hl_tyconref"><span class="mpre">IV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">IV</span></span><span class="mpre">))
                  (</span><span class="hl_tyconref"><span class="mpre">IV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">IV</span></span><span class="mpre">))

data </span><a name="loc_40_6_40_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_27&#39;)"><span class="hl_tycondecl"><span class="mpre">CipherKeyExchangeType</span></span></a><span class="mpre"> =
      </span><a name="loc_41_7_41_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_28&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_RSA</span></span></a><span class="mpre">
    | </span><a name="loc_42_7_42_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_32&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_DH_Anon</span></span></a><span class="mpre">
    | </span><a name="loc_43_7_43_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_32&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_DHE_RSA</span></span></a><span class="mpre">
    | </span><a name="loc_44_7_44_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_34&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_ECDHE_RSA</span></span></a><span class="mpre">
    | </span><a name="loc_45_7_45_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_32&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_DHE_DSS</span></span></a><span class="mpre">
    | </span><a name="loc_46_7_46_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_31&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_DH_DSS</span></span></a><span class="mpre">
    | </span><a name="loc_47_7_47_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_7_47_31&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_DH_RSA</span></span></a><span class="mpre">
    | </span><a name="loc_48_7_48_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_35&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_ECDH_ECDSA</span></span></a><span class="mpre">
    | </span><a name="loc_49_7_49_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_33&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_ECDH_RSA</span></span></a><span class="mpre">
    | </span><a name="loc_50_7_50_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_36&#39;)"><span class="hl_condecl"><span class="mpre">CipherKeyExchange_ECDHE_ECDSA</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 5, srcSpanEndLine = 51, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 5, srcSpanEndLine = 51, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Cipher.hs&quot;, srcSpanStartLine = 51, srcSpa"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

data </span><a name="loc_53_6_53_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Bulk</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Bulk</span></span><span class="mpre">
    { </span><a name="loc_54_7_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_7_54_15&#39;)"><span class="hl_fielddecl"><span class="mpre">bulkName</span></span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_55_7_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_18&#39;)"><span class="hl_fielddecl"><span class="mpre">bulkKeySize</span></span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    , </span><a name="loc_56_7_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_17&#39;)"><span class="hl_fielddecl"><span class="mpre">bulkIVSize</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    , </span><a name="loc_57_7_57_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_20&#39;)"><span class="hl_fielddecl"><span class="mpre">bulkBlockSize</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    , </span><a name="loc_58_7_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_12&#39;)"><span class="hl_fielddecl"><span class="mpre">bulkF</span></span></a><span class="mpre">            :: </span><a href="#loc_33_6_33_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_6_33_19&#39;)"><span class="hl_tyconref"><span class="mpre">BulkFunctions</span></span></a><span class="mpre">
    }

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_53_6_53_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_10&#39;)"><span class="hl_tyconref"><span class="mpre">Bulk</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_62_10_62_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_14&#39;)"><span class="hl_vardecl"><span class="mpre">bulk</span></span></a><span class="mpre"> = </span><a href="#loc_54_7_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_7_54_15&#39;)"><span class="hl_varref"><span class="mpre">bulkName</span></span></a><span class="mpre"> </span><a href="#loc_62_10_62_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_14&#39;)"><span class="hl_varref"><span class="mpre">bulk</span></span></a><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre"> </span><a href="#loc_53_6_53_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_10&#39;)"><span class="hl_tyconref"><span class="mpre">Bulk</span></span></a><span class="mpre"> where
    </span><a name="loc_64_5_64_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_7&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">==</span></span><span class="mpre"> </span><a name="loc_64_11_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_13&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">and</span></span><span class="mpre"> [ </span><a href="#loc_54_7_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_7_54_15&#39;)"><span class="hl_varref"><span class="mpre">bulkName</span></span></a><span class="mpre"> </span><a href="#loc_64_5_64_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_7&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_54_7_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_7_54_15&#39;)"><span class="hl_varref"><span class="mpre">bulkName</span></span></a><span class="mpre"> </span><a href="#loc_64_11_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_13&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
                   , </span><a href="#loc_55_7_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_18&#39;)"><span class="hl_varref"><span class="mpre">bulkKeySize</span></span></a><span class="mpre"> </span><a href="#loc_64_5_64_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_7&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_55_7_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_18&#39;)"><span class="hl_varref"><span class="mpre">bulkKeySize</span></span></a><span class="mpre"> </span><a href="#loc_64_11_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_13&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
                   , </span><a href="#loc_56_7_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_17&#39;)"><span class="hl_varref"><span class="mpre">bulkIVSize</span></span></a><span class="mpre"> </span><a href="#loc_64_5_64_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_7&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_56_7_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_17&#39;)"><span class="hl_varref"><span class="mpre">bulkIVSize</span></span></a><span class="mpre"> </span><a href="#loc_64_11_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_13&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
                   , </span><a href="#loc_57_7_57_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_20&#39;)"><span class="hl_varref"><span class="mpre">bulkBlockSize</span></span></a><span class="mpre"> </span><a href="#loc_64_5_64_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_7&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_57_7_57_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_20&#39;)"><span class="hl_varref"><span class="mpre">bulkBlockSize</span></span></a><span class="mpre"> </span><a href="#loc_64_11_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_13&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
                   ]

data </span><a name="loc_70_6_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Hash</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Hash</span></span><span class="mpre">
    { </span><a name="loc_71_7_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_15&#39;)"><span class="hl_fielddecl"><span class="mpre">hashName</span></span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_72_7_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_15&#39;)"><span class="hl_fielddecl"><span class="mpre">hashSize</span></span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    , </span><a name="loc_73_7_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_7_73_12&#39;)"><span class="hl_fielddecl"><span class="mpre">hashF</span></span></a><span class="mpre">            :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
    }

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_70_6_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_10&#39;)"><span class="hl_tyconref"><span class="mpre">Hash</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_77_10_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_14&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> = </span><a href="#loc_71_7_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_15&#39;)"><span class="hl_varref"><span class="mpre">hashName</span></span></a><span class="mpre"> </span><a href="#loc_77_10_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_14&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre"> </span><a href="#loc_70_6_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_10&#39;)"><span class="hl_tyconref"><span class="mpre">Hash</span></span></a><span class="mpre"> where
    </span><a name="loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_vardecl"><span class="mpre">h1</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">==</span></span><span class="mpre"> </span><a name="loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_vardecl"><span class="mpre">h2</span></span></a><span class="mpre"> = </span><a href="#loc_71_7_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_15&#39;)"><span class="hl_varref"><span class="mpre">hashName</span></span></a><span class="mpre"> </span><a href="#loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_varref"><span class="mpre">h1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_71_7_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_15&#39;)"><span class="hl_varref"><span class="mpre">hashName</span></span></a><span class="mpre"> </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">h2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_72_7_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_15&#39;)"><span class="hl_varref"><span class="mpre">hashSize</span></span></a><span class="mpre"> </span><a href="#loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_varref"><span class="mpre">h1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_72_7_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_15&#39;)"><span class="hl_varref"><span class="mpre">hashSize</span></span></a><span class="mpre"> </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">h2</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Cipher algorithm</span></span><span class="mpre">
data </span><a name="loc_82_6_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Cipher</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Cipher</span></span><span class="mpre">
    { </span><a name="loc_83_7_83_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_7_83_15&#39;)"><span class="hl_fielddecl"><span class="mpre">cipherID</span></span></a><span class="mpre">           :: </span><span class="hl_tyconref"><span class="mpre">CipherID</span></span><span class="mpre">
    , </span><a name="loc_84_7_84_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_7_84_17&#39;)"><span class="hl_fielddecl"><span class="mpre">cipherName</span></span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_85_7_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_17&#39;)"><span class="hl_fielddecl"><span class="mpre">cipherHash</span></span></a><span class="mpre">         :: </span><a href="#loc_70_6_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_10&#39;)"><span class="hl_tyconref"><span class="mpre">Hash</span></span></a><span class="mpre">
    , </span><a name="loc_86_7_86_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_7_86_17&#39;)"><span class="hl_fielddecl"><span class="mpre">cipherBulk</span></span></a><span class="mpre">         :: </span><a href="#loc_53_6_53_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_10&#39;)"><span class="hl_tyconref"><span class="mpre">Bulk</span></span></a><span class="mpre">
    , </span><a name="loc_87_7_87_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_7_87_24&#39;)"><span class="hl_fielddecl"><span class="mpre">cipherKeyExchange</span></span></a><span class="mpre">  :: </span><a href="#loc_40_6_40_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_27&#39;)"><span class="hl_tyconref"><span class="mpre">CipherKeyExchangeType</span></span></a><span class="mpre">
    , </span><a name="loc_88_7_88_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_19&#39;)"><span class="hl_fielddecl"><span class="mpre">cipherMinVer</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
    }

</span><a href="#loc_92_1_92_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_19&#39;)"><span class="mpre">cipherKeyBlockSize</span></a><span class="mpre"> :: </span><a href="#loc_82_6_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cipher</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_92_1_92_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_19&#39;)"><span class="hl_fundecl"><span class="mpre">cipherKeyBlockSize</span></span></a><span class="mpre"> </span><a name="loc_92_20_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_26&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_72_7_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_15&#39;)"><span class="hl_varref"><span class="mpre">hashSize</span></span></a><span class="mpre"> (</span><a href="#loc_85_7_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_17&#39;)"><span class="hl_varref"><span class="mpre">cipherHash</span></span></a><span class="mpre"> </span><a href="#loc_92_20_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_26&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_56_7_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_17&#39;)"><span class="hl_varref"><span class="mpre">bulkIVSize</span></span></a><span class="mpre"> </span><a href="#loc_93_9_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_13&#39;)"><span class="hl_varref"><span class="mpre">bulk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_55_7_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_18&#39;)"><span class="hl_varref"><span class="mpre">bulkKeySize</span></span></a><span class="mpre"> </span><a href="#loc_93_9_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_13&#39;)"><span class="hl_varref"><span class="mpre">bulk</span></span></a><span class="mpre">)
  where </span><a name="loc_93_9_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_13&#39;)"><span class="hl_vardecl"><span class="mpre">bulk</span></span></a><span class="mpre"> = </span><a href="#loc_86_7_86_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_7_86_17&#39;)"><span class="hl_varref"><span class="mpre">cipherBulk</span></span></a><span class="mpre"> </span><a href="#loc_92_20_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_26&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Check if a specific &#39;Cipher&#39; is allowed to be used</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with the version specified</span></span><span class="mpre">
</span><a href="#loc_98_1_98_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_24&#39;)"><span class="mpre">cipherAllowedForVersion</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_82_6_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cipher</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_98_1_98_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_24&#39;)"><span class="hl_fundecl"><span class="mpre">cipherAllowedForVersion</span></span></a><span class="mpre"> </span><a name="loc_98_25_98_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_25_98_28&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a name="loc_98_29_98_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_29_98_35&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> =
    case </span><a href="#loc_88_7_88_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_19&#39;)"><span class="hl_varref"><span class="mpre">cipherMinVer</span></span></a><span class="mpre"> </span><a href="#loc_98_29_98_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_29_98_35&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">   -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_101_14_101_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_18&#39;)"><span class="hl_vardecl"><span class="mpre">cVer</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_101_14_101_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_18&#39;)"><span class="hl_varref"><span class="mpre">cVer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_98_25_98_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_25_98_28&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_82_6_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cipher</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_84_7_84_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_7_84_17&#39;)"><span class="hl_varref"><span class="mpre">cipherName</span></span></a><span class="mpre"> </span><a href="#loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre"> </span><a href="#loc_82_6_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cipher</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">(==)</span></span><span class="mpre"> </span><a name="loc_107_10_107_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_10_107_12&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a name="loc_107_13_107_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_13_107_15&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> = </span><a href="#loc_83_7_83_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_7_83_15&#39;)"><span class="hl_varref"><span class="mpre">cipherID</span></span></a><span class="mpre"> </span><a href="#loc_107_10_107_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_10_107_12&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_83_7_83_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_7_83_15&#39;)"><span class="hl_varref"><span class="mpre">cipherID</span></span></a><span class="mpre"> </span><a href="#loc_107_13_107_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_13_107_15&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">

</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="mpre">cipherExchangeNeedMoreData</span></a><span class="mpre"> :: </span><a href="#loc_40_6_40_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_27&#39;)"><span class="hl_tyconref"><span class="mpre">CipherKeyExchangeType</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_41_7_41_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_28&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_RSA</span></span></a><span class="mpre">         = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_42_7_42_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_32&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DH_Anon</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_32&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DHE_RSA</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_44_7_44_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_34&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_ECDHE_RSA</span></span></a><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_45_7_45_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_32&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DHE_DSS</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_46_7_46_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_31&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DH_DSS</span></span></a><span class="mpre">      = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_47_7_47_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_7_47_31&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DH_RSA</span></span></a><span class="mpre">      = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_48_7_48_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_35&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_ECDH_ECDSA</span></span></a><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_49_7_49_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_33&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_ECDH_RSA</span></span></a><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_110_1_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_27&#39;)"><span class="hl_fundecl"><span class="mpre">cipherExchangeNeedMoreData</span></span></a><span class="mpre"> </span><a href="#loc_50_7_50_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_36&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_ECDHE_ECDSA</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span></div></body></html>