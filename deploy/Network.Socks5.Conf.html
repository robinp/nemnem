<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.Socks5.Conf</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- typical SOCKS configuration</span></span><span class="mpre">
module Network.Socks5.Conf
    ( SocksConf(..)
    , socksHost
    , socksPort
    , defaultSocksConf 
    , defaultSocksConfFromSockAddr
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Conf.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 8, srcSpanEndLine = 17, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre">
import Network.Socks5.Types (</span><a href="Network.Socks5.Types.html#loc_87_6_87_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_87_6_87_18&#39;)"><span class="mpre">SocksAddress</span></a><span class="mpre">(..), </span><a href="Network.Socks5.Types.html#loc_53_6_53_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_53_6_53_22&#39;)"><span class="mpre">SocksHostAddress</span></a><span class="mpre">(..), </span><a href="Network.Socks5.Types.html#loc_29_6_29_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_29_6_29_18&#39;)"><span class="mpre">SocksVersion</span></a><span class="mpre">(..))
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Conf.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 18, srcSpanEndLine = 19, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BC

</span><span class="hl_comment"><span class="mpre">-- | SOCKS configuration structure.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this structure will be extended in future to support authentification.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- use defaultSocksConf to create new record.</span></span><span class="mpre">
data </span><a name="loc_24_6_24_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_6_24_15&#39;)"><span class="hl_tycondecl"><span class="mpre">SocksConf</span></span></a><span class="mpre"> = </span><a name="loc_24_18_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_18_24_27&#39;)"><span class="hl_condecl"><span class="mpre">SocksConf</span></span></a><span class="mpre">
    { </span><a name="loc_25_7_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_7_25_18&#39;)"><span class="hl_fielddecl"><span class="mpre">socksServer</span></span></a><span class="mpre">  :: </span><a href="Network.Socks5.Types.html#loc_87_6_87_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_87_6_87_18&#39;)"><span class="hl_tyconref"><span class="mpre">SocksAddress</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ SOCKS Address</span></span><span class="mpre">
    , </span><a name="loc_26_7_26_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_19&#39;)"><span class="hl_fielddecl"><span class="mpre">socksVersion</span></span></a><span class="mpre"> :: </span><a href="Network.Socks5.Types.html#loc_29_6_29_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_29_6_29_18&#39;)"><span class="hl_tyconref"><span class="mpre">SocksVersion</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ SOCKS version to use</span></span><span class="mpre">
    }

</span><span class="hl_comment"><span class="mpre">-- | SOCKS Host</span></span><span class="mpre">
</span><a href="#loc_31_1_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_10&#39;)"><span class="mpre">socksHost</span></a><span class="mpre"> :: </span><a href="#loc_24_6_24_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_6_24_15&#39;)"><span class="hl_tyconref"><span class="mpre">SocksConf</span></span></a><span class="mpre"> -&gt; </span><a href="Network.Socks5.Types.html#loc_53_6_53_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_53_6_53_22&#39;)"><span class="hl_tyconref"><span class="mpre">SocksHostAddress</span></span></a><span class="mpre">
</span><a name="loc_31_1_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_10&#39;)"><span class="hl_fundecl"><span class="mpre">socksHost</span></span></a><span class="mpre"> </span><a name="loc_31_11_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_11_31_15&#39;)"><span class="hl_vardecl"><span class="mpre">conf</span></span></a><span class="mpre"> = </span><a href="#loc_31_41_31_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_41_31_43&#39;)"><span class="hl_varref"><span class="mpre">ha</span></span></a><span class="mpre"> where (</span><a href="Network.Socks5.Types.html#loc_87_21_87_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_87_21_87_33&#39;)"><span class="hl_conref"><span class="mpre">SocksAddress</span></span></a><span class="mpre"> </span><a name="loc_31_41_31_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_41_31_43&#39;)"><span class="hl_vardecl"><span class="mpre">ha</span></span></a><span class="mpre"> _) = </span><a href="#loc_25_7_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_7_25_18&#39;)"><span class="hl_varref"><span class="mpre">socksServer</span></span></a><span class="mpre"> </span><a href="#loc_31_11_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_11_31_15&#39;)"><span class="hl_varref"><span class="mpre">conf</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | SOCKS Port</span></span><span class="mpre">
</span><a href="#loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="mpre">socksPort</span></a><span class="mpre"> :: </span><a href="#loc_24_6_24_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_6_24_15&#39;)"><span class="hl_tyconref"><span class="mpre">SocksConf</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PortNumber</span></span><span class="mpre">
</span><a name="loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="hl_fundecl"><span class="mpre">socksPort</span></span></a><span class="mpre"> </span><a name="loc_35_11_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_11_35_15&#39;)"><span class="hl_vardecl"><span class="mpre">conf</span></span></a><span class="mpre"> = </span><a href="#loc_35_45_35_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_45_35_49&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre"> where (</span><a href="Network.Socks5.Types.html#loc_87_21_87_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_87_21_87_33&#39;)"><span class="hl_conref"><span class="mpre">SocksAddress</span></span></a><span class="mpre"> _ </span><a name="loc_35_45_35_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_45_35_49&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre">) = </span><a href="#loc_25_7_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_7_25_18&#39;)"><span class="hl_varref"><span class="mpre">socksServer</span></span></a><span class="mpre"> </span><a href="#loc_35_11_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_11_35_15&#39;)"><span class="hl_varref"><span class="mpre">conf</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | defaultSocksConf create a new record, making sure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- API remains compatible when the record is extended.</span></span><span class="mpre">
</span><a name="loc_39_1_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_17&#39;)"><span class="hl_fundecl"><span class="mpre">defaultSocksConf</span></span></a><span class="mpre"> </span><a name="loc_39_18_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_22&#39;)"><span class="hl_vardecl"><span class="mpre">host</span></span></a><span class="mpre"> </span><a name="loc_39_23_39_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_27&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre"> = </span><a href="#loc_24_18_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_18_24_27&#39;)"><span class="hl_conref"><span class="mpre">SocksConf</span></span></a><span class="mpre"> </span><a href="#loc_40_11_40_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_17&#39;)"><span class="hl_varref"><span class="mpre">server</span></span></a><span class="mpre"> </span><a href="Network.Socks5.Types.html#loc_29_21_29_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_29_21_29_30&#39;)"><span class="hl_conref"><span class="mpre">SocksVer5</span></span></a><span class="mpre">
    where </span><a name="loc_40_11_40_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_17&#39;)"><span class="hl_vardecl"><span class="mpre">server</span></span></a><span class="mpre"> = </span><a href="Network.Socks5.Types.html#loc_87_21_87_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_87_21_87_33&#39;)"><span class="hl_conref"><span class="mpre">SocksAddress</span></span></a><span class="mpre"> </span><a href="#loc_41_11_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_11_41_16&#39;)"><span class="hl_varref"><span class="mpre">haddr</span></span></a><span class="mpre"> </span><a href="#loc_39_23_39_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_27&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">
          </span><a name="loc_41_11_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_11_41_16&#39;)"><span class="hl_vardecl"><span class="mpre">haddr</span></span></a><span class="mpre">  = </span><a href="Network.Socks5.Types.html#loc_55_7_55_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_55_7_55_26&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrDomainName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BC.pack</span></span><span class="mpre"> </span><a href="#loc_39_18_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_22&#39;)"><span class="hl_varref"><span class="mpre">host</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | same as defaultSocksConf except the server address is determined from a &#39;SockAddr&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A unix SockAddr will raises an error. Only Inet and Inet6 types supported</span></span><span class="mpre">
</span><a name="loc_46_1_46_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_29&#39;)"><span class="hl_fundecl"><span class="mpre">defaultSocksConfFromSockAddr</span></span></a><span class="mpre"> </span><a name="loc_46_30_46_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_30_46_38&#39;)"><span class="hl_vardecl"><span class="mpre">sockaddr</span></span></a><span class="mpre"> = </span><a href="#loc_24_18_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_18_24_27&#39;)"><span class="hl_conref"><span class="mpre">SocksConf</span></span></a><span class="mpre"> </span><a href="#loc_47_11_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_11_47_17&#39;)"><span class="hl_varref"><span class="mpre">server</span></span></a><span class="mpre"> </span><a href="Network.Socks5.Types.html#loc_29_21_29_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_29_21_29_30&#39;)"><span class="hl_conref"><span class="mpre">SocksVer5</span></span></a><span class="mpre">
    where </span><a name="loc_47_11_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_11_47_17&#39;)"><span class="hl_vardecl"><span class="mpre">server</span></span></a><span class="mpre">       = </span><a href="Network.Socks5.Types.html#loc_87_21_87_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_87_21_87_33&#39;)"><span class="hl_conref"><span class="mpre">SocksAddress</span></span></a><span class="mpre"> </span><a href="#loc_48_12_48_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_12_48_17&#39;)"><span class="hl_varref"><span class="mpre">haddr</span></span></a><span class="mpre"> </span><a href="#loc_48_18_48_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_18_48_22&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">
          (</span><a name="loc_48_12_48_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_12_48_17&#39;)"><span class="hl_vardecl"><span class="mpre">haddr</span></span></a><span class="mpre">,</span><a name="loc_48_18_48_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_18_48_22&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre">) = case </span><a href="#loc_46_30_46_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_30_46_38&#39;)"><span class="hl_varref"><span class="mpre">sockaddr</span></span></a><span class="mpre"> of
                             </span><span class="hl_conref"><span class="mpre">SockAddrInet</span></span><span class="mpre"> </span><a name="loc_49_43_49_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_43_49_44&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_49_45_49_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_45_49_46&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">      -&gt; (</span><a href="Network.Socks5.Types.html#loc_54_7_54_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_54_7_54_20&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrIPV4</span></span></a><span class="mpre"> </span><a href="#loc_49_45_49_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_45_49_46&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">, </span><a href="#loc_49_43_49_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_43_49_44&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
                             </span><span class="hl_conref"><span class="mpre">SockAddrInet6</span></span><span class="mpre"> </span><a name="loc_50_44_50_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_44_50_45&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> _ </span><a name="loc_50_48_50_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_48_50_49&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> _ -&gt; (</span><a href="Network.Socks5.Types.html#loc_56_7_56_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_56_7_56_20&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrIPV6</span></span></a><span class="mpre"> </span><a href="#loc_50_48_50_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_48_50_49&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">, </span><a href="#loc_50_44_50_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_44_50_45&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
                             _                     -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unsupported unix sockaddr type&quot;</span></span><span class="mpre">
</span></div></body></html>