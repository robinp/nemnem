<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | This module contains an arrow interface for option parsers, which allows</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to define and combine parsers using the arrow notation and arrow</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- combinators.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The arrow syntax is particularly useful to create parsers of nested</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- structures, or records where the order of fields is different from the order</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in which the parsers should be applied.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For example, an &#39;Options.Applicative.Builder.arguments` parser often needs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to be applied last, and that makes it inconvenient to use it for a field</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which is not the last one in a record.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Using the arrow syntax and the functions in this module, one can write, e.g.:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; data Options = Options</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   { optArgs :: [String]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   , optVerbose :: Bool }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; opts :: Parser Options</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; opts = runA $ proc () -&gt; do</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   verbose &lt;- asA (switch (short &#39;v&#39;)) -&lt; ()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   args &lt;- asA (arguments str idm) -&lt; ()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   returnA -&lt; Options args verbose</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Parser arrows, created out of regular &#39;Parser&#39; values using the &#39;asA&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function, are arrows taking @()@ as argument and returning the parsed value.</span></span><span class="mpre">
module Options.Applicative.Arrows (
  module Control.Arrow,
  A(..),
  asA,
  runA,
  ParserA,
  ) where

import Control.Arrow
import Control.Category (</span><a href="Control.Category.html#loc_32_7_32_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Category.html#loc_32_7_32_15&#39;)"><span class="mpre">Category</span></a><span class="mpre">(..))

import Options.Applicative

import Prelude hiding ((.), id)

</span><span class="hl_comment"><span class="mpre">-- | For any &#39;Applicative&#39; functor @f@, @A f@ is the &#39;Arrow&#39; instance</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- associated to @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;A&#39; constructor can be used to convert a value of type @f (a -&gt; b)@ into</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an arrow.</span></span><span class="mpre">
newtype </span><a name="loc_47_9_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_10&#39;)"><span class="hl_tycondecl"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> = </span><a name="loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_condecl"><span class="mpre">A</span></span></a><span class="mpre">
  { </span><a name="loc_48_5_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_5_48_8&#39;)"><span class="hl_fielddecl"><span class="mpre">unA</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) }

</span><span class="hl_comment"><span class="mpre">-- | Convert a value of type @f a@ into an arrow taking @()@ as argument.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Applied to a value of type &#39;Parser&#39;, it turns it into an arrow that can be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- used inside an arrow command, or passed to arrow combinators.</span></span><span class="mpre">
</span><a href="#loc_55_1_55_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_4&#39;)"><span class="mpre">asA</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 8, srcSpanEndLine = 54, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 22, srcSpanEndLine = 54, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = "><span class="mpre">Applicative f =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_55_1_55_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_4&#39;)"><span class="hl_fundecl"><span class="mpre">asA</span></span></a><span class="mpre"> </span><a name="loc_55_5_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_5_55_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_55_5_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_5_55_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert an arrow back to an applicative value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function can be used to return a result of type &#39;Parser&#39; from an arrow</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- command.</span></span><span class="mpre">
</span><a href="#loc_62_1_62_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_5&#39;)"><span class="mpre">runA</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 9, srcSpanEndLine = 61, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 23, srcSpanEndLine = 61, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = "><span class="mpre">Applicative f =&gt;</span></span><span class="mpre"> </span><a href="#loc_47_9_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_62_1_62_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_5&#39;)"><span class="hl_fundecl"><span class="mpre">runA</span></span></a><span class="mpre"> </span><a name="loc_62_6_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_6_62_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_48_5_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_5_48_8&#39;)"><span class="hl_varref"><span class="mpre">unA</span></span></a><span class="mpre"> </span><a href="#loc_62_6_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_6_62_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_varref"><span class="mpre">pure</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 10, srcSpanEndLine = 64, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 24, srcSpanEndLine = 64, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">Applicative f =&gt;</span></span><span class="mpre"> </span><a href="Control.Category.html#loc_32_7_32_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Category.html#loc_32_7_32_15&#39;)"><span class="hl_classref"><span class="mpre">Category</span></span></a><span class="mpre"> (</span><a href="#loc_47_9_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre">) where
  </span><a href="Control.Category.html#loc_34_5_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Category.html#loc_34_5_34_7&#39;)"><span class="hl_vardecl"><span class="mpre">id</span></span></a><span class="mpre"> = </span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_varref"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a href="Control.Category.html#loc_34_5_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Category.html#loc_34_5_34_7&#39;)"><span class="hl_varref"><span class="mpre">id</span></span></a><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- use reverse composition, because we want effects to run from</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- top to bottom in the arrow syntax</span></span><span class="mpre">
  (</span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><a name="loc_68_6_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_6_68_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="Control.Category.html#loc_37_5_37_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Category.html#loc_37_5_37_8&#39;)"><span class="hl_fundecl"><span class="mpre">.</span></span></a><span class="mpre"> (</span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><a name="loc_68_14_68_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_14_68_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) = </span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Control.Category.html#loc_37_5_37_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Category.html#loc_37_5_37_8&#39;)"><span class="hl_varref"><span class="mpre">(.)</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_68_14_68_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_14_68_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_68_6_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_6_68_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 10, srcSpanEndLine = 70, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 24, srcSpanEndLine = 70, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">Applicative f =&gt;</span></span><span class="mpre"> </span><a href="Control.Arrow.html#loc_83_21_83_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_83_21_83_26&#39;)"><span class="hl_classref"><span class="mpre">Arrow</span></span></a><span class="mpre"> (</span><a href="#loc_47_9_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre">) where
  </span><a href="Control.Arrow.html#loc_86_5_86_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_86_5_86_8&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> = </span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><a href="Control.Category.html#loc_37_5_37_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Category.html#loc_37_5_37_8&#39;)"><span class="hl_infix"><span class="mpre">.</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_varref"><span class="mpre">pure</span></span></a><span class="mpre">
  </span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_fundecl"><span class="mpre">first</span></span></a><span class="mpre"> (</span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><a name="loc_72_12_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = </span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_72_12_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The type of arrows associated to the applicative &#39;Parser&#39; functor.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 1, srcSpanEndLine = 75, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-applicative-0.9.0/Options/Applicative/Arrows.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 1, srcSpanEndLine = 75, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/optparse-appli"><span class="mpre">type ParserA = A Parser</span></span><span class="mpre">
</span></div></body></html>