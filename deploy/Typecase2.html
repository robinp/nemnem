<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

module Typecase2 (tests) where

</span><span class="hl_comment"><span class="mpre">{-

This test provides a variation on typecase1.hs.
This time, we use generic show as defined for all instances of Data.
Thereby, we get rid of the Show constraint in our functions.
So we only keep a single constraint: the one for class Data.

-}</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase2.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 8, srcSpanEndLine = 14, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">

import Data.Generics
import Data.Maybe

</span><span class="hl_comment"><span class="mpre">-- Some datatype.</span></span><span class="mpre">
data </span><a name="loc_20_6_20_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_12&#39;)"><span class="hl_tycondecl"><span class="mpre">MyData</span></span></a><span class="mpre"> = </span><a name="loc_20_15_20_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_15_20_21&#39;)"><span class="hl_condecl"><span class="mpre">MyCons</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase2.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 29, srcSpanEndLine = 20, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase2.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 29, srcSpanEndLine = 20, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase2.hs&quot;, srcSpanStartLine = 20, srcSpanStartC"><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Some function that performs type case.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_26_1_26_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_2&#39;)"><span class="mpre">f</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase2.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 6, srcSpanEndLine = 25, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase2.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 13, srcSpanEndLine = 25, srcSpanEndColumn = 15}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase2.hs&quot;"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_26_1_26_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_2&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_26_3_26_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_3_26_4&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_46_3_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_3_46_9&#39;)"><span class="hl_varref"><span class="mpre">others</span></span></a><span class="mpre"> 
                      </span><a href="#loc_43_3_43_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_3_43_8&#39;)"><span class="hl_varref"><span class="mpre">mytys</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cast</span></span><span class="mpre"> </span><a href="#loc_26_3_26_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_3_26_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) )
                      </span><a href="#loc_39_3_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_3_39_8&#39;)"><span class="hl_varref"><span class="mpre">float</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cast</span></span><span class="mpre"> </span><a href="#loc_26_3_26_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_3_26_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) )
                      </span><a href="#loc_35_3_35_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_3_35_6&#39;)"><span class="hl_varref"><span class="mpre">int</span></span></a><span class="mpre">   (</span><span class="hl_varref"><span class="mpre">cast</span></span><span class="mpre"> </span><a href="#loc_26_3_26_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_3_26_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) )

 where

  </span><span class="hl_comment"><span class="mpre">-- do something with ints</span></span><span class="mpre">
  </span><a href="#loc_35_3_35_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_3_35_6&#39;)"><span class="mpre">int</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
  </span><a name="loc_35_3_35_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_3_35_6&#39;)"><span class="hl_fundecl"><span class="mpre">int</span></span></a><span class="mpre"> </span><a name="loc_35_7_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_8&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> =  </span><span class="hl_string"><span class="mpre">&quot;got an int, incremented: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_35_7_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_8&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
  
  </span><span class="hl_comment"><span class="mpre">-- do something with floats</span></span><span class="mpre">
  </span><a href="#loc_39_3_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_3_39_8&#39;)"><span class="mpre">float</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
  </span><a name="loc_39_3_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_3_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">float</span></span></a><span class="mpre"> </span><a name="loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;got a float, multiplied by .42: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.42</span></span><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- do something with my data</span></span><span class="mpre">
  </span><a href="#loc_43_3_43_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_3_43_8&#39;)"><span class="mpre">mytys</span></a><span class="mpre"> :: </span><a href="#loc_20_6_20_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_12&#39;)"><span class="hl_tyconref"><span class="mpre">MyData</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
  </span><a name="loc_43_3_43_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_3_43_8&#39;)"><span class="hl_fundecl"><span class="mpre">mytys</span></span></a><span class="mpre"> </span><a name="loc_43_9_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;got my data: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Data.Generics.Text.html#loc_43_1_43_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Text.html#loc_43_1_43_6&#39;)"><span class="hl_varref"><span class="mpre">gshow</span></span></a><span class="mpre"> </span><a href="#loc_43_9_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- do something with all other data</span></span><span class="mpre">
  </span><a name="loc_46_3_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_3_46_9&#39;)"><span class="hl_vardecl"><span class="mpre">others</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;got something else: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Data.Generics.Text.html#loc_43_1_43_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Text.html#loc_43_1_43_6&#39;)"><span class="hl_varref"><span class="mpre">gshow</span></span></a><span class="mpre"> </span><a href="#loc_26_3_26_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_3_26_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Test the type case</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a name="loc_52_1_52_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = ( </span><a href="#loc_26_1_26_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">41</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
        , </span><a href="#loc_26_1_26_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">88</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">)
        , </span><a href="#loc_26_1_26_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_20_15_20_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_15_20_21&#39;)"><span class="hl_conref"><span class="mpre">MyCons</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;42&quot;</span></span><span class="mpre">)
        , </span><a href="#loc_26_1_26_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">~=?</span></span><span class="mpre"> </span><a href="#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_7&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

</span><a name="loc_57_1_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_7&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = ( </span><span class="hl_string"><span class="mpre">&quot;got an int, incremented: 42&quot;</span></span><span class="mpre">
         , </span><span class="hl_string"><span class="mpre">&quot;got a float, multiplied by .42: 36.96&quot;</span></span><span class="mpre">
         , </span><span class="hl_string"><span class="mpre">&quot;got my data: (MyCons \&quot;42\&quot;)&quot;</span></span><span class="mpre">
         , </span><span class="hl_string"><span class="mpre">&quot;got something else: (True)&quot;</span></span><span class="mpre">)

</span></div></body></html>