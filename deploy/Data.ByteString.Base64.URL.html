<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
#if __GLASGOW_HASKELL__ &gt;= 702
{-# LANGUAGE Trustworthy #-}
#endif

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ByteString.Base64.URL</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2012 Deian Stefan</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : deian@cs.stanford.edu</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fast and efficient encoding and decoding of base64url-encoded strings.</span></span><span class="mpre">

module Data.ByteString.Base64.URL
    (
      encode
    , decode
    , decodeLenient
    , joinWith
    ) where

import Data.ByteString.Base64.Internal
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Data.ByteString.Internal (</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="mpre">ByteString</span></a><span class="mpre">(..))
import Data.Word (Word8)
import Foreign.ForeignPtr (ForeignPtr)

</span><span class="hl_comment"><span class="mpre">-- | Encode a string into base64url form.  The result will always be a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- multiple of 4 bytes in length.</span></span><span class="mpre">
</span><a href="#loc_34_1_34_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_7&#39;)"><span class="mpre">encode</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_34_1_34_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_7&#39;)"><span class="hl_vardecl"><span class="mpre">encode</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Base64.Internal.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Base64.Internal.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">encodeWith</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Base64.Internal.html#loc_101_1_101_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Base64.Internal.html#loc_101_1_101_14&#39;)"><span class="hl_varref"><span class="mpre">mkEncodeTable</span></span></a><span class="mpre"> </span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="hl_varref"><span class="mpre">alphabet</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Decode a base64url-encoded string.  This function strictly follows</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the specification in RFC 4648,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www.apps.ietf.org/rfc/rfc4648.html&gt;.</span></span><span class="mpre">
</span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="mpre">decode</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_vardecl"><span class="mpre">decode</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Base64.Internal.html#loc_153_1_153_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Base64.Internal.html#loc_153_1_153_16&#39;)"><span class="hl_varref"><span class="mpre">decodeWithTable</span></span></a><span class="mpre"> </span><a href="#loc_55_4_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_4_55_12&#39;)"><span class="hl_varref"><span class="mpre">decodeFP</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Decode a base64url-encoded string.  This function is lenient in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- following the specification from RFC 4648,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www.apps.ietf.org/rfc/rfc4648.html&gt;, and will not generate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parse errors no matter how poor its input.</span></span><span class="mpre">
</span><a href="#loc_47_1_47_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_14&#39;)"><span class="mpre">decodeLenient</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_47_1_47_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_14&#39;)"><span class="hl_vardecl"><span class="mpre">decodeLenient</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Base64.Internal.html#loc_207_1_207_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Base64.Internal.html#loc_207_1_207_23&#39;)"><span class="hl_varref"><span class="mpre">decodeLenientWithTable</span></span></a><span class="mpre"> </span><a href="#loc_55_4_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_4_55_12&#39;)"><span class="hl_varref"><span class="mpre">decodeFP</span></span></a><span class="mpre">


</span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="mpre">alphabet</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="hl_vardecl"><span class="mpre">alphabet</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 21, srcSpanEndLine = 51, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 21, srcSpanEndLine = 51, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-byte"><span class="mpre">[65..90]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 33, srcSpanEndLine = 51, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 33, srcSpanEndLine = 51, srcSpanEndColumn = 34},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-byte"><span class="mpre">[97..122]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 46, srcSpanEndLine = 51, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 46, srcSpanEndLine = 51, srcSpanEndColumn = 47},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-byte"><span class="mpre">[48..57]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><span class="hl_num"><span class="mpre">45</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">95</span></span><span class="mpre">]
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="mpre">alphabet</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_55_4_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_4_55_12&#39;)"><span class="mpre">decodeFP</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_55_4_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_4_55_12&#39;)"><span class="hl_vardecl"><span class="mpre">decodeFP</span></span></a><span class="mpre"> _ _ = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">45</span></span><span class="mpre"> </span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><span class="hl_num"><span class="mpre">62</span></span><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 58, srcSpanEndLine = 55, srcSpanEndColumn = 66}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 58, srcSpanEndLine = 55, srcSpanEndColumn = 59},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-byte"><span class="mpre">[52..61]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,
  </span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="Data.ByteString.Base64.Internal.html#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Base64.Internal.html#loc_261_1_261_5&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 20, srcSpanEndLine = 56, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 20, srcSpanEndLine = 56, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-byte"><span class="mpre">[0..25]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><span class="hl_num"><span class="mpre">63</span></span><span class="mpre">,</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 49, srcSpanEndLine = 56, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 49, srcSpanEndLine = 56, srcSpanEndColumn = 50},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-byte"><span class="mpre">[26..51]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">133</span></span><span class="mpre"> </span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_55_4_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_4_55_12&#39;)"><span class="mpre">decodeFP</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="mpre">x</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 6, srcSpanEndLine = 59, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/URL.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 17, srcSpanEndLine = 59, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/"><span class="mpre">Integral a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">255</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_60_1_60_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_2&#39;)"><span class="mpre">x</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>