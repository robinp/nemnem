<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, OverloadedStrings #-}
</span><span class="hl_comment"><span class="mpre">-- | This module handles building multipart/form-data. Example usage:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; {-# LANGUAGE OverloadedStrings #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; import Network</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; import Network.HTTP.Conduit</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; import Network.HTTP.Conduit.MultipartFormData</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; import Data.Text.Encoding as TE</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; import Control.Monad</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; main = withSocketsDo $ withManager $ \m -&gt; do</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     req1 &lt;- parseUrl &quot;http://random-cat-photo.net/cat.jpg&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     res &lt;- httpLbs req1 m</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     req2 &lt;- parseUrl &quot;http://example.org/~friedrich/blog/addPost.hs&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     flip httpLbs m =&lt;&lt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;         (formDataBody [partBS &quot;title&quot; &quot;Bleaurgh&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                       ,partBS &quot;text&quot; $ TE.encodeUtf8 &quot;矢田矢田矢田矢田矢田&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                       ,partFileSource &quot;file1&quot; &quot;/home/friedrich/Photos/MyLittlePony.jpg&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                       ,partFileRequestBody &quot;file2&quot; &quot;cat.jpg&quot; $ RequestBodyLBS $ responseBody res]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;             req2)</span></span><span class="mpre">
module Network.HTTP.Client.MultipartFormData
    (
    </span><span class="hl_comment"><span class="mpre">-- * Part type</span></span><span class="mpre">
     Part(..)
    </span><span class="hl_comment"><span class="mpre">-- * Constructing parts</span></span><span class="mpre">
    ,partBS
    ,partLBS
    ,partFile
    ,partFileSource
    ,partFileSourceChunked
    ,partFileRequestBody
    ,partFileRequestBodyM
    </span><span class="hl_comment"><span class="mpre">-- * Building form data</span></span><span class="mpre">
    ,formDataBody
    ,formDataBodyWithBoundary
    </span><span class="hl_comment"><span class="mpre">-- * Boundary</span></span><span class="mpre">
    ,webkitBoundary
    ,webkitBoundaryPure
    </span><span class="hl_comment"><span class="mpre">-- * Misc</span></span><span class="mpre">
    ,renderParts
    ,renderPart
    ) where

import Network.HTTP.Client
import Network.Mime
import Network.HTTP.Types (</span><a href="Network.HTTP.Types.Header.html#loc_71_1_71_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_71_1_71_13&#39;)"><span class="mpre">hContentType</span></a><span class="mpre">, </span><a href="Network.HTTP.Types.Method.html#loc_31_1_31_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Method.html#loc_31_1_31_11&#39;)"><span class="mpre">methodPost</span></a><span class="mpre">)
import Data.Monoid (</span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="mpre">(&lt;&gt;)</span></a><span class="mpre">)

import Blaze.ByteString.Builder

import Data.Text
import qualified Data.Text.Encoding as TE
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 18, srcSpanEndLine = 55, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as BL
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 18, srcSpanEndLine = 56, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as BS

import Control.Monad.Trans.State.Strict (</span><a href="Control.Monad.Trans.State.Strict.html#loc_85_1_85_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_85_1_85_6&#39;)"><span class="mpre">state</span></a><span class="mpre">, </span><a href="Control.Monad.Trans.State.Strict.html#loc_92_1_92_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_92_1_92_9&#39;)"><span class="mpre">runState</span></a><span class="mpre">)
import Control.Monad.IO.Class
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 60, srcSpanStartColumn = 8, srcSpanEndLine = 60, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;System.FilePath&quot;"><span class="mpre">System.FilePath</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 8, srcSpanEndLine = 61, srcSpanEndColumn = 21}, srcInfoPoints = []}) &quot;System.Random&quot;"><span class="mpre">System.Random</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 8, srcSpanEndLine = 62, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.Array.Base&quot;"><span class="mpre">Data.Array.Base</span></span><span class="mpre">
import System.IO
import Data.Bits
import Data.Word
import Data.Monoid (</span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="mpre">Monoid</span></a><span class="mpre">(..))
import Control.Monad
import Data.ByteString.Lazy.Internal (</span><a href="Data.ByteString.Lazy.Internal.html#loc_208_1_208_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_208_1_208_17&#39;)"><span class="mpre">defaultChunkSize</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | A single part of a multipart message.</span></span><span class="mpre">
data </span><a name="loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Part</span></span></a><span class="mpre"> = </span><a name="loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_condecl"><span class="mpre">Part</span></span></a><span class="mpre">
    { </span><a name="loc_72_7_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_15&#39;)"><span class="hl_fielddecl"><span class="mpre">partName</span></span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Name of the corresponding \&lt;input\&gt;</span></span><span class="mpre">
    , </span><a name="loc_73_7_73_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_7_73_19&#39;)"><span class="hl_fielddecl"><span class="mpre">partFilename</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ A file name, if this is an attached file</span></span><span class="mpre">
    , </span><a name="loc_74_7_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_22&#39;)"><span class="hl_fielddecl"><span class="mpre">partContentType</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">MimeType</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Content type</span></span><span class="mpre">
    , </span><a name="loc_75_7_75_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_18&#39;)"><span class="hl_fielddecl"><span class="mpre">partGetBody</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_180_6_180_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_180_6_180_17&#39;)"><span class="hl_tyconref"><span class="mpre">RequestBody</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Action in m which returns the body</span></span><span class="mpre">
                                   </span><span class="hl_comment"><span class="mpre">-- of a message.</span></span><span class="mpre">
    }

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><a name="loc_80_15_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_16&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> (</span><a href="#loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_conref"><span class="mpre">Part</span></span></a><span class="mpre"> </span><a name="loc_80_23_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_23_80_24&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_80_25_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_25_80_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_80_27_80_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_27_80_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> _) =
        </span><span class="hl_varref"><span class="mpre">showParen</span></span><span class="mpre"> (</span><a href="#loc_80_15_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_16&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Part &quot;</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre"> </span><a href="#loc_80_23_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_23_80_24&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre"> </span><a href="#loc_80_25_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_25_80_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre"> </span><a href="#loc_80_27_80_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_27_80_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;m (RequestBody m)&gt;&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Make a &#39;Part&#39; whose content is a strict &#39;BS.ByteString&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Part&#39; does not have a file name or content type associated</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with it.</span></span><span class="mpre">
</span><a href="#loc_97_1_97_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_7&#39;)"><span class="mpre">partBS</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ The body for this &#39;Part&#39;.</span></span><span class="mpre">
       -&gt; </span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">
</span><a name="loc_97_1_97_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_7&#39;)"><span class="hl_fundecl"><span class="mpre">partBS</span></span></a><span class="mpre"> </span><a name="loc_97_8_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_8_97_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_97_10_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_10_97_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_conref"><span class="mpre">Part</span></span></a><span class="mpre"> </span><a href="#loc_97_8_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_8_97_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RequestBodyBS</span></span><span class="mpre"> </span><a href="#loc_97_10_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_10_97_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Make a &#39;Part&#39; whose content is a lazy &#39;BL.ByteString&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Part&#39; does not have a file name or content type associated</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with it.</span></span><span class="mpre">
</span><a href="#loc_106_1_106_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_8&#39;)"><span class="mpre">partLBS</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">BL.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ The body for this &#39;Part&#39;.</span></span><span class="mpre">
        -&gt; </span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">
</span><a name="loc_106_1_106_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_8&#39;)"><span class="hl_fundecl"><span class="mpre">partLBS</span></span></a><span class="mpre"> </span><a name="loc_106_9_106_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_106_11_106_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_11_106_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_conref"><span class="mpre">Part</span></span></a><span class="mpre"> </span><a href="#loc_106_9_106_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RequestBodyLBS</span></span><span class="mpre"> </span><a href="#loc_106_11_106_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_11_106_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Make a &#39;Part&#39; from a file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The entire file will reside in memory at once.  If you want</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- constant memory usage, use &#39;partFileSource&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;FilePath&#39; supplied will be used as the file name of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Part&#39;. If you do not want to reveal this name to the server, you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- must remove it prior to uploading.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Part&#39; does not have a content type associated with it.</span></span><span class="mpre">
</span><a href="#loc_121_1_121_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_9&#39;)"><span class="mpre">partFile</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ The name of the local file to upload.</span></span><span class="mpre">
         -&gt; </span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">
</span><a name="loc_121_1_121_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_9&#39;)"><span class="hl_fundecl"><span class="mpre">partFile</span></span></a><span class="mpre"> </span><a name="loc_121_10_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_10_121_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
    </span><a href="#loc_187_1_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_21&#39;)"><span class="hl_varref"><span class="mpre">partFileRequestBodyM</span></span></a><span class="mpre"> </span><a href="#loc_121_10_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_10_121_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RequestBodyBS</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.IO.Class.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_34_5_34_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.readFile</span></span><span class="mpre"> </span><a href="#loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Stream a &#39;Part&#39; from a file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;FilePath&#39; supplied will be used as the file name of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Part&#39;. If you do not want to reveal this name to the server, you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- must remove it prior to uploading.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Part&#39; does not have a content type associated with it.</span></span><span class="mpre">
</span><a href="#loc_135_1_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_15&#39;)"><span class="mpre">partFileSource</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ The name of the local file to upload.</span></span><span class="mpre">
               -&gt; </span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">
</span><a name="loc_135_1_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_15&#39;)"><span class="hl_fundecl"><span class="mpre">partFileSource</span></span></a><span class="mpre"> </span><a name="loc_135_16_135_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_16_135_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_135_18_135_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_18_135_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
    </span><a href="#loc_187_1_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_21&#39;)"><span class="hl_varref"><span class="mpre">partFileRequestBodyM</span></span></a><span class="mpre"> </span><a href="#loc_135_16_135_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_16_135_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_135_18_135_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_18_135_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_34_5_34_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.html#loc_397_1_397_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_397_1_397_15&#39;)"><span class="hl_varref"><span class="mpre">withBinaryFile</span></span></a><span class="mpre"> </span><a href="#loc_135_18_135_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_18_135_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="hl_conref"><span class="mpre">ReadMode</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.html#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_113_1_113_10&#39;)"><span class="hl_varref"><span class="mpre">hFileSize</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RequestBodyStream</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_141_1_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_11&#39;)"><span class="hl_varref"><span class="mpre">streamFile</span></span></a><span class="mpre"> </span><a href="#loc_135_18_135_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_18_135_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><a href="#loc_141_1_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_11&#39;)"><span class="mpre">streamFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GivesPopper</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_141_1_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_11&#39;)"><span class="hl_fundecl"><span class="mpre">streamFile</span></span></a><span class="mpre"> </span><a name="loc_141_12_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_12_141_14&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_141_15_141_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_15_141_17&#39;)"><span class="hl_vardecl"><span class="mpre">np</span></span></a><span class="mpre"> =
    </span><a href="System.IO.html#loc_390_1_390_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_390_1_390_9&#39;)"><span class="hl_varref"><span class="mpre">withFile</span></span></a><span class="mpre"> </span><a href="#loc_141_12_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_12_141_14&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="hl_conref"><span class="mpre">ReadMode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_141_15_141_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_15_141_17&#39;)"><span class="hl_varref"><span class="mpre">np</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_144_5_144_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_5_144_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_144_5_144_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_5_144_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_144_8_144_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_8_144_9&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.hGetSome</span></span><span class="mpre"> </span><a href="#loc_144_8_144_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_8_144_9&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_208_1_208_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_208_1_208_17&#39;)"><span class="hl_varref"><span class="mpre">defaultChunkSize</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &#39;partFileSourceChunked&#39; will read a file and send it in chunks.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that not all servers support this. Only use &#39;partFileSourceChunked&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- if you know the server you&#39;re sending to supports chunked request bodies.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;FilePath&#39; supplied will be used as the file name of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Part&#39;. If you do not want to reveal this name to the server, you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- must remove it prior to uploading.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Part&#39; does not have a content type associated with it.</span></span><span class="mpre">
</span><a href="#loc_157_1_157_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_22&#39;)"><span class="mpre">partFileSourceChunked</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">
</span><a name="loc_157_1_157_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_22&#39;)"><span class="hl_fundecl"><span class="mpre">partFileSourceChunked</span></span></a><span class="mpre"> </span><a name="loc_157_23_157_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_23_157_24&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_157_25_157_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_25_157_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
    </span><a href="#loc_173_1_173_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_20&#39;)"><span class="hl_varref"><span class="mpre">partFileRequestBody</span></span></a><span class="mpre"> </span><a href="#loc_157_23_157_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_23_157_24&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_157_25_157_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_25_157_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><span class="hl_conref"><span class="mpre">RequestBodyStreamChunked</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_141_1_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_11&#39;)"><span class="hl_varref"><span class="mpre">streamFile</span></span></a><span class="mpre"> </span><a href="#loc_157_25_157_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_25_157_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Construct a &#39;Part&#39; from form name, filepath and a &#39;RequestBody&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; partFileRequestBody &quot;who_calls&quot; &quot;caller.json&quot; $ RequestBodyBS &quot;{\&quot;caller\&quot;:\&quot;Jason J Jason\&quot;}&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; -- empty upload form</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; partFileRequestBody &quot;file&quot; mempty mempty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Part&#39; does not have a content type associated with it.</span></span><span class="mpre">
</span><a href="#loc_173_1_173_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_20&#39;)"><span class="mpre">partFileRequestBody</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ File name to supply to the server.</span></span><span class="mpre">
                    -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_180_6_180_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_180_6_180_17&#39;)"><span class="hl_tyconref"><span class="mpre">RequestBody</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Data to upload.</span></span><span class="mpre">
                    -&gt; </span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">
</span><a name="loc_173_1_173_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_20&#39;)"><span class="hl_fundecl"><span class="mpre">partFileRequestBody</span></span></a><span class="mpre"> </span><a name="loc_173_21_173_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_21_173_22&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_173_23_173_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_23_173_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_173_25_173_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_25_173_28&#39;)"><span class="hl_vardecl"><span class="mpre">rqb</span></span></a><span class="mpre"> =
    </span><a href="#loc_187_1_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_21&#39;)"><span class="hl_varref"><span class="mpre">partFileRequestBodyM</span></span></a><span class="mpre"> </span><a href="#loc_173_21_173_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_21_173_22&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_173_23_173_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_23_173_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_173_25_173_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_25_173_28&#39;)"><span class="hl_varref"><span class="mpre">rqb</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Construct a &#39;Part&#39; from action returning the &#39;RequestBody&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; partFileRequestBodyM &quot;cat_photo&quot; &quot;haskell-the-cat.jpg&quot; $ do</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     size &lt;- fromInteger &lt;$&gt; withBinaryFile &quot;haskell-the-cat.jpg&quot; ReadMode hFileSize</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     return $ RequestBodySource size $ CB.sourceFile &quot;haskell-the-cat.jpg&quot; $= CL.map fromByteString</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Part&#39; does not have a content type associated with it.</span></span><span class="mpre">
</span><a href="#loc_187_1_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_21&#39;)"><span class="mpre">partFileRequestBodyM</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span class="mpre">
                     -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ File name to supply to the server.</span></span><span class="mpre">
                     -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_180_6_180_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_180_6_180_17&#39;)"><span class="hl_tyconref"><span class="mpre">RequestBody</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Action that will supply data to upload.</span></span><span class="mpre">
                     -&gt; </span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">
</span><a name="loc_187_1_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">partFileRequestBodyM</span></span></a><span class="mpre"> </span><a name="loc_187_22_187_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_22_187_23&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_187_24_187_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_24_187_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_187_26_187_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_26_187_29&#39;)"><span class="hl_vardecl"><span class="mpre">rqb</span></span></a><span class="mpre"> =
    </span><a href="#loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_conref"><span class="mpre">Part</span></span></a><span class="mpre"> </span><a href="#loc_187_22_187_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_22_187_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_187_24_187_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_24_187_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Mime.html#loc_50_1_50_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Mime.html#loc_50_1_50_18&#39;)"><span class="hl_varref"><span class="mpre">defaultMimeLookup</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_387_1_387_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_387_1_387_5&#39;)"><span class="hl_varref"><span class="mpre">pack</span></span></a><span class="mpre"> </span><a href="#loc_187_24_187_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_24_187_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_187_26_187_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_26_187_29&#39;)"><span class="hl_varref"><span class="mpre">rqb</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="mpre">cp</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="mpre">cp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_180_6_180_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_180_6_180_17&#39;)"><span class="hl_tyconref"><span class="mpre">RequestBody</span></span></a><span class="mpre">
</span><a name="loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_fundecl"><span class="mpre">cp</span></span></a><span class="mpre"> </span><a name="loc_192_4_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_4_192_6&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">RequestBodyBuilder</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.length</span></span><span class="mpre"> </span><a href="#loc_192_4_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_4_192_6&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">copyByteString</span></span></a><span class="mpre"> </span><a href="#loc_192_4_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_4_192_6&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_196_1_196_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_11&#39;)"><span class="mpre">renderPart</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Boundary between parts.</span></span><span class="mpre">
           -&gt; </span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_180_6_180_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_180_6_180_17&#39;)"><span class="hl_tyconref"><span class="mpre">RequestBody</span></span></a><span class="mpre">
</span><a name="loc_196_1_196_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_11&#39;)"><span class="hl_fundecl"><span class="mpre">renderPart</span></span></a><span class="mpre"> </span><a name="loc_196_12_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_12_196_20&#39;)"><span class="hl_vardecl"><span class="mpre">boundary</span></span></a><span class="mpre"> (</span><a href="#loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_conref"><span class="mpre">Part</span></span></a><span class="mpre"> </span><a name="loc_196_27_196_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_27_196_31&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_196_32_196_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_32_196_41&#39;)"><span class="hl_vardecl"><span class="mpre">mfilename</span></span></a><span class="mpre"> </span><a name="loc_196_42_196_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_42_196_54&#39;)"><span class="hl_vardecl"><span class="mpre">mcontenttype</span></span></a><span class="mpre"> </span><a name="loc_196_55_196_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_55_196_58&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre">) = </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><a href="#loc_197_9_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_15&#39;)"><span class="hl_varref"><span class="mpre">render</span></span></a><span class="mpre"> </span><a href="#loc_196_55_196_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_55_196_58&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">
  where </span><a name="loc_197_9_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_15&#39;)"><span class="hl_fundecl"><span class="mpre">render</span></span></a><span class="mpre"> </span><a name="loc_197_16_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_16_197_26&#39;)"><span class="hl_vardecl"><span class="mpre">renderBody</span></span></a><span class="mpre"> =
            </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><a href="#loc_196_12_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_12_196_20&#39;)"><span class="hl_varref"><span class="mpre">boundary</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">
         </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Disposition: form-data; name=\&quot;&quot;</span></span><span class="mpre">
         </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RequestBodyBS</span></span><span class="mpre"> (</span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">TE.encodeUtf8</span></span></a><span class="mpre"> </span><a href="#loc_196_27_196_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_27_196_31&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">)
         </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> (case </span><a href="#loc_196_32_196_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_32_196_41&#39;)"><span class="hl_varref"><span class="mpre">mfilename</span></span></a><span class="mpre"> of
                 </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_202_23_202_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_23_202_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\&quot;; filename=\&quot;&quot;</span></span><span class="mpre">
                        </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RequestBodyBS</span></span><span class="mpre"> (</span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">TE.encodeUtf8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_387_1_387_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_387_1_387_5&#39;)"><span class="hl_varref"><span class="mpre">pack</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">takeFileName</span></span><span class="mpre"> </span><a href="#loc_202_23_202_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_23_202_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
                 _ -&gt; </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)
         </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\&quot;&quot;</span></span><span class="mpre">
         </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> (case </span><a href="#loc_196_42_196_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_42_196_54&#39;)"><span class="hl_varref"><span class="mpre">mcontenttype</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_207_22_207_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_22_207_24&#39;)"><span class="hl_vardecl"><span class="mpre">ct</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">
                        </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Type: &quot;</span></span><span class="mpre">
                        </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><a href="#loc_207_22_207_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_22_207_24&#39;)"><span class="hl_varref"><span class="mpre">ct</span></span></a><span class="mpre">
                _ -&gt; </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)
         </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n\r\n&quot;</span></span><span class="mpre">
         </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_197_16_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_16_197_26&#39;)"><span class="hl_varref"><span class="mpre">renderBody</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Combine the &#39;Part&#39;s to form multipart/form-data body</span></span><span class="mpre">
</span><a href="#loc_217_1_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_12&#39;)"><span class="mpre">renderParts</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Boundary between parts.</span></span><span class="mpre">
            -&gt; [</span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_180_6_180_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_180_6_180_17&#39;)"><span class="hl_tyconref"><span class="mpre">RequestBody</span></span></a><span class="mpre">
</span><a name="loc_217_1_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_12&#39;)"><span class="hl_fundecl"><span class="mpre">renderParts</span></span></a><span class="mpre"> </span><a name="loc_217_13_217_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_13_217_21&#39;)"><span class="hl_vardecl"><span class="mpre">boundary</span></span></a><span class="mpre"> </span><a name="loc_217_22_217_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_22_217_27&#39;)"><span class="hl_vardecl"><span class="mpre">parts</span></span></a><span class="mpre"> = (</span><a href="#loc_218_9_218_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_12&#39;)"><span class="hl_varref"><span class="mpre">fin</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre">) </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_infix"><span class="mpre">`liftM`</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> (</span><a href="#loc_196_1_196_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_11&#39;)"><span class="hl_varref"><span class="mpre">renderPart</span></span></a><span class="mpre"> </span><a href="#loc_217_13_217_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_13_217_21&#39;)"><span class="hl_varref"><span class="mpre">boundary</span></span></a><span class="mpre">) </span><a href="#loc_217_22_217_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_22_217_27&#39;)"><span class="hl_varref"><span class="mpre">parts</span></span></a><span class="mpre">
  where </span><a name="loc_218_9_218_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_12&#39;)"><span class="hl_vardecl"><span class="mpre">fin</span></span></a><span class="mpre"> = (</span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><a href="#loc_217_13_217_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_13_217_21&#39;)"><span class="hl_varref"><span class="mpre">boundary</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_99_1_99_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_3&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;--\r\n&quot;</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Generate a boundary simillar to those generated by WebKit-based browsers.</span></span><span class="mpre">
</span><a href="#loc_222_1_222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_15&#39;)"><span class="mpre">webkitBoundary</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre">
</span><a name="loc_222_1_222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_15&#39;)"><span class="hl_vardecl"><span class="mpre">webkitBoundary</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">getStdRandom</span></span><span class="mpre"> </span><a href="#loc_225_1_225_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_19&#39;)"><span class="hl_varref"><span class="mpre">webkitBoundaryPure</span></span></a><span class="mpre">

</span><a href="#loc_225_1_225_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_19&#39;)"><span class="mpre">webkitBoundaryPure</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 224, srcSpanStartColumn = 23, srcSpanEndLine = 224, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 224, srcSpanStartColumn = 35, srcSpanEndLine = 224, srcSpanEndColumn = 37}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFi"><span class="mpre">RandomGen g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_225_1_225_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_19&#39;)"><span class="hl_fundecl"><span class="mpre">webkitBoundaryPure</span></span></a><span class="mpre"> </span><a name="loc_225_20_225_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_20_225_21&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = (</span><a href="Control.Monad.Trans.State.Strict.html#loc_92_1_92_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_92_1_92_9&#39;)"><span class="hl_infix"><span class="mpre">`runState`</span></span></a><span class="mpre"> </span><a href="#loc_225_20_225_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_20_225_21&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.append</span></span><span class="mpre"> </span><a href="#loc_233_5_233_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_5_233_11&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Prelude.concat</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_227_9_227_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_19&#39;)"><span class="hl_vardecl"><span class="mpre">randomness</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.State.Strict.html#loc_85_1_85_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_85_1_85_6&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">random</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_235_5_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_5_235_28&#39;)"><span class="hl_varref"><span class="mpre">alphaNumericEncodingMap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_227_9_227_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_19&#39;)"><span class="hl_varref"><span class="mpre">randomness</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">
               ,</span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_235_5_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_5_235_28&#39;)"><span class="hl_varref"><span class="mpre">alphaNumericEncodingMap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_227_9_227_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_19&#39;)"><span class="hl_varref"><span class="mpre">randomness</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">
               ,</span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_235_5_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_5_235_28&#39;)"><span class="hl_varref"><span class="mpre">alphaNumericEncodingMap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_227_9_227_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_19&#39;)"><span class="hl_varref"><span class="mpre">randomness</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">
               ,</span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_235_5_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_5_235_28&#39;)"><span class="hl_varref"><span class="mpre">alphaNumericEncodingMap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_227_9_227_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_19&#39;)"><span class="hl_varref"><span class="mpre">randomness</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">]
  where
    </span><a name="loc_233_5_233_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_5_233_11&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;----WebKitFormBoundary&quot;</span></span><span class="mpre">
    </span><a href="#loc_235_5_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_5_235_28&#39;)"><span class="mpre">alphaNumericEncodingMap</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">UArray</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
    </span><a name="loc_235_5_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_5_235_28&#39;)"><span class="hl_vardecl"><span class="mpre">alphaNumericEncodingMap</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">listArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">63</span></span><span class="mpre">)
        [</span><span class="hl_num"><span class="mpre">0x41</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x42</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x43</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x44</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x45</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x46</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x47</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x48</span></span><span class="mpre">,
         </span><span class="hl_num"><span class="mpre">0x49</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x4A</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x4B</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x4C</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x4D</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x4E</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x4F</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x50</span></span><span class="mpre">,
         </span><span class="hl_num"><span class="mpre">0x51</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x52</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x53</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x54</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x55</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x56</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x57</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x58</span></span><span class="mpre">,
         </span><span class="hl_num"><span class="mpre">0x59</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x5A</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x61</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x62</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x63</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x64</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x65</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x66</span></span><span class="mpre">,
         </span><span class="hl_num"><span class="mpre">0x67</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x68</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x69</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x6A</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x6B</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x6C</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x6D</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x6E</span></span><span class="mpre">,
         </span><span class="hl_num"><span class="mpre">0x6F</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x70</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x71</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x72</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x73</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x74</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x75</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x76</span></span><span class="mpre">,
         </span><span class="hl_num"><span class="mpre">0x77</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x78</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x79</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x7A</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x30</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x31</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x32</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x33</span></span><span class="mpre">,
         </span><span class="hl_num"><span class="mpre">0x34</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x35</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x36</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x37</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x38</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x39</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x41</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0x42</span></span><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | Add form data to the &#39;Request&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This sets a new &#39;requestBody&#39;, adds a content-type request header and changes the method to POST.</span></span><span class="mpre">
</span><a href="#loc_249_1_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_13&#39;)"><span class="mpre">formDataBody</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 248, srcSpanStartColumn = 17, srcSpanEndLine = 248, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 248, srcSpanStartColumn = 27, srcSpanEndLine = 248, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFi"><span class="mpre">MonadIO m =&gt;</span></span><span class="mpre"> [</span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">] -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre">
</span><a name="loc_249_1_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_13&#39;)"><span class="hl_fundecl"><span class="mpre">formDataBody</span></span></a><span class="mpre"> </span><a name="loc_249_14_249_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_249_16_249_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_16_249_17&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="Control.Monad.IO.Class.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_34_5_34_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_250_5_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_5_250_13&#39;)"><span class="hl_vardecl"><span class="mpre">boundary</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_222_1_222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_15&#39;)"><span class="hl_varref"><span class="mpre">webkitBoundary</span></span></a><span class="mpre">
    </span><a href="#loc_255_1_255_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_25&#39;)"><span class="hl_varref"><span class="mpre">formDataBodyWithBoundary</span></span></a><span class="mpre"> </span><a href="#loc_250_5_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_5_250_13&#39;)"><span class="hl_varref"><span class="mpre">boundary</span></span></a><span class="mpre"> </span><a href="#loc_249_14_249_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_249_16_249_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_16_249_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Add form data with supplied boundary</span></span><span class="mpre">
</span><a href="#loc_255_1_255_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_25&#39;)"><span class="mpre">formDataBodyWithBoundary</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> -&gt; [</span><a href="#loc_71_6_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_10&#39;)"><span class="hl_tyconref"><span class="mpre">Part</span></span></a><span class="mpre">] -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre">
</span><a name="loc_255_1_255_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_25&#39;)"><span class="hl_fundecl"><span class="mpre">formDataBodyWithBoundary</span></span></a><span class="mpre"> </span><a name="loc_255_26_255_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_26_255_34&#39;)"><span class="hl_vardecl"><span class="mpre">boundary</span></span></a><span class="mpre"> </span><a name="loc_255_35_255_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_35_255_40&#39;)"><span class="hl_vardecl"><span class="mpre">parts</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">req</span></span><span class="mpre"> = do
    </span><span class="hl_vardecl"><span class="mpre">body</span></span><span class="mpre"> &lt;- </span><a href="#loc_217_1_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_12&#39;)"><span class="hl_varref"><span class="mpre">renderParts</span></span></a><span class="mpre"> </span><a href="#loc_255_26_255_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_26_255_34&#39;)"><span class="hl_varref"><span class="mpre">boundary</span></span></a><span class="mpre"> </span><a href="#loc_255_35_255_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_35_255_40&#39;)"><span class="hl_varref"><span class="mpre">parts</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 257, srcSpanStartColumn = 14, srcSpanEndLine = 263, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/MultipartFormData.hs&quot;, srcSpanStartLine = 258, srcSpanStartColumn = 9, srcSpanEndLine = 258, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/htt"><span class="mpre">req
        { method = methodPost
        , requestHeaders =
            (hContentType, &quot;multipart/form-data; boundary=&quot; &lt;&gt; boundary)
          : Prelude.filter (\(x, _) -&gt; x /= hContentType) (requestHeaders req)
        , requestBody = body
        }</span></span><span class="mpre">
</span></div></body></html>