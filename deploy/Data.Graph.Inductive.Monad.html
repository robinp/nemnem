<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE MultiParamTypeClasses #-}

</span><span class="hl_comment"><span class="mpre">-- (c) 2002 by Martin Erwig [see file COPYRIGHT]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Monadic Graphs</span></span><span class="mpre">
module Data.Graph.Inductive.Monad(
    </span><span class="hl_comment"><span class="mpre">-- * Classes</span></span><span class="mpre">
    GraphM(..),
    </span><span class="hl_comment"><span class="mpre">-- * Operations</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** Graph Folds and Maps</span></span><span class="mpre">
    ufoldM,
    </span><span class="hl_comment"><span class="mpre">-- ** Graph Projection</span></span><span class="mpre">
    nodesM,edgesM,newNodesM,
    </span><span class="hl_comment"><span class="mpre">-- ** Graph Construction and Destruction</span></span><span class="mpre">
    delNodeM,delNodesM,
    mkUGraphM,
    </span><span class="hl_comment"><span class="mpre">-- ** Graph Inspection</span></span><span class="mpre">
    contextM,labM
) where


import Data.Graph.Inductive.Graph


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- MONADIC GRAPH CLASS</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Currently, we define just one monadic graph class:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   GraphM:    static, decomposable graphs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--              static means that a graph itself cannot be changed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Later we might also define DynGraphM for dynamic, extensible graphs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- Monadic Graph</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 7, srcSpanEndLine = 41, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 15, srcSpanEndLine = 41, srcSpanEndColumn = 17}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a name="loc_41_18_41_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_18_41_24&#39;)"><span class="hl_classdecl"><span class="mpre">GraphM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> where
  </span><span class="hl_comment"><span class="mpre">-- essential operations</span></span><span class="mpre">
  </span><a name="loc_43_3_43_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_3_43_9&#39;)"><span class="mpre">emptyM</span></a><span class="mpre">     :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
  </span><a name="loc_44_3_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_3_44_11&#39;)"><span class="mpre">isEmptyM</span></a><span class="mpre">   :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
  </span><a name="loc_45_3_45_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_3_45_9&#39;)"><span class="mpre">matchM</span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Decomp</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
  </span><a name="loc_46_3_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_3_46_11&#39;)"><span class="mpre">mkGraphM</span></a><span class="mpre">   :: [</span><span class="hl_tyconref"><span class="mpre">LNode</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">LEdge</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
  </span><a name="loc_47_3_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_3_47_12&#39;)"><span class="mpre">labNodesM</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">LNode</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
  </span><span class="hl_comment"><span class="mpre">-- derived operations</span></span><span class="mpre">
  </span><a name="loc_49_3_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_3_49_12&#39;)"><span class="mpre">matchAnyM</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GDecomp</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
  </span><a name="loc_50_3_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_3_50_11&#39;)"><span class="mpre">noNodesM</span></a><span class="mpre">   :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><a name="loc_51_3_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_3_51_13&#39;)"><span class="mpre">nodeRangeM</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">)
  </span><a name="loc_52_3_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_3_52_12&#39;)"><span class="mpre">labEdgesM</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">LEdge</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">]
  </span><span class="hl_comment"><span class="mpre">-- default implementation of derived operations</span></span><span class="mpre">
  </span><a href="#loc_49_3_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_3_49_12&#39;)"><span class="hl_fundecl"><span class="mpre">matchAnyM</span></span></a><span class="mpre"> </span><a name="loc_54_13_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = do </span><a name="loc_54_20_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_22&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_47_3_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_3_47_12&#39;)"><span class="hl_varref"><span class="mpre">labNodesM</span></span></a><span class="mpre"> </span><a href="#loc_54_13_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                   case </span><a href="#loc_54_20_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_22&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> of
                     []      -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Match Exception, Empty Graph&quot;</span></span><span class="mpre">
                     (</span><a name="loc_57_23_57_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_23_57_24&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; do (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_57_42_57_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_42_57_43&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_57_44_57_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_44_57_46&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_45_3_45_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_3_45_9&#39;)"><span class="hl_varref"><span class="mpre">matchM</span></span></a><span class="mpre"> </span><a href="#loc_57_23_57_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_23_57_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_54_13_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                                   </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_57_42_57_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_42_57_43&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">,</span><a href="#loc_57_44_57_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_44_57_46&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">)
  </span><a href="#loc_50_3_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_3_50_11&#39;)"><span class="hl_vardecl"><span class="mpre">noNodesM</span></span></a><span class="mpre"> = </span><a href="#loc_47_3_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_3_47_12&#39;)"><span class="hl_varref"><span class="mpre">labNodesM</span></span></a><span class="mpre"> </span><a href="#loc_71_3_71_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_3_71_6&#39;)"><span class="hl_infix"><span class="mpre">&gt;&gt;.</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre">
  </span><a href="#loc_51_3_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_3_51_13&#39;)"><span class="hl_fundecl"><span class="mpre">nodeRangeM</span></span></a><span class="mpre"> </span><a name="loc_60_14_60_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_14_60_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = do </span><a name="loc_60_21_60_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_23&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_47_3_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_3_47_12&#39;)"><span class="hl_varref"><span class="mpre">labNodesM</span></span></a><span class="mpre"> </span><a href="#loc_60_14_60_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_14_60_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                    let </span><a name="loc_61_25_61_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_25_61_28&#39;)"><span class="hl_vardecl"><span class="mpre">vs&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_60_21_60_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_23&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">minimum</span></span><span class="mpre"> </span><a href="#loc_61_25_61_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_25_61_28&#39;)"><span class="hl_varref"><span class="mpre">vs&#39;</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">maximum</span></span><span class="mpre"> </span><a href="#loc_61_25_61_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_25_61_28&#39;)"><span class="hl_varref"><span class="mpre">vs&#39;</span></span></a><span class="mpre">)
  </span><a href="#loc_52_3_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_3_52_12&#39;)"><span class="hl_vardecl"><span class="mpre">labEdgesM</span></span></a><span class="mpre"> = </span><a href="#loc_83_1_83_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_7&#39;)"><span class="hl_varref"><span class="mpre">ufoldM</span></span></a><span class="mpre"> (\(</span><a name="loc_63_25_63_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_25_63_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_63_27_63_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_28&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_,</span><a name="loc_63_31_63_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_31_63_32&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)-&gt;(((</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_65_21_65_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_21_65_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_63_27_63_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_28&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><a href="#loc_63_25_63_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_25_63_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">(</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_64_21_64_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_21_64_22&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_63_27_63_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_28&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><a href="#loc_63_31_63_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_31_63_32&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))</span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">)) []
              where </span><a name="loc_64_21_64_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_21_64_22&#39;)"><span class="hl_fundecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_64_23_64_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_23_64_24&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = \(</span><a name="loc_64_29_64_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_29_64_30&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_64_31_64_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_31_64_32&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_64_23_64_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_23_64_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_64_31_64_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_31_64_32&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">,</span><a href="#loc_64_29_64_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_29_64_30&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
                    </span><a name="loc_65_21_65_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_21_65_22&#39;)"><span class="hl_fundecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = \(</span><a name="loc_65_29_65_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_29_65_30&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_65_31_65_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_31_65_32&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_65_31_65_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_31_65_32&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">,</span><a href="#loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_65_29_65_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_29_65_30&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- composing a monadic function with a non-monadic one</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_71_3_71_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_3_71_6&#39;)"><span class="mpre">(&gt;&gt;.)</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 10, srcSpanEndLine = 70, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 18, srcSpanEndLine = 70, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
</span><a name="loc_71_1_71_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_2&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_71_3_71_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_3_71_6&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;.</span></span></a><span class="mpre"> </span><a name="loc_71_7_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_8&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = (</span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_71_7_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_71_1_71_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- DERIVED GRAPH OPERATIONS</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- graph folds and maps</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | graph fold</span></span><span class="mpre">
</span><a href="#loc_83_1_83_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_7&#39;)"><span class="mpre">ufoldM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 11, srcSpanEndLine = 82, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 23, srcSpanEndLine = 82, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> ((</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
</span><a name="loc_83_1_83_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_7&#39;)"><span class="hl_fundecl"><span class="mpre">ufoldM</span></span></a><span class="mpre"> </span><a name="loc_83_8_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_8_83_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_83_12_83_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_12_83_13&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = do </span><a name="loc_83_19_83_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_19_83_20&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_44_3_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_3_44_11&#39;)"><span class="hl_varref"><span class="mpre">isEmptyM</span></span></a><span class="mpre"> </span><a href="#loc_83_12_83_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_12_83_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                  if </span><a href="#loc_83_19_83_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_19_83_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">
                       else do (</span><a name="loc_85_33_85_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_33_85_34&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_85_35_85_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_35_85_37&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_49_3_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_3_49_12&#39;)"><span class="hl_varref"><span class="mpre">matchAnyM</span></span></a><span class="mpre"> </span><a href="#loc_83_12_83_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_12_83_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                               </span><a name="loc_86_32_86_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_32_86_33&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_83_1_83_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_7&#39;)"><span class="hl_varref"><span class="mpre">ufoldM</span></span></a><span class="mpre"> </span><a href="#loc_83_8_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_8_83_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_85_35_85_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_35_85_37&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">)
                               </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_83_8_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_8_83_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_85_33_85_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_33_85_34&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_86_32_86_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_32_86_33&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- (additional) graph projection</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [noNodes, nodeRange, labNodes, labEdges are defined in class Graph]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_94_1_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_7&#39;)"><span class="mpre">nodesM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 11, srcSpanEndLine = 93, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 23, srcSpanEndLine = 93, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_94_1_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_7&#39;)"><span class="hl_vardecl"><span class="mpre">nodesM</span></span></a><span class="mpre"> = </span><a href="#loc_47_3_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_3_47_12&#39;)"><span class="hl_varref"><span class="mpre">labNodesM</span></span></a><span class="mpre"> </span><a href="#loc_71_3_71_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_3_71_6&#39;)"><span class="hl_infix"><span class="mpre">&gt;&gt;.</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">

</span><a href="#loc_97_1_97_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_7&#39;)"><span class="mpre">edgesM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 11, srcSpanEndLine = 96, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 23, srcSpanEndLine = 96, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre">]
</span><a name="loc_97_1_97_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_7&#39;)"><span class="hl_vardecl"><span class="mpre">edgesM</span></span></a><span class="mpre"> =  </span><a href="#loc_52_3_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_3_52_12&#39;)"><span class="hl_varref"><span class="mpre">labEdgesM</span></span></a><span class="mpre"> </span><a href="#loc_71_3_71_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_3_71_6&#39;)"><span class="hl_infix"><span class="mpre">&gt;&gt;.</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_97_32_97_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_32_97_33&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_97_34_97_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_34_97_35&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">,_)-&gt;(</span><a href="#loc_97_32_97_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_32_97_33&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_97_34_97_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_34_97_35&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">))

</span><a href="#loc_100_1_100_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_10&#39;)"><span class="mpre">newNodesM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 14, srcSpanEndLine = 99, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 26, srcSpanEndLine = 99, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_100_1_100_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_10&#39;)"><span class="hl_fundecl"><span class="mpre">newNodesM</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">i</span></span><span class="mpre"> </span><a name="loc_100_13_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = do (_,</span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre">) &lt;- </span><a href="#loc_51_3_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_3_51_13&#39;)"><span class="hl_varref"><span class="mpre">nodeRangeM</span></span></a><span class="mpre"> </span><a href="#loc_100_13_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                   </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 27, srcSpanEndLine = 101, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 27, srcSpanEndLine = 101, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Mo"><span class="mpre">[n+1..n+i]</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- graph construction &amp; destruction</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_107_1_107_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_9&#39;)"><span class="mpre">delNodeM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 13, srcSpanEndLine = 106, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 25, srcSpanEndLine = 106, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_107_1_107_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_9&#39;)"><span class="hl_fundecl"><span class="mpre">delNodeM</span></span></a><span class="mpre"> </span><a name="loc_107_10_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_10_107_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_110_1_110_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_10&#39;)"><span class="hl_varref"><span class="mpre">delNodesM</span></span></a><span class="mpre"> [</span><a href="#loc_107_10_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_10_107_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">]

</span><a href="#loc_110_1_110_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_10&#39;)"><span class="mpre">delNodesM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 109, srcSpanStartColumn = 14, srcSpanEndLine = 109, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 109, srcSpanStartColumn = 26, srcSpanEndLine = 109, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_110_1_110_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_10&#39;)"><span class="hl_fundecl"><span class="mpre">delNodesM</span></span></a><span class="mpre"> []     </span><a name="loc_110_18_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_19&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_110_18_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
</span><a href="#loc_110_1_110_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_10&#39;)"><span class="hl_fundecl"><span class="mpre">delNodesM</span></span></a><span class="mpre"> (</span><a name="loc_111_12_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_13&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_111_14_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_14_111_16&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">) </span><a name="loc_111_18_111_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_18_111_19&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = do (_,</span><a name="loc_111_28_111_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_28_111_30&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_45_3_45_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_3_45_9&#39;)"><span class="hl_varref"><span class="mpre">matchM</span></span></a><span class="mpre"> </span><a href="#loc_111_12_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_111_18_111_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_18_111_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                        </span><a href="#loc_110_1_110_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_10&#39;)"><span class="hl_varref"><span class="mpre">delNodesM</span></span></a><span class="mpre"> </span><a href="#loc_111_14_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_14_111_16&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_111_28_111_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_28_111_30&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">)

</span><a href="#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_10&#39;)"><span class="mpre">mkUGraphM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 114, srcSpanStartColumn = 14, srcSpanEndLine = 114, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 114, srcSpanStartColumn = 26, srcSpanEndLine = 114, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
</span><a name="loc_115_1_115_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_10&#39;)"><span class="hl_fundecl"><span class="mpre">mkUGraphM</span></span></a><span class="mpre"> </span><a name="loc_115_11_115_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_11_115_13&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> </span><a name="loc_115_14_115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_14_115_16&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre"> = </span><a href="#loc_46_3_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_3_46_11&#39;)"><span class="hl_varref"><span class="mpre">mkGraphM</span></span></a><span class="mpre"> (</span><a href="#loc_118_1_118_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_10&#39;)"><span class="hl_varref"><span class="mpre">labUNodes</span></span></a><span class="mpre"> </span><a href="#loc_115_11_115_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_11_115_13&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">) (</span><a href="#loc_117_1_117_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_10&#39;)"><span class="hl_varref"><span class="mpre">labUEdges</span></span></a><span class="mpre"> </span><a href="#loc_115_14_115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_14_115_16&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)

</span><a name="loc_117_1_117_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_10&#39;)"><span class="hl_vardecl"><span class="mpre">labUEdges</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_117_20_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_20_117_21&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_117_22_117_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_22_117_23&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_117_20_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_20_117_21&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_117_22_117_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_22_117_23&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">))
</span><a name="loc_118_1_118_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">labUNodes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_118_19_118_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_19_118_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">-&gt;(</span><a href="#loc_118_19_118_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_19_118_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">))


</span><span class="hl_comment"><span class="mpre">-- graph inspection (for a particular node)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_124_1_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_8&#39;)"><span class="mpre">onMatch</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 123, srcSpanStartColumn = 12, srcSpanEndLine = 123, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 123, srcSpanStartColumn = 24, srcSpanEndLine = 123, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
</span><a name="loc_124_1_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_8&#39;)"><span class="hl_fundecl"><span class="mpre">onMatch</span></span></a><span class="mpre"> </span><a name="loc_124_9_124_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_9_124_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_124_11_124_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_11_124_12&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_124_13_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_13_124_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_124_15_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_15_124_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = do (</span><a name="loc_124_23_124_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_23_124_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,_) &lt;- </span><a href="#loc_45_3_45_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_3_45_9&#39;)"><span class="hl_varref"><span class="mpre">matchM</span></span></a><span class="mpre"> </span><a href="#loc_124_15_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_15_124_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_124_13_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_13_124_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (case </span><a href="#loc_124_23_124_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_23_124_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of {</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_124_11_124_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_11_124_12&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_125_60_125_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_60_125_61&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_124_9_124_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_9_124_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_125_60_125_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_60_125_61&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">})

</span><a href="#loc_128_1_128_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_9&#39;)"><span class="mpre">contextM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 127, srcSpanStartColumn = 13, srcSpanEndLine = 127, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 127, srcSpanStartColumn = 25, srcSpanEndLine = 127, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_128_1_128_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_9&#39;)"><span class="hl_fundecl"><span class="mpre">contextM</span></span></a><span class="mpre"> </span><a name="loc_128_10_128_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_10_128_11&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_128_12_128_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_12_128_13&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_124_1_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_8&#39;)"><span class="hl_varref"><span class="mpre">onMatch</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Match Exception, Node: &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_128_12_128_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_12_128_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)) </span><a href="#loc_128_10_128_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_10_128_11&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_128_12_128_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_12_128_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><a href="#loc_131_1_131_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_5&#39;)"><span class="mpre">labM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 9, srcSpanEndLine = 130, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 21, srcSpanEndLine = 130, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_131_1_131_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_5&#39;)"><span class="hl_vardecl"><span class="mpre">labM</span></span></a><span class="mpre"> = </span><a href="#loc_124_1_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_8&#39;)"><span class="hl_varref"><span class="mpre">onMatch</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_359_1_359_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_359_1_359_5&#39;)"><span class="hl_varref"><span class="mpre">lab&#39;</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
neighbors :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; [Node]
neighbors = (\(p,_,_,s) -&gt; map snd (p++s)) .: context

suc :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; [Node]
suc = map snd .: context4

pre :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; [Node]
pre = map snd .: context1

lsuc :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; [(Node,b)]
lsuc = map flip2 .: context4

lpre :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; [(Node,b)]
lpre = map flip2 .: context1

out :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; [LEdge b]
out g v = map (\(l,w)-&gt;(v,w,l)) (context4 g v)

inn :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; [LEdge b]
inn g v = map (\(l,w)-&gt;(w,v,l)) (context1 g v)

outdeg :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; Int
outdeg = length .: context4

indeg :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; Int
indeg  = length .: context1

deg :: GraphM m gr =&gt; m (gr a b) -&gt; Node -&gt; Int
deg = (\(p,_,_,s) -&gt; length p+length s) .: context
--

-- -- context inspection
-- --
-- node&#39; :: Context a b -&gt; Node
-- node&#39; (_,v,_,_) = v
--
-- lab&#39; :: Context a b -&gt; a
-- lab&#39; (_,_,l,_) = l
--
-- labNode&#39; :: Context a b -&gt; LNode a
-- labNode&#39; (_,v,l,_) = (v,l)
--
-- neighbors&#39; :: Context a b -&gt; [Node]
-- neighbors&#39; (p,_,_,s) = map snd p++map snd s
--
-- suc&#39; :: Context a b -&gt; [Node]
-- suc&#39; (_,_,_,s) = map snd s
--
-- pre&#39; :: Context a b -&gt; [Node]
-- pre&#39; (p,_,_,_) = map snd p
--
-- lpre&#39; :: Context a b -&gt; [(Node,b)]
-- lpre&#39; (p,_,_,_) = map flip2 p
--
-- lsuc&#39; :: Context a b -&gt; [(Node,b)]
-- lsuc&#39; (_,_,_,s) = map flip2 s
--
-- out&#39; :: Context a b -&gt; [LEdge b]
-- out&#39; (_,v,_,s) = map (\(l,w)-&gt;(v,w,l)) s
--
-- inn&#39; :: Context a b -&gt; [LEdge b]
-- inn&#39; (p,v,_,_) = map (\(l,w)-&gt;(w,v,l)) p
--
-- outdeg&#39; :: Context a b -&gt; Int
-- outdeg&#39; (_,_,_,s) = length s
--
-- indeg&#39; :: Context a b -&gt; Int
-- indeg&#39; (p,_,_,_) = length p
--
-- deg&#39; :: Context a b -&gt; Int
-- deg&#39; (p,_,_,s) = length p+length s


-- graph equality
--
nodeComp :: Eq b =&gt; LNode b -&gt; LNode b -&gt; Ordering
nodeComp n@(v,a) n&#39;@(w,b) | n == n&#39;   = EQ
                          | v&lt;w       = LT
                          | otherwise = GT

slabNodes :: (Eq a,Graph gr) =&gt; m (gr a b) -&gt; [LNode a]
slabNodes = sortBy nodeComp . labNodes

edgeComp :: Eq b =&gt; LEdge b -&gt; LEdge b -&gt; Ordering
edgeComp e@(v,w,a) e&#39;@(x,y,b) | e == e&#39;              = EQ
                              | v&lt;x || (v==x &amp;&amp; w&lt;y) = LT
                              | otherwise            = GT

slabEdges :: (Eq b,Graph gr) =&gt; m (gr a b) -&gt; [LEdge b]
slabEdges = sortBy edgeComp . labEdges

instance (Eq a,Eq b,Graph gr) =&gt; Eq (m (gr a b)) where
  g == g&#39; = slabNodes g == slabNodes g&#39; &amp;&amp; slabEdges g == slabEdges g&#39;


-}</span></span><span class="mpre">
</span></div></body></html>