<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Distribution.Compat.ReadP</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow 2002</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a library of parser combinators, originally written by Koen Claessen.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It parses all alternatives in parallel, so it never keeps hold of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the beginning of the input string, a common source of space leaks with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- other parsers.  The &#39;(+++)&#39; choice combinator is genuinely commutative;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it makes no difference which branch is \&quot;shorter\&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See also Koen&#39;s paper /Parallel Parsing Processes/</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&lt;http://www.cs.chalmers.se/~koen/publications.html&gt;).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This version of ReadP has been locally hacked to make it H98, by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Martin Sj&amp;#xF6;gren &lt;mailto:msjogren@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The unit tests have been moved to UnitTest.Distribution.Compat.ReadP, by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Mark Lentczner &lt;mailto:mark@glyphic.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Distribution.Compat.ReadP
  (
  </span><span class="hl_comment"><span class="mpre">-- * The &#39;ReadP&#39; type</span></span><span class="mpre">
  ReadP,      </span><span class="hl_comment"><span class="mpre">-- :: * -&gt; *; instance Functor, Monad, MonadPlus</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- * Primitive operations</span></span><span class="mpre">
  get,        </span><span class="hl_comment"><span class="mpre">-- :: ReadP Char</span></span><span class="mpre">
  look,       </span><span class="hl_comment"><span class="mpre">-- :: ReadP String</span></span><span class="mpre">
  (+++),      </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP a -&gt; ReadP a</span></span><span class="mpre">
  (&lt;++),      </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP a -&gt; ReadP a</span></span><span class="mpre">
  gather,     </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP (String, a)</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- * Other operations</span></span><span class="mpre">
  pfail,      </span><span class="hl_comment"><span class="mpre">-- :: ReadP a</span></span><span class="mpre">
  satisfy,    </span><span class="hl_comment"><span class="mpre">-- :: (Char -&gt; Bool) -&gt; ReadP Char</span></span><span class="mpre">
  char,       </span><span class="hl_comment"><span class="mpre">-- :: Char -&gt; ReadP Char</span></span><span class="mpre">
  string,     </span><span class="hl_comment"><span class="mpre">-- :: String -&gt; ReadP String</span></span><span class="mpre">
  munch,      </span><span class="hl_comment"><span class="mpre">-- :: (Char -&gt; Bool) -&gt; ReadP String</span></span><span class="mpre">
  munch1,     </span><span class="hl_comment"><span class="mpre">-- :: (Char -&gt; Bool) -&gt; ReadP String</span></span><span class="mpre">
  skipSpaces, </span><span class="hl_comment"><span class="mpre">-- :: ReadP ()</span></span><span class="mpre">
  choice,     </span><span class="hl_comment"><span class="mpre">-- :: [ReadP a] -&gt; ReadP a</span></span><span class="mpre">
  count,      </span><span class="hl_comment"><span class="mpre">-- :: Int -&gt; ReadP a -&gt; ReadP [a]</span></span><span class="mpre">
  between,    </span><span class="hl_comment"><span class="mpre">-- :: ReadP open -&gt; ReadP close -&gt; ReadP a -&gt; ReadP a</span></span><span class="mpre">
  option,     </span><span class="hl_comment"><span class="mpre">-- :: a -&gt; ReadP a -&gt; ReadP a</span></span><span class="mpre">
  optional,   </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP ()</span></span><span class="mpre">
  many,       </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP [a]</span></span><span class="mpre">
  many1,      </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP [a]</span></span><span class="mpre">
  skipMany,   </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP ()</span></span><span class="mpre">
  skipMany1,  </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP ()</span></span><span class="mpre">
  sepBy,      </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP sep -&gt; ReadP [a]</span></span><span class="mpre">
  sepBy1,     </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP sep -&gt; ReadP [a]</span></span><span class="mpre">
  endBy,      </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP sep -&gt; ReadP [a]</span></span><span class="mpre">
  endBy1,     </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP sep -&gt; ReadP [a]</span></span><span class="mpre">
  chainr,     </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP (a -&gt; a -&gt; a) -&gt; a -&gt; ReadP a</span></span><span class="mpre">
  chainl,     </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP (a -&gt; a -&gt; a) -&gt; a -&gt; ReadP a</span></span><span class="mpre">
  chainl1,    </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP (a -&gt; a -&gt; a) -&gt; ReadP a</span></span><span class="mpre">
  chainr1,    </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP (a -&gt; a -&gt; a) -&gt; ReadP a</span></span><span class="mpre">
  manyTill,   </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadP end -&gt; ReadP [a]</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- * Running a parser</span></span><span class="mpre">
  ReadS,      </span><span class="hl_comment"><span class="mpre">-- :: *; = String -&gt; [(a,String)]</span></span><span class="mpre">
  readP_to_S, </span><span class="hl_comment"><span class="mpre">-- :: ReadP a -&gt; ReadS a</span></span><span class="mpre">
  readS_to_P  </span><span class="hl_comment"><span class="mpre">-- :: ReadS a -&gt; ReadP a</span></span><span class="mpre">
  )
 where

import Control.Monad( </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="mpre">MonadPlus</span></a><span class="mpre">(..), </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="mpre">liftM</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="mpre">liftM2</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="mpre">ap</span></a><span class="mpre"> )
import Data.Char (</span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="mpre">isSpace</span></a><span class="mpre">)
import Control.Applicative (</span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="mpre">Applicative</span></a><span class="mpre">(..), </span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="mpre">Alternative</span></a><span class="mpre">(</span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="mpre">empty</span></a><span class="mpre">, </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="mpre">(&lt;|&gt;)</span></a><span class="mpre">))

</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Compat/ReadP.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 1, srcSpanEndLine = 76, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Compat/ReadP.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 8, srcSpanEndLine = 76, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Compat/Read"><span class="mpre">infixr 5 +++, &lt;++</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The P type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is representation type -- should be kept abstract</span></span><span class="mpre">

data </span><a name="loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tycondecl"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  = </span><a name="loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_condecl"><span class="mpre">Get</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  | </span><a name="loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_condecl"><span class="mpre">Look</span></span></a><span class="mpre"> ([</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">] -&gt; </span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  | </span><a name="loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_condecl"><span class="mpre">Fail</span></span></a><span class="mpre">
  | </span><a name="loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_condecl"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  | </span><a name="loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_condecl"><span class="mpre">Final</span></span></a><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">])] </span><span class="hl_comment"><span class="mpre">-- invariant: list is non-empty!</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Monad, MonadPlus</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
  </span><span class="hl_vardecl"><span class="mpre">fmap</span></span><span class="mpre"> = </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
  </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
  </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
  </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_99_10_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_10_99_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="#loc_99_10_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_10_99_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">

  (</span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_101_8_101_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_8_101_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)      </span><a name="loc_101_16_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_16_101_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_101_20_101_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> (\</span><a name="loc_101_30_101_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_30_101_31&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_101_8_101_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_8_101_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_101_30_101_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_30_101_31&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_101_20_101_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
  (</span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_102_9_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)     </span><a href="#loc_101_16_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_16_101_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_102_20_102_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_20_102_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_102_31_102_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_32&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_102_9_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_102_31_102_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_32&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_102_20_102_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_20_102_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
  </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">         </span><a href="#loc_101_16_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_16_101_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> _ = </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">
  (</span><a href="#loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_104_13_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="#loc_101_16_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_16_101_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> (</span><a href="#loc_104_13_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
  (</span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_105_10_105_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_10_105_11&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)    </span><a href="#loc_101_16_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_16_101_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_105_20_105_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_20_105_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre"> [</span><a href="#loc_105_49_105_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_49_105_52&#39;)"><span class="hl_varref"><span class="mpre">ys&#39;</span></span></a><span class="mpre"> | (</span><a name="loc_105_38_105_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_38_105_39&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_105_40_105_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_40_105_41&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_105_10_105_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_10_105_11&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">, </span><a name="loc_105_49_105_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_49_105_52&#39;)"><span class="hl_vardecl"><span class="mpre">ys&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_105_20_105_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_20_105_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_105_38_105_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_38_105_39&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_105_40_105_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_40_105_41&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">]

  </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> _ = </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="hl_classref"><span class="mpre">Alternative</span></span></a><span class="mpre"> (</span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
      </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre">
      </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;|&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_varref"><span class="mpre">mplus</span></span></a><span class="mpre">

instance </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="hl_classref"><span class="mpre">MonadPlus</span></span></a><span class="mpre"> (</span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
  </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">mzero</span></span></a><span class="mpre"> = </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- most common case: two gets are combined</span></span><span class="mpre">
  </span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_117_7_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_9&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre">     </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_117_26_117_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_28&#39;)"><span class="hl_vardecl"><span class="mpre">f2</span></span></a><span class="mpre">     = </span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> (\</span><a name="loc_117_41_117_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_41_117_42&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_117_7_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_9&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a href="#loc_117_41_117_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_41_117_42&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_117_26_117_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_28&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a href="#loc_117_41_117_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_41_117_42&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- results are delivered as soon as possible</span></span><span class="mpre">
  </span><a href="#loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_120_10_120_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_120_12_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_12_120_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_120_22_120_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_22_120_23&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">          = </span><a href="#loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="#loc_120_10_120_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_120_12_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_12_120_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_120_22_120_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_22_120_23&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">)
  </span><a name="loc_121_3_121_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_3_121_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_121_29_121_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_29_121_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_121_31_121_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_31_121_32&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="#loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="#loc_121_29_121_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_29_121_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_121_3_121_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_3_121_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_121_31_121_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_31_121_32&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- fail disappears</span></span><span class="mpre">
  </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">       </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_124_22_124_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_22_124_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          = </span><a href="#loc_124_22_124_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_22_124_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
  </span><a name="loc_125_3_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_3_125_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">       = </span><a href="#loc_125_3_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_3_125_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- two finals are combined</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- final + look becomes one look and one final (=optimization)</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- final + sthg else becomes one look and one final</span></span><span class="mpre">
  </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_130_9_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_130_28_130_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_28_130_29&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">    = </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_130_9_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_130_28_130_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_28_130_29&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
  </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_131_9_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_131_27_131_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_27_131_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     = </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_131_42_131_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_42_131_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_131_9_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_131_27_131_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_27_131_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_131_42_131_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_42_131_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_131_42_131_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_42_131_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))
  </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_132_9_132_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_9_132_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_132_22_132_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_22_132_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          = </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_132_42_132_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_42_132_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_132_9_132_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_9_132_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_132_22_132_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_22_132_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_132_42_132_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_42_132_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))
  </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_133_8_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_8_133_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_133_28_133_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_28_133_29&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    = </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_133_42_133_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_42_133_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_133_8_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_8_133_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_133_42_133_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_42_133_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_133_42_133_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_42_133_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_133_28_133_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_28_133_29&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">))
  </span><a name="loc_134_3_134_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_3_134_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_134_28_134_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_28_134_29&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    = </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_134_42_134_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_42_134_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_134_3_134_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_3_134_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_134_42_134_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_42_134_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_134_28_134_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_28_134_29&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">))

  </span><span class="hl_comment"><span class="mpre">-- two looks are combined (=optimization)</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- look + sthg else floats upwards</span></span><span class="mpre">
  </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_138_8_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_138_27_138_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_27_138_28&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">     = </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_138_42_138_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_42_138_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_138_8_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_138_42_138_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_42_138_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_138_27_138_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_27_138_28&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_138_42_138_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_42_138_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
  </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_139_8_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_8_139_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_139_22_139_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_22_139_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          = </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_139_42_139_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_42_139_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_139_8_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_8_139_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_139_42_139_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_42_139_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_139_22_139_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_22_139_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
  </span><a name="loc_140_3_140_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_3_140_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_140_27_140_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_27_140_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     = </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_140_42_140_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_42_140_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_140_3_140_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_3_140_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_140_27_140_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_27_140_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_140_42_140_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_42_140_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The ReadP type</span></span><span class="mpre">

newtype </span><a name="loc_145_9_145_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_condecl"><span class="mpre">R</span></span></a><span class="mpre"> ((</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Compat/ReadP.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 1, srcSpanEndLine = 146, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Compat/ReadP.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 1, srcSpanEndLine = 146, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Compat/R"><span class="mpre">type ReadP r a = Parser r Char a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Functor, Monad, MonadPlus</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_145_9_145_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
  </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_151_8_151_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_8_151_9&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_151_22_151_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_22_151_23&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_151_22_151_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_22_151_23&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_151_8_151_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_8_151_9&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">))

instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_145_9_145_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
  </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
  </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_145_9_145_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
  </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_158_10_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_10_158_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  = </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_158_19_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_19_158_20&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_158_19_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_19_158_20&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_158_10_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_10_158_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
  </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> _    = </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\_ -&gt; </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">)
  </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_160_5_160_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_5_160_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_160_11_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_11_160_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_160_19_160_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_20&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_5_160_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_5_160_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (\</span><a name="loc_160_28_160_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_28_160_29&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; let </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_160_39_160_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_39_160_41&#39;)"><span class="hl_vardecl"><span class="mpre">m&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_160_11_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_11_160_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_160_28_160_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_28_160_29&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> in </span><a href="#loc_160_39_160_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_39_160_41&#39;)"><span class="hl_varref"><span class="mpre">m&#39;</span></span></a><span class="mpre"> </span><a href="#loc_160_19_160_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_20&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">--instance MonadPlus (Parser r s) where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  mzero = pfail</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  mplus = (+++)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Operations over P</span></span><span class="mpre">

</span><a href="#loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="mpre">final</span></a><span class="mpre"> :: [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">])] -&gt; </span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintains invariant for Final constructor</span></span><span class="mpre">
</span><a name="loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="hl_fundecl"><span class="mpre">final</span></span></a><span class="mpre"> [] = </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">
</span><a href="#loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="hl_fundecl"><span class="mpre">final</span></span></a><span class="mpre"> </span><a name="loc_172_7_172_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_7_172_8&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">  = </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a href="#loc_172_7_172_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_7_172_8&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="mpre">run</span></a><span class="mpre"> :: </span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">] -&gt; [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">])])
</span><a name="loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_175_10_175_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_10_175_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)      (</span><a name="loc_175_19_175_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_19_175_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_175_21_175_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_21_175_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_175_10_175_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_10_175_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_175_19_175_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_19_175_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_175_21_175_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_21_175_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_176_11_176_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_11_176_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)     </span><a name="loc_176_18_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_18_176_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">     = </span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_176_11_176_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_11_176_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_176_18_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_18_176_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_176_18_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_18_176_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_177_13_177_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_13_177_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_177_15_177_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_15_177_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a name="loc_177_18_177_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_18_177_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">     = (</span><a href="#loc_177_13_177_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_13_177_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_177_18_177_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_18_177_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_177_15_177_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_15_177_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_177_18_177_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_18_177_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)    _     = </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> _            _     = []

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Operations over ReadP</span></span><span class="mpre">

</span><a href="#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="mpre">get</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Consumes and returns the next character.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Fails if there is no input left.</span></span><span class="mpre">
</span><a name="loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> = </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre">

</span><a href="#loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="mpre">look</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Look-ahead: returns the part of the input that is left, without</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   consuming it.</span></span><span class="mpre">
</span><a name="loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="hl_vardecl"><span class="mpre">look</span></span></a><span class="mpre"> = </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre">

</span><a href="#loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="mpre">pfail</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Always fails.</span></span><span class="mpre">
</span><a name="loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="hl_vardecl"><span class="mpre">pfail</span></span></a><span class="mpre"> = </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\_ -&gt; </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">)

</span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="mpre">(+++)</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Symmetric choice.</span></span><span class="mpre">
</span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_200_3_200_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_3_200_5&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a name="loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_fundecl"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_200_12_200_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_14&#39;)"><span class="hl_vardecl"><span class="mpre">f2</span></span></a><span class="mpre"> = </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_200_21_200_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_21_200_22&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_200_3_200_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_3_200_5&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a href="#loc_200_21_200_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_21_200_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_200_12_200_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_14&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a href="#loc_200_21_200_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_21_200_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)

</span><a href="#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_5_206_8&#39;)"><span class="mpre">(&lt;++)</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Local, exclusive, left-biased choice: If left parser</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   locally produces any result at all, then right parser is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   not used.</span></span><span class="mpre">
</span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_206_3_206_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_3_206_4&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_206_5_206_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_5_206_8&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a name="loc_206_9_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_10&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> =
  do </span><a name="loc_207_6_207_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_6_207_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre">
     </span><a href="#loc_210_3_210_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_8&#39;)"><span class="hl_varref"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_206_3_206_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_3_206_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">) </span><a href="#loc_207_6_207_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_6_207_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
 where
  </span><a name="loc_210_3_210_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_210_14_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_14_210_16&#39;)"><span class="hl_vardecl"><span class="mpre">f&#39;</span></span></a><span class="mpre">)       (</span><a name="loc_210_25_210_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_25_210_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_210_27_210_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_27_210_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_210_30_210_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_30_210_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_210_3_210_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_8&#39;)"><span class="hl_varref"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_210_14_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_14_210_16&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre"> </span><a href="#loc_210_25_210_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_25_210_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_210_27_210_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_27_210_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_210_30_210_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_30_210_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  </span><a href="#loc_210_3_210_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_211_15_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_15_211_17&#39;)"><span class="hl_vardecl"><span class="mpre">f&#39;</span></span></a><span class="mpre">)      </span><a name="loc_211_24_211_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_24_211_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">     </span><a name="loc_211_30_211_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_30_211_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_210_3_210_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_8&#39;)"><span class="hl_varref"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_211_15_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_15_211_17&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre"> </span><a href="#loc_211_24_211_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_24_211_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_211_24_211_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_24_211_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_211_30_211_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_30_211_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
  </span><a href="#loc_210_3_210_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> </span><a name="loc_212_9_212_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_10&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a href="#loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> _ _) _     </span><a name="loc_212_30_212_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_30_212_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_216_3_216_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_3_216_10&#39;)"><span class="hl_varref"><span class="mpre">discard</span></span></a><span class="mpre"> </span><a href="#loc_212_30_212_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_30_212_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_212_9_212_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">)
  </span><a href="#loc_210_3_210_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_213_16_213_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_16_213_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)      _     _ = </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a href="#loc_213_16_213_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_16_213_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">)
  </span><a href="#loc_210_3_210_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> _              _     _ = </span><a href="#loc_206_9_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_10&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

  </span><a name="loc_216_3_216_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_3_216_10&#39;)"><span class="hl_fundecl"><span class="mpre">discard</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
  </span><a href="#loc_216_3_216_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_3_216_10&#39;)"><span class="hl_fundecl"><span class="mpre">discard</span></span></a><span class="mpre"> </span><a name="loc_217_11_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_11_217_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">  = </span><a href="#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_216_3_216_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_3_216_10&#39;)"><span class="hl_varref"><span class="mpre">discard</span></span></a><span class="mpre"> (</span><a href="#loc_217_11_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_11_217_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)

</span><a href="#loc_224_1_224_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_7&#39;)"><span class="mpre">gather</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_82_6_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">-- ^ Transforms a parser into one that does the same, but</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   in addition returns the exact characters read.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   IMPORTANT NOTE: &#39;gather&#39; gives a runtime error if its first argument</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   is built using any occurrences of readS_to_P.</span></span><span class="mpre">
</span><a name="loc_224_1_224_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_7&#39;)"><span class="hl_fundecl"><span class="mpre">gather</span></span></a><span class="mpre"> (</span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_224_11_224_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_11_224_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) =
  </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_225_7_225_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_7_225_8&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_varref"><span class="mpre">gath</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> (</span><a href="#loc_224_11_224_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_11_224_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (\</span><a name="loc_225_25_225_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_25_225_26&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (\</span><a name="loc_225_39_225_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_39_225_40&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_225_7_225_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_7_225_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_225_39_225_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_39_225_40&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_225_25_225_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_25_225_26&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)))))
 where
  </span><a name="loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a name="loc_227_8_227_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_8_227_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_227_15_227_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_15_227_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)      = </span><a href="#loc_83_5_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> (\</span><a name="loc_227_31_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_31_227_32&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_varref"><span class="mpre">gath</span></span></a><span class="mpre"> (</span><a href="#loc_227_8_227_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_8_227_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">(</span><a href="#loc_227_31_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_31_227_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) (</span><a href="#loc_227_15_227_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_15_227_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_227_31_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_31_227_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">))
  </span><a href="#loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> _ </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">         = </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">
  </span><a href="#loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a name="loc_229_8_229_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_8_229_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_229_16_229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_16_229_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)     = </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_229_32_229_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_32_229_33&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_varref"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a href="#loc_229_8_229_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_8_229_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_229_16_229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_16_229_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_229_32_229_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_32_229_33&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))
  </span><a href="#loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a name="loc_230_8_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_8_230_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_86_5_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_230_18_230_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_18_230_19&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_230_20_230_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_20_230_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_230_18_230_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_18_230_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_230_8_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_8_230_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> []) </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_varref"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a href="#loc_230_8_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_8_230_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_230_20_230_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_20_230_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
  </span><a href="#loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> _ (</span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> _)    = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;do not use readS_to_P in gather!&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Derived operations</span></span><span class="mpre">

</span><a href="#loc_239_1_239_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_8&#39;)"><span class="mpre">satisfy</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Consumes and returns the next character, if it satisfies the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   specified predicate.</span></span><span class="mpre">
</span><a name="loc_239_1_239_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_8&#39;)"><span class="hl_fundecl"><span class="mpre">satisfy</span></span></a><span class="mpre"> </span><a name="loc_239_9_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_9_239_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do </span><a name="loc_239_16_239_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_16_239_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">; if </span><a href="#loc_239_9_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_9_239_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_239_16_239_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_16_239_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_239_16_239_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_16_239_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> else </span><a href="#loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre">

</span><a href="#loc_243_1_243_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_5&#39;)"><span class="mpre">char</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Parses and returns the specified character.</span></span><span class="mpre">
</span><a name="loc_243_1_243_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_5&#39;)"><span class="hl_fundecl"><span class="mpre">char</span></span></a><span class="mpre"> </span><a name="loc_243_6_243_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_6_243_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_239_1_239_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_8&#39;)"><span class="hl_varref"><span class="mpre">satisfy</span></span></a><span class="mpre"> (</span><a href="#loc_243_6_243_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_6_243_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre">)

</span><a href="#loc_247_1_247_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_7&#39;)"><span class="mpre">string</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Parses and returns the specified string.</span></span><span class="mpre">
</span><a name="loc_247_1_247_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_7&#39;)"><span class="hl_fundecl"><span class="mpre">string</span></span></a><span class="mpre"> </span><a name="loc_247_8_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_8_247_12&#39;)"><span class="hl_vardecl"><span class="mpre">this</span></span></a><span class="mpre"> = do </span><a name="loc_247_18_247_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_18_247_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre">; </span><a href="#loc_249_3_249_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_3_249_7&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_247_8_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_8_247_12&#39;)"><span class="hl_varref"><span class="mpre">this</span></span></a><span class="mpre"> </span><a href="#loc_247_18_247_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_18_247_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
 where
  </span><a name="loc_249_3_249_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_3_249_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> []     _               = do </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_247_8_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_8_247_12&#39;)"><span class="hl_varref"><span class="mpre">this</span></span></a><span class="mpre">
  </span><a href="#loc_249_3_249_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_3_249_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> (</span><a name="loc_250_9_250_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_9_250_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_250_11_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_11_250_13&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) (</span><a name="loc_250_16_250_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_16_250_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_250_18_250_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_18_250_20&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) | </span><a href="#loc_250_9_250_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_9_250_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_250_16_250_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_16_250_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> = do </span><a href="#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_249_3_249_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_3_249_7&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_250_11_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_11_250_13&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_250_18_250_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_18_250_20&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
  </span><a href="#loc_249_3_249_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_3_249_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> _      _               = do </span><a href="#loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre">

</span><a href="#loc_255_1_255_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_6&#39;)"><span class="mpre">munch</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Parses the first zero or more characters satisfying the predicate.</span></span><span class="mpre">
</span><a name="loc_255_1_255_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_6&#39;)"><span class="hl_fundecl"><span class="mpre">munch</span></span></a><span class="mpre"> </span><a name="loc_255_7_255_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_7_255_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> =
  do </span><a name="loc_256_6_256_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_6_256_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre">
     </span><a href="#loc_259_3_259_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_7&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_256_6_256_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_6_256_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
 where
  </span><a name="loc_259_3_259_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> (</span><a name="loc_259_9_259_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_9_259_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_259_11_259_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_11_259_13&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) | </span><a href="#loc_255_7_255_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_7_255_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_259_9_259_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_9_259_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = do _ &lt;- </span><a href="#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">; </span><a name="loc_259_36_259_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_36_259_37&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_259_3_259_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_7&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_259_11_259_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_11_259_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_259_9_259_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_9_259_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_259_36_259_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_36_259_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
  </span><a href="#loc_259_3_259_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> _            = do </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><a href="#loc_264_1_264_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_7&#39;)"><span class="mpre">munch1</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Parses the first one or more characters satisfying the predicate.</span></span><span class="mpre">
</span><a name="loc_264_1_264_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_7&#39;)"><span class="hl_fundecl"><span class="mpre">munch1</span></span></a><span class="mpre"> </span><a name="loc_264_8_264_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_8_264_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> =
  do </span><a name="loc_265_6_265_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_6_265_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">
     if </span><a href="#loc_264_8_264_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_8_264_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_265_6_265_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_6_265_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> then do </span><a name="loc_266_21_266_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_21_266_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_255_1_255_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_6&#39;)"><span class="hl_varref"><span class="mpre">munch</span></span></a><span class="mpre"> </span><a href="#loc_264_8_264_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_8_264_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_265_6_265_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_6_265_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_266_21_266_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_21_266_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
            else </span><a href="#loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre">

</span><a href="#loc_271_1_271_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_7&#39;)"><span class="mpre">choice</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Combines all parsers in the specified list.</span></span><span class="mpre">
</span><a name="loc_271_1_271_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_7&#39;)"><span class="hl_fundecl"><span class="mpre">choice</span></span></a><span class="mpre"> []     = </span><a href="#loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre">
</span><a href="#loc_271_1_271_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_7&#39;)"><span class="hl_fundecl"><span class="mpre">choice</span></span></a><span class="mpre"> [</span><a name="loc_272_9_272_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_9_272_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">]    = </span><a href="#loc_272_9_272_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_9_272_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><a href="#loc_271_1_271_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_7&#39;)"><span class="hl_fundecl"><span class="mpre">choice</span></span></a><span class="mpre"> (</span><a name="loc_273_9_273_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_273_11_273_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_11_273_13&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) = </span><a href="#loc_273_9_273_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_271_1_271_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_7&#39;)"><span class="hl_varref"><span class="mpre">choice</span></span></a><span class="mpre"> </span><a href="#loc_273_11_273_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_11_273_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">

</span><a href="#loc_277_1_277_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_11&#39;)"><span class="mpre">skipSpaces</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Skips all whitespace.</span></span><span class="mpre">
</span><a name="loc_277_1_277_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_11&#39;)"><span class="hl_vardecl"><span class="mpre">skipSpaces</span></span></a><span class="mpre"> =
  do </span><a name="loc_278_6_278_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre">
     </span><a href="#loc_281_3_281_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_3_281_7&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
 where
  </span><a name="loc_281_3_281_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_3_281_7&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> (</span><a name="loc_281_9_281_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_9_281_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_281_11_281_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_11_281_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) | </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_281_9_281_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_9_281_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = do _ &lt;- </span><a href="#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">; </span><a href="#loc_281_3_281_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_3_281_7&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_281_11_281_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_11_281_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  </span><a href="#loc_281_3_281_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_3_281_7&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> _                 = do </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_287_1_287_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_6&#39;)"><span class="mpre">count</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @ count n p @ parses @n@ occurrences of @p@ in sequence. A list of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   results is returned.</span></span><span class="mpre">
</span><a name="loc_287_1_287_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_6&#39;)"><span class="hl_fundecl"><span class="mpre">count</span></span></a><span class="mpre"> </span><a name="loc_287_7_287_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_7_287_8&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_287_9_287_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_9_287_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">sequence</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><a href="#loc_287_7_287_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_7_287_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_287_9_287_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_9_287_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)

</span><a href="#loc_292_1_292_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_8&#39;)"><span class="mpre">between</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">open</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">close</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @ between open close p @ parses @open@, followed by @p@ and finally</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   @close@. Only the value of @p@ is returned.</span></span><span class="mpre">
</span><a name="loc_292_1_292_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_8&#39;)"><span class="hl_fundecl"><span class="mpre">between</span></span></a><span class="mpre"> </span><a name="loc_292_9_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_9_292_13&#39;)"><span class="hl_vardecl"><span class="mpre">open</span></span></a><span class="mpre"> </span><a name="loc_292_14_292_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_14_292_19&#39;)"><span class="hl_vardecl"><span class="mpre">close</span></span></a><span class="mpre"> </span><a name="loc_292_20_292_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_20_292_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do _ &lt;- </span><a href="#loc_292_9_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_9_292_13&#39;)"><span class="hl_varref"><span class="mpre">open</span></span></a><span class="mpre">
                          </span><a name="loc_293_27_293_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_27_293_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_292_20_292_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_20_292_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                          _ &lt;- </span><a href="#loc_292_14_292_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_14_292_19&#39;)"><span class="hl_varref"><span class="mpre">close</span></span></a><span class="mpre">
                          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_293_27_293_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_27_293_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_300_1_300_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_7&#39;)"><span class="mpre">option</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @option x p@ will either parse @p@ or return @x@ without consuming</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   any input.</span></span><span class="mpre">
</span><a name="loc_300_1_300_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_7&#39;)"><span class="hl_fundecl"><span class="mpre">option</span></span></a><span class="mpre"> </span><a name="loc_300_8_300_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_8_300_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_300_10_300_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_10_300_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_300_10_300_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_10_300_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_300_8_300_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_8_300_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_304_1_304_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_1_304_9&#39;)"><span class="mpre">optional</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @optional p@ optionally parses @p@ and always returns @()@.</span></span><span class="mpre">
</span><a name="loc_304_1_304_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_1_304_9&#39;)"><span class="hl_fundecl"><span class="mpre">optional</span></span></a><span class="mpre"> </span><a name="loc_304_10_304_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_10_304_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = (</span><a href="#loc_304_10_304_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_10_304_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_308_1_308_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_5&#39;)"><span class="mpre">many</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ Parses zero or more occurrences of the given parser.</span></span><span class="mpre">
</span><a name="loc_308_1_308_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_5&#39;)"><span class="hl_fundecl"><span class="mpre">many</span></span></a><span class="mpre"> </span><a name="loc_308_6_308_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_6_308_7&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [] </span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_312_1_312_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> </span><a href="#loc_308_6_308_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_6_308_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_312_1_312_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_6&#39;)"><span class="mpre">many1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ Parses one or more occurrences of the given parser.</span></span><span class="mpre">
</span><a name="loc_312_1_312_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_6&#39;)"><span class="hl_fundecl"><span class="mpre">many1</span></span></a><span class="mpre"> </span><a name="loc_312_7_312_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_7_312_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="#loc_312_7_312_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_7_312_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_308_1_308_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_312_7_312_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_7_312_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)

</span><a href="#loc_316_1_316_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_9&#39;)"><span class="mpre">skipMany</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Like &#39;many&#39;, but discards the result.</span></span><span class="mpre">
</span><a name="loc_316_1_316_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_9&#39;)"><span class="hl_fundecl"><span class="mpre">skipMany</span></span></a><span class="mpre"> </span><a name="loc_316_10_316_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_10_316_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_308_1_308_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_316_10_316_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_10_316_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_320_1_320_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_10&#39;)"><span class="mpre">skipMany1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Like &#39;many1&#39;, but discards the result.</span></span><span class="mpre">
</span><a name="loc_320_1_320_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_10&#39;)"><span class="hl_fundecl"><span class="mpre">skipMany1</span></span></a><span class="mpre"> </span><a name="loc_320_11_320_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_11_320_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_320_11_320_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_11_320_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_316_1_316_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_9&#39;)"><span class="hl_varref"><span class="mpre">skipMany</span></span></a><span class="mpre"> </span><a href="#loc_320_11_320_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_11_320_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_325_1_325_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_1_325_6&#39;)"><span class="mpre">sepBy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">sep</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @sepBy p sep@ parses zero or more occurrences of @p@, separated by @sep@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Returns a list of values returned by @p@.</span></span><span class="mpre">
</span><a name="loc_325_1_325_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_1_325_6&#39;)"><span class="hl_fundecl"><span class="mpre">sepBy</span></span></a><span class="mpre"> </span><a name="loc_325_7_325_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_7_325_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_325_9_325_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_9_325_12&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> = </span><a href="#loc_330_1_330_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_7&#39;)"><span class="hl_varref"><span class="mpre">sepBy1</span></span></a><span class="mpre"> </span><a href="#loc_325_7_325_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_7_325_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_325_9_325_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_9_325_12&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> </span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []

</span><a href="#loc_330_1_330_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_7&#39;)"><span class="mpre">sepBy1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">sep</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @sepBy1 p sep@ parses one or more occurrences of @p@, separated by @sep@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Returns a list of values returned by @p@.</span></span><span class="mpre">
</span><a name="loc_330_1_330_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_7&#39;)"><span class="hl_fundecl"><span class="mpre">sepBy1</span></span></a><span class="mpre"> </span><a name="loc_330_8_330_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_8_330_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_330_10_330_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_10_330_13&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="#loc_330_8_330_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_8_330_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_308_1_308_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (</span><a href="#loc_330_10_330_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_10_330_13&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_330_8_330_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_8_330_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">))

</span><a href="#loc_335_1_335_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_1_335_6&#39;)"><span class="mpre">endBy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">sep</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @endBy p sep@ parses zero or more occurrences of @p@, separated and ended</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   by @sep@.</span></span><span class="mpre">
</span><a name="loc_335_1_335_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_1_335_6&#39;)"><span class="hl_fundecl"><span class="mpre">endBy</span></span></a><span class="mpre"> </span><a name="loc_335_7_335_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_7_335_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_335_9_335_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_9_335_12&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> = </span><a href="#loc_308_1_308_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (do </span><a name="loc_335_24_335_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_24_335_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_335_7_335_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_7_335_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> ; _ &lt;- </span><a href="#loc_335_9_335_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_9_335_12&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_335_24_335_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_24_335_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><a href="#loc_340_1_340_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_1_340_7&#39;)"><span class="mpre">endBy1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">sep</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @endBy p sep@ parses one or more occurrences of @p@, separated and ended</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   by @sep@.</span></span><span class="mpre">
</span><a name="loc_340_1_340_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_1_340_7&#39;)"><span class="hl_fundecl"><span class="mpre">endBy1</span></span></a><span class="mpre"> </span><a name="loc_340_8_340_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_8_340_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_340_10_340_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_10_340_13&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> = </span><a href="#loc_312_1_312_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> (do </span><a name="loc_340_26_340_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_26_340_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_340_8_340_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_8_340_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> ; _ &lt;- </span><a href="#loc_340_10_340_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_10_340_13&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_340_26_340_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_26_340_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><a href="#loc_347_1_347_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_1_347_7&#39;)"><span class="mpre">chainr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @chainr p op x@ parses zero or more occurrences of @p@, separated by @op@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Returns a value produced by a /right/ associative application of all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   functions returned by @op@. If there are no occurrences of @p@, @x@ is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   returned.</span></span><span class="mpre">
</span><a name="loc_347_1_347_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_1_347_7&#39;)"><span class="hl_fundecl"><span class="mpre">chainr</span></span></a><span class="mpre"> </span><a name="loc_347_8_347_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_8_347_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_347_10_347_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_10_347_12&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_347_13_347_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_13_347_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_358_1_358_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_1_358_8&#39;)"><span class="hl_varref"><span class="mpre">chainr1</span></span></a><span class="mpre"> </span><a href="#loc_347_8_347_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_8_347_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_347_10_347_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_10_347_12&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_347_13_347_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_13_347_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_354_1_354_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_7&#39;)"><span class="mpre">chainl</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @chainl p op x@ parses zero or more occurrences of @p@, separated by @op@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Returns a value produced by a /left/ associative application of all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   functions returned by @op@. If there are no occurrences of @p@, @x@ is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   returned.</span></span><span class="mpre">
</span><a name="loc_354_1_354_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_7&#39;)"><span class="hl_fundecl"><span class="mpre">chainl</span></span></a><span class="mpre"> </span><a name="loc_354_8_354_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_8_354_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_354_10_354_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_10_354_12&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_354_13_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_13_354_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="hl_varref"><span class="mpre">chainl1</span></span></a><span class="mpre"> </span><a href="#loc_354_8_354_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_8_354_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_354_10_354_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_10_354_12&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_354_13_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_13_354_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_358_1_358_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_1_358_8&#39;)"><span class="mpre">chainr1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Like &#39;chainr&#39;, but parses one or more occurrences of @p@.</span></span><span class="mpre">
</span><a name="loc_358_1_358_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_1_358_8&#39;)"><span class="hl_fundecl"><span class="mpre">chainr1</span></span></a><span class="mpre"> </span><a name="loc_358_9_358_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_358_11_358_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_11_358_13&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> = </span><a href="#loc_359_9_359_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_9_359_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">
  where </span><a name="loc_359_9_359_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_9_359_13&#39;)"><span class="hl_vardecl"><span class="mpre">scan</span></span></a><span class="mpre">   = </span><a href="#loc_358_9_358_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_360_9_360_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_9_360_13&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a name="loc_360_9_360_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_9_360_13&#39;)"><span class="hl_fundecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_360_14_360_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_14_360_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do </span><a name="loc_360_21_360_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_21_360_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_358_11_358_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_11_358_13&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                    </span><a name="loc_361_21_361_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_21_361_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_359_9_359_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_9_359_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_360_21_360_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_21_360_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_360_14_360_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_14_360_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_361_21_361_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_21_361_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                 </span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_360_14_360_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_14_360_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="mpre">chainl1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Like &#39;chainl&#39;, but parses one or more occurrences of @p@.</span></span><span class="mpre">
</span><a name="loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="hl_fundecl"><span class="mpre">chainl1</span></span></a><span class="mpre"> </span><a name="loc_367_9_367_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_9_367_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_367_11_367_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_11_367_13&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> = </span><a href="#loc_367_9_367_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_9_367_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_368_9_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_9_368_13&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
  where </span><a name="loc_368_9_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_9_368_13&#39;)"><span class="hl_fundecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_368_14_368_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_14_368_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do </span><a name="loc_368_21_368_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_21_368_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_367_11_367_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_11_367_13&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                    </span><a name="loc_369_21_369_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_21_369_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_367_9_367_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_9_367_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                    </span><a href="#loc_368_9_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_9_368_13&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> (</span><a href="#loc_368_21_368_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_21_368_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_368_14_368_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_14_368_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_369_21_369_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_21_369_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                 </span><a href="#loc_200_6_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_6_200_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_368_14_368_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_14_368_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_376_1_376_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_9&#39;)"><span class="mpre">manyTill</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] </span><span class="hl_tyvar"><span class="mpre">end</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @manyTill p end@ parses zero or more occurrences of @p@, until @end@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   succeeds. Returns a list of values returned by @p@.</span></span><span class="mpre">
</span><a name="loc_376_1_376_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_9&#39;)"><span class="hl_fundecl"><span class="mpre">manyTill</span></span></a><span class="mpre"> </span><a name="loc_376_10_376_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_10_376_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_376_12_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_15&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre"> = </span><a href="#loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">
  where </span><a name="loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_vardecl"><span class="mpre">scan</span></span></a><span class="mpre"> = (</span><a href="#loc_376_12_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_15&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []) </span><a href="#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> (</span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="#loc_376_10_376_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_10_376_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Converting between ReadP and Read</span></span><span class="mpre">

</span><a href="#loc_387_1_387_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_11&#39;)"><span class="mpre">readP_to_S</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Converts a parser into a Haskell ReadS-style function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This is the main way in which you can \&quot;run\&quot; a &#39;ReadP&#39; parser:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the expanded type is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @ readP_to_S :: ReadP a -&gt; String -&gt; [(a,String)] @</span></span><span class="mpre">
</span><a name="loc_387_1_387_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_11&#39;)"><span class="hl_fundecl"><span class="mpre">readP_to_S</span></span></a><span class="mpre"> (</span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_387_15_387_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_15_387_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = </span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_387_15_387_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_15_387_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">)

</span><a href="#loc_393_1_393_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_1_393_11&#39;)"><span class="mpre">readS_to_P</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Converts a Haskell ReadS-style function into a parser.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Warning: This introduces local backtracking in the resulting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   parser, and therefore a possible inefficiency.</span></span><span class="mpre">
</span><a name="loc_393_1_393_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_1_393_11&#39;)"><span class="hl_fundecl"><span class="mpre">readS_to_P</span></span></a><span class="mpre"> </span><a name="loc_393_12_393_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> =
  </span><a href="#loc_145_24_145_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_24_145_25&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_394_7_394_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_7_394_8&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_394_19_394_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_19_394_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre"> [</span><a href="#loc_394_53_394_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_53_394_57&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;&#39;</span></span></a><span class="mpre"> | (</span><a name="loc_394_39_394_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_39_394_40&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_394_41_394_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_41_394_43&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_393_12_393_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_394_19_394_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_19_394_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_394_53_394_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_53_394_57&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_175_1_175_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_394_7_394_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_7_394_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_394_39_394_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_39_394_40&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_394_41_394_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_41_394_43&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">]))



</span></div></body></html>