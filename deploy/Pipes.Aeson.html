<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RankNTypes #-}

</span><span class="hl_comment"><span class="mpre">-- | This module allows you to encode and decode JSON values flowing downstream</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- through Pipes streams.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module builds on top of the @aeson@, @pipes@ and @pipes-parse@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- libraries, and assumes you know how to use them. Please read the examples</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in &quot;Pipes.Parse.Tutorial&quot; to understand how to use these functions.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In this module, the following type synonym compatible with the @lens@,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @lens-family@ and @lens-family-core@ libraries is used but not exported:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- type Lens&#39; s a = forall f . &#39;Functor&#39; f =&gt; (a -&gt; f a) -&gt; (s -&gt; f s)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">

module Pipes.Aeson
  ( </span><span class="hl_comment"><span class="mpre">-- * Encoding</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $encoding</span></span><span class="mpre">
    encodeArray
  , encodeObject

    </span><span class="hl_comment"><span class="mpre">-- * Decoding</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $decoding</span></span><span class="mpre">
  , decode
  , decoded
    </span><span class="hl_comment"><span class="mpre">-- ** Including lengths</span></span><span class="mpre">
  , decodeL
  , decodedL

    </span><span class="hl_comment"><span class="mpre">-- * Types</span></span><span class="mpre">
  , I.DecodingError(..)
  ) where

import           Control.Monad         (</span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="mpre">liftM</span></a><span class="mpre">)
import qualified Data.Aeson            as Ae
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 18, srcSpanEndLine = 37, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as B
import           Pipes
import qualified Pipes.Aeson.Internal  as I
import qualified Pipes.Aeson.Unchecked as U
import qualified Pipes.Parse           as Pipes

</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- $encoding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Encode &#39;Ae.Array&#39; or &#39;Ae.Object&#39; values as JSON and send them downstream,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- possibly in more than one &#39;B.ByteString&#39; chunk.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Note:/ The JSON RFC-4627 standard only allows arrays or objects as top-level</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- entities, which is why these functions restrict their input to them. If you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- prefer to ignore the standard and encode any &#39;Ae.Value&#39;, then use &#39;U.encode&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- from the &quot;Pipes.Aeson.Unchecked&quot; module.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode an &#39;Ae.Object&#39; as JSON and send it downstream,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Hint:/ You can easily turn this &#39;Producer&#39;&#39; into a &#39;Pipe&#39; that encodes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Ae.Object&#39; values as JSON as they flow downstream using:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;for&#39; &#39;cat&#39; &#39;encodeObject&#39; :: &#39;Monad&#39; m =&gt; &#39;Pipe&#39; &#39;Ae.Object&#39; &#39;B.ByteString&#39; m r</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_13&#39;)"><span class="mpre">encodeObject</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 17, srcSpanEndLine = 63, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 25, srcSpanEndLine = 63, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-ae"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ae.Object</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Producer&#39;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_64_1_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_13&#39;)"><span class="hl_vardecl"><span class="mpre">encodeObject</span></span></a><span class="mpre"> = </span><a href="Pipes.Aeson.Unchecked.html#loc_34_1_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Aeson.Unchecked.html#loc_34_1_34_7&#39;)"><span class="hl_varref"><span class="mpre">U.encode</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE encodeObject #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;p &gt;-&gt; for cat encodeObject&quot; forall p .
    p &gt;-&gt; for cat encodeObject = for p encodeObject
  #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode an &#39;Ae.Array&#39; as JSON and send it downstream,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Hint:/ You can easily turn this &#39;Producer&#39;&#39; into a &#39;Pipe&#39; that encodes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Ae.Array&#39; values as JSON as they flow downstream using:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;for&#39; &#39;cat&#39; &#39;encodeArray&#39; :: &#39;Monad&#39; m =&gt; &#39;Pipe&#39; &#39;Ae.Array&#39; &#39;B.ByteString&#39; m r</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_79_1_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_12&#39;)"><span class="mpre">encodeArray</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 16, srcSpanEndLine = 78, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 24, srcSpanEndLine = 78, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-ae"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ae.Array</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Producer&#39;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_79_1_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_12&#39;)"><span class="hl_vardecl"><span class="mpre">encodeArray</span></span></a><span class="mpre"> = </span><a href="Pipes.Aeson.Unchecked.html#loc_34_1_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Aeson.Unchecked.html#loc_34_1_34_7&#39;)"><span class="hl_varref"><span class="mpre">U.encode</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE encodeArray #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;p &gt;-&gt; for cat encodeArray&quot; forall p .
    p &gt;-&gt; for cat encodeArray = for p encodeArray
  #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- $decoding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Decoding JSON as a Haskell value involves two different steps:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Parsing a raw JSON &#39;B.ByteString&#39; into an &#39;Ae.Object&#39; or an &#39;Ae.Array&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Converting the obtained &#39;Ae.Object&#39; or &#39;Ae.Array&#39; to the desired</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Ae.FromJSON&#39; instance.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Any of those steps can fail, in which case a &#39;I.DecodingError&#39; will report</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the precise error and at which the step it happened.</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Decodes an &#39;Ae.Object&#39; or &#39;Ae.Array&#39; JSON value from the underlying state.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Returns either the decoded entitiy, or a &#39;I.DecodingError&#39; in case of error.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It returns &#39;Nothing&#39; if the underlying &#39;Producer&#39; is exhausted, otherwise</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it returns either the decoded entity or a &#39;I.DecodingError&#39; in case of error.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Note:/ The JSON RFC-4627 standard only allows arrays or objects as top-level</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- entities, which is why this &#39;Pipes.Parser&#39; restricts its output to them. If</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- you prefer to ignore the standard and decode any &#39;Ae.Value&#39;, then use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;U.decode&#39; from the &quot;Pipes.Aeson.Unchecked&quot; module.</span></span><span class="mpre">
</span><a href="#loc_113_1_113_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_7&#39;)"><span class="mpre">decode</span></a><span class="mpre">
  :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 6, srcSpanEndLine = 112, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 6, srcSpanEndLine = 111, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpan"><span class="mpre">(Monad m, Ae.FromJSON a)
  =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Pipes.Parser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Pipes.Aeson.Internal.html#loc_29_6_29_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Aeson.Internal.html#loc_29_6_29_19&#39;)"><span class="hl_tyconref"><span class="mpre">I.DecodingError</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
</span><a name="loc_113_1_113_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_7&#39;)"><span class="hl_vardecl"><span class="mpre">decode</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">) </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_infix"><span class="mpre">`liftM`</span></span></a><span class="mpre"> </span><a href="#loc_122_1_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_8&#39;)"><span class="hl_varref"><span class="mpre">decodeL</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE decode #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;decode&#39;, except it also returns the length of JSON input that was</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- consumed in order to obtain the value, not including the length of whitespace</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- before nor after the parsed JSON input.</span></span><span class="mpre">
</span><a href="#loc_122_1_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_8&#39;)"><span class="mpre">decodeL</span></a><span class="mpre">
  :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 6, srcSpanEndLine = 121, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 6, srcSpanEndLine = 120, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpan"><span class="mpre">(Monad m, Ae.FromJSON a)
  =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Pipes.Parser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Pipes.Aeson.Internal.html#loc_29_6_29_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Aeson.Internal.html#loc_29_6_29_19&#39;)"><span class="hl_tyconref"><span class="mpre">I.DecodingError</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)))
</span><a name="loc_122_1_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_8&#39;)"><span class="hl_vardecl"><span class="mpre">decodeL</span></span></a><span class="mpre"> = </span><a href="Pipes.Aeson.Internal.html#loc_86_1_86_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Aeson.Internal.html#loc_86_1_86_8&#39;)"><span class="hl_varref"><span class="mpre">I.decodeL</span></span></a><span class="mpre"> </span><a href="Data.Aeson.Parser.Internal.html#loc_97_1_97_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Aeson.Parser.Internal.html#loc_97_1_97_6&#39;)"><span class="hl_varref"><span class="mpre">Ae.json&#39;</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE decodeL #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | /Improper lens/ that turns a stream of raw JSON input into a stream of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Ae.FromJSON&#39; and back.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- By /improper lens/ we mean that in practice you can&#39;t expect the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Monad Morphism Laws/ to be true when using &#39;decoded&#39; with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Control.Lens.zoom&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Control.Lens.zoom&#39; &#39;decoded&#39; (&#39;return&#39; r) /= &#39;return&#39; r</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Control.Lens.zoom&#39; &#39;decoded&#39; (m &gt;&gt;= k)  /= &#39;Control.Lens.zoom&#39; m &gt;&gt;= &#39;Control.Lens.zoom&#39; . f</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Note:/ The JSON RFC-4627 standard only allows arrays or objects as top-level</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- entities, which is why this function restricts its stream values to them. If</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- you prefer to ignore the standard and encode or decode any &#39;Ae.Value&#39;, then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- use &#39;U.decoded&#39; from the &quot;Pipes.Aeson.Unchecked&quot; module.</span></span><span class="mpre">
</span><a href="#loc_149_1_149_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_8&#39;)"><span class="mpre">decoded</span></a><span class="mpre">
  :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 6, srcSpanEndLine = 144, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 6, srcSpanEndLine = 143, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpan"><span class="mpre">(Monad m, Ae.FromJSON a, Ae.ToJSON a)
  =&gt;</span></span><span class="mpre"> (</span><a href="Data.Aeson.Types.Internal.html#loc_177_6_177_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Aeson.Types.Internal.html#loc_177_6_177_11&#39;)"><span class="hl_tyconref"><span class="mpre">Ae.Value</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ae.Object</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ae.Array</span></span><span class="mpre">)
     </span><span class="hl_comment"><span class="mpre">-- ^ A witness that @a@ can be represented either as an &#39;Ae.Object&#39; or as</span></span><span class="mpre">
     </span><span class="hl_comment"><span class="mpre">-- an &#39;Ae.Array&#39;. The passed in &#39;Ae.Value&#39; is @&#39;Ae.toJSON&#39; a@</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
           (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> (</span><a href="Pipes.Aeson.Internal.html#loc_29_6_29_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Aeson.Internal.html#loc_29_6_29_19&#39;)"><span class="hl_tyconref"><span class="mpre">I.DecodingError</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">))
</span><a name="loc_149_1_149_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_8&#39;)"><span class="hl_fundecl"><span class="mpre">decoded</span></span></a><span class="mpre"> </span><a name="loc_149_9_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_149_11_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_11_149_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_149_13_149_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_13_149_15&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_151_5_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_5_151_12&#39;)"><span class="hl_varref"><span class="mpre">_encode</span></span></a><span class="mpre"> (</span><a href="#loc_149_11_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_11_149_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Pipes.Aeson.Internal.html#loc_61_1_61_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Aeson.Internal.html#loc_61_1_61_14&#39;)"><span class="hl_varref"><span class="mpre">I.consecutively</span></span></a><span class="mpre"> </span><a href="#loc_113_1_113_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_149_13_149_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_13_149_15&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre">))
  where
    </span><a name="loc_151_5_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_5_151_12&#39;)"><span class="hl_vardecl"><span class="mpre">_encode</span></span></a><span class="mpre"> = \</span><a name="loc_151_16_151_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_16_151_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
       </span><a name="loc_152_8_152_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_8_152_10&#39;)"><span class="hl_vardecl"><span class="mpre">er</span></span></a><span class="mpre"> &lt;- </span><a href="Pipes.html#loc_150_1_150_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_150_1_150_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> </span><a href="#loc_151_16_151_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_16_151_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (\</span><a name="loc_152_22_152_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_22_152_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><a href="#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">encodeObject</span></span></a><span class="mpre"> </span><a href="#loc_79_1_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_12&#39;)"><span class="hl_varref"><span class="mpre">encodeArray</span></span></a><span class="mpre"> (</span><a href="#loc_149_9_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">Ae.toJSON</span></span><span class="mpre"> </span><a href="#loc_152_22_152_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_22_152_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)))
       case </span><a href="#loc_152_8_152_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_8_152_10&#39;)"><span class="hl_varref"><span class="mpre">er</span></span></a><span class="mpre"> of
          </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (_, </span><a name="loc_154_20_154_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_20_154_22&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_154_20_154_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_20_154_22&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">
          </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_155_17_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_17_155_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_155_17_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_17_155_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE decoded #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;decoded&#39;, except it also tags each decoded entity with the length of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- JSON input that was consumed in order to obtain the value, not including the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- length of whitespace between each parsed JSON input.</span></span><span class="mpre">
</span><a href="#loc_168_1_168_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_9&#39;)"><span class="mpre">decodedL</span></a><span class="mpre">
  :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 6, srcSpanEndLine = 163, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 6, srcSpanEndLine = 162, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpan"><span class="mpre">(Monad m, Ae.FromJSON a, Ae.ToJSON a)
  =&gt;</span></span><span class="mpre"> (</span><a href="Data.Aeson.Types.Internal.html#loc_177_6_177_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Aeson.Types.Internal.html#loc_177_6_177_11&#39;)"><span class="hl_tyconref"><span class="mpre">Ae.Value</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ae.Object</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ae.Array</span></span><span class="mpre">)
     </span><span class="hl_comment"><span class="mpre">-- ^ A witness that @a@ can be represented either as an &#39;Ae.Object&#39; or as</span></span><span class="mpre">
     </span><span class="hl_comment"><span class="mpre">-- an &#39;Ae.Array&#39;. The passed in &#39;Ae.Value&#39; is @&#39;Ae.toJSON&#39; a@</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
           (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> (</span><a href="Pipes.Aeson.Internal.html#loc_29_6_29_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Aeson.Internal.html#loc_29_6_29_19&#39;)"><span class="hl_tyconref"><span class="mpre">I.DecodingError</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">))
</span><a name="loc_168_1_168_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_9&#39;)"><span class="hl_fundecl"><span class="mpre">decodedL</span></span></a><span class="mpre"> </span><a name="loc_168_10_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_10_168_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_168_12_168_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_12_168_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_168_14_168_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_14_168_16&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_170_5_170_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_5_170_12&#39;)"><span class="hl_varref"><span class="mpre">_encode</span></span></a><span class="mpre"> (</span><a href="#loc_168_12_168_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_12_168_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Pipes.Aeson.Internal.html#loc_61_1_61_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Aeson.Internal.html#loc_61_1_61_14&#39;)"><span class="hl_varref"><span class="mpre">I.consecutively</span></span></a><span class="mpre"> </span><a href="#loc_113_1_113_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_168_14_168_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_14_168_16&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre">))
  where
    </span><a name="loc_170_5_170_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_5_170_12&#39;)"><span class="hl_vardecl"><span class="mpre">_encode</span></span></a><span class="mpre"> = \</span><a name="loc_170_16_170_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_16_170_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
      </span><a name="loc_171_7_171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_7_171_9&#39;)"><span class="hl_vardecl"><span class="mpre">er</span></span></a><span class="mpre"> &lt;- </span><a href="Pipes.html#loc_150_1_150_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_150_1_150_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> </span><a href="#loc_170_16_170_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_16_170_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (\(_, </span><a name="loc_171_25_171_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_25_171_26&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><a href="#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">encodeObject</span></span></a><span class="mpre"> </span><a href="#loc_79_1_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_12&#39;)"><span class="hl_varref"><span class="mpre">encodeArray</span></span></a><span class="mpre"> (</span><a href="#loc_168_10_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_10_168_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">Ae.toJSON</span></span><span class="mpre"> </span><a href="#loc_171_25_171_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_25_171_26&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)))
      case </span><a href="#loc_171_7_171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_7_171_9&#39;)"><span class="hl_varref"><span class="mpre">er</span></span></a><span class="mpre"> of
         </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (_, </span><a name="loc_173_19_173_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_19_173_21&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_173_19_173_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_19_173_21&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">
         </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_174_16_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_16_174_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_174_16_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_16_174_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE decodedL #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Internal tools --------------------------------------------------------------</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 181, srcSpanStartColumn = 1, srcSpanEndLine = 181, srcSpanEndColumn = 66}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSpanStartLine = 181, srcSpanStartColumn = 1, srcSpanEndLine = 181, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-aeson-0.4.1.1/src/Pipes/Aeson.hs&quot;, srcSp"><span class="mpre">type Lens&#39; s a = forall f . Functor f =&gt; (a -&gt; f a) -&gt; (s -&gt; f s)</span></span><span class="mpre">
</span></div></body></html>