<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
module Web.Cookie
    ( </span><span class="hl_comment"><span class="mpre">-- * Server to client</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- ** Data type</span></span><span class="mpre">
      SetCookie
    , setCookieName
    , setCookieValue
    , setCookiePath
    , setCookieExpires
    , setCookieMaxAge
    , setCookieDomain
    , setCookieHttpOnly
    , setCookieSecure
      </span><span class="hl_comment"><span class="mpre">-- ** Functions</span></span><span class="mpre">
    , parseSetCookie
    , renderSetCookie
    , def
      </span><span class="hl_comment"><span class="mpre">-- * Client to server</span></span><span class="mpre">
    , Cookies
    , parseCookies
    , renderCookies
      </span><span class="hl_comment"><span class="mpre">-- ** UTF8 Version</span></span><span class="mpre">
    , CookiesText
    , parseCookiesText
    , renderCookiesText
      </span><span class="hl_comment"><span class="mpre">-- * Expires field</span></span><span class="mpre">
    , expiresFormat
    , formatCookieExpires
    , parseCookieExpires
    ) where

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 18, srcSpanEndLine = 32, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 18, srcSpanEndLine = 33, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as S8
import Data.Char (</span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">)
import Blaze.ByteString.Builder (</span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="mpre">Builder</span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="mpre">fromByteString</span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="mpre">copyByteString</span></a><span class="mpre">)
import Blaze.ByteString.Builder.Char8 (</span><a href="Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9&#39;)"><span class="mpre">fromChar</span></a><span class="mpre">)
import Data.Monoid (</span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="mpre">mconcat</span></a><span class="mpre">)
import Data.Word (Word8)
import Data.Ratio (numerator, denominator)
import Data.Time (</span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="mpre">UTCTime</span></a><span class="mpre">, </span><a href="Data.Time.Format.html#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Format.html#loc_150_1_150_11&#39;)"><span class="mpre">formatTime</span></a><span class="mpre">, </span><a href="Data.Time.Format.Parse.html#loc_88_1_88_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Format.Parse.html#loc_88_1_88_10&#39;)"><span class="mpre">parseTime</span></a><span class="mpre">)
import Data.Time.Clock (</span><a href="Data.Time.Clock.Scale.html#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_41_9_41_17&#39;)"><span class="mpre">DiffTime</span></a><span class="mpre">, </span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="mpre">secondsToDiffTime</span></a><span class="mpre">)
import System.Locale (</span><a href="System.Locale.html#loc_50_1_50_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Locale.html#loc_50_1_50_18&#39;)"><span class="mpre">defaultTimeLocale</span></a><span class="mpre">)
import Control.Arrow (</span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="mpre">first</span></a><span class="mpre">)
import Data.Text (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">)
import Data.Text.Encoding (</span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="mpre">encodeUtf8</span></a><span class="mpre">, </span><a href="Data.Text.Encoding.html#loc_142_1_142_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_142_1_142_15&#39;)"><span class="mpre">decodeUtf8With</span></a><span class="mpre">)
import Data.Text.Encoding.Error (</span><a href="Data.Text.Encoding.Error.html#loc_107_1_107_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_107_1_107_14&#39;)"><span class="mpre">lenientDecode</span></a><span class="mpre">)
import Control.Arrow (</span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="mpre">(***)</span></a><span class="mpre">)
import Data.Maybe (</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="mpre">isJust</span></a><span class="mpre">)
import Data.Default (</span><a href="Data.Default.Class.html#loc_38_7_38_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_38_7_38_14&#39;)"><span class="mpre">Default</span></a><span class="mpre"> (def))
import Control.DeepSeq (</span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="mpre">NFData</span></a><span class="mpre"> (</span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="mpre">rnf</span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Textual cookies. Functions assume UTF8 encoding.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 1, srcSpanEndLine = 53, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 1, srcSpanEndLine = 53, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 53, srcSpanStartColu"><span class="mpre">type CookiesText = [(Text, Text)]</span></span><span class="mpre">

</span><a href="#loc_56_1_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_17&#39;)"><span class="mpre">parseCookiesText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CookiesText</span></span><span class="mpre">
</span><a name="loc_56_1_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_17&#39;)"><span class="hl_vardecl"><span class="mpre">parseCookiesText</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_59_5_59_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><a href="#loc_59_5_59_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_69_1_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_13&#39;)"><span class="hl_varref"><span class="mpre">parseCookies</span></span></a><span class="mpre">
  where
    </span><a name="loc_59_5_59_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_7&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = </span><a href="Data.Text.Encoding.html#loc_142_1_142_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_142_1_142_15&#39;)"><span class="hl_varref"><span class="mpre">decodeUtf8With</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.Error.html#loc_107_1_107_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_107_1_107_14&#39;)"><span class="hl_varref"><span class="mpre">lenientDecode</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- FIXME to speed things up, skip encodeUtf8 and use fromText instead</span></span><span class="mpre">
</span><a href="#loc_63_1_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_18&#39;)"><span class="mpre">renderCookiesText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CookiesText</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_63_1_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_18&#39;)"><span class="hl_vardecl"><span class="mpre">renderCookiesText</span></span></a><span class="mpre"> = </span><a href="#loc_87_1_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_14&#39;)"><span class="hl_varref"><span class="mpre">renderCookies</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">encodeUtf8</span></span></a><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">encodeUtf8</span></span></a><span class="mpre">)

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 1, srcSpanEndLine = 65, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 1, srcSpanEndLine = 65, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 65, srcSpanStartColu"><span class="mpre">type Cookies = [(S.ByteString, S.ByteString)]</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Decode the value of a \&quot;Cookie\&quot; request header into key/value pairs.</span></span><span class="mpre">
</span><a href="#loc_69_1_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_13&#39;)"><span class="mpre">parseCookies</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Cookies</span></span><span class="mpre">
</span><a name="loc_69_1_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_13&#39;)"><span class="hl_fundecl"><span class="mpre">parseCookies</span></span></a><span class="mpre"> </span><a name="loc_69_14_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_14_69_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_69_14_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_14_69_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> = []
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
    let (</span><a name="loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_72_13_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_13_72_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><a href="#loc_82_1_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_13&#39;)"><span class="hl_varref"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><a href="#loc_69_14_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_14_69_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- semicolon</span></span><span class="mpre">
     in </span><a href="#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="hl_varref"><span class="mpre">parseCookie</span></span></a><span class="mpre"> </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_69_1_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_13&#39;)"><span class="hl_varref"><span class="mpre">parseCookies</span></span></a><span class="mpre"> </span><a href="#loc_72_13_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_13_72_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><a href="#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="mpre">parseCookie</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="hl_fundecl"><span class="mpre">parseCookie</span></span></a><span class="mpre"> </span><a name="loc_76_13_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_13_76_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    let (</span><a name="loc_77_10_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_13&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre">, </span><a name="loc_77_15_77_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_20&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre">) = </span><a href="#loc_82_1_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_13&#39;)"><span class="hl_varref"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">61</span></span><span class="mpre"> </span><a href="#loc_76_13_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_13_76_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- equals sign</span></span><span class="mpre">
        </span><a name="loc_78_9_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_13&#39;)"><span class="hl_vardecl"><span class="mpre">key&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">) </span><a href="#loc_77_10_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_13&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- space</span></span><span class="mpre">
     in (</span><a href="#loc_78_9_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_13&#39;)"><span class="hl_varref"><span class="mpre">key&#39;</span></span></a><span class="mpre">, </span><a href="#loc_77_15_77_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_20&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre">)

</span><a href="#loc_82_1_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_13&#39;)"><span class="mpre">breakDiscard</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_82_1_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_13&#39;)"><span class="hl_fundecl"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><a name="loc_82_14_82_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_14_82_15&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_82_16_82_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_16_82_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    let (</span><a name="loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_83_13_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.breakByte</span></span><span class="mpre"> </span><a href="#loc_82_14_82_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_14_82_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_82_16_82_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_16_82_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
     in (</span><a href="#loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_83_13_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><a href="#loc_87_1_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_14&#39;)"><span class="mpre">renderCookies</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Cookies</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_87_1_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_14&#39;)"><span class="hl_fundecl"><span class="mpre">renderCookies</span></span></a><span class="mpre"> [] = </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
</span><a href="#loc_87_1_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_14&#39;)"><span class="hl_fundecl"><span class="mpre">renderCookies</span></span></a><span class="mpre"> </span><a name="loc_88_15_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_15_88_17&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">foldr1</span></span><span class="mpre"> </span><a href="#loc_91_5_91_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_94_1_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_13&#39;)"><span class="hl_varref"><span class="mpre">renderCookie</span></span></a><span class="mpre"> </span><a href="#loc_88_15_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_15_88_17&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  where
    </span><a name="loc_91_5_91_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_91_8_91_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_8_91_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_91_10_91_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_10_91_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_91_8_91_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_8_91_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">fromChar</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;;&#39;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_91_10_91_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_10_91_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><a href="#loc_94_1_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_13&#39;)"><span class="mpre">renderCookie</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">) -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_94_1_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_13&#39;)"><span class="hl_fundecl"><span class="mpre">renderCookie</span></span></a><span class="mpre"> (</span><a name="loc_94_15_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_16&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_94_18_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_18_94_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_94_15_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">fromChar</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre">
                                       </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_94_18_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_18_94_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

data </span><a name="loc_97_6_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_15&#39;)"><span class="hl_tycondecl"><span class="mpre">SetCookie</span></span></a><span class="mpre"> = </span><a name="loc_97_18_97_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_27&#39;)"><span class="hl_condecl"><span class="mpre">SetCookie</span></span></a><span class="mpre">
    { </span><a name="loc_98_7_98_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_20&#39;)"><span class="hl_fielddecl"><span class="mpre">setCookieName</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
    , </span><a name="loc_99_7_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_7_99_21&#39;)"><span class="hl_fielddecl"><span class="mpre">setCookieValue</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
    , </span><a name="loc_100_7_100_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_7_100_20&#39;)"><span class="hl_fielddecl"><span class="mpre">setCookiePath</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
    , </span><a name="loc_101_7_101_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_7_101_23&#39;)"><span class="hl_fielddecl"><span class="mpre">setCookieExpires</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
    , </span><a name="loc_102_7_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_7_102_22&#39;)"><span class="hl_fielddecl"><span class="mpre">setCookieMaxAge</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Clock.Scale.html#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre">
    , </span><a name="loc_103_7_103_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_7_103_22&#39;)"><span class="hl_fielddecl"><span class="mpre">setCookieDomain</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
    , </span><a name="loc_104_7_104_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_7_104_24&#39;)"><span class="hl_fielddecl"><span class="mpre">setCookieHttpOnly</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    , </span><a name="loc_105_7_105_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_7_105_22&#39;)"><span class="hl_fielddecl"><span class="mpre">setCookieSecure</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 5, srcSpanEndLine = 107, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 5, srcSpanEndLine = 107, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 107, srcSpanSta"><span class="mpre">deriving (Eq, Show)</span></span><span class="mpre">

instance </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> </span><a href="#loc_97_6_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_15&#39;)"><span class="hl_tyconref"><span class="mpre">SetCookie</span></span></a><span class="mpre"> where
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><a href="#loc_97_18_97_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_27&#39;)"><span class="hl_conref"><span class="mpre">SetCookie</span></span></a><span class="mpre"> </span><a name="loc_110_20_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_20_110_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_110_22_110_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_22_110_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_110_24_110_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_24_110_25&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_110_26_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_26_110_27&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_110_28_110_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_28_110_29&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><a name="loc_110_30_110_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_30_110_31&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_110_32_110_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_32_110_33&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_110_34_110_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_34_110_35&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">) =
        </span><a href="#loc_110_20_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_20_110_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre">
        </span><a href="#loc_110_22_110_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_22_110_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre">
        </span><a href="#loc_121_9_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_15&#39;)"><span class="hl_varref"><span class="mpre">rnfMBS</span></span></a><span class="mpre"> </span><a href="#loc_110_24_110_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_24_110_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre">
        </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_110_26_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_26_110_27&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre">
        </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_110_28_110_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_28_110_29&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre">
        </span><a href="#loc_121_9_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_15&#39;)"><span class="hl_varref"><span class="mpre">rnfMBS</span></span></a><span class="mpre"> </span><a href="#loc_110_30_110_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_30_110_31&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre">
        </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_110_32_110_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_32_110_33&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre">
        </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_110_34_110_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_34_110_35&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
      where
        </span><span class="hl_comment"><span class="mpre">-- For backwards compatibility</span></span><span class="mpre">
        </span><a name="loc_121_9_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_15&#39;)"><span class="hl_fundecl"><span class="mpre">rnfMBS</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="#loc_121_9_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_15&#39;)"><span class="hl_fundecl"><span class="mpre">rnfMBS</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_122_22_122_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_22_122_24&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = </span><a href="#loc_122_22_122_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_22_122_24&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

instance </span><a href="Data.Default.Class.html#loc_38_7_38_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_38_7_38_14&#39;)"><span class="hl_classref"><span class="mpre">Default</span></span></a><span class="mpre"> </span><a href="#loc_97_6_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_15&#39;)"><span class="hl_tyconref"><span class="mpre">SetCookie</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">def</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 125, srcSpanStartColumn = 11, srcSpanEndLine = 134, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 126, srcSpanStartColumn = 9, srcSpanEndLine = 126, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 127, srcSpanS"><span class="mpre">SetCookie
        { setCookieName     = &quot;name&quot;
        , setCookieValue    = &quot;value&quot;
        , setCookiePath     = Nothing
        , setCookieExpires  = Nothing
        , setCookieMaxAge   = Nothing
        , setCookieDomain   = Nothing
        , setCookieHttpOnly = False
        , setCookieSecure   = False
        }</span></span><span class="mpre">

</span><a href="#loc_137_1_137_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_16&#39;)"><span class="mpre">renderSetCookie</span></a><span class="mpre"> :: </span><a href="#loc_97_6_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_15&#39;)"><span class="hl_tyconref"><span class="mpre">SetCookie</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_137_1_137_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_16&#39;)"><span class="hl_fundecl"><span class="mpre">renderSetCookie</span></span></a><span class="mpre"> </span><a name="loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_vardecl"><span class="mpre">sc</span></span></a><span class="mpre"> = </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre">
    [ </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> (</span><a href="#loc_98_7_98_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_20&#39;)"><span class="hl_varref"><span class="mpre">setCookieName</span></span></a><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre">)
    , </span><a href="Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">fromChar</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre">
    , </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> (</span><a href="#loc_99_7_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_7_99_21&#39;)"><span class="hl_varref"><span class="mpre">setCookieValue</span></span></a><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre">)
    , case </span><a href="#loc_100_7_100_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_7_100_20&#39;)"><span class="hl_varref"><span class="mpre">setCookiePath</span></span></a><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_143_14_143_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_14_143_18&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;; Path=&quot;</span></span><span class="mpre">
                     </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_143_14_143_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_14_143_18&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
    , case </span><a href="#loc_101_7_101_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_7_101_23&#39;)"><span class="hl_varref"><span class="mpre">setCookieExpires</span></span></a><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_147_14_147_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_14_147_15&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;; Expires=&quot;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre">
                  </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> (</span><a href="#loc_196_1_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_20&#39;)"><span class="hl_varref"><span class="mpre">formatCookieExpires</span></span></a><span class="mpre"> </span><a href="#loc_147_14_147_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_14_147_15&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
    , case </span><a href="#loc_102_7_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_7_102_22&#39;)"><span class="hl_varref"><span class="mpre">setCookieMaxAge</span></span></a><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_151_14_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_14_151_16&#39;)"><span class="hl_vardecl"><span class="mpre">ma</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">copyByteString</span></span></a><span class="hl_string"><span class="mpre">&quot;; Max-Age=&quot;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre">
                   </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> (</span><a href="#loc_204_1_204_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_19&#39;)"><span class="hl_varref"><span class="mpre">formatCookieMaxAge</span></span></a><span class="mpre"> </span><a href="#loc_151_14_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_14_151_16&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="mpre">)
    , case </span><a href="#loc_103_7_103_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_7_103_22&#39;)"><span class="hl_varref"><span class="mpre">setCookieDomain</span></span></a><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_155_14_155_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_14_155_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;; Domain=&quot;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre">
                  </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_155_14_155_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_14_155_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
    , if </span><a href="#loc_104_7_104_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_7_104_24&#39;)"><span class="hl_varref"><span class="mpre">setCookieHttpOnly</span></span></a><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre">
        then </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;; HttpOnly&quot;</span></span><span class="mpre">
        else </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
    , if </span><a href="#loc_105_7_105_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_7_105_22&#39;)"><span class="hl_varref"><span class="mpre">setCookieSecure</span></span></a><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre">
        then </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;; Secure&quot;</span></span><span class="mpre">
        else </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
    ]

</span><a href="#loc_166_1_166_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_15&#39;)"><span class="mpre">parseSetCookie</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_97_6_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_15&#39;)"><span class="hl_tyconref"><span class="mpre">SetCookie</span></span></a><span class="mpre">
</span><a name="loc_166_1_166_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_15&#39;)"><span class="hl_fundecl"><span class="mpre">parseSetCookie</span></span></a><span class="mpre"> </span><a name="loc_166_16_166_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_16_166_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 20, srcSpanEndLine = 177, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 5, srcSpanEndLine = 167, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cookie-0.4.1.1/Web/Cookie.hs&quot;, srcSpanStartLine = 168, srcSpanSta"><span class="mpre">SetCookie
    { setCookieName = key
    , setCookieValue = value
    , setCookiePath = lookup &quot;path&quot; pairs
    , setCookieExpires =
        lookup &quot;expires&quot; pairs &gt;&gt;= parseCookieExpires
    , setCookieMaxAge =
        lookup &quot;max-age&quot; pairs &gt;&gt;= parseCookieMaxAge
    , setCookieDomain = lookup &quot;domain&quot; pairs
    , setCookieHttpOnly = isJust $ lookup &quot;httponly&quot; pairs
    , setCookieSecure = isJust $ lookup &quot;secure&quot; pairs
    }</span></span><span class="mpre">
  where
    (</span><span class="hl_vardecl"><span class="mpre">key</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">value</span></span><span class="mpre">, </span><a name="loc_179_18_179_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_18_179_19&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_181_5_181_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_5_181_14&#39;)"><span class="hl_varref"><span class="mpre">parsePair</span></span></a><span class="mpre"> </span><a href="#loc_166_16_166_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_16_166_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">pairs</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S8.map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_185_5_185_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_15&#39;)"><span class="hl_varref"><span class="mpre">parsePairs</span></span></a><span class="mpre"> </span><a href="#loc_179_18_179_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_18_179_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
    </span><a name="loc_181_5_181_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_5_181_14&#39;)"><span class="hl_fundecl"><span class="mpre">parsePair</span></span></a><span class="mpre"> </span><a name="loc_181_15_181_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_15_181_17&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        let (</span><a name="loc_182_14_182_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_14_182_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_182_17_182_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_17_182_20&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_82_1_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_13&#39;)"><span class="hl_varref"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">61</span></span><span class="mpre"> </span><a href="#loc_181_15_181_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_15_181_17&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- equals sign</span></span><span class="mpre">
            (</span><a name="loc_183_14_183_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_14_183_15&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">, </span><a name="loc_183_17_183_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_17_183_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_82_1_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_13&#39;)"><span class="hl_varref"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><a href="#loc_182_17_182_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_17_182_20&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- semicolon</span></span><span class="mpre">
         in (</span><a href="#loc_182_14_182_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_14_182_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">, </span><a href="#loc_183_14_183_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_14_183_15&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">) </span><a href="#loc_183_17_183_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_17_183_21&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;&#39;</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- space</span></span><span class="mpre">
    </span><a name="loc_185_5_185_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_15&#39;)"><span class="hl_fundecl"><span class="mpre">parsePairs</span></span></a><span class="mpre"> </span><a name="loc_185_16_185_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_16_185_18&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_185_16_185_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_16_185_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            then []
            else let (</span><a name="loc_188_23_188_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_23_188_24&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_188_26_188_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_26_188_27&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">, </span><a name="loc_188_29_188_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_29_188_32&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_181_5_181_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_5_181_14&#39;)"><span class="hl_varref"><span class="mpre">parsePair</span></span></a><span class="mpre"> </span><a href="#loc_185_16_185_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_16_185_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                  in (</span><a href="#loc_188_23_188_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_23_188_24&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">, </span><a href="#loc_188_26_188_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_26_188_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_185_5_185_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_15&#39;)"><span class="hl_varref"><span class="mpre">parsePairs</span></span></a><span class="mpre"> </span><a href="#loc_188_29_188_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_29_188_32&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;</span></span></a><span class="mpre">

</span><a href="#loc_192_1_192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_14&#39;)"><span class="mpre">expiresFormat</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_192_1_192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_14&#39;)"><span class="hl_vardecl"><span class="mpre">expiresFormat</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;%a, %d-%b-%Y %X GMT&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Format a &#39;UTCTime&#39; for a cookie.</span></span><span class="mpre">
</span><a href="#loc_196_1_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_20&#39;)"><span class="mpre">formatCookieExpires</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_196_1_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_20&#39;)"><span class="hl_vardecl"><span class="mpre">formatCookieExpires</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Time.Format.html#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Format.html#loc_150_1_150_11&#39;)"><span class="hl_varref"><span class="mpre">formatTime</span></span></a><span class="mpre"> </span><a href="System.Locale.html#loc_50_1_50_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Locale.html#loc_50_1_50_18&#39;)"><span class="hl_varref"><span class="mpre">defaultTimeLocale</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_14&#39;)"><span class="hl_varref"><span class="mpre">expiresFormat</span></span></a><span class="mpre">

</span><a href="#loc_200_1_200_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_19&#39;)"><span class="mpre">parseCookieExpires</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
</span><a name="loc_200_1_200_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_19&#39;)"><span class="hl_vardecl"><span class="mpre">parseCookieExpires</span></span></a><span class="mpre"> = </span><a href="Data.Time.Format.Parse.html#loc_88_1_88_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Format.Parse.html#loc_88_1_88_10&#39;)"><span class="hl_varref"><span class="mpre">parseTime</span></span></a><span class="mpre"> </span><a href="System.Locale.html#loc_50_1_50_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Locale.html#loc_50_1_50_18&#39;)"><span class="hl_varref"><span class="mpre">defaultTimeLocale</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_14&#39;)"><span class="hl_varref"><span class="mpre">expiresFormat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S8.unpack</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Format a &#39;DiffTime&#39; for a cookie.</span></span><span class="mpre">
</span><a href="#loc_204_1_204_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_19&#39;)"><span class="mpre">formatCookieMaxAge</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.Scale.html#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_204_1_204_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_19&#39;)"><span class="hl_fundecl"><span class="mpre">formatCookieMaxAge</span></span></a><span class="mpre"> </span><a name="loc_204_20_204_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_20_204_28&#39;)"><span class="hl_vardecl"><span class="mpre">difftime</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_206_9_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_12&#39;)"><span class="hl_varref"><span class="mpre">num</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_207_9_207_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_9_207_14&#39;)"><span class="hl_varref"><span class="mpre">denom</span></span></a><span class="mpre">)
  where </span><a name="loc_205_9_205_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_17&#39;)"><span class="hl_vardecl"><span class="mpre">rational</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre"> </span><a href="#loc_204_20_204_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_20_204_28&#39;)"><span class="hl_varref"><span class="mpre">difftime</span></span></a><span class="mpre">
        </span><a name="loc_206_9_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_12&#39;)"><span class="hl_vardecl"><span class="mpre">num</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">numerator</span></span><span class="mpre"> </span><a href="#loc_205_9_205_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_17&#39;)"><span class="hl_varref"><span class="mpre">rational</span></span></a><span class="mpre">
        </span><a name="loc_207_9_207_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_9_207_14&#39;)"><span class="hl_vardecl"><span class="mpre">denom</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">denominator</span></span><span class="mpre"> </span><a href="#loc_205_9_205_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_17&#39;)"><span class="hl_varref"><span class="mpre">rational</span></span></a><span class="mpre">

</span><a href="#loc_210_1_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_18&#39;)"><span class="mpre">parseCookieMaxAge</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Clock.Scale.html#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre">
</span><a name="loc_210_1_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_18&#39;)"><span class="hl_fundecl"><span class="mpre">parseCookieMaxAge</span></span></a><span class="mpre"> </span><a name="loc_210_19_210_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_19_210_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (\ </span><a name="loc_211_12_211_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_12_211_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_211_12_211_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_12_211_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_211_12_211_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_12_211_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;9&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_213_9_213_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_17&#39;)"><span class="hl_varref"><span class="mpre">unpacked</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">read</span></span><span class="mpre"> </span><a href="#loc_213_9_213_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_17&#39;)"><span class="hl_varref"><span class="mpre">unpacked</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  where </span><a name="loc_213_9_213_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_17&#39;)"><span class="hl_vardecl"><span class="mpre">unpacked</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.unpack</span></span><span class="mpre"> </span><a href="#loc_210_19_210_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_19_210_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
</span></div></body></html>