<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Extension</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- basic extensions are defined in RFC 6066</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Extension
    ( Extension(..)
    , supportedExtensions
    </span><span class="hl_comment"><span class="mpre">-- all extensions ID supported</span></span><span class="mpre">
    , extensionID_ServerName
    , extensionID_MaxFragmentLength
    , extensionID_SecureRenegotiation
    , extensionID_NextProtocolNegotiation
    </span><span class="hl_comment"><span class="mpre">-- all implemented extensions</span></span><span class="mpre">
    , ServerNameType(..)
    , ServerName(..)
    , MaxFragmentLength(..)
    , MaxFragmentEnum(..)
    , SecureRenegotiation(..)
    , NextProtocolNegotiation(..)
    ) where

import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)
import Control.Monad

import Data.Word
import Data.Maybe (</span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="mpre">fromMaybe</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 8, srcSpanEndLine = 32, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 18, srcSpanEndLine = 33, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 18, srcSpanEndLine = 34, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BC

import Network.TLS.Struct (ExtensionID)
import Network.TLS.Wire
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 8, srcSpanEndLine = 38, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Network.BSD&quot;"><span class="mpre">Network.BSD</span></span><span class="mpre"> (HostName)

</span><a href="#loc_43_1_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_23&#39;)"><span class="mpre">extensionID_ServerName</span></a><span class="mpre">, </span><a href="#loc_44_1_44_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_30&#39;)"><span class="mpre">extensionID_MaxFragmentLength</span></a><span class="mpre">
                      , </span><a href="#loc_45_1_45_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_32&#39;)"><span class="mpre">extensionID_SecureRenegotiation</span></a><span class="mpre">
                      , </span><a href="#loc_46_1_46_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_36&#39;)"><span class="mpre">extensionID_NextProtocolNegotiation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ExtensionID</span></span><span class="mpre">
</span><a name="loc_43_1_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_23&#39;)"><span class="hl_vardecl"><span class="mpre">extensionID_ServerName</span></span></a><span class="mpre">              = </span><span class="hl_num"><span class="mpre">0x0</span></span><span class="mpre">
</span><a name="loc_44_1_44_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_30&#39;)"><span class="hl_vardecl"><span class="mpre">extensionID_MaxFragmentLength</span></span></a><span class="mpre">       = </span><span class="hl_num"><span class="mpre">0x1</span></span><span class="mpre">
</span><a name="loc_45_1_45_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_32&#39;)"><span class="hl_vardecl"><span class="mpre">extensionID_SecureRenegotiation</span></span></a><span class="mpre">     = </span><span class="hl_num"><span class="mpre">0xff01</span></span><span class="mpre">
</span><a name="loc_46_1_46_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_36&#39;)"><span class="hl_vardecl"><span class="mpre">extensionID_NextProtocolNegotiation</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0x3374</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | all supported extensions by the implementation</span></span><span class="mpre">
</span><a href="#loc_50_1_50_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_20&#39;)"><span class="mpre">supportedExtensions</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ExtensionID</span></span><span class="mpre">]
</span><a name="loc_50_1_50_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_20&#39;)"><span class="hl_vardecl"><span class="mpre">supportedExtensions</span></span></a><span class="mpre"> = [ </span><a href="#loc_43_1_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_23&#39;)"><span class="hl_varref"><span class="mpre">extensionID_ServerName</span></span></a><span class="mpre">
                      , </span><a href="#loc_44_1_44_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_30&#39;)"><span class="hl_varref"><span class="mpre">extensionID_MaxFragmentLength</span></span></a><span class="mpre">
                      , </span><a href="#loc_45_1_45_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_32&#39;)"><span class="hl_varref"><span class="mpre">extensionID_SecureRenegotiation</span></span></a><span class="mpre">
                      , </span><a href="#loc_46_1_46_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_36&#39;)"><span class="hl_varref"><span class="mpre">extensionID_NextProtocolNegotiation</span></span></a><span class="mpre">
                      ]

</span><span class="hl_comment"><span class="mpre">-- | Extension class to transform bytes to and from a high level Extension type.</span></span><span class="mpre">
class </span><a name="loc_57_7_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_16&#39;)"><span class="hl_classdecl"><span class="mpre">Extension</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
    </span><a name="loc_58_5_58_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_16&#39;)"><span class="mpre">extensionID</span></a><span class="mpre">     :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ExtensionID</span></span><span class="mpre">
    </span><a name="loc_59_5_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_20&#39;)"><span class="mpre">extensionDecode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
    </span><a name="loc_60_5_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_20&#39;)"><span class="mpre">extensionEncode</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Server Name extension including the name type and the associated name.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the associated name decoding is dependant of its name type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- name type = 0 : hostname</span></span><span class="mpre">
data </span><a name="loc_65_6_65_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_6_65_16&#39;)"><span class="hl_tycondecl"><span class="mpre">ServerName</span></span></a><span class="mpre"> = </span><a name="loc_65_19_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_19_65_29&#39;)"><span class="hl_condecl"><span class="mpre">ServerName</span></span></a><span class="mpre"> [</span><a href="#loc_68_6_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_6_68_20&#39;)"><span class="hl_tyconref"><span class="mpre">ServerNameType</span></span></a><span class="mpre">]
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 5, srcSpanEndLine = 66, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 5, srcSpanEndLine = 66, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 6"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

data </span><a name="loc_68_6_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_6_68_20&#39;)"><span class="hl_tycondecl"><span class="mpre">ServerNameType</span></span></a><span class="mpre"> = </span><a name="loc_68_23_68_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_23_68_41&#39;)"><span class="hl_condecl"><span class="mpre">ServerNameHostName</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HostName</span></span><span class="mpre">
                    | </span><a name="loc_69_23_69_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_23_69_38&#39;)"><span class="hl_condecl"><span class="mpre">ServerNameOther</span></span></a><span class="mpre">    (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
                    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 21, srcSpanEndLine = 70, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 21, srcSpanEndLine = 70, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine ="><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

instance </span><a href="#loc_57_7_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_16&#39;)"><span class="hl_classref"><span class="mpre">Extension</span></span></a><span class="mpre"> </span><a href="#loc_65_6_65_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_6_65_16&#39;)"><span class="hl_tyconref"><span class="mpre">ServerName</span></span></a><span class="mpre"> where
    </span><a href="#loc_58_5_58_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_16&#39;)"><span class="hl_fundecl"><span class="mpre">extensionID</span></span></a><span class="mpre"> _ = </span><a href="#loc_43_1_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_23&#39;)"><span class="hl_varref"><span class="mpre">extensionID_ServerName</span></span></a><span class="mpre">
    </span><a href="#loc_60_5_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_20&#39;)"><span class="hl_fundecl"><span class="mpre">extensionEncode</span></span></a><span class="mpre"> (</span><a href="#loc_65_19_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_19_65_29&#39;)"><span class="hl_conref"><span class="mpre">ServerName</span></span></a><span class="mpre"> </span><a name="loc_74_33_74_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_33_74_34&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_153_1_153_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_153_1_153_12&#39;)"><span class="hl_varref"><span class="mpre">putOpaque16</span></span></a><span class="mpre"> (</span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a href="#loc_75_15_75_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_29&#39;)"><span class="hl_varref"><span class="mpre">encodeNameType</span></span></a><span class="mpre"> </span><a href="#loc_74_33_74_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_33_74_34&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
        where </span><a name="loc_75_15_75_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_29&#39;)"><span class="hl_fundecl"><span class="mpre">encodeNameType</span></span></a><span class="mpre"> (</span><a href="#loc_68_23_68_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_23_68_41&#39;)"><span class="hl_conref"><span class="mpre">ServerNameHostName</span></span></a><span class="mpre"> </span><a name="loc_75_50_75_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_50_75_52&#39;)"><span class="hl_vardecl"><span class="mpre">hn</span></span></a><span class="mpre">)       = </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_153_1_153_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_153_1_153_12&#39;)"><span class="hl_varref"><span class="mpre">putOpaque16</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BC.pack</span></span><span class="mpre"> </span><a href="#loc_75_50_75_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_50_75_52&#39;)"><span class="hl_varref"><span class="mpre">hn</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- FIXME: should be puny code conversion</span></span><span class="mpre">
              </span><a href="#loc_75_15_75_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_29&#39;)"><span class="hl_fundecl"><span class="mpre">encodeNameType</span></span></a><span class="mpre"> (</span><a href="#loc_69_23_69_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_23_69_38&#39;)"><span class="hl_conref"><span class="mpre">ServerNameOther</span></span></a><span class="mpre"> (</span><a name="loc_76_48_76_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_48_76_50&#39;)"><span class="hl_vardecl"><span class="mpre">nt</span></span></a><span class="mpre">,</span><a name="loc_76_51_76_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_51_76_57&#39;)"><span class="hl_vardecl"><span class="mpre">opaque</span></span></a><span class="mpre">)) = </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> </span><a href="#loc_76_48_76_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_48_76_50&#39;)"><span class="hl_varref"><span class="mpre">nt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_147_1_147_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_147_1_147_9&#39;)"><span class="hl_varref"><span class="mpre">putBytes</span></span></a><span class="mpre"> </span><a href="#loc_76_51_76_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_51_76_57&#39;)"><span class="hl_varref"><span class="mpre">opaque</span></span></a><span class="mpre">
    </span><a href="#loc_59_5_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_20&#39;)"><span class="hl_fundecl"><span class="mpre">extensionDecode</span></span></a><span class="mpre"> _ = </span><a href="Network.TLS.Wire.html#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">runGetMaybe</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_77_53_77_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_53_77_56&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Wire.html#loc_117_1_117_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_117_1_117_8&#39;)"><span class="hl_varref"><span class="mpre">getList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_77_53_77_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_53_77_56&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><a href="#loc_78_15_78_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_15_78_28&#39;)"><span class="hl_varref"><span class="mpre">getServerName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_65_19_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_19_65_29&#39;)"><span class="hl_conref"><span class="mpre">ServerName</span></span></a><span class="mpre">)
        where </span><a name="loc_78_15_78_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_15_78_28&#39;)"><span class="hl_vardecl"><span class="mpre">getServerName</span></span></a><span class="mpre"> = do
                  </span><a name="loc_79_19_79_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_19_79_21&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre">    &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
                  </span><a name="loc_80_19_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_24&#39;)"><span class="hl_vardecl"><span class="mpre">sname</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_108_1_108_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_108_1_108_12&#39;)"><span class="hl_varref"><span class="mpre">getOpaque16</span></span></a><span class="mpre">
                  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_80_19_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_24&#39;)"><span class="hl_varref"><span class="mpre">sname</span></span></a><span class="mpre">, case </span><a href="#loc_79_19_79_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_19_79_21&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> of
                      </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; </span><a href="#loc_68_23_68_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_23_68_41&#39;)"><span class="hl_conref"><span class="mpre">ServerNameHostName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BC.unpack</span></span><span class="mpre"> </span><a href="#loc_80_19_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_24&#39;)"><span class="hl_varref"><span class="mpre">sname</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- FIXME: should be puny code conversion</span></span><span class="mpre">
                      _ -&gt; </span><a href="#loc_69_23_69_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_23_69_38&#39;)"><span class="hl_conref"><span class="mpre">ServerNameOther</span></span></a><span class="mpre"> (</span><a href="#loc_79_19_79_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_19_79_21&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">, </span><a href="#loc_80_19_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_24&#39;)"><span class="hl_varref"><span class="mpre">sname</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Max fragment extension with length from 512 bytes to 4096 bytes</span></span><span class="mpre">
data </span><a name="loc_86_6_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_23&#39;)"><span class="hl_tycondecl"><span class="mpre">MaxFragmentLength</span></span></a><span class="mpre"> = </span><a name="loc_86_26_86_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_26_86_43&#39;)"><span class="hl_condecl"><span class="mpre">MaxFragmentLength</span></span></a><span class="mpre"> </span><a href="#loc_88_6_88_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_21&#39;)"><span class="hl_tyconref"><span class="mpre">MaxFragmentEnum</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 5, srcSpanEndLine = 87, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 5, srcSpanEndLine = 87, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 8"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">
data </span><a name="loc_88_6_88_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_21&#39;)"><span class="hl_tycondecl"><span class="mpre">MaxFragmentEnum</span></span></a><span class="mpre"> = </span><a name="loc_88_24_88_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_24_88_38&#39;)"><span class="hl_condecl"><span class="mpre">MaxFragment512</span></span></a><span class="mpre"> | </span><a name="loc_88_41_88_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_41_88_56&#39;)"><span class="hl_condecl"><span class="mpre">MaxFragment1024</span></span></a><span class="mpre"> | </span><a name="loc_88_59_88_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_59_88_74&#39;)"><span class="hl_condecl"><span class="mpre">MaxFragment2048</span></span></a><span class="mpre"> | </span><a name="loc_88_77_88_92" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_77_88_92&#39;)"><span class="hl_condecl"><span class="mpre">MaxFragment4096</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 5, srcSpanEndLine = 89, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 5, srcSpanEndLine = 89, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 8"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

instance </span><a href="#loc_57_7_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_16&#39;)"><span class="hl_classref"><span class="mpre">Extension</span></span></a><span class="mpre"> </span><a href="#loc_86_6_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_23&#39;)"><span class="hl_tyconref"><span class="mpre">MaxFragmentLength</span></span></a><span class="mpre"> where
    </span><a href="#loc_58_5_58_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_16&#39;)"><span class="hl_fundecl"><span class="mpre">extensionID</span></span></a><span class="mpre"> _ = </span><a href="#loc_44_1_44_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_30&#39;)"><span class="hl_varref"><span class="mpre">extensionID_MaxFragmentLength</span></span></a><span class="mpre">
    </span><a href="#loc_60_5_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_20&#39;)"><span class="hl_fundecl"><span class="mpre">extensionEncode</span></span></a><span class="mpre"> (</span><a href="#loc_86_26_86_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_26_86_43&#39;)"><span class="hl_conref"><span class="mpre">MaxFragmentLength</span></span></a><span class="mpre"> </span><a name="loc_93_40_93_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_40_93_41&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.singleton</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_94_15_94_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_27&#39;)"><span class="hl_varref"><span class="mpre">marshallSize</span></span></a><span class="mpre"> </span><a href="#loc_93_40_93_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_40_93_41&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
        where </span><a name="loc_94_15_94_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_27&#39;)"><span class="hl_fundecl"><span class="mpre">marshallSize</span></span></a><span class="mpre"> </span><a href="#loc_88_24_88_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_24_88_38&#39;)"><span class="hl_conref"><span class="mpre">MaxFragment512</span></span></a><span class="mpre">  = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
              </span><a href="#loc_94_15_94_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_27&#39;)"><span class="hl_fundecl"><span class="mpre">marshallSize</span></span></a><span class="mpre"> </span><a href="#loc_88_41_88_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_41_88_56&#39;)"><span class="hl_conref"><span class="mpre">MaxFragment1024</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
              </span><a href="#loc_94_15_94_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_27&#39;)"><span class="hl_fundecl"><span class="mpre">marshallSize</span></span></a><span class="mpre"> </span><a href="#loc_88_59_88_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_59_88_74&#39;)"><span class="hl_conref"><span class="mpre">MaxFragment2048</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
              </span><a href="#loc_94_15_94_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_27&#39;)"><span class="hl_fundecl"><span class="mpre">marshallSize</span></span></a><span class="mpre"> </span><a href="#loc_88_77_88_92" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_77_88_92&#39;)"><span class="hl_conref"><span class="mpre">MaxFragment4096</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
    </span><a href="#loc_59_5_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_20&#39;)"><span class="hl_fundecl"><span class="mpre">extensionDecode</span></span></a><span class="mpre"> _ = </span><a href="Network.TLS.Wire.html#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">runGetMaybe</span></span></a><span class="mpre"> (</span><a href="#loc_86_26_86_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_26_86_43&#39;)"><span class="hl_conref"><span class="mpre">MaxFragmentLength</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_varref"><span class="mpre">unmarshallSize</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">)
        where </span><a name="loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_fundecl"><span class="mpre">unmarshallSize</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><a href="#loc_88_24_88_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_24_88_38&#39;)"><span class="hl_conref"><span class="mpre">MaxFragment512</span></span></a><span class="mpre">
              </span><a href="#loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_fundecl"><span class="mpre">unmarshallSize</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> = </span><a href="#loc_88_41_88_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_41_88_56&#39;)"><span class="hl_conref"><span class="mpre">MaxFragment1024</span></span></a><span class="mpre">
              </span><a href="#loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_fundecl"><span class="mpre">unmarshallSize</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> = </span><a href="#loc_88_59_88_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_59_88_74&#39;)"><span class="hl_conref"><span class="mpre">MaxFragment2048</span></span></a><span class="mpre">
              </span><a href="#loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_fundecl"><span class="mpre">unmarshallSize</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> = </span><a href="#loc_88_77_88_92" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_77_88_92&#39;)"><span class="hl_conref"><span class="mpre">MaxFragment4096</span></span></a><span class="mpre">
              </span><a href="#loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_fundecl"><span class="mpre">unmarshallSize</span></span></a><span class="mpre"> </span><a name="loc_103_30_103_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_30_103_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;unknown max fragment size &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_103_30_103_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_30_103_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Secure Renegotiation</span></span><span class="mpre">
data </span><a name="loc_106_6_106_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_6_106_25&#39;)"><span class="hl_tycondecl"><span class="mpre">SecureRenegotiation</span></span></a><span class="mpre"> = </span><a name="loc_106_28_106_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_47&#39;)"><span class="hl_condecl"><span class="mpre">SecureRenegotiation</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 5, srcSpanEndLine = 107, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 5, srcSpanEndLine = 107, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

instance </span><a href="#loc_57_7_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_16&#39;)"><span class="hl_classref"><span class="mpre">Extension</span></span></a><span class="mpre"> </span><a href="#loc_106_6_106_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_6_106_25&#39;)"><span class="hl_tyconref"><span class="mpre">SecureRenegotiation</span></span></a><span class="mpre"> where
    </span><a href="#loc_58_5_58_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_16&#39;)"><span class="hl_fundecl"><span class="mpre">extensionID</span></span></a><span class="mpre"> _ = </span><a href="#loc_45_1_45_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_32&#39;)"><span class="hl_varref"><span class="mpre">extensionID_SecureRenegotiation</span></span></a><span class="mpre">
    </span><a href="#loc_60_5_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_20&#39;)"><span class="hl_fundecl"><span class="mpre">extensionEncode</span></span></a><span class="mpre"> (</span><a href="#loc_106_28_106_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_47&#39;)"><span class="hl_conref"><span class="mpre">SecureRenegotiation</span></span></a><span class="mpre"> </span><a name="loc_111_42_111_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_42_111_45&#39;)"><span class="hl_vardecl"><span class="mpre">cvd</span></span></a><span class="mpre"> </span><a name="loc_111_46_111_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_46_111_49&#39;)"><span class="hl_vardecl"><span class="mpre">svd</span></span></a><span class="mpre">) =
        </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_150_1_150_11&#39;)"><span class="hl_varref"><span class="mpre">putOpaque8</span></span></a><span class="mpre"> (</span><a href="#loc_111_42_111_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_42_111_45&#39;)"><span class="hl_varref"><span class="mpre">cvd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre"> </span><a href="#loc_111_46_111_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_46_111_49&#39;)"><span class="hl_varref"><span class="mpre">svd</span></span></a><span class="mpre">)
    </span><a href="#loc_59_5_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_20&#39;)"><span class="hl_fundecl"><span class="mpre">extensionDecode</span></span></a><span class="mpre"> </span><a name="loc_113_21_113_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_21_113_34&#39;)"><span class="hl_vardecl"><span class="mpre">isServerHello</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">runGetMaybe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_114_9_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_15&#39;)"><span class="hl_vardecl"><span class="mpre">opaque</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_105_1_105_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_105_1_105_11&#39;)"><span class="hl_varref"><span class="mpre">getOpaque8</span></span></a><span class="mpre">
        if </span><a href="#loc_113_21_113_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_21_113_34&#39;)"><span class="hl_varref"><span class="mpre">isServerHello</span></span></a><span class="mpre">
           then let (</span><a name="loc_116_22_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_25&#39;)"><span class="hl_vardecl"><span class="mpre">cvd</span></span></a><span class="mpre">, </span><a name="loc_116_27_116_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_27_116_30&#39;)"><span class="hl_vardecl"><span class="mpre">svd</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_114_9_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_15&#39;)"><span class="hl_varref"><span class="mpre">opaque</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_114_9_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_15&#39;)"><span class="hl_varref"><span class="mpre">opaque</span></span></a><span class="mpre">
                 in </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_106_28_106_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_47&#39;)"><span class="hl_conref"><span class="mpre">SecureRenegotiation</span></span></a><span class="mpre"> </span><a href="#loc_116_22_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_25&#39;)"><span class="hl_varref"><span class="mpre">cvd</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_116_27_116_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_27_116_30&#39;)"><span class="hl_varref"><span class="mpre">svd</span></span></a><span class="mpre">)
           else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_106_28_106_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_47&#39;)"><span class="hl_conref"><span class="mpre">SecureRenegotiation</span></span></a><span class="mpre"> </span><a href="#loc_114_9_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_15&#39;)"><span class="hl_varref"><span class="mpre">opaque</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Next Protocol Negotiation</span></span><span class="mpre">
data </span><a name="loc_121_6_121_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_29&#39;)"><span class="hl_tycondecl"><span class="mpre">NextProtocolNegotiation</span></span></a><span class="mpre"> = </span><a name="loc_121_32_121_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_55&#39;)"><span class="hl_condecl"><span class="mpre">NextProtocolNegotiation</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">]
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 5, srcSpanEndLine = 122, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 5, srcSpanEndLine = 122, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Extension.hs&quot;, srcSpanStartLine"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

instance </span><a href="#loc_57_7_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_16&#39;)"><span class="hl_classref"><span class="mpre">Extension</span></span></a><span class="mpre"> </span><a href="#loc_121_6_121_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_29&#39;)"><span class="hl_tyconref"><span class="mpre">NextProtocolNegotiation</span></span></a><span class="mpre"> where
    </span><a href="#loc_58_5_58_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_16&#39;)"><span class="hl_fundecl"><span class="mpre">extensionID</span></span></a><span class="mpre"> _ = </span><a href="#loc_46_1_46_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_36&#39;)"><span class="hl_varref"><span class="mpre">extensionID_NextProtocolNegotiation</span></span></a><span class="mpre">
    </span><a href="#loc_60_5_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_20&#39;)"><span class="hl_fundecl"><span class="mpre">extensionEncode</span></span></a><span class="mpre"> (</span><a href="#loc_121_32_121_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_55&#39;)"><span class="hl_conref"><span class="mpre">NextProtocolNegotiation</span></span></a><span class="mpre"> </span><a name="loc_126_46_126_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_46_126_51&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre">) =
        </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_150_1_150_11&#39;)"><span class="hl_varref"><span class="mpre">putOpaque8</span></span></a><span class="mpre"> </span><a href="#loc_126_46_126_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_46_126_51&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">
    </span><a href="#loc_59_5_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_20&#39;)"><span class="hl_fundecl"><span class="mpre">extensionDecode</span></span></a><span class="mpre"> _ = </span><a href="Network.TLS.Wire.html#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">runGetMaybe</span></span></a><span class="mpre"> (</span><a href="#loc_121_32_121_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_55&#39;)"><span class="hl_conref"><span class="mpre">NextProtocolNegotiation</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_129_15_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_15_129_21&#39;)"><span class="hl_varref"><span class="mpre">getNPN</span></span></a><span class="mpre">)
        where </span><a name="loc_129_15_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_15_129_21&#39;)"><span class="hl_vardecl"><span class="mpre">getNPN</span></span></a><span class="mpre"> = do
                 </span><a name="loc_130_18_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_18_130_23&#39;)"><span class="hl_vardecl"><span class="mpre">avail</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_408_1_408_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_408_1_408_10&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre">
                 case </span><a href="#loc_130_18_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_18_130_23&#39;)"><span class="hl_varref"><span class="mpre">avail</span></span></a><span class="mpre"> of
                     </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
                     _ -&gt; do </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_105_1_105_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_105_1_105_11&#39;)"><span class="hl_varref"><span class="mpre">getOpaque8</span></span></a><span class="mpre"> </span><a href="#loc_129_15_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_15_129_21&#39;)"><span class="hl_varref"><span class="mpre">getNPN</span></span></a><span class="mpre">
</span></div></body></html>