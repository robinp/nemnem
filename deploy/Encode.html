<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

</span><span class="hl_comment"><span class="mpre">-- A bit more test code for the 2nd boilerplate paper.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These are downscaled versions of library functionality or real test cases.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We just wanted to typecheck the fragments as shown in the paper.</span></span><span class="mpre">

module Encode () where

import Data.Generics

data </span><a name="loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tycondecl"><span class="mpre">Bit</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Zero</span></span><span class="mpre"> | </span><span class="hl_condecl"><span class="mpre">One</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Sec. 3.2</span></span><span class="mpre">

</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="mpre">data2bits</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 14, srcSpanEndLine = 16, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 21, srcSpanEndLine = 16, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpa"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="#loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tyconref"><span class="mpre">Bit</span></span></a><span class="mpre">]
</span><a name="loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">data2bits</span></span></a><span class="mpre"> </span><a name="loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_varref"><span class="mpre">encodeCon</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><a href="#loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
                </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_varref"><span class="mpre">data2bits</span></span></a><span class="mpre"> </span><a href="#loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- The encoder for constructors</span></span><span class="mpre">
</span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="mpre">encodeCon</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DataType</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre"> -&gt; [</span><a href="#loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tyconref"><span class="mpre">Bit</span></span></a><span class="mpre">]
</span><a name="loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_fundecl"><span class="mpre">encodeCon</span></span></a><span class="mpre"> </span><a name="loc_22_11_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_13&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a name="loc_22_14_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_14_22_17&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> = </span><a href="#loc_29_1_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_9&#39;)"><span class="hl_varref"><span class="mpre">natToBin</span></span></a><span class="mpre"> (</span><a href="#loc_24_21_24_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_21_24_24&#39;)"><span class="hl_varref"><span class="mpre">max</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_25_21_25_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_21_25_24&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                  where
                    </span><a name="loc_24_21_24_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_21_24_24&#39;)"><span class="hl_vardecl"><span class="mpre">max</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maxConstrIndex</span></span><span class="mpre"> </span><a href="#loc_22_11_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_13&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">
                    </span><a name="loc_25_21_25_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_21_25_24&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">constrIndex</span></span><span class="mpre"> </span><a href="#loc_22_14_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_14_22_17&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">


</span><a href="#loc_29_1_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_9&#39;)"><span class="mpre">natToBin</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><a href="#loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tyconref"><span class="mpre">Bit</span></span></a><span class="mpre">]
</span><a name="loc_29_1_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_9&#39;)"><span class="hl_vardecl"><span class="mpre">natToBin</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Sec. 3.3</span></span><span class="mpre">

data </span><a name="loc_34_6_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_11&#39;)"><span class="hl_tycondecl"><span class="mpre">State</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- Abstract</span></span><span class="mpre">
</span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="mpre">initState</span></a><span class="mpre">  :: </span><a href="#loc_34_6_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_11&#39;)"><span class="hl_tyconref"><span class="mpre">State</span></span></a><span class="mpre">
</span><a href="#loc_40_1_40_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_11&#39;)"><span class="mpre">encodeCon&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DataType</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">
           -&gt; </span><a href="#loc_34_6_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_11&#39;)"><span class="hl_tyconref"><span class="mpre">State</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_34_6_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_11&#39;)"><span class="hl_tyconref"><span class="mpre">State</span></span></a><span class="mpre">, [</span><a href="#loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tyconref"><span class="mpre">Bit</span></span></a><span class="mpre">])

</span><a name="loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_vardecl"><span class="mpre">initState</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
</span><a name="loc_40_1_40_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_11&#39;)"><span class="hl_vardecl"><span class="mpre">encodeCon&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">

</span><a href="#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="mpre">data2bits&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 15, srcSpanEndLine = 42, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 22, srcSpanEndLine = 42, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpa"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="#loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tyconref"><span class="mpre">Bit</span></span></a><span class="mpre">]
</span><a name="loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="hl_fundecl"><span class="mpre">data2bits&#39;</span></span></a><span class="mpre"> </span><a name="loc_43_12_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_13&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> (</span><a href="#loc_46_1_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_9&#39;)"><span class="hl_varref"><span class="mpre">show_bin</span></span></a><span class="mpre"> </span><a href="#loc_43_12_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_13&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">initState</span></span></a><span class="mpre">)

</span><a href="#loc_46_1_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_9&#39;)"><span class="mpre">show_bin</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 13, srcSpanEndLine = 45, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 20, srcSpanEndLine = 45, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpa"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_34_6_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_11&#39;)"><span class="hl_tyconref"><span class="mpre">State</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_34_6_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_11&#39;)"><span class="hl_tyconref"><span class="mpre">State</span></span></a><span class="mpre">, [</span><a href="#loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tyconref"><span class="mpre">Bit</span></span></a><span class="mpre">])
</span><a name="loc_46_1_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_9&#39;)"><span class="hl_fundecl"><span class="mpre">show_bin</span></span></a><span class="mpre"> </span><a name="loc_46_10_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_46_12_46_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_12_46_14&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> = (</span><a href="#loc_50_6_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_9&#39;)"><span class="hl_varref"><span class="mpre">st2</span></span></a><span class="mpre">, </span><a href="#loc_48_11_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_19&#39;)"><span class="hl_varref"><span class="mpre">con_bits</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_50_11_50_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_20&#39;)"><span class="hl_varref"><span class="mpre">args_bits</span></span></a><span class="mpre">)
   where
    (</span><a name="loc_48_6_48_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_6_48_9&#39;)"><span class="hl_vardecl"><span class="mpre">st1</span></span></a><span class="mpre">, </span><a name="loc_48_11_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_19&#39;)"><span class="hl_vardecl"><span class="mpre">con_bits</span></span></a><span class="mpre">)  = </span><a href="#loc_40_1_40_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_11&#39;)"><span class="hl_varref"><span class="mpre">encodeCon&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><a href="#loc_46_10_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
                                  (</span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_46_10_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="#loc_46_12_46_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_12_46_14&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">
    (</span><a name="loc_50_6_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_9&#39;)"><span class="hl_vardecl"><span class="mpre">st2</span></span></a><span class="mpre">, </span><a name="loc_50_11_50_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_20&#39;)"><span class="hl_vardecl"><span class="mpre">args_bits</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_56_5_56_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_5_56_11&#39;)"><span class="hl_varref"><span class="mpre">do_arg</span></span></a><span class="mpre"> (</span><a href="#loc_48_6_48_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_6_48_9&#39;)"><span class="hl_varref"><span class="mpre">st1</span></span></a><span class="mpre">,[])
                             </span><a href="#loc_54_5_54_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_13&#39;)"><span class="hl_varref"><span class="mpre">enc_args</span></span></a><span class="mpre">

    </span><a href="#loc_54_5_54_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_13&#39;)"><span class="mpre">enc_args</span></a><span class="mpre"> :: [</span><a href="#loc_34_6_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_11&#39;)"><span class="hl_tyconref"><span class="mpre">State</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_34_6_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_11&#39;)"><span class="hl_tyconref"><span class="mpre">State</span></span></a><span class="mpre">,[</span><a href="#loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tyconref"><span class="mpre">Bit</span></span></a><span class="mpre">])]
    </span><a name="loc_54_5_54_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_13&#39;)"><span class="hl_vardecl"><span class="mpre">enc_args</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><a href="#loc_46_1_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_9&#39;)"><span class="hl_varref"><span class="mpre">show_bin</span></span></a><span class="mpre"> </span><a href="#loc_46_10_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

    </span><a name="loc_56_5_56_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_5_56_11&#39;)"><span class="hl_fundecl"><span class="mpre">do_arg</span></span></a><span class="mpre"> </span><a name="loc_56_12_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_12_56_14&#39;)"><span class="hl_vardecl"><span class="mpre">fn</span></span></a><span class="mpre"> (</span><a name="loc_56_16_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_16_56_18&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre">,</span><a name="loc_56_19_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_23&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="mpre">) = (</span><a href="#loc_58_10_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_13&#39;)"><span class="hl_varref"><span class="mpre">st&#39;</span></span></a><span class="mpre">, </span><a href="#loc_58_15_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_15_58_20&#39;)"><span class="hl_varref"><span class="mpre">bits&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_56_19_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_23&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre">)
      where
        (</span><a name="loc_58_10_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_13&#39;)"><span class="hl_vardecl"><span class="mpre">st&#39;</span></span></a><span class="mpre">, </span><a name="loc_58_15_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_15_58_20&#39;)"><span class="hl_vardecl"><span class="mpre">bits&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_56_12_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_12_56_14&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre"> </span><a href="#loc_56_16_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_16_56_18&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Sec. 3.3 cont&#39;d</span></span><span class="mpre">

data </span><a name="loc_64_6_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_6_64_10&#39;)"><span class="hl_tycondecl"><span class="mpre">EncM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- The encoder monad</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_64_6_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_6_64_10&#39;)"><span class="hl_tyconref"><span class="mpre">EncM</span></span></a><span class="mpre">
 where
  </span><span class="hl_vardecl"><span class="mpre">return</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  </span><span class="hl_vardecl"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">

</span><a href="#loc_73_1_73_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_7&#39;)"><span class="mpre">runEnc</span></a><span class="mpre">  :: </span><a href="#loc_64_6_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_6_64_10&#39;)"><span class="hl_tyconref"><span class="mpre">EncM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> -&gt; [</span><a href="#loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tyconref"><span class="mpre">Bit</span></span></a><span class="mpre">]
</span><a href="#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_8&#39;)"><span class="mpre">emitCon</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DataType</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre"> -&gt; </span><a href="#loc_64_6_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_6_64_10&#39;)"><span class="hl_tyconref"><span class="mpre">EncM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">

</span><a name="loc_73_1_73_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_7&#39;)"><span class="hl_vardecl"><span class="mpre">runEnc</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
</span><a name="loc_74_1_74_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_8&#39;)"><span class="hl_vardecl"><span class="mpre">emitCon</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">

</span><a href="#loc_77_1_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_12&#39;)"><span class="mpre">data2bits&#39;&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 16, srcSpanEndLine = 76, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 23, srcSpanEndLine = 76, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpa"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="#loc_11_6_11_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_9&#39;)"><span class="hl_tyconref"><span class="mpre">Bit</span></span></a><span class="mpre">]
</span><a name="loc_77_1_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_12&#39;)"><span class="hl_fundecl"><span class="mpre">data2bits&#39;&#39;</span></span></a><span class="mpre"> </span><a name="loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_73_1_73_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_7&#39;)"><span class="hl_varref"><span class="mpre">runEnc</span></span></a><span class="mpre"> (</span><a href="#loc_80_1_80_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)

</span><a href="#loc_80_1_80_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_5&#39;)"><span class="mpre">emit</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 9, srcSpanEndLine = 79, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 16, srcSpanEndLine = 79, srcSpanEndColumn = 18}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Encode.hs&quot;, srcSpan"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_64_6_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_6_64_10&#39;)"><span class="hl_tyconref"><span class="mpre">EncM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_80_1_80_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_5&#39;)"><span class="hl_fundecl"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a name="loc_80_6_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_6_80_7&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = do { </span><a href="#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">emitCon</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><a href="#loc_80_6_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_6_80_7&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_80_6_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_6_80_7&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) 
            ; </span><span class="hl_varref"><span class="mpre">sequence_</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><a href="#loc_80_1_80_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_80_6_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_6_80_7&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) }
</span></div></body></html>