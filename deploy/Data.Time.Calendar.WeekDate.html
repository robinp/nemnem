<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | ISO 8601 Week Date format</span></span><span class="mpre">
module Data.Time.Calendar.WeekDate where

import Data.Time.Calendar.OrdinalDate
import Data.Time.Calendar.Days
import Data.Time.Calendar.Private

</span><span class="hl_comment"><span class="mpre">-- | convert to ISO 8601 Week Date format. First element of result is year, second week number (1-53), third day of week (1 for Monday to 7 for Sunday).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that \&quot;Week\&quot; years are not quite the same as Gregorian years, as the first day of the year is always a Monday.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The first week of a year is the first week to contain at least four days in the corresponding Gregorian year.</span></span><span class="mpre">
</span><a href="#loc_12_1_12_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_11&#39;)"><span class="mpre">toWeekDate</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_12_1_12_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_11&#39;)"><span class="hl_fundecl"><span class="mpre">toWeekDate</span></span></a><span class="mpre"> </span><a name="loc_12_12_12_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_12_12_16&#39;)"><span class="hl_specname"><span class="mpre">date</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><a name="loc_12_36_12_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_36_12_39&#39;)"><span class="hl_vardecl"><span class="mpre">mjd</span></span></a><span class="mpre">) = (</span><a href="#loc_19_10_19_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_12&#39;)"><span class="hl_varref"><span class="mpre">y1</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><a href="#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_13_19_15&#39;)"><span class="hl_varref"><span class="mpre">w1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">),</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_14_9_14_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) where
        (</span><a name="loc_13_10_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_10_13_12&#39;)"><span class="hl_vardecl"><span class="mpre">y0</span></span></a><span class="mpre">,</span><a name="loc_13_13_13_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_13_13_15&#39;)"><span class="hl_vardecl"><span class="mpre">yd</span></span></a><span class="mpre">) = </span><a href="Data.Time.Calendar.OrdinalDate.html#loc_10_1_10_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.OrdinalDate.html#loc_10_1_10_14&#39;)"><span class="hl_varref"><span class="mpre">toOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_12_12_12_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_12_12_16&#39;)"><span class="hl_varref"><span class="mpre">date</span></span></a><span class="mpre">
        </span><a name="loc_14_9_14_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="#loc_12_36_12_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_36_12_39&#39;)"><span class="hl_varref"><span class="mpre">mjd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
        </span><a href="#loc_16_9_16_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_12&#39;)"><span class="mpre">foo</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
        </span><a name="loc_16_9_16_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_12&#39;)"><span class="hl_fundecl"><span class="mpre">foo</span></span></a><span class="mpre"> </span><a name="loc_16_13_16_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_13_16_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_17_9_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_12&#39;)"><span class="hl_varref"><span class="mpre">bar</span></span></a><span class="mpre"> (</span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> (</span><a href="Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_16_13_16_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_13_16_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">))
        </span><a name="loc_17_9_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_12&#39;)"><span class="hl_fundecl"><span class="mpre">bar</span></span></a><span class="mpre"> </span><a name="loc_17_13_17_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_13_17_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_14_9_14_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_17_13_17_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_13_17_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">)
        </span><a name="loc_18_9_18_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_11&#39;)"><span class="hl_vardecl"><span class="mpre">w0</span></span></a><span class="mpre"> = </span><a href="#loc_17_9_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_12&#39;)"><span class="hl_varref"><span class="mpre">bar</span></span></a><span class="mpre"> (</span><a href="#loc_14_9_14_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><a href="#loc_13_13_13_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_13_13_15&#39;)"><span class="hl_varref"><span class="mpre">yd</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
        (</span><a name="loc_19_10_19_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_12&#39;)"><span class="hl_vardecl"><span class="mpre">y1</span></span></a><span class="mpre">,</span><a name="loc_19_13_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_13_19_15&#39;)"><span class="hl_vardecl"><span class="mpre">w1</span></span></a><span class="mpre">) = if </span><a href="#loc_18_9_18_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_11&#39;)"><span class="hl_varref"><span class="mpre">w0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> -</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                then (</span><a href="#loc_13_10_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_10_13_12&#39;)"><span class="hl_varref"><span class="mpre">y0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><a href="#loc_16_9_16_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_12&#39;)"><span class="hl_varref"><span class="mpre">foo</span></span></a><span class="mpre"> (</span><a href="#loc_13_10_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_10_13_12&#39;)"><span class="hl_varref"><span class="mpre">y0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))
                else if </span><a href="#loc_18_9_18_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_11&#39;)"><span class="hl_varref"><span class="mpre">w0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">52</span></span><span class="mpre">
                then if (</span><a href="#loc_16_9_16_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_12&#39;)"><span class="hl_varref"><span class="mpre">foo</span></span></a><span class="mpre"> (</span><a href="#loc_13_10_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_10_13_12&#39;)"><span class="hl_varref"><span class="mpre">y0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                        then (</span><a href="#loc_13_10_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_10_13_12&#39;)"><span class="hl_varref"><span class="mpre">y0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
                        else (</span><a href="#loc_13_10_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_10_13_12&#39;)"><span class="hl_varref"><span class="mpre">y0</span></span></a><span class="mpre">,</span><a href="#loc_18_9_18_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_11&#39;)"><span class="hl_varref"><span class="mpre">w0</span></span></a><span class="mpre">)
                else (</span><a href="#loc_13_10_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_10_13_12&#39;)"><span class="hl_varref"><span class="mpre">y0</span></span></a><span class="mpre">,</span><a href="#loc_18_9_18_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_11&#39;)"><span class="hl_varref"><span class="mpre">w0</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | convert from ISO 8601 Week Date format. First argument is year, second week number (1-52 or 53), third day of week (1 for Monday to 7 for Sunday).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid week and day values will be clipped to the correct range.</span></span><span class="mpre">
</span><a href="#loc_30_1_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_13&#39;)"><span class="mpre">fromWeekDate</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_30_1_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromWeekDate</span></span></a><span class="mpre"> </span><a name="loc_30_14_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_30_16_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_16_30_17&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_30_18_30_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_18_30_19&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> (</span><a href="#loc_31_17_31_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_18&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_31_17_31_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_18&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> (((</span><a href="Data.Time.Calendar.Private.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_43_1_43_5&#39;)"><span class="hl_varref"><span class="mpre">clip</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (if </span><a href="#loc_32_17_32_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_17_32_25&#39;)"><span class="hl_varref"><span class="mpre">longYear</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">53</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">52</span></span><span class="mpre">) </span><a href="#loc_30_16_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_16_30_17&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Private.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_43_1_43_5&#39;)"><span class="hl_varref"><span class="mpre">clip</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><a href="#loc_30_18_30_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_18_30_19&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">))) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) where
                </span><a name="loc_31_17_31_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_18&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> (</span><a href="Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_30_14_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)
                </span><a name="loc_32_17_32_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_17_32_25&#39;)"><span class="hl_vardecl"><span class="mpre">longYear</span></span></a><span class="mpre"> = case </span><a href="#loc_12_1_12_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_11&#39;)"><span class="hl_varref"><span class="mpre">toWeekDate</span></span></a><span class="mpre"> (</span><a href="Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_30_14_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) of
                        (_,</span><span class="hl_num"><span class="mpre">53</span></span><span class="mpre">,_) -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                        _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | convert from ISO 8601 Week Date format. First argument is year, second week number (1-52 or 53), third day of week (1 for Monday to 7 for Sunday).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid week and day values will return Nothing.</span></span><span class="mpre">
</span><a href="#loc_39_1_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_18&#39;)"><span class="mpre">fromWeekDateValid</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_39_1_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_18&#39;)"><span class="hl_fundecl"><span class="mpre">fromWeekDateValid</span></span></a><span class="mpre"> </span><a name="loc_39_19_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_20&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_39_21_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_21_39_22&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_39_23_39_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_24&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = do
        </span><a name="loc_40_9_40_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_11&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Calendar.Private.html#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">clipValid</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><a href="#loc_39_23_39_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_24&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
        let
                </span><a name="loc_42_17_42_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_25&#39;)"><span class="hl_vardecl"><span class="mpre">longYear</span></span></a><span class="mpre"> = case </span><a href="#loc_12_1_12_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_11&#39;)"><span class="hl_varref"><span class="mpre">toWeekDate</span></span></a><span class="mpre"> (</span><a href="Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_39_19_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_20&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) of
                        (_,</span><span class="hl_num"><span class="mpre">53</span></span><span class="mpre">,_) -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                        _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        </span><a name="loc_45_9_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_11&#39;)"><span class="hl_vardecl"><span class="mpre">w&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Calendar.Private.html#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">clipValid</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (if </span><a href="#loc_42_17_42_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_25&#39;)"><span class="hl_varref"><span class="mpre">longYear</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">53</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">52</span></span><span class="mpre">) </span><a href="#loc_39_21_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_21_39_22&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
        let
                </span><a name="loc_47_17_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_18&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> (</span><a href="Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.OrdinalDate.html#loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_39_19_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_20&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> (</span><a href="#loc_47_17_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_18&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_47_17_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_18&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> ((</span><a href="#loc_45_9_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_11&#39;)"><span class="hl_varref"><span class="mpre">w&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_40_9_40_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_11&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | show in ISO 8601 Week Date format as yyyy-Www-d (e.g. \&quot;2006-W46-3\&quot;).</span></span><span class="mpre">
</span><a href="#loc_52_1_52_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_13&#39;)"><span class="mpre">showWeekDate</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_52_1_52_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_13&#39;)"><span class="hl_fundecl"><span class="mpre">showWeekDate</span></span></a><span class="mpre"> </span><a name="loc_52_14_52_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_14_52_18&#39;)"><span class="hl_vardecl"><span class="mpre">date</span></span></a><span class="mpre"> = (</span><a href="Data.Time.Calendar.Private.html#loc_34_1_34_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_34_1_34_6&#39;)"><span class="hl_varref"><span class="mpre">show4</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">) </span><a href="#loc_53_10_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-W&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Private.html#loc_28_1_28_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_28_1_28_6&#39;)"><span class="hl_varref"><span class="mpre">show2</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">) </span><a href="#loc_53_12_53_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_12_53_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_53_14_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_14_53_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">) where
        (</span><a name="loc_53_10_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_53_12_53_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_12_53_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">,</span><a name="loc_53_14_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_14_53_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><a href="#loc_12_1_12_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_11&#39;)"><span class="hl_varref"><span class="mpre">toWeekDate</span></span></a><span class="mpre"> </span><a href="#loc_52_14_52_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_14_52_18&#39;)"><span class="hl_varref"><span class="mpre">date</span></span></a><span class="mpre">
</span></div></body></html>