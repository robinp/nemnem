<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}

module System.IO.Streams.Tests.Text (tests) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           Control.Monad                  (</span><a href="Control.Monad.html#loc_180_3_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_180_3_180_6&#39;)"><span class="mpre">(&gt;=&gt;)</span></a><span class="mpre">)
import           Data.Text.Encoding.Error
import qualified System.IO.Streams.Internal     as Streams
import qualified System.IO.Streams.List         as Streams
import           System.IO.Streams.Tests.Common
import qualified System.IO.Streams.Text         as Streams
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Text.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Test.Framework&quot;"><span class="mpre">Test.Framework</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Text.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 48}, srcInfoPoints = []}) &quot;Test.Framework.Providers.HUnit&quot;"><span class="mpre">Test.Framework.Providers.HUnit</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Text.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">                     hiding (Test)
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_18_1_18_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_6&#39;)"><span class="mpre">tests</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">]
</span><a name="loc_18_1_18_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = [ </span><a href="#loc_34_1_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_13&#39;)"><span class="hl_varref"><span class="mpre">testDecodeOK</span></span></a><span class="mpre">
        , </span><a href="#loc_63_1_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_22&#39;)"><span class="hl_varref"><span class="mpre">testStrictDecodeError</span></span></a><span class="mpre">
        , </span><a href="#loc_26_1_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_11&#39;)"><span class="hl_varref"><span class="mpre">testEncode</span></span></a><span class="mpre">
        ]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_26_1_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_11&#39;)"><span class="mpre">testEncode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_26_1_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_11&#39;)"><span class="hl_vardecl"><span class="mpre">testEncode</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;text/encodeUtf8&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_27_5_27_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\x3BC&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">]
    </span><a href="System.IO.Streams.List.html#loc_109_1_109_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_109_1_109_13&#39;)"><span class="hl_varref"><span class="mpre">Streams.outputToList</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.Text.html#loc_33_1_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Text.html#loc_33_1_33_11&#39;)"><span class="hl_varref"><span class="mpre">Streams.encodeUtf8</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_180_3_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_180_3_180_6&#39;)"><span class="hl_infix"><span class="mpre">&gt;=&gt;</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">Streams.connect</span></span></a><span class="mpre"> </span><a href="#loc_27_5_27_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">)
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok encode&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\xCE\xBC&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_34_1_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_13&#39;)"><span class="mpre">testDecodeOK</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_34_1_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_13&#39;)"><span class="hl_vardecl"><span class="mpre">testDecodeOK</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;text/decodeUtf8/wholeChunk&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\xCE\xBC&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">]
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Text.html#loc_41_1_41_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Text.html#loc_41_1_41_11&#39;)"><span class="hl_varref"><span class="mpre">Streams.decodeUtf8</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok decode&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\x3BC&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\xCE&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\xBC&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;foo\xCE&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\xBC&quot;</span></span><span class="mpre">]
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Text.html#loc_41_1_41_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Text.html#loc_41_1_41_11&#39;)"><span class="hl_varref"><span class="mpre">Streams.decodeUtf8</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok decode 2&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\x3BC&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\x3BC&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\xE2\xB6&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\x8E&quot;</span></span><span class="mpre">]
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Text.html#loc_41_1_41_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Text.html#loc_41_1_41_11&#39;)"><span class="hl_varref"><span class="mpre">Streams.decodeUtf8</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok decode 3&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\x2D8E&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\xF0\x90\x80\x83&quot;</span></span><span class="mpre">]
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Text.html#loc_41_1_41_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Text.html#loc_41_1_41_11&#39;)"><span class="hl_varref"><span class="mpre">Streams.decodeUtf8</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok decode 4&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\x10003&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> []
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Text.html#loc_53_1_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Text.html#loc_53_1_53_15&#39;)"><span class="hl_varref"><span class="mpre">Streams.decodeUtf8With</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.Error.html#loc_102_1_102_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_102_1_102_13&#39;)"><span class="hl_varref"><span class="mpre">strictDecode</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok strict empty&quot;</span></span><span class="mpre"> []


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_63_1_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_22&#39;)"><span class="mpre">testStrictDecodeError</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_63_1_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_22&#39;)"><span class="hl_vardecl"><span class="mpre">testStrictDecodeError</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;text/decodeUtf8/error&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;\x87&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
                      </span><a href="System.IO.Streams.Text.html#loc_53_1_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Text.html#loc_53_1_53_15&#39;)"><span class="hl_varref"><span class="mpre">Streams.decodeUtf8With</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.Error.html#loc_102_1_102_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_102_1_102_13&#39;)"><span class="hl_varref"><span class="mpre">strictDecode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
                      </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;o\x87\x87&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
                      </span><a href="System.IO.Streams.Text.html#loc_53_1_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Text.html#loc_53_1_53_15&#39;)"><span class="hl_varref"><span class="mpre">Streams.decodeUtf8With</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.Error.html#loc_102_1_102_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_102_1_102_13&#39;)"><span class="hl_varref"><span class="mpre">strictDecode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
                      </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre">)
</span></div></body></html>