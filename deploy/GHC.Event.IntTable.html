<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, NoImplicitPrelude, RecordWildCards, Trustworthy #-}
{-# OPTIONS_GHC -fno-warn-name-shadowing #-}

module GHC.Event.IntTable
    (
      IntTable
    , new
    , lookup
    , insertWith
    , reset
    , delete
    , updateWith
    ) where

import Control.Monad (</span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="mpre">(=&lt;&lt;)</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="mpre">liftM</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="mpre">unless</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import Data.Bits ((.&amp;.), </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">)
import Data.IORef (</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="mpre">IORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="mpre">newIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="mpre">readIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="mpre">writeIORef</span></a><span class="mpre">)
import Data.Maybe (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="mpre">Maybe</span></a><span class="mpre">(..), </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="mpre">isJust</span></a><span class="mpre">)
import Foreign.ForeignPtr (ForeignPtr, </span><a href="Foreign.ForeignPtr.html#loc_49_1_49_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.html#loc_49_1_49_17&#39;)"><span class="mpre">mallocForeignPtr</span></a><span class="mpre">, withForeignPtr)
import Foreign.Storable (peek, poke)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 8, srcSpanEndLine = 21, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre"> (Monad(..), ($), const, otherwise)
import GHC.Classes (</span><a href="GHC.Classes.html#loc_43_8_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Classes.html#loc_43_8_43_10&#39;)"><span class="mpre">Eq</span></a><span class="mpre">(..), </span><a href="GHC.Classes.html#loc_127_18_127_21" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Classes.html#loc_127_18_127_21&#39;)"><span class="mpre">Ord</span></a><span class="mpre">(..))
import GHC.Event.Arr (</span><a href="GHC.Event.Arr.html#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_17_6_17_9&#39;)"><a href="GHC.Event.Arr.html#loc_17_14_17_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_17_14_17_17&#39;)"><span class="mpre">Arr</span></a></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 8, srcSpanEndLine = 24, srcSpanEndColumn = 15}, srcInfoPoints = []}) &quot;GHC.Num&quot;"><span class="mpre">GHC.Num</span></span><span class="mpre"> (Num(..))
import GHC.Prim (</span><a href="GHC.Prim.html#loc_2832_1_2832_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2832_1_2832_4&#39;)"><span class="mpre">seq</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 8, srcSpanEndLine = 26, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;GHC.Types&quot;"><span class="mpre">GHC.Types</span></span><span class="mpre"> (Bool(..), IO(..), Int(..))
import qualified GHC.Event.Arr as Arr

</span><span class="hl_comment"><span class="mpre">-- A very simple chained integer-keyed mutable hash table. We use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- power-of-two sizing, grow at a load factor of 0.75, and never</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- shrink. The &quot;hash function&quot; is the identity function.</span></span><span class="mpre">

newtype </span><a name="loc_33_9_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_17&#39;)"><span class="hl_tycondecl"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_33_22_33_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_30&#39;)"><span class="hl_condecl"><span class="mpre">IntTable</span></span></a><span class="mpre"> (</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> (</span><a href="#loc_35_6_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_8&#39;)"><span class="hl_tyconref"><span class="mpre">IT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))

data </span><a name="loc_35_6_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_8&#39;)"><span class="hl_tycondecl"><span class="mpre">IT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">IT</span></span><span class="mpre"> {
      </span><a name="loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_fielddecl"><span class="mpre">tabArr</span></span></a><span class="mpre">  :: {-# UNPACK #-} !(</span><a href="GHC.Event.Arr.html#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Arr</span></span></a><span class="mpre"> (</span><a href="#loc_40_6_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Bucket</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
    , </span><a name="loc_37_7_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_14&#39;)"><span class="hl_fielddecl"><span class="mpre">tabSize</span></span></a><span class="mpre"> :: {-# UNPACK #-} !(</span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
    }

data </span><a name="loc_40_6_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Bucket</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_40_17_40_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_17_40_22&#39;)"><span class="hl_condecl"><span class="mpre">Empty</span></span></a><span class="mpre">
              | </span><a name="loc_41_17_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_23&#39;)"><span class="hl_condecl"><span class="mpre">Bucket</span></span></a><span class="mpre"> {
      </span><a name="loc_42_7_42_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_16&#39;)"><span class="hl_fielddecl"><span class="mpre">bucketKey</span></span></a><span class="mpre">   :: {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    , </span><a name="loc_43_7_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_18&#39;)"><span class="hl_fielddecl"><span class="mpre">bucketValue</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
    , </span><a name="loc_44_7_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_17&#39;)"><span class="hl_fielddecl"><span class="mpre">bucketNext</span></span></a><span class="mpre">  :: </span><a href="#loc_40_6_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Bucket</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
    }

</span><a href="#loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="mpre">lookup</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_33_9_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_17&#39;)"><span class="hl_tyconref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="hl_fundecl"><span class="mpre">lookup</span></span></a><span class="mpre"> </span><a name="loc_48_8_48_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_8_48_9&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_33_22_33_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_30&#39;)"><span class="hl_conref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><a name="loc_48_20_48_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_23&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre">) = do
  let </span><a name="loc_49_7_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 10, srcSpanEndLine = 49, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 16, srcSpanEndLine = 49, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 49,"><span class="mpre">Bucket{..}</span></span><span class="mpre">
        | </span><a href="#loc_42_7_42_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_16&#39;)"><span class="hl_varref"><span class="mpre">bucketKey</span></span></a><span class="mpre"> </span><a href="GHC.Classes.html#loc_44_5_44_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Classes.html#loc_44_5_44_9&#39;)"><span class="hl_infix"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_48_8_48_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_8_48_9&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_18&#39;)"><span class="hl_varref"><span class="mpre">bucketValue</span></span></a><span class="mpre">)
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">      = </span><a href="#loc_49_7_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_44_7_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_17&#39;)"><span class="hl_varref"><span class="mpre">bucketNext</span></span></a><span class="mpre">
      </span><a href="#loc_49_7_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
  </span><a name="loc_53_3_53_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_3_53_5&#39;)"><span class="hl_specname"><span class="mpre">it</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 6, srcSpanEndLine = 53, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 8, srcSpanEndLine = 53, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 53, sr"><span class="mpre">IT{..}</span></span><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_48_20_48_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_23&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
  </span><a href="#loc_49_7_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><a href="GHC.Event.Arr.html#loc_27_1_27_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_27_1_27_5&#39;)"><span class="hl_varref"><span class="mpre">Arr.read</span></span></a><span class="mpre"> </span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> (</span><a href="#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_8&#39;)"><span class="hl_varref"><span class="mpre">indexOf</span></span></a><span class="mpre"> </span><a href="#loc_48_8_48_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_8_48_9&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_53_3_53_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_3_53_5&#39;)"><span class="hl_varref"><span class="mpre">it</span></span></a><span class="mpre">)

</span><a href="#loc_57_1_57_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_4&#39;)"><span class="mpre">new</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_33_9_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_17&#39;)"><span class="hl_tyconref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_57_1_57_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_4&#39;)"><span class="hl_fundecl"><span class="mpre">new</span></span></a><span class="mpre"> </span><a name="loc_57_5_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_13&#39;)"><span class="hl_vardecl"><span class="mpre">capacity</span></span></a><span class="mpre"> = </span><a href="#loc_33_22_33_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_30&#39;)"><span class="hl_conref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_infix"><span class="mpre">`liftM`</span></span></a><span class="mpre"> (</span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><a href="#loc_60_1_60_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_5&#39;)"><span class="hl_varref"><span class="mpre">new_</span></span></a><span class="mpre"> </span><a href="#loc_57_5_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_13&#39;)"><span class="hl_varref"><span class="mpre">capacity</span></span></a><span class="mpre">)

</span><a href="#loc_60_1_60_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_5&#39;)"><span class="mpre">new_</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_35_6_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_8&#39;)"><span class="hl_tyconref"><span class="mpre">IT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_60_1_60_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_5&#39;)"><span class="hl_fundecl"><span class="mpre">new_</span></span></a><span class="mpre"> </span><a name="loc_60_6_60_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_6_60_14&#39;)"><span class="hl_vardecl"><span class="mpre">capacity</span></span></a><span class="mpre"> = do
  </span><span class="hl_vardecl"><span class="mpre">arr</span></span><span class="mpre"> &lt;- </span><a href="GHC.Event.Arr.html#loc_20_1_20_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_20_1_20_4&#39;)"><span class="hl_varref"><span class="mpre">Arr.new</span></span></a><span class="mpre"> </span><a href="#loc_40_17_40_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_17_40_22&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre"> </span><a href="#loc_60_6_60_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_6_60_14&#39;)"><span class="hl_varref"><span class="mpre">capacity</span></span></a><span class="mpre">
  </span><a name="loc_62_3_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_3_62_7&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> &lt;- </span><a href="Foreign.ForeignPtr.html#loc_49_1_49_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.html#loc_49_1_49_17&#39;)"><span class="hl_varref"><span class="mpre">mallocForeignPtr</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_62_3_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_3_62_7&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_63_26_63_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_26_63_29&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_63_26_63_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_26_63_29&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 10, srcSpanEndLine = 66, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 13, srcSpanEndLine = 64, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine "><span class="mpre">IT { tabArr = arr
            , tabSize = size
            }</span></span><span class="mpre">

</span><a href="#loc_69_1_69_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_5&#39;)"><span class="mpre">grow</span></a><span class="mpre"> :: </span><a href="#loc_35_6_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_8&#39;)"><span class="hl_tyconref"><span class="mpre">IT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> (</span><a href="#loc_35_6_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_8&#39;)"><span class="hl_tyconref"><span class="mpre">IT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_69_1_69_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_5&#39;)"><span class="hl_fundecl"><span class="mpre">grow</span></span></a><span class="mpre"> </span><a name="loc_69_6_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_6_69_11&#39;)"><span class="hl_vardecl"><span class="mpre">oldit</span></span></a><span class="mpre"> </span><a name="loc_69_12_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_12_69_15&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_69_16_69_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_16_69_20&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> = do
  </span><a name="loc_70_3_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_3_70_8&#39;)"><span class="hl_vardecl"><span class="mpre">newit</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_60_1_60_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_5&#39;)"><span class="hl_varref"><span class="mpre">new_</span></span></a><span class="mpre"> (</span><a href="GHC.Event.Arr.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">Arr.size</span></span></a><span class="mpre"> (</span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="#loc_69_6_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_6_69_11&#39;)"><span class="hl_varref"><span class="mpre">oldit</span></span></a><span class="mpre">) </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
  let </span><a name="loc_71_7_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_15&#39;)"><span class="hl_fundecl"><span class="mpre">copySlot</span></span></a><span class="mpre"> </span><a name="loc_71_16_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_16_71_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> !</span><a name="loc_71_19_71_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_19_71_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
        | </span><a href="#loc_71_16_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_16_71_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="GHC.Classes.html#loc_44_5_44_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Classes.html#loc_44_5_44_9&#39;)"><span class="hl_infix"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_69_16_69_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_16_69_20&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
          let </span><a name="loc_74_15_74_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_25&#39;)"><span class="hl_fundecl"><span class="mpre">copyBucket</span></span></a><span class="mpre"> !</span><a name="loc_74_27_74_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_27_74_28&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_40_17_40_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_17_40_22&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">          = </span><a href="#loc_71_7_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_15&#39;)"><span class="hl_varref"><span class="mpre">copySlot</span></span></a><span class="mpre"> </span><a href="#loc_74_27_74_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_27_74_28&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_71_19_71_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_19_71_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
              </span><a href="#loc_74_15_74_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_25&#39;)"><span class="hl_fundecl"><span class="mpre">copyBucket</span></span></a><span class="mpre">  </span><a name="loc_75_27_75_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_27_75_28&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">bkt</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 33, srcSpanEndLine = 75, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 39, srcSpanEndLine = 75, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 75,"><span class="mpre">Bucket{..}</span></span><span class="mpre"> = do
                let </span><a name="loc_76_21_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_21_76_24&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><a href="#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_8&#39;)"><span class="hl_varref"><span class="mpre">indexOf</span></span></a><span class="mpre"> </span><a href="#loc_42_7_42_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_16&#39;)"><span class="hl_varref"><span class="mpre">bucketKey</span></span></a><span class="mpre"> </span><a href="#loc_70_3_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_3_70_8&#39;)"><span class="hl_varref"><span class="mpre">newit</span></span></a><span class="mpre">
                </span><span class="hl_vardecl"><span class="mpre">next</span></span><span class="mpre"> &lt;- </span><a href="GHC.Event.Arr.html#loc_27_1_27_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_27_1_27_5&#39;)"><span class="hl_varref"><span class="mpre">Arr.read</span></span></a><span class="mpre"> (</span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="#loc_70_3_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_3_70_8&#39;)"><span class="hl_varref"><span class="mpre">newit</span></span></a><span class="mpre">) </span><a href="#loc_76_21_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_21_76_24&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre">
                </span><a href="GHC.Event.Arr.html#loc_31_1_31_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_31_1_31_6&#39;)"><span class="hl_varref"><span class="mpre">Arr.write</span></span></a><span class="mpre"> (</span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="#loc_70_3_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_3_70_8&#39;)"><span class="hl_varref"><span class="mpre">newit</span></span></a><span class="mpre">) </span><a href="#loc_76_21_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_21_76_24&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 46, srcSpanEndLine = 78, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 50, srcSpanEndLine = 78, srcSpanEndColumn = 51},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine "><span class="mpre">bkt { bucketNext = next }</span></span><span class="mpre">
                </span><a href="#loc_74_15_74_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_25&#39;)"><span class="hl_varref"><span class="mpre">copyBucket</span></span></a><span class="mpre"> (</span><a href="#loc_75_27_75_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_27_75_28&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_44_7_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_17&#39;)"><span class="hl_varref"><span class="mpre">bucketNext</span></span></a><span class="mpre">
          </span><a href="#loc_74_15_74_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_25&#39;)"><span class="hl_varref"><span class="mpre">copyBucket</span></span></a><span class="mpre"> </span><a href="#loc_71_16_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_16_71_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><a href="GHC.Event.Arr.html#loc_27_1_27_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_27_1_27_5&#39;)"><span class="hl_varref"><span class="mpre">Arr.read</span></span></a><span class="mpre"> (</span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="#loc_69_6_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_6_69_11&#39;)"><span class="hl_varref"><span class="mpre">oldit</span></span></a><span class="mpre">) </span><a href="#loc_71_19_71_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_19_71_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
  </span><a href="#loc_71_7_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_15&#39;)"><span class="hl_varref"><span class="mpre">copySlot</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> (</span><a href="#loc_37_7_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_14&#39;)"><span class="hl_varref"><span class="mpre">tabSize</span></span></a><span class="mpre"> </span><a href="#loc_70_3_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_3_70_8&#39;)"><span class="hl_varref"><span class="mpre">newit</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_82_37_82_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_37_82_40&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_82_37_82_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_37_82_40&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_69_16_69_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_16_69_20&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">
  </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_69_12_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_12_69_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_70_3_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_3_70_8&#39;)"><span class="hl_varref"><span class="mpre">newit</span></span></a><span class="mpre">

</span><a href="#loc_86_1_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_11&#39;)"><span class="mpre">insertWith</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_33_9_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_17&#39;)"><span class="hl_tyconref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_86_1_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_11&#39;)"><span class="hl_fundecl"><span class="mpre">insertWith</span></span></a><span class="mpre"> </span><a name="loc_86_12_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_86_16_86_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_86_18_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_18_86_26&#39;)"><span class="hl_specname"><span class="mpre">inttable</span></span></a><span class="mpre">@(</span><a href="#loc_33_22_33_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_30&#39;)"><span class="hl_conref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><a name="loc_86_37_86_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_37_86_40&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre">) = do
  </span><a name="loc_87_3_87_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_5&#39;)"><span class="hl_specname"><span class="mpre">it</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 6, srcSpanEndLine = 87, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 8, srcSpanEndLine = 87, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 87, sr"><span class="mpre">IT{..}</span></span><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_86_37_86_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_37_86_40&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
  let </span><a name="loc_88_7_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_10&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><a href="#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_8&#39;)"><span class="hl_varref"><span class="mpre">indexOf</span></span></a><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_87_3_87_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_5&#39;)"><span class="hl_varref"><span class="mpre">it</span></span></a><span class="mpre">
      </span><a name="loc_89_7_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_89_10_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_10_89_14&#39;)"><span class="hl_vardecl"><span class="mpre">seen</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">bkt</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 19, srcSpanEndLine = 89, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 25, srcSpanEndLine = 89, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 89,"><span class="mpre">Bucket{..}</span></span><span class="mpre">
        | </span><a href="#loc_42_7_42_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_16&#39;)"><span class="hl_varref"><span class="mpre">bucketKey</span></span></a><span class="mpre"> </span><a href="GHC.Classes.html#loc_44_5_44_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Classes.html#loc_44_5_44_9&#39;)"><span class="hl_infix"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> = do
          let !</span><a name="loc_91_16_91_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_16_91_18&#39;)"><span class="hl_vardecl"><span class="mpre">v&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_86_12_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_86_16_86_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_18&#39;)"><span class="hl_varref"><span class="mpre">bucketValue</span></span></a><span class="mpre">
              !</span><a name="loc_92_16_92_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_16_92_20&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre"> = </span><a href="#loc_89_10_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_10_89_14&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre"> </span><a href="#loc_93_28_93_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_28_93_30&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_44_7_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_17&#39;)"><span class="hl_varref"><span class="mpre">bucketNext</span></span></a><span class="mpre">
              </span><a href="#loc_40_17_40_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_17_40_22&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">        </span><a name="loc_93_28_93_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_28_93_30&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a name="loc_93_31_93_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_31_93_33&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_93_31_93_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_31_93_33&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
              </span><span class="hl_specname"><span class="mpre">b</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 17, srcSpanEndLine = 94, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 23, srcSpanEndLine = 94, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 94,"><span class="mpre">Bucket{..}</span></span><span class="mpre"> </span><a href="#loc_93_28_93_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_28_93_30&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">bs</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 36, srcSpanEndLine = 94, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 38, srcSpanEndLine = 94, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine "><span class="mpre">b { bucketNext = bucketNext &lt;&gt; bs }</span></span><span class="mpre">
          </span><a href="GHC.Event.Arr.html#loc_31_1_31_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_31_1_31_6&#39;)"><span class="hl_varref"><span class="mpre">Arr.write</span></span></a><span class="mpre"> </span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="#loc_88_7_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_10&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_41_17_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_23&#39;)"><span class="hl_conref"><span class="mpre">Bucket</span></span></a><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_91_16_91_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_16_91_18&#39;)"><span class="hl_varref"><span class="mpre">v&#39;</span></span></a><span class="mpre"> </span><a href="#loc_92_16_92_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_16_92_20&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre">)
          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_18&#39;)"><span class="hl_varref"><span class="mpre">bucketValue</span></span></a><span class="mpre">)
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_89_7_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 26, srcSpanEndLine = 97, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 30, srcSpanEndLine = 97, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine "><span class="mpre">bkt { bucketNext = seen }</span></span><span class="mpre"> </span><a href="#loc_44_7_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_17&#39;)"><span class="hl_varref"><span class="mpre">bucketNext</span></span></a><span class="mpre">
      </span><a href="#loc_89_7_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_98_10_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_14&#39;)"><span class="hl_vardecl"><span class="mpre">seen</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_37_7_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_14&#39;)"><span class="hl_varref"><span class="mpre">tabSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_98_45_98_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_45_98_48&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_99_9_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_13&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_98_45_98_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_45_98_48&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
        if </span><a href="#loc_99_9_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_13&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="GHC.Classes.html#loc_129_21_129_25" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Classes.html#loc_129_21_129_25&#39;)"><span class="hl_infix"><span class="mpre">&gt;=</span></span></a><span class="mpre"> </span><a href="GHC.Event.Arr.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">Arr.size</span></span></a><span class="mpre"> </span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><a href="GHC.Event.Arr.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">Arr.size</span></span></a><span class="mpre"> </span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
          then </span><a href="#loc_69_1_69_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_5&#39;)"><span class="hl_varref"><span class="mpre">grow</span></span></a><span class="mpre"> </span><a href="#loc_87_3_87_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_5&#39;)"><span class="hl_varref"><span class="mpre">it</span></span></a><span class="mpre"> </span><a href="#loc_86_37_86_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_37_86_40&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_99_9_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_13&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_86_1_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_11&#39;)"><span class="hl_varref"><span class="mpre">insertWith</span></span></a><span class="mpre"> </span><a href="#loc_86_12_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_86_16_86_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_86_18_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_18_86_26&#39;)"><span class="hl_varref"><span class="mpre">inttable</span></span></a><span class="mpre">
          else do
            </span><a href="#loc_86_16_86_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_2832_1_2832_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2832_1_2832_4&#39;)"><span class="hl_infix"><span class="mpre">`seq`</span></span></a><span class="mpre"> </span><a href="GHC.Event.Arr.html#loc_31_1_31_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_31_1_31_6&#39;)"><span class="hl_varref"><span class="mpre">Arr.write</span></span></a><span class="mpre"> </span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="#loc_88_7_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_10&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_41_17_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_23&#39;)"><span class="hl_conref"><span class="mpre">Bucket</span></span></a><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_86_16_86_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_98_10_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_14&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_98_45_98_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_45_98_48&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><a href="#loc_99_9_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_13&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
  </span><a href="#loc_89_7_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_40_17_40_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_17_40_22&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><a href="GHC.Event.Arr.html#loc_27_1_27_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_27_1_27_5&#39;)"><span class="hl_varref"><span class="mpre">Arr.read</span></span></a><span class="mpre"> </span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="#loc_88_7_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_10&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE insertWith #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Used to undo the effect of a prior insertWith.</span></span><span class="mpre">
</span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="mpre">reset</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_33_9_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_17&#39;)"><span class="hl_tyconref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_fundecl"><span class="mpre">reset</span></span></a><span class="mpre"> </span><a name="loc_111_7_111_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_7_111_8&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_111_15_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_111_18_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_18_111_21&#39;)"><span class="hl_vardecl"><span class="mpre">tbl</span></span></a><span class="mpre"> = </span><a href="#loc_86_1_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_11&#39;)"><span class="hl_varref"><span class="mpre">insertWith</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="#loc_111_7_111_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_7_111_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_111_15_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_111_18_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_18_111_21&#39;)"><span class="hl_varref"><span class="mpre">tbl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
</span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_fundecl"><span class="mpre">reset</span></span></a><span class="mpre"> </span><a name="loc_112_7_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_7_112_8&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">  </span><a name="loc_112_18_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_18_112_21&#39;)"><span class="hl_vardecl"><span class="mpre">tbl</span></span></a><span class="mpre"> = </span><a href="#loc_118_1_118_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_7&#39;)"><span class="hl_varref"><span class="mpre">delete</span></span></a><span class="mpre"> </span><a href="#loc_112_7_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_7_112_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_112_18_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_18_112_21&#39;)"><span class="hl_varref"><span class="mpre">tbl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_8&#39;)"><span class="mpre">indexOf</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_35_6_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_8&#39;)"><span class="hl_tyconref"><span class="mpre">IT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_115_1_115_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_8&#39;)"><span class="hl_fundecl"><span class="mpre">indexOf</span></span></a><span class="mpre"> </span><a name="loc_115_9_115_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 11, srcSpanEndLine = 115, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 13, srcSpanEndLine = 115, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine ="><span class="mpre">IT{..}</span></span><span class="mpre"> = </span><a href="#loc_115_9_115_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> (</span><a href="GHC.Event.Arr.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">Arr.size</span></span></a><span class="mpre"> </span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><a href="#loc_118_1_118_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_7&#39;)"><span class="mpre">delete</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_33_9_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_17&#39;)"><span class="hl_tyconref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_118_1_118_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_7&#39;)"><span class="hl_fundecl"><span class="mpre">delete</span></span></a><span class="mpre"> </span><a name="loc_118_8_118_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_8_118_9&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_118_10_118_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_10_118_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_121_1_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_11&#39;)"><span class="hl_varref"><span class="mpre">updateWith</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><a href="#loc_118_8_118_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_8_118_9&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_118_10_118_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_10_118_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><a href="#loc_121_1_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_11&#39;)"><span class="mpre">updateWith</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_33_9_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_17&#39;)"><span class="hl_tyconref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_121_1_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_11&#39;)"><span class="hl_fundecl"><span class="mpre">updateWith</span></span></a><span class="mpre"> </span><a name="loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_121_14_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_33_22_33_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_30&#39;)"><span class="hl_conref"><span class="mpre">IntTable</span></span></a><span class="mpre"> </span><a name="loc_121_26_121_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_26_121_29&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre">) = do
  </span><a name="loc_122_3_122_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_3_122_5&#39;)"><span class="hl_specname"><span class="mpre">it</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 6, srcSpanEndLine = 122, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 8, srcSpanEndLine = 122, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 12"><span class="mpre">IT{..}</span></span><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_121_26_121_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_26_121_29&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
  let </span><a name="loc_123_7_123_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_10&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><a href="#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_8&#39;)"><span class="hl_varref"><span class="mpre">indexOf</span></span></a><span class="mpre"> </span><a href="#loc_121_14_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_122_3_122_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_3_122_5&#39;)"><span class="hl_varref"><span class="mpre">it</span></span></a><span class="mpre">
      </span><a name="loc_124_7_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_124_10_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_10_124_17&#39;)"><span class="hl_vardecl"><span class="mpre">changed</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">bkt</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 22, srcSpanEndLine = 124, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 28, srcSpanEndLine = 124, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine ="><span class="mpre">Bucket{..}</span></span><span class="mpre">
        | </span><a href="#loc_42_7_42_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_16&#39;)"><span class="hl_varref"><span class="mpre">bucketKey</span></span></a><span class="mpre"> </span><a href="GHC.Classes.html#loc_44_5_44_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Classes.html#loc_44_5_44_9&#39;)"><span class="hl_infix"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_121_14_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> =
            let </span><a name="loc_126_17_126_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_17_126_20&#39;)"><span class="hl_vardecl"><span class="mpre">fbv</span></span></a><span class="mpre"> = </span><a href="#loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_18&#39;)"><span class="hl_varref"><span class="mpre">bucketValue</span></span></a><span class="mpre">
                !</span><a name="loc_127_18_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_18_127_20&#39;)"><span class="hl_vardecl"><span class="mpre">nb</span></span></a><span class="mpre"> = case </span><a href="#loc_126_17_126_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_17_126_20&#39;)"><span class="hl_varref"><span class="mpre">fbv</span></span></a><span class="mpre"> of
                        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">val</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 128, srcSpanStartColumn = 37, srcSpanEndLine = 128, srcSpanEndColumn = 62}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 128, srcSpanStartColumn = 41, srcSpanEndLine = 128, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartL"><span class="mpre">bkt { bucketValue = val }</span></span><span class="mpre">
                        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_44_7_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_17&#39;)"><span class="hl_varref"><span class="mpre">bucketNext</span></span></a><span class="mpre">
            in (</span><a href="#loc_126_17_126_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_17_126_20&#39;)"><span class="hl_varref"><span class="mpre">fbv</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_18&#39;)"><span class="hl_varref"><span class="mpre">bucketValue</span></span></a><span class="mpre">, </span><a href="#loc_127_18_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_18_127_20&#39;)"><span class="hl_varref"><span class="mpre">nb</span></span></a><span class="mpre">)
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = case </span><a href="#loc_124_7_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_124_10_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_10_124_17&#39;)"><span class="hl_varref"><span class="mpre">changed</span></span></a><span class="mpre"> </span><a href="#loc_44_7_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_17&#39;)"><span class="hl_varref"><span class="mpre">bucketNext</span></span></a><span class="mpre"> of
                        (</span><a name="loc_132_26_132_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_26_132_29&#39;)"><span class="hl_vardecl"><span class="mpre">fbv</span></span></a><span class="mpre">, </span><a name="loc_132_31_132_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_31_132_33&#39;)"><span class="hl_vardecl"><span class="mpre">ov</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">nb</span></span><span class="mpre">) -&gt; (</span><a href="#loc_132_26_132_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_26_132_29&#39;)"><span class="hl_varref"><span class="mpre">fbv</span></span></a><span class="mpre">, </span><a href="#loc_132_31_132_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_31_132_33&#39;)"><span class="hl_varref"><span class="mpre">ov</span></span></a><span class="mpre">, </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 52, srcSpanEndLine = 132, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 56, srcSpanEndLine = 132, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/Event/IntTable.hs&quot;, srcSpanStartL"><span class="mpre">bkt { bucketNext = nb }</span></span><span class="mpre">)
      </span><a href="#loc_124_7_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> _ </span><a name="loc_133_12_133_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_12_133_13&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a href="#loc_133_12_133_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_12_133_13&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
  (</span><a name="loc_134_4_134_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_4_134_7&#39;)"><span class="hl_vardecl"><span class="mpre">fbv</span></span></a><span class="mpre">, </span><a name="loc_134_9_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_15&#39;)"><span class="hl_vardecl"><span class="mpre">oldVal</span></span></a><span class="mpre">, </span><a name="loc_134_17_134_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_26&#39;)"><span class="hl_vardecl"><span class="mpre">newBucket</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_124_7_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_infix"><span class="mpre">`liftM`</span></span></a><span class="mpre"> </span><a href="GHC.Event.Arr.html#loc_27_1_27_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_27_1_27_5&#39;)"><span class="hl_varref"><span class="mpre">Arr.read</span></span></a><span class="mpre"> </span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="#loc_123_7_123_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_10&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre">
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_134_9_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_15&#39;)"><span class="hl_varref"><span class="mpre">oldVal</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="GHC.Event.Arr.html#loc_31_1_31_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Event.Arr.html#loc_31_1_31_6&#39;)"><span class="hl_varref"><span class="mpre">Arr.write</span></span></a><span class="mpre"> </span><a href="#loc_36_7_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_13&#39;)"><span class="hl_varref"><span class="mpre">tabArr</span></span></a><span class="mpre"> </span><a href="#loc_123_7_123_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_10&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_134_17_134_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_26&#39;)"><span class="hl_varref"><span class="mpre">newBucket</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_134_4_134_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_4_134_7&#39;)"><span class="hl_varref"><span class="mpre">fbv</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_37_7_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_14&#39;)"><span class="hl_varref"><span class="mpre">tabSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_138_33_138_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_33_138_36&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_139_9_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_13&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_138_33_138_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_33_138_36&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_138_33_138_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_33_138_36&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><a href="#loc_139_9_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_13&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_134_9_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_15&#39;)"><span class="hl_varref"><span class="mpre">oldVal</span></span></a><span class="mpre">
</span></div></body></html>