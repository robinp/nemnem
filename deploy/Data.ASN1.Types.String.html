<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ASN1.Types.String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Different String types available in ASN1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.ASN1.Types.String
    ( ASN1StringEncoding(..)
    , ASN1CharacterString(..)
    , asn1CharacterString
    , asn1CharacterToString
    ) where

import Data.String
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types/String.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types/String.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 18, srcSpanEndLine = 19, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types/String.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 18, srcSpanEndLine = 20, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BC
import Data.Bits
import Data.Word

</span><span class="hl_comment"><span class="mpre">-- a note on T61 encodings. The actual specification of a T61 character set seems</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to be lost in time, as such it will be considered an ascii like encoding.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www.mail-archive.com/asn1@asn1.org/msg00460.html&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;sizable volume of software in the world treats TeletexString (T61String)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as a simple 8-bit string with mostly Windows Latin 1&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Define all possible ASN1 String encoding.</span></span><span class="mpre">
data </span><a name="loc_32_6_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_24&#39;)"><span class="hl_tycondecl"><span class="mpre">ASN1StringEncoding</span></span></a><span class="mpre"> =
      </span><a name="loc_33_7_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_10&#39;)"><span class="hl_condecl"><span class="mpre">IA5</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ 128 characters equivalent to the ASCII alphabet</span></span><span class="mpre">
    | </span><a name="loc_34_7_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_11&#39;)"><span class="hl_condecl"><span class="mpre">UTF8</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ UTF8</span></span><span class="mpre">
    | </span><a name="loc_35_7_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_14&#39;)"><span class="hl_condecl"><span class="mpre">General</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ all registered graphic and character sets (see ISO 2375) plus SPACE and DELETE.</span></span><span class="mpre">
    | </span><a name="loc_36_7_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_14&#39;)"><span class="hl_condecl"><span class="mpre">Graphic</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ all registered G sets and SPACE</span></span><span class="mpre">
    | </span><a name="loc_37_7_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_14&#39;)"><span class="hl_condecl"><span class="mpre">Numeric</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ encoding containing numeric [0-9] and space</span></span><span class="mpre">
    | </span><a name="loc_38_7_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_16&#39;)"><span class="hl_condecl"><span class="mpre">Printable</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ printable [a-z] [A-Z] [()+,-.?:/=] and space.</span></span><span class="mpre">
    | </span><a name="loc_39_7_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_15&#39;)"><span class="hl_condecl"><span class="mpre">VideoTex</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ CCITT&#39;s T.100 and T.101 character sets</span></span><span class="mpre">
    | </span><a name="loc_40_7_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_14&#39;)"><span class="hl_condecl"><span class="mpre">Visible</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ International ASCII printing character sets</span></span><span class="mpre">
    | </span><a name="loc_41_7_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_10&#39;)"><span class="hl_condecl"><span class="mpre">T61</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ teletext</span></span><span class="mpre">
    | </span><a name="loc_42_7_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_12&#39;)"><span class="hl_condecl"><span class="mpre">UTF32</span></span></a><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ UTF32</span></span><span class="mpre">
    | </span><a name="loc_43_7_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_16&#39;)"><span class="hl_condecl"><span class="mpre">Character</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Character</span></span><span class="mpre">
    | </span><a name="loc_44_7_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_10&#39;)"><span class="hl_condecl"><span class="mpre">BMP</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ UCS2</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types/String.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 5, srcSpanEndLine = 45, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types/String.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 5, srcSpanEndLine = 45, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types/String.h"><span class="mpre">deriving (Show,Eq,Ord)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | provide a way to possibly encode or decode character string based on character encoding</span></span><span class="mpre">
</span><a href="#loc_50_1_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_24&#39;)"><span class="mpre">stringEncodingFunctions</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_24&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1StringEncoding</span></span></a><span class="mpre">
                        -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_50_1_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_24&#39;)"><span class="hl_fundecl"><span class="mpre">stringEncodingFunctions</span></span></a><span class="mpre"> </span><a name="loc_50_25_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_25_50_33&#39;)"><span class="hl_vardecl"><span class="mpre">encoding</span></span></a><span class="mpre">
    | </span><a href="#loc_50_25_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_25_50_33&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_34_7_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_11&#39;)"><span class="hl_conref"><span class="mpre">UTF8</span></span></a><span class="mpre">                   = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="hl_varref"><span class="mpre">decodeUTF8</span></span></a><span class="mpre">, </span><a href="#loc_114_1_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_11&#39;)"><span class="hl_varref"><span class="mpre">encodeUTF8</span></span></a><span class="mpre">)
    | </span><a href="#loc_50_25_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_25_50_33&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_44_7_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_10&#39;)"><span class="hl_conref"><span class="mpre">BMP</span></span></a><span class="mpre">                    = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_135_1_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_10&#39;)"><span class="hl_varref"><span class="mpre">decodeBMP</span></span></a><span class="mpre">, </span><a href="#loc_139_1_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_10&#39;)"><span class="hl_varref"><span class="mpre">encodeBMP</span></span></a><span class="mpre">)
    | </span><a href="#loc_50_25_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_25_50_33&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_42_7_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_12&#39;)"><span class="hl_conref"><span class="mpre">UTF32</span></span></a><span class="mpre">                  = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_145_1_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_12&#39;)"><span class="hl_varref"><span class="mpre">decodeUTF32</span></span></a><span class="mpre">, </span><a href="#loc_149_1_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_12&#39;)"><span class="hl_varref"><span class="mpre">encodeUTF32</span></span></a><span class="mpre">)
    | </span><a href="#loc_50_25_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_25_50_33&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_56_9_56_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_27&#39;)"><span class="hl_varref"><span class="mpre">asciiLikeEncodings</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_129_1_129_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_12&#39;)"><span class="hl_varref"><span class="mpre">decodeASCII</span></span></a><span class="mpre">, </span><a href="#loc_132_1_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASCII</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                          = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  where </span><a name="loc_56_9_56_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_27&#39;)"><span class="hl_vardecl"><span class="mpre">asciiLikeEncodings</span></span></a><span class="mpre"> = [</span><a href="#loc_33_7_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_10&#39;)"><span class="hl_conref"><span class="mpre">IA5</span></span></a><span class="mpre">,</span><a href="#loc_37_7_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_14&#39;)"><span class="hl_conref"><span class="mpre">Numeric</span></span></a><span class="mpre">,</span><a href="#loc_38_7_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_16&#39;)"><span class="hl_conref"><span class="mpre">Printable</span></span></a><span class="mpre">,</span><a href="#loc_40_7_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_14&#39;)"><span class="hl_conref"><span class="mpre">Visible</span></span></a><span class="mpre">,</span><a href="#loc_35_7_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_14&#39;)"><span class="hl_conref"><span class="mpre">General</span></span></a><span class="mpre">,</span><a href="#loc_36_7_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_14&#39;)"><span class="hl_conref"><span class="mpre">Graphic</span></span></a><span class="mpre">,</span><a href="#loc_41_7_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_10&#39;)"><span class="hl_conref"><span class="mpre">T61</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | encode a string into a character string</span></span><span class="mpre">
</span><a href="#loc_60_1_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_20&#39;)"><span class="mpre">asn1CharacterString</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_24&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1StringEncoding</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_73_6_73_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_6_73_25&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre">
</span><a name="loc_60_1_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_20&#39;)"><span class="hl_fundecl"><span class="mpre">asn1CharacterString</span></span></a><span class="mpre"> </span><a name="loc_60_21_60_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_29&#39;)"><span class="hl_vardecl"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><a name="loc_60_30_60_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_30_60_31&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    case </span><a href="#loc_50_1_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_24&#39;)"><span class="hl_varref"><span class="mpre">stringEncodingFunctions</span></span></a><span class="mpre"> </span><a href="#loc_60_21_60_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_29&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (_, </span><a name="loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_73_28_73_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_28_73_47&#39;)"><span class="hl_conref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre"> </span><a href="#loc_60_21_60_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_29&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> (</span><a href="#loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_60_30_60_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_30_60_31&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">     -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;cannot encode ASN1 Character String &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_60_21_60_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_29&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; from string&quot;</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | try to decode an &#39;ASN1CharacterString&#39; to a String</span></span><span class="mpre">
</span><a href="#loc_67_1_67_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_22&#39;)"><span class="mpre">asn1CharacterToString</span></a><span class="mpre"> :: </span><a href="#loc_73_6_73_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_6_73_25&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_67_1_67_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_22&#39;)"><span class="hl_fundecl"><span class="mpre">asn1CharacterToString</span></span></a><span class="mpre"> (</span><a href="#loc_73_28_73_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_28_73_47&#39;)"><span class="hl_conref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre"> </span><a name="loc_67_44_67_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_44_67_52&#39;)"><span class="hl_vardecl"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><a name="loc_67_53_67_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_53_67_55&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) =
    case </span><a href="#loc_50_1_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_24&#39;)"><span class="hl_varref"><span class="mpre">stringEncodingFunctions</span></span></a><span class="mpre"> </span><a href="#loc_67_44_67_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_44_67_52&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_69_15_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_15_69_16&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">, _) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_69_15_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_15_69_16&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_67_53_67_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_53_67_55&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">     -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | ASN1 Character String with encoding</span></span><span class="mpre">
data </span><a name="loc_73_6_73_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_6_73_25&#39;)"><span class="hl_tycondecl"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre"> = </span><a name="loc_73_28_73_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_28_73_47&#39;)"><span class="hl_condecl"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre">
    { </span><a name="loc_74_7_74_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_24&#39;)"><span class="hl_fielddecl"><span class="mpre">characterEncoding</span></span></a><span class="mpre">         :: </span><a href="#loc_32_6_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_24&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1StringEncoding</span></span></a><span class="mpre">
    , </span><a name="loc_75_7_75_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_32&#39;)"><span class="hl_fielddecl"><span class="mpre">getCharacterStringRawData</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types/String.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 7, srcSpanEndLine = 76, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types/String.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 7, srcSpanEndLine = 76, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types/String.h"><span class="mpre">deriving (Show,Eq,Ord)</span></span><span class="mpre">

instance </span><a href="Data.String.html#loc_34_7_34_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_34_7_34_15&#39;)"><span class="hl_classref"><span class="mpre">IsString</span></span></a><span class="mpre"> </span><a href="#loc_73_6_73_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_6_73_25&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre"> where
    </span><a href="Data.String.html#loc_35_5_35_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_35_5_35_15&#39;)"><span class="hl_fundecl"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a name="loc_79_16_79_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_16_79_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_73_28_73_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_28_73_47&#39;)"><span class="hl_conref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre"> </span><a href="#loc_34_7_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_11&#39;)"><span class="hl_conref"><span class="mpre">UTF8</span></span></a><span class="mpre"> (</span><a href="#loc_114_1_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_11&#39;)"><span class="hl_varref"><span class="mpre">encodeUTF8</span></span></a><span class="mpre"> </span><a href="#loc_79_16_79_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_16_79_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><a href="#loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="mpre">decodeUTF8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="hl_fundecl"><span class="mpre">decodeUTF8</span></span></a><span class="mpre"> </span><a name="loc_82_12_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unpack</span></span><span class="mpre"> </span><a href="#loc_82_12_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  where </span><a href="#loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="mpre">loop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
        </span><a name="loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> _   []     = []
        </span><a href="#loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_85_14_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_17&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> (</span><a name="loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_85_21_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_21_85_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
            | </span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_16&#39;)"><span class="hl_infix"><span class="mpre">`isClear`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_85_14_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_17&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_85_21_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_21_85_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
            | </span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_16&#39;)"><span class="hl_infix"><span class="mpre">`isClear`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;continuation byte in heading context&quot;</span></span><span class="mpre">
            | </span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_16&#39;)"><span class="hl_infix"><span class="mpre">`isClear`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> = </span><a href="#loc_93_9_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_15&#39;)"><span class="hl_varref"><span class="mpre">uncont</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1f</span></span><span class="mpre">) </span><a href="#loc_85_14_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_17&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_85_21_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_21_85_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
            | </span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_16&#39;)"><span class="hl_infix"><span class="mpre">`isClear`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> = </span><a href="#loc_93_9_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_15&#39;)"><span class="hl_varref"><span class="mpre">uncont</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> (</span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf</span></span><span class="mpre">)  </span><a href="#loc_85_14_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_17&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_85_21_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_21_85_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
            | </span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_16&#39;)"><span class="hl_infix"><span class="mpre">`isClear`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> = </span><a href="#loc_93_9_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_15&#39;)"><span class="hl_varref"><span class="mpre">uncont</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> (</span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7</span></span><span class="mpre">)  </span><a href="#loc_85_14_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_17&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_85_21_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_21_85_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;too many byte&quot;</span></span><span class="mpre">
        </span><a href="#loc_93_9_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_15&#39;)"><span class="mpre">uncont</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
        </span><a name="loc_93_9_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_15&#39;)"><span class="hl_fundecl"><span class="mpre">uncont</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a name="loc_93_18_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_18_93_22&#39;)"><span class="hl_vardecl"><span class="mpre">iniV</span></span></a><span class="mpre"> </span><a name="loc_93_23_93_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_23_93_26&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a name="loc_93_27_93_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_27_93_29&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> =
            case </span><a href="#loc_93_27_93_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_27_93_29&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                </span><a name="loc_95_17_95_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_17_95_19&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_95_20_95_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_20_95_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_107_9_107_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_19&#39;)"><span class="hl_varref"><span class="mpre">decodeCont</span></span></a><span class="mpre"> </span><a href="#loc_93_18_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_18_93_22&#39;)"><span class="hl_varref"><span class="mpre">iniV</span></span></a><span class="mpre"> [</span><a href="#loc_95_17_95_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_17_95_19&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_93_23_93_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_23_93_26&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_95_20_95_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_20_95_23&#39;)"><span class="hl_varref"><span class="mpre">xs&#39;</span></span></a><span class="mpre">
                _      -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;truncated continuation, expecting 1 byte&quot;</span></span><span class="mpre">
        </span><a href="#loc_93_9_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_15&#39;)"><span class="hl_fundecl"><span class="mpre">uncont</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a name="loc_97_18_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_22&#39;)"><span class="hl_vardecl"><span class="mpre">iniV</span></span></a><span class="mpre"> </span><a name="loc_97_23_97_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_26&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a name="loc_97_27_97_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_27_97_29&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> =
            case </span><a href="#loc_97_27_97_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_27_97_29&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                </span><a name="loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_99_20_99_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_20_99_22&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_99_23_99_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_23_99_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_107_9_107_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_19&#39;)"><span class="hl_varref"><span class="mpre">decodeCont</span></span></a><span class="mpre"> </span><a href="#loc_97_18_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_22&#39;)"><span class="hl_varref"><span class="mpre">iniV</span></span></a><span class="mpre"> [</span><a href="#loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">,</span><a href="#loc_99_20_99_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_20_99_22&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_97_23_97_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_26&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><a href="#loc_99_23_99_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_23_99_26&#39;)"><span class="hl_varref"><span class="mpre">xs&#39;</span></span></a><span class="mpre">
                _         -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;truncated continuation, expecting 2 bytes&quot;</span></span><span class="mpre">
        </span><a href="#loc_93_9_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_15&#39;)"><span class="hl_fundecl"><span class="mpre">uncont</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><a name="loc_101_18_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_18_101_22&#39;)"><span class="hl_vardecl"><span class="mpre">iniV</span></span></a><span class="mpre"> </span><a name="loc_101_23_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_23_101_26&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a name="loc_101_27_101_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_29&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> =
            case </span><a href="#loc_101_27_101_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_29&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                </span><a name="loc_103_17_103_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_17_103_19&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_103_20_103_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_20_103_22&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_103_23_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_25&#39;)"><span class="hl_vardecl"><span class="mpre">c3</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_103_26_103_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_29&#39;)"><span class="hl_vardecl"><span class="mpre">xs&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_107_9_107_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_19&#39;)"><span class="hl_varref"><span class="mpre">decodeCont</span></span></a><span class="mpre"> </span><a href="#loc_101_18_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_18_101_22&#39;)"><span class="hl_varref"><span class="mpre">iniV</span></span></a><span class="mpre"> [</span><a href="#loc_103_17_103_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_17_103_19&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">,</span><a href="#loc_103_20_103_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_20_103_22&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">,</span><a href="#loc_103_23_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_25&#39;)"><span class="hl_varref"><span class="mpre">c3</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_101_23_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_23_101_26&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><a href="#loc_103_26_103_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_29&#39;)"><span class="hl_varref"><span class="mpre">xs&#39;</span></span></a><span class="mpre">
                _            -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;truncated continuation, expecting 3 bytes&quot;</span></span><span class="mpre">
        </span><a href="#loc_93_9_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_15&#39;)"><span class="hl_fundecl"><span class="mpre">uncont</span></span></a><span class="mpre"> _ _ _ _ = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;invalid number of bytes for continuation&quot;</span></span><span class="mpre">
        </span><a href="#loc_107_9_107_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_19&#39;)"><span class="mpre">decodeCont</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
        </span><a name="loc_107_9_107_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodeCont</span></span></a><span class="mpre"> </span><a name="loc_107_20_107_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_20_107_24&#39;)"><span class="hl_vardecl"><span class="mpre">iniV</span></span></a><span class="mpre"> </span><a name="loc_107_25_107_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_25_107_26&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="#loc_110_9_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_19&#39;)"><span class="hl_varref"><span class="mpre">isContByte</span></span></a><span class="mpre"> </span><a href="#loc_107_25_107_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_25_107_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> (\</span><a name="loc_108_51_108_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_51_108_54&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_108_55_108_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_55_108_56&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_108_51_108_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_51_108_54&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_108_55_108_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_55_108_56&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_107_20_107_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_20_107_24&#39;)"><span class="hl_varref"><span class="mpre">iniV</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_108_123_108_124" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_123_108_124&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_108_123_108_124" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_123_108_124&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">) </span><a href="#loc_107_25_107_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_25_107_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;continuation bytes invalid&quot;</span></span><span class="mpre">
        </span><a name="loc_110_9_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_19&#39;)"><span class="hl_fundecl"><span class="mpre">isContByte</span></span></a><span class="mpre"> </span><a name="loc_110_20_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_20_110_21&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_110_20_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_20_110_21&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_infix"><span class="mpre">`testBit`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_110_20_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_20_110_21&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_16&#39;)"><span class="hl_infix"><span class="mpre">`isClear`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">
        </span><a name="loc_111_9_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_16&#39;)"><span class="hl_fundecl"><span class="mpre">isClear</span></span></a><span class="mpre"> </span><a name="loc_111_17_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_17_111_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_111_19_111_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_111_17_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_17_111_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_infix"><span class="mpre">`testBit`</span></span></a><span class="mpre"> </span><a href="#loc_111_19_111_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)

</span><a href="#loc_114_1_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_11&#39;)"><span class="mpre">encodeUTF8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_114_1_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_11&#39;)"><span class="hl_fundecl"><span class="mpre">encodeUTF8</span></span></a><span class="mpre"> </span><a name="loc_114_12_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><a href="#loc_115_9_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_15&#39;)"><span class="hl_varref"><span class="mpre">toUTF8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre">) </span><a href="#loc_114_12_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  where </span><a name="loc_115_9_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_15&#39;)"><span class="hl_fundecl"><span class="mpre">toUTF8</span></span></a><span class="mpre"> </span><a name="loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">
            | </span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">      = [</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">]
            | </span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x800</span></span><span class="mpre">     = [</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)), </span><a href="#loc_126_9_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_15&#39;)"><span class="hl_varref"><span class="mpre">toCont</span></span></a><span class="mpre"> </span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">]
            | </span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">   = [</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">))
                              ,</span><a href="#loc_126_9_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_15&#39;)"><span class="hl_varref"><span class="mpre">toCont</span></span></a><span class="mpre"> (</span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)
                              ,</span><a href="#loc_126_9_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_15&#39;)"><span class="hl_varref"><span class="mpre">toCont</span></span></a><span class="mpre"> </span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">]
            | </span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x200000</span></span><span class="mpre">  = [</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">))
                              , </span><a href="#loc_126_9_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_15&#39;)"><span class="hl_varref"><span class="mpre">toCont</span></span></a><span class="mpre"> (</span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)
                              , </span><a href="#loc_126_9_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_15&#39;)"><span class="hl_varref"><span class="mpre">toCont</span></span></a><span class="mpre"> (</span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)
                              , </span><a href="#loc_126_9_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_15&#39;)"><span class="hl_varref"><span class="mpre">toCont</span></span></a><span class="mpre"> </span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">]
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not a valid value&quot;</span></span><span class="mpre">
        </span><a name="loc_126_9_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_15&#39;)"><span class="hl_fundecl"><span class="mpre">toCont</span></span></a><span class="mpre"> </span><a name="loc_126_16_126_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_16_126_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> (</span><a href="#loc_126_16_126_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_16_126_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">))

</span><a href="#loc_129_1_129_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_12&#39;)"><span class="mpre">decodeASCII</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_129_1_129_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_12&#39;)"><span class="hl_vardecl"><span class="mpre">decodeASCII</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BC.unpack</span></span><span class="mpre">

</span><a href="#loc_132_1_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_12&#39;)"><span class="mpre">encodeASCII</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_132_1_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_12&#39;)"><span class="hl_vardecl"><span class="mpre">encodeASCII</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BC.pack</span></span><span class="mpre">

</span><a href="#loc_135_1_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_10&#39;)"><span class="mpre">decodeBMP</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_135_1_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_10&#39;)"><span class="hl_fundecl"><span class="mpre">decodeBMP</span></span></a><span class="mpre"> </span><a name="loc_135_11_135_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_11_135_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">odd</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_135_11_135_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_11_135_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not a valid BMP string&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
</span><a href="#loc_139_1_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_10&#39;)"><span class="mpre">encodeBMP</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_139_1_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_10&#39;)"><span class="hl_fundecl"><span class="mpre">encodeBMP</span></span></a><span class="mpre"> </span><a name="loc_139_11_139_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><a href="#loc_140_9_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_15&#39;)"><span class="hl_varref"><span class="mpre">toUCS2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre">) </span><a href="#loc_139_11_139_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  where </span><a name="loc_140_9_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_15&#39;)"><span class="hl_fundecl"><span class="mpre">toUCS2</span></span></a><span class="mpre"> </span><a name="loc_140_16_140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_16_140_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = [</span><a href="#loc_141_19_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_19_141_21&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre">,</span><a href="#loc_142_19_142_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_19_142_21&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">]
            where </span><a name="loc_141_19_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_19_141_21&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_140_16_140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_16_140_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)
                  </span><a name="loc_142_19_142_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_19_142_21&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_140_16_140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_16_140_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre">)

</span><a href="#loc_145_1_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_12&#39;)"><span class="mpre">decodeUTF32</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_145_1_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_12&#39;)"><span class="hl_fundecl"><span class="mpre">decodeUTF32</span></span></a><span class="mpre"> </span><a name="loc_145_13_145_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_13_145_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">
    | (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_145_13_145_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_13_145_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not a valid UTF32 string&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                 = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
</span><a href="#loc_149_1_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_12&#39;)"><span class="mpre">encodeUTF32</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_149_1_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_12&#39;)"><span class="hl_fundecl"><span class="mpre">encodeUTF32</span></span></a><span class="mpre"> </span><a name="loc_149_13_149_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_13_149_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><a href="#loc_150_9_150_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_16&#39;)"><span class="hl_varref"><span class="mpre">toUTF32</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre">) </span><a href="#loc_149_13_149_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_13_149_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  where </span><a name="loc_150_9_150_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_16&#39;)"><span class="hl_fundecl"><span class="mpre">toUTF32</span></span></a><span class="mpre"> </span><a name="loc_150_17_150_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_17_150_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = [</span><a href="#loc_151_19_151_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_19_151_21&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre">,</span><a href="#loc_152_19_152_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_19_152_21&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">,</span><a href="#loc_153_19_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_21&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">,</span><a href="#loc_154_19_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_19_154_21&#39;)"><span class="hl_varref"><span class="mpre">b3</span></span></a><span class="mpre">]
            where </span><a name="loc_151_19_151_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_19_151_21&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_150_17_150_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_17_150_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">)
                  </span><a name="loc_152_19_152_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_19_152_21&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> ((</span><a href="#loc_150_17_150_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_17_150_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre">)
                  </span><a name="loc_153_19_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_21&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> ((</span><a href="#loc_150_17_150_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_17_150_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)  </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre">)
                  </span><a name="loc_154_19_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_19_154_21&#39;)"><span class="hl_vardecl"><span class="mpre">b3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_150_17_150_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_17_150_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre">)
</span></div></body></html>