<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}

module TagSoup.Benchmark where

import Text.HTML.TagSoup

import Control.DeepSeq
import Control.Monad
import Data.List
import Data.Maybe
import System.IO.Unsafe(</span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="mpre">unsafeInterleaveIO</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/TagSoup/Benchmark.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BS
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/TagSoup/Benchmark.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre"> as LBS
import Data.Time.Clock.POSIX(</span><a href="Data.Time.Clock.POSIX.html#loc_51_1_51_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.POSIX.html#loc_51_1_51_13&#39;)"><span class="mpre">getPOSIXTime</span></a><span class="mpre">)

</span><a name="loc_16_1_16_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_1_16_5&#39;)"><span class="hl_vardecl"><span class="mpre">conf</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0.95</span></span><span class="mpre">


</span><a href="#loc_20_1_20_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_9&#39;)"><span class="mpre">timefile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_20_1_20_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_9&#39;)"><span class="hl_fundecl"><span class="mpre">timefile</span></span></a><span class="mpre"> </span><a name="loc_20_10_20_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_10_20_14&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> = do
    </span><span class="hl_comment"><span class="mpre">-- use LBS to be most representative of real life</span></span><span class="mpre">
    </span><a name="loc_22_5_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_8&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">LBS.readFile</span></span><span class="mpre"> </span><a href="#loc_20_10_20_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_10_20_14&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
    let </span><a name="loc_23_9_23_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_9_23_12&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">LBS.unpack</span></span><span class="mpre"> </span><a href="#loc_22_5_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_8&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">
        </span><a name="loc_24_9_24_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">LBS.toChunks</span></span><span class="mpre"> </span><a href="#loc_22_5_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_8&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">LBS.length</span></span><span class="mpre"> </span><a href="#loc_22_5_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_8&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_23_9_23_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_9_23_12&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.length</span></span><span class="mpre"> </span><a href="#loc_24_9_24_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">benchWith</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="#loc_23_9_23_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_9_23_12&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="#loc_24_9_24_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="#loc_22_5_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_8&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_96_1_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_12&#39;)"><span class="hl_varref"><span class="mpre">benchStatic</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">LBS.length</span></span><span class="mpre"> </span><a href="#loc_22_5_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_8&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">)


</span><a href="#loc_30_1_30_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_7&#39;)"><span class="mpre">sample</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_30_1_30_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_7&#39;)"><span class="hl_vardecl"><span class="mpre">sample</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&lt;this is a test with=&#39;attributes&#39; and other=\&quot;things&amp;quot;tested\&quot; /&gt;&lt;neil&gt; is &lt;/here&gt;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
         </span><span class="hl_string"><span class="mpre">&quot;&lt;!-- comment --&gt; and some just random &amp;amp; test &amp;gt;&amp;lt;&lt;foo&gt;&lt;/bar&gt;&lt;bar&gt;&lt;bob href=no&gt;&quot;</span></span><span class="mpre">

</span><a name="loc_33_1_33_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_8&#39;)"><span class="hl_vardecl"><span class="mpre">nsample</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_583_1_583_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_583_1_583_14&#39;)"><span class="hl_varref"><span class="mpre">genericLength</span></span></a><span class="mpre"> </span><a href="#loc_30_1_30_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_7&#39;)"><span class="hl_varref"><span class="mpre">sample</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">

</span><a href="#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_5&#39;)"><span class="mpre">time</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_36_1_36_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_5&#39;)"><span class="hl_vardecl"><span class="mpre">time</span></span></a><span class="mpre"> = </span><a href="#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">benchWith</span></span></a><span class="mpre"> (</span><a href="#loc_38_9_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_12&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">,</span><a href="#loc_39_9_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">,</span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">) </span><a href="#loc_81_1_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_14&#39;)"><span class="hl_varref"><span class="mpre">benchVariable</span></span></a><span class="mpre">
    where
        </span><a name="loc_38_9_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_12&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = \</span><a name="loc_38_16_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_632_1_632_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_632_1_632_17&#39;)"><span class="hl_varref"><span class="mpre">genericReplicate</span></span></a><span class="mpre"> </span><a href="#loc_38_16_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_30_1_30_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_7&#39;)"><span class="hl_varref"><span class="mpre">sample</span></span></a><span class="mpre">
        </span><a name="loc_39_9_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">  = let </span><a name="loc_39_19_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.pack</span></span><span class="mpre"> </span><a href="#loc_30_1_30_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_7&#39;)"><span class="hl_varref"><span class="mpre">sample</span></span></a><span class="mpre"> in \</span><a name="loc_39_42_39_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_42_39_43&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">BS.concat</span></span><span class="mpre"> (</span><a href="Data.List.html#loc_632_1_632_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_632_1_632_17&#39;)"><span class="hl_varref"><span class="mpre">genericReplicate</span></span></a><span class="mpre"> </span><a href="#loc_39_42_39_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_42_39_43&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_39_19_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
        </span><a name="loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre"> = let </span><a name="loc_40_19_40_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_19_40_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">LBS.pack</span></span><span class="mpre"> </span><a href="#loc_30_1_30_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_7&#39;)"><span class="hl_varref"><span class="mpre">sample</span></span></a><span class="mpre"> in \</span><a name="loc_40_43_40_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_43_40_44&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">LBS.concat</span></span><span class="mpre"> (</span><a href="Data.List.html#loc_632_1_632_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_632_1_632_17&#39;)"><span class="hl_varref"><span class="mpre">genericReplicate</span></span></a><span class="mpre"> </span><a href="#loc_40_43_40_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_43_40_44&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_40_19_40_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_19_40_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)



</span><a href="#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_10&#39;)"><span class="mpre">benchWith</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LBS.ByteString</span></span><span class="mpre">)
          -&gt; ((</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_46_1_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_10&#39;)"><span class="hl_fundecl"><span class="mpre">benchWith</span></span></a><span class="mpre"> (</span><a name="loc_46_12_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_12_46_15&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">,</span><a name="loc_46_16_46_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_18&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">,</span><a name="loc_46_19_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_22&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre">) </span><a name="loc_46_24_46_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_24_46_29&#39;)"><span class="hl_vardecl"><span class="mpre">bench</span></span></a><span class="mpre"> = do
        </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Timing parseTags in characters/second&quot;</span></span><span class="mpre">
        let </span><a name="loc_48_13_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_19&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]) [</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">round</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_16_1_16_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_1_16_5&#39;)"><span class="hl_varref"><span class="mpre">conf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;% confidence)&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;String&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;BS&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;LBS&quot;</span></span><span class="mpre">]
        </span><a name="loc_49_9_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_13&#39;)"><span class="hl_vardecl"><span class="mpre">rows</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> </span><a href="#loc_52_9_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_12&#39;)"><span class="hl_varref"><span class="mpre">row</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">]
        </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_61_9_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_15&#39;)"><span class="hl_varref"><span class="mpre">strict</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_136_1_136_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_5&#39;)"><span class="hl_varref"><span class="mpre">grid</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_145_1_145_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_7&#39;)"><span class="hl_varref"><span class="mpre">delay2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_48_13_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_19&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_49_9_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_13&#39;)"><span class="hl_varref"><span class="mpre">rows</span></span></a><span class="mpre">
    where
        </span><a name="loc_52_9_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_12&#39;)"><span class="hl_fundecl"><span class="mpre">row</span></span></a><span class="mpre"> [</span><a name="loc_52_14_52_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_14_52_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,</span><a name="loc_52_18_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_18_52_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">] = do
            let </span><a name="loc_53_17_53_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_17_53_23&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="mpre"> [</span><a href="#loc_54_17_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_18&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_52_14_52_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_14_52_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;pos&quot;</span></span><span class="mpre">, </span><a href="#loc_54_17_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_18&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;warn&quot;</span></span><span class="mpre">, </span><a href="#loc_54_17_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_18&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_52_18_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_18_52_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;merge&quot;</span></span><span class="mpre">]
                </span><a name="loc_54_17_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_18&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_54_19_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_20&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_54_21_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_21_54_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (if </span><a href="#loc_54_19_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre"> else </span><span class="hl_char"><span class="mpre">&#39;!&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_54_21_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_21_54_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                </span><a name="loc_55_17_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_17_55_18&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_55_19_55_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_19_55_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_46_24_46_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_24_46_29&#39;)"><span class="hl_varref"><span class="mpre">bench</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_55_32_55_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_32_55_33&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Parser.html#loc_25_1_25_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Parser.html#loc_25_1_25_17&#39;)"><span class="hl_varref"><span class="mpre">parseTagsOptions</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/TagSoup/Benchmark.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 60, srcSpanEndLine = 55, srcSpanEndColumn = 124}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/TagSoup/Benchmark.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 72, srcSpanEndLine = 55, srcSpanEndColumn = 73},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/TagSoup/Benchmark.hs&quot;, srcSpanStartL"><span class="mpre">parseOptions{optTagPosition=a,optTagWarning=b,optTagTextMerge=c}</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_55_19_55_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_19_55_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_55_32_55_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_32_55_33&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            </span><a name="loc_56_13_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_15&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_55_17_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_17_55_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_46_12_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_12_46_15&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
            </span><a name="loc_57_13_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_13_57_15&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_55_17_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_17_55_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_46_16_46_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            </span><a name="loc_58_13_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_15&#39;)"><span class="hl_vardecl"><span class="mpre">c3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_55_17_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_17_55_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_46_19_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_22&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [[</span><a href="#loc_53_17_53_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_17_53_23&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre">],</span><a href="#loc_56_13_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_15&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">,</span><a href="#loc_57_13_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_13_57_15&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">,</span><a href="#loc_58_13_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_15&#39;)"><span class="hl_varref"><span class="mpre">c3</span></span></a><span class="mpre">]

        </span><a name="loc_61_9_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_15&#39;)"><span class="hl_vardecl"><span class="mpre">strict</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- BENCHMARK ON THE SAMPLE INPUT</span></span><span class="mpre">

</span><a name="loc_67_1_67_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_5&#39;)"><span class="hl_fundecl"><span class="mpre">disp</span></span></a><span class="mpre"> </span><a name="loc_67_6_67_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_6_67_8&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_110_1_110_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_9&#39;)"><span class="hl_varref"><span class="mpre">showUnit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">floor</span></span><span class="mpre"> </span><a href="#loc_68_11_68_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_15&#39;)"><span class="hl_varref"><span class="mpre">xbar</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; (~&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_69_11_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_11_69_14&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;%)&quot;</span></span><span class="mpre">
    where </span><a name="loc_68_11_68_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_15&#39;)"><span class="hl_vardecl"><span class="mpre">xbar</span></span></a><span class="mpre"> = </span><a href="#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="hl_varref"><span class="mpre">mean</span></span></a><span class="mpre"> </span><a href="#loc_67_6_67_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_6_67_8&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
          </span><a name="loc_69_11_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_11_69_14&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_67_6_67_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_6_67_8&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;?&quot;</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ceiling</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="hl_varref"><span class="mpre">range</span></span></a><span class="mpre"> </span><a href="#loc_16_1_16_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_1_16_5&#39;)"><span class="hl_varref"><span class="mpre">conf</span></span></a><span class="mpre"> </span><a href="#loc_67_6_67_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_6_67_8&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_68_11_68_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_15&#39;)"><span class="hl_varref"><span class="mpre">xbar</span></span></a><span class="mpre">) 

</span><a name="loc_71_1_71_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_5&#39;)"><span class="hl_fundecl"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a name="loc_71_6_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><a href="#loc_71_6_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_6_71_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)


</span><a name="loc_74_1_74_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_8&#39;)"><span class="hl_vardecl"><span class="mpre">aimTime</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0.3</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- seconds to aim for</span></span><span class="mpre">
</span><a name="loc_75_1_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_8&#39;)"><span class="hl_vardecl"><span class="mpre">minTime</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0.2</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- below this a test is considered invalid</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- given a number of times to repeat sample, return a list of what</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to display</span></span><span class="mpre">
</span><a href="#loc_81_1_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_14&#39;)"><span class="mpre">benchVariable</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
</span><a name="loc_81_1_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_14&#39;)"><span class="hl_fundecl"><span class="mpre">benchVariable</span></span></a><span class="mpre"> </span><a name="loc_81_15_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_17&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> = </span><a href="#loc_71_1_71_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_5&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;?&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_83_9_83_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> []
    where
        </span><a name="loc_83_9_83_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_83_11_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_11_83_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_83_13_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_17&#39;)"><span class="hl_vardecl"><span class="mpre">seen</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_83_13_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_17&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre"> = </span><a href="#loc_71_1_71_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_5&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_67_1_67_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_5&#39;)"><span class="hl_varref"><span class="mpre">disp</span></span></a><span class="mpre"> </span><a href="#loc_83_13_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_17&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
                 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeInterleaveIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_85_13_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_16&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_127_1_127_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_6&#39;)"><span class="hl_varref"><span class="mpre">timer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_81_15_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_17&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_83_11_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_11_83_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            let </span><a name="loc_86_17_86_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_20&#39;)"><span class="hl_vardecl"><span class="mpre">cps</span></span></a><span class="mpre"> = if </span><a href="#loc_85_13_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_16&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><a href="#loc_83_11_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_11_83_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_33_1_33_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_8&#39;)"><span class="hl_varref"><span class="mpre">nsample</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_85_13_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_16&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre">
            if </span><a href="#loc_85_13_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_16&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_75_1_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_8&#39;)"><span class="hl_varref"><span class="mpre">minTime</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_83_13_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_17&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_85_13_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_16&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">aimTime</span></span></a><span class="mpre">) then do
                let </span><a name="loc_88_21_88_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_21_88_27&#39;)"><span class="hl_vardecl"><span class="mpre">factor</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">floor</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">aimTime</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_85_13_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_16&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre">
                </span><a href="#loc_71_1_71_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_5&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;? &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_67_1_67_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_5&#39;)"><span class="hl_varref"><span class="mpre">disp</span></span></a><span class="mpre"> [</span><a href="#loc_86_17_86_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_20&#39;)"><span class="hl_varref"><span class="mpre">cps</span></span></a><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_83_9_83_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_83_11_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_11_83_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_88_21_88_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_21_88_27&#39;)"><span class="hl_varref"><span class="mpre">factor</span></span></a><span class="mpre">) []
             else
                </span><a href="#loc_71_1_71_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_5&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_83_13_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_17&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_67_1_67_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_5&#39;)"><span class="hl_varref"><span class="mpre">disp</span></span></a><span class="mpre"> (</span><a href="#loc_86_17_86_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_20&#39;)"><span class="hl_varref"><span class="mpre">cps</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_83_13_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_17&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_83_9_83_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_83_11_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_11_83_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_86_17_86_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_20&#39;)"><span class="hl_varref"><span class="mpre">cps</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_83_13_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_17&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">)



</span><a href="#loc_96_1_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_12&#39;)"><span class="mpre">benchStatic</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
</span><a name="loc_96_1_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_12&#39;)"><span class="hl_fundecl"><span class="mpre">benchStatic</span></span></a><span class="mpre"> </span><a name="loc_96_13_96_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_20&#39;)"><span class="hl_vardecl"><span class="mpre">nsample</span></span></a><span class="mpre"> </span><a name="loc_96_21_96_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_21_96_23&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> = </span><a href="#loc_71_1_71_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_5&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;?&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_98_9_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> []
    where
        </span><a name="loc_98_9_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_98_11_98_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_15&#39;)"><span class="hl_vardecl"><span class="mpre">seen</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_98_11_98_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre"> = </span><a href="#loc_71_1_71_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_5&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_67_1_67_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_5&#39;)"><span class="hl_varref"><span class="mpre">disp</span></span></a><span class="mpre"> </span><a href="#loc_98_11_98_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeInterleaveIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_100_13_100_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_16&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_127_1_127_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_6&#39;)"><span class="hl_varref"><span class="mpre">timer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_96_21_96_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_21_96_23&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_583_1_583_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_583_1_583_14&#39;)"><span class="hl_varref"><span class="mpre">genericLength</span></span></a><span class="mpre"> </span><a href="#loc_98_11_98_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">
            let </span><a name="loc_101_17_101_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_20&#39;)"><span class="hl_vardecl"><span class="mpre">cps</span></span></a><span class="mpre"> = if </span><a href="#loc_100_13_100_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_16&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a href="#loc_96_13_96_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_20&#39;)"><span class="hl_varref"><span class="mpre">nsample</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_100_13_100_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_16&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre">
            </span><a href="#loc_71_1_71_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_5&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_98_11_98_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_67_1_67_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_5&#39;)"><span class="hl_varref"><span class="mpre">disp</span></span></a><span class="mpre"> (</span><a href="#loc_101_17_101_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_20&#39;)"><span class="hl_varref"><span class="mpre">cps</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_98_11_98_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_98_9_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_101_17_101_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_20&#39;)"><span class="hl_varref"><span class="mpre">cps</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_98_11_98_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- UTILITY FUNCTIONS</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Given a number, show it using a unit and decimal place</span></span><span class="mpre">
</span><a href="#loc_110_1_110_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_9&#39;)"><span class="mpre">showUnit</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_110_1_110_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_9&#39;)"><span class="hl_fundecl"><span class="mpre">showUnit</span></span></a><span class="mpre"> </span><a name="loc_110_10_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_10_110_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_118_9_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_12&#39;)"><span class="hl_varref"><span class="mpre">num</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_115_9_115_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_13&#39;)"><span class="hl_varref"><span class="mpre">unit</span></span></a><span class="mpre">
    where
        </span><a name="loc_112_9_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_14&#39;)"><span class="hl_vardecl"><span class="mpre">units</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot; KMGTPEZY&quot;</span></span><span class="mpre">
        (</span><a name="loc_113_10_113_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_10_113_13&#39;)"><span class="hl_vardecl"><span class="mpre">use</span></span></a><span class="mpre">,</span><a name="loc_113_14_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_14_113_18&#39;)"><span class="hl_vardecl"><span class="mpre">skip</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">splitAt</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_110_10_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_10_110_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><a name="loc_115_9_115_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_13&#39;)"><span class="hl_vardecl"><span class="mpre">unit</span></span></a><span class="mpre"> = [</span><a href="#loc_112_9_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_14&#39;)"><span class="hl_varref"><span class="mpre">units</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!!</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_113_14_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_14_113_18&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)]

        </span><a name="loc_117_9_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_12&#39;)"><span class="hl_vardecl"><span class="mpre">dot</span></span></a><span class="mpre"> = ((</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_113_14_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_14_113_18&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_118_9_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_12&#39;)"><span class="hl_vardecl"><span class="mpre">num</span></span></a><span class="mpre"> = </span><a href="#loc_119_20_119_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_20_119_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> | </span><a href="#loc_119_22_119_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_22_119_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_119_22_119_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_22_119_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            where (</span><a name="loc_119_20_119_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_20_119_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_119_22_119_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_22_119_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">splitAt</span></span><span class="mpre"> </span><a href="#loc_117_9_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_12&#39;)"><span class="hl_varref"><span class="mpre">dot</span></span></a><span class="mpre"> </span><a href="#loc_113_10_113_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_10_113_13&#39;)"><span class="hl_varref"><span class="mpre">use</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- copied from the criterion package</span></span><span class="mpre">
</span><a href="#loc_124_1_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_8&#39;)"><span class="mpre">getTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_124_1_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_8&#39;)"><span class="hl_vardecl"><span class="mpre">getTime</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">fromRational</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.Time.Clock.POSIX.html#loc_51_1_51_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.POSIX.html#loc_51_1_51_13&#39;)"><span class="hl_varref"><span class="mpre">getPOSIXTime</span></span></a><span class="mpre">

</span><a href="#loc_127_1_127_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_6&#39;)"><span class="mpre">timer</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_127_1_127_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_6&#39;)"><span class="hl_fundecl"><span class="mpre">timer</span></span></a><span class="mpre"> </span><a name="loc_127_7_127_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_7_127_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do
    </span><a name="loc_128_5_128_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_5_128_10&#39;)"><span class="hl_vardecl"><span class="mpre">start</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_124_1_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_8&#39;)"><span class="hl_varref"><span class="mpre">getTime</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_127_7_127_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_7_127_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a name="loc_130_5_130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_5_130_8&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_124_1_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_8&#39;)"><span class="hl_varref"><span class="mpre">getTime</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_130_5_130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_5_130_8&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_128_5_128_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_5_128_10&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- display a grid</span></span><span class="mpre">
</span><a href="#loc_136_1_136_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_5&#39;)"><span class="mpre">grid</span></a><span class="mpre"> :: [[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_136_1_136_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_5&#39;)"><span class="hl_fundecl"><span class="mpre">grid</span></span></a><span class="mpre"> </span><a name="loc_136_6_136_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_6_136_8&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="hl_varref"><span class="mpre">unlines</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> </span><a href="#loc_138_11_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_11_138_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_137_11_137_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_11_137_15&#39;)"><span class="hl_varref"><span class="mpre">cols</span></span></a><span class="mpre">) </span><a href="#loc_136_6_136_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_6_136_8&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    where </span><a name="loc_137_11_137_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_11_137_15&#39;)"><span class="hl_vardecl"><span class="mpre">cols</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Data.List.html#loc_523_1_523_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_523_1_523_8&#39;)"><span class="hl_varref"><span class="mpre">maximum</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_451_1_451_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_451_1_451_10&#39;)"><span class="hl_varref"><span class="mpre">transpose</span></span></a><span class="mpre"> </span><a href="#loc_136_6_136_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_6_136_8&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
          </span><a name="loc_138_11_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_11_138_12&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_138_13_138_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_13_138_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_138_15_138_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_15_138_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_138_15_138_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_15_138_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> (</span><a href="#loc_138_13_138_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_13_138_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_138_15_138_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_15_138_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- display a series of grids over time</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- when a grid gets to [] keep its value at that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- when all grids get to [] return []</span></span><span class="mpre">
</span><a href="#loc_145_1_145_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_7&#39;)"><span class="mpre">delay2</span></a><span class="mpre"> :: [[[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]]] -&gt; [[[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]]]
</span><a name="loc_145_1_145_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_7&#39;)"><span class="hl_fundecl"><span class="mpre">delay2</span></span></a><span class="mpre"> </span><a name="loc_145_8_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_8_145_10&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre">) </span><a href="#loc_145_8_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_8_145_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_145_8_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_8_145_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) then [] else </span><a href="#loc_145_1_145_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_7&#39;)"><span class="hl_varref"><span class="mpre">delay2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_146_11_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_11_146_13&#39;)"><span class="hl_varref"><span class="mpre">tl</span></span></a><span class="mpre">) </span><a href="#loc_145_8_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_8_145_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    where </span><a name="loc_146_11_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_11_146_13&#39;)"><span class="hl_fundecl"><span class="mpre">tl</span></span></a><span class="mpre"> (</span><a name="loc_146_15_146_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_15_146_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_146_17_146_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_17_146_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_146_17_146_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_17_146_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> then </span><a href="#loc_146_15_146_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_15_146_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_146_17_146_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_17_146_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> else </span><a href="#loc_146_17_146_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_17_146_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- INSTANCES</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/TagSoup/Benchmark.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 10, srcSpanEndLine = 152, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/TagSoup/Benchmark.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 19, srcSpanEndLine = 152, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0."><span class="mpre">NFData a =&gt;</span></span><span class="mpre"> </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">TagOpen</span></span><span class="mpre"> </span><a name="loc_153_18_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_18_153_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_153_20_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_20_153_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_153_18_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_18_153_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_153_20_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_20_153_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">TagClose</span></span><span class="mpre"> </span><a name="loc_154_19_154_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_19_154_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_154_19_154_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_19_154_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">TagText</span></span><span class="mpre"> </span><a name="loc_155_18_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_155_18_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">TagComment</span></span><span class="mpre"> </span><a name="loc_156_21_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_156_21_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">TagWarning</span></span><span class="mpre"> </span><a name="loc_157_21_157_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_21_157_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_157_21_157_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_21_157_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">TagPosition</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">y</span></span><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- both are already ! bound</span></span><span class="mpre">


#ifndef BYTESTRING_HAS_NFDATA
# ifdef MIN_VERSION_bytestring
#  define BYTESTRING_HAS_NFDATA (MIN_VERSION_bytestring(0,10,0))
# else
#  define BYTESTRING_HAS_NFDATA (__GLASGOW_HASKELL__ &gt;= 706)
# endif
#endif

#if !BYTESTRING_HAS_NFDATA
instance </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LBS.ByteString</span></span><span class="mpre"> where
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a name="loc_171_9_171_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_9_171_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">LBS.length</span></span><span class="mpre"> </span><a href="#loc_171_9_171_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_9_171_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

instance </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> where
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a name="loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.length</span></span><span class="mpre"> </span><a href="#loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
#endif


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- STATISTICS</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Provided by Emily Mitchell</span></span><span class="mpre">

</span><a name="loc_182_1_182_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_7&#39;)"><span class="hl_vardecl"><span class="mpre">confNs</span></span></a><span class="mpre"> = let </span><a name="loc_182_14_182_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_14_182_17&#39;)"><span class="hl_vardecl"><span class="mpre">(*)</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> in
    [</span><span class="hl_num"><span class="mpre">0.95</span></span><span class="mpre"> </span><a href="#loc_182_14_182_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_14_182_17&#39;)"><span class="hl_infix"><span class="mpre">*</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1.96</span></span><span class="mpre">
    ,</span><span class="hl_num"><span class="mpre">0.90</span></span><span class="mpre"> </span><a href="#loc_182_14_182_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_14_182_17&#39;)"><span class="hl_infix"><span class="mpre">*</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1.644</span></span><span class="mpre">]

</span><a href="#loc_187_1_187_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_5&#39;)"><span class="mpre">size</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_187_1_187_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_5&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_583_1_583_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_583_1_583_14&#39;)"><span class="hl_varref"><span class="mpre">genericLength</span></span></a><span class="mpre">

</span><a href="#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="mpre">mean</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="hl_fundecl"><span class="mpre">mean</span></span></a><span class="mpre"> </span><a name="loc_190_6_190_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_6_190_8&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1025_1_1025_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1025_1_1025_4&#39;)"><span class="hl_varref"><span class="mpre">sum</span></span></a><span class="mpre"> </span><a href="#loc_190_6_190_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_6_190_8&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_187_1_187_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_5&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_190_6_190_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_6_190_8&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><a href="#loc_193_1_193_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_7&#39;)"><span class="mpre">stddev</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_193_1_193_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_7&#39;)"><span class="hl_fundecl"><span class="mpre">stddev</span></span></a><span class="mpre"> </span><a name="loc_193_8_193_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_8_193_10&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">sqrt</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_1025_1_1025_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1025_1_1025_4&#39;)"><span class="hl_varref"><span class="mpre">sum</span></span></a><span class="mpre"> [</span><a href="#loc_195_11_195_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_14&#39;)"><span class="hl_varref"><span class="mpre">sqr</span></span></a><span class="mpre"> (</span><a href="#loc_193_42_193_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_42_193_43&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_194_11_194_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_11_194_15&#39;)"><span class="hl_varref"><span class="mpre">xbar</span></span></a><span class="mpre">) | </span><a name="loc_193_42_193_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_42_193_43&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_193_8_193_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_8_193_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_187_1_187_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_5&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_193_8_193_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_8_193_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    where </span><a name="loc_194_11_194_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_11_194_15&#39;)"><span class="hl_vardecl"><span class="mpre">xbar</span></span></a><span class="mpre"> = </span><a href="#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="hl_varref"><span class="mpre">mean</span></span></a><span class="mpre"> </span><a href="#loc_193_8_193_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_8_193_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
          </span><a name="loc_195_11_195_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_14&#39;)"><span class="hl_fundecl"><span class="mpre">sqr</span></span></a><span class="mpre"> </span><a name="loc_195_15_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_15_195_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_195_15_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_15_195_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_195_15_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_15_195_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- given a sample, and a required confidence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of the mean (i.e. 2.5% = 0.025)</span></span><span class="mpre">
</span><a href="#loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="mpre">range</span></a><span class="mpre"> ::</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="hl_fundecl"><span class="mpre">range</span></span></a><span class="mpre"> </span><a name="loc_200_7_200_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_7_200_11&#39;)"><span class="hl_vardecl"><span class="mpre">conf</span></span></a><span class="mpre"> </span><a name="loc_200_12_200_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_201_11_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_11_201_16&#39;)"><span class="hl_varref"><span class="mpre">conf2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_193_1_193_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_7&#39;)"><span class="hl_varref"><span class="mpre">stddev</span></span></a><span class="mpre"> </span><a href="#loc_200_12_200_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sqrt</span></span><span class="mpre"> (</span><a href="#loc_187_1_187_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_5&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_200_12_200_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    where </span><a name="loc_201_11_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_11_201_16&#39;)"><span class="hl_vardecl"><span class="mpre">conf2</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Unknown confidence interval: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_200_7_200_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_7_200_11&#39;)"><span class="hl_varref"><span class="mpre">conf</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><a href="#loc_200_7_200_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_7_200_11&#39;)"><span class="hl_varref"><span class="mpre">conf</span></span></a><span class="mpre"> </span><a href="#loc_182_1_182_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_7&#39;)"><span class="hl_varref"><span class="mpre">confNs</span></span></a><span class="mpre">
</span></div></body></html>