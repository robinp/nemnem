<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ViewPatterns, PatternGuards #-}

</span><span class="hl_comment"><span class="mpre">{-
    Concept:
    Remove all the lambdas you can be inserting only sections
    Never create a right section with +-# as the operator (they are misparsed)

    Rules:
    fun a = \x -&gt; y  -- promote lambdas, provided no where&#39;s outside the lambda
    fun x = y x  -- eta reduce, x /= mr and foo /= symbol
    \x -&gt; y x  -- eta reduce
    ((#) x) ==&gt; (x #)  -- rotate operators
    (flip op x) ==&gt; (`op` x)  -- rotate operators
    \x y -&gt; x + y ==&gt; (+)  -- insert operator
    \x y -&gt; op y x ==&gt; flip op
    \x -&gt; x + y ==&gt; (+ y)  -- insert section, 
    \x -&gt; op x y ==&gt; (`op` y)  -- insert section 
    \x -&gt; y + x ==&gt; (y +)  -- insert section
    \x -&gt; \y -&gt; ... ==&gt; \x y -- lambda compression
    \x -&gt; (x +) ==&gt; (+) -- operator reduction

&lt;TEST&gt;
f a = \x -&gt; x + x -- f a x = x + x
f a = \a -&gt; a + a -- f _ a = a + a
f a = \x -&gt; x + x where _ = test
f = \x -&gt; x + x -- f x = x + x
fun x y z = f x y z -- fun = f
fun x y z = f x x y z -- fun x = f x x
fun x y z = f g z -- fun x y = f g
fun mr = y mr
f = foo ((*) x) -- (x *)
f = (*) x
f = foo (flip op x) -- (`op` x)
f = flip op x
f = foo (flip (*) x) -- (* x)
f = foo (flip (-) x)
f = foo (\x y -&gt; fun x y) -- @Error fun
f = foo (\x y -&gt; x + y) -- (+)
f = foo (\x -&gt; x * y) -- @Warning (* y)
f = foo (\x -&gt; x # y)
f = foo (\x -&gt; \y -&gt; x x y y) -- \x y -&gt; x x y y
f = foo (\x -&gt; \x -&gt; foo x x) -- \_ x -&gt; foo x x
f = foo (\(x:xs) -&gt; \x -&gt; foo x x) -- \(_:xs) x -&gt; foo x x
f = foo (\x -&gt; \y -&gt; \z -&gt; x x y y z z) -- \x y z -&gt; x x y y z z
x ! y = fromJust $ lookup x y
f = foo (\i -&gt; writeIdea (getClass i) i)
f = bar (flip Foo.bar x) -- (`Foo.bar` x)
f = a b (\x -&gt; c x d)  -- (`c` d)
yes = \x -&gt; a x where -- a
yes = \x y -&gt; op y x where -- flip op
f = \y -&gt; nub $ reverse y where -- nub . reverse
f = \z -&gt; foo $ bar $ baz z where -- foo . bar . baz
f = \z -&gt; foo $ bar x $ baz z where -- foo . bar x . baz
f = \z -&gt; foo $ z $ baz z where
f = \x -&gt; bar map (filter x) where -- bar map . filter
f = bar &amp;+&amp; \x -&gt; f (g x)
foo = [\column -&gt; set column [treeViewColumnTitle := printf &quot;%s (match %d)&quot; name (length candidnates)]]
foo = [\x -&gt; x]
foo = [\m x -&gt; insert x x m]
foo a b c = bar (flux ++ quux) c where flux = a -- foo a b = bar (flux ++ quux)
foo a b c = bar (flux ++ quux) c where flux = c
yes = foo (\x -&gt; Just x) -- @Error Just
foo = bar (\x -&gt; (x `f`)) -- f
baz = bar (\x -&gt; (x +)) -- (+)
&lt;/TEST&gt;
-}</span></span><span class="mpre">


module Hint.Lambda(lambdaHint) where

import Hint.Util
import Hint.Type
import Util
import Data.Maybe


</span><a href="#loc_78_1_78_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_11&#39;)"><span class="mpre">lambdaHint</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DeclHint</span></span><span class="mpre">
</span><a name="loc_78_1_78_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_11&#39;)"><span class="hl_fundecl"><span class="mpre">lambdaHint</span></span></a><span class="mpre"> _ _ </span><a name="loc_78_16_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> </span><a href="#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">lambdaExp</span></span></a><span class="mpre">) (</span><a href="Util.html#loc_294_1_294_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Util.html#loc_294_1_294_17&#39;)"><span class="hl_varref"><span class="mpre">universeParentBi</span></span></a><span class="mpre"> </span><a href="#loc_78_16_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="hl_varref"><span class="mpre">lambdaDecl</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">universe</span></span><span class="mpre"> </span><a href="#loc_78_16_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><a href="#loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="mpre">lambdaDecl</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Decl_</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Idea</span></span><span class="mpre">]
</span><a name="loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="hl_fundecl"><span class="mpre">lambdaDecl</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 13, srcSpanEndLine = 82, srcSpanEndColumn = 87}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 23, srcSpanEndLine = 82, srcSpanEndColumn = 25}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, "><span class="mpre">toFunBind -&gt; o@(FunBind loc [Match _ name pats (UnGuardedRhs _ bod) bind])</span></span><span class="mpre">)
    | </span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="hl_varref"><span class="mpre">isNothing</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bind</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">isLambda</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromParen</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bod</span></span><span class="mpre"> = [</span><span class="hl_varref"><span class="mpre">err</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Redundant lambda&quot;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">o</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> </span><a href="#loc_86_15_86_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_21&#39;)"><span class="hl_varref"><span class="mpre">reform</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_111_1_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_11&#39;)"><span class="hl_varref"><span class="mpre">fromLambda</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Lambda</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pats</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bod</span></span><span class="mpre">]
    | (</span><span class="hl_vardecl"><span class="mpre">pats2</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">bod2</span></span><span class="mpre">) &lt;- </span><a href="#loc_91_1_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_10&#39;)"><span class="hl_varref"><span class="mpre">etaReduce</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pats</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bod</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pats2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pats</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">pvars</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pats2</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">pats</span></span><span class="mpre">) </span><a href="Util.html#loc_110_1_110_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Util.html#loc_110_1_110_9&#39;)"><span class="hl_infix"><span class="mpre">`disjoint`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">varss</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bind</span></span><span class="mpre">
        = [</span><span class="hl_varref"><span class="mpre">err</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Eta reduce&quot;</span></span><span class="mpre"> (</span><a href="#loc_86_15_86_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_21&#39;)"><span class="hl_varref"><span class="mpre">reform</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pats</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bod</span></span><span class="mpre">) (</span><a href="#loc_86_15_86_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_21&#39;)"><span class="hl_varref"><span class="mpre">reform</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pats2</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bod2</span></span><span class="mpre">)]
        where </span><a name="loc_86_15_86_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_21&#39;)"><span class="hl_fundecl"><span class="mpre">reform</span></span></a><span class="mpre"> </span><a name="loc_86_22_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_22_86_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_86_24_86_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_24_86_25&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">FunBind</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">loc</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">name</span></span><span class="mpre"> </span><a href="#loc_86_22_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_22_86_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">UnGuardedRhs</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> </span><a href="#loc_86_24_86_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_24_86_25&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">]
</span><a href="#loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="hl_fundecl"><span class="mpre">lambdaDecl</span></span></a><span class="mpre"> _ = []


</span><a href="#loc_91_1_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_10&#39;)"><span class="mpre">etaReduce</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Pat_</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">Pat_</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre">)
</span><a name="loc_91_1_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_10&#39;)"><span class="hl_fundecl"><span class="mpre">etaReduce</span></span></a><span class="mpre"> </span><a name="loc_91_11_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_13&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">App</span></span><span class="mpre"> _ </span><a name="loc_91_21_91_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_21_91_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Var</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">UnQual</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">Ident</span></span><span class="mpre"> _ </span><a name="loc_91_49_91_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_49_91_50&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">))))
    | </span><a href="#loc_91_11_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> [], </span><span class="hl_conref"><span class="mpre">PVar</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">Ident</span></span><span class="mpre"> _ </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_91_11_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_91_49_91_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_49_91_50&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mr&quot;</span></span><span class="mpre">, </span><a href="#loc_91_49_91_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_49_91_50&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`notElem`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">vars</span></span><span class="mpre"> </span><a href="#loc_91_21_91_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_21_91_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    = </span><a href="#loc_91_1_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_10&#39;)"><span class="hl_varref"><span class="mpre">etaReduce</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><a href="#loc_91_11_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">) </span><a href="#loc_91_21_91_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_21_91_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_91_1_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_10&#39;)"><span class="hl_fundecl"><span class="mpre">etaReduce</span></span></a><span class="mpre"> </span><a name="loc_94_11_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_13&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a name="loc_94_14_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_14_94_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_94_11_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">,</span><a href="#loc_94_14_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_14_94_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><a href="#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="mpre">lambdaExp</span></a><span class="mpre"> :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Idea</span></span><span class="mpre">]
</span><a name="loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="hl_fundecl"><span class="mpre">lambdaExp</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> </span><a name="loc_98_13_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_13_98_14&#39;)"><span class="hl_specname"><span class="mpre">o</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">Paren</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">App</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">Var</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">UnQual</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">Symbol</span></span><span class="mpre"> _ </span><a name="loc_98_58_98_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_58_98_59&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">))) </span><a name="loc_98_63_98_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_63_98_64&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">)) | </span><span class="hl_varref"><span class="mpre">isAtom</span></span><span class="mpre"> </span><a href="#loc_98_63_98_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_63_98_64&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">allowLeftSection</span></span><span class="mpre"> </span><a href="#loc_98_58_98_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_58_98_59&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> =
    [</span><span class="hl_varref"><span class="mpre">warn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Use section&quot;</span></span><span class="mpre"> </span><a href="#loc_98_13_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_13_98_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">LeftSection</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> </span><a href="#loc_98_63_98_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_63_98_64&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toNamed</span></span><span class="mpre"> </span><a href="#loc_98_58_98_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_58_98_59&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)]
</span><a href="#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="hl_fundecl"><span class="mpre">lambdaExp</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> </span><a name="loc_100_13_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_14&#39;)"><span class="hl_specname"><span class="mpre">o</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">Paren</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">App</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">App</span></span><span class="mpre"> _ (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 39, srcSpanEndLine = 100, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 44, srcSpanEndLine = 100, srcSpanEndColumn = 46}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.h"><span class="mpre">view -&gt; Var_ &quot;flip&quot;</span></span><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Var</span></span><span class="mpre"> _ </span><a name="loc_100_67_100_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_67_100_68&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)) </span><a name="loc_100_71_100_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_71_100_72&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">)) | </span><span class="hl_varref"><span class="mpre">allowRightSection</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromNamed</span></span><span class="mpre"> </span><a href="#loc_100_67_100_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_67_100_68&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> =
    [</span><span class="hl_varref"><span class="mpre">warn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Use section&quot;</span></span><span class="mpre"> </span><a href="#loc_100_13_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RightSection</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">QVarOp</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> </span><a href="#loc_100_67_100_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_67_100_68&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_100_71_100_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_71_100_72&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">]
</span><a href="#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="hl_fundecl"><span class="mpre">lambdaExp</span></span></a><span class="mpre"> </span><a name="loc_102_11_102_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_102_13_102_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_13_102_14&#39;)"><span class="hl_specname"><span class="mpre">o</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 15, srcSpanEndLine = 102, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 21, srcSpanEndLine = 102, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 102, srcSpanStart"><span class="mpre">Lambda{}</span></span><span class="mpre"> | </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isInfixApp</span></span><span class="mpre">) </span><a href="#loc_102_11_102_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">res</span></span><span class="mpre"> &lt;- </span><a href="Hint.Util.html#loc_14_1_14_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Hint.Util.html#loc_14_1_14_11&#39;)"><span class="hl_varref"><span class="mpre">niceLambda</span></span></a><span class="mpre"> [] </span><a href="#loc_102_13_102_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_13_102_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isLambda</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">res</span></span><span class="mpre"> =
    [(if </span><span class="hl_varref"><span class="mpre">isVar</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">res</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isCon</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">res</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">err</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">warn</span></span><span class="mpre">) </span><span class="hl_string"><span class="mpre">&quot;Avoid lambda&quot;</span></span><span class="mpre"> </span><a href="#loc_102_13_102_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_13_102_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">res</span></span><span class="mpre">]
</span><a href="#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="hl_fundecl"><span class="mpre">lambdaExp</span></span></a><span class="mpre"> </span><a name="loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_104_13_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_14&#39;)"><span class="hl_specname"><span class="mpre">o</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">Lambda</span></span><span class="mpre"> _ _ </span><a name="loc_104_27_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_27_104_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">isLambda</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromParen</span></span><span class="mpre"> </span><a href="#loc_104_27_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_27_104_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isLambda</span></span><span class="mpre">) </span><a href="#loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> =
    [</span><span class="hl_varref"><span class="mpre">warn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Collapse lambdas&quot;</span></span><span class="mpre"> </span><a href="#loc_104_13_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Lambda</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_111_1_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_11&#39;)"><span class="hl_varref"><span class="mpre">fromLambda</span></span></a><span class="mpre"> </span><a href="#loc_104_13_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">]
</span><a href="#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="hl_fundecl"><span class="mpre">lambdaExp</span></span></a><span class="mpre"> _ _ = []


</span><span class="hl_comment"><span class="mpre">-- replace any repeated pattern variable with _</span></span><span class="mpre">
</span><a href="#loc_111_1_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_11&#39;)"><span class="mpre">fromLambda</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">Pat_</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre">)
</span><a name="loc_111_1_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_11&#39;)"><span class="hl_fundecl"><span class="mpre">fromLambda</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Lambda</span></span><span class="mpre"> _ </span><a name="loc_111_22_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_25&#39;)"><span class="hl_vardecl"><span class="mpre">ps1</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 27, srcSpanEndLine = 111, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 50, srcSpanEndLine = 111, srcSpanEndColumn = 52}]}) (InfixApp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lam"><span class="mpre">fromLambda . fromParen -&gt; (ps2,x)</span></span><span class="mpre">)) = (</span><span class="hl_varref"><span class="mpre">transformBi</span></span><span class="mpre"> (</span><a href="#loc_112_11_112_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_11_112_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pvars</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ps2</span></span><span class="mpre">) </span><a href="#loc_111_22_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_25&#39;)"><span class="hl_varref"><span class="mpre">ps1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ps2</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre">)
    where </span><a name="loc_112_11_112_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_11_112_12&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_112_13_112_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_13_112_16&#39;)"><span class="hl_vardecl"><span class="mpre">bad</span></span></a><span class="mpre"> </span><a name="loc_112_17_112_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_17_112_18&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 112, srcSpanStartColumn = 19, srcSpanEndLine = 112, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 112, srcSpanStartColumn = 23, srcSpanEndLine = 112, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Lambda.hs&quot;, srcSpanStartLine = 112, srcSpanStart"><span class="mpre">PVar{}</span></span><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">prettyPrint</span></span><span class="mpre"> </span><a href="#loc_112_17_112_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_17_112_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_112_13_112_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_13_112_16&#39;)"><span class="hl_varref"><span class="mpre">bad</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">PWildCard</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre">
          </span><a href="#loc_112_11_112_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_11_112_12&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">bad</span></span><span class="mpre"> </span><a name="loc_113_17_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_113_17_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_111_1_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_11&#39;)"><span class="hl_fundecl"><span class="mpre">fromLambda</span></span></a><span class="mpre"> </span><a name="loc_114_12_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = ([], </span><a href="#loc_114_12_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span></div></body></html>