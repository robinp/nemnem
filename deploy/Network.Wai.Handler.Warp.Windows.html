<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
module Network.Wai.Handler.Warp.Windows
  ( windowsThreadBlockHack
  ) where

#if WINDOWS
import Control.Exception
import Control.Concurrent.MVar
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Windows.hs&quot;, srcSpanStartLine = 9, srcSpanStartColumn = 8, srcSpanEndLine = 9, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre">
import Control.Monad

</span><a href="#loc_13_1_13_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_23&#39;)"><span class="mpre">windowsThreadBlockHack</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_13_1_13_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_23&#39;)"><span class="hl_fundecl"><span class="mpre">windowsThreadBlockHack</span></span></a><span class="mpre"> </span><a name="loc_13_24_13_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_24_13_27&#39;)"><span class="hl_vardecl"><span class="mpre">act</span></span></a><span class="mpre"> = 
  do
    </span><a name="loc_15_5_15_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_5_15_8&#39;)"><span class="hl_vardecl"><span class="mpre">var</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SomeException</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
    </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Exception.Base.html#loc_212_1_212_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_212_1_212_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><a href="#loc_13_24_13_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_24_13_27&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_15_5_15_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_5_15_8&#39;)"><span class="hl_varref"><span class="mpre">var</span></span></a><span class="mpre">
    </span><a name="loc_17_5_17_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_5_17_8&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_15_5_15_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_5_15_8&#39;)"><span class="hl_varref"><span class="mpre">var</span></span></a><span class="mpre">
    case </span><a href="#loc_17_5_17_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_5_17_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  </span><a name="loc_19_13_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_13_19_14&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="#loc_19_13_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_13_19_14&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_20_13_20_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_13_20_14&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_20_13_20_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_13_20_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
#else
</span><a href="#loc_13_1_13_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_23&#39;)"><span class="mpre">windowsThreadBlockHack</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">windowsThreadBlockHack</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
#endif
</span></div></body></html>