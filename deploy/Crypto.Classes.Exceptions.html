<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |The module mirrors &#39;Crypto.Classes&#39; except that errors are thrown as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- exceptions instead of having returning types of @Either error result@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or @Maybe result@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- NB This module is experimental and might go away or be re-arranged.</span></span><span class="mpre">
{-# LANGUAGE DeriveDataTypeable #-}
module Crypto.Classes.Exceptions 
    ( C.Hash(..)
    , C.hashFunc&#39;, C.hashFunc
    , C.BlockCipher, C.blockSize, C.encryptBlock, C.decryptBlock
    , C.keyLength
    , C.getIVIO, C.blockSizeBytes, C.keyLengthBytes, C.buildKeyIO
    , C.AsymCipher, C.publicKeyLength, C.privateKeyLength, C.buildKeyPairIO
    , C.Signing, C.signingKeyLength, C.verifyingKeyLength, C.verify
    , C.incIV, C.zeroIV, R.CryptoRandomGen, R.genSeedLength, R.reseedInfo, R.reseedPeriod, R.newGenIO
    </span><span class="hl_comment"><span class="mpre">--  Types</span></span><span class="mpre">
    , R.GenError(..), R.ReseedInfo(..), CipherError(..)
    </span><span class="hl_comment"><span class="mpre">-- Modes</span></span><span class="mpre">
    , C.ecb, C.unEcb, C.cbc, C.unCbc, C.ctr, C.unCtr, C.ctrLazy, C.unCtrLazy
    , C.cfb, C.unCfb, C.ofb, C.unOfb, C.cbcLazy, C.unCbcLazy, C.sivLazy, C.unSivLazy
    , C.siv, C.unSiv, C.ecbLazy, C.unEcbLazy, C.cfbLazy, C.unCfbLazy, C.ofbLazy
    , C.unOfbLazy
    </span><span class="hl_comment"><span class="mpre">-- Wrapped functions</span></span><span class="mpre">
    , buildKey, getIV, buildKeyGen
    , buildKeyPair, encryptAsym, decryptAsym
    , newGen, genBytes, genBytesWithEntropy, reseed, splitGen
    ) where

import qualified Crypto.Random     as R
import           Crypto.Random     (</span><a href="Crypto.Random.html#loc_96_7_96_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_96_7_96_22&#39;)"><span class="mpre">CryptoRandomGen</span></a><span class="mpre">)
import           Crypto.Types
import qualified Crypto.Classes    as C
import qualified Control.Exception as X
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 18, srcSpanEndLine = 34, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">   as B
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 18, srcSpanEndLine = 35, srcSpanEndColumn = 27}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
import           Data.Typeable

data </span><a name="loc_38_6_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_17&#39;)"><span class="hl_tycondecl"><span class="mpre">CipherError</span></span></a><span class="mpre"> = </span><a name="loc_38_20_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_20_38_28&#39;)"><span class="hl_condecl"><span class="mpre">GenError</span></span></a><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">R.GenError</span></span></a><span class="mpre">
                 | </span><a name="loc_39_20_39_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_20_39_33&#39;)"><span class="hl_condecl"><span class="mpre">KeyGenFailure</span></span></a><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 9, srcSpanEndLine = 40, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 9, srcSpanEndLine = 40, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Except"><span class="mpre">deriving (Show, Read, Eq, Ord, Data, Typeable)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">X.Exception</span></span><span class="mpre"> </span><a href="#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">CipherError</span></span></a><span class="mpre">

</span><a href="#loc_45_1_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_8&#39;)"><span class="mpre">mExcept</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 12, srcSpanEndLine = 44, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 12, srcSpanEndLine = 44, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Excep"><span class="mpre">(X.Exception e) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_45_1_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_8&#39;)"><span class="hl_fundecl"><span class="mpre">mExcept</span></span></a><span class="mpre"> </span><a name="loc_45_9_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_10&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">X.throw</span></span><span class="mpre"> </span><a href="#loc_45_9_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_10&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

</span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="mpre">eExcept</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 12, srcSpanEndLine = 47, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 12, srcSpanEndLine = 47, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Excep"><span class="mpre">(X.Exception e) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_vardecl"><span class="mpre">eExcept</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">X.throw</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Key construction from raw material (typically including key expansion)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper that can throw a &#39;CipherError&#39; on exception.</span></span><span class="mpre">
</span><a href="#loc_54_1_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_9&#39;)"><span class="mpre">buildKey</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 13, srcSpanEndLine = 53, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 29, srcSpanEndLine = 53, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">C.BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_54_1_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_9&#39;)"><span class="hl_vardecl"><span class="mpre">buildKey</span></span></a><span class="mpre"> = </span><a href="#loc_45_1_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_8&#39;)"><span class="hl_varref"><span class="mpre">mExcept</span></span></a><span class="mpre"> </span><a href="#loc_39_20_39_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_20_39_33&#39;)"><span class="hl_conref"><span class="mpre">KeyGenFailure</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_155_3_155_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_155_3_155_11&#39;)"><span class="hl_varref"><span class="mpre">C.buildKey</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Random &#39;IV&#39; generation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper that can throw a &#39;GenError&#39; on exception.</span></span><span class="mpre">
</span><a href="#loc_60_1_60_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_6&#39;)"><span class="mpre">getIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 10, srcSpanEndLine = 59, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 10, srcSpanEndLine = 59, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Excep"><span class="mpre">(C.BlockCipher k, CryptoRandomGen g) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_60_1_60_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_6&#39;)"><span class="hl_vardecl"><span class="mpre">getIV</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_311_1_311_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_311_1_311_6&#39;)"><span class="hl_varref"><span class="mpre">C.getIV</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Symmetric key generation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper that can throw a &#39;GenError&#39; on exception.</span></span><span class="mpre">
</span><a href="#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="mpre">buildKeyGen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 16, srcSpanEndLine = 65, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 16, srcSpanEndLine = 65, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Excep"><span class="mpre">(CryptoRandomGen g, C.BlockCipher k) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="hl_vardecl"><span class="mpre">buildKeyGen</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_468_1_468_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_468_1_468_12&#39;)"><span class="hl_varref"><span class="mpre">C.buildKeyGen</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Asymetric key generation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper that can throw a &#39;GenError&#39; on exception.</span></span><span class="mpre">
</span><a href="#loc_72_1_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_13&#39;)"><span class="mpre">buildKeyPair</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 17, srcSpanEndLine = 71, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 17, srcSpanEndLine = 71, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Excep"><span class="mpre">(CryptoRandomGen g, C.AsymCipher p v) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre"> -&gt; ((</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">), </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_72_1_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_13&#39;)"><span class="hl_fundecl"><span class="mpre">buildKeyPair</span></span></a><span class="mpre"> </span><a name="loc_72_14_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_486_3_486_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_486_3_486_15&#39;)"><span class="hl_varref"><span class="mpre">C.buildKeyPair</span></span></a><span class="mpre"> </span><a href="#loc_72_14_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Asymmetric encryption</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper that can throw a &#39;GenError&#39; on exception.</span></span><span class="mpre">
</span><a href="#loc_78_1_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_12&#39;)"><span class="mpre">encryptAsym</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 77, srcSpanStartColumn = 16, srcSpanEndLine = 77, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 77, srcSpanStartColumn = 16, srcSpanEndLine = 77, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Excep"><span class="mpre">(CryptoRandomGen g, C.AsymCipher p v) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_78_1_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_12&#39;)"><span class="hl_fundecl"><span class="mpre">encryptAsym</span></span></a><span class="mpre"> </span><a name="loc_78_13_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_13_78_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_78_15_78_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_15_78_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_487_3_487_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_487_3_487_14&#39;)"><span class="hl_varref"><span class="mpre">C.encryptAsym</span></span></a><span class="mpre"> </span><a href="#loc_78_13_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_13_78_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_78_15_78_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_15_78_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Asymmetric decryption</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper that can throw a GenError on exception.</span></span><span class="mpre">
</span><a href="#loc_84_1_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_12&#39;)"><span class="mpre">decryptAsym</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 16, srcSpanEndLine = 83, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 16, srcSpanEndLine = 83, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Excep"><span class="mpre">(CryptoRandomGen g, C.AsymCipher p v) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_84_1_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_12&#39;)"><span class="hl_fundecl"><span class="mpre">decryptAsym</span></span></a><span class="mpre"> </span><a name="loc_84_13_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_84_15_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_15_84_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_488_3_488_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_488_3_488_14&#39;)"><span class="hl_varref"><span class="mpre">C.decryptAsym</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_84_15_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_15_84_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Instantiate a new random bit generator.  The provided</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bytestring should be of length &gt;= genSeedLength.  If the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bytestring is shorter then the call may fail (suggested</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- error: `NotEnoughEntropy`).  If the bytestring is of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sufficent length the call should always succeed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper that can throw &#39;GenError&#39; types as exceptions.</span></span><span class="mpre">
</span><a href="#loc_94_1_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_7&#39;)"><span class="mpre">newGen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 11, srcSpanEndLine = 93, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 29, srcSpanEndLine = 93, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">CryptoRandomGen g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">
</span><a name="loc_94_1_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_7&#39;)"><span class="hl_vardecl"><span class="mpre">newGen</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_102_9_102_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_102_9_102_15&#39;)"><span class="hl_varref"><span class="mpre">R.newGen</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @genBytes len g@ generates a random ByteString of length</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @len@ and new generator.  The &#39;MonadCryptoRandom&#39; package</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- has routines useful for converting the ByteString to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- commonly needed values (but &#39;cereal&#39; or other</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- deserialization libraries would also work).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper that can throw &#39;GenError&#39; types as exceptions.</span></span><span class="mpre">
</span><a href="#loc_104_1_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_9&#39;)"><span class="mpre">genBytes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 13, srcSpanEndLine = 103, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 31, srcSpanEndLine = 103, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">CryptoRandomGen g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_104_1_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_9&#39;)"><span class="hl_fundecl"><span class="mpre">genBytes</span></span></a><span class="mpre"> </span><a name="loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">R.genBytes</span></span></a><span class="mpre"> </span><a href="#loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |@genBytesWithEntropy g i entropy@ generates @i@ random bytes and use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the additional input @entropy@ in the generation of the requested data</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to increase the confidence our generated data is a secure random stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper that can throw &#39;GenError&#39; types as exceptions.</span></span><span class="mpre">
</span><a href="#loc_112_1_112_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_20&#39;)"><span class="mpre">genBytesWithEntropy</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 24, srcSpanEndLine = 111, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 42, srcSpanEndLine = 111, srcSpanEndColumn = 44}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">CryptoRandomGen g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_112_1_112_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_20&#39;)"><span class="hl_fundecl"><span class="mpre">genBytesWithEntropy</span></span></a><span class="mpre"> </span><a name="loc_112_21_112_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_21_112_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_112_23_112_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_23_112_24&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_146_9_146_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_146_9_146_28&#39;)"><span class="hl_varref"><span class="mpre">R.genBytesWithEntropy</span></span></a><span class="mpre"> </span><a href="#loc_112_21_112_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_21_112_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_112_23_112_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_23_112_24&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |If the generator has produced too many random bytes on its existing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- seed it will throw a `NeedReseed` exception.  In that case, reseed the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- generator using this function and a new high-entropy seed of length &gt;=</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- `genSeedLength`.  Using bytestrings that are too short can result in an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- exception (`NotEnoughEntropy`).</span></span><span class="mpre">
</span><a href="#loc_120_1_120_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_7&#39;)"><span class="mpre">reseed</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 119, srcSpanStartColumn = 11, srcSpanEndLine = 119, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 119, srcSpanStartColumn = 29, srcSpanEndLine = 119, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">CryptoRandomGen g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">
</span><a name="loc_120_1_120_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_7&#39;)"><span class="hl_fundecl"><span class="mpre">reseed</span></span></a><span class="mpre"> </span><a name="loc_120_8_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_8_120_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_161_9_161_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_161_9_161_15&#39;)"><span class="hl_varref"><span class="mpre">R.reseed</span></span></a><span class="mpre"> </span><a href="#loc_120_8_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_8_120_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | While the safety and wisdom of a splitting function depends on the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- properties of the generator being split, several arguments from</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- informed people indicate such a function is safe for NIST SP 800-90</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- generators.  (see libraries\@haskell.org discussion around Sept, Oct</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 2010).  You can find implementations of such generators in the &#39;DRBG&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- package.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper for &#39;Crypto.Random.splitGen&#39; which throws errors as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- exceptions.</span></span><span class="mpre">
</span><a href="#loc_132_1_132_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_9&#39;)"><span class="mpre">splitGen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 131, srcSpanStartColumn = 13, srcSpanEndLine = 131, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes/Exceptions.hs&quot;, srcSpanStartLine = 131, srcSpanStartColumn = 31, srcSpanEndLine = 131, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">CryptoRandomGen g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_132_1_132_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_9&#39;)"><span class="hl_vardecl"><span class="mpre">splitGen</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">eExcept</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_228_1_228_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_228_1_228_9&#39;)"><span class="hl_varref"><span class="mpre">R.splitGen</span></span></a><span class="mpre">
</span></div></body></html>