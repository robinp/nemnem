<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns      #-}
{-# LANGUAGE OverloadedStrings #-}

module System.IO.Streams.Internal.Search
  ( search
  , MatchInfo(..)
  ) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           Control.Monad               (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import           Control.Monad.IO.Class      (</span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="mpre">liftIO</span></a><span class="mpre">)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Internal/Search.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">       (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Internal/Search.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">       as S
import qualified Data.ByteString.Unsafe      as S
import qualified Data.Vector.Unboxed         as V
import qualified Data.Vector.Unboxed.Mutable as MV
import           Prelude                     (Bool (..), Either (..), Enum (..), Eq (..), IO, Int, Monad (..), Num (..), Ord (..), Show, either, id, </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="mpre">maybe</span></a><span class="mpre">, not, otherwise, ($), </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="mpre">($!)</span></a><span class="mpre">, (&amp;&amp;), (.), (||))
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           System.IO.Streams.Internal  (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="mpre">InputStream</span></a><span class="mpre">)
import qualified System.IO.Streams.Internal  as Streams


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | &#39;MatchInfo&#39; provides match information when performing string search.</span></span><span class="mpre">
data </span><a name="loc_25_6_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_15&#39;)"><span class="hl_tycondecl"><span class="mpre">MatchInfo</span></span></a><span class="mpre"> = </span><a name="loc_25_18_25_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_18_25_23&#39;)"><span class="hl_condecl"><span class="mpre">Match</span></span></a><span class="mpre">   {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
               | </span><a name="loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_condecl"><span class="mpre">NoMatch</span></span></a><span class="mpre"> {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Internal/Search.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 3, srcSpanEndLine = 27, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Internal/Search.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 3, srcSpanEndLine = 27, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-stre"><span class="mpre">deriving (Show, Eq)</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Does the given needle match the haystack over the given ranges of indices?</span></span><span class="mpre">
</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="mpre">matches</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ needle</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^ needle start</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^ needle end (inclusive)</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ haystack</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^ haystack start</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^ haystack end (inclusive)</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">matches</span></span></a><span class="mpre"> !</span><a name="loc_39_10_39_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_10_39_16&#39;)"><span class="hl_vardecl"><span class="mpre">needle</span></span></a><span class="mpre"> !</span><a name="loc_39_18_39_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_24&#39;)"><span class="hl_vardecl"><span class="mpre">nstart</span></span></a><span class="mpre"> !</span><a name="loc_39_26_39_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_26_39_31&#39;)"><span class="hl_vardecl"><span class="mpre">nend&#39;</span></span></a><span class="mpre"> !</span><a name="loc_39_33_39_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_33_39_41&#39;)"><span class="hl_vardecl"><span class="mpre">haystack</span></span></a><span class="mpre"> !</span><a name="loc_39_43_39_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_43_39_49&#39;)"><span class="hl_vardecl"><span class="mpre">hstart</span></span></a><span class="mpre"> !</span><a name="loc_39_51_39_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_51_39_56&#39;)"><span class="hl_vardecl"><span class="mpre">hend&#39;</span></span></a><span class="mpre"> =
    </span><a href="#loc_42_5_42_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_39_26_39_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_26_39_31&#39;)"><span class="hl_varref"><span class="mpre">nend&#39;</span></span></a><span class="mpre"> </span><a href="#loc_39_51_39_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_51_39_56&#39;)"><span class="hl_varref"><span class="mpre">hend&#39;</span></span></a><span class="mpre">
  where
    </span><a name="loc_42_5_42_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_42_9_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_13&#39;)"><span class="hl_vardecl"><span class="mpre">nend</span></span></a><span class="mpre"> !</span><a name="loc_42_15_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_15_42_19&#39;)"><span class="hl_vardecl"><span class="mpre">hend</span></span></a><span class="mpre"> =
        if </span><a href="#loc_42_9_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_13&#39;)"><span class="hl_varref"><span class="mpre">nend</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_39_18_39_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_24&#39;)"><span class="hl_varref"><span class="mpre">nstart</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_42_15_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_15_42_19&#39;)"><span class="hl_varref"><span class="mpre">hend</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_39_43_39_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_43_39_49&#39;)"><span class="hl_varref"><span class="mpre">hstart</span></span></a><span class="mpre">
          then </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
          else let !</span><a name="loc_45_21_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_21_45_23&#39;)"><span class="hl_vardecl"><span class="mpre">nc</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_39_10_39_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_10_39_16&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre"> </span><a href="#loc_42_9_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_13&#39;)"><span class="hl_varref"><span class="mpre">nend</span></span></a><span class="mpre">
                   !</span><a name="loc_46_21_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_21_46_23&#39;)"><span class="hl_vardecl"><span class="mpre">hc</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_39_33_39_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_33_39_41&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre"> </span><a href="#loc_42_15_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_15_42_19&#39;)"><span class="hl_varref"><span class="mpre">hend</span></span></a><span class="mpre">
               in if </span><a href="#loc_45_21_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_21_45_23&#39;)"><span class="hl_varref"><span class="mpre">nc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_46_21_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_21_46_23&#39;)"><span class="hl_varref"><span class="mpre">hc</span></span></a><span class="mpre">
                    then </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                    else </span><a href="#loc_42_5_42_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_42_9_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_13&#39;)"><span class="hl_varref"><span class="mpre">nend</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_42_15_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_15_42_19&#39;)"><span class="hl_varref"><span class="mpre">hend</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="mpre">matches</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Given a &#39;ByteString&#39; to look for (the \&quot;needle\&quot;) and an &#39;InputStream&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- produces a new &#39;InputStream&#39; which yields data of type &#39;MatchInfo&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; &#39;System.IO.Streams.fromList&#39; [\&quot;food\&quot;, \&quot;oof\&quot;, \&quot;oodles\&quot;, \&quot;ok\&quot;] &gt;&gt;=</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       &#39;search&#39; \&quot;foo\&quot; &gt;&gt;= &#39;System.IO.Streams.toList&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [&#39;Match&#39; \&quot;foo\&quot;,&#39;NoMatch&#39; \&quot;d\&quot;,&#39;NoMatch&#39; \&quot;oo\&quot;,&#39;Match&#39; \&quot;foo\&quot;,&#39;NoMatch&#39; \&quot;dlesok\&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Uses the Boyer-Moore-Horspool algorithm</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&lt;http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore%E2%80%93Horspool_algorithm&gt;).</span></span><span class="mpre">
</span><a href="#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_7&#39;)"><span class="mpre">search</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^ \&quot;needle\&quot; to look for</span></span><span class="mpre">
       -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ input stream to wrap</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><a href="#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">MatchInfo</span></span></a><span class="mpre">)
</span><a name="loc_70_1_70_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_7&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> </span><a name="loc_70_8_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_8_70_14&#39;)"><span class="hl_vardecl"><span class="mpre">needle</span></span></a><span class="mpre"> </span><a name="loc_70_15_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_15_70_21&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_599_1_599_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_599_1_599_14&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromGenerator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                       </span><a href="#loc_187_5_187_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_14&#39;)"><span class="hl_varref"><span class="mpre">lookahead</span></span></a><span class="mpre"> </span><a href="#loc_169_6_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_10&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><a href="#loc_75_5_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_17&#39;)"><span class="hl_varref"><span class="mpre">finishAndEOF</span></span></a><span class="mpre"> </span><a href="#loc_80_5_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_16&#39;)"><span class="hl_varref"><span class="mpre">startSearch</span></span></a><span class="mpre">

  where
    </span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------</span></span><span class="mpre">
    </span><a name="loc_75_5_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_17&#39;)"><span class="hl_fundecl"><span class="mpre">finishAndEOF</span></span></a><span class="mpre"> </span><a name="loc_75_18_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_18_75_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_75_18_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_18_75_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                       then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                       else </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.yield</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">NoMatch</span></span></a><span class="mpre"> </span><a href="#loc_75_18_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_18_75_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------</span></span><span class="mpre">
    </span><a name="loc_80_5_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_16&#39;)"><span class="hl_fundecl"><span class="mpre">startSearch</span></span></a><span class="mpre"> !</span><a name="loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_vardecl"><span class="mpre">haystack</span></span></a><span class="mpre"> =
        if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre">
          then </span><a href="#loc_187_5_187_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_14&#39;)"><span class="hl_varref"><span class="mpre">lookahead</span></span></a><span class="mpre"> </span><a href="#loc_169_6_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_10&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><a href="#loc_75_5_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_17&#39;)"><span class="hl_varref"><span class="mpre">finishAndEOF</span></span></a><span class="mpre"> </span><a href="#loc_80_5_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_16&#39;)"><span class="hl_varref"><span class="mpre">startSearch</span></span></a><span class="mpre">
          else </span><a href="#loc_90_9_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

      where
        </span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
        !</span><a name="loc_87_10_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_14&#39;)"><span class="hl_vardecl"><span class="mpre">hlen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
        </span><a name="loc_90_9_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_90_13_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_17&#39;)"><span class="hl_vardecl"><span class="mpre">hidx</span></span></a><span class="mpre">
          | </span><a href="#loc_107_14_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_14_107_18&#39;)"><span class="hl_varref"><span class="mpre">hend</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_87_10_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_14&#39;)"><span class="hl_varref"><span class="mpre">hlen</span></span></a><span class="mpre"> = </span><a href="#loc_115_9_115_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_19&#39;)"><span class="hl_varref"><span class="mpre">crossBound</span></span></a><span class="mpre"> </span><a href="#loc_90_13_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_17&#39;)"><span class="hl_varref"><span class="mpre">hidx</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
              let </span><a name="loc_93_19_93_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_19_93_24&#39;)"><span class="hl_vardecl"><span class="mpre">match</span></span></a><span class="mpre"> = </span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_varref"><span class="mpre">matches</span></span></a><span class="mpre"> </span><a href="#loc_70_8_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_8_70_14&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_170_6_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_13&#39;)"><span class="hl_varref"><span class="mpre">lastIdx</span></span></a><span class="mpre"> </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre"> </span><a href="#loc_90_13_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_17&#39;)"><span class="hl_varref"><span class="mpre">hidx</span></span></a><span class="mpre"> </span><a href="#loc_107_14_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_14_107_18&#39;)"><span class="hl_varref"><span class="mpre">hend</span></span></a><span class="mpre">
              if </span><a href="#loc_93_19_93_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_19_93_24&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre">
                then do
                  let !</span><a name="loc_96_24_96_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_24_96_31&#39;)"><span class="hl_vardecl"><span class="mpre">nomatch</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_90_13_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_17&#39;)"><span class="hl_varref"><span class="mpre">hidx</span></span></a><span class="mpre"> </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre">
                  let !</span><a name="loc_97_24_97_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_24_97_34&#39;)"><span class="hl_vardecl"><span class="mpre">aftermatch</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><a href="#loc_107_14_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_14_107_18&#39;)"><span class="hl_varref"><span class="mpre">hend</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre">

                  </span><a href="#loc_163_5_163_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_5_163_17&#39;)"><span class="hl_varref"><span class="mpre">produceMatch</span></span></a><span class="mpre"> </span><a href="#loc_96_24_96_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_24_96_31&#39;)"><span class="hl_varref"><span class="mpre">nomatch</span></span></a><span class="mpre"> </span><a href="#loc_97_24_97_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_24_97_34&#39;)"><span class="hl_varref"><span class="mpre">aftermatch</span></span></a><span class="mpre">
                else do
                  </span><span class="hl_comment"><span class="mpre">-- skip ahead</span></span><span class="mpre">
                  let </span><a name="loc_102_23_102_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_23_102_24&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre"> </span><a href="#loc_107_14_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_14_107_18&#39;)"><span class="hl_varref"><span class="mpre">hend</span></span></a><span class="mpre">
                  let !</span><a name="loc_103_24_103_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_24_103_28&#39;)"><span class="hl_vardecl"><span class="mpre">skip</span></span></a><span class="mpre"> = </span><a href="Data.Vector.Unboxed.html#loc_288_1_288_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_288_1_288_12&#39;)"><span class="hl_varref"><span class="mpre">V.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_173_6_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_6_173_11&#39;)"><span class="hl_varref"><span class="mpre">table</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_102_23_102_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_23_102_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                  </span><a href="#loc_90_9_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_90_13_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_17&#39;)"><span class="hl_varref"><span class="mpre">hidx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_103_24_103_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_24_103_28&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">)

          where
            !</span><a name="loc_107_14_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_14_107_18&#39;)"><span class="hl_vardecl"><span class="mpre">hend</span></span></a><span class="mpre"> = </span><a href="#loc_90_13_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_17&#39;)"><span class="hl_varref"><span class="mpre">hidx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_169_6_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_10&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
        </span><a name="loc_110_9_110_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_16&#39;)"><span class="hl_fundecl"><span class="mpre">mkCoeff</span></span></a><span class="mpre"> </span><a name="loc_110_17_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_17_110_21&#39;)"><span class="hl_vardecl"><span class="mpre">hidx</span></span></a><span class="mpre"> = let !</span><a name="loc_110_29_110_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_29_110_31&#39;)"><span class="hl_vardecl"><span class="mpre">ll</span></span></a><span class="mpre"> = </span><a href="#loc_87_10_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_14&#39;)"><span class="hl_varref"><span class="mpre">hlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_110_17_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_17_110_21&#39;)"><span class="hl_varref"><span class="mpre">hidx</span></span></a><span class="mpre">
                           !</span><a name="loc_111_29_111_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_29_111_31&#39;)"><span class="hl_vardecl"><span class="mpre">nm</span></span></a><span class="mpre"> = </span><a href="#loc_169_6_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_10&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_110_29_110_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_29_110_31&#39;)"><span class="hl_varref"><span class="mpre">ll</span></span></a><span class="mpre">
                       in (</span><a href="#loc_110_29_110_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_29_110_31&#39;)"><span class="hl_varref"><span class="mpre">ll</span></span></a><span class="mpre">, </span><a href="#loc_111_29_111_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_29_111_31&#39;)"><span class="hl_varref"><span class="mpre">nm</span></span></a><span class="mpre">)

        </span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
        </span><a name="loc_115_9_115_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_19&#39;)"><span class="hl_fundecl"><span class="mpre">crossBound</span></span></a><span class="mpre"> !</span><a name="loc_115_21_115_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_21_115_26&#39;)"><span class="hl_vardecl"><span class="mpre">hidx0</span></span></a><span class="mpre"> = do
            let (!</span><a name="loc_116_19_116_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_26&#39;)"><span class="hl_vardecl"><span class="mpre">leftLen</span></span></a><span class="mpre">, </span><a name="loc_116_28_116_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_28_116_36&#39;)"><span class="hl_vardecl"><span class="mpre">needMore</span></span></a><span class="mpre">) = </span><a href="#loc_110_9_110_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_16&#39;)"><span class="hl_varref"><span class="mpre">mkCoeff</span></span></a><span class="mpre"> </span><a href="#loc_115_21_115_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_21_115_26&#39;)"><span class="hl_varref"><span class="mpre">hidx0</span></span></a><span class="mpre">

            </span><a href="#loc_187_5_187_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_14&#39;)"><span class="hl_varref"><span class="mpre">lookahead</span></span></a><span class="mpre"> </span><a href="#loc_116_28_116_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_28_116_36&#39;)"><span class="hl_varref"><span class="mpre">needMore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
              </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (\</span><a name="loc_119_24_119_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_24_119_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_75_5_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_17&#39;)"><span class="hl_varref"><span class="mpre">finishAndEOF</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.append</span></span><span class="mpre"> </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre"> </span><a href="#loc_119_24_119_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_24_119_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                     (</span><a href="#loc_123_13_123_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_20&#39;)"><span class="hl_varref"><span class="mpre">runNext</span></span></a><span class="mpre"> </span><a href="#loc_115_21_115_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_21_115_26&#39;)"><span class="hl_varref"><span class="mpre">hidx0</span></span></a><span class="mpre"> </span><a href="#loc_116_19_116_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_26&#39;)"><span class="hl_varref"><span class="mpre">leftLen</span></span></a><span class="mpre"> </span><a href="#loc_116_28_116_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_28_116_36&#39;)"><span class="hl_varref"><span class="mpre">needMore</span></span></a><span class="mpre">)

          where
            </span><a name="loc_123_13_123_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_20&#39;)"><span class="hl_fundecl"><span class="mpre">runNext</span></span></a><span class="mpre"> !</span><a name="loc_123_22_123_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_22_123_26&#39;)"><span class="hl_vardecl"><span class="mpre">hidx</span></span></a><span class="mpre"> !</span><a name="loc_123_28_123_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_28_123_35&#39;)"><span class="hl_vardecl"><span class="mpre">leftLen</span></span></a><span class="mpre"> !</span><a name="loc_123_37_123_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_37_123_45&#39;)"><span class="hl_vardecl"><span class="mpre">needMore</span></span></a><span class="mpre"> !</span><a name="loc_123_47_123_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_59&#39;)"><span class="hl_vardecl"><span class="mpre">nextHaystack</span></span></a><span class="mpre"> = do
                let </span><a name="loc_124_21_124_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_21_124_27&#39;)"><span class="hl_vardecl"><span class="mpre">match1</span></span></a><span class="mpre"> = </span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_varref"><span class="mpre">matches</span></span></a><span class="mpre"> </span><a href="#loc_70_8_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_8_70_14&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre"> </span><a href="#loc_123_28_123_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_28_123_35&#39;)"><span class="hl_varref"><span class="mpre">leftLen</span></span></a><span class="mpre"> </span><a href="#loc_170_6_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_13&#39;)"><span class="hl_varref"><span class="mpre">lastIdx</span></span></a><span class="mpre"> </span><a href="#loc_123_47_123_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_59&#39;)"><span class="hl_varref"><span class="mpre">nextHaystack</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                                     (</span><a href="#loc_123_37_123_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_37_123_45&#39;)"><span class="hl_varref"><span class="mpre">needMore</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                let </span><a name="loc_126_21_126_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_21_126_27&#39;)"><span class="hl_vardecl"><span class="mpre">match2</span></span></a><span class="mpre"> = </span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_varref"><span class="mpre">matches</span></span></a><span class="mpre"> </span><a href="#loc_70_8_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_8_70_14&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="#loc_123_28_123_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_28_123_35&#39;)"><span class="hl_varref"><span class="mpre">leftLen</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre"> </span><a href="#loc_123_22_123_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_22_123_26&#39;)"><span class="hl_varref"><span class="mpre">hidx</span></span></a><span class="mpre">
                                     (</span><a href="#loc_87_10_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_14&#39;)"><span class="hl_varref"><span class="mpre">hlen</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

                if </span><a href="#loc_124_21_124_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_21_124_27&#39;)"><span class="hl_varref"><span class="mpre">match1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_126_21_126_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_21_126_27&#39;)"><span class="hl_varref"><span class="mpre">match2</span></span></a><span class="mpre">
                  then do
                    let !</span><a name="loc_131_26_131_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_26_131_33&#39;)"><span class="hl_vardecl"><span class="mpre">nomatch</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_123_22_123_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_22_123_26&#39;)"><span class="hl_varref"><span class="mpre">hidx</span></span></a><span class="mpre"> </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre">
                    let !</span><a name="loc_132_26_132_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_26_132_36&#39;)"><span class="hl_vardecl"><span class="mpre">aftermatch</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_123_37_123_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_37_123_45&#39;)"><span class="hl_varref"><span class="mpre">needMore</span></span></a><span class="mpre"> </span><a href="#loc_123_47_123_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_59&#39;)"><span class="hl_varref"><span class="mpre">nextHaystack</span></span></a><span class="mpre">

                    </span><a href="#loc_163_5_163_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_5_163_17&#39;)"><span class="hl_varref"><span class="mpre">produceMatch</span></span></a><span class="mpre"> </span><a href="#loc_131_26_131_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_26_131_33&#39;)"><span class="hl_varref"><span class="mpre">nomatch</span></span></a><span class="mpre"> </span><a href="#loc_132_26_132_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_26_132_36&#39;)"><span class="hl_varref"><span class="mpre">aftermatch</span></span></a><span class="mpre">

                  else do
                    let </span><a name="loc_137_25_137_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_123_47_123_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_59&#39;)"><span class="hl_varref"><span class="mpre">nextHaystack</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_123_37_123_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_37_123_45&#39;)"><span class="hl_varref"><span class="mpre">needMore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                    let </span><a name="loc_138_25_138_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_25_138_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Data.Vector.Unboxed.html#loc_288_1_288_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_288_1_288_12&#39;)"><span class="hl_varref"><span class="mpre">V.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_173_6_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_6_173_11&#39;)"><span class="hl_varref"><span class="mpre">table</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_137_25_137_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

                    if </span><a href="#loc_138_25_138_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_25_138_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_123_28_123_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_28_123_35&#39;)"><span class="hl_varref"><span class="mpre">leftLen</span></span></a><span class="mpre">
                      then do
                        let !</span><a name="loc_142_30_142_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_30_142_35&#39;)"><span class="hl_vardecl"><span class="mpre">hidx&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_123_22_123_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_22_123_26&#39;)"><span class="hl_varref"><span class="mpre">hidx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_138_25_138_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_25_138_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                        let (!</span><a name="loc_143_31_143_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_31_143_39&#39;)"><span class="hl_vardecl"><span class="mpre">leftLen&#39;</span></span></a><span class="mpre">, </span><a name="loc_143_41_143_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_41_143_50&#39;)"><span class="hl_vardecl"><span class="mpre">needMore&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_110_9_110_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_16&#39;)"><span class="hl_varref"><span class="mpre">mkCoeff</span></span></a><span class="mpre"> </span><a href="#loc_142_30_142_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_30_142_35&#39;)"><span class="hl_varref"><span class="mpre">hidx&#39;</span></span></a><span class="mpre">
                        let !</span><a name="loc_144_30_144_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_30_144_37&#39;)"><span class="hl_vardecl"><span class="mpre">nextlen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_123_47_123_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_59&#39;)"><span class="hl_varref"><span class="mpre">nextHaystack</span></span></a><span class="mpre">
                        if </span><a href="#loc_144_30_144_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_30_144_37&#39;)"><span class="hl_varref"><span class="mpre">nextlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_143_41_143_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_41_143_50&#39;)"><span class="hl_varref"><span class="mpre">needMore&#39;</span></span></a><span class="mpre">
                          then
                            </span><span class="hl_comment"><span class="mpre">-- this should be impossibly rare</span></span><span class="mpre">
                            </span><a href="#loc_187_5_187_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_14&#39;)"><span class="hl_varref"><span class="mpre">lookahead</span></span></a><span class="mpre"> (</span><a href="#loc_143_41_143_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_41_143_50&#39;)"><span class="hl_varref"><span class="mpre">needMore&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_144_30_144_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_30_144_37&#39;)"><span class="hl_varref"><span class="mpre">nextlen</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
                              </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (\</span><a name="loc_149_40_149_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_40_149_41&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_75_5_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_17&#39;)"><span class="hl_varref"><span class="mpre">finishAndEOF</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                            </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> [ </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre">
                                                     , </span><a href="#loc_123_47_123_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_59&#39;)"><span class="hl_varref"><span class="mpre">nextHaystack</span></span></a><span class="mpre">
                                                     , </span><a href="#loc_149_40_149_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_40_149_41&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> ])
                                     (\</span><a name="loc_153_40_153_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_40_153_41&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_123_13_123_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_20&#39;)"><span class="hl_varref"><span class="mpre">runNext</span></span></a><span class="mpre"> </span><a href="#loc_142_30_142_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_30_142_35&#39;)"><span class="hl_varref"><span class="mpre">hidx&#39;</span></span></a><span class="mpre"> </span><a href="#loc_143_31_143_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_31_143_39&#39;)"><span class="hl_varref"><span class="mpre">leftLen&#39;</span></span></a><span class="mpre"> </span><a href="#loc_143_41_143_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_41_143_50&#39;)"><span class="hl_varref"><span class="mpre">needMore&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                            </span><span class="hl_varref"><span class="mpre">S.append</span></span><span class="mpre"> </span><a href="#loc_123_47_123_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_59&#39;)"><span class="hl_varref"><span class="mpre">nextHaystack</span></span></a><span class="mpre"> </span><a href="#loc_153_40_153_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_40_153_41&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                          else </span><a href="#loc_123_13_123_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_20&#39;)"><span class="hl_varref"><span class="mpre">runNext</span></span></a><span class="mpre"> </span><a href="#loc_142_30_142_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_30_142_35&#39;)"><span class="hl_varref"><span class="mpre">hidx&#39;</span></span></a><span class="mpre"> </span><a href="#loc_143_31_143_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_31_143_39&#39;)"><span class="hl_varref"><span class="mpre">leftLen&#39;</span></span></a><span class="mpre"> </span><a href="#loc_143_41_143_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_41_143_50&#39;)"><span class="hl_varref"><span class="mpre">needMore&#39;</span></span></a><span class="mpre"> </span><a href="#loc_123_47_123_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_59&#39;)"><span class="hl_varref"><span class="mpre">nextHaystack</span></span></a><span class="mpre">
                      else do
                          let </span><a name="loc_157_31_157_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_31_157_35&#39;)"><span class="hl_vardecl"><span class="mpre">sidx</span></span></a><span class="mpre"> = </span><a href="#loc_138_25_138_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_25_138_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_123_28_123_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_28_123_35&#39;)"><span class="hl_varref"><span class="mpre">leftLen</span></span></a><span class="mpre">
                          let (!</span><a name="loc_158_33_158_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_33_158_38&#39;)"><span class="hl_vardecl"><span class="mpre">crumb</span></span></a><span class="mpre">, </span><a name="loc_158_40_158_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_40_158_44&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> </span><a href="#loc_157_31_157_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_31_157_35&#39;)"><span class="hl_varref"><span class="mpre">sidx</span></span></a><span class="mpre"> </span><a href="#loc_123_47_123_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_59&#39;)"><span class="hl_varref"><span class="mpre">nextHaystack</span></span></a><span class="mpre">
                          </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.yield</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">NoMatch</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.append</span></span><span class="mpre"> </span><a href="#loc_80_18_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre"> </span><a href="#loc_158_33_158_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_33_158_38&#39;)"><span class="hl_varref"><span class="mpre">crumb</span></span></a><span class="mpre">
                          </span><a href="#loc_80_5_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_16&#39;)"><span class="hl_varref"><span class="mpre">startSearch</span></span></a><span class="mpre"> </span><a href="#loc_158_40_158_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_40_158_44&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------</span></span><span class="mpre">
    </span><a name="loc_163_5_163_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_5_163_17&#39;)"><span class="hl_fundecl"><span class="mpre">produceMatch</span></span></a><span class="mpre"> </span><a name="loc_163_18_163_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_18_163_25&#39;)"><span class="hl_vardecl"><span class="mpre">nomatch</span></span></a><span class="mpre"> </span><a name="loc_163_26_163_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_26_163_36&#39;)"><span class="hl_vardecl"><span class="mpre">aftermatch</span></span></a><span class="mpre"> = do
        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_163_18_163_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_18_163_25&#39;)"><span class="hl_varref"><span class="mpre">nomatch</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.yield</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">NoMatch</span></span></a><span class="mpre"> </span><a href="#loc_163_18_163_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_18_163_25&#39;)"><span class="hl_varref"><span class="mpre">nomatch</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.yield</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_25_18_25_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_18_25_23&#39;)"><span class="hl_conref"><span class="mpre">Match</span></span></a><span class="mpre"> </span><a href="#loc_70_8_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_8_70_14&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre">
        </span><a href="#loc_80_5_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_16&#39;)"><span class="hl_varref"><span class="mpre">startSearch</span></span></a><span class="mpre"> </span><a href="#loc_163_26_163_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_26_163_36&#39;)"><span class="hl_varref"><span class="mpre">aftermatch</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------</span></span><span class="mpre">
    !</span><a name="loc_169_6_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_10&#39;)"><span class="hl_vardecl"><span class="mpre">nlen</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_70_8_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_8_70_14&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre">
    !</span><a name="loc_170_6_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_13&#39;)"><span class="hl_vardecl"><span class="mpre">lastIdx</span></span></a><span class="mpre"> = </span><a href="#loc_169_6_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_10&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------</span></span><span class="mpre">
    !</span><a name="loc_173_6_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_6_173_11&#39;)"><span class="hl_vardecl"><span class="mpre">table</span></span></a><span class="mpre"> = </span><a href="Data.Vector.Unboxed.html#loc_585_1_585_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_585_1_585_7&#39;)"><span class="hl_varref"><span class="mpre">V.create</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Vector.Unboxed.Mutable.html#loc_157_1_157_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.Mutable.html#loc_157_1_157_10&#39;)"><span class="hl_varref"><span class="mpre">MV.replicate</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">256</span></span><span class="mpre"> </span><a href="#loc_169_6_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_10&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre">
        </span><a href="#loc_178_9_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

      where
        </span><a name="loc_178_9_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_178_13_178_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_13_178_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_180_13_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_16&#39;)"><span class="hl_varref"><span class="mpre">go&#39;</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
          where
            </span><a name="loc_180_13_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_16&#39;)"><span class="hl_fundecl"><span class="mpre">go&#39;</span></span></a><span class="mpre"> !</span><a name="loc_180_18_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> | </span><a href="#loc_180_18_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_170_6_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_13&#39;)"><span class="hl_varref"><span class="mpre">lastIdx</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_178_13_178_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_13_178_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
                   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = do
                let </span><a name="loc_182_21_182_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_21_182_22&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_70_8_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_8_70_14&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre"> </span><a href="#loc_180_18_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
                </span><a href="Data.Vector.Unboxed.Mutable.html#loc_225_1_225_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.Mutable.html#loc_225_1_225_12&#39;)"><span class="hl_varref"><span class="mpre">MV.unsafeWrite</span></span></a><span class="mpre"> </span><a href="#loc_178_13_178_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_13_178_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_182_21_182_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_21_182_22&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_170_6_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_13&#39;)"><span class="hl_varref"><span class="mpre">lastIdx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_180_18_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
                </span><a href="#loc_180_13_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_16&#39;)"><span class="hl_varref"><span class="mpre">go&#39;</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_180_18_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------</span></span><span class="mpre">
    </span><a name="loc_187_5_187_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_14&#39;)"><span class="hl_fundecl"><span class="mpre">lookahead</span></span></a><span class="mpre"> </span><a name="loc_187_15_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_15_187_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_189_9_189_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_9_189_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_187_15_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_15_187_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
      where
        </span><a name="loc_189_9_189_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_9_189_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_189_12_189_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_12_189_17&#39;)"><span class="hl_vardecl"><span class="mpre">dlist</span></span></a><span class="mpre"> !</span><a name="loc_189_19_189_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_19_189_20&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">Streams.read</span></span></a><span class="mpre"> </span><a href="#loc_70_15_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_15_70_21&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_191_13_191_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_13_191_16&#39;)"><span class="hl_varref"><span class="mpre">eof</span></span></a><span class="mpre"> </span><a href="#loc_193_13_193_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_13_193_18&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">
          where
            </span><a name="loc_191_13_191_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_13_191_16&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_189_12_189_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_12_189_17&#39;)"><span class="hl_varref"><span class="mpre">dlist</span></span></a><span class="mpre"> []

            </span><a name="loc_193_13_193_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_13_193_18&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_193_19_193_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><a href="#loc_198_17_198_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                        then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_199_17_199_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_17_199_19&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre"> []
                        else </span><a href="#loc_189_9_189_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_9_189_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_199_17_199_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_17_199_19&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre"> </span><a href="#loc_198_17_198_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
              where
                </span><a name="loc_197_17_197_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_17_197_18&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_193_19_193_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                </span><a name="loc_198_17_198_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">  = </span><a href="#loc_189_19_189_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_19_189_20&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_197_17_197_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_17_197_18&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                </span><a name="loc_199_17_199_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_17_199_19&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_189_12_189_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_12_189_17&#39;)"><span class="hl_varref"><span class="mpre">dlist</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_193_19_193_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)
</span></div></body></html>