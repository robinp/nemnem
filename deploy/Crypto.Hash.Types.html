<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Hash.Types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Crypto hash types definitions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Hash.Types
    ( HashAlgorithm(..)
    , Context(..)
    , Digest(..)
    </span><span class="hl_comment"><span class="mpre">-- * deprecated</span></span><span class="mpre">
    , contextToByteString
    , digestToByteString
    )
    where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Types.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Data.Byteable
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Types.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 18, srcSpanEndLine = 22, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BC
import Crypto.Hash.Utils (</span><a href="Crypto.Hash.Utils.html#loc_29_1_29_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Utils.html#loc_29_1_29_6&#39;)"><span class="mpre">toHex</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Class representing hashing algorithms.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The hash algorithm is built over 3 primitives:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * init     : create a new hashing context</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * updates  : update the hashing context with some strict bytestrings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--              and return the new context</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * finalize : finalize the context into a digest</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
class </span><a name="loc_36_7_36_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_20&#39;)"><span class="hl_classdecl"><span class="mpre">HashAlgorithm</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
    </span><span class="hl_comment"><span class="mpre">-- | Block size in bytes the hash algorithm operates on</span></span><span class="mpre">
    </span><a name="loc_38_5_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_5_38_18&#39;)"><span class="mpre">hashBlockSize</span></a><span class="mpre"> :: </span><a href="#loc_54_9_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_16&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | Initialize a new context for this hash algorithm</span></span><span class="mpre">
    </span><a name="loc_41_5_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_13&#39;)"><span class="mpre">hashInit</span></a><span class="mpre">     :: </span><a href="#loc_54_9_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_16&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | Update the context with a list of strict bytestring,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- and return a new context with the updates.</span></span><span class="mpre">
    </span><a name="loc_45_5_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_16&#39;)"><span class="mpre">hashUpdates</span></a><span class="mpre">  :: </span><a href="#loc_54_9_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_16&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><a href="#loc_54_9_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_16&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | Finalize a context and return a digest.</span></span><span class="mpre">
    </span><a name="loc_48_5_48_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_5_48_17&#39;)"><span class="mpre">hashFinalize</span></a><span class="mpre"> :: </span><a href="#loc_54_9_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_16&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_64_9_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_15&#39;)"><span class="hl_tyconref"><span class="mpre">Digest</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | Try to convert a binary digest bytestring to a digest.</span></span><span class="mpre">
    </span><a name="loc_51_5_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_25&#39;)"><span class="mpre">digestFromByteString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><a href="#loc_64_9_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_15&#39;)"><span class="hl_tyconref"><span class="mpre">Digest</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Represent a context for a given hash algorithm.</span></span><span class="mpre">
newtype </span><a name="loc_54_9_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_54_21_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_21_54_28&#39;)"><span class="hl_condecl"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">

instance </span><a href="Data.Byteable.html#loc_22_7_22_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_22_7_22_15&#39;)"><span class="hl_classref"><span class="mpre">Byteable</span></span></a><span class="mpre"> (</span><a href="#loc_54_9_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_16&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_fundecl"><span class="mpre">toBytes</span></span></a><span class="mpre"> (</span><a href="#loc_54_21_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_21_54_28&#39;)"><span class="hl_conref"><span class="mpre">Context</span></span></a><span class="mpre"> </span><a name="loc_57_22_57_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_22_57_24&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = </span><a href="#loc_57_22_57_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_22_57_24&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | return the binary bytestring. deprecated use toBytes.</span></span><span class="mpre">
</span><a href="#loc_61_1_61_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_20&#39;)"><span class="mpre">contextToByteString</span></a><span class="mpre"> :: </span><a href="#loc_54_9_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_16&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_61_1_61_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_20&#39;)"><span class="hl_vardecl"><span class="mpre">contextToByteString</span></span></a><span class="mpre"> = </span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_varref"><span class="mpre">toBytes</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Represent a digest for a given hash algorithm.</span></span><span class="mpre">
newtype </span><a name="loc_64_9_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Digest</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_64_20_64_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_20_64_26&#39;)"><span class="hl_condecl"><span class="mpre">Digest</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Types.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 5, srcSpanEndLine = 65, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Types.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 5, srcSpanEndLine = 65, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Types.hs&quot;, srcSpanS"><span class="mpre">deriving (Eq,Ord)</span></span><span class="mpre">

instance </span><a href="Data.Byteable.html#loc_22_7_22_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_22_7_22_15&#39;)"><span class="hl_classref"><span class="mpre">Byteable</span></span></a><span class="mpre"> (</span><a href="#loc_64_9_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_15&#39;)"><span class="hl_tyconref"><span class="mpre">Digest</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_fundecl"><span class="mpre">toBytes</span></span></a><span class="mpre"> (</span><a href="#loc_64_20_64_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_20_64_26&#39;)"><span class="hl_conref"><span class="mpre">Digest</span></span></a><span class="mpre"> </span><a name="loc_68_21_68_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_21_68_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = </span><a href="#loc_68_21_68_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_21_68_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | return the binary bytestring. deprecated use toBytes.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Types.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 1, srcSpanEndLine = 71, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Types.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 1, srcSpanEndLine = 71, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Types.hs&quot;, sr"><span class="mpre">{-# DEPRECATED digestToByteString &quot;use toBytes from byteable:Data.Byteable&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_73_1_73_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_19&#39;)"><span class="mpre">digestToByteString</span></a><span class="mpre"> :: </span><a href="#loc_64_9_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_15&#39;)"><span class="hl_tyconref"><span class="mpre">Digest</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_73_1_73_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_19&#39;)"><span class="hl_vardecl"><span class="mpre">digestToByteString</span></span></a><span class="mpre"> = </span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_varref"><span class="mpre">toBytes</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> (</span><a href="#loc_64_9_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_15&#39;)"><span class="hl_tyconref"><span class="mpre">Digest</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_64_20_64_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_20_64_26&#39;)"><span class="hl_conref"><span class="mpre">Digest</span></span></a><span class="mpre"> </span><a name="loc_76_18_76_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_18_76_20&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">BC.unpack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Hash.Utils.html#loc_29_1_29_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Utils.html#loc_29_1_29_6&#39;)"><span class="hl_varref"><span class="mpre">toHex</span></span></a><span class="mpre"> </span><a href="#loc_76_18_76_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_18_76_20&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
</span></div></body></html>