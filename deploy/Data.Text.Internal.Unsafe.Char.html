<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, MagicHash #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Text.Internal.Unsafe.Char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2008, 2009 Tom Harper,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) 2009, 2010 Bryan O&#39;Sullivan,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) 2009 Duncan Coutts</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Warning/: this is an internal module, and does not have a stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- API or name. Functions in this module may not check or enforce</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- preconditions expected by public modules. Use at your own risk!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fast character manipulation functions.</span></span><span class="mpre">
module Data.Text.Internal.Unsafe.Char
    (
      ord
    , unsafeChr
    , unsafeChr8
    , unsafeChr32
    , unsafeWrite
    </span><span class="hl_comment"><span class="mpre">-- , unsafeWriteRev</span></span><span class="mpre">
    ) where

#ifdef ASSERTS
import Control.Exception (assert)
#endif
import Control.Monad.ST (ST)
import Data.Bits ((.&amp;.))
import Data.Text.Internal.Unsafe.Shift (</span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">)
import GHC.Exts (Char(..), Int(..), </span><a href="GHC.Prim.html#loc_1491_1_1491_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1491_1_1491_5&#39;)"><span class="mpre">chr#</span></a><span class="mpre">, </span><a href="GHC.Prim.html#loc_1382_1_1382_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1382_1_1382_5&#39;)"><span class="mpre">ord#</span></a><span class="mpre">, </span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="mpre">word2Int#</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Unsafe/Char.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 8, srcSpanEndLine = 36, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Word&quot;"><span class="mpre">GHC.Word</span></span><span class="mpre"> (Word8(..), Word16(..), Word32(..))
import qualified Data.Text.Array as A

</span><a href="#loc_40_1_40_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_4&#39;)"><span class="mpre">ord</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_40_1_40_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_4&#39;)"><span class="hl_fundecl"><span class="mpre">ord</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">C#</span></span><span class="mpre"> </span><a name="loc_40_9_40_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_11&#39;)"><span class="hl_vardecl"><span class="mpre">c#</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1382_1_1382_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1382_1_1382_5&#39;)"><span class="hl_varref"><span class="mpre">ord#</span></span></a><span class="mpre"> </span><a href="#loc_40_9_40_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_11&#39;)"><span class="hl_varref"><span class="mpre">c#</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_40_1_40_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_4&#39;)"><span class="mpre">ord</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="mpre">unsafeChr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeChr</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">W16#</span></span><span class="mpre"> </span><a name="loc_44_17_44_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_19&#39;)"><span class="hl_vardecl"><span class="mpre">w#</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">C#</span></span><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1491_1_1491_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1491_1_1491_5&#39;)"><span class="hl_varref"><span class="mpre">chr#</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="hl_varref"><span class="mpre">word2Int#</span></span></a><span class="mpre"> </span><a href="#loc_44_17_44_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_19&#39;)"><span class="hl_varref"><span class="mpre">w#</span></span></a><span class="mpre">))
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="mpre">unsafeChr</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_11&#39;)"><span class="mpre">unsafeChr8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_48_1_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_11&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeChr8</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">W8#</span></span><span class="mpre"> </span><a name="loc_48_17_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_19&#39;)"><span class="hl_vardecl"><span class="mpre">w#</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">C#</span></span><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1491_1_1491_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1491_1_1491_5&#39;)"><span class="hl_varref"><span class="mpre">chr#</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="hl_varref"><span class="mpre">word2Int#</span></span></a><span class="mpre"> </span><a href="#loc_48_17_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_19&#39;)"><span class="hl_varref"><span class="mpre">w#</span></span></a><span class="mpre">))
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_11&#39;)"><span class="mpre">unsafeChr8</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="mpre">unsafeChr32</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeChr32</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">W32#</span></span><span class="mpre"> </span><a name="loc_52_19_52_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_19_52_21&#39;)"><span class="hl_vardecl"><span class="mpre">w#</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">C#</span></span><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1491_1_1491_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1491_1_1491_5&#39;)"><span class="hl_varref"><span class="mpre">chr#</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="hl_varref"><span class="mpre">word2Int#</span></span></a><span class="mpre"> </span><a href="#loc_52_19_52_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_19_52_21&#39;)"><span class="hl_varref"><span class="mpre">w#</span></span></a><span class="mpre">))
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="mpre">unsafeChr32</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a character into the array at the given offset.  Returns</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the number of &#39;Word16&#39;s written.</span></span><span class="mpre">
</span><a href="#loc_58_1_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_12&#39;)"><span class="mpre">unsafeWrite</span></a><span class="mpre"> :: </span><a href="Data.Text.Array.html#loc_91_6_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_91_6_91_12&#39;)"><span class="hl_tyconref"><span class="mpre">A.MArray</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_58_1_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_12&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeWrite</span></span></a><span class="mpre"> </span><a name="loc_58_13_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_17&#39;)"><span class="hl_vardecl"><span class="mpre">marr</span></span></a><span class="mpre"> </span><a name="loc_58_18_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_18_58_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_58_20_58_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_20_58_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">
    | </span><a href="#loc_72_11_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre"> = do
#if defined(ASSERTS)
        </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_58_18_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_18_58_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_58_18_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_18_58_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="Data.Text.Array.html#loc_102_5_102_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_102_5_102_11&#39;)"><span class="hl_varref"><span class="mpre">A.length</span></span></a><span class="mpre"> </span><a href="#loc_58_13_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_17&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
#endif
        </span><a href="Data.Text.Array.html#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_158_1_158_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeWrite</span></span></a><span class="mpre"> </span><a href="#loc_58_13_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_17&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre"> </span><a href="#loc_58_18_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_18_58_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_72_11_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
#if defined(ASSERTS)
        </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_58_18_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_18_58_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_58_18_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_18_58_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="Data.Text.Array.html#loc_102_5_102_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_102_5_102_11&#39;)"><span class="hl_varref"><span class="mpre">A.length</span></span></a><span class="mpre"> </span><a href="#loc_58_13_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_17&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
#endif
        </span><a href="Data.Text.Array.html#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_158_1_158_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeWrite</span></span></a><span class="mpre"> </span><a href="#loc_58_13_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_17&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre"> </span><a href="#loc_58_18_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_18_58_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_74_11_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_13&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre">
        </span><a href="Data.Text.Array.html#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_158_1_158_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeWrite</span></span></a><span class="mpre"> </span><a href="#loc_58_13_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_17&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre"> (</span><a href="#loc_58_18_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_18_58_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_75_11_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_13&#39;)"><span class="hl_varref"><span class="mpre">hi</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
    where </span><a name="loc_72_11_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_40_1_40_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_4&#39;)"><span class="hl_varref"><span class="mpre">ord</span></span></a><span class="mpre"> </span><a href="#loc_58_20_58_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_20_58_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
          </span><a name="loc_73_11_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_72_11_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">
          </span><a name="loc_74_11_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_13&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_73_11_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre">
          </span><a name="loc_75_11_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_13&#39;)"><span class="hl_vardecl"><span class="mpre">hi</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_73_11_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3FF</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDC00</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_58_1_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_12&#39;)"><span class="mpre">unsafeWrite</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
unsafeWriteRev :: A.MArray s Word16 -&gt; Int -&gt; Char -&gt; ST s Int
unsafeWriteRev marr i c
    | n &lt; 0x10000 = do
        assert (i &gt;= 0) . assert (i &lt; A.length marr) $
          A.unsafeWrite marr i (fromIntegral n)
        return (i-1)
    | otherwise = do
        assert (i &gt;= 1) . assert (i &lt; A.length marr) $
          A.unsafeWrite marr (i-1) lo
        A.unsafeWrite marr i hi
        return (i-2)
    where n = ord c
          m = n - 0x10000
          lo = fromIntegral $ (m `shiftR` 10) + 0xD800
          hi = fromIntegral $ (m .&amp;. 0x3FF) + 0xDC00
{-# INLINE unsafeWriteRev #-}
-}</span></span><span class="mpre">
</span></div></body></html>