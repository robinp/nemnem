<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS_GHC -fno-warn-orphans #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE StandaloneDeriving #-}

module RequestSpec (main, spec) where

import Network.Wai.Handler.Warp.Request
import Network.Wai.Handler.Warp.RequestHeader (</span><a href="Network.Wai.Handler.Warp.RequestHeader.html#loc_136_1_136_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.RequestHeader.html#loc_136_1_136_16&#39;)"><span class="mpre">parseByteRanges</span></a><span class="mpre">)
import Network.Wai.Handler.Warp.Types
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/RequestSpec.hs&quot;, srcSpanStartLine = 10, srcSpanStartColumn = 8, srcSpanEndLine = 10, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/RequestSpec.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 8, srcSpanEndLine = 11, srcSpanEndColumn = 29}, srcInfoPoints = []}) &quot;Test.Hspec.QuickCheck&quot;"><span class="mpre">Test.Hspec.QuickCheck</span></span><span class="mpre">
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/RequestSpec.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/RequestSpec.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as S8
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/RequestSpec.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified Network.HTTP.Types.Header as HH
import Data.IORef

</span><a href="#loc_19_1_19_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_19_1_19_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hspec</span></span><span class="mpre"> </span><a href="#loc_22_1_22_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_5&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">

</span><a href="#loc_22_1_22_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_5&#39;)"><span class="mpre">spec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_22_1_22_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_5&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> = do
  </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;headerLines&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takes until blank&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="#loc_64_5_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_14&#39;)"><span class="hl_varref"><span class="mpre">blankSafe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, [</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;baz&quot;</span></span><span class="mpre">]))
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ignored leading whitespace in bodies&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="#loc_65_5_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_5_65_14&#39;)"><span class="hl_varref"><span class="mpre">whiteSafe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot; hi there&quot;</span></span><span class="mpre">, [</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;baz&quot;</span></span><span class="mpre">]))
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throws OverLargeHeader when too many&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="#loc_66_5_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_12&#39;)"><span class="hl_varref"><span class="mpre">tooMany</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldThrow`</span></span><span class="mpre"> </span><a href="#loc_101_1_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_16&#39;)"><span class="hl_varref"><span class="mpre">overLargeHeader</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throws OverLargeHeader when too large&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="#loc_67_5_67_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_13&#39;)"><span class="hl_varref"><span class="mpre">tooLarge</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldThrow`</span></span><span class="mpre"> </span><a href="#loc_101_1_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_16&#39;)"><span class="hl_varref"><span class="mpre">overLargeHeader</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;known bad chunking behavior #239&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        let </span><a name="loc_33_13_33_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_13_33_19&#39;)"><span class="hl_vardecl"><span class="mpre">chunks</span></span></a><span class="mpre"> =
                [ </span><span class="hl_string"><span class="mpre">&quot;GET / HTTP/1.1\r\nConnection: Close\r&quot;</span></span><span class="mpre">
                , </span><span class="hl_string"><span class="mpre">&quot;\n\r\n&quot;</span></span><span class="mpre">
                ]
        (</span><a name="loc_37_10_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_16&#39;)"><span class="hl_vardecl"><span class="mpre">actual</span></span></a><span class="mpre">, </span><a name="loc_37_18_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_18_37_21&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_74_1_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_17&#39;)"><span class="hl_varref"><span class="mpre">headerLinesList&#39;</span></span></a><span class="mpre"> </span><a href="#loc_33_13_33_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_13_33_19&#39;)"><span class="hl_varref"><span class="mpre">chunks</span></span></a><span class="mpre">
        </span><a name="loc_38_9_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_17&#39;)"><span class="hl_vardecl"><span class="mpre">leftover</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_120_1_120_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_120_1_120_19&#39;)"><span class="hl_varref"><span class="mpre">readLeftoverSource</span></span></a><span class="mpre"> </span><a href="#loc_37_18_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_18_37_21&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        </span><a href="#loc_38_9_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_17&#39;)"><span class="hl_varref"><span class="mpre">leftover</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
        </span><a href="#loc_37_10_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_16&#39;)"><span class="hl_varref"><span class="mpre">actual</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;GET / HTTP/1.1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Connection: Close&quot;</span></span><span class="mpre">]
    </span><span class="hl_varref"><span class="mpre">prop</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;random chunking&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_41_31_41_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_31_41_37&#39;)"><span class="hl_vardecl"><span class="mpre">breaks</span></span></a><span class="mpre"> </span><a name="loc_41_38_41_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_38_41_44&#39;)"><span class="hl_vardecl"><span class="mpre">extraS</span></span></a><span class="mpre"> -&gt; do
        let </span><a name="loc_42_13_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_19&#39;)"><span class="hl_vardecl"><span class="mpre">bsFull</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;GET / HTTP/1.1\r\nConnection: Close\r\n\r\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`S8.append`</span></span><span class="mpre"> </span><a href="#loc_43_13_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_18&#39;)"><span class="hl_varref"><span class="mpre">extra</span></span></a><span class="mpre">
            </span><a name="loc_43_13_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_18&#39;)"><span class="hl_vardecl"><span class="mpre">extra</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><a href="#loc_41_38_41_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_38_41_44&#39;)"><span class="hl_varref"><span class="mpre">extraS</span></span></a><span class="mpre">
            </span><a name="loc_44_13_44_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_19&#39;)"><span class="hl_vardecl"><span class="mpre">chunks</span></span></a><span class="mpre"> = </span><a href="#loc_45_13_45_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_17&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_41_31_41_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_31_41_37&#39;)"><span class="hl_varref"><span class="mpre">breaks</span></span></a><span class="mpre"> </span><a href="#loc_42_13_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_19&#39;)"><span class="hl_varref"><span class="mpre">bsFull</span></span></a><span class="mpre">
            </span><a name="loc_45_13_45_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_17&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> [] </span><a name="loc_45_21_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_21_45_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = [</span><a href="#loc_45_21_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_21_45_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">]
            </span><a href="#loc_45_13_45_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_17&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a name="loc_46_19_46_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_46_21_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_21_46_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_46_25_46_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_25_46_27&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
                </span><a href="#loc_49_18_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_18_49_21&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_45_13_45_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_17&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_46_21_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_21_46_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_49_23_49_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_23_49_26&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">
              where
                (</span><a name="loc_49_18_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_18_49_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs1</span></span></a><span class="mpre">, </span><a name="loc_49_23_49_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_23_49_26&#39;)"><span class="hl_vardecl"><span class="mpre">bs2</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S8.splitAt</span></span><span class="mpre"> ((</span><a href="#loc_46_19_46_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_46_25_46_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_25_46_27&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        (</span><a name="loc_50_10_50_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_10_50_16&#39;)"><span class="hl_vardecl"><span class="mpre">actual</span></span></a><span class="mpre">, </span><a name="loc_50_18_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_18_50_21&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_74_1_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_17&#39;)"><span class="hl_varref"><span class="mpre">headerLinesList&#39;</span></span></a><span class="mpre"> </span><a href="#loc_44_13_44_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_19&#39;)"><span class="hl_varref"><span class="mpre">chunks</span></span></a><span class="mpre">
        </span><a name="loc_51_9_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_17&#39;)"><span class="hl_vardecl"><span class="mpre">leftover</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_87_1_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_11&#39;)"><span class="hl_varref"><span class="mpre">consumeLen</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_41_38_41_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_38_41_44&#39;)"><span class="hl_varref"><span class="mpre">extraS</span></span></a><span class="mpre">) </span><a href="#loc_50_18_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_18_50_21&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">

        </span><a href="#loc_50_10_50_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_10_50_16&#39;)"><span class="hl_varref"><span class="mpre">actual</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;GET / HTTP/1.1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Connection: Close&quot;</span></span><span class="mpre">]
        </span><a href="#loc_51_9_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_17&#39;)"><span class="hl_varref"><span class="mpre">leftover</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><a href="#loc_43_13_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_18&#39;)"><span class="hl_varref"><span class="mpre">extra</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parseByteRanges&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    let </span><a name="loc_56_9_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_13&#39;)"><span class="hl_fundecl"><span class="mpre">test</span></span></a><span class="mpre"> </span><a name="loc_56_14_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_14_56_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_56_16_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_16_56_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><a href="#loc_56_14_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_14_56_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.RequestHeader.html#loc_136_1_136_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.RequestHeader.html#loc_136_1_136_16&#39;)"><span class="hl_varref"><span class="mpre">parseByteRanges</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><a href="#loc_56_14_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_14_56_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><a href="#loc_56_16_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_16_56_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
    </span><a href="#loc_56_9_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_13&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytes=0-499&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> [</span><a href="Network.HTTP.Types.Header.html#loc_88_5_88_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_88_5_88_20&#39;)"><span class="hl_conref"><span class="mpre">HH.ByteRangeFromTo</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">499</span></span><span class="mpre">]
    </span><a href="#loc_56_9_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_13&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytes=500-999&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> [</span><a href="Network.HTTP.Types.Header.html#loc_88_5_88_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_88_5_88_20&#39;)"><span class="hl_conref"><span class="mpre">HH.ByteRangeFromTo</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">500</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">999</span></span><span class="mpre">]
    </span><a href="#loc_56_9_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_13&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytes=-500&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> [</span><a href="Network.HTTP.Types.Header.html#loc_89_5_89_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_89_5_89_20&#39;)"><span class="hl_conref"><span class="mpre">HH.ByteRangeSuffix</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">500</span></span><span class="mpre">]
    </span><a href="#loc_56_9_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_13&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytes=9500-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> [</span><a href="Network.HTTP.Types.Header.html#loc_87_5_87_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_87_5_87_18&#39;)"><span class="hl_conref"><span class="mpre">HH.ByteRangeFrom</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">9500</span></span><span class="mpre">]
    </span><a href="#loc_56_9_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_13&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foobytes=9500-&quot;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a href="#loc_56_9_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_13&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytes=0-0,-1&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> [</span><a href="Network.HTTP.Types.Header.html#loc_88_5_88_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_88_5_88_20&#39;)"><span class="hl_conref"><span class="mpre">HH.ByteRangeFromTo</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="Network.HTTP.Types.Header.html#loc_89_5_89_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_89_5_89_20&#39;)"><span class="hl_conref"><span class="mpre">HH.ByteRangeSuffix</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">]
  where
    </span><a name="loc_64_5_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_14&#39;)"><span class="hl_vardecl"><span class="mpre">blankSafe</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_16&#39;)"><span class="hl_varref"><span class="mpre">headerLinesList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;f&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;oo\n&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bar\nbaz\n\r\n&quot;</span></span><span class="mpre">]
    </span><a name="loc_65_5_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_5_65_14&#39;)"><span class="hl_vardecl"><span class="mpre">whiteSafe</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_16&#39;)"><span class="hl_varref"><span class="mpre">headerLinesList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;foo\r\nbar\r\nbaz\r\n\r\n hi there&quot;</span></span><span class="mpre">]
    </span><a name="loc_66_5_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_12&#39;)"><span class="hl_vardecl"><span class="mpre">tooMany</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_16&#39;)"><span class="hl_varref"><span class="mpre">headerLinesList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;f\n&quot;</span></span><span class="mpre">
    </span><a name="loc_67_5_67_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_13&#39;)"><span class="hl_vardecl"><span class="mpre">tooLarge</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_16&#39;)"><span class="hl_varref"><span class="mpre">headerLinesList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;f&quot;</span></span><span class="mpre">

</span><a name="loc_69_1_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_16&#39;)"><span class="hl_fundecl"><span class="mpre">headerLinesList</span></span></a><span class="mpre"> </span><a name="loc_69_17_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_17_69_21&#39;)"><span class="hl_vardecl"><span class="mpre">orig</span></span></a><span class="mpre"> = do
    (</span><a name="loc_70_6_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_9&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre">, </span><a name="loc_70_11_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_11_70_14&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_74_1_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_17&#39;)"><span class="hl_varref"><span class="mpre">headerLinesList&#39;</span></span></a><span class="mpre"> </span><a href="#loc_69_17_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_17_69_21&#39;)"><span class="hl_varref"><span class="mpre">orig</span></span></a><span class="mpre">
    </span><a name="loc_71_5_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_13&#39;)"><span class="hl_vardecl"><span class="mpre">leftover</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_120_1_120_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_120_1_120_19&#39;)"><span class="hl_varref"><span class="mpre">readLeftoverSource</span></span></a><span class="mpre"> </span><a href="#loc_70_11_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_11_70_14&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_71_5_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_13&#39;)"><span class="hl_varref"><span class="mpre">leftover</span></span></a><span class="mpre">, </span><a href="#loc_70_6_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_9&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">)

</span><a name="loc_74_1_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_17&#39;)"><span class="hl_fundecl"><span class="mpre">headerLinesList&#39;</span></span></a><span class="mpre"> </span><a name="loc_74_18_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_18_74_22&#39;)"><span class="hl_vardecl"><span class="mpre">orig</span></span></a><span class="mpre"> = do
    </span><a name="loc_75_5_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_74_18_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_18_74_22&#39;)"><span class="hl_varref"><span class="mpre">orig</span></span></a><span class="mpre">
    let </span><a name="loc_76_9_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_12&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = do
            </span><a name="loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_75_5_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
            case </span><a href="#loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                [] -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
                </span><a name="loc_80_17_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_17_80_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_80_19_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_20&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> -&gt; do
                    </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_75_5_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_80_19_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_20&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_80_17_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_17_80_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
    </span><a name="loc_83_5_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_9&#39;)"><span class="hl_vardecl"><span class="mpre">src&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_99_1_99_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_99_1_99_9&#39;)"><span class="hl_varref"><span class="mpre">mkSource</span></span></a><span class="mpre"> </span><a href="#loc_76_9_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_12&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
    </span><a name="loc_84_5_84_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_8&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Request.html#loc_88_1_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Request.html#loc_88_1_88_12&#39;)"><span class="hl_varref"><span class="mpre">headerLines</span></span></a><span class="mpre"> </span><a href="#loc_83_5_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_9&#39;)"><span class="hl_varref"><span class="mpre">src&#39;</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_84_5_84_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">, </span><a href="#loc_83_5_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_9&#39;)"><span class="hl_varref"><span class="mpre">src&#39;</span></span></a><span class="mpre">)

</span><a name="loc_87_1_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_11&#39;)"><span class="hl_fundecl"><span class="mpre">consumeLen</span></span></a><span class="mpre"> </span><a name="loc_87_12_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">len0</span></span></a><span class="mpre"> </span><a name="loc_87_17_87_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_20&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> =
    </span><a href="#loc_90_5_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_87_12_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_16&#39;)"><span class="hl_varref"><span class="mpre">len0</span></span></a><span class="mpre">
  where
    </span><a name="loc_90_5_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_9&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_90_10_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_15&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> </span><a name="loc_90_16_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_19&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">
        | </span><a href="#loc_90_16_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_19&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_90_10_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_15&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
            </span><a name="loc_93_13_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_87_17_87_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_20&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
            if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_93_13_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                then </span><a href="#loc_90_5_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_90_10_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_15&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                else do
                    let (</span><a name="loc_97_26_97_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_26_97_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">y</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> </span><a href="#loc_90_16_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_19&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_93_13_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    </span><a href="#loc_90_5_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_90_10_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_15&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_97_26_97_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_26_97_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) (</span><a href="#loc_90_16_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_19&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_97_26_97_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_26_97_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><a href="#loc_101_1_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_16&#39;)"><span class="mpre">overLargeHeader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Selector</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Types.html#loc_44_6_44_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_44_6_44_20&#39;)"><span class="hl_tyconref"><span class="mpre">InvalidRequest</span></span></a><span class="mpre">
</span><a name="loc_101_1_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_16&#39;)"><span class="hl_fundecl"><span class="mpre">overLargeHeader</span></span></a><span class="mpre"> </span><a name="loc_101_17_101_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_18&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="#loc_101_17_101_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_18&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Types.html#loc_49_23_49_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_49_23_49_38&#39;)"><span class="hl_conref"><span class="mpre">OverLargeHeader</span></span></a><span class="mpre">
</span></div></body></html>