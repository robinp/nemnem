<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}

module Network.Wai.Handler.Warp.Header where

import Data.Array
import Data.Array.ST
import Network.HTTP.Types
import Network.Wai.Handler.Warp.Types

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Array for a set of HTTP headers.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Header.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 1, srcSpanEndLine = 13, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Header.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 1, srcSpanEndLine = 13, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler"><span class="mpre">type IndexedHeader = Array Int (Maybe HeaderValue)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_18_1_18_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_19&#39;)"><span class="mpre">indexRequestHeader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">RequestHeaders</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IndexedHeader</span></span><span class="mpre">
</span><a name="loc_18_1_18_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_19&#39;)"><span class="hl_fundecl"><span class="mpre">indexRequestHeader</span></span></a><span class="mpre"> </span><a name="loc_18_20_18_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_23&#39;)"><span class="hl_vardecl"><span class="mpre">hdr</span></span></a><span class="mpre"> = </span><a href="#loc_70_1_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_15&#39;)"><span class="hl_varref"><span class="mpre">traverseHeader</span></span></a><span class="mpre"> </span><a href="#loc_18_20_18_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_23&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre"> </span><a href="#loc_33_1_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_16&#39;)"><span class="hl_varref"><span class="mpre">requestMaxIndex</span></span></a><span class="mpre"> </span><a href="#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">requestKeyIndex</span></span></a><span class="mpre">

</span><a href="#loc_22_1_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_17&#39;)"><span class="mpre">idxContentLength</span></a><span class="mpre">,</span><a href="#loc_23_1_23_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_20&#39;)"><span class="mpre">idxTransferEncoding</span></a><span class="mpre">,</span><a href="#loc_24_1_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_10&#39;)"><span class="mpre">idxExpect</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a href="#loc_25_1_25_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_14&#39;)"><span class="mpre">idxConnection</span></a><span class="mpre">,</span><a href="#loc_26_1_26_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_9&#39;)"><span class="mpre">idxRange</span></a><span class="mpre">,</span><a href="#loc_27_1_27_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_8&#39;)"><span class="mpre">idxHost</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_22_1_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_17&#39;)"><span class="hl_vardecl"><span class="mpre">idxContentLength</span></span></a><span class="mpre">    = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><a name="loc_23_1_23_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_20&#39;)"><span class="hl_vardecl"><span class="mpre">idxTransferEncoding</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
</span><a name="loc_24_1_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_10&#39;)"><span class="hl_vardecl"><span class="mpre">idxExpect</span></span></a><span class="mpre">           = </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
</span><a name="loc_25_1_25_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_14&#39;)"><span class="hl_vardecl"><span class="mpre">idxConnection</span></span></a><span class="mpre">       = </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
</span><a name="loc_26_1_26_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_9&#39;)"><span class="hl_vardecl"><span class="mpre">idxRange</span></span></a><span class="mpre">            = </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
</span><a name="loc_27_1_27_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_8&#39;)"><span class="hl_vardecl"><span class="mpre">idxHost</span></span></a><span class="mpre">             = </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The size for &#39;IndexedHeader&#39; for HTTP Request.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   From 0 to this corresponds to \&quot;Content-Length\&quot;, \&quot;Transfer-Encoding\&quot;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   \&quot;Expect\&quot;, \&quot;Connection\&quot;, \&quot;Range\&quot;, and \&quot;Host\&quot;.</span></span><span class="mpre">
</span><a href="#loc_33_1_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_16&#39;)"><span class="mpre">requestMaxIndex</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_33_1_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_16&#39;)"><span class="hl_vardecl"><span class="mpre">requestMaxIndex</span></span></a><span class="mpre">     = </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">

</span><a href="#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="mpre">requestKeyIndex</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HeaderName</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="hl_fundecl"><span class="mpre">requestKeyIndex</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;content-length&quot;</span></span><span class="mpre">    = </span><a href="#loc_22_1_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_17&#39;)"><span class="hl_varref"><span class="mpre">idxContentLength</span></span></a><span class="mpre">
</span><a href="#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="hl_fundecl"><span class="mpre">requestKeyIndex</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;transfer-encoding&quot;</span></span><span class="mpre"> = </span><a href="#loc_23_1_23_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_20&#39;)"><span class="hl_varref"><span class="mpre">idxTransferEncoding</span></span></a><span class="mpre">
</span><a href="#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="hl_fundecl"><span class="mpre">requestKeyIndex</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;expect&quot;</span></span><span class="mpre">            = </span><a href="#loc_24_1_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_10&#39;)"><span class="hl_varref"><span class="mpre">idxExpect</span></span></a><span class="mpre">
</span><a href="#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="hl_fundecl"><span class="mpre">requestKeyIndex</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;connection&quot;</span></span><span class="mpre">        = </span><a href="#loc_25_1_25_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_14&#39;)"><span class="hl_varref"><span class="mpre">idxConnection</span></span></a><span class="mpre">
</span><a href="#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="hl_fundecl"><span class="mpre">requestKeyIndex</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;range&quot;</span></span><span class="mpre">             = </span><a href="#loc_26_1_26_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_9&#39;)"><span class="hl_varref"><span class="mpre">idxRange</span></span></a><span class="mpre">
</span><a href="#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="hl_fundecl"><span class="mpre">requestKeyIndex</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;host&quot;</span></span><span class="mpre">              = </span><a href="#loc_27_1_27_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_8&#39;)"><span class="hl_varref"><span class="mpre">idxHost</span></span></a><span class="mpre">
</span><a href="#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="hl_fundecl"><span class="mpre">requestKeyIndex</span></span></a><span class="mpre"> _                   = -</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

</span><a href="#loc_45_1_45_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_26&#39;)"><span class="mpre">defaultIndexRequestHeader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IndexedHeader</span></span><span class="mpre">
</span><a name="loc_45_1_45_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_26&#39;)"><span class="hl_vardecl"><span class="mpre">defaultIndexRequestHeader</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_33_1_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_16&#39;)"><span class="hl_varref"><span class="mpre">requestMaxIndex</span></span></a><span class="mpre">) [(</span><a href="#loc_45_68_45_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_68_45_69&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)|</span><a name="loc_45_68_45_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_68_45_69&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">&lt;-</span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Header.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 71, srcSpanEndLine = 45, srcSpanEndColumn = 91}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Header.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 71, srcSpanEndLine = 45, srcSpanEndColumn = 72},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Ha"><span class="mpre">[0..requestMaxIndex]</span></span><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_50_1_50_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_20&#39;)"><span class="mpre">indexResponseHeader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ResponseHeaders</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IndexedHeader</span></span><span class="mpre">
</span><a name="loc_50_1_50_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_20&#39;)"><span class="hl_fundecl"><span class="mpre">indexResponseHeader</span></span></a><span class="mpre"> </span><a name="loc_50_21_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_21_50_24&#39;)"><span class="hl_vardecl"><span class="mpre">hdr</span></span></a><span class="mpre"> = </span><a href="#loc_70_1_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_15&#39;)"><span class="hl_varref"><span class="mpre">traverseHeader</span></span></a><span class="mpre"> </span><a href="#loc_50_21_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_21_50_24&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre"> </span><a href="#loc_59_1_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_17&#39;)"><span class="hl_varref"><span class="mpre">responseMaxIndex</span></span></a><span class="mpre"> </span><a href="#loc_62_1_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_17&#39;)"><span class="hl_varref"><span class="mpre">responseKeyIndex</span></span></a><span class="mpre">

</span><a href="#loc_54_1_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_10&#39;)"><span class="mpre">idxServer</span></a><span class="mpre">, </span><a href="#loc_55_1_55_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_8&#39;)"><span class="mpre">idxDate</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--idxContentLength = 0</span></span><span class="mpre">
</span><a name="loc_54_1_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_10&#39;)"><span class="hl_vardecl"><span class="mpre">idxServer</span></span></a><span class="mpre">        = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
</span><a name="loc_55_1_55_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_8&#39;)"><span class="hl_vardecl"><span class="mpre">idxDate</span></span></a><span class="mpre">          = </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The size for &#39;IndexedHeader&#39; for HTTP Response.</span></span><span class="mpre">
</span><a href="#loc_59_1_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_17&#39;)"><span class="mpre">responseMaxIndex</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_59_1_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_17&#39;)"><span class="hl_vardecl"><span class="mpre">responseMaxIndex</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">

</span><a href="#loc_62_1_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_17&#39;)"><span class="mpre">responseKeyIndex</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HeaderName</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_62_1_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseKeyIndex</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;content-length&quot;</span></span><span class="mpre"> = </span><a href="#loc_22_1_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_17&#39;)"><span class="hl_varref"><span class="mpre">idxContentLength</span></span></a><span class="mpre">
</span><a href="#loc_62_1_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseKeyIndex</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;server&quot;</span></span><span class="mpre">         = </span><a href="#loc_54_1_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_10&#39;)"><span class="hl_varref"><span class="mpre">idxServer</span></span></a><span class="mpre">
</span><a href="#loc_62_1_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseKeyIndex</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;date&quot;</span></span><span class="mpre">           = </span><a href="#loc_55_1_55_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_8&#39;)"><span class="hl_varref"><span class="mpre">idxDate</span></span></a><span class="mpre">
</span><a href="#loc_62_1_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseKeyIndex</span></span></a><span class="mpre"> _                = -</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_70_1_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_15&#39;)"><span class="mpre">traverseHeader</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Header</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">HeaderName</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IndexedHeader</span></span><span class="mpre">
</span><a name="loc_70_1_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_15&#39;)"><span class="hl_fundecl"><span class="mpre">traverseHeader</span></span></a><span class="mpre"> </span><a name="loc_70_16_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_16_70_19&#39;)"><span class="hl_vardecl"><span class="mpre">hdr</span></span></a><span class="mpre"> </span><a name="loc_70_20_70_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_26&#39;)"><span class="hl_vardecl"><span class="mpre">maxidx</span></span></a><span class="mpre"> </span><a name="loc_70_27_70_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_27_70_35&#39;)"><span class="hl_vardecl"><span class="mpre">getIndex</span></span></a><span class="mpre"> = </span><a href="Data.Array.ST.html#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Array.ST.html#loc_43_1_43_11&#39;)"><span class="hl_varref"><span class="mpre">runSTArray</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_71_5_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_8&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_70_20_70_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_26&#39;)"><span class="hl_varref"><span class="mpre">maxidx</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> (</span><a href="#loc_75_5_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_11&#39;)"><span class="hl_varref"><span class="mpre">insert</span></span></a><span class="mpre"> </span><a href="#loc_71_5_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_8&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre">) </span><a href="#loc_70_16_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_16_70_19&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_71_5_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_8&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre">
  where
    </span><a name="loc_75_5_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_11&#39;)"><span class="hl_fundecl"><span class="mpre">insert</span></span></a><span class="mpre"> </span><a name="loc_75_12_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_12_75_15&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> (</span><a name="loc_75_17_75_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_20&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre">,</span><a name="loc_75_21_75_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_24&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre">)
      | </span><a href="#loc_79_9_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_12&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> -</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">writeArray</span></span><span class="mpre"> </span><a href="#loc_75_12_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_12_75_15&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_79_9_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_12&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_75_21_75_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_24&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">)
      where
        </span><a name="loc_79_9_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_12&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><a href="#loc_70_27_70_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_27_70_35&#39;)"><span class="hl_varref"><span class="mpre">getIndex</span></span></a><span class="mpre"> </span><a href="#loc_75_17_75_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_20&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">
</span></div></body></html>