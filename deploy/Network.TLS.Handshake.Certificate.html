<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Handshake.Certificate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Handshake.Certificate
    ( certificateRejected
    , rejectOnException
    ) where

import Network.TLS.Context.Internal
import Network.TLS.Struct
import Network.TLS.X509
import Control.Monad.State
import Control.Exception (SomeException)

</span><span class="hl_comment"><span class="mpre">-- on certificate reject, throw an exception with the proper protocol alert error.</span></span><span class="mpre">
</span><a href="#loc_21_1_21_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_20&#39;)"><span class="mpre">certificateRejected</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Handshake/Certificate.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 24, srcSpanEndLine = 20, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Handshake/Certificate.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 34, srcSpanEndLine = 20, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">MonadIO m =&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.X509.html#loc_40_6_40_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.X509.html#loc_40_6_40_29&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateRejectReason</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_21_1_21_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_20&#39;)"><span class="hl_fundecl"><span class="mpre">certificateRejected</span></span></a><span class="mpre"> </span><a href="Network.TLS.X509.html#loc_42_11_42_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.X509.html#loc_42_11_42_35&#39;)"><span class="hl_conref"><span class="mpre">CertificateRejectRevoked</span></span></a><span class="mpre"> =
    </span><a href="Network.TLS.Context.Internal.html#loc_167_1_167_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_167_1_167_10&#39;)"><span class="hl_varref"><span class="mpre">throwCore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_123_7_123_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_123_7_123_21&#39;)"><span class="hl_conref"><span class="mpre">Error_Protocol</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;certificate is revoked&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_191_7_191_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_191_7_191_25&#39;)"><span class="hl_conref"><span class="mpre">CertificateRevoked</span></span></a><span class="mpre">)
</span><a href="#loc_21_1_21_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_20&#39;)"><span class="hl_fundecl"><span class="mpre">certificateRejected</span></span></a><span class="mpre"> </span><a href="Network.TLS.X509.html#loc_41_11_41_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.X509.html#loc_41_11_41_35&#39;)"><span class="hl_conref"><span class="mpre">CertificateRejectExpired</span></span></a><span class="mpre"> =
    </span><a href="Network.TLS.Context.Internal.html#loc_167_1_167_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_167_1_167_10&#39;)"><span class="hl_varref"><span class="mpre">throwCore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_123_7_123_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_123_7_123_21&#39;)"><span class="hl_conref"><span class="mpre">Error_Protocol</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;certificate has expired&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_192_7_192_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_192_7_192_25&#39;)"><span class="hl_conref"><span class="mpre">CertificateExpired</span></span></a><span class="mpre">)
</span><a href="#loc_21_1_21_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_20&#39;)"><span class="hl_fundecl"><span class="mpre">certificateRejected</span></span></a><span class="mpre"> </span><a href="Network.TLS.X509.html#loc_43_11_43_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.X509.html#loc_43_11_43_37&#39;)"><span class="hl_conref"><span class="mpre">CertificateRejectUnknownCA</span></span></a><span class="mpre"> =
    </span><a href="Network.TLS.Context.Internal.html#loc_167_1_167_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_167_1_167_10&#39;)"><span class="hl_varref"><span class="mpre">throwCore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_123_7_123_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_123_7_123_21&#39;)"><span class="hl_conref"><span class="mpre">Error_Protocol</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;certificate has unknown CA&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_195_7_195_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_195_7_195_16&#39;)"><span class="hl_conref"><span class="mpre">UnknownCa</span></span></a><span class="mpre">)
</span><a href="#loc_21_1_21_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_20&#39;)"><span class="hl_fundecl"><span class="mpre">certificateRejected</span></span></a><span class="mpre"> (</span><a href="Network.TLS.X509.html#loc_44_11_44_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.X509.html#loc_44_11_44_33&#39;)"><span class="hl_conref"><span class="mpre">CertificateRejectOther</span></span></a><span class="mpre"> </span><a name="loc_27_45_27_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_45_27_46&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) =
    </span><a href="Network.TLS.Context.Internal.html#loc_167_1_167_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_167_1_167_10&#39;)"><span class="hl_varref"><span class="mpre">throwCore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_123_7_123_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_123_7_123_21&#39;)"><span class="hl_conref"><span class="mpre">Error_Protocol</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;certificate rejected: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_27_45_27_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_45_27_46&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_193_7_193_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_193_7_193_25&#39;)"><span class="hl_conref"><span class="mpre">CertificateUnknown</span></span></a><span class="mpre">)

</span><a href="#loc_31_1_31_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_18&#39;)"><span class="mpre">rejectOnException</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">SomeException</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.TLS.X509.html#loc_48_6_48_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.X509.html#loc_48_6_48_22&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateUsage</span></span></a><span class="mpre">
</span><a name="loc_31_1_31_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_18&#39;)"><span class="hl_fundecl"><span class="mpre">rejectOnException</span></span></a><span class="mpre"> </span><a name="loc_31_19_31_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_20&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.X509.html#loc_50_11_50_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.X509.html#loc_50_11_50_33&#39;)"><span class="hl_conref"><span class="mpre">CertificateUsageReject</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.X509.html#loc_44_11_44_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.X509.html#loc_44_11_44_33&#39;)"><span class="hl_conref"><span class="mpre">CertificateRejectOther</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_31_19_31_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_20&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
</span></div></body></html>