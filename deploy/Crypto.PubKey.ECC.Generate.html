<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | Signature generation.</span></span><span class="mpre">
module Crypto.PubKey.ECC.Generate where

import Crypto.Random (</span><a href="Crypto.Random.Generator.html#loc_16_7_16_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Generator.html#loc_16_7_16_11&#39;)"><span class="mpre">CPRG</span></a><span class="mpre">)
import Crypto.Types.PubKey.ECC
import Crypto.Types.PubKey.ECDSA
import Crypto.Number.Generate
import Crypto.PubKey.ECC.Prim

</span><span class="hl_comment"><span class="mpre">-- | Generate Q given d.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /WARNING:/ Vulnerable to timing attacks.</span></span><span class="mpre">
</span><a href="#loc_16_1_16_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_1_16_10&#39;)"><span class="mpre">generateQ</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.ECC.html#loc_33_6_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_33_6_33_11&#39;)"><span class="hl_tyconref"><span class="mpre">Curve</span></span></a><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
          -&gt; </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_6_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_6_44_11&#39;)"><span class="hl_tyconref"><span class="mpre">Point</span></span></a><span class="mpre">
</span><a name="loc_16_1_16_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_1_16_10&#39;)"><span class="hl_fundecl"><span class="mpre">generateQ</span></span></a><span class="mpre"> </span><a name="loc_16_11_16_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_11_16_16&#39;)"><span class="hl_vardecl"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a name="loc_16_17_16_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_17_16_18&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.ECC.Prim.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.ECC.Prim.html#loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">pointMul</span></span></a><span class="mpre"> </span><a href="#loc_16_11_16_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_11_16_16&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a href="#loc_16_17_16_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_17_16_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_17_9_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
  where </span><a name="loc_17_9_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_76_7_76_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_76_7_76_12&#39;)"><span class="hl_varref"><span class="mpre">ecc_g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_60_1_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_60_1_60_13&#39;)"><span class="hl_varref"><span class="mpre">common_curve</span></span></a><span class="mpre"> </span><a href="#loc_16_11_16_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_11_16_16&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Generate a pair of (private, public) key.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /WARNING:/ Vulnerable to timing attacks.</span></span><span class="mpre">
</span><a href="#loc_26_1_26_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_9&#39;)"><span class="mpre">generate</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ECC/Generate.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 13, srcSpanEndLine = 23, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ECC/Generate.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 10, srcSpanEndLine = 23, srcSpanEndColumn = 12}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">CPRG g
         =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ CPRG</span></span><span class="mpre">
         -&gt; </span><a href="Crypto.Types.PubKey.ECC.html#loc_33_6_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_33_6_33_11&#39;)"><span class="hl_tyconref"><span class="mpre">Curve</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Elliptic Curve</span></span><span class="mpre">
         -&gt; ((</span><a href="Crypto.Types.PubKey.ECDSA.html#loc_40_6_40_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_40_6_40_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre">, </span><a href="Crypto.Types.PubKey.ECDSA.html#loc_34_6_34_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_34_6_34_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre">), </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_26_1_26_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_9&#39;)"><span class="hl_fundecl"><span class="mpre">generate</span></span></a><span class="mpre"> </span><a name="loc_26_10_26_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_10_26_13&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_26_14_26_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_14_26_19&#39;)"><span class="hl_vardecl"><span class="mpre">curve</span></span></a><span class="mpre"> = ((</span><span class="hl_conref"><span class="mpre">PublicKey</span></span><span class="mpre"> </span><a href="#loc_26_14_26_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_14_26_19&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a href="#loc_28_9_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_10&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">PrivateKey</span></span><span class="mpre"> </span><a href="#loc_26_14_26_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_14_26_19&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a href="#loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">), </span><a href="#loc_27_13_27_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_13_27_17&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)
  where (</span><a name="loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">, </span><a name="loc_27_13_27_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_13_27_17&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.Number.Generate.html#loc_29_1_29_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_29_1_29_16&#39;)"><span class="hl_varref"><span class="mpre">generateBetween</span></span></a><span class="mpre"> </span><a href="#loc_26_10_26_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_10_26_13&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_29_9_29_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a name="loc_28_9_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_10&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="#loc_16_1_16_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_1_16_10&#39;)"><span class="hl_varref"><span class="mpre">generateQ</span></span></a><span class="mpre"> </span><a href="#loc_26_14_26_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_14_26_19&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a href="#loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
        </span><a name="loc_29_9_29_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_77_7_77_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_77_7_77_12&#39;)"><span class="hl_varref"><span class="mpre">ecc_n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_60_1_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_60_1_60_13&#39;)"><span class="hl_varref"><span class="mpre">common_curve</span></span></a><span class="mpre"> </span><a href="#loc_26_14_26_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_14_26_19&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre">
</span></div></body></html>