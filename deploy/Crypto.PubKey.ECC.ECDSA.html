<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | /WARNING:/ Signature operations may leak the private key. Signature verification</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- should be safe.</span></span><span class="mpre">
module Crypto.PubKey.ECC.ECDSA
    ( module Crypto.Types.PubKey.ECDSA
    , signWith
    , sign
    , verify
    ) where

import Control.Monad
import Crypto.Random
import Data.Bits (</span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ECC/ECDSA.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 8, srcSpanEndLine = 13, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Crypto.Number.ModArithmetic (</span><a href="Crypto.Number.ModArithmetic.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_126_1_126_8&#39;)"><span class="mpre">inverse</span></a><span class="mpre">)
import Crypto.Number.Serialize
import Crypto.Number.Generate
import Crypto.Types.PubKey.ECDSA
import Crypto.Types.PubKey.ECC
import Crypto.PubKey.HashDescr
import Crypto.PubKey.ECC.Prim

</span><span class="hl_comment"><span class="mpre">-- | Sign message using the private key and an explicit k number.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /WARNING:/ Vulnerable to timing attacks.</span></span><span class="mpre">
</span><a href="#loc_30_1_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_9&#39;)"><span class="mpre">signWith</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ k random number</span></span><span class="mpre">
         -&gt; </span><a href="Crypto.Types.PubKey.ECDSA.html#loc_34_6_34_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_34_6_34_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ private key</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ hash function</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ message to sign</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECDSA.html#loc_28_6_28_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_28_6_28_15&#39;)"><span class="hl_tyconref"><span class="mpre">Signature</span></span></a><span class="mpre">
</span><a name="loc_30_1_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_9&#39;)"><span class="hl_fundecl"><span class="mpre">signWith</span></span></a><span class="mpre"> </span><a name="loc_30_10_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_10_30_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PrivateKey</span></span><span class="mpre"> </span><a name="loc_30_24_30_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_29&#39;)"><span class="hl_vardecl"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a name="loc_30_30_30_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_30_30_31&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) </span><a name="loc_30_33_30_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_33_30_37&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_30_38_30_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_38_30_41&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = do
    let </span><a name="loc_31_9_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_10&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="#loc_76_1_76_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_6&#39;)"><span class="hl_varref"><span class="mpre">tHash</span></span></a><span class="mpre"> </span><a href="#loc_30_33_30_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_33_30_37&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_30_38_30_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_38_30_41&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a href="#loc_32_27_32_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_28&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">CurveCommon</span></span><span class="mpre"> _ _ </span><a name="loc_32_25_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_25_32_26&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_32_27_32_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_28&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ = </span><a href="Crypto.Types.PubKey.ECC.html#loc_60_1_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_60_1_60_13&#39;)"><span class="hl_varref"><span class="mpre">common_curve</span></span></a><span class="mpre"> </span><a href="#loc_30_24_30_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_29&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre">
    let </span><a name="loc_33_9_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_14&#39;)"><span class="hl_vardecl"><span class="mpre">point</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.ECC.Prim.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.ECC.Prim.html#loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">pointMul</span></span></a><span class="mpre"> </span><a href="#loc_30_24_30_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_29&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a href="#loc_30_10_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_10_30_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_32_25_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_25_32_26&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
    </span><a name="loc_34_5_34_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_6&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- case </span><a href="#loc_33_9_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_14&#39;)"><span class="hl_varref"><span class="mpre">point</span></span></a><span class="mpre"> of
              </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre">    -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
              </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a name="loc_36_21_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_21_36_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_36_21_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_21_36_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_32_27_32_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_28&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    </span><a name="loc_37_5_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_9&#39;)"><span class="hl_vardecl"><span class="mpre">kInv</span></span></a><span class="mpre"> &lt;- </span><a href="Crypto.Number.ModArithmetic.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_126_1_126_8&#39;)"><span class="hl_varref"><span class="mpre">inverse</span></span></a><span class="mpre"> </span><a href="#loc_30_10_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_10_30_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_32_27_32_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_28&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    let </span><a name="loc_38_9_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_37_5_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_9&#39;)"><span class="hl_varref"><span class="mpre">kInv</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_31_9_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_10&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_34_5_34_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_6&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_30_30_30_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_30_30_31&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_32_27_32_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_28&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_34_5_34_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_6&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_38_9_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Signature</span></span><span class="mpre"> </span><a href="#loc_34_5_34_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_6&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_38_9_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Sign message using the private key.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /WARNING:/ Vulnerable to timing attacks.</span></span><span class="mpre">
</span><a href="#loc_46_1_46_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_5&#39;)"><span class="mpre">sign</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ECC/ECDSA.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 9, srcSpanEndLine = 45, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ECC/ECDSA.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 16, srcSpanEndLine = 45, srcSpanEndColumn = 18}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemne"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECDSA.html#loc_34_6_34_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_34_6_34_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><a href="Crypto.Types.PubKey.ECDSA.html#loc_28_6_28_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_28_6_28_15&#39;)"><span class="hl_tyconref"><span class="mpre">Signature</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_46_1_46_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_5&#39;)"><span class="hl_fundecl"><span class="mpre">sign</span></span></a><span class="mpre"> </span><a name="loc_46_6_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_6_46_9&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_46_10_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_12&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_46_13_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_17&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_46_18_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_18_46_21&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
    case </span><a href="#loc_30_1_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_9&#39;)"><span class="hl_varref"><span class="mpre">signWith</span></span></a><span class="mpre"> </span><a href="#loc_51_10_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_46_10_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_12&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_46_13_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_17&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_46_18_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_18_46_21&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> of
         </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  -&gt; </span><a href="#loc_46_1_46_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_5&#39;)"><span class="hl_varref"><span class="mpre">sign</span></span></a><span class="mpre"> </span><a href="#loc_51_13_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_17&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre"> </span><a href="#loc_46_10_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_12&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_46_13_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_17&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_46_18_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_18_46_21&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
         </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_49_15_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_18&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_49_15_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_18&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre">, </span><a href="#loc_51_13_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_17&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)
  where </span><a name="loc_50_9_50_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_77_7_77_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_77_7_77_12&#39;)"><span class="hl_varref"><span class="mpre">ecc_n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_60_1_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_60_1_60_13&#39;)"><span class="hl_varref"><span class="mpre">common_curve</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECDSA.html#loc_35_7_35_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_35_7_35_20&#39;)"><span class="hl_varref"><span class="mpre">private_curve</span></span></a><span class="mpre"> </span><a href="#loc_46_10_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_12&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">
        (</span><a name="loc_51_10_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_51_13_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_17&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.Number.Generate.html#loc_29_1_29_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_29_1_29_16&#39;)"><span class="hl_varref"><span class="mpre">generateBetween</span></span></a><span class="mpre"> </span><a href="#loc_46_6_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_6_46_9&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_50_9_50_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Verify a bytestring using the public key.</span></span><span class="mpre">
</span><a href="#loc_55_1_55_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_7&#39;)"><span class="mpre">verify</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECDSA.html#loc_40_6_40_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_40_6_40_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECDSA.html#loc_28_6_28_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_28_6_28_15&#39;)"><span class="hl_tyconref"><span class="mpre">Signature</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_55_1_55_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_7&#39;)"><span class="hl_fundecl"><span class="mpre">verify</span></span></a><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">PublicKey</span></span><span class="mpre"> _ </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre">) _ _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_55_1_55_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_7&#39;)"><span class="hl_fundecl"><span class="mpre">verify</span></span></a><span class="mpre"> </span><a name="loc_56_8_56_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_8_56_12&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_56_13_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_15&#39;)"><span class="hl_specname"><span class="mpre">pk</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">PublicKey</span></span><span class="mpre"> </span><a name="loc_56_27_56_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_27_56_32&#39;)"><span class="hl_vardecl"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a name="loc_56_33_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_33_56_34&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Signature</span></span><span class="mpre"> </span><a name="loc_56_47_56_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_47_56_48&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_56_49_56_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_49_56_50&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_56_52_56_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_52_56_55&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre">
    | </span><a href="#loc_56_47_56_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_47_56_48&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_56_47_56_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_47_56_48&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_70_9_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_56_49_56_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_49_56_50&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_56_49_56_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_49_56_50&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_70_9_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> (</span><a href="#loc_56_47_56_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_47_56_48&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_59_9_59_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_10&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> &lt;- </span><a href="Crypto.Number.ModArithmetic.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_126_1_126_8&#39;)"><span class="hl_varref"><span class="mpre">inverse</span></span></a><span class="mpre"> </span><a href="#loc_56_49_56_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_49_56_50&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_70_9_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        let </span><a name="loc_60_13_60_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_13_60_14&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">  = </span><a href="#loc_76_1_76_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_6&#39;)"><span class="hl_varref"><span class="mpre">tHash</span></span></a><span class="mpre"> </span><a href="#loc_56_8_56_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_8_56_12&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_56_52_56_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_52_56_55&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a href="#loc_70_9_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
            </span><a name="loc_61_13_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_13_61_15&#39;)"><span class="hl_vardecl"><span class="mpre">u1</span></span></a><span class="mpre"> = </span><a href="#loc_60_13_60_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_13_60_14&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_59_9_59_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_70_9_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
            </span><a name="loc_62_13_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_13_62_15&#39;)"><span class="hl_vardecl"><span class="mpre">u2</span></span></a><span class="mpre"> = </span><a href="#loc_56_47_56_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_47_56_48&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_59_9_59_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_70_9_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- TODO: Use Shamir&#39;s trick</span></span><span class="mpre">
            </span><a name="loc_64_13_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_13_64_15&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.ECC.Prim.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.ECC.Prim.html#loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">pointMul</span></span></a><span class="mpre"> </span><a href="#loc_56_27_56_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_27_56_32&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a href="#loc_61_13_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_13_61_15&#39;)"><span class="hl_varref"><span class="mpre">u1</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
            </span><a name="loc_65_13_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_13_65_15&#39;)"><span class="hl_vardecl"><span class="mpre">q&#39;</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.ECC.Prim.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.ECC.Prim.html#loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">pointMul</span></span></a><span class="mpre"> </span><a href="#loc_56_27_56_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_27_56_32&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a href="#loc_62_13_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_13_62_15&#39;)"><span class="hl_varref"><span class="mpre">u2</span></span></a><span class="mpre"> </span><a href="#loc_56_33_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_33_56_34&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
            </span><a name="loc_66_13_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  = </span><a href="Crypto.PubKey.ECC.Prim.html#loc_19_1_19_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.ECC.Prim.html#loc_19_1_19_9&#39;)"><span class="hl_varref"><span class="mpre">pointAdd</span></span></a><span class="mpre"> </span><a href="#loc_56_27_56_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_27_56_32&#39;)"><span class="hl_varref"><span class="mpre">curve</span></span></a><span class="mpre"> </span><a href="#loc_64_13_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_13_64_15&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre"> </span><a href="#loc_65_13_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_13_65_15&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre">
        case </span><a href="#loc_66_13_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
             </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre">     -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
             </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a name="loc_69_20_69_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_22&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_69_20_69_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_22&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_70_9_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
  where </span><a name="loc_70_9_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_77_7_77_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_77_7_77_12&#39;)"><span class="hl_varref"><span class="mpre">ecc_n</span></span></a><span class="mpre"> </span><a href="#loc_72_9_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_11&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre">
        </span><a name="loc_71_9_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_76_7_76_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_76_7_76_12&#39;)"><span class="hl_varref"><span class="mpre">ecc_g</span></span></a><span class="mpre"> </span><a href="#loc_72_9_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_11&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre">
        </span><a name="loc_72_9_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_11&#39;)"><span class="hl_vardecl"><span class="mpre">cc</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_60_1_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_60_1_60_13&#39;)"><span class="hl_varref"><span class="mpre">common_curve</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECDSA.html#loc_41_7_41_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECDSA.html#loc_41_7_41_19&#39;)"><span class="hl_varref"><span class="mpre">public_curve</span></span></a><span class="mpre"> </span><a href="#loc_56_13_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_15&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Truncate and hash.</span></span><span class="mpre">
</span><a href="#loc_76_1_76_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_6&#39;)"><span class="mpre">tHash</span></a><span class="mpre"> ::  </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_76_1_76_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_6&#39;)"><span class="hl_fundecl"><span class="mpre">tHash</span></span></a><span class="mpre"> </span><a name="loc_76_7_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_7_76_11&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><a href="#loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_varref"><span class="mpre">shiftR</span></span></a><span class="mpre"> </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
  where </span><a name="loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="hl_varref"><span class="mpre">os2ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_76_7_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_7_76_11&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
        </span><a name="loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="#loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_varref"><span class="mpre">log2</span></span></a><span class="mpre"> </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_varref"><span class="mpre">log2</span></span></a><span class="mpre"> </span><a href="#loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        </span><a name="loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_vardecl"><span class="mpre">log2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">ceiling</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">logBase</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">
</span></div></body></html>