<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ForeignFunctionInterface #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Hash.Whirlpool</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A module containing Whirlpool bindings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Hash.Whirlpool
    ( Ctx(..)

    </span><span class="hl_comment"><span class="mpre">-- * Incremental hashing Functions</span></span><span class="mpre">
    , init     </span><span class="hl_comment"><span class="mpre">-- :: Ctx</span></span><span class="mpre">
    , update   </span><span class="hl_comment"><span class="mpre">-- :: Ctx -&gt; ByteString -&gt; Ctx</span></span><span class="mpre">
    , updates  </span><span class="hl_comment"><span class="mpre">-- :: Ctx -&gt; [ByteString] -&gt; Ctx</span></span><span class="mpre">
    , finalize </span><span class="hl_comment"><span class="mpre">-- :: Ctx -&gt; ByteString</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- * Single Pass hashing</span></span><span class="mpre">
    , hash     </span><span class="hl_comment"><span class="mpre">-- :: ByteString -&gt; ByteString</span></span><span class="mpre">
    , hashlazy </span><span class="hl_comment"><span class="mpre">-- :: ByteString -&gt; ByteString</span></span><span class="mpre">
    ) where

import Prelude hiding (init)
import Foreign.Ptr
import Foreign.ForeignPtr (</span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="mpre">withForeignPtr</span></a><span class="mpre">)
import Foreign.Storable
import Foreign.Marshal.Alloc
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 18, srcSpanEndLine = 31, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 18, srcSpanEndLine = 32, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 8, srcSpanEndLine = 33, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Data.ByteString.Unsafe (</span><a href="Data.ByteString.Unsafe.html#loc_311_1_311_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_311_1_311_22&#39;)"><span class="mpre">unsafeUseAsCStringLen</span></a><span class="mpre">)
import Data.ByteString.Internal (</span><a href="Data.ByteString.Internal.html#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_434_1_434_7&#39;)"><span class="mpre">create</span></a><span class="mpre">, </span><a href="Data.ByteString.Internal.html#loc_405_1_405_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_405_1_405_13&#39;)"><span class="mpre">toForeignPtr</span></a><span class="mpre">)
import Data.Word
import Crypto.Hash.Internal (</span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="mpre">unsafeDoIO</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Whirlpool Context</span></span><span class="mpre">
newtype </span><a name="loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Ctx</span></span></a><span class="mpre"> = </span><a name="loc_40_15_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_15_40_18&#39;)"><span class="hl_condecl"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_44_1_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_11&#39;)"><span class="mpre">digestSize</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_44_1_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_11&#39;)"><span class="mpre">digestSize</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_44_1_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_11&#39;)"><span class="hl_vardecl"><span class="mpre">digestSize</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">64</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="mpre">sizeCtx</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="mpre">sizeCtx</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_vardecl"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">168</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;digestSize&quot; B.length (finalize init) = digestSize #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;hash&quot; forall b. finalize (update init b) = hash b #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;hash.list1&quot; forall b. finalize (updates init [b]) = hash b #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;hashmany&quot; forall b. finalize (foldl update init b) = hashlazy (L.fromChunks b) #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;hashlazy&quot; forall b. finalize (foldl update init $ L.toChunks b) = hashlazy b #-}</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_58_1_58_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_18&#39;)"><span class="mpre">withByteStringPtr</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_58_1_58_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_18&#39;)"><span class="mpre">withByteStringPtr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_58_1_58_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_18&#39;)"><span class="hl_fundecl"><span class="mpre">withByteStringPtr</span></span></a><span class="mpre"> </span><a name="loc_58_19_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_19_58_20&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_58_21_58_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_21_58_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
    </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_60_12_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_12_60_16&#39;)"><span class="hl_varref"><span class="mpre">fptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_59_28_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_28_59_31&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_58_21_58_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_21_58_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_59_28_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_28_59_31&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_60_18_60_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_18_60_21&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre">)
    where (</span><a name="loc_60_12_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_12_60_16&#39;)"><span class="hl_vardecl"><span class="mpre">fptr</span></span></a><span class="mpre">, </span><a name="loc_60_18_60_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_18_60_21&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre">, _) = </span><a href="Data.ByteString.Internal.html#loc_405_1_405_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_405_1_405_13&#39;)"><span class="hl_varref"><span class="mpre">toForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_58_19_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_19_58_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_64_1_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_10&#39;)"><span class="mpre">memcopy64</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_64_1_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_10&#39;)"><span class="mpre">memcopy64</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_64_1_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_10&#39;)"><span class="hl_fundecl"><span class="mpre">memcopy64</span></span></a><span class="mpre"> </span><a name="loc_64_11_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_14&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a name="loc_64_15_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_15_64_18&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a href="#loc_65_11_65_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_11_65_22&#39;)"><span class="hl_varref"><span class="mpre">peekAndPoke</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 39, srcSpanEndLine = 64, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 39, srcSpanEndLine = 64, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpo"><span class="mpre">[0..(21-1)]</span></span><span class="mpre">
    where </span><a name="loc_65_11_65_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_11_65_22&#39;)"><span class="hl_fundecl"><span class="mpre">peekAndPoke</span></span></a><span class="mpre"> </span><a name="loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> </span><a href="#loc_64_15_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_15_64_18&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pokeElemOff</span></span><span class="mpre"> </span><a href="#loc_64_11_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_14&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a href="#loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="mpre">withCtxCopy</span></a><span class="mpre"> :: </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_fundecl"><span class="mpre">withCtxCopy</span></span></a><span class="mpre"> (</span><a href="#loc_40_15_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_15_40_18&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><a name="loc_68_18_68_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_18_68_22&#39;)"><span class="hl_vardecl"><span class="mpre">ctxB</span></span></a><span class="mpre">) </span><a name="loc_68_24_68_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_24_68_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_40_15_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_15_40_18&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_69_11_69_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_11_69_20&#39;)"><span class="hl_varref"><span class="mpre">createCtx</span></span></a><span class="mpre">
    where </span><a name="loc_69_11_69_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_11_69_20&#39;)"><span class="hl_vardecl"><span class="mpre">createCtx</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">create</span></span></a><span class="mpre"> </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_69_41_69_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_41_69_47&#39;)"><span class="hl_vardecl"><span class="mpre">dstPtr</span></span></a><span class="mpre"> -&gt;
                      </span><a href="#loc_58_1_58_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_18&#39;)"><span class="hl_varref"><span class="mpre">withByteStringPtr</span></span></a><span class="mpre"> </span><a href="#loc_68_18_68_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_18_68_22&#39;)"><span class="hl_varref"><span class="mpre">ctxB</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_70_49_70_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_49_70_55&#39;)"><span class="hl_vardecl"><span class="mpre">srcPtr</span></span></a><span class="mpre"> -&gt; do
                          </span><a href="#loc_64_1_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_10&#39;)"><span class="hl_varref"><span class="mpre">memcopy64</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_69_41_69_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_41_69_47&#39;)"><span class="hl_varref"><span class="mpre">dstPtr</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_70_49_70_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_49_70_55&#39;)"><span class="hl_varref"><span class="mpre">srcPtr</span></span></a><span class="mpre">)
                          </span><a href="#loc_68_24_68_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_24_68_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_69_41_69_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_41_69_47&#39;)"><span class="hl_varref"><span class="mpre">dstPtr</span></span></a><span class="mpre">)

</span><a href="#loc_75_1_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_13&#39;)"><span class="mpre">withCtxThrow</span></a><span class="mpre"> :: </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_75_1_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_13&#39;)"><span class="hl_fundecl"><span class="mpre">withCtxThrow</span></span></a><span class="mpre"> (</span><a href="#loc_40_15_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_15_40_18&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><a name="loc_75_19_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_19_75_23&#39;)"><span class="hl_vardecl"><span class="mpre">ctxB</span></span></a><span class="mpre">) </span><a name="loc_75_25_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
    </span><a href="Foreign.Marshal.Alloc.html#loc_121_1_121_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_121_1_121_12&#39;)"><span class="hl_varref"><span class="mpre">allocaBytes</span></span></a><span class="mpre"> </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_76_28_76_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_34&#39;)"><span class="hl_vardecl"><span class="mpre">dstPtr</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_58_1_58_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_18&#39;)"><span class="hl_varref"><span class="mpre">withByteStringPtr</span></span></a><span class="mpre"> </span><a href="#loc_75_19_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_19_75_23&#39;)"><span class="hl_varref"><span class="mpre">ctxB</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_77_31_77_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_31_77_37&#39;)"><span class="hl_vardecl"><span class="mpre">srcPtr</span></span></a><span class="mpre"> -&gt; do
        </span><a href="#loc_64_1_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_10&#39;)"><span class="hl_varref"><span class="mpre">memcopy64</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_76_28_76_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_34&#39;)"><span class="hl_varref"><span class="mpre">dstPtr</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_77_31_77_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_31_77_37&#39;)"><span class="hl_varref"><span class="mpre">srcPtr</span></span></a><span class="mpre">)
        </span><a href="#loc_75_25_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_76_28_76_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_34&#39;)"><span class="hl_varref"><span class="mpre">dstPtr</span></span></a><span class="mpre">)

</span><a href="#loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="mpre">withCtxNew</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="hl_fundecl"><span class="mpre">withCtxNew</span></span></a><span class="mpre"> </span><a name="loc_82_12_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_40_15_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_15_40_18&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">create</span></span></a><span class="mpre"> </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> (</span><a href="#loc_82_12_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre">)

</span><a href="#loc_85_1_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_16&#39;)"><span class="mpre">withCtxNewThrow</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_85_1_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_16&#39;)"><span class="hl_fundecl"><span class="mpre">withCtxNewThrow</span></span></a><span class="mpre"> </span><a name="loc_85_17_85_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="Foreign.Marshal.Alloc.html#loc_121_1_121_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_121_1_121_12&#39;)"><span class="hl_varref"><span class="mpre">allocaBytes</span></span></a><span class="mpre"> </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> (</span><a href="#loc_85_17_85_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre">)

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 1, srcSpanEndLine = 88, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 1, srcSpanEndLine = 87, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;,"><span class="mpre">foreign import ccall unsafe &quot;whirlpool.h whirlpool_init&quot;
    c_whirlpool_init :: Ptr Ctx -&gt; IO ()</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 1, srcSpanEndLine = 91, srcSpanEndColumn = 66}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 1, srcSpanEndLine = 90, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;,"><span class="mpre">foreign import ccall &quot;whirlpool.h whirlpool_update&quot;
    c_whirlpool_update :: Ptr Ctx -&gt; Ptr Word8 -&gt; Word32 -&gt; IO ()</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 1, srcSpanEndLine = 94, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 1, srcSpanEndLine = 93, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/Whirlpool.hs&quot;,"><span class="mpre">foreign import ccall unsafe &quot;whirlpool.h whirlpool_finalize&quot;
    c_whirlpool_finalize :: Ptr Ctx -&gt; Ptr Word8 -&gt; IO ()</span></span><span class="mpre">

</span><a href="#loc_97_1_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_17&#39;)"><span class="mpre">updateInternalIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_97_1_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_17&#39;)"><span class="hl_fundecl"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a name="loc_97_18_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_21&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_97_22_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_22_97_23&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> =
    </span><a href="Data.ByteString.Unsafe.html#loc_311_1_311_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_311_1_311_22&#39;)"><span class="hl_varref"><span class="mpre">unsafeUseAsCStringLen</span></span></a><span class="mpre"> </span><a href="#loc_97_22_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_22_97_23&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> (\(</span><a name="loc_98_32_98_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_32_98_34&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a name="loc_98_36_98_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_36_98_39&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">c_whirlpool_update</span></span><span class="mpre"> </span><a href="#loc_97_18_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_21&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_98_32_98_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_32_98_34&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_98_36_98_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_36_98_39&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">))

</span><a href="#loc_101_1_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_19&#39;)"><span class="mpre">finalizeInternalIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_101_1_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_19&#39;)"><span class="hl_fundecl"><span class="mpre">finalizeInternalIO</span></span></a><span class="mpre"> </span><a name="loc_101_20_101_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_23&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">create</span></span></a><span class="mpre"> </span><a href="#loc_44_1_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_11&#39;)"><span class="hl_varref"><span class="mpre">digestSize</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">c_whirlpool_finalize</span></span><span class="mpre"> </span><a href="#loc_101_20_101_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_23&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">)

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_106_1_106_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_5&#39;)"><span class="mpre">init</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | init a context</span></span><span class="mpre">
</span><a href="#loc_106_1_106_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_5&#39;)"><span class="mpre">init</span></a><span class="mpre"> :: </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_106_1_106_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_5&#39;)"><span class="hl_vardecl"><span class="mpre">init</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="hl_varref"><span class="mpre">withCtxNew</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">c_whirlpool_init</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="mpre">update</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | update a context with a bytestring</span></span><span class="mpre">
</span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="mpre">update</span></a><span class="mpre"> :: </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> </span><a name="loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_111_12_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_varref"><span class="mpre">withCtxCopy</span></span></a><span class="mpre"> </span><a href="#loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_111_48_111_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_48_111_51&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_97_1_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_17&#39;)"><span class="hl_varref"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_111_48_111_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_48_111_51&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_111_12_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_116_1_116_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_8&#39;)"><span class="mpre">updates</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | updates a context with multiples bytestring</span></span><span class="mpre">
</span><a href="#loc_116_1_116_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_8&#39;)"><span class="mpre">updates</span></a><span class="mpre"> :: </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_116_1_116_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_8&#39;)"><span class="hl_fundecl"><span class="mpre">updates</span></span></a><span class="mpre"> </span><a name="loc_116_9_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_12&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_116_13_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_14&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_varref"><span class="mpre">withCtxCopy</span></span></a><span class="mpre"> </span><a href="#loc_116_9_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_12&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_116_49_116_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_49_116_52&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><a href="#loc_97_1_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_17&#39;)"><span class="hl_varref"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_116_49_116_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_49_116_52&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">) </span><a href="#loc_116_13_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_121_1_121_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_9&#39;)"><span class="mpre">finalize</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | finalize the context into a digest bytestring</span></span><span class="mpre">
</span><a href="#loc_121_1_121_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_9&#39;)"><span class="mpre">finalize</span></a><span class="mpre"> :: </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_121_1_121_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_9&#39;)"><span class="hl_fundecl"><span class="mpre">finalize</span></span></a><span class="mpre"> </span><a name="loc_121_10_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_10_121_13&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_75_1_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_13&#39;)"><span class="hl_varref"><span class="mpre">withCtxThrow</span></span></a><span class="mpre"> </span><a href="#loc_121_10_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_10_121_13&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_101_1_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_19&#39;)"><span class="hl_varref"><span class="mpre">finalizeInternalIO</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="mpre">hash</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | hash a strict bytestring into a digest bytestring</span></span><span class="mpre">
</span><a href="#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="mpre">hash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="hl_fundecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_126_6_126_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_6_126_7&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_85_1_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_16&#39;)"><span class="hl_varref"><span class="mpre">withCtxNewThrow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_126_42_126_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_42_126_45&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">c_whirlpool_init</span></span><span class="mpre"> </span><a href="#loc_126_42_126_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_42_126_45&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_97_1_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_17&#39;)"><span class="hl_varref"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_126_42_126_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_42_126_45&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_126_6_126_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_6_126_7&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_101_1_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_19&#39;)"><span class="hl_varref"><span class="mpre">finalizeInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_126_42_126_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_42_126_45&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_132_1_132_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_9&#39;)"><span class="mpre">hashlazy</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | hash a lazy bytestring into a digest bytestring</span></span><span class="mpre">
</span><a href="#loc_132_1_132_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_9&#39;)"><span class="mpre">hashlazy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_132_1_132_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_9&#39;)"><span class="hl_fundecl"><span class="mpre">hashlazy</span></span></a><span class="mpre"> </span><a name="loc_132_10_132_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_10_132_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_85_1_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_16&#39;)"><span class="hl_varref"><span class="mpre">withCtxNewThrow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_132_46_132_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_46_132_49&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">c_whirlpool_init</span></span><span class="mpre"> </span><a href="#loc_132_46_132_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_46_132_49&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><a href="#loc_97_1_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_17&#39;)"><span class="hl_varref"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_132_46_132_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_46_132_49&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_132_10_132_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_10_132_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_101_1_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_19&#39;)"><span class="hl_varref"><span class="mpre">finalizeInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_132_46_132_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_46_132_49&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
</span></div></body></html>