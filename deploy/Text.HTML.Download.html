<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">{-|
    /DEPRECATED/: Use the HTTP package instead:

    &gt; import Network.HTTP
    &gt; openURL x = getResponseBody =&lt;&lt; simpleHTTP (getRequest x)

    This module simply downloads a page off the internet. It is very restricted,
    and it not intended for proper use.
    
    The original version was by Alistair Bayley, with additional help from
    Daniel McAllansmith. It is taken from the Haskell-Cafe mailing list
    \&quot;Simple HTTP lib for Windows?\&quot;, 18 Jan 2007.
    &lt;http://thread.gmane.org/gmane.comp.lang.haskell.cafe/18443/&gt;
-}</span></span><span class="mpre">

module Text.HTML.Download(openURL, openItem) where

import System.IO
import System.IO.Unsafe
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/Download.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 15}, srcInfoPoints = []}) &quot;Network&quot;"><span class="mpre">Network</span></span><span class="mpre">
import Data.List

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/Download.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 126}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/Download.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/Download.hs&quot;, srcSpan"><span class="mpre">{-# DEPRECATED openItem, openURL &quot;Use package HTTP, module Network.HTTP, getResponseBody =&lt;&lt; simpleHTTP (getRequest url)&quot; #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | This function opens a URL on the internet.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Any @http:\/\/@ prefix is ignored.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; openURL &quot;www.haskell.org/haskellwiki/Haskell&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Known Limitations:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Only HTTP on port 80</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Outputs the HTTP Headers as well</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Does not work with all servers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It is hoped that a more reliable version of this function will be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- placed in a new HTTP library at some point!</span></span><span class="mpre">
</span><a href="#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="mpre">openURL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="hl_fundecl"><span class="mpre">openURL</span></span></a><span class="mpre"> </span><a name="loc_42_9_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_12&#39;)"><span class="hl_vardecl"><span class="mpre">url</span></span></a><span class="mpre"> | </span><span class="hl_string"><span class="mpre">&quot;http://&quot;</span></span><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_42_9_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_12&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre"> = </span><a href="#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="hl_varref"><span class="mpre">openURL</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><a href="#loc_42_9_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_12&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre">)
</span><a href="#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="hl_fundecl"><span class="mpre">openURL</span></span></a><span class="mpre"> </span><a name="loc_43_9_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_12&#39;)"><span class="hl_vardecl"><span class="mpre">url</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="hl_varref"><span class="mpre">client</span></span></a><span class="mpre"> </span><a href="#loc_44_12_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_12_44_18&#39;)"><span class="hl_varref"><span class="mpre">server</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">80</span></span><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_44_19_44_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_19_44_23&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre"> else </span><a href="#loc_44_19_44_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_19_44_23&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">)
    where (</span><a name="loc_44_12_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_12_44_18&#39;)"><span class="hl_vardecl"><span class="mpre">server</span></span></a><span class="mpre">,</span><a name="loc_44_19_44_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_19_44_23&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">) </span><a href="#loc_43_9_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_12&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre">


</span><a href="#loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="mpre">client</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">PortNumber</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="hl_fundecl"><span class="mpre">client</span></span></a><span class="mpre"> </span><a name="loc_48_8_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_8_48_14&#39;)"><span class="hl_vardecl"><span class="mpre">server</span></span></a><span class="mpre"> </span><a name="loc_48_15_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_15_48_19&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre"> </span><a name="loc_48_20_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_24&#39;)"><span class="hl_vardecl"><span class="mpre">page</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">withSocketsDo</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_49_5_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_9&#39;)"><span class="hl_vardecl"><span class="mpre">hndl</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">connectTo</span></span><span class="mpre"> </span><a href="#loc_48_8_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_8_48_14&#39;)"><span class="hl_varref"><span class="mpre">server</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PortNumber</span></span><span class="mpre"> </span><a href="#loc_48_15_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_15_48_19&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">)
    let </span><a name="loc_50_9_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_12&#39;)"><span class="hl_fundecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hPutStrLn</span></span><span class="mpre"> </span><a href="#loc_49_5_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_9&#39;)"><span class="hl_varref"><span class="mpre">hndl</span></span></a><span class="mpre"> (</span><a href="#loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r&quot;</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">hSetBuffering</span></span><span class="mpre"> </span><a href="#loc_49_5_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_9&#39;)"><span class="hl_varref"><span class="mpre">hndl</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">NoBuffering</span></span><span class="mpre">

    </span><a href="#loc_50_9_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;GET &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_48_20_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_24&#39;)"><span class="hl_varref"><span class="mpre">page</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; HTTP/1.1&quot;</span></span><span class="mpre">
    </span><a href="#loc_50_9_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Host: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_48_8_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_8_48_14&#39;)"><span class="hl_varref"><span class="mpre">server</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
    </span><a href="#loc_50_9_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Connection: close&quot;</span></span><span class="mpre">
    </span><a href="#loc_50_9_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
    </span><a href="#loc_50_9_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
    </span><a href="#loc_62_1_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_13&#39;)"><span class="hl_varref"><span class="mpre">readResponse</span></span></a><span class="mpre"> </span><a href="#loc_49_5_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_9&#39;)"><span class="hl_varref"><span class="mpre">hndl</span></span></a><span class="mpre">


</span><a href="#loc_62_1_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_13&#39;)"><span class="mpre">readResponse</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Handle</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_62_1_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_13&#39;)"><span class="hl_fundecl"><span class="mpre">readResponse</span></span></a><span class="mpre"> </span><a name="loc_62_14_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_14_62_18&#39;)"><span class="hl_vardecl"><span class="mpre">hndl</span></span></a><span class="mpre"> = do
    </span><a name="loc_63_5_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_11&#39;)"><span class="hl_vardecl"><span class="mpre">closed</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">hIsClosed</span></span><span class="mpre"> </span><a href="#loc_62_14_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_14_62_18&#39;)"><span class="hl_varref"><span class="mpre">hndl</span></span></a><span class="mpre">
    </span><a name="loc_64_5_64_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_8&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">hIsEOF</span></span><span class="mpre"> </span><a href="#loc_62_14_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_14_62_18&#39;)"><span class="hl_varref"><span class="mpre">hndl</span></span></a><span class="mpre">
    if </span><a href="#loc_63_5_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_11&#39;)"><span class="hl_varref"><span class="mpre">closed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_64_5_64_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_8&#39;)"><span class="hl_varref"><span class="mpre">eof</span></span></a><span class="mpre">
        then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
        else do
            </span><a name="loc_68_13_68_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">hGetChar</span></span><span class="mpre"> </span><a href="#loc_62_14_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_14_62_18&#39;)"><span class="hl_varref"><span class="mpre">hndl</span></span></a><span class="mpre">
            </span><a name="loc_69_13_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_13_69_15&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeInterleaveIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_62_1_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_13&#39;)"><span class="hl_varref"><span class="mpre">readResponse</span></span></a><span class="mpre"> </span><a href="#loc_62_14_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_14_62_18&#39;)"><span class="hl_varref"><span class="mpre">hndl</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_68_13_68_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_69_13_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_13_69_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Open a URL (if it starts with @http:\/\/@) or a file otherwise</span></span><span class="mpre">
</span><a href="#loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="mpre">openItem</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="hl_fundecl"><span class="mpre">openItem</span></span></a><span class="mpre"> </span><a name="loc_75_10_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_string"><span class="mpre">&quot;http://&quot;</span></span><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_75_10_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="hl_varref"><span class="mpre">openURL</span></span></a><span class="mpre"> </span><a href="#loc_75_10_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">readFile</span></span><span class="mpre"> </span><a href="#loc_75_10_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span></div></body></html>