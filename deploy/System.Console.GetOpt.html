<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Safe #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  System.Console.GetOpt</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Sven Panne 2002-2005</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This library provides facilities for parsing the command-line options</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in a standalone program.  It is essentially a Haskell port of the GNU </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @getopt@ library.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
Sven Panne &lt;Sven.Panne@informatik.uni-muenchen.de&gt; Oct. 1996 (small
changes Dec. 1997)

Two rather obscure features are missing: The Bash 2.0 non-option hack
(if you don&#39;t already know it, you probably don&#39;t want to hear about
it...) and the recognition of long options with a single dash
(e.g. &#39;-help&#39; is recognised as &#39;--help&#39;, as long as there is no short
option &#39;h&#39;).

Other differences between GNU&#39;s getopt and this implementation:

* To enforce a coherent description of options and arguments, there
  are explanation fields in the option/argument descriptor.

* Error messages are now more informative, but no longer POSIX
  compliant... :-(

And a final Haskell advertisement: The GNU C implementation uses well
over 1100 lines, we need only 195 here, including a 46 line example! 
:-)
-}</span></span><span class="mpre">

module System.Console.GetOpt (
   </span><span class="hl_comment"><span class="mpre">-- * GetOpt</span></span><span class="mpre">
   getOpt, getOpt&#39;,
   usageInfo,
   ArgOrder(..),
   OptDescr(..),
   ArgDescr(..),

   </span><span class="hl_comment"><span class="mpre">-- * Examples</span></span><span class="mpre">

   </span><span class="hl_comment"><span class="mpre">-- |To hopefully illuminate the role of the different data structures,</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- here are the command-line options for a (very simple) compiler,</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- done in two different ways.</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- The difference arises because the type of &#39;getOpt&#39; is</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- parameterized by the type of values derived from flags.</span></span><span class="mpre">

   </span><span class="hl_comment"><span class="mpre">-- ** Interpreting flags as concrete values</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- $example1</span></span><span class="mpre">

   </span><span class="hl_comment"><span class="mpre">-- ** Interpreting flags as transformations of an options record</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- $example2</span></span><span class="mpre">
) where

import Prelude </span><span class="hl_comment"><span class="mpre">-- necessary to get dependencies right</span></span><span class="mpre">

import Data.List ( </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="mpre">isPrefixOf</span></a><span class="mpre">, </span><a href="Data.List.html#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_261_1_261_5&#39;)"><span class="mpre">find</span></a><span class="mpre"> )

</span><span class="hl_comment"><span class="mpre">-- |What to do with options following non-options</span></span><span class="mpre">
data </span><a name="loc_70_6_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_14&#39;)"><span class="hl_tycondecl"><span class="mpre">ArgOrder</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  = </span><a name="loc_71_5_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_17&#39;)"><span class="hl_condecl"><span class="mpre">RequireOrder</span></span></a><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- ^ no option processing after first non-option</span></span><span class="mpre">
  | </span><a name="loc_72_5_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_12&#39;)"><span class="hl_condecl"><span class="mpre">Permute</span></span></a><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">-- ^ freely intersperse options and non-options</span></span><span class="mpre">
  | </span><a name="loc_73_5_73_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_18&#39;)"><span class="hl_condecl"><span class="mpre">ReturnInOrder</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ wrap non-options into options</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-|
Each &#39;OptDescr&#39; describes a single option.

The arguments to &#39;Option&#39; are:

* list of short option characters

* list of long option strings (without \&quot;--\&quot;)

* argument descriptor

* explanation of option for user
-}</span></span><span class="mpre">
data </span><a name="loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tycondecl"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> =              </span><span class="hl_comment"><span class="mpre">-- description of a single options:</span></span><span class="mpre">
   </span><a name="loc_89_4_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_10&#39;)"><span class="hl_condecl"><span class="mpre">Option</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]                </span><span class="hl_comment"><span class="mpre">--    list of short option characters</span></span><span class="mpre">
          [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]              </span><span class="hl_comment"><span class="mpre">--    list of long option strings (without &quot;--&quot;)</span></span><span class="mpre">
          (</span><a href="#loc_96_6_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)          </span><span class="hl_comment"><span class="mpre">--    argument descriptor</span></span><span class="mpre">
          </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">--    explanation of option for user</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Describes whether an option takes an argument or not, and if so</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- how the argument is injected into a value of type @a@.</span></span><span class="mpre">
data </span><a name="loc_96_6_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_14&#39;)"><span class="hl_tycondecl"><span class="mpre">ArgDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
   = </span><a name="loc_97_6_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_11&#39;)"><span class="hl_condecl"><span class="mpre">NoArg</span></span></a><span class="mpre">                   </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^   no argument expected</span></span><span class="mpre">
   | </span><a name="loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_condecl"><span class="mpre">ReqArg</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">       -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^   option requires argument</span></span><span class="mpre">
   | </span><a name="loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_condecl"><span class="mpre">OptArg</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^   optional argument</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_70_6_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgOrder</span></span></a><span class="mpre"> where
    </span><a name="loc_102_5_102_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> _ </span><a href="#loc_71_5_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_17&#39;)"><span class="hl_conref"><span class="mpre">RequireOrder</span></span></a><span class="mpre">      = </span><a href="#loc_71_5_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_17&#39;)"><span class="hl_conref"><span class="mpre">RequireOrder</span></span></a><span class="mpre">
    </span><a href="#loc_102_5_102_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> _ </span><a href="#loc_72_5_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_12&#39;)"><span class="hl_conref"><span class="mpre">Permute</span></span></a><span class="mpre">           = </span><a href="#loc_72_5_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_12&#39;)"><span class="hl_conref"><span class="mpre">Permute</span></span></a><span class="mpre">
    </span><a href="#loc_102_5_102_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_73_5_73_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_18&#39;)"><span class="hl_conref"><span class="mpre">ReturnInOrder</span></span></a><span class="mpre"> </span><a name="loc_104_27_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_27_104_28&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) = </span><a href="#loc_73_5_73_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_18&#39;)"><span class="hl_conref"><span class="mpre">ReturnInOrder</span></span></a><span class="mpre"> (</span><a href="#loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_104_27_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_27_104_28&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_107_10_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_10_107_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_89_4_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> </span><a name="loc_107_20_107_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_20_107_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_107_22_107_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_22_107_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_107_24_107_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_24_107_32&#39;)"><span class="hl_vardecl"><span class="mpre">argDescr</span></span></a><span class="mpre"> </span><a name="loc_107_33_107_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_33_107_34&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) = </span><a href="#loc_89_4_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> </span><a href="#loc_107_20_107_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_20_107_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_107_22_107_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_22_107_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_107_10_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_10_107_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_107_24_107_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_24_107_32&#39;)"><span class="hl_varref"><span class="mpre">argDescr</span></span></a><span class="mpre">) </span><a href="#loc_107_33_107_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_33_107_34&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_96_6_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgDescr</span></span></a><span class="mpre"> where
    </span><a name="loc_110_5_110_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_5_110_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_110_10_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_10_110_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_97_6_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre"> </span><a name="loc_110_19_110_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_19_110_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">)    = </span><a href="#loc_97_6_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre"> (</span><a href="#loc_110_10_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_10_110_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_110_19_110_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_19_110_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
    </span><a href="#loc_110_5_110_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_5_110_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_111_10_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_10_111_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> </span><a name="loc_111_20_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_20_111_21&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_111_22_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> (</span><a href="#loc_111_10_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_10_111_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_111_20_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_20_111_21&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><a href="#loc_111_22_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><a href="#loc_110_5_110_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_5_110_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_112_10_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_10_112_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> </span><a name="loc_112_20_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_21&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_112_22_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_22_112_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> (</span><a href="#loc_112_10_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_10_112_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_112_20_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_21&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><a href="#loc_112_22_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_22_112_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

data </span><a name="loc_114_6_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_6_114_13&#39;)"><span class="hl_tycondecl"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- kind of cmd line arg (internal use only):</span></span><span class="mpre">
   = </span><a name="loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_condecl"><span class="mpre">Opt</span></span></a><span class="mpre">       </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">--    an option</span></span><span class="mpre">
   | </span><a name="loc_116_6_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_14&#39;)"><span class="hl_condecl"><span class="mpre">UnreqOpt</span></span></a><span class="mpre">  </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">--    an un-recognized option</span></span><span class="mpre">
   | </span><a name="loc_117_6_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_12&#39;)"><span class="hl_condecl"><span class="mpre">NonOpt</span></span></a><span class="mpre">    </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">--    a non-option</span></span><span class="mpre">
   | </span><a name="loc_118_6_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_6_118_15&#39;)"><span class="hl_condecl"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">                  </span><span class="hl_comment"><span class="mpre">--    end-of-options marker (i.e. &quot;--&quot;)</span></span><span class="mpre">
   | </span><a name="loc_119_6_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_6_119_12&#39;)"><span class="hl_condecl"><span class="mpre">OptErr</span></span></a><span class="mpre">    </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">--    something went wrong...</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Return a string describing the usage of a command, derived from</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the header (first argument) and the options described by the </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- second argument.</span></span><span class="mpre">
</span><a href="#loc_127_1_127_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_10&#39;)"><span class="mpre">usageInfo</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">                    </span><span class="hl_comment"><span class="mpre">-- header</span></span><span class="mpre">
          -&gt; [</span><a href="#loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]              </span><span class="hl_comment"><span class="mpre">-- option descriptors</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">                    </span><span class="hl_comment"><span class="mpre">-- nicely formatted decription of options</span></span><span class="mpre">
</span><a name="loc_127_1_127_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_10&#39;)"><span class="hl_fundecl"><span class="mpre">usageInfo</span></span></a><span class="mpre"> </span><a name="loc_127_11_127_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_11_127_17&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> </span><a name="loc_127_18_127_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_18_127_26&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="hl_varref"><span class="mpre">unlines</span></span></a><span class="mpre"> (</span><a href="#loc_127_11_127_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_11_127_17&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_129_10_129_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_10_129_15&#39;)"><span class="hl_varref"><span class="mpre">table</span></span></a><span class="mpre">)
   where (</span><a name="loc_128_11_128_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_11_128_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">,</span><a name="loc_128_14_128_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_14_128_16&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre">,</span><a name="loc_128_17_128_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_17_128_19&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">)     = (</span><span class="hl_varref"><span class="mpre">unzip3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_135_1_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_7&#39;)"><span class="hl_varref"><span class="mpre">fmtOpt</span></span></a><span class="mpre">) </span><a href="#loc_127_18_127_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_18_127_26&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">
         </span><a name="loc_129_10_129_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_10_129_15&#39;)"><span class="hl_vardecl"><span class="mpre">table</span></span></a><span class="mpre">          = </span><span class="hl_varref"><span class="mpre">zipWith3</span></span><span class="mpre"> </span><a href="#loc_130_10_130_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_10_130_15&#39;)"><span class="hl_varref"><span class="mpre">paste</span></span></a><span class="mpre"> (</span><a href="#loc_131_10_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_10_131_17&#39;)"><span class="hl_varref"><span class="mpre">sameLen</span></span></a><span class="mpre"> </span><a href="#loc_128_11_128_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_11_128_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">) (</span><a href="#loc_131_10_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_10_131_17&#39;)"><span class="hl_varref"><span class="mpre">sameLen</span></span></a><span class="mpre"> </span><a href="#loc_128_14_128_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_14_128_16&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">) </span><a href="#loc_128_17_128_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_17_128_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
         </span><a name="loc_130_10_130_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_10_130_15&#39;)"><span class="hl_fundecl"><span class="mpre">paste</span></span></a><span class="mpre"> </span><a name="loc_130_16_130_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_16_130_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_130_18_130_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_18_130_19&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_130_20_130_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_20_130_21&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">    = </span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_130_16_130_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_16_130_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_130_18_130_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_18_130_19&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_130_20_130_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_20_130_21&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
         </span><a name="loc_131_10_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_10_131_17&#39;)"><span class="hl_fundecl"><span class="mpre">sameLen</span></span></a><span class="mpre"> </span><a name="loc_131_18_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_18_131_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">     = </span><a href="#loc_132_10_132_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_10_132_19&#39;)"><span class="hl_varref"><span class="mpre">flushLeft</span></span></a><span class="mpre"> ((</span><a href="Data.List.html#loc_523_1_523_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_523_1_523_8&#39;)"><span class="hl_varref"><span class="mpre">maximum</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre">) </span><a href="#loc_131_18_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_18_131_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_131_18_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_18_131_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
         </span><a name="loc_132_10_132_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_10_132_19&#39;)"><span class="hl_fundecl"><span class="mpre">flushLeft</span></span></a><span class="mpre"> </span><a name="loc_132_20_132_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_20_132_21&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_132_22_132_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_22_132_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = [ </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_132_20_132_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_20_132_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_132_56_132_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_56_132_57&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre">) | </span><a name="loc_132_56_132_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_56_132_57&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_132_22_132_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_22_132_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> ]

</span><a href="#loc_135_1_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_7&#39;)"><span class="mpre">fmtOpt</span></a><span class="mpre"> :: </span><a href="#loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_135_1_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_7&#39;)"><span class="hl_fundecl"><span class="mpre">fmtOpt</span></span></a><span class="mpre"> (</span><a href="#loc_89_4_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> </span><a name="loc_135_16_135_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_16_135_19&#39;)"><span class="hl_vardecl"><span class="mpre">sos</span></span></a><span class="mpre"> </span><a name="loc_135_20_135_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_20_135_23&#39;)"><span class="hl_vardecl"><span class="mpre">los</span></span></a><span class="mpre"> </span><a name="loc_135_24_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_24_135_26&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre"> </span><a name="loc_135_27_135_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_27_135_32&#39;)"><span class="hl_vardecl"><span class="mpre">descr</span></span></a><span class="mpre">) =
   case </span><a href="Data.List.html#loc_1044_1_1044_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1044_1_1044_6&#39;)"><span class="hl_varref"><span class="mpre">lines</span></span></a><span class="mpre"> </span><a href="#loc_135_27_135_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_27_135_32&#39;)"><span class="hl_varref"><span class="mpre">descr</span></span></a><span class="mpre"> of
     []     -&gt; [(</span><a href="#loc_142_10_142_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_10_142_16&#39;)"><span class="hl_varref"><span class="mpre">sosFmt</span></span></a><span class="mpre">,</span><a href="#loc_143_10_143_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_10_143_16&#39;)"><span class="hl_varref"><span class="mpre">losFmt</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)]
     (</span><a name="loc_138_7_138_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_7_138_8&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_138_9_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_11&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">) -&gt;  (</span><a href="#loc_142_10_142_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_10_142_16&#39;)"><span class="hl_varref"><span class="mpre">sosFmt</span></span></a><span class="mpre">,</span><a href="#loc_143_10_143_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_10_143_16&#39;)"><span class="hl_varref"><span class="mpre">losFmt</span></span></a><span class="mpre">,</span><a href="#loc_138_7_138_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_7_138_8&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> [ (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">,</span><a href="#loc_138_52_138_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_52_138_54&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">) | </span><a name="loc_138_52_138_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_52_138_54&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_138_9_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_11&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre"> ]
   where </span><a name="loc_139_10_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_15&#39;)"><span class="hl_fundecl"><span class="mpre">sepBy</span></span></a><span class="mpre"> _  []     = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
         </span><a href="#loc_139_10_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_15&#39;)"><span class="hl_fundecl"><span class="mpre">sepBy</span></span></a><span class="mpre"> _  [</span><a name="loc_140_20_140_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_20_140_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">]    = </span><a href="#loc_140_20_140_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_20_140_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
         </span><a href="#loc_139_10_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_15&#39;)"><span class="hl_fundecl"><span class="mpre">sepBy</span></span></a><span class="mpre"> </span><a name="loc_141_16_141_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_16_141_18&#39;)"><span class="hl_vardecl"><span class="mpre">ch</span></span></a><span class="mpre"> (</span><a name="loc_141_20_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_20_141_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_141_22_141_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_22_141_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_141_20_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_20_141_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_141_16_141_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_16_141_18&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_139_10_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_15&#39;)"><span class="hl_varref"><span class="mpre">sepBy</span></span></a><span class="mpre"> </span><a href="#loc_141_16_141_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_16_141_18&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><a href="#loc_141_22_141_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_22_141_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
         </span><a name="loc_142_10_142_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_10_142_16&#39;)"><span class="hl_vardecl"><span class="mpre">sosFmt</span></span></a><span class="mpre"> = </span><a href="#loc_139_10_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_15&#39;)"><span class="hl_varref"><span class="mpre">sepBy</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_146_1_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_9&#39;)"><span class="hl_varref"><span class="mpre">fmtShort</span></span></a><span class="mpre"> </span><a href="#loc_135_24_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_24_135_26&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">) </span><a href="#loc_135_16_135_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_16_135_19&#39;)"><span class="hl_varref"><span class="mpre">sos</span></span></a><span class="mpre">)
         </span><a name="loc_143_10_143_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_10_143_16&#39;)"><span class="hl_vardecl"><span class="mpre">losFmt</span></span></a><span class="mpre"> = </span><a href="#loc_139_10_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_15&#39;)"><span class="hl_varref"><span class="mpre">sepBy</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_151_1_151_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_8&#39;)"><span class="hl_varref"><span class="mpre">fmtLong</span></span></a><span class="mpre">  </span><a href="#loc_135_24_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_24_135_26&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">) </span><a href="#loc_135_20_135_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_20_135_23&#39;)"><span class="hl_varref"><span class="mpre">los</span></span></a><span class="mpre">)

</span><a href="#loc_146_1_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_9&#39;)"><span class="mpre">fmtShort</span></a><span class="mpre"> :: </span><a href="#loc_96_6_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_146_1_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmtShort</span></span></a><span class="mpre"> (</span><a href="#loc_97_6_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  _   ) </span><a name="loc_146_24_146_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_24_146_26&#39;)"><span class="hl_vardecl"><span class="mpre">so</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_146_24_146_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_24_146_26&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre">]
</span><a href="#loc_146_1_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmtShort</span></span></a><span class="mpre"> (</span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> _ </span><a name="loc_147_20_147_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_20_147_22&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre">) </span><a name="loc_147_24_147_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_24_147_26&#39;)"><span class="hl_vardecl"><span class="mpre">so</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_147_24_147_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_24_147_26&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_147_20_147_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_20_147_22&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">
</span><a href="#loc_146_1_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmtShort</span></span></a><span class="mpre"> (</span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> _ </span><a name="loc_148_20_148_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_20_148_22&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre">) </span><a name="loc_148_24_148_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_24_148_26&#39;)"><span class="hl_vardecl"><span class="mpre">so</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_148_24_148_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_24_148_26&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;[&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_148_20_148_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_20_148_22&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">

</span><a href="#loc_151_1_151_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_8&#39;)"><span class="mpre">fmtLong</span></a><span class="mpre"> :: </span><a href="#loc_96_6_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_151_1_151_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_8&#39;)"><span class="hl_fundecl"><span class="mpre">fmtLong</span></span></a><span class="mpre"> (</span><a href="#loc_97_6_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  _   ) </span><a name="loc_151_23_151_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_23_151_25&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_151_23_151_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_23_151_25&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre">
</span><a href="#loc_151_1_151_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_8&#39;)"><span class="hl_fundecl"><span class="mpre">fmtLong</span></span></a><span class="mpre"> (</span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> _ </span><a name="loc_152_19_152_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_19_152_21&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre">) </span><a name="loc_152_23_152_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_23_152_25&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_152_23_152_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_23_152_25&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_152_19_152_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_19_152_21&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">
</span><a href="#loc_151_1_151_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_8&#39;)"><span class="hl_fundecl"><span class="mpre">fmtLong</span></span></a><span class="mpre"> (</span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> _ </span><a name="loc_153_19_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_21&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre">) </span><a name="loc_153_23_153_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_23_153_25&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_153_23_153_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_23_153_25&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;[=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_153_19_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_21&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-|
Process the command-line, and return the list of values that matched
(and those that didn\&#39;t). The arguments are:

* The order requirements (see &#39;ArgOrder&#39;)

* The option descriptions (see &#39;OptDescr&#39;)

* The actual command line arguments (presumably got from 
  &#39;System.Environment.getArgs&#39;).

&#39;getOpt&#39; returns a triple consisting of the option arguments, a list
of non-options, and a list of error messages.
-}</span></span><span class="mpre">
</span><a href="#loc_173_1_173_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_7&#39;)"><span class="mpre">getOpt</span></a><span class="mpre"> :: </span><a href="#loc_70_6_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgOrder</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- non-option handling</span></span><span class="mpre">
       -&gt; [</span><a href="#loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]                 </span><span class="hl_comment"><span class="mpre">-- option descriptors</span></span><span class="mpre">
       -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]                     </span><span class="hl_comment"><span class="mpre">-- the command-line arguments</span></span><span class="mpre">
       -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">],[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">],[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])      </span><span class="hl_comment"><span class="mpre">-- (options,non-options,error messages)</span></span><span class="mpre">
</span><a name="loc_173_1_173_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_7&#39;)"><span class="hl_fundecl"><span class="mpre">getOpt</span></span></a><span class="mpre"> </span><a name="loc_173_8_173_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_8_173_16&#39;)"><span class="hl_vardecl"><span class="mpre">ordering</span></span></a><span class="mpre"> </span><a name="loc_173_17_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_17_173_25&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> </span><a name="loc_173_26_173_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_26_173_30&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> = (</span><a href="#loc_174_11_174_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_11_174_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_174_14_174_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_14_174_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_174_20_174_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_20_174_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_256_1_256_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_9&#39;)"><span class="hl_varref"><span class="mpre">errUnrec</span></span></a><span class="mpre"> </span><a href="#loc_174_17_174_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_17_174_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">)
   where (</span><a name="loc_174_11_174_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_11_174_13&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">,</span><a name="loc_174_14_174_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_14_174_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_174_17_174_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_17_174_19&#39;)"><span class="hl_vardecl"><span class="mpre">us</span></span></a><span class="mpre">,</span><a name="loc_174_20_174_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_20_174_22&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">) = </span><a href="#loc_185_1_185_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_8&#39;)"><span class="hl_varref"><span class="mpre">getOpt&#39;</span></span></a><span class="mpre"> </span><a href="#loc_173_8_173_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_8_173_16&#39;)"><span class="hl_varref"><span class="mpre">ordering</span></span></a><span class="mpre"> </span><a href="#loc_173_17_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_17_173_25&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre"> </span><a href="#loc_173_26_173_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_26_173_30&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-|
This is almost the same as &#39;getOpt&#39;, but returns a quadruple
consisting of the option arguments, a list of non-options, a list of
unrecognized options, and a list of error messages.
-}</span></span><span class="mpre">
</span><a href="#loc_185_1_185_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_8&#39;)"><span class="mpre">getOpt&#39;</span></a><span class="mpre"> :: </span><a href="#loc_70_6_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgOrder</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                         </span><span class="hl_comment"><span class="mpre">-- non-option handling</span></span><span class="mpre">
        -&gt; [</span><a href="#loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]                       </span><span class="hl_comment"><span class="mpre">-- option descriptors</span></span><span class="mpre">
        -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]                           </span><span class="hl_comment"><span class="mpre">-- the command-line arguments</span></span><span class="mpre">
        -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">],[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">], [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] ,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]) </span><span class="hl_comment"><span class="mpre">-- (options,non-options,unrecognized,error messages)</span></span><span class="mpre">
</span><a name="loc_185_1_185_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_8&#39;)"><span class="hl_fundecl"><span class="mpre">getOpt&#39;</span></span></a><span class="mpre"> _        _        []         =  ([],[],[],[])
</span><a href="#loc_185_1_185_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_8&#39;)"><span class="hl_fundecl"><span class="mpre">getOpt&#39;</span></span></a><span class="mpre"> </span><a name="loc_186_9_186_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_17&#39;)"><span class="hl_vardecl"><span class="mpre">ordering</span></span></a><span class="mpre"> </span><a name="loc_186_18_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_18_186_26&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> (</span><a name="loc_186_28_186_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_28_186_31&#39;)"><span class="hl_vardecl"><span class="mpre">arg</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_186_32_186_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_32_186_36&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre">) = </span><a href="#loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_varref"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> </span><a href="#loc_197_11_197_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_11_197_14&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre"> </span><a href="#loc_186_9_186_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_17&#39;)"><span class="hl_varref"><span class="mpre">ordering</span></span></a><span class="mpre">
   where </span><a name="loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> </span><a name="loc_187_27_187_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_27_187_28&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">)      _                 = (</span><a href="#loc_187_27_187_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_27_187_28&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_198_11_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_11_198_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_198_14_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_14_198_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_198_17_198_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_198_20_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_20_198_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
         </span><a href="#loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_116_6_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_14&#39;)"><span class="hl_conref"><span class="mpre">UnreqOpt</span></span></a><span class="mpre"> </span><a name="loc_188_32_188_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_32_188_33&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">) _                 = (</span><a href="#loc_198_11_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_11_198_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_198_14_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_14_198_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_188_32_188_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_32_188_33&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_198_17_198_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_198_20_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_20_198_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
         </span><a href="#loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_117_6_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_12&#39;)"><span class="hl_conref"><span class="mpre">NonOpt</span></span></a><span class="mpre"> </span><a name="loc_189_30_189_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_30_189_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)   </span><a href="#loc_71_5_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_17&#39;)"><span class="hl_conref"><span class="mpre">RequireOrder</span></span></a><span class="mpre">      = ([],</span><a href="#loc_189_30_189_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_30_189_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_197_15_197_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_15_197_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">,[],[])
         </span><a href="#loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_117_6_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_12&#39;)"><span class="hl_conref"><span class="mpre">NonOpt</span></span></a><span class="mpre"> </span><a name="loc_190_30_190_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_30_190_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)   </span><a href="#loc_72_5_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_12&#39;)"><span class="hl_conref"><span class="mpre">Permute</span></span></a><span class="mpre">           = (</span><a href="#loc_198_11_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_11_198_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_190_30_190_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_30_190_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_198_14_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_14_198_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_198_17_198_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_198_20_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_20_198_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
         </span><a href="#loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_117_6_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_12&#39;)"><span class="hl_conref"><span class="mpre">NonOpt</span></span></a><span class="mpre"> </span><a name="loc_191_30_191_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_30_191_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)   (</span><a href="#loc_73_5_73_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_18&#39;)"><span class="hl_conref"><span class="mpre">ReturnInOrder</span></span></a><span class="mpre"> </span><a name="loc_191_50_191_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_50_191_51&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = (</span><a href="#loc_191_50_191_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_50_191_51&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_191_30_191_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_30_191_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_198_11_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_11_198_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">, </span><a href="#loc_198_14_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_14_198_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_198_17_198_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_198_20_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_20_198_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
         </span><a href="#loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> </span><a href="#loc_118_6_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_6_118_15&#39;)"><span class="hl_conref"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">    </span><a href="#loc_71_5_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_17&#39;)"><span class="hl_conref"><span class="mpre">RequireOrder</span></span></a><span class="mpre">      = ([],</span><a href="#loc_197_15_197_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_15_197_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">,[],[])
         </span><a href="#loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> </span><a href="#loc_118_6_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_6_118_15&#39;)"><span class="hl_conref"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">    </span><a href="#loc_72_5_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_12&#39;)"><span class="hl_conref"><span class="mpre">Permute</span></span></a><span class="mpre">           = ([],</span><a href="#loc_197_15_197_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_15_197_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">,[],[])
         </span><a href="#loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> </span><a href="#loc_118_6_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_6_118_15&#39;)"><span class="hl_conref"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">    (</span><a href="#loc_73_5_73_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_18&#39;)"><span class="hl_conref"><span class="mpre">ReturnInOrder</span></span></a><span class="mpre"> </span><a name="loc_194_50_194_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_50_194_51&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_194_50_194_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_50_194_51&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_197_15_197_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_15_197_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">,[],[],[])
         </span><a href="#loc_187_10_187_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_119_6_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_6_119_12&#39;)"><span class="hl_conref"><span class="mpre">OptErr</span></span></a><span class="mpre"> </span><a name="loc_195_30_195_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_30_195_31&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)   _                 = (</span><a href="#loc_198_11_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_11_198_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_198_14_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_14_198_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_198_17_198_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_195_30_195_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_30_195_31&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_198_20_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_20_198_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)

         (</span><a name="loc_197_11_197_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_11_197_14&#39;)"><span class="hl_vardecl"><span class="mpre">opt</span></span></a><span class="mpre">,</span><a name="loc_197_15_197_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_15_197_19&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><a href="#loc_202_1_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_8&#39;)"><span class="hl_varref"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><a href="#loc_186_28_186_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_28_186_31&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><a href="#loc_186_32_186_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_32_186_36&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_186_18_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_18_186_26&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">
         (</span><a name="loc_198_11_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_11_198_13&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">,</span><a name="loc_198_14_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_14_198_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_198_17_198_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_19&#39;)"><span class="hl_vardecl"><span class="mpre">us</span></span></a><span class="mpre">,</span><a name="loc_198_20_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_20_198_22&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">) = </span><a href="#loc_185_1_185_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_8&#39;)"><span class="hl_varref"><span class="mpre">getOpt&#39;</span></span></a><span class="mpre"> </span><a href="#loc_186_9_186_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_17&#39;)"><span class="hl_varref"><span class="mpre">ordering</span></span></a><span class="mpre"> </span><a href="#loc_186_18_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_18_186_26&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre"> </span><a href="#loc_197_15_197_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_15_197_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- take a look at the next cmd line arg and decide what to do with it</span></span><span class="mpre">
</span><a href="#loc_202_1_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_8&#39;)"><span class="mpre">getNext</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><a href="#loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><a href="#loc_114_6_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_6_114_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])
</span><a name="loc_202_1_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_8&#39;)"><span class="hl_fundecl"><span class="mpre">getNext</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]) </span><a name="loc_202_22_202_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_22_202_26&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> _        = (</span><a href="#loc_118_6_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_6_118_15&#39;)"><span class="hl_conref"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">,</span><a href="#loc_202_22_202_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_22_202_26&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
</span><a href="#loc_202_1_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_8&#39;)"><span class="hl_fundecl"><span class="mpre">getNext</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_203_18_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_203_22_203_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_22_203_26&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_203_27_203_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_27_203_35&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><a href="#loc_209_1_209_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_8&#39;)"><span class="hl_varref"><span class="mpre">longOpt</span></span></a><span class="mpre"> </span><a href="#loc_203_18_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_203_22_203_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_22_203_26&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_203_27_203_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_27_203_35&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">
</span><a href="#loc_202_1_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_8&#39;)"><span class="hl_fundecl"><span class="mpre">getNext</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_204_15_204_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_15_204_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_204_18_204_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_18_204_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_204_22_204_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_22_204_26&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_204_27_204_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_27_204_35&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><a href="#loc_230_1_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_9&#39;)"><span class="hl_varref"><span class="mpre">shortOpt</span></span></a><span class="mpre"> </span><a href="#loc_204_15_204_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_15_204_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_204_18_204_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_18_204_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_204_22_204_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_22_204_26&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_204_27_204_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_27_204_35&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">
</span><a href="#loc_202_1_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_8&#39;)"><span class="hl_fundecl"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><a name="loc_205_9_205_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">            </span><a name="loc_205_22_205_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_22_205_26&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> _        = (</span><a href="#loc_117_6_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_12&#39;)"><span class="hl_conref"><span class="mpre">NonOpt</span></span></a><span class="mpre"> </span><a href="#loc_205_9_205_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_205_22_205_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_22_205_26&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- handle long option</span></span><span class="mpre">
</span><a href="#loc_209_1_209_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_8&#39;)"><span class="mpre">longOpt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><a href="#loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><a href="#loc_114_6_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_6_114_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])
</span><a name="loc_209_1_209_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_8&#39;)"><span class="hl_fundecl"><span class="mpre">longOpt</span></span></a><span class="mpre"> </span><a name="loc_209_9_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_11&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a name="loc_209_12_209_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_12_209_14&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> </span><a name="loc_209_15_209_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_15_209_23&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><a href="#loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_varref"><span class="mpre">long</span></span></a><span class="mpre"> </span><a href="#loc_215_10_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_13&#39;)"><span class="hl_varref"><span class="mpre">ads</span></span></a><span class="mpre"> </span><a href="#loc_210_15_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_18&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><a href="#loc_209_12_209_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_12_209_14&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
   where (</span><a name="loc_210_11_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_11_210_14&#39;)"><span class="hl_vardecl"><span class="mpre">opt</span></span></a><span class="mpre">,</span><a name="loc_210_15_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_18&#39;)"><span class="hl_vardecl"><span class="mpre">arg</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre">) </span><a href="#loc_209_9_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_11&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">
         </span><a name="loc_211_10_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_10_211_17&#39;)"><span class="hl_fundecl"><span class="mpre">getWith</span></span></a><span class="mpre"> </span><a name="loc_211_18_211_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_18_211_19&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = [ </span><a href="#loc_211_28_211_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_28_211_29&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> | </span><a name="loc_211_28_211_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_28_211_29&#39;)"><span class="hl_specname"><span class="mpre">o</span></span></a><span class="mpre">@(</span><a href="#loc_89_4_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> _ </span><a name="loc_211_40_211_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_40_211_42&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> _ _) &lt;- </span><a href="#loc_209_15_209_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_15_209_23&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">
                         , </span><a href="Data.List.html#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_261_1_261_5&#39;)"><span class="hl_varref"><span class="mpre">find</span></span></a><span class="mpre"> (</span><a href="#loc_211_18_211_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_18_211_19&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_210_11_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_11_210_14&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre">) </span><a href="#loc_211_40_211_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_40_211_42&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> ]
         </span><a name="loc_213_10_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_10_213_15&#39;)"><span class="hl_vardecl"><span class="mpre">exact</span></span></a><span class="mpre">     = </span><a href="#loc_211_10_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_10_211_17&#39;)"><span class="hl_varref"><span class="mpre">getWith</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre">
         </span><a name="loc_214_10_214_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_10_214_17&#39;)"><span class="hl_vardecl"><span class="mpre">options</span></span></a><span class="mpre">   = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_213_10_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_10_213_15&#39;)"><span class="hl_varref"><span class="mpre">exact</span></span></a><span class="mpre"> then </span><a href="#loc_211_10_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_10_211_17&#39;)"><span class="hl_varref"><span class="mpre">getWith</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_varref"><span class="mpre">isPrefixOf</span></span></a><span class="mpre"> else </span><a href="#loc_213_10_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_10_213_15&#39;)"><span class="hl_varref"><span class="mpre">exact</span></span></a><span class="mpre">
         </span><a name="loc_215_10_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_13&#39;)"><span class="hl_vardecl"><span class="mpre">ads</span></span></a><span class="mpre">       = [ </span><a href="#loc_215_40_215_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_40_215_42&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> | </span><a href="#loc_89_4_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> _ _ </span><a name="loc_215_40_215_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_40_215_42&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre"> _ &lt;- </span><a href="#loc_214_10_214_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_10_214_17&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> ]
         </span><a name="loc_216_10_216_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_16&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre">    = (</span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_210_11_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_11_210_14&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre">)

         </span><a name="loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)      _        </span><a name="loc_218_37_218_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_37_218_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_249_1_249_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_9&#39;)"><span class="hl_varref"><span class="mpre">errAmbig</span></span></a><span class="mpre"> </span><a href="#loc_214_10_214_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_10_214_17&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> </span><a href="#loc_216_10_216_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,</span><a href="#loc_218_37_218_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_37_218_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_97_6_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  </span><a name="loc_219_23_219_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_23_219_24&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  ] []       </span><a name="loc_219_37_219_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_37_219_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> </span><a href="#loc_219_23_219_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_23_219_24&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_219_37_219_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_37_219_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_97_6_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  _  ] (</span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)  </span><a name="loc_220_37_220_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_37_220_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_259_1_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_1_259_9&#39;)"><span class="hl_varref"><span class="mpre">errNoArg</span></span></a><span class="mpre"> </span><a href="#loc_216_10_216_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,</span><a href="#loc_220_37_220_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_37_220_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> _ </span><a name="loc_221_25_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_25_221_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">] []       []       = (</span><a href="#loc_253_1_253_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_7&#39;)"><span class="hl_varref"><span class="mpre">errReq</span></span></a><span class="mpre"> </span><a href="#loc_221_25_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_25_221_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_216_10_216_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,[])
         </span><a href="#loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> </span><a name="loc_222_23_222_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_23_222_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _] []       (</span><a name="loc_222_38_222_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_38_222_39&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_222_40_222_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_40_222_44&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_222_23_222_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_23_222_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_222_38_222_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_38_222_39&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">),</span><a href="#loc_222_40_222_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_40_222_44&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> </span><a name="loc_223_23_223_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_23_223_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _] (</span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_223_33_223_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_33_223_35&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_223_37_223_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_37_223_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_223_23_223_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_23_223_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_223_33_223_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_33_223_35&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">),</span><a href="#loc_223_37_223_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_37_223_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> </span><a name="loc_224_23_224_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_23_224_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _] []       </span><a name="loc_224_37_224_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_37_224_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_224_23_224_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_23_224_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">),</span><a href="#loc_224_37_224_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_37_224_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> </span><a name="loc_225_23_225_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_23_225_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _] (</span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_225_33_225_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_33_225_35&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_225_37_225_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_37_225_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_225_23_225_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_23_225_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_225_33_225_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_33_225_35&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)),</span><a href="#loc_225_37_225_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_37_225_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_218_10_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> _            _        </span><a name="loc_226_37_226_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_37_226_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_116_6_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_14&#39;)"><span class="hl_conref"><span class="mpre">UnreqOpt</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_209_9_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_11&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">),</span><a href="#loc_226_37_226_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_37_226_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- handle short option</span></span><span class="mpre">
</span><a href="#loc_230_1_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_9&#39;)"><span class="mpre">shortOpt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><a href="#loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><a href="#loc_114_6_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_6_114_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])
</span><a name="loc_230_1_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_9&#39;)"><span class="hl_fundecl"><span class="mpre">shortOpt</span></span></a><span class="mpre"> </span><a name="loc_230_10_230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_10_230_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_230_12_230_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_12_230_14&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> </span><a name="loc_230_15_230_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> </span><a name="loc_230_18_230_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_18_230_26&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_varref"><span class="mpre">short</span></span></a><span class="mpre"> </span><a href="#loc_232_9_232_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_9_232_12&#39;)"><span class="hl_varref"><span class="mpre">ads</span></span></a><span class="mpre"> </span><a href="#loc_230_12_230_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_12_230_14&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><a href="#loc_230_15_230_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
  where </span><a name="loc_231_9_231_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_9_231_16&#39;)"><span class="hl_vardecl"><span class="mpre">options</span></span></a><span class="mpre"> = [ </span><a href="#loc_231_26_231_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_26_231_27&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">  | </span><a name="loc_231_26_231_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_26_231_27&#39;)"><span class="hl_specname"><span class="mpre">o</span></span></a><span class="mpre">@(</span><a href="#loc_89_4_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> </span><a name="loc_231_36_231_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_36_231_38&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> _ _ _) &lt;- </span><a href="#loc_230_18_230_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_18_230_26&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">, </span><a name="loc_231_59_231_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_59_231_60&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_231_36_231_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_36_231_38&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">, </span><a href="#loc_230_10_230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_10_230_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_231_59_231_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_59_231_60&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> ]
        </span><a name="loc_232_9_232_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_9_232_12&#39;)"><span class="hl_vardecl"><span class="mpre">ads</span></span></a><span class="mpre">     = [ </span><a href="#loc_232_37_232_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_37_232_39&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> | </span><a href="#loc_89_4_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> _ _ </span><a name="loc_232_37_232_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_37_232_39&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre"> _ &lt;- </span><a href="#loc_231_9_231_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_9_231_16&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> ]
        </span><a name="loc_233_9_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_9_233_15&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre">  = </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[</span><a href="#loc_230_10_230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_10_230_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">]

        </span><a name="loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)        _  </span><a name="loc_235_33_235_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_33_235_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_249_1_249_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_9&#39;)"><span class="hl_varref"><span class="mpre">errAmbig</span></span></a><span class="mpre"> </span><a href="#loc_231_9_231_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_9_231_16&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> </span><a href="#loc_233_9_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_9_233_15&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,</span><a href="#loc_235_33_235_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_33_235_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_97_6_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  </span><a name="loc_236_23_236_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_23_236_24&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) [] </span><a name="loc_236_33_236_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_33_236_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> </span><a href="#loc_236_23_236_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_23_236_24&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_236_33_236_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_33_236_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_97_6_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  </span><a name="loc_237_23_237_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_23_237_24&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) </span><a name="loc_237_30_237_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_30_237_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_237_33_237_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_33_237_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> </span><a href="#loc_237_23_237_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_23_237_24&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,(</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_237_30_237_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_30_237_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_237_33_237_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_33_237_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> _ </span><a name="loc_238_25_238_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_25_238_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) [] []       = (</span><a href="#loc_253_1_253_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_7&#39;)"><span class="hl_varref"><span class="mpre">errReq</span></span></a><span class="mpre"> </span><a href="#loc_238_25_238_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_25_238_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_233_9_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_9_233_15&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,[])
        </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> </span><a name="loc_239_23_239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_23_239_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) [] (</span><a name="loc_239_34_239_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_34_239_35&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_239_36_239_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_36_239_40&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_239_23_239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_23_239_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_239_34_239_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_34_239_35&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">),</span><a href="#loc_239_36_239_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_36_239_40&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_98_6_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> </span><a name="loc_240_23_240_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_23_240_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) </span><a name="loc_240_30_240_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_30_240_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_240_33_240_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_33_240_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_240_23_240_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_23_240_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_240_30_240_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_30_240_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">),</span><a href="#loc_240_33_240_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_33_240_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> </span><a name="loc_241_23_241_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_23_241_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) [] </span><a name="loc_241_33_241_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_33_241_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_241_23_241_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_23_241_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">),</span><a href="#loc_241_33_241_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_33_241_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> </span><a name="loc_242_23_242_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_23_242_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) </span><a name="loc_242_30_242_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_30_242_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_242_33_242_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_33_242_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_115_6_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_242_23_242_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_23_242_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_242_30_242_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_30_242_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)),</span><a href="#loc_242_33_242_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_33_242_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> []             [] </span><a name="loc_243_33_243_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_33_243_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_116_6_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_14&#39;)"><span class="hl_conref"><span class="mpre">UnreqOpt</span></span></a><span class="mpre"> </span><a href="#loc_233_9_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_9_233_15&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,</span><a href="#loc_243_33_243_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_33_243_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_235_9_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> []             </span><a name="loc_244_30_244_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_30_244_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_244_33_244_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_33_244_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_116_6_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_14&#39;)"><span class="hl_conref"><span class="mpre">UnreqOpt</span></span></a><span class="mpre"> </span><a href="#loc_233_9_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_9_233_15&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,(</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_244_30_244_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_30_244_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_244_33_244_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_33_244_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- miscellaneous error formatting</span></span><span class="mpre">

</span><a href="#loc_249_1_249_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_9&#39;)"><span class="mpre">errAmbig</span></a><span class="mpre"> :: [</span><a href="#loc_88_6_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_114_6_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_6_114_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_249_1_249_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_9&#39;)"><span class="hl_fundecl"><span class="mpre">errAmbig</span></span></a><span class="mpre"> </span><a name="loc_249_10_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_10_249_13&#39;)"><span class="hl_vardecl"><span class="mpre">ods</span></span></a><span class="mpre"> </span><a name="loc_249_14_249_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_20&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre"> = </span><a href="#loc_119_6_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_6_119_12&#39;)"><span class="hl_conref"><span class="mpre">OptErr</span></span></a><span class="mpre"> (</span><a href="#loc_127_1_127_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_10&#39;)"><span class="hl_varref"><span class="mpre">usageInfo</span></span></a><span class="mpre"> </span><a href="#loc_250_10_250_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_10_250_16&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre"> </span><a href="#loc_249_10_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_10_249_13&#39;)"><span class="hl_varref"><span class="mpre">ods</span></span></a><span class="mpre">)
   where </span><a name="loc_250_10_250_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_10_250_16&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;option `&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_249_14_249_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_20&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; is ambiguous; could be one of:&quot;</span></span><span class="mpre">

</span><a href="#loc_253_1_253_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_7&#39;)"><span class="mpre">errReq</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_114_6_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_6_114_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_253_1_253_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_7&#39;)"><span class="hl_fundecl"><span class="mpre">errReq</span></span></a><span class="mpre"> </span><a name="loc_253_8_253_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_8_253_9&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_253_10_253_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_10_253_16&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre"> = </span><a href="#loc_119_6_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_6_119_12&#39;)"><span class="hl_conref"><span class="mpre">OptErr</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;option `&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_253_10_253_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_10_253_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; requires an argument &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_253_8_253_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_8_253_9&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">)

</span><a href="#loc_256_1_256_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_9&#39;)"><span class="mpre">errUnrec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_256_1_256_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_9&#39;)"><span class="hl_fundecl"><span class="mpre">errUnrec</span></span></a><span class="mpre"> </span><a name="loc_256_10_256_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_10_256_16&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;unrecognized option `&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_256_10_256_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_10_256_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;\n&quot;</span></span><span class="mpre">

</span><a href="#loc_259_1_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_1_259_9&#39;)"><span class="mpre">errNoArg</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_114_6_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_6_114_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_259_1_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_1_259_9&#39;)"><span class="hl_fundecl"><span class="mpre">errNoArg</span></span></a><span class="mpre"> </span><a name="loc_259_10_259_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_10_259_16&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre"> = </span><a href="#loc_119_6_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_6_119_12&#39;)"><span class="hl_conref"><span class="mpre">OptErr</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;option `&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_259_10_259_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_10_259_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; doesn&#39;t allow an argument\n&quot;</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{-
-----------------------------------------------------------------------------------------
-- and here a small and hopefully enlightening example:

data Flag = Verbose | Version | Name String | Output String | Arg String   deriving Show

options :: [OptDescr Flag]
options =
   [Option [&#39;v&#39;]     [&quot;verbose&quot;]           (NoArg Verbose)      &quot;verbosely list files&quot;,
    Option [&#39;V&#39;,&#39;?&#39;] [&quot;version&quot;,&quot;release&quot;] (NoArg Version)      &quot;show version info&quot;,
    Option [&#39;o&#39;]     [&quot;output&quot;]            (OptArg out &quot;FILE&quot;)  &quot;use FILE for dump&quot;,
    Option [&#39;n&#39;]     [&quot;name&quot;]              (ReqArg Name &quot;USER&quot;) &quot;only dump USER&#39;s files&quot;]

out :: Maybe String -&gt; Flag
out Nothing  = Output &quot;stdout&quot;
out (Just o) = Output o

test :: ArgOrder Flag -&gt; [String] -&gt; String
test order cmdline = case getOpt order options cmdline of
                        (o,n,[]  ) -&gt; &quot;options=&quot; ++ show o ++ &quot;  args=&quot; ++ show n ++ &quot;\n&quot;
                        (_,_,errs) -&gt; concat errs ++ usageInfo header options
   where header = &quot;Usage: foobar [OPTION...] files...&quot;

-- example runs:
-- putStr (test RequireOrder [&quot;foo&quot;,&quot;-v&quot;])
--    ==&gt; options=[]  args=[&quot;foo&quot;, &quot;-v&quot;]
-- putStr (test Permute [&quot;foo&quot;,&quot;-v&quot;])
--    ==&gt; options=[Verbose]  args=[&quot;foo&quot;]
-- putStr (test (ReturnInOrder Arg) [&quot;foo&quot;,&quot;-v&quot;])
--    ==&gt; options=[Arg &quot;foo&quot;, Verbose]  args=[]
-- putStr (test Permute [&quot;foo&quot;,&quot;--&quot;,&quot;-v&quot;])
--    ==&gt; options=[]  args=[&quot;foo&quot;, &quot;-v&quot;]
-- putStr (test Permute [&quot;-?o&quot;,&quot;--name&quot;,&quot;bar&quot;,&quot;--na=baz&quot;])
--    ==&gt; options=[Version, Output &quot;stdout&quot;, Name &quot;bar&quot;, Name &quot;baz&quot;]  args=[]
-- putStr (test Permute [&quot;--ver&quot;,&quot;foo&quot;])
--    ==&gt; option `--ver&#39; is ambiguous; could be one of:
--          -v      --verbose             verbosely list files
--          -V, -?  --version, --release  show version info   
--        Usage: foobar [OPTION...] files...
--          -v        --verbose             verbosely list files  
--          -V, -?    --version, --release  show version info     
--          -o[FILE]  --output[=FILE]       use FILE for dump     
--          -n USER   --name=USER           only dump USER&#39;s files
-----------------------------------------------------------------------------------------
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- $example1

A simple choice for the type associated with flags is to define a type
@Flag@ as an algebraic type representing the possible flags and their
arguments:

&gt;    module Opts1 where
&gt;    
&gt;    import System.Console.GetOpt
&gt;    import Data.Maybe ( fromMaybe )
&gt;    
&gt;    data Flag 
&gt;     = Verbose  | Version 
&gt;     | Input String | Output String | LibDir String
&gt;       deriving Show
&gt;    
&gt;    options :: [OptDescr Flag]
&gt;    options =
&gt;     [ Option [&#39;v&#39;]     [&quot;verbose&quot;] (NoArg Verbose)       &quot;chatty output on stderr&quot;
&gt;     , Option [&#39;V&#39;,&#39;?&#39;] [&quot;version&quot;] (NoArg Version)       &quot;show version number&quot;
&gt;     , Option [&#39;o&#39;]     [&quot;output&quot;]  (OptArg outp &quot;FILE&quot;)  &quot;output FILE&quot;
&gt;     , Option [&#39;c&#39;]     []          (OptArg inp  &quot;FILE&quot;)  &quot;input FILE&quot;
&gt;     , Option [&#39;L&#39;]     [&quot;libdir&quot;]  (ReqArg LibDir &quot;DIR&quot;) &quot;library directory&quot;
&gt;     ]
&gt;    
&gt;    inp,outp :: Maybe String -&gt; Flag
&gt;    outp = Output . fromMaybe &quot;stdout&quot;
&gt;    inp  = Input  . fromMaybe &quot;stdin&quot;
&gt;    
&gt;    compilerOpts :: [String] -&gt; IO ([Flag], [String])
&gt;    compilerOpts argv = 
&gt;       case getOpt Permute options argv of
&gt;          (o,n,[]  ) -&gt; return (o,n)
&gt;          (_,_,errs) -&gt; ioError (userError (concat errs ++ usageInfo header options))
&gt;      where header = &quot;Usage: ic [OPTION...] files...&quot;

Then the rest of the program will use the constructed list of flags
to determine it\&#39;s behaviour.

-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- $example2

A different approach is to group the option values in a record of type
@Options@, and have each flag yield a function of type
@Options -&gt; Options@ transforming this record.

&gt;    module Opts2 where
&gt;
&gt;    import System.Console.GetOpt
&gt;    import Data.Maybe ( fromMaybe )
&gt;
&gt;    data Options = Options
&gt;     { optVerbose     :: Bool
&gt;     , optShowVersion :: Bool
&gt;     , optOutput      :: Maybe FilePath
&gt;     , optInput       :: Maybe FilePath
&gt;     , optLibDirs     :: [FilePath]
&gt;     } deriving Show
&gt;
&gt;    defaultOptions    = Options
&gt;     { optVerbose     = False
&gt;     , optShowVersion = False
&gt;     , optOutput      = Nothing
&gt;     , optInput       = Nothing
&gt;     , optLibDirs     = []
&gt;     }
&gt;
&gt;    options :: [OptDescr (Options -&gt; Options)]
&gt;    options =
&gt;     [ Option [&#39;v&#39;]     [&quot;verbose&quot;]
&gt;         (NoArg (\ opts -&gt; opts { optVerbose = True }))
&gt;         &quot;chatty output on stderr&quot;
&gt;     , Option [&#39;V&#39;,&#39;?&#39;] [&quot;version&quot;]
&gt;         (NoArg (\ opts -&gt; opts { optShowVersion = True }))
&gt;         &quot;show version number&quot;
&gt;     , Option [&#39;o&#39;]     [&quot;output&quot;]
&gt;         (OptArg ((\ f opts -&gt; opts { optOutput = Just f }) . fromMaybe &quot;output&quot;)
&gt;                 &quot;FILE&quot;)
&gt;         &quot;output FILE&quot;
&gt;     , Option [&#39;c&#39;]     []
&gt;         (OptArg ((\ f opts -&gt; opts { optInput = Just f }) . fromMaybe &quot;input&quot;)
&gt;                 &quot;FILE&quot;)
&gt;         &quot;input FILE&quot;
&gt;     , Option [&#39;L&#39;]     [&quot;libdir&quot;]
&gt;         (ReqArg (\ d opts -&gt; opts { optLibDirs = optLibDirs opts ++ [d] }) &quot;DIR&quot;)
&gt;         &quot;library directory&quot;
&gt;     ]
&gt;
&gt;    compilerOpts :: [String] -&gt; IO (Options, [String])
&gt;    compilerOpts argv =
&gt;       case getOpt Permute options argv of
&gt;          (o,n,[]  ) -&gt; return (foldl (flip id) defaultOptions o, n)
&gt;          (_,_,errs) -&gt; ioError (userError (concat errs ++ usageInfo header options))
&gt;      where header = &quot;Usage: ic [OPTION...] files...&quot;

Similarly, each flag could yield a monadic function transforming a record,
of type @Options -&gt; IO Options@ (or any other monad), allowing option
processing to perform actions of the chosen monad, e.g. printing help or
version messages, checking that file arguments exist, etc.

-}</span></span><span class="mpre">

</span></div></body></html>