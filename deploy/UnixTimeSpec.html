<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings, FlexibleInstances #-}
{-# OPTIONS_GHC -fno-warn-orphans #-}

module UnixTimeSpec (main, spec) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/test/UnixTimeSpec.hs&quot;, srcSpanStartLine = 6, srcSpanStartColumn = 8, srcSpanEndLine = 6, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/test/UnixTimeSpec.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 18, srcSpanEndLine = 7, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BS
import Data.Time
import Data.Time.Clock.POSIX (</span><a href="Data.Time.Clock.POSIX.html#loc_34_1_34_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.POSIX.html#loc_34_1_34_22&#39;)"><span class="mpre">posixSecondsToUTCTime</span></a><span class="mpre">)
import Data.UnixTime
import Foreign.Ptr (Ptr)
import Foreign.Marshal.Alloc (</span><a href="Foreign.Marshal.Alloc.html#loc_107_1_107_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_107_1_107_7&#39;)"><span class="mpre">alloca</span></a><span class="mpre">)
import Foreign.Storable (peek, poke)
import System.Locale (</span><a href="System.Locale.html#loc_50_1_50_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Locale.html#loc_50_1_50_18&#39;)"><span class="mpre">defaultTimeLocale</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/test/UnixTimeSpec.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 8, srcSpanEndLine = 15, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/test/UnixTimeSpec.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 8, srcSpanEndLine = 16, srcSpanEndColumn = 29}, srcInfoPoints = []}) &quot;Test.Hspec.QuickCheck&quot;"><span class="mpre">Test.Hspec.QuickCheck</span></span><span class="mpre"> (prop)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/test/UnixTimeSpec.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 8, srcSpanEndLine = 17, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre">

</span><a href="#loc_20_1_20_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_20_1_20_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hspec</span></span><span class="mpre"> </span><a href="#loc_33_1_33_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_5&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Arbitrary</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">arbitrary</span></span><span class="mpre"> = do
        </span><span class="hl_vardecl"><span class="mpre">a</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4294967295</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Gen</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">b</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">999999</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Gen</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        let </span><a name="loc_26_13_26_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_13_26_15&#39;)"><span class="hl_vardecl"><span class="mpre">ut</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/test/UnixTimeSpec.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 29, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/test/UnixTimeSpec.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 27, srcSpanEndLine = 26, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/test/UnixTimeSpec.hs&quot;, srcSpanStar"><span class="mpre">UnixTime {
                utSeconds = abs (fromIntegral a)
              , utMicroSeconds = fromIntegral b
              }</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_26_13_26_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_13_26_15&#39;)"><span class="hl_varref"><span class="mpre">ut</span></span></a><span class="mpre">

</span><a href="#loc_33_1_33_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_5&#39;)"><span class="mpre">spec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_33_1_33_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_5&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;formatUnixTime&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">prop</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;behaves like the model&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_35_42_35_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_42_35_44&#39;)"><span class="hl_vardecl"><span class="mpre">ut</span></span></a><span class="mpre"> -&gt; do
            let </span><a name="loc_36_17_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_21&#39;)"><span class="hl_vardecl"><span class="mpre">ours</span></span></a><span class="mpre"> = </span><a href="Data.UnixTime.Conv.html#loc_69_1_69_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_69_1_69_15&#39;)"><span class="hl_varref"><span class="mpre">formatUnixTime</span></span></a><span class="mpre"> </span><a href="Data.UnixTime.Conv.html#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_117_1_117_15&#39;)"><span class="hl_varref"><span class="mpre">mailDateFormat</span></span></a><span class="mpre"> </span><a href="#loc_35_42_35_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_42_35_44&#39;)"><span class="hl_varref"><span class="mpre">ut</span></span></a><span class="mpre">
                </span><a name="loc_37_17_37_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_24&#39;)"><span class="hl_vardecl"><span class="mpre">utcTime</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_10&#39;)"><span class="hl_varref"><span class="mpre">toUTCTime</span></span></a><span class="mpre"> </span><a href="#loc_35_42_35_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_42_35_44&#39;)"><span class="hl_varref"><span class="mpre">ut</span></span></a><span class="mpre">
            </span><a name="loc_38_13_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_13_38_21&#39;)"><span class="hl_vardecl"><span class="mpre">timeZone</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.LocalTime.TimeZone.html#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.LocalTime.TimeZone.html#loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">getTimeZone</span></span></a><span class="mpre"> </span><a href="#loc_37_17_37_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_24&#39;)"><span class="hl_varref"><span class="mpre">utcTime</span></span></a><span class="mpre">
            let </span><a name="loc_39_17_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_22&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><a href="#loc_62_1_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_16&#39;)"><span class="hl_varref"><span class="mpre">formatMailModel</span></span></a><span class="mpre"> </span><a href="#loc_37_17_37_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_24&#39;)"><span class="hl_varref"><span class="mpre">utcTime</span></span></a><span class="mpre"> </span><a href="#loc_38_13_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_13_38_21&#39;)"><span class="hl_varref"><span class="mpre">timeZone</span></span></a><span class="mpre">
            </span><a href="#loc_36_17_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_21&#39;)"><span class="hl_varref"><span class="mpre">ours</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldReturn`</span></span><span class="mpre"> </span><a href="#loc_39_17_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_22&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parseUnixTimeGMT &amp; formatUnixTimeGMT&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">prop</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;inverses the result&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_43_39_43_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_39_43_41&#39;)"><span class="hl_specname"><span class="mpre">ut</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">UnixTime</span></span><span class="mpre"> </span><a name="loc_43_52_43_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_52_43_55&#39;)"><span class="hl_vardecl"><span class="mpre">sec</span></span></a><span class="mpre"> _) -&gt;
            let </span><a name="loc_44_17_44_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_19&#39;)"><span class="hl_vardecl"><span class="mpre">dt</span></span></a><span class="mpre">  = </span><a href="Data.UnixTime.Conv.html#loc_81_1_81_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_81_1_81_18&#39;)"><span class="hl_varref"><span class="mpre">formatUnixTimeGMT</span></span></a><span class="mpre"> </span><a href="Data.UnixTime.Conv.html#loc_109_1_109_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_109_1_109_14&#39;)"><span class="hl_varref"><span class="mpre">webDateFormat</span></span></a><span class="mpre"> </span><a href="#loc_43_39_43_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_39_43_41&#39;)"><span class="hl_varref"><span class="mpre">ut</span></span></a><span class="mpre">
                </span><a name="loc_45_17_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_20&#39;)"><span class="hl_vardecl"><span class="mpre">ut&#39;</span></span></a><span class="mpre"> = </span><a href="Data.UnixTime.Conv.html#loc_56_1_56_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_56_1_56_17&#39;)"><span class="hl_varref"><span class="mpre">parseUnixTimeGMT</span></span></a><span class="mpre">  </span><a href="Data.UnixTime.Conv.html#loc_109_1_109_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_109_1_109_14&#39;)"><span class="hl_varref"><span class="mpre">webDateFormat</span></span></a><span class="mpre"> </span><a href="#loc_44_17_44_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_19&#39;)"><span class="hl_varref"><span class="mpre">dt</span></span></a><span class="mpre">
                </span><a name="loc_46_17_46_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_20&#39;)"><span class="hl_vardecl"><span class="mpre">dt&#39;</span></span></a><span class="mpre"> = </span><a href="Data.UnixTime.Conv.html#loc_81_1_81_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_81_1_81_18&#39;)"><span class="hl_varref"><span class="mpre">formatUnixTimeGMT</span></span></a><span class="mpre"> </span><a href="Data.UnixTime.Conv.html#loc_109_1_109_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_109_1_109_14&#39;)"><span class="hl_varref"><span class="mpre">webDateFormat</span></span></a><span class="mpre"> </span><a href="#loc_45_17_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_20&#39;)"><span class="hl_varref"><span class="mpre">ut&#39;</span></span></a><span class="mpre">
            in </span><a href="#loc_45_17_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_20&#39;)"><span class="hl_varref"><span class="mpre">ut&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">UnixTime</span></span><span class="mpre"> </span><a href="#loc_43_52_43_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_52_43_55&#39;)"><span class="hl_varref"><span class="mpre">sec</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_44_17_44_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_19&#39;)"><span class="hl_varref"><span class="mpre">dt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_46_17_46_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_20&#39;)"><span class="hl_varref"><span class="mpre">dt&#39;</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;addUnixDiffTime &amp; diffUnixTime&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">prop</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;invrses the result&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a name="loc_50_39_50_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_42&#39;)"><span class="hl_vardecl"><span class="mpre">ut0</span></span></a><span class="mpre">, </span><a name="loc_50_44_50_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_44_50_47&#39;)"><span class="hl_vardecl"><span class="mpre">ut1</span></span></a><span class="mpre">) -&gt;
            let </span><a name="loc_51_17_51_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_17_51_21&#39;)"><span class="hl_vardecl"><span class="mpre">ut0&#39;</span></span></a><span class="mpre"> = </span><a href="Data.UnixTime.Diff.html#loc_63_1_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Diff.html#loc_63_1_63_16&#39;)"><span class="hl_varref"><span class="mpre">addUnixDiffTime</span></span></a><span class="mpre"> </span><a href="#loc_50_44_50_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_44_50_47&#39;)"><span class="hl_varref"><span class="mpre">ut1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.UnixTime.Diff.html#loc_55_1_55_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Diff.html#loc_55_1_55_13&#39;)"><span class="hl_varref"><span class="mpre">diffUnixTime</span></span></a><span class="mpre"> </span><a href="#loc_50_39_50_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_42&#39;)"><span class="hl_varref"><span class="mpre">ut0</span></span></a><span class="mpre"> </span><a href="#loc_50_44_50_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_44_50_47&#39;)"><span class="hl_varref"><span class="mpre">ut1</span></span></a><span class="mpre">
                </span><a name="loc_52_17_52_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_21&#39;)"><span class="hl_vardecl"><span class="mpre">ut1&#39;</span></span></a><span class="mpre"> = </span><a href="Data.UnixTime.Diff.html#loc_63_1_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Diff.html#loc_63_1_63_16&#39;)"><span class="hl_varref"><span class="mpre">addUnixDiffTime</span></span></a><span class="mpre"> </span><a href="#loc_50_39_50_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_42&#39;)"><span class="hl_varref"><span class="mpre">ut0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.UnixTime.Diff.html#loc_55_1_55_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Diff.html#loc_55_1_55_13&#39;)"><span class="hl_varref"><span class="mpre">diffUnixTime</span></span></a><span class="mpre"> </span><a href="#loc_50_44_50_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_44_50_47&#39;)"><span class="hl_varref"><span class="mpre">ut1</span></span></a><span class="mpre"> </span><a href="#loc_50_39_50_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_42&#39;)"><span class="hl_varref"><span class="mpre">ut0</span></span></a><span class="mpre">
            in </span><a href="#loc_51_17_51_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_17_51_21&#39;)"><span class="hl_varref"><span class="mpre">ut0&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_50_39_50_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_42&#39;)"><span class="hl_varref"><span class="mpre">ut0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_52_17_52_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_21&#39;)"><span class="hl_varref"><span class="mpre">ut1&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_50_44_50_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_44_50_47&#39;)"><span class="hl_varref"><span class="mpre">ut1</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;UnixTime Storable instance&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">prop</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;peek . poke = id&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_56_36_56_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_36_56_38&#39;)"><span class="hl_vardecl"><span class="mpre">ut</span></span></a><span class="mpre"> -&gt;
            let </span><a href="#loc_58_17_58_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_25&#39;)"><span class="mpre">pokePeek</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre">
                </span><a name="loc_58_17_58_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_25&#39;)"><span class="hl_fundecl"><span class="mpre">pokePeek</span></span></a><span class="mpre"> </span><a name="loc_58_26_58_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_29&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_58_26_58_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_29&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_56_36_56_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_36_56_38&#39;)"><span class="hl_varref"><span class="mpre">ut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_58_26_58_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_29&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
            in </span><span class="hl_varref"><span class="mpre">shouldReturn</span></span><span class="mpre"> (</span><a href="Foreign.Marshal.Alloc.html#loc_107_1_107_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_107_1_107_7&#39;)"><span class="hl_varref"><span class="mpre">alloca</span></span></a><span class="mpre"> </span><a href="#loc_58_17_58_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_25&#39;)"><span class="hl_varref"><span class="mpre">pokePeek</span></span></a><span class="mpre">) </span><a href="#loc_56_36_56_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_36_56_38&#39;)"><span class="hl_varref"><span class="mpre">ut</span></span></a><span class="mpre">

</span><a href="#loc_62_1_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_16&#39;)"><span class="mpre">formatMailModel</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Time.LocalTime.TimeZone.html#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.LocalTime.TimeZone.html#loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_62_1_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_16&#39;)"><span class="hl_fundecl"><span class="mpre">formatMailModel</span></span></a><span class="mpre"> </span><a name="loc_62_17_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_17_62_19&#39;)"><span class="hl_vardecl"><span class="mpre">ut</span></span></a><span class="mpre"> </span><a name="loc_62_20_62_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_20_62_24&#39;)"><span class="hl_vardecl"><span class="mpre">zone</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Time.Format.html#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Format.html#loc_150_1_150_11&#39;)"><span class="hl_varref"><span class="mpre">formatTime</span></span></a><span class="mpre"> </span><a href="System.Locale.html#loc_50_1_50_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Locale.html#loc_50_1_50_18&#39;)"><span class="hl_varref"><span class="mpre">defaultTimeLocale</span></span></a><span class="mpre"> </span><a href="#loc_65_4_65_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_4_65_7&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><a href="#loc_64_4_64_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_4_64_6&#39;)"><span class="hl_varref"><span class="mpre">zt</span></span></a><span class="mpre">
  where
   </span><a name="loc_64_4_64_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_4_64_6&#39;)"><span class="hl_vardecl"><span class="mpre">zt</span></span></a><span class="mpre"> = </span><a href="Data.Time.LocalTime.LocalTime.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.LocalTime.LocalTime.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">utcToZonedTime</span></span></a><span class="mpre"> </span><a href="#loc_62_20_62_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_20_62_24&#39;)"><span class="hl_varref"><span class="mpre">zone</span></span></a><span class="mpre"> </span><a href="#loc_62_17_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_17_62_19&#39;)"><span class="hl_varref"><span class="mpre">ut</span></span></a><span class="mpre">
   </span><a name="loc_65_4_65_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_4_65_7&#39;)"><span class="hl_vardecl"><span class="mpre">fmt</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.unpack</span></span><span class="mpre"> </span><a href="Data.UnixTime.Conv.html#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_117_1_117_15&#39;)"><span class="hl_varref"><span class="mpre">mailDateFormat</span></span></a><span class="mpre">

</span><a href="#loc_68_1_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_10&#39;)"><span class="mpre">toUTCTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre"> -&gt; </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
</span><a name="loc_68_1_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_10&#39;)"><span class="hl_vardecl"><span class="mpre">toUTCTime</span></span></a><span class="mpre"> = </span><a href="Data.Time.Clock.POSIX.html#loc_34_1_34_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.POSIX.html#loc_34_1_34_22&#39;)"><span class="hl_varref"><span class="mpre">posixSecondsToUTCTime</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">realToFrac</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.UnixTime.Conv.html#loc_131_1_131_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_131_1_131_12&#39;)"><span class="hl_varref"><span class="mpre">toEpochTime</span></span></a><span class="mpre">
</span></div></body></html>