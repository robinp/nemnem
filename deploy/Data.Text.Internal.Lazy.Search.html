<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, ScopedTypeVariables #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Text.Lazy.Search</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2009, 2010 Bryan O&#39;Sullivan</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Warning/: this is an internal module, and does not have a stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- API or name. Functions in this module may not check or enforce</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- preconditions expected by public modules. Use at your own risk!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fast substring search for lazy &#39;Text&#39;, based on work by Boyer,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Moore, Horspool, Sunday, and Lundh.  Adapted from the strict</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- implementation.</span></span><span class="mpre">

module Data.Text.Internal.Lazy.Search
    (
      indices
    ) where

import qualified Data.Text.Array as A
import Data.Int (</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="mpre">Int64</span></a><span class="mpre">)
import Data.Word (Word16, Word64)
import qualified Data.Text.Internal as T
import Data.Text.Internal.Fusion.Types (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_6_53_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_6_53_11&#39;)"><span class="mpre">PairS</span></a><span class="mpre">(..))
import Data.Text.Internal.Lazy (</span><a href="Data.Text.Internal.Lazy.html#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_6_47_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">(..), </span><a href="Data.Text.Internal.Lazy.html#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_101_1_101_12&#39;)"><span class="mpre">foldlChunks</span></a><span class="mpre">)
import Data.Bits ((.|.), (.&amp;.))
import Data.Text.Internal.Unsafe.Shift (</span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | /O(n+m)/ Find the offsets of all non-overlapping indices of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @needle@ within @haystack@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function is strict in @needle@, and lazy (as far as possible)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in the chunks of @haystack@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In (unlikely) bad cases, this algorithm&#39;s complexity degrades</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- towards /O(n*m)/.</span></span><span class="mpre">
</span><a href="#loc_45_1_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_8&#39;)"><span class="mpre">indices</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.Lazy.html#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- ^ Substring to search for (@needle@)</span></span><span class="mpre">
        -&gt; </span><a href="Data.Text.Internal.Lazy.html#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- ^ Text to search in (@haystack@)</span></span><span class="mpre">
        -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]
</span><a name="loc_45_1_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_8&#39;)"><span class="hl_fundecl"><span class="mpre">indices</span></span></a><span class="mpre"> </span><a name="loc_45_9_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_15&#39;)"><span class="hl_specname"><span class="mpre">needle</span></span></a><span class="mpre">@(</span><a href="Data.Text.Internal.Lazy.html#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_45_23_45_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_23_45_24&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_45_25_45_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_25_45_27&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre">) </span><span class="hl_specname"><span class="mpre">_haystack</span></span><span class="mpre">@(</span><a href="Data.Text.Internal.Lazy.html#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_45_46_45_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_46_45_47&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_45_48_45_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_48_45_50&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre">)
    | </span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = []
    | </span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">  = </span><a href="#loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="hl_varref"><span class="mpre">indicesOne</span></span></a><span class="mpre"> (</span><a href="#loc_73_5_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_11&#39;)"><span class="hl_varref"><span class="mpre">nindex</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_45_46_45_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_46_45_47&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_45_48_45_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_48_45_50&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><a href="#loc_50_5_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_12&#39;)"><span class="hl_varref"><span class="mpre">advance</span></span></a><span class="mpre"> </span><a href="#loc_45_46_45_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_46_45_47&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_45_48_45_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_48_45_50&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where
    </span><a name="loc_50_5_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_12&#39;)"><span class="hl_fundecl"><span class="mpre">advance</span></span></a><span class="mpre"> </span><a name="loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@(</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> _ _ </span><a name="loc_50_27_50_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_27_50_28&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) </span><a name="loc_50_30_50_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_30_50_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_52_7_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">
     where
      </span><a name="loc_52_7_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_11&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> !</span><a name="loc_52_13_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> !</span><a name="loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
         | </span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_60_10_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> = case </span><a href="#loc_50_30_50_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_30_50_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                      </span><a href="Data.Text.Internal.Lazy.html#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">           -&gt; []
                      </span><a href="Data.Text.Internal.Lazy.html#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_55_29_55_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_29_55_30&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_55_31_55_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_31_55_33&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">      -&gt; </span><a href="#loc_50_5_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_12&#39;)"><span class="hl_varref"><span class="mpre">advance</span></span></a><span class="mpre"> </span><a href="#loc_55_29_55_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_29_55_30&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_55_31_55_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_31_55_33&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><a href="#loc_52_13_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_60_10_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)
         | </span><a href="#loc_92_5_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_15&#39;)"><span class="hl_varref"><span class="mpre">lackingHay</span></span></a><span class="mpre"> (</span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre">) </span><a href="#loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_50_30_50_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_30_50_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">  = []
         | </span><a href="#loc_61_10_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_66_10_66_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_10_66_24&#39;)"><span class="hl_varref"><span class="mpre">candidateMatch</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = </span><a href="#loc_52_13_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_7_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> (</span><a href="#loc_52_13_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre">) (</span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre">)
         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                   = </span><a href="#loc_52_7_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> (</span><a href="#loc_52_13_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_62_10_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_15&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">) (</span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_62_10_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_15&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">)
       where
         </span><a name="loc_60_10_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_50_27_50_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_27_50_28&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
         </span><a name="loc_61_10_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_70_10_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_16&#39;)"><span class="hl_varref"><span class="mpre">hindex</span></span></a><span class="mpre"> (</span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_72_5_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_10&#39;)"><span class="hl_varref"><span class="mpre">nlast</span></span></a><span class="mpre">)
         </span><a name="loc_62_10_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_15&#39;)"><span class="hl_vardecl"><span class="mpre">delta</span></span></a><span class="mpre"> | </span><a href="#loc_65_10_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_23&#39;)"><span class="hl_varref"><span class="mpre">nextInPattern</span></span></a><span class="mpre"> = </span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
               | </span><a href="#loc_61_10_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">        = </span><a href="#loc_76_26_76_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_26_76_30&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
         </span><a name="loc_65_10_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_23&#39;)"><span class="hl_vardecl"><span class="mpre">nextInPattern</span></span></a><span class="mpre">         = </span><a href="#loc_76_6_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_10&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><a href="#loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_varref"><span class="mpre">swizzle</span></span></a><span class="mpre"> (</span><a href="#loc_70_10_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_16&#39;)"><span class="hl_varref"><span class="mpre">hindex</span></span></a><span class="mpre"> (</span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
         </span><a name="loc_66_10_66_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_10_66_24&#39;)"><span class="hl_fundecl"><span class="mpre">candidateMatch</span></span></a><span class="mpre"> !</span><a name="loc_66_26_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_26_66_27&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre">
             | </span><a href="#loc_66_26_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_26_66_27&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_72_5_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_10&#39;)"><span class="hl_varref"><span class="mpre">nlast</span></span></a><span class="mpre">               = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
             | </span><a href="#loc_70_10_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_16&#39;)"><span class="hl_varref"><span class="mpre">hindex</span></span></a><span class="mpre"> (</span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_66_26_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_26_66_27&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_73_5_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_11&#39;)"><span class="hl_varref"><span class="mpre">nindex</span></span></a><span class="mpre"> </span><a href="#loc_66_26_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_26_66_27&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
             | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                = </span><a href="#loc_66_10_66_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_10_66_24&#39;)"><span class="hl_varref"><span class="mpre">candidateMatch</span></span></a><span class="mpre"> (</span><a href="#loc_66_26_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_26_66_27&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
         </span><a name="loc_70_10_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_16&#39;)"><span class="hl_vardecl"><span class="mpre">hindex</span></span></a><span class="mpre">                         = </span><a href="#loc_104_1_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_6&#39;)"><span class="hl_varref"><span class="mpre">index</span></span></a><span class="mpre"> </span><a href="#loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_50_30_50_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_30_50_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a name="loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_vardecl"><span class="mpre">nlen</span></span></a><span class="mpre">      = </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">wordLength</span></span></a><span class="mpre"> </span><a href="#loc_45_9_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_15&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre">
    </span><a name="loc_72_5_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_10&#39;)"><span class="hl_vardecl"><span class="mpre">nlast</span></span></a><span class="mpre">     = </span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><a name="loc_73_5_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_11&#39;)"><span class="hl_vardecl"><span class="mpre">nindex</span></span></a><span class="mpre">    = </span><a href="#loc_104_1_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_6&#39;)"><span class="hl_varref"><span class="mpre">index</span></span></a><span class="mpre"> </span><a href="#loc_45_23_45_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_23_45_24&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_45_25_45_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_25_45_27&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">
    </span><a name="loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">         = </span><a href="Data.Text.Internal.Lazy.html#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_101_1_101_12&#39;)"><span class="hl_varref"><span class="mpre">foldlChunks</span></span></a><span class="mpre"> </span><a href="#loc_75_15_75_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_18&#39;)"><span class="hl_varref"><span class="mpre">fin</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_45_9_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_15&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre">
        where </span><a name="loc_75_15_75_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_18&#39;)"><span class="hl_fundecl"><span class="mpre">fin</span></span></a><span class="mpre"> _ (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> </span><a name="loc_75_29_75_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_29_75_33&#39;)"><span class="hl_vardecl"><span class="mpre">farr</span></span></a><span class="mpre"> </span><a name="loc_75_34_75_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_34_75_38&#39;)"><span class="hl_vardecl"><span class="mpre">foff</span></span></a><span class="mpre"> </span><a name="loc_75_39_75_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_39_75_43&#39;)"><span class="hl_vardecl"><span class="mpre">flen</span></span></a><span class="mpre">) = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_75_29_75_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_29_75_33&#39;)"><span class="hl_varref"><span class="mpre">farr</span></span></a><span class="mpre"> (</span><a href="#loc_75_34_75_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_34_75_38&#39;)"><span class="hl_varref"><span class="mpre">foff</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_75_39_75_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_39_75_43&#39;)"><span class="hl_varref"><span class="mpre">flen</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    (</span><a name="loc_76_6_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_10&#39;)"><span class="hl_vardecl"><span class="mpre">mask</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">) </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a name="loc_76_26_76_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_26_76_30&#39;)"><span class="hl_vardecl"><span class="mpre">skip</span></span></a><span class="mpre"> = </span><a href="#loc_78_5_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_15&#39;)"><span class="hl_varref"><span class="mpre">buildTable</span></span></a><span class="mpre"> </span><a href="#loc_45_23_45_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_23_45_24&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_45_25_45_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_25_45_27&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
    </span><a name="loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_fundecl"><span class="mpre">swizzle</span></span></a><span class="mpre"> </span><a name="loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
    </span><a name="loc_78_5_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_15&#39;)"><span class="hl_fundecl"><span class="mpre">buildTable</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> </span><a name="loc_78_24_78_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_24_78_28&#39;)"><span class="hl_vardecl"><span class="mpre">xarr</span></span></a><span class="mpre"> </span><a name="loc_78_29_78_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_29_78_33&#39;)"><span class="hl_vardecl"><span class="mpre">xoff</span></span></a><span class="mpre"> </span><a name="loc_78_34_78_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_34_78_38&#39;)"><span class="hl_vardecl"><span class="mpre">xlen</span></span></a><span class="mpre">) </span><a name="loc_78_40_78_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_40_78_42&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_80_9_80_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
      where
        </span><a name="loc_80_9_80_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !(</span><a name="loc_80_14_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_14_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">::</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">) !</span><a name="loc_80_25_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_25_80_26&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> !</span><a name="loc_80_28_80_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_28_80_31&#39;)"><span class="hl_vardecl"><span class="mpre">msk</span></span></a><span class="mpre"> !</span><a name="loc_80_33_80_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_33_80_36&#39;)"><span class="hl_vardecl"><span class="mpre">skp</span></span></a><span class="mpre">
            | </span><a href="#loc_80_25_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_25_80_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_89_19_89_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_19_89_24&#39;)"><span class="hl_varref"><span class="mpre">xlast</span></span></a><span class="mpre"> = case </span><a href="#loc_78_40_78_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_40_78_42&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                             </span><a href="Data.Text.Internal.Lazy.html#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">      -&gt; (</span><a href="#loc_80_28_80_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_28_80_31&#39;)"><span class="hl_varref"><span class="mpre">msk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_varref"><span class="mpre">swizzle</span></span></a><span class="mpre"> </span><a href="#loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">) </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a href="#loc_80_33_80_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_33_80_36&#39;)"><span class="hl_varref"><span class="mpre">skp</span></span></a><span class="mpre">
                             </span><a href="Data.Text.Internal.Lazy.html#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_83_36_83_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_36_83_37&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_83_38_83_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_38_83_40&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_78_5_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_15&#39;)"><span class="hl_varref"><span class="mpre">buildTable</span></span></a><span class="mpre"> </span><a href="#loc_83_36_83_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_36_83_37&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_83_38_83_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_38_83_40&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><a href="#loc_80_14_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_14_80_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_86_19_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_19_86_23&#39;)"><span class="hl_varref"><span class="mpre">msk&#39;</span></span></a><span class="mpre"> </span><a href="#loc_87_19_87_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_19_87_23&#39;)"><span class="hl_varref"><span class="mpre">skp&#39;</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_80_9_80_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_80_14_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_14_80_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_80_25_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_25_80_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_86_19_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_19_86_23&#39;)"><span class="hl_varref"><span class="mpre">msk&#39;</span></span></a><span class="mpre"> </span><a href="#loc_87_19_87_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_19_87_23&#39;)"><span class="hl_varref"><span class="mpre">skp&#39;</span></span></a><span class="mpre">
            where </span><a name="loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">                = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_78_24_78_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_24_78_28&#39;)"><span class="hl_varref"><span class="mpre">xarr</span></span></a><span class="mpre"> (</span><a href="#loc_78_29_78_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_29_78_33&#39;)"><span class="hl_varref"><span class="mpre">xoff</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_80_25_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_25_80_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
                  </span><a name="loc_86_19_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_19_86_23&#39;)"><span class="hl_vardecl"><span class="mpre">msk&#39;</span></span></a><span class="mpre">             = </span><a href="#loc_80_28_80_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_28_80_31&#39;)"><span class="hl_varref"><span class="mpre">msk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_varref"><span class="mpre">swizzle</span></span></a><span class="mpre"> </span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                  </span><a name="loc_87_19_87_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_19_87_23&#39;)"><span class="hl_vardecl"><span class="mpre">skp&#39;</span></span></a><span class="mpre"> | </span><a href="#loc_85_19_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_19_85_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">    = </span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_80_14_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_14_80_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
                       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_80_33_80_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_33_80_36&#39;)"><span class="hl_varref"><span class="mpre">skp</span></span></a><span class="mpre">
                  </span><a name="loc_89_19_89_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_19_89_24&#39;)"><span class="hl_vardecl"><span class="mpre">xlast</span></span></a><span class="mpre"> = </span><a href="#loc_78_34_78_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_34_78_38&#39;)"><span class="hl_varref"><span class="mpre">xlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | Check whether an attempt to index into the haystack at the</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- given offset would fail.</span></span><span class="mpre">
    </span><a name="loc_92_5_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_15&#39;)"><span class="hl_fundecl"><span class="mpre">lackingHay</span></span></a><span class="mpre"> </span><a name="loc_92_16_92_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_16_92_17&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="#loc_94_9_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      where
        </span><a name="loc_94_9_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_94_12_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_12_94_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> _ _ </span><a name="loc_94_26_94_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_26_94_27&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) </span><a name="loc_94_29_94_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_29_94_31&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> = </span><a href="#loc_97_19_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_19_97_21&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_92_16_92_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_16_92_17&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> case </span><a href="#loc_94_29_94_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_29_94_31&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> of
                                             </span><a href="Data.Text.Internal.Lazy.html#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">      -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                                             </span><a href="Data.Text.Internal.Lazy.html#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_96_52_96_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_52_96_53&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_96_54_96_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_54_96_56&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_94_9_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_97_19_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_19_97_21&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre"> </span><a href="#loc_96_52_96_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_52_96_53&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_96_54_96_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_54_96_56&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
            where </span><a name="loc_97_19_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_19_97_21&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_94_12_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_12_94_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_94_26_94_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_26_94_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
</span><a href="#loc_45_1_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_8&#39;)"><span class="hl_fundecl"><span class="mpre">indices</span></span></a><span class="mpre"> _ _ = []

</span><span class="hl_comment"><span class="mpre">-- | Fast index into a partly unpacked &#39;Text&#39;.  We take into account</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the possibility that the caller might try to access one element</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- past the end.</span></span><span class="mpre">
</span><a href="#loc_104_1_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_6&#39;)"><span class="mpre">index</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Lazy.html#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">
</span><a name="loc_104_1_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_6&#39;)"><span class="hl_fundecl"><span class="mpre">index</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> </span><a name="loc_104_15_104_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_15_104_18&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_104_19_104_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_19_104_22&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_104_23_104_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_23_104_26&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_104_28_104_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_28_104_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> !</span><a name="loc_104_32_104_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_32_104_33&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
    | </span><a href="#loc_113_11_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_11_113_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_104_23_104_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_23_104_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">   = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_104_15_104_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_15_104_18&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> (</span><a href="#loc_104_19_104_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_19_104_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_113_11_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_11_113_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = case </span><a href="#loc_104_28_104_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_28_104_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                    </span><a href="Data.Text.Internal.Lazy.html#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">
                        </span><span class="hl_comment"><span class="mpre">-- out of bounds, but legal</span></span><span class="mpre">
                        | </span><a href="#loc_113_11_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_11_113_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_104_23_104_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_23_104_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">  -&gt; </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                        </span><span class="hl_comment"><span class="mpre">-- should never happen, due to lackingHay above</span></span><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_134_1_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_11&#39;)"><span class="hl_varref"><span class="mpre">emptyError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;index&quot;</span></span><span class="mpre">
                    </span><a href="Data.Text.Internal.Lazy.html#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_112_27_112_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_27_112_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_112_29_112_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_29_112_31&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_104_1_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_6&#39;)"><span class="hl_varref"><span class="mpre">index</span></span></a><span class="mpre"> </span><a href="#loc_112_27_112_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_27_112_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_112_29_112_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_29_112_31&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> (</span><a href="#loc_104_32_104_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_32_104_33&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_104_23_104_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_23_104_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)
    where </span><a name="loc_113_11_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_11_113_12&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_104_32_104_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_32_104_33&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A variant of &#39;indices&#39; that scans linearly for a single &#39;Word16&#39;.</span></span><span class="mpre">
</span><a href="#loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="mpre">indicesOne</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Lazy.html#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]
</span><a name="loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="hl_fundecl"><span class="mpre">indicesOne</span></span></a><span class="mpre"> </span><a name="loc_117_12_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_119_5_119_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">
  where
    </span><a name="loc_119_5_119_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> !</span><a name="loc_119_12_119_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_12_119_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> </span><a name="loc_119_22_119_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_22_119_26&#39;)"><span class="hl_vardecl"><span class="mpre">oarr</span></span></a><span class="mpre"> </span><a name="loc_119_27_119_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_27_119_31&#39;)"><span class="hl_vardecl"><span class="mpre">ooff</span></span></a><span class="mpre"> </span><a name="loc_119_32_119_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_32_119_36&#39;)"><span class="hl_vardecl"><span class="mpre">olen</span></span></a><span class="mpre">) </span><a name="loc_119_38_119_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_38_119_40&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre"> = </span><a href="#loc_121_9_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      where
        </span><a name="loc_121_9_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> | </span><a href="#loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_119_32_119_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_32_119_36&#39;)"><span class="hl_varref"><span class="mpre">olen</span></span></a><span class="mpre"> = case </span><a href="#loc_119_38_119_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_38_119_40&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre"> of
                             </span><a href="Data.Text.Internal.Lazy.html#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">      -&gt; []
                             </span><a href="Data.Text.Internal.Lazy.html#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_123_36_123_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_36_123_37&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_123_38_123_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_38_123_40&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_119_5_119_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><a href="#loc_119_12_119_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_12_119_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_119_32_119_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_32_119_36&#39;)"><span class="hl_varref"><span class="mpre">olen</span></span></a><span class="mpre">) </span><a href="#loc_123_36_123_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_36_123_37&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_123_38_123_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_38_123_40&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
             | </span><a href="#loc_126_20_126_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_20_126_22&#39;)"><span class="hl_varref"><span class="mpre">on</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_117_12_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_119_12_119_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_12_119_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_121_9_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
             | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_121_9_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
             where </span><a name="loc_126_20_126_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_20_126_22&#39;)"><span class="hl_vardecl"><span class="mpre">on</span></span></a><span class="mpre"> = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_119_22_119_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_22_119_26&#39;)"><span class="hl_varref"><span class="mpre">oarr</span></span></a><span class="mpre"> (</span><a href="#loc_119_27_119_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_27_119_31&#39;)"><span class="hl_varref"><span class="mpre">ooff</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_121_12_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_12_121_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The number of &#39;Word16&#39; values in a &#39;Text&#39;.</span></span><span class="mpre">
</span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="mpre">wordLength</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.Lazy.html#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">
</span><a name="loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_vardecl"><span class="mpre">wordLength</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Lazy.html#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Lazy.html#loc_101_1_101_12&#39;)"><span class="hl_varref"><span class="mpre">foldlChunks</span></span></a><span class="mpre"> </span><a href="#loc_131_11_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_20&#39;)"><span class="hl_varref"><span class="mpre">sumLength</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    where </span><a name="loc_131_11_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_20&#39;)"><span class="hl_fundecl"><span class="mpre">sumLength</span></span></a><span class="mpre"> </span><a name="loc_131_21_131_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_21_131_22&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> _ _ </span><a name="loc_131_35_131_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_35_131_36&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><a href="#loc_131_21_131_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_21_131_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_131_35_131_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_35_131_36&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><a href="#loc_134_1_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_11&#39;)"><span class="mpre">emptyError</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_134_1_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_11&#39;)"><span class="hl_fundecl"><span class="mpre">emptyError</span></span></a><span class="mpre"> </span><a name="loc_134_12_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_15&#39;)"><span class="hl_vardecl"><span class="mpre">fun</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Data.Text.Lazy.Search.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_134_12_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_15&#39;)"><span class="hl_varref"><span class="mpre">fun</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: empty input&quot;</span></span><span class="mpre">)
</span></div></body></html>