<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS_HADDOCK hide #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Language.Haskell.Exts.Annotated.ParseMonad</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Niklas Broberg (c) 2004-2009,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                Original (c) The GHC Team, 1997-2000</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Niklas Broberg, d00nibro@chalmers.se</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Monads for the Haskell parser and lexer.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Language.Haskell.Exts.ParseMonad(
        </span><span class="hl_comment"><span class="mpre">-- * Parsing</span></span><span class="mpre">
        P, ParseResult(..), atSrcLoc, LexContext(..),
        ParseMode(..), defaultParseMode, fromParseResult,
        runParserWithMode, runParserWithModeComments, runParser,
        getSrcLoc, pushCurrentContext, popContext,
        getExtensions,
        </span><span class="hl_comment"><span class="mpre">-- * Lexing</span></span><span class="mpre">
        Lex(runL), getInput, discard, lexNewline, lexTab, lexWhile,
        alternative, checkBOL, setBOL, startToken, getOffside,
        pushContextL, popContextL, getExtensionsL, pushComment, 
        getSrcLocL, setSrcLineL, ignoreLinePragmasL, setLineFilenameL,
        </span><span class="hl_comment"><span class="mpre">-- * Harp/Hsx</span></span><span class="mpre">
        ExtContext(..),
        pushExtContextL, popExtContextL, getExtContext,
        pullCtxtFlag, flagDo,
        getModuleName
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 8, srcSpanEndLine = 36, srcSpanEndColumn = 36}, srcInfoPoints = []}) &quot;Language.Haskell.Exts.SrcLoc&quot;"><span class="mpre">Language.Haskell.Exts.SrcLoc</span></span><span class="mpre">(SrcLoc(..))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 8, srcSpanEndLine = 37, srcSpanEndColumn = 36}, srcInfoPoints = []}) &quot;Language.Haskell.Exts.Fixity&quot;"><span class="mpre">Language.Haskell.Exts.Fixity</span></span><span class="mpre"> (Fixity, preludeFixities)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 8, srcSpanEndLine = 38, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Language.Haskell.Exts.Comments&quot;"><span class="mpre">Language.Haskell.Exts.Comments</span></span><span class="mpre">
import Language.Haskell.Exts.Extension </span><span class="hl_comment"><span class="mpre">-- (Extension, impliesExts, haskell2010)</span></span><span class="mpre">

import Data.List ( </span><a href="Data.List.html#loc_427_1_427_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_427_1_427_12&#39;)"><span class="mpre">intersperse</span></a><span class="mpre"> )
import Control.Applicative
import Control.Monad (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import Data.Monoid

</span><span class="hl_comment"><span class="mpre">-- | The result of a parse.</span></span><span class="mpre">
data </span><a name="loc_47_6_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_17&#39;)"><span class="hl_tycondecl"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
    = </span><a name="loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_condecl"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ The parse succeeded, yielding a value.</span></span><span class="mpre">
    | </span><a name="loc_49_7_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_18&#39;)"><span class="hl_condecl"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SrcLoc</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- ^ The parse failed at the specified</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- source location, with an error message.</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 5, srcSpanEndLine = 52, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 5, srcSpanEndLine = 52, srcSpanEndColumn = 13}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {sr"><span class="mpre">deriving Show</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Retrieve the result of a successful parse, throwing an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   error if the parse is actually not successful.</span></span><span class="mpre">
</span><a href="#loc_57_1_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_16&#39;)"><span class="mpre">fromParseResult</span></a><span class="mpre"> :: </span><a href="#loc_47_6_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_57_1_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_16&#39;)"><span class="hl_fundecl"><span class="mpre">fromParseResult</span></span></a><span class="mpre"> (</span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a name="loc_57_26_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_26_57_27&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_57_26_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_26_57_27&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
</span><a href="#loc_57_1_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_16&#39;)"><span class="hl_fundecl"><span class="mpre">fromParseResult</span></span></a><span class="mpre"> (</span><a href="#loc_49_7_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_18&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a name="loc_58_30_58_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_30_58_33&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_58_34_58_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_34_58_37&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;fromParseResult: Parse failed at [&quot;</span></span><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">srcFilename</span></span><span class="mpre"> </span><a href="#loc_58_30_58_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_30_58_33&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;] (&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">srcLine</span></span><span class="mpre"> </span><a href="#loc_58_30_58_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_30_58_33&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">srcColumn</span></span><span class="mpre"> </span><a href="#loc_58_30_58_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_30_58_33&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;): &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_58_34_58_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_34_58_37&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_47_6_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> where
  </span><a name="loc_62_3_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_3_62_7&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_62_8_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_8_62_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a name="loc_62_19_62_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_19_62_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)           = </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_62_8_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_8_62_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_62_19_62_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_19_62_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><a href="#loc_62_3_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_3_62_7&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> (</span><a href="#loc_49_7_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_18&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a name="loc_63_23_63_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_23_63_26&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_63_27_63_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_30&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre">) = </span><a href="#loc_49_7_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_18&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a href="#loc_63_23_63_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_23_63_26&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_63_27_63_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_30&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> </span><a href="#loc_47_6_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> where
  </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre"> = </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre">
  </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a name="loc_67_11_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">           </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a name="loc_67_27_67_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_27_67_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_67_11_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_67_27_67_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_27_67_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><a href="#loc_49_7_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_18&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a name="loc_68_15_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_18&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_68_19_68_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_19_68_22&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> _ = </span><a href="#loc_49_7_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_18&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a href="#loc_68_15_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_18&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_68_19_68_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_19_68_22&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_47_6_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> where
  </span><span class="hl_vardecl"><span class="mpre">return</span></span><span class="mpre"> = </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre">
  </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a name="loc_72_11_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">           </span><a name="loc_72_23_72_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_23_72_26&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_72_27_72_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_27_72_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_72_27_72_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_27_72_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_72_11_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><a href="#loc_49_7_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_18&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a name="loc_73_15_73_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_15_73_18&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_73_19_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_19_73_22&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a href="#loc_72_23_72_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_23_72_26&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> _ = </span><a href="#loc_49_7_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_18&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a href="#loc_73_15_73_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_15_73_18&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_73_19_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_19_73_22&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 10, srcSpanEndLine = 75, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 19, srcSpanEndLine = 75, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan "><span class="mpre">Monoid m =&gt;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> (</span><a href="#loc_47_6_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
  </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a name="loc_77_11_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a name="loc_77_31_77_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_31_77_32&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_77_11_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_77_31_77_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_31_77_32&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
  </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a name="loc_78_23_78_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_23_78_26&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">       = </span><a href="#loc_78_23_78_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_23_78_26&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
  </span><a name="loc_79_3_79_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_3_79_6&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">       </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">`mappend`</span></span></a><span class="mpre"> _         = </span><a href="#loc_79_3_79_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_3_79_6&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- left-biased</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- internal version</span></span><span class="mpre">
data </span><a name="loc_83_6_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_6_83_17&#39;)"><span class="hl_tycondecl"><span class="mpre">ParseStatus</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_condecl"><span class="mpre">Ok</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ParseState</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> | </span><a name="loc_83_40_83_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_40_83_46&#39;)"><span class="hl_condecl"><span class="mpre">Failed</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SrcLoc</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 5, srcSpanEndLine = 84, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 5, srcSpanEndLine = 84, srcSpanEndColumn = 13}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {sr"><span class="mpre">deriving Show</span></span><span class="mpre">

data </span><a name="loc_86_6_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_16&#39;)"><span class="hl_tycondecl"><span class="mpre">LexContext</span></span></a><span class="mpre"> = </span><a name="loc_86_19_86_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_19_86_27&#39;)"><span class="hl_condecl"><span class="mpre">NoLayout</span></span></a><span class="mpre"> | </span><a name="loc_86_30_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_30_86_36&#39;)"><span class="hl_condecl"><span class="mpre">Layout</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 5, srcSpanEndLine = 87, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 5, srcSpanEndLine = 87, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">deriving (Eq,Ord,Show)</span></span><span class="mpre">

data </span><a name="loc_89_6_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_16&#39;)"><span class="hl_tycondecl"><span class="mpre">ExtContext</span></span></a><span class="mpre"> = </span><a name="loc_89_19_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_19_89_27&#39;)"><span class="hl_condecl"><span class="mpre">CodeCtxt</span></span></a><span class="mpre"> | </span><a name="loc_89_30_89_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_30_89_38&#39;)"><span class="hl_condecl"><span class="mpre">HarpCtxt</span></span></a><span class="mpre"> | </span><a name="loc_89_41_89_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_41_89_48&#39;)"><span class="hl_condecl"><span class="mpre">TagCtxt</span></span></a><span class="mpre"> | </span><a name="loc_89_51_89_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_51_89_60&#39;)"><span class="hl_condecl"><span class="mpre">ChildCtxt</span></span></a><span class="mpre">
        | </span><a name="loc_90_11_90_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_23&#39;)"><span class="hl_condecl"><span class="mpre">CloseTagCtxt</span></span></a><span class="mpre"> | </span><a name="loc_90_26_90_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_26_90_37&#39;)"><span class="hl_condecl"><span class="mpre">CodeTagCtxt</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 5, srcSpanEndLine = 91, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 5, srcSpanEndLine = 91, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">deriving (Eq,Ord,Show)</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 1, srcSpanEndLine = 93, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 1, srcSpanEndLine = 93, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">type CtxtFlag = (Bool,Bool)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (True,_) = We&#39;re in a do context.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (_, True)= Next token must be a virtual closing brace.</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 1, srcSpanEndLine = 97, srcSpanEndColumn = 65}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 1, srcSpanEndLine = 97, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">type ParseState = ([LexContext],[ExtContext],CtxtFlag,[Comment])</span></span><span class="mpre">

</span><a href="#loc_100_1_100_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_19&#39;)"><span class="mpre">indentOfParseState</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ParseState</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_100_1_100_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_19&#39;)"><span class="hl_fundecl"><span class="mpre">indentOfParseState</span></span></a><span class="mpre"> (</span><a href="#loc_86_30_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_30_86_36&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre"> </span><a name="loc_100_28_100_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_28_100_29&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_,_,_,_) = </span><a href="#loc_100_28_100_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_28_100_29&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><a href="#loc_100_1_100_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_19&#39;)"><span class="hl_fundecl"><span class="mpre">indentOfParseState</span></span></a><span class="mpre"> _                  = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Static parameters governing a parse.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Note that the various parse functions in &quot;Language.Haskell.Exts.Parser&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   never look at LANGUAGE pragmas, regardless of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   what the @ignoreLanguagePragmas@ flag is set to.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Only the various @parseFile@ functions in &quot;Language.Haskell.Exts&quot; will</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   act on it, when set to &#39;False&#39;.</span></span><span class="mpre">

data </span><a name="loc_110_6_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_15&#39;)"><span class="hl_tycondecl"><span class="mpre">ParseMode</span></span></a><span class="mpre"> = </span><a name="loc_110_18_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_27&#39;)"><span class="hl_condecl"><span class="mpre">ParseMode</span></span></a><span class="mpre"> {
        </span><span class="hl_comment"><span class="mpre">-- | original name of the file being parsed</span></span><span class="mpre">
        </span><a name="loc_112_9_112_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_22&#39;)"><span class="hl_fielddecl"><span class="mpre">parseFilename</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,
        </span><span class="hl_comment"><span class="mpre">-- | base language (e.g. Haskell98, Haskell2010)</span></span><span class="mpre">
        </span><a name="loc_114_9_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_21&#39;)"><span class="hl_fielddecl"><span class="mpre">baseLanguage</span></span></a><span class="mpre"> :: </span><a href="Language.Haskell.Exts.Extension.html#loc_79_6_79_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Exts.Extension.html#loc_79_6_79_14&#39;)"><span class="hl_tyconref"><span class="mpre">Language</span></span></a><span class="mpre">,
        </span><span class="hl_comment"><span class="mpre">-- | list of extensions enabled for parsing</span></span><span class="mpre">
        </span><a name="loc_116_9_116_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_19&#39;)"><span class="hl_fielddecl"><span class="mpre">extensions</span></span></a><span class="mpre"> :: [</span><a href="Language.Haskell.Exts.Extension.html#loc_117_6_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Exts.Extension.html#loc_117_6_117_15&#39;)"><span class="hl_tyconref"><span class="mpre">Extension</span></span></a><span class="mpre">],
        </span><span class="hl_comment"><span class="mpre">-- | if &#39;True&#39;, the parser won&#39;t care about further extensions</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">--   in LANGUAGE pragmas in source files</span></span><span class="mpre">
        </span><a name="loc_119_9_119_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_30&#39;)"><span class="hl_fielddecl"><span class="mpre">ignoreLanguagePragmas</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">,
        </span><span class="hl_comment"><span class="mpre">-- | if &#39;True&#39;, the parser won&#39;t read line position information</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">--   from LINE pragmas in source files</span></span><span class="mpre">
        </span><a name="loc_122_9_122_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_26&#39;)"><span class="hl_fielddecl"><span class="mpre">ignoreLinePragmas</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">,
        </span><span class="hl_comment"><span class="mpre">-- | list of fixities to be aware of</span></span><span class="mpre">
        </span><a name="loc_124_9_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_9_124_17&#39;)"><span class="hl_fielddecl"><span class="mpre">fixities</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Fixity</span></span><span class="mpre">]
        }

</span><span class="hl_comment"><span class="mpre">-- | Default parameters for a parse.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The default is an unknown filename,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   no extensions (i.e. Haskell 98),</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   don&#39;t ignore LANGUAGE pragmas, do ignore LINE pragmas,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   and be aware of fixities from the &#39;Prelude&#39;.</span></span><span class="mpre">
</span><a href="#loc_133_1_133_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_17&#39;)"><span class="mpre">defaultParseMode</span></a><span class="mpre"> :: </span><a href="#loc_110_6_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_15&#39;)"><span class="hl_tyconref"><span class="mpre">ParseMode</span></span></a><span class="mpre">
</span><a name="loc_133_1_133_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_17&#39;)"><span class="hl_vardecl"><span class="mpre">defaultParseMode</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 133, srcSpanStartColumn = 20, srcSpanEndLine = 140, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 133, srcSpanStartColumn = 30, srcSpanEndLine = 133, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/"><span class="mpre">ParseMode {
        parseFilename = &quot;&lt;unknown&gt;.hs&quot;,
        baseLanguage = Haskell2010,
        extensions = [],
        ignoreLanguagePragmas = False,
        ignoreLinePragmas = True,
        fixities = Just preludeFixities
        }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Version of ParseMode used internally,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- where the language and extensions have</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- been expanded</span></span><span class="mpre">
data </span><a name="loc_145_6_145_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_23&#39;)"><span class="hl_tycondecl"><span class="mpre">InternalParseMode</span></span></a><span class="mpre"> = </span><a name="loc_145_26_145_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_26_145_36&#39;)"><span class="hl_condecl"><span class="mpre">IParseMode</span></span></a><span class="mpre"> {
        </span><a name="loc_146_9_146_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_9_146_23&#39;)"><span class="hl_fielddecl"><span class="mpre">iParseFilename</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,
        </span><a name="loc_147_9_147_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_9_147_20&#39;)"><span class="hl_fielddecl"><span class="mpre">iExtensions</span></span></a><span class="mpre"> :: [</span><a href="Language.Haskell.Exts.Extension.html#loc_130_6_130_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Exts.Extension.html#loc_130_6_130_20&#39;)"><span class="hl_tyconref"><span class="mpre">KnownExtension</span></span></a><span class="mpre">],
        </span><span class="hl_fielddecl"><span class="mpre">iIgnoreLanguagePragmas</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">,
        </span><a name="loc_149_9_149_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_27&#39;)"><span class="hl_fielddecl"><span class="mpre">iIgnoreLinePragmas</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">,
        </span><span class="hl_fielddecl"><span class="mpre">iFixities</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Fixity</span></span><span class="mpre">]
    }

</span><a href="#loc_154_1_154_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_20&#39;)"><span class="mpre">toInternalParseMode</span></a><span class="mpre"> :: </span><a href="#loc_110_6_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_15&#39;)"><span class="hl_tyconref"><span class="mpre">ParseMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_145_6_145_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_23&#39;)"><span class="hl_tyconref"><span class="mpre">InternalParseMode</span></span></a><span class="mpre">
</span><a name="loc_154_1_154_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_20&#39;)"><span class="hl_fundecl"><span class="mpre">toInternalParseMode</span></span></a><span class="mpre"> (</span><a href="#loc_110_18_110_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_27&#39;)"><span class="hl_conref"><span class="mpre">ParseMode</span></span></a><span class="mpre"> </span><a name="loc_154_32_154_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_32_154_34&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre"> </span><a name="loc_154_35_154_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_35_154_40&#39;)"><span class="hl_vardecl"><span class="mpre">bLang</span></span></a><span class="mpre"> </span><a name="loc_154_41_154_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_41_154_45&#39;)"><span class="hl_vardecl"><span class="mpre">exts</span></span></a><span class="mpre"> </span><a name="loc_154_46_154_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_46_154_51&#39;)"><span class="hl_vardecl"><span class="mpre">ilang</span></span></a><span class="mpre"> </span><a name="loc_154_52_154_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_52_154_57&#39;)"><span class="hl_vardecl"><span class="mpre">iline</span></span></a><span class="mpre"> </span><a name="loc_154_58_154_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_58_154_60&#39;)"><span class="hl_vardecl"><span class="mpre">fx</span></span></a><span class="mpre">) =
    </span><a href="#loc_145_26_145_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_26_145_36&#39;)"><span class="hl_conref"><span class="mpre">IParseMode</span></span></a><span class="mpre"> </span><a href="#loc_154_32_154_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_32_154_34&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.Exts.Extension.html#loc_503_1_503_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Exts.Extension.html#loc_503_1_503_12&#39;)"><span class="hl_varref"><span class="mpre">impliesExts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Language.Haskell.Exts.Extension.html#loc_644_1_644_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Exts.Extension.html#loc_644_1_644_16&#39;)"><span class="hl_varref"><span class="mpre">toExtensionList</span></span></a><span class="mpre"> </span><a href="#loc_154_35_154_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_35_154_40&#39;)"><span class="hl_varref"><span class="mpre">bLang</span></span></a><span class="mpre"> </span><a href="#loc_154_41_154_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_41_154_45&#39;)"><span class="hl_varref"><span class="mpre">exts</span></span></a><span class="mpre">) </span><a href="#loc_154_46_154_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_46_154_51&#39;)"><span class="hl_varref"><span class="mpre">ilang</span></span></a><span class="mpre"> </span><a href="#loc_154_52_154_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_52_154_57&#39;)"><span class="hl_varref"><span class="mpre">iline</span></span></a><span class="mpre"> </span><a href="#loc_154_58_154_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_58_154_60&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Monad for parsing</span></span><span class="mpre">

newtype </span><a name="loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tycondecl"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_condecl"><span class="mpre">P</span></span></a><span class="mpre"> { </span><a name="loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_fielddecl"><span class="mpre">runP</span></span></a><span class="mpre"> ::
                </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- input string</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                 </span><span class="hl_comment"><span class="mpre">-- current column</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                 </span><span class="hl_comment"><span class="mpre">-- current line</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">SrcLoc</span></span><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- location of last token read</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">ParseState</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- layout info.</span></span><span class="mpre">
             -&gt; </span><a href="#loc_145_6_145_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_23&#39;)"><span class="hl_tyconref"><span class="mpre">InternalParseMode</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- parse parameters</span></span><span class="mpre">
             -&gt; </span><a href="#loc_83_6_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_6_83_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseStatus</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
        }

</span><a href="#loc_180_1_180_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_18&#39;)"><span class="mpre">runParserWithMode</span></a><span class="mpre"> :: </span><a href="#loc_110_6_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_15&#39;)"><span class="hl_tyconref"><span class="mpre">ParseMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_6_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-runParserWithMode mode (P m) s = case m s 0 1 start ([],[],(False,False),[]) mode of
    Ok _ a -&gt; ParseOk a
    Failed loc msg -&gt; ParseFailed loc msg
    where start = SrcLoc {
        srcFilename = parseFilename mode,
        srcLine = 1,
        srcColumn = 1
    }
-}</span></span><span class="mpre">
</span><a name="loc_180_1_180_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_18&#39;)"><span class="hl_fundecl"><span class="mpre">runParserWithMode</span></span></a><span class="mpre"> </span><a name="loc_180_19_180_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_19_180_23&#39;)"><span class="hl_vardecl"><span class="mpre">mode</span></span></a><span class="mpre"> </span><a name="loc_180_24_180_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_24_180_26&#39;)"><span class="hl_vardecl"><span class="mpre">pm</span></span></a><span class="mpre"> </span><a name="loc_180_27_180_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_27_180_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_186_1_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_26&#39;)"><span class="hl_varref"><span class="mpre">runParserWithModeComments</span></span></a><span class="mpre"> </span><a href="#loc_180_19_180_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_19_180_23&#39;)"><span class="hl_varref"><span class="mpre">mode</span></span></a><span class="mpre"> </span><a href="#loc_180_24_180_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_24_180_26&#39;)"><span class="hl_varref"><span class="mpre">pm</span></span></a><span class="mpre"> </span><a href="#loc_180_27_180_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_27_180_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_183_1_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_10&#39;)"><span class="mpre">runParser</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_6_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_183_1_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_10&#39;)"><span class="hl_vardecl"><span class="mpre">runParser</span></span></a><span class="mpre"> = </span><a href="#loc_180_1_180_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_18&#39;)"><span class="hl_varref"><span class="mpre">runParserWithMode</span></span></a><span class="mpre"> </span><a href="#loc_133_1_133_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_17&#39;)"><span class="hl_varref"><span class="mpre">defaultParseMode</span></span></a><span class="mpre">

</span><a href="#loc_186_1_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_26&#39;)"><span class="mpre">runParserWithModeComments</span></a><span class="mpre"> :: </span><a href="#loc_110_6_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_15&#39;)"><span class="hl_tyconref"><span class="mpre">ParseMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_6_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">Comment</span></span><span class="mpre">])
</span><a name="loc_186_1_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_26&#39;)"><span class="hl_fundecl"><span class="mpre">runParserWithModeComments</span></span></a><span class="mpre"> </span><a name="loc_186_27_186_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_27_186_31&#39;)"><span class="hl_vardecl"><span class="mpre">mode</span></span></a><span class="mpre"> (</span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_186_35_186_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_35_186_36&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) </span><a name="loc_186_38_186_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_38_186_39&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = 
  case </span><a href="#loc_186_35_186_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_35_186_36&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_186_38_186_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_38_186_39&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_190_11_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_16&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre"> ([],[],(</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">),[]) (</span><a href="#loc_154_1_154_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_20&#39;)"><span class="hl_varref"><span class="mpre">toInternalParseMode</span></span></a><span class="mpre"> </span><a href="#loc_186_27_186_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_27_186_31&#39;)"><span class="hl_varref"><span class="mpre">mode</span></span></a><span class="mpre">) of
    </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> (_,_,_,</span><a name="loc_188_15_188_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_15_188_17&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) </span><a name="loc_188_19_188_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_19_188_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_48_7_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_14&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> (</span><a href="#loc_188_19_188_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_19_188_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_188_15_188_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_15_188_17&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
    </span><a href="#loc_83_40_83_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_40_83_46&#39;)"><span class="hl_conref"><span class="mpre">Failed</span></span></a><span class="mpre"> </span><a name="loc_189_12_189_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_12_189_15&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_189_16_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_16_189_19&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_49_7_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_18&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a href="#loc_189_12_189_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_12_189_15&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_189_16_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_16_189_19&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
    where </span><a name="loc_190_11_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_16&#39;)"><span class="hl_vardecl"><span class="mpre">start</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 19, srcSpanEndLine = 194, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 26, srcSpanEndLine = 190, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/"><span class="mpre">SrcLoc {
        srcFilename = parseFilename mode,
        srcLine = 1,
        srcColumn = 1
        }</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">--        allExts mode@(ParseMode {extensions = es}) = mode { extensions = impliesExts es }</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">--      allExts mode = let imode = to</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_200_12_200_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> </span><a name="loc_200_33_200_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_33_200_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_m</span></span><span class="mpre"> -&gt; </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> </span><a href="#loc_200_33_200_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_33_200_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_200_12_200_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_201_7_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_7_201_8&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_201_13_201_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_13_201_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_201_22_201_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_22_201_23&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_201_24_201_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_24_201_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_201_26_201_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_26_201_27&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_201_28_201_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_28_201_29&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_201_30_201_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_30_201_31&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_201_32_201_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_32_201_36&#39;)"><span class="hl_vardecl"><span class="mpre">mode</span></span></a><span class="mpre"> -&gt;
        case </span><a href="#loc_201_7_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_7_201_8&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_201_22_201_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_22_201_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_201_24_201_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_24_201_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_201_26_201_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_26_201_27&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_201_28_201_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_28_201_29&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_201_30_201_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_30_201_31&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_201_32_201_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_32_201_36&#39;)"><span class="hl_varref"><span class="mpre">mode</span></span></a><span class="mpre"> of
            </span><a href="#loc_83_40_83_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_40_83_46&#39;)"><span class="hl_conref"><span class="mpre">Failed</span></span></a><span class="mpre"> </span><a name="loc_203_20_203_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_20_203_23&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_203_24_203_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_24_203_27&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_83_40_83_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_40_83_46&#39;)"><span class="hl_conref"><span class="mpre">Failed</span></span></a><span class="mpre"> </span><a href="#loc_203_20_203_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_20_203_23&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_203_24_203_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_24_203_27&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
            </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> </span><a name="loc_204_16_204_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_16_204_18&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a name="loc_204_19_204_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_19_204_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_201_13_201_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_13_201_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_204_19_204_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_19_204_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_201_22_201_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_22_201_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_201_24_201_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_24_201_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_201_26_201_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_26_201_27&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_201_28_201_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_28_201_29&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_204_16_204_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_16_204_18&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_201_32_201_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_32_201_36&#39;)"><span class="hl_varref"><span class="mpre">mode</span></span></a><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> </span><a name="loc_205_10_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_r</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_col</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_line</span></span><span class="mpre"> </span><a name="loc_205_33_205_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_33_205_36&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_stk</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_m</span></span><span class="mpre"> -&gt; </span><a href="#loc_83_40_83_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_40_83_46&#39;)"><span class="hl_conref"><span class="mpre">Failed</span></span></a><span class="mpre"> </span><a href="#loc_205_33_205_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_33_205_36&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_205_10_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_208_5_208_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_5_208_15&#39;)"><span class="mpre">atSrcLoc</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SrcLoc</span></span><span class="mpre"> -&gt; </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_208_3_208_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_4&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_208_5_208_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_5_208_15&#39;)"><span class="hl_fundecl"><span class="mpre">`atSrcLoc`</span></span></a><span class="mpre"> </span><a name="loc_208_16_208_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_16_208_19&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_208_27_208_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_27_208_28&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_208_29_208_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_29_208_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_208_31_208_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_31_208_32&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> -&gt; </span><a href="#loc_208_3_208_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_208_27_208_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_27_208_28&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_208_29_208_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_29_208_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_208_31_208_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_31_208_32&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_208_16_208_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_16_208_19&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">

</span><a href="#loc_211_1_211_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_10&#39;)"><span class="mpre">getSrcLoc</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SrcLoc</span></span><span class="mpre">
</span><a name="loc_211_1_211_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_10&#39;)"><span class="hl_vardecl"><span class="mpre">getSrcLoc</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><a name="loc_211_27_211_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_27_211_28&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_211_29_211_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_29_211_30&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_m</span></span><span class="mpre"> -&gt; </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> </span><a href="#loc_211_29_211_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_29_211_30&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_211_27_211_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_27_211_28&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><a href="#loc_214_1_214_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_14&#39;)"><span class="mpre">getModuleName</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_214_1_214_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_14&#39;)"><span class="hl_vardecl"><span class="mpre">getModuleName</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> </span><a name="loc_214_34_214_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_34_214_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_214_36_214_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_36_214_37&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt;
    let </span><a name="loc_215_9_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_11&#39;)"><span class="hl_vardecl"><span class="mpre">fn</span></span></a><span class="mpre"> = </span><a href="#loc_146_9_146_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_9_146_23&#39;)"><span class="hl_varref"><span class="mpre">iParseFilename</span></span></a><span class="mpre"> </span><a href="#loc_214_36_214_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_36_214_37&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
        </span><a name="loc_216_9_216_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_9_216_11&#39;)"><span class="hl_vardecl"><span class="mpre">mn</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_427_1_427_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_427_1_427_12&#39;)"><span class="hl_varref"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_219_9_219_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_18&#39;)"><span class="hl_varref"><span class="mpre">splitPath</span></span></a><span class="mpre"> </span><a href="#loc_215_9_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_11&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre">

        </span><a href="#loc_219_9_219_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_18&#39;)"><span class="mpre">splitPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
        </span><a name="loc_219_9_219_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_18&#39;)"><span class="hl_fundecl"><span class="mpre">splitPath</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">   = []
        </span><a href="#loc_219_9_219_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_18&#39;)"><span class="hl_fundecl"><span class="mpre">splitPath</span></span></a><span class="mpre"> </span><a name="loc_220_19_220_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_19_220_22&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">  = let (</span><a name="loc_220_31_220_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_31_220_32&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_220_33_220_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_33_220_37&#39;)"><span class="hl_vardecl"><span class="mpre">str&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre">) </span><a href="#loc_220_19_220_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_19_220_22&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
                          in case </span><a href="#loc_220_33_220_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_33_220_37&#39;)"><span class="hl_varref"><span class="mpre">str&#39;</span></span></a><span class="mpre"> of
                              []      -&gt; [</span><a href="#loc_225_9_225_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_21&#39;)"><span class="hl_varref"><span class="mpre">removeSuffix</span></span></a><span class="mpre"> </span><a href="#loc_220_31_220_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_31_220_32&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">]
                              (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_223_34_223_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_34_223_39&#39;)"><span class="hl_vardecl"><span class="mpre">str&#39;&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_220_31_220_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_31_220_32&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_219_9_219_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_18&#39;)"><span class="hl_varref"><span class="mpre">splitPath</span></span></a><span class="mpre"> </span><a href="#loc_223_34_223_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_34_223_39&#39;)"><span class="hl_varref"><span class="mpre">str&#39;&#39;</span></span></a><span class="mpre">

        </span><a name="loc_225_9_225_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_21&#39;)"><span class="hl_fundecl"><span class="mpre">removeSuffix</span></span></a><span class="mpre"> </span><a name="loc_225_22_225_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_22_225_23&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_225_22_225_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_22_225_23&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

     in </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> </span><a href="#loc_214_34_214_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_34_214_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_216_9_216_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_9_216_11&#39;)"><span class="hl_varref"><span class="mpre">mn</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Enter a new layout context.  If we are already in a layout context,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ensure that the new indent is greater than the indent of that context.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (So if the source loc is not to the right of the current indent, an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- empty list {} will be inserted.)</span></span><span class="mpre">

</span><a href="#loc_235_1_235_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_19&#39;)"><span class="mpre">pushCurrentContext</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_235_1_235_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_19&#39;)"><span class="hl_vardecl"><span class="mpre">pushCurrentContext</span></span></a><span class="mpre"> = do
    </span><a name="loc_236_5_236_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_5_236_7&#39;)"><span class="hl_vardecl"><span class="mpre">lc</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_211_1_211_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_10&#39;)"><span class="hl_varref"><span class="mpre">getSrcLoc</span></span></a><span class="mpre">
    </span><a name="loc_237_5_237_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_5_237_11&#39;)"><span class="hl_vardecl"><span class="mpre">indent</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_245_1_245_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_14&#39;)"><span class="hl_varref"><span class="mpre">currentIndent</span></span></a><span class="mpre">
    </span><a name="loc_238_5_238_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_8&#39;)"><span class="hl_vardecl"><span class="mpre">dob</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_284_1_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_1_284_13&#39;)"><span class="hl_varref"><span class="mpre">pullDoStatus</span></span></a><span class="mpre">
    let </span><a name="loc_239_9_239_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_9_239_12&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">srcColumn</span></span><span class="mpre"> </span><a href="#loc_236_5_236_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_5_236_7&#39;)"><span class="hl_varref"><span class="mpre">lc</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_238_5_238_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_8&#39;)"><span class="hl_varref"><span class="mpre">dob</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_239_9_239_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_9_239_12&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_237_5_237_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_5_237_11&#39;)"><span class="hl_varref"><span class="mpre">indent</span></span></a><span class="mpre">
           </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_238_5_238_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_8&#39;)"><span class="hl_varref"><span class="mpre">dob</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_239_9_239_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_9_239_12&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_237_5_237_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_5_237_11&#39;)"><span class="hl_varref"><span class="mpre">indent</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_278_1_278_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_13&#39;)"><span class="hl_varref"><span class="mpre">pushCtxtFlag</span></span></a><span class="mpre">
    </span><a href="#loc_248_1_248_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_12&#39;)"><span class="hl_varref"><span class="mpre">pushContext</span></span></a><span class="mpre"> (</span><a href="#loc_86_30_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_30_86_36&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre"> </span><a href="#loc_239_9_239_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_9_239_12&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><a href="#loc_245_1_245_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_14&#39;)"><span class="mpre">currentIndent</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_245_1_245_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_14&#39;)"><span class="hl_vardecl"><span class="mpre">currentIndent</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_r</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">loc</span></span><span class="mpre"> </span><a name="loc_245_35_245_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_35_245_38&#39;)"><span class="hl_vardecl"><span class="mpre">stk</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_mode</span></span><span class="mpre"> -&gt; </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> </span><a href="#loc_245_35_245_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_35_245_38&#39;)"><span class="hl_varref"><span class="mpre">stk</span></span></a><span class="mpre"> (</span><a href="#loc_100_1_100_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_19&#39;)"><span class="hl_varref"><span class="mpre">indentOfParseState</span></span></a><span class="mpre"> </span><a href="#loc_245_35_245_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_35_245_38&#39;)"><span class="hl_varref"><span class="mpre">stk</span></span></a><span class="mpre">)

</span><a href="#loc_248_1_248_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_12&#39;)"><span class="mpre">pushContext</span></a><span class="mpre"> :: </span><a href="#loc_86_6_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_16&#39;)"><span class="hl_tyconref"><span class="mpre">LexContext</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_248_1_248_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_12&#39;)"><span class="hl_fundecl"><span class="mpre">pushContext</span></span></a><span class="mpre"> </span><a name="loc_248_13_248_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_13_248_17&#39;)"><span class="hl_vardecl"><span class="mpre">ctxt</span></span></a><span class="mpre"> =
</span><span class="hl_comment"><span class="mpre">--trace (&quot;pushing lexical scope: &quot; ++ show ctxt ++&quot;\n&quot;) $</span></span><span class="mpre">
    </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> (</span><a name="loc_250_23_250_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_23_250_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_250_26_250_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_26_250_27&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, </span><a name="loc_250_29_250_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_29_250_30&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_250_32_250_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_32_250_33&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_vardecl"><span class="mpre">_m</span></span><span class="mpre"> -&gt; </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> (</span><a href="#loc_248_13_248_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_13_248_17&#39;)"><span class="hl_varref"><span class="mpre">ctxt</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_250_23_250_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_23_250_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_250_26_250_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_26_250_27&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, </span><a href="#loc_250_29_250_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_29_250_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_250_32_250_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_32_250_33&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_253_1_253_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_11&#39;)"><span class="mpre">popContext</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_253_1_253_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_11&#39;)"><span class="hl_vardecl"><span class="mpre">popContext</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><a name="loc_253_28_253_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_28_253_31&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_253_32_253_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_32_253_35&#39;)"><span class="hl_vardecl"><span class="mpre">stk</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_m</span></span><span class="mpre"> -&gt;
      case </span><a href="#loc_253_32_253_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_32_253_35&#39;)"><span class="hl_varref"><span class="mpre">stk</span></span></a><span class="mpre"> of
        (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_255_12_255_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_12_255_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_255_15_255_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_15_255_16&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, </span><a name="loc_255_18_255_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_18_255_19&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_255_21_255_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_21_255_22&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) -&gt; </span><span class="hl_comment"><span class="mpre">--trace (&quot;popping lexical scope, context now &quot;++show s ++ &quot;\n&quot;) $</span></span><span class="mpre">
                          </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> (</span><a href="#loc_255_12_255_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_12_255_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_255_15_255_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_15_255_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, </span><a href="#loc_255_18_255_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_18_255_19&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_255_21_255_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_21_255_22&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        ([],_,_,_)     -&gt; </span><a href="#loc_83_40_83_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_40_83_46&#39;)"><span class="hl_conref"><span class="mpre">Failed</span></span></a><span class="mpre"> </span><a href="#loc_253_28_253_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_28_253_31&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Unexpected }&quot;</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- error &quot;Internal error: empty context in popContext&quot;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- HaRP/Hsx</span></span><span class="mpre">
</span><a href="#loc_262_1_262_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_15&#39;)"><span class="mpre">pushExtContext</span></a><span class="mpre"> :: </span><a href="#loc_89_6_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_16&#39;)"><span class="hl_tyconref"><span class="mpre">ExtContext</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_262_1_262_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_15&#39;)"><span class="hl_fundecl"><span class="mpre">pushExtContext</span></span></a><span class="mpre"> </span><a name="loc_262_16_262_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_16_262_20&#39;)"><span class="hl_vardecl"><span class="mpre">ctxt</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> (</span><a name="loc_262_41_262_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_41_262_42&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_262_44_262_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_44_262_45&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, </span><a name="loc_262_47_262_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_47_262_48&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_262_50_262_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_50_262_51&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_vardecl"><span class="mpre">_m</span></span><span class="mpre"> -&gt; </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> (</span><a href="#loc_262_41_262_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_41_262_42&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_262_16_262_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_16_262_20&#39;)"><span class="hl_varref"><span class="mpre">ctxt</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_262_44_262_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_44_262_45&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, </span><a href="#loc_262_47_262_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_47_262_48&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_262_50_262_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_50_262_51&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_265_1_265_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_1_265_14&#39;)"><span class="mpre">popExtContext</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_265_1_265_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_1_265_14&#39;)"><span class="hl_vardecl"><span class="mpre">popExtContext</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> (</span><a name="loc_265_35_265_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_35_265_36&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_265_38_265_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_38_265_39&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, </span><a name="loc_265_41_265_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_41_265_42&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_265_44_265_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_44_265_45&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_vardecl"><span class="mpre">_m</span></span><span class="mpre"> -&gt;
    case </span><a href="#loc_265_38_265_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_38_265_39&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
     (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_267_9_267_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_9_267_11&#39;)"><span class="hl_vardecl"><span class="mpre">e&#39;</span></span></a><span class="mpre">) -&gt;
       </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> (</span><a href="#loc_265_35_265_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_35_265_36&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_267_9_267_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_9_267_11&#39;)"><span class="hl_varref"><span class="mpre">e&#39;</span></span></a><span class="mpre">, </span><a href="#loc_265_41_265_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_41_265_42&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_265_44_265_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_44_265_45&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
     [] -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Internal error: empty context in popExtContext&quot;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Extension-aware lexing/parsing</span></span><span class="mpre">
</span><a href="#loc_274_1_274_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_1_274_14&#39;)"><span class="mpre">getExtensions</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.Exts.Extension.html#loc_130_6_130_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Exts.Extension.html#loc_130_6_130_20&#39;)"><span class="hl_tyconref"><span class="mpre">KnownExtension</span></span></a><span class="mpre">]
</span><a name="loc_274_1_274_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_1_274_14&#39;)"><span class="hl_vardecl"><span class="mpre">getExtensions</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> </span><a name="loc_274_34_274_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_34_274_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_274_36_274_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_36_274_37&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> </span><a href="#loc_274_34_274_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_34_274_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_147_9_147_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_9_147_20&#39;)"><span class="hl_varref"><span class="mpre">iExtensions</span></span></a><span class="mpre"> </span><a href="#loc_274_36_274_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_36_274_37&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><a href="#loc_278_1_278_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_13&#39;)"><span class="mpre">pushCtxtFlag</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_278_1_278_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_13&#39;)"><span class="hl_vardecl"><span class="mpre">pushCtxtFlag</span></span></a><span class="mpre"> =
    </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> (</span><a name="loc_279_23_279_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_23_279_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_279_26_279_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_26_279_27&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, (</span><a name="loc_279_30_279_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_30_279_31&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">,</span><a name="loc_279_32_279_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_32_279_33&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">), </span><a name="loc_279_36_279_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_36_279_38&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) </span><span class="hl_vardecl"><span class="mpre">_m</span></span><span class="mpre"> -&gt; case </span><a href="#loc_279_32_279_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_32_279_33&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> -&gt; </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> (</span><a href="#loc_279_23_279_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_23_279_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_279_26_279_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_26_279_27&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, (</span><a href="#loc_279_30_279_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_30_279_31&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">), </span><a href="#loc_279_36_279_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_36_279_38&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        _     -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Internal error: context flag already pushed&quot;</span></span><span class="mpre">

</span><a href="#loc_284_1_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_1_284_13&#39;)"><span class="mpre">pullDoStatus</span></a><span class="mpre"> :: </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_284_1_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_1_284_13&#39;)"><span class="hl_vardecl"><span class="mpre">pullDoStatus</span></span></a><span class="mpre"> = </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> (</span><a name="loc_284_34_284_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_34_284_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_284_37_284_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_37_284_38&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, (</span><a name="loc_284_41_284_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_41_284_42&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">,</span><a name="loc_284_43_284_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_43_284_44&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">), </span><a name="loc_284_47_284_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_47_284_49&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) </span><span class="hl_vardecl"><span class="mpre">_m</span></span><span class="mpre"> -&gt; </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_conref"><span class="mpre">Ok</span></span></a><span class="mpre"> (</span><a href="#loc_284_34_284_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_34_284_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_284_37_284_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_37_284_38&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">,</span><a href="#loc_284_43_284_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_43_284_44&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">),</span><a href="#loc_284_47_284_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_47_284_49&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) </span><a href="#loc_284_41_284_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_41_284_42&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Monad for lexical analysis:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a continuation-passing version of the parsing monad</span></span><span class="mpre">

newtype </span><a name="loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_condecl"><span class="mpre">Lex</span></span></a><span class="mpre"> { </span><a name="loc_291_25_291_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_25_291_29&#39;)"><span class="hl_fielddecl"><span class="mpre">runL</span></span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> }

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_294_12_294_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_12_294_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_294_23_294_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_23_294_24&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_294_23_294_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_23_294_24&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_294_12_294_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_12_294_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><a name="loc_295_9_295_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_9_295_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_295_15_295_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_15_295_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_295_26_295_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_26_295_27&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_295_9_295_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_9_295_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (\</span><a name="loc_295_35_295_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_35_295_36&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_291_25_291_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_25_291_29&#39;)"><span class="hl_varref"><span class="mpre">runL</span></span></a><span class="mpre"> (</span><a href="#loc_295_15_295_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_15_295_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_295_35_295_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_35_295_36&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_295_26_295_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_26_295_27&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
    </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><a name="loc_296_9_296_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_9_296_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><a name="loc_296_18_296_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_18_296_19&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_296_29_296_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_29_296_30&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_296_9_296_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_9_296_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (\_ -&gt; </span><a href="#loc_296_18_296_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_18_296_19&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_296_29_296_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_29_296_30&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
    </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> </span><a name="loc_297_10_297_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_10_297_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><a href="#loc_297_10_297_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_10_297_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Operations on this monad</span></span><span class="mpre">

</span><a href="#loc_302_1_302_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_9&#39;)"><span class="mpre">getInput</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_302_1_302_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_9&#39;)"><span class="hl_vardecl"><span class="mpre">getInput</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_302_19_302_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_19_302_23&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_302_32_302_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_32_302_33&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_302_19_302_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_19_302_23&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a href="#loc_302_32_302_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_32_302_33&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">) </span><a href="#loc_302_32_302_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_32_302_33&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Discard some input characters (these must not include tabs or newlines).</span></span><span class="mpre">

</span><a href="#loc_307_1_307_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_8&#39;)"><span class="mpre">discard</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_307_1_307_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_8&#39;)"><span class="hl_fundecl"><span class="mpre">discard</span></span></a><span class="mpre"> </span><a name="loc_307_9_307_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_9_307_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_307_20_307_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_20_307_24&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_307_33_307_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_33_307_34&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_307_35_307_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_35_307_36&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_307_20_307_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_20_307_24&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><a href="#loc_307_9_307_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_9_307_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_307_33_307_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_33_307_34&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">) (</span><a href="#loc_307_35_307_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_35_307_36&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_307_9_307_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_9_307_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Discard the next character, which must be a newline.</span></span><span class="mpre">

</span><a href="#loc_312_1_312_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_11&#39;)"><span class="mpre">lexNewline</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_312_1_312_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_11&#39;)"><span class="hl_vardecl"><span class="mpre">lexNewline</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_312_21_312_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_21_312_25&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_312_34_312_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_34_312_36&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><a name="loc_312_40_312_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_40_312_41&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_312_42_312_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_42_312_45&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> -&gt;
  case </span><a href="#loc_312_34_312_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_34_312_36&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre"> of
    (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_314_8_314_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_8_314_9&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_312_21_312_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_21_312_25&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_314_8_314_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_8_314_9&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_312_40_312_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_40_312_41&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_312_42_312_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_42_312_45&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">
    []    -&gt; \_ _ -&gt; </span><a href="#loc_83_40_83_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_40_83_46&#39;)"><span class="hl_conref"><span class="mpre">Failed</span></span></a><span class="mpre"> </span><a href="#loc_312_42_312_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_42_312_45&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Lexer: expected newline.&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Discard the next character, which must be a tab.</span></span><span class="mpre">

</span><a href="#loc_320_1_320_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_7&#39;)"><span class="mpre">lexTab</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_320_1_320_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_7&#39;)"><span class="hl_vardecl"><span class="mpre">lexTab</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_320_17_320_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_17_320_21&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_320_33_320_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_33_320_34&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) </span><a name="loc_320_36_320_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_36_320_37&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_320_17_320_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_17_320_21&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_320_33_320_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_33_320_34&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> (</span><a href="#loc_323_1_323_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_1_323_8&#39;)"><span class="hl_varref"><span class="mpre">nextTab</span></span></a><span class="mpre"> </span><a href="#loc_320_36_320_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_36_320_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><a href="#loc_323_1_323_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_1_323_8&#39;)"><span class="mpre">nextTab</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_323_1_323_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_1_323_8&#39;)"><span class="hl_fundecl"><span class="mpre">nextTab</span></span></a><span class="mpre"> </span><a name="loc_323_9_323_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_9_323_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_323_9_323_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_9_323_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_326_1_326_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_11&#39;)"><span class="hl_varref"><span class="mpre">tAB_LENGTH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><a href="#loc_323_9_323_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_9_323_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_326_1_326_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_11&#39;)"><span class="hl_varref"><span class="mpre">tAB_LENGTH</span></span></a><span class="mpre">)

</span><a href="#loc_326_1_326_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_11&#39;)"><span class="mpre">tAB_LENGTH</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_326_1_326_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_11&#39;)"><span class="hl_vardecl"><span class="mpre">tAB_LENGTH</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Consume and return the largest string of characters satisfying p</span></span><span class="mpre">

</span><a href="#loc_331_1_331_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_1_331_9&#39;)"><span class="mpre">lexWhile</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_331_1_331_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_1_331_9&#39;)"><span class="hl_fundecl"><span class="mpre">lexWhile</span></span></a><span class="mpre"> </span><a name="loc_331_10_331_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_10_331_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_331_21_331_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_21_331_25&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_331_34_331_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_34_331_35&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_331_36_331_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_36_331_37&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt;
    let (</span><a name="loc_332_10_332_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_10_332_12&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">,</span><a name="loc_332_13_332_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_13_332_17&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="#loc_331_10_331_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_10_331_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_331_34_331_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_34_331_35&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> in
    </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_331_21_331_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_21_331_25&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a href="#loc_332_10_332_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_10_332_12&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) </span><a href="#loc_332_13_332_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_13_332_17&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> (</span><a href="#loc_331_36_331_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_36_331_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_332_10_332_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_10_332_12&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- An alternative scan, to which we can return if subsequent scanning</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is unsuccessful.</span></span><span class="mpre">

</span><a href="#loc_339_1_339_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_12&#39;)"><span class="mpre">alternative</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)
</span><a name="loc_339_1_339_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_12&#39;)"><span class="hl_fundecl"><span class="mpre">alternative</span></span></a><span class="mpre"> (</span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><a name="loc_339_18_339_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_18_339_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_339_30_339_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_30_339_34&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_339_43_339_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_43_339_44&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_339_45_339_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_45_339_46&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_339_47_339_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_47_339_48&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_339_30_339_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_30_339_34&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> (</span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_340_24_340_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_24_340_29&#39;)"><span class="hl_vardecl"><span class="mpre">cont&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_r</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_y</span></span><span class="mpre"> -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_339_18_339_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_18_339_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_340_24_340_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_24_340_29&#39;)"><span class="hl_varref"><span class="mpre">cont&#39;</span></span></a><span class="mpre">) </span><a href="#loc_339_43_339_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_43_339_44&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_339_45_339_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_45_339_46&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_339_47_339_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_47_339_48&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)) </span><a href="#loc_339_43_339_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_43_339_44&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_339_45_339_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_45_339_46&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_339_47_339_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_47_339_48&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- The source location is the coordinates of the previous token,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or, while scanning a token, the start of the current token.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- col is the current column in the source file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We also need to remember between scanning tokens whether we are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- somewhere at the beginning of the line before the first token.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This could be done with an extra Bool argument to the P monad,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- but as a hack we use a col value of 0 to indicate this situation.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Setting col to 0 is used in two places: just after emitting a virtual</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- close brace due to layout, so that next time through we check whether</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- we also need to emit a semi-colon, and at the beginning of the file,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by runParser, to kick off the lexer.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Thus when col is zero, the true column can be taken from the loc.</span></span><span class="mpre">

</span><a href="#loc_359_1_359_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_1_359_9&#39;)"><span class="mpre">checkBOL</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_359_1_359_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_1_359_9&#39;)"><span class="hl_vardecl"><span class="mpre">checkBOL</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_359_19_359_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_19_359_23&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_359_32_359_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_32_359_33&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_359_34_359_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_34_359_35&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_359_36_359_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_36_359_37&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_359_38_359_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_38_359_41&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> -&gt;
        if </span><a href="#loc_359_34_359_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_34_359_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_359_19_359_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_19_359_23&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) </span><a href="#loc_359_32_359_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_32_359_33&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">srcColumn</span></span><span class="mpre"> </span><a href="#loc_359_38_359_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_38_359_41&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">) </span><a href="#loc_359_36_359_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_36_359_37&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_359_38_359_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_38_359_41&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">
            else </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_359_19_359_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_19_359_23&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">) </span><a href="#loc_359_32_359_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_32_359_33&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_359_34_359_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_34_359_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_359_36_359_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_36_359_37&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_359_38_359_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_38_359_41&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">

</span><a href="#loc_364_1_364_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_7&#39;)"><span class="mpre">setBOL</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_364_1_364_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_7&#39;)"><span class="hl_vardecl"><span class="mpre">setBOL</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_364_17_364_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_17_364_21&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_364_30_364_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_30_364_31&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> _ -&gt; </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_364_17_364_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_17_364_21&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_364_30_364_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_30_364_31&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Set the loc to the current position</span></span><span class="mpre">

</span><a href="#loc_369_1_369_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_1_369_11&#39;)"><span class="mpre">startToken</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_369_1_369_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_1_369_11&#39;)"><span class="hl_vardecl"><span class="mpre">startToken</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_369_21_369_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_21_369_25&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_369_34_369_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_34_369_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_369_36_369_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_36_369_37&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_369_38_369_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_38_369_39&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> _ </span><a name="loc_369_42_369_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_42_369_45&#39;)"><span class="hl_vardecl"><span class="mpre">stk</span></span></a><span class="mpre"> </span><a name="loc_369_46_369_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_46_369_50&#39;)"><span class="hl_vardecl"><span class="mpre">mode</span></span></a><span class="mpre"> -&gt;
    let </span><a name="loc_370_9_370_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_9_370_12&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 370, srcSpanStartColumn = 15, srcSpanEndLine = 374, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 370, srcSpanStartColumn = 22, srcSpanEndLine = 370, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/n"><span class="mpre">SrcLoc {
        srcFilename = iParseFilename mode,
        srcLine = y,
        srcColumn = x
    }</span></span><span class="mpre"> in
    </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_369_21_369_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_21_369_25&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_369_34_369_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_34_369_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_369_36_369_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_36_369_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_369_38_369_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_38_369_39&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_370_9_370_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_9_370_12&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_369_42_369_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_42_369_45&#39;)"><span class="hl_varref"><span class="mpre">stk</span></span></a><span class="mpre"> </span><a href="#loc_369_46_369_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_46_369_50&#39;)"><span class="hl_varref"><span class="mpre">mode</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Current status with respect to the offside (layout) rule:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- LT: we are to the left of the current indent (if any)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- EQ: we are at the current indent (if any)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- GT: we are to the right of the current indent, or not subject to layout</span></span><span class="mpre">

</span><a href="#loc_383_1_383_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_11&#39;)"><span class="mpre">getOffside</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ordering</span></span><span class="mpre">
</span><a name="loc_383_1_383_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_11&#39;)"><span class="hl_vardecl"><span class="mpre">getOffside</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_383_21_383_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_21_383_25&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_383_34_383_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_34_383_35&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_383_36_383_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_36_383_37&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_383_38_383_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_38_383_39&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_383_40_383_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_40_383_43&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_383_44_383_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_44_383_47&#39;)"><span class="hl_vardecl"><span class="mpre">stk</span></span></a><span class="mpre"> -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_383_21_383_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_21_383_25&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_383_36_383_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_36_383_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_100_1_100_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_19&#39;)"><span class="hl_varref"><span class="mpre">indentOfParseState</span></span></a><span class="mpre"> </span><a href="#loc_383_44_383_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_44_383_47&#39;)"><span class="hl_varref"><span class="mpre">stk</span></span></a><span class="mpre">))) </span><a href="#loc_383_34_383_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_34_383_35&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_383_36_383_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_36_383_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_383_38_383_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_38_383_39&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_383_40_383_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_40_383_43&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_383_44_383_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_44_383_47&#39;)"><span class="hl_varref"><span class="mpre">stk</span></span></a><span class="mpre">

</span><a href="#loc_387_1_387_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_11&#39;)"><span class="mpre">getSrcLocL</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SrcLoc</span></span><span class="mpre">
</span><a name="loc_387_1_387_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_11&#39;)"><span class="hl_vardecl"><span class="mpre">getSrcLocL</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_387_21_387_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_21_387_25&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_387_34_387_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_34_387_35&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_387_36_387_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_36_387_37&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_387_38_387_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_38_387_39&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_387_40_387_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_40_387_41&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_387_21_387_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_21_387_25&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 388, srcSpanStartColumn = 21, srcSpanEndLine = 388, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 388, srcSpanStartColumn = 23, srcSpanEndLine = 388, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/"><span class="mpre">l { srcLine = y, srcColumn = x }</span></span><span class="mpre">)) </span><a href="#loc_387_34_387_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_34_387_35&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_387_36_387_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_36_387_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_387_38_387_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_38_387_39&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_387_40_387_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_40_387_41&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><a href="#loc_391_1_391_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_12&#39;)"><span class="mpre">setSrcLineL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_391_1_391_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_12&#39;)"><span class="hl_fundecl"><span class="mpre">setSrcLineL</span></span></a><span class="mpre"> </span><a name="loc_391_13_391_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_13_391_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_391_24_391_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_24_391_28&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_391_37_391_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_37_391_38&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_391_39_391_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_39_391_40&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> _ -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_391_24_391_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_24_391_28&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_391_37_391_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_37_391_38&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_391_39_391_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_39_391_40&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_391_13_391_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_13_391_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><a href="#loc_395_1_395_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_13&#39;)"><span class="mpre">pushContextL</span></a><span class="mpre"> :: </span><a href="#loc_86_6_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_16&#39;)"><span class="hl_tyconref"><span class="mpre">LexContext</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_395_1_395_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_13&#39;)"><span class="hl_fundecl"><span class="mpre">pushContextL</span></span></a><span class="mpre"> </span><a name="loc_395_14_395_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_14_395_18&#39;)"><span class="hl_vardecl"><span class="mpre">ctxt</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_395_28_395_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_28_395_32&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_395_41_395_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_41_395_42&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_395_43_395_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_43_395_44&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_395_45_395_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_45_395_46&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_395_47_395_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_47_395_50&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a name="loc_395_52_395_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_52_395_55&#39;)"><span class="hl_vardecl"><span class="mpre">stk</span></span></a><span class="mpre">, </span><a name="loc_395_57_395_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_57_395_58&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, </span><a name="loc_395_60_395_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_60_395_63&#39;)"><span class="hl_vardecl"><span class="mpre">pst</span></span></a><span class="mpre">, </span><a name="loc_395_65_395_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_65_395_67&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_395_28_395_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_28_395_32&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_395_41_395_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_41_395_42&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_395_43_395_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_43_395_44&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_395_45_395_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_45_395_46&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_395_47_395_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_47_395_50&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a href="#loc_395_14_395_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_14_395_18&#39;)"><span class="hl_varref"><span class="mpre">ctxt</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_395_52_395_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_52_395_55&#39;)"><span class="hl_varref"><span class="mpre">stk</span></span></a><span class="mpre">, </span><a href="#loc_395_57_395_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_57_395_58&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, </span><a href="#loc_395_60_395_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_60_395_63&#39;)"><span class="hl_varref"><span class="mpre">pst</span></span></a><span class="mpre">, </span><a href="#loc_395_65_395_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_65_395_67&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)

</span><a href="#loc_399_1_399_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_1_399_12&#39;)"><span class="mpre">popContextL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_399_1_399_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_1_399_12&#39;)"><span class="hl_fundecl"><span class="mpre">popContextL</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">fn</span></span><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_399_25_399_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_25_399_29&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_399_38_399_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_38_399_39&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_399_40_399_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_40_399_41&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_399_42_399_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_42_399_43&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_399_44_399_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_44_399_47&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_399_48_399_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_48_399_51&#39;)"><span class="hl_vardecl"><span class="mpre">stk</span></span></a><span class="mpre"> </span><a name="loc_399_52_399_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_52_399_53&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_399_48_399_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_48_399_51&#39;)"><span class="hl_varref"><span class="mpre">stk</span></span></a><span class="mpre"> of
        (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_400_12_400_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_12_400_16&#39;)"><span class="hl_vardecl"><span class="mpre">ctxt</span></span></a><span class="mpre">, </span><a name="loc_400_18_400_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_18_400_19&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, </span><a name="loc_400_21_400_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_21_400_24&#39;)"><span class="hl_vardecl"><span class="mpre">pst</span></span></a><span class="mpre">, </span><a name="loc_400_26_400_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_26_400_28&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_399_25_399_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_25_399_29&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_399_38_399_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_38_399_39&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_399_40_399_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_40_399_41&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_399_42_399_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_42_399_43&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_399_44_399_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_44_399_47&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a href="#loc_400_12_400_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_12_400_16&#39;)"><span class="hl_varref"><span class="mpre">ctxt</span></span></a><span class="mpre">, </span><a href="#loc_400_18_400_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_18_400_19&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, </span><a href="#loc_400_21_400_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_21_400_24&#39;)"><span class="hl_varref"><span class="mpre">pst</span></span></a><span class="mpre">, </span><a href="#loc_400_26_400_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_26_400_28&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) </span><a href="#loc_399_52_399_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_52_399_53&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
        ([], _, _, _)        -&gt; </span><a href="#loc_83_40_83_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_40_83_46&#39;)"><span class="hl_conref"><span class="mpre">Failed</span></span></a><span class="mpre"> </span><a href="#loc_399_44_399_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_44_399_47&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Unexpected }&quot;</span></span><span class="mpre">

</span><a href="#loc_404_1_404_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_13&#39;)"><span class="mpre">pullCtxtFlag</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_404_1_404_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_13&#39;)"><span class="hl_vardecl"><span class="mpre">pullCtxtFlag</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_404_23_404_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_23_404_27&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_404_36_404_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_36_404_37&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_404_38_404_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_38_404_39&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_404_40_404_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_40_404_41&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_404_42_404_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_42_404_45&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a name="loc_404_47_404_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_47_404_49&#39;)"><span class="hl_vardecl"><span class="mpre">ct</span></span></a><span class="mpre">, </span><a name="loc_404_51_404_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_51_404_52&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, (</span><a name="loc_404_55_404_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_55_404_56&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">,</span><a name="loc_404_57_404_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_57_404_58&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">), </span><a name="loc_404_61_404_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_61_404_63&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_404_23_404_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_23_404_27&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a href="#loc_404_57_404_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_57_404_58&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_404_36_404_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_36_404_37&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_404_38_404_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_38_404_39&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_404_40_404_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_40_404_41&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_404_42_404_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_42_404_45&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a href="#loc_404_47_404_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_47_404_49&#39;)"><span class="hl_varref"><span class="mpre">ct</span></span></a><span class="mpre">, </span><a href="#loc_404_51_404_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_51_404_52&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, (</span><a href="#loc_404_55_404_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_55_404_56&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">), </span><a href="#loc_404_61_404_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_61_404_63&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)


</span><a href="#loc_409_1_409_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_7&#39;)"><span class="mpre">flagDo</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_409_1_409_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_7&#39;)"><span class="hl_vardecl"><span class="mpre">flagDo</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_409_17_409_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_17_409_21&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_409_30_409_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_30_409_31&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_409_32_409_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_32_409_33&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_409_34_409_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_34_409_35&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_409_36_409_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_36_409_39&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a name="loc_409_41_409_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_41_409_43&#39;)"><span class="hl_vardecl"><span class="mpre">ct</span></span></a><span class="mpre">, </span><a name="loc_409_45_409_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_45_409_46&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, (</span><span class="hl_vardecl"><span class="mpre">d</span></span><span class="mpre">,</span><a name="loc_409_51_409_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_51_409_52&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">), </span><a name="loc_409_55_409_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_55_409_57&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_409_17_409_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_17_409_21&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_409_30_409_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_30_409_31&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_409_32_409_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_32_409_33&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_409_34_409_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_34_409_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_409_36_409_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_36_409_39&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a href="#loc_409_41_409_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_41_409_43&#39;)"><span class="hl_varref"><span class="mpre">ct</span></span></a><span class="mpre">, </span><a href="#loc_409_45_409_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_45_409_46&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><a href="#loc_409_51_409_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_51_409_52&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">), </span><a href="#loc_409_55_409_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_55_409_57&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- Harp/Hsx</span></span><span class="mpre">

</span><a href="#loc_416_1_416_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_14&#39;)"><span class="mpre">getExtContext</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_89_6_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_16&#39;)"><span class="hl_tyconref"><span class="mpre">ExtContext</span></span></a><span class="mpre">)
</span><a name="loc_416_1_416_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_14&#39;)"><span class="hl_vardecl"><span class="mpre">getExtContext</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_416_24_416_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_24_416_28&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_416_37_416_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_37_416_38&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_416_39_416_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_39_416_40&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_416_41_416_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_41_416_42&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_416_43_416_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_43_416_46&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_416_47_416_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_47_416_50&#39;)"><span class="hl_specname"><span class="mpre">stk</span></span></a><span class="mpre">@(_, </span><a name="loc_416_55_416_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_55_416_56&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, _, _) -&gt;
        let </span><a name="loc_417_13_417_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_13_417_15&#39;)"><span class="hl_vardecl"><span class="mpre">me</span></span></a><span class="mpre"> = case </span><a href="#loc_416_55_416_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_55_416_56&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
              [] -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
              (</span><a name="loc_419_16_419_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_16_419_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_419_16_419_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_16_419_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
        in </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_416_24_416_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_24_416_28&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a href="#loc_417_13_417_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_13_417_15&#39;)"><span class="hl_varref"><span class="mpre">me</span></span></a><span class="mpre">) </span><a href="#loc_416_37_416_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_37_416_38&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_416_39_416_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_39_416_40&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_416_41_416_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_41_416_42&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_416_43_416_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_43_416_46&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_416_47_416_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_47_416_50&#39;)"><span class="hl_varref"><span class="mpre">stk</span></span></a><span class="mpre">

</span><a href="#loc_423_1_423_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_16&#39;)"><span class="mpre">pushExtContextL</span></a><span class="mpre"> :: </span><a href="#loc_89_6_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_16&#39;)"><span class="hl_tyconref"><span class="mpre">ExtContext</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_423_1_423_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_16&#39;)"><span class="hl_fundecl"><span class="mpre">pushExtContextL</span></span></a><span class="mpre"> </span><a name="loc_423_17_423_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_17_423_19&#39;)"><span class="hl_vardecl"><span class="mpre">ec</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_423_29_423_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_29_423_33&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_423_42_423_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_42_423_43&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_423_44_423_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_44_423_45&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_423_46_423_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_46_423_47&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_423_48_423_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_48_423_51&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a name="loc_423_53_423_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_53_423_54&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_423_56_423_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_56_423_57&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, </span><a name="loc_423_59_423_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_59_423_60&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_423_62_423_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_62_423_63&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_423_29_423_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_29_423_33&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_423_42_423_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_42_423_43&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_423_44_423_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_44_423_45&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_423_46_423_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_46_423_47&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_423_48_423_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_48_423_51&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a href="#loc_423_53_423_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_53_423_54&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_423_17_423_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_17_423_19&#39;)"><span class="hl_varref"><span class="mpre">ec</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_423_56_423_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_56_423_57&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, </span><a href="#loc_423_59_423_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_59_423_60&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_423_62_423_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_62_423_63&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

</span><a href="#loc_427_1_427_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_1_427_15&#39;)"><span class="mpre">popExtContextL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_427_1_427_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_1_427_15&#39;)"><span class="hl_fundecl"><span class="mpre">popExtContextL</span></span></a><span class="mpre"> </span><a name="loc_427_16_427_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_16_427_18&#39;)"><span class="hl_vardecl"><span class="mpre">fn</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_427_28_427_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_28_427_32&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_427_41_427_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_41_427_42&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_427_43_427_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_43_427_44&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_427_45_427_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_45_427_46&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_427_47_427_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_47_427_50&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">stk</span></span><span class="mpre">@(</span><a name="loc_427_56_427_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_56_427_57&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">,</span><a name="loc_427_58_427_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_58_427_59&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">,</span><a name="loc_427_60_427_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_60_427_61&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_427_62_427_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_62_427_63&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><a name="loc_427_65_427_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_65_427_66&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_427_58_427_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_58_427_59&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
            (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_428_16_428_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_16_428_18&#39;)"><span class="hl_vardecl"><span class="mpre">ec</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_427_28_427_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_28_427_32&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_427_41_427_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_41_427_42&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_427_43_427_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_43_427_44&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_427_45_427_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_45_427_46&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_427_47_427_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_47_427_50&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a href="#loc_427_56_427_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_56_427_57&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_428_16_428_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_16_428_18&#39;)"><span class="hl_varref"><span class="mpre">ec</span></span></a><span class="mpre">,</span><a href="#loc_427_60_427_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_60_427_61&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_427_62_427_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_62_427_63&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_427_65_427_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_65_427_66&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
            []       -&gt; </span><a href="#loc_83_40_83_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_40_83_46&#39;)"><span class="hl_conref"><span class="mpre">Failed</span></span></a><span class="mpre"> </span><a href="#loc_427_47_427_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_47_427_50&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Internal error: empty tag context in &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_427_16_427_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_16_427_18&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- Extension-aware lexing</span></span><span class="mpre">

</span><a href="#loc_435_1_435_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_1_435_15&#39;)"><span class="mpre">getExtensionsL</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> [</span><a href="Language.Haskell.Exts.Extension.html#loc_130_6_130_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Exts.Extension.html#loc_130_6_130_20&#39;)"><span class="hl_tyconref"><span class="mpre">KnownExtension</span></span></a><span class="mpre">]
</span><a name="loc_435_1_435_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_1_435_15&#39;)"><span class="hl_vardecl"><span class="mpre">getExtensionsL</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_435_25_435_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_25_435_29&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_435_38_435_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_38_435_39&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_435_40_435_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_40_435_41&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_435_42_435_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_42_435_43&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_435_44_435_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_44_435_47&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_435_48_435_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_48_435_49&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_435_50_435_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_50_435_51&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_435_25_435_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_25_435_29&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_147_9_147_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_9_147_20&#39;)"><span class="hl_varref"><span class="mpre">iExtensions</span></span></a><span class="mpre"> </span><a href="#loc_435_50_435_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_50_435_51&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><a href="#loc_435_38_435_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_38_435_39&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_435_40_435_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_40_435_41&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_435_42_435_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_42_435_43&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_435_44_435_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_44_435_47&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_435_48_435_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_48_435_49&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_435_50_435_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_50_435_51&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- LINE-aware lexing</span></span><span class="mpre">

</span><a href="#loc_441_1_441_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_1_441_19&#39;)"><span class="mpre">ignoreLinePragmasL</span></a><span class="mpre"> :: </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_441_1_441_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_1_441_19&#39;)"><span class="hl_vardecl"><span class="mpre">ignoreLinePragmasL</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_441_29_441_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_29_441_33&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_441_42_441_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_42_441_43&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_441_44_441_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_44_441_45&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_441_46_441_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_46_441_47&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_441_48_441_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_48_441_51&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_441_52_441_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_52_441_53&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_441_54_441_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_54_441_55&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_441_29_441_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_29_441_33&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_149_9_149_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_27&#39;)"><span class="hl_varref"><span class="mpre">iIgnoreLinePragmas</span></span></a><span class="mpre"> </span><a href="#loc_441_54_441_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_54_441_55&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><a href="#loc_441_42_441_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_42_441_43&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_441_44_441_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_44_441_45&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_441_46_441_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_46_441_47&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_441_48_441_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_48_441_51&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_441_52_441_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_52_441_53&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_441_54_441_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_54_441_55&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- If we read a file name in a LINE pragma, we should update the state.</span></span><span class="mpre">
</span><a href="#loc_446_1_446_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_17&#39;)"><span class="mpre">setLineFilenameL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_446_1_446_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_17&#39;)"><span class="hl_fundecl"><span class="mpre">setLineFilenameL</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">name</span></span><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_446_32_446_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_32_446_36&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_446_45_446_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_45_446_46&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_446_47_446_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_47_446_48&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_446_49_446_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_49_446_50&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_446_51_446_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_51_446_54&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_446_55_446_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_55_446_56&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">m</span></span><span class="mpre"> -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_446_32_446_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_32_446_36&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_446_45_446_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_45_446_46&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_446_47_446_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_47_446_48&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_446_49_446_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_49_446_50&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_446_51_446_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_51_446_54&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_446_55_446_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_55_446_56&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 447, srcSpanStartColumn = 37, srcSpanEndLine = 447, srcSpanEndColumn = 62}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskell-src-exts-1.14.0.1/src/Language/Haskell/Exts/ParseMonad.hs&quot;, srcSpanStartLine = 447, srcSpanStartColumn = 39, srcSpanEndLine = 447, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/"><span class="mpre">m {iParseFilename = name}</span></span><span class="mpre">)
        
</span><span class="hl_comment"><span class="mpre">-- Comments</span></span><span class="mpre">

</span><a href="#loc_452_1_452_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_1_452_12&#39;)"><span class="mpre">pushComment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Comment</span></span><span class="mpre"> -&gt; </span><a href="#loc_291_9_291_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_12&#39;)"><span class="hl_tyconref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_452_1_452_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_1_452_12&#39;)"><span class="hl_fundecl"><span class="mpre">pushComment</span></span></a><span class="mpre"> </span><a name="loc_452_13_452_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_13_452_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_291_19_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_19_291_22&#39;)"><span class="hl_conref"><span class="mpre">Lex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_452_24_452_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_24_452_28&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_452_37_452_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_37_452_38&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_452_39_452_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_39_452_40&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_452_41_452_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_41_452_42&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_452_43_452_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_43_452_46&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a name="loc_452_48_452_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_48_452_49&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_452_51_452_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_51_452_52&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">, </span><a name="loc_452_54_452_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_54_452_55&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_452_57_452_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_57_452_59&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) -&gt;
        </span><a href="#loc_160_19_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_19_160_23&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> (</span><a href="#loc_452_24_452_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_24_452_28&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_452_37_452_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_37_452_38&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_452_39_452_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_39_452_40&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_452_41_452_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_41_452_42&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_452_43_452_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_43_452_46&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> (</span><a href="#loc_452_48_452_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_48_452_49&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_452_51_452_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_51_452_52&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, </span><a href="#loc_452_54_452_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_54_452_55&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_452_13_452_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_13_452_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_452_57_452_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_57_452_59&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
</span></div></body></html>