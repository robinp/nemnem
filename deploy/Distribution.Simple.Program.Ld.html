<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Distribution.Simple.Program.Ld</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Duncan Coutts 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  cabal-devel@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module provides an library interface to the @ld@ linker program.</span></span><span class="mpre">

module Distribution.Simple.Program.Ld (
    combineObjectFiles,
  ) where

import Distribution.Simple.Program.Types
         ( </span><a href="Distribution.Simple.Program.Types.html#loc_77_6_77_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Types.html#loc_77_6_77_23&#39;)"><span class="mpre">ConfiguredProgram</span></a><span class="mpre">(..) )
import Distribution.Simple.Program.Run
         ( </span><a href="Distribution.Simple.Program.Run.html#loc_84_1_84_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_84_1_84_18&#39;)"><span class="mpre">programInvocation</span></a><span class="mpre">, </span><a href="Distribution.Simple.Program.Run.html#loc_212_1_212_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_212_1_212_28&#39;)"><span class="mpre">multiStageProgramInvocation</span></a><span class="mpre">
         , </span><a href="Distribution.Simple.Program.Run.html#loc_95_1_95_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_95_1_95_21&#39;)"><span class="mpre">runProgramInvocation</span></a><span class="mpre"> )
import Distribution.Verbosity
         ( </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="mpre">Verbosity</span></a><span class="mpre"> )

import System.Directory
         ( </span><a href="System.Directory.html#loc_510_1_510_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_510_1_510_11&#39;)"><span class="mpre">renameFile</span></a><span class="mpre"> )
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Ld.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;System.FilePath&quot;"><span class="mpre">System.FilePath</span></span><span class="mpre">
         ( (&lt;.&gt;) )

</span><span class="hl_comment"><span class="mpre">-- | Call @ld -r@ to link a bunch of object files together.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_32_1_32_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_19&#39;)"><span class="mpre">combineObjectFiles</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><a href="Distribution.Simple.Program.Types.html#loc_77_6_77_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Types.html#loc_77_6_77_23&#39;)"><span class="hl_tyconref"><span class="mpre">ConfiguredProgram</span></span></a><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_32_1_32_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_19&#39;)"><span class="hl_fundecl"><span class="mpre">combineObjectFiles</span></span></a><span class="mpre"> </span><a name="loc_32_20_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_20_32_29&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_32_30_32_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_30_32_32&#39;)"><span class="hl_vardecl"><span class="mpre">ld</span></span></a><span class="mpre"> </span><a name="loc_32_33_32_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_33_32_39&#39;)"><span class="hl_vardecl"><span class="mpre">target</span></span></a><span class="mpre"> </span><a name="loc_32_40_32_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_40_32_45&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre"> =

  </span><span class="hl_comment"><span class="mpre">-- Unlike &quot;ar&quot;, the &quot;ld&quot; tool is not designed to be used with xargs. That is,</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- if we have more object files than fit on a single command line then we</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- have a slight problem. What we have to do is link files in batches into</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- a temp object file and then include that one in the next batch.</span></span><span class="mpre">

  let </span><a name="loc_39_7_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_17&#39;)"><span class="hl_vardecl"><span class="mpre">simpleArgs</span></span></a><span class="mpre">  = [</span><span class="hl_string"><span class="mpre">&quot;-r&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;-o&quot;</span></span><span class="mpre">, </span><a href="#loc_32_33_32_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_33_32_39&#39;)"><span class="hl_varref"><span class="mpre">target</span></span></a><span class="mpre">]

      </span><a name="loc_41_7_41_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_18&#39;)"><span class="hl_vardecl"><span class="mpre">initialArgs</span></span></a><span class="mpre"> = [</span><span class="hl_string"><span class="mpre">&quot;-r&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;-o&quot;</span></span><span class="mpre">, </span><a href="#loc_32_33_32_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_33_32_39&#39;)"><span class="hl_varref"><span class="mpre">target</span></span></a><span class="mpre">]
      </span><a name="loc_42_7_42_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_17&#39;)"><span class="hl_vardecl"><span class="mpre">middleArgs</span></span></a><span class="mpre">  = [</span><span class="hl_string"><span class="mpre">&quot;-r&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;-o&quot;</span></span><span class="mpre">, </span><a href="#loc_32_33_32_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_33_32_39&#39;)"><span class="hl_varref"><span class="mpre">target</span></span></a><span class="mpre">, </span><a href="#loc_56_5_56_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_5_56_12&#39;)"><span class="hl_varref"><span class="mpre">tmpfile</span></span></a><span class="mpre">]
      </span><a name="loc_43_7_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_16&#39;)"><span class="hl_vardecl"><span class="mpre">finalArgs</span></span></a><span class="mpre">   = </span><a href="#loc_42_7_42_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_17&#39;)"><span class="hl_varref"><span class="mpre">middleArgs</span></span></a><span class="mpre">

      </span><a name="loc_45_7_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_13&#39;)"><span class="hl_vardecl"><span class="mpre">simple</span></span></a><span class="mpre">      = </span><a href="Distribution.Simple.Program.Run.html#loc_84_1_84_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_84_1_84_18&#39;)"><span class="hl_varref"><span class="mpre">programInvocation</span></span></a><span class="mpre"> </span><a href="#loc_32_30_32_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_30_32_32&#39;)"><span class="hl_varref"><span class="mpre">ld</span></span></a><span class="mpre"> </span><a href="#loc_39_7_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_17&#39;)"><span class="hl_varref"><span class="mpre">simpleArgs</span></span></a><span class="mpre">
      </span><a name="loc_46_7_46_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_14&#39;)"><span class="hl_vardecl"><span class="mpre">initial</span></span></a><span class="mpre">     = </span><a href="Distribution.Simple.Program.Run.html#loc_84_1_84_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_84_1_84_18&#39;)"><span class="hl_varref"><span class="mpre">programInvocation</span></span></a><span class="mpre"> </span><a href="#loc_32_30_32_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_30_32_32&#39;)"><span class="hl_varref"><span class="mpre">ld</span></span></a><span class="mpre"> </span><a href="#loc_41_7_41_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_18&#39;)"><span class="hl_varref"><span class="mpre">initialArgs</span></span></a><span class="mpre">
      </span><a name="loc_47_7_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_7_47_13&#39;)"><span class="hl_vardecl"><span class="mpre">middle</span></span></a><span class="mpre">      = </span><a href="Distribution.Simple.Program.Run.html#loc_84_1_84_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_84_1_84_18&#39;)"><span class="hl_varref"><span class="mpre">programInvocation</span></span></a><span class="mpre"> </span><a href="#loc_32_30_32_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_30_32_32&#39;)"><span class="hl_varref"><span class="mpre">ld</span></span></a><span class="mpre"> </span><a href="#loc_42_7_42_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_17&#39;)"><span class="hl_varref"><span class="mpre">middleArgs</span></span></a><span class="mpre">
      </span><a name="loc_48_7_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_12&#39;)"><span class="hl_vardecl"><span class="mpre">final</span></span></a><span class="mpre">       = </span><a href="Distribution.Simple.Program.Run.html#loc_84_1_84_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_84_1_84_18&#39;)"><span class="hl_varref"><span class="mpre">programInvocation</span></span></a><span class="mpre"> </span><a href="#loc_32_30_32_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_30_32_32&#39;)"><span class="hl_varref"><span class="mpre">ld</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_16&#39;)"><span class="hl_varref"><span class="mpre">finalArgs</span></span></a><span class="mpre">

      </span><a name="loc_50_7_50_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_18&#39;)"><span class="hl_vardecl"><span class="mpre">invocations</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Program.Run.html#loc_212_1_212_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_212_1_212_28&#39;)"><span class="hl_varref"><span class="mpre">multiStageProgramInvocation</span></span></a><span class="mpre">
                      </span><a href="#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_13&#39;)"><span class="hl_varref"><span class="mpre">simple</span></span></a><span class="mpre"> (</span><a href="#loc_46_7_46_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_14&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">, </span><a href="#loc_47_7_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_7_47_13&#39;)"><span class="hl_varref"><span class="mpre">middle</span></span></a><span class="mpre">, </span><a href="#loc_48_7_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_12&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre">) </span><a href="#loc_32_40_32_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_40_32_45&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre">

   in </span><a href="#loc_58_5_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_8&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_50_7_50_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_18&#39;)"><span class="hl_varref"><span class="mpre">invocations</span></span></a><span class="mpre">

  where
    </span><a name="loc_56_5_56_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_5_56_12&#39;)"><span class="hl_vardecl"><span class="mpre">tmpfile</span></span></a><span class="mpre">        = </span><a href="#loc_32_33_32_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_33_32_39&#39;)"><span class="hl_varref"><span class="mpre">target</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;tmp&quot;</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- perhaps should use a proper temp file</span></span><span class="mpre">

    </span><a name="loc_58_5_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_8&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> []         = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_58_5_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_8&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> [</span><a name="loc_59_10_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_13&#39;)"><span class="hl_vardecl"><span class="mpre">inv</span></span></a><span class="mpre">]      = </span><a href="Distribution.Simple.Program.Run.html#loc_95_1_95_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_95_1_95_21&#39;)"><span class="hl_varref"><span class="mpre">runProgramInvocation</span></span></a><span class="mpre"> </span><a href="#loc_32_20_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_20_32_29&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_59_10_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_13&#39;)"><span class="hl_varref"><span class="mpre">inv</span></span></a><span class="mpre">
    </span><a href="#loc_58_5_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_8&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a name="loc_60_10_60_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_13&#39;)"><span class="hl_vardecl"><span class="mpre">inv</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_60_14_60_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_14_60_18&#39;)"><span class="hl_vardecl"><span class="mpre">invs</span></span></a><span class="mpre">) = do </span><a href="Distribution.Simple.Program.Run.html#loc_95_1_95_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Run.html#loc_95_1_95_21&#39;)"><span class="hl_varref"><span class="mpre">runProgramInvocation</span></span></a><span class="mpre"> </span><a href="#loc_32_20_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_20_32_29&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_60_10_60_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_13&#39;)"><span class="hl_varref"><span class="mpre">inv</span></span></a><span class="mpre">
                        </span><a href="System.Directory.html#loc_510_1_510_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_510_1_510_11&#39;)"><span class="hl_varref"><span class="mpre">renameFile</span></span></a><span class="mpre"> </span><a href="#loc_32_33_32_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_33_32_39&#39;)"><span class="hl_varref"><span class="mpre">target</span></span></a><span class="mpre"> </span><a href="#loc_56_5_56_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_5_56_12&#39;)"><span class="hl_varref"><span class="mpre">tmpfile</span></span></a><span class="mpre">
                        </span><a href="#loc_58_5_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_8&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_60_14_60_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_14_60_18&#39;)"><span class="hl_varref"><span class="mpre">invs</span></span></a><span class="mpre">
</span></div></body></html>