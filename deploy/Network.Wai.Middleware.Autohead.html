<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
</span><span class="hl_comment"><span class="mpre">-- | Automatically produce responses to HEAD requests based on the underlying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- applications GET response.</span></span><span class="mpre">
module Network.Wai.Middleware.Autohead (autohead) where

import Network.Wai
import Data.Monoid (</span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre">)

</span><a href="#loc_10_1_10_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_9&#39;)"><span class="mpre">autohead</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Middleware</span></span><span class="mpre">
</span><a name="loc_10_1_10_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_9&#39;)"><span class="hl_fundecl"><span class="mpre">autohead</span></span></a><span class="mpre"> </span><a name="loc_10_10_10_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_10_10_13&#39;)"><span class="hl_vardecl"><span class="mpre">app</span></span></a><span class="mpre"> </span><a name="loc_10_14_10_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_14_10_17&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_10_18_10_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_18_10_30&#39;)"><span class="hl_vardecl"><span class="mpre">sendResponse</span></span></a><span class="mpre">
    | </span><a href="Network.Wai.Internal.html#loc_22_6_22_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_22_6_22_19&#39;)"><span class="hl_varref"><span class="mpre">requestMethod</span></span></a><span class="mpre"> </span><a href="#loc_10_14_10_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_14_10_17&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;HEAD&quot;</span></span><span class="mpre"> = </span><a href="#loc_10_10_10_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_10_10_13&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/Autohead.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 41, srcSpanEndLine = 11, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/Autohead.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 45, srcSpanEndLine = 11, srcSpanEndColumn = 46},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/"><span class="mpre">req { requestMethod = &quot;GET&quot; }</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_11_74_11_77" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_74_11_77&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> -&gt; do
        let (</span><a name="loc_12_14_12_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_14_12_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_12_17_12_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_17_12_19&#39;)"><span class="hl_vardecl"><span class="mpre">hs</span></span></a><span class="mpre">, _) = </span><a href="Network.Wai.html#loc_198_1_198_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_198_1_198_17&#39;)"><span class="hl_varref"><span class="mpre">responseToStream</span></span></a><span class="mpre"> </span><a href="#loc_11_74_11_77" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_74_11_77&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
        </span><a href="#loc_10_18_10_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_18_10_30&#39;)"><span class="hl_varref"><span class="mpre">sendResponse</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_125_1_125_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_125_1_125_16&#39;)"><span class="hl_varref"><span class="mpre">responseBuilder</span></span></a><span class="mpre"> </span><a href="#loc_12_14_12_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_14_12_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_12_17_12_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_17_12_19&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_10_10_10_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_10_10_13&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre"> </span><a href="#loc_10_14_10_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_14_10_17&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_10_18_10_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_18_10_30&#39;)"><span class="hl_varref"><span class="mpre">sendResponse</span></span></a><span class="mpre">

</span></div></body></html>