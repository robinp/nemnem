<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.Validation.Cache</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- X.509 Validation cache</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Define all the types necessary for the validation cache,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and some simples instances of cache mechanism</span></span><span class="mpre">
module Data.X509.Validation.Cache
    (
    </span><span class="hl_comment"><span class="mpre">-- * Cache for validation</span></span><span class="mpre">
      ValidationCacheResult(..)
    , ValidationCacheQueryCallback
    , ValidationCacheAddCallback
    , ValidationCache(..)
    </span><span class="hl_comment"><span class="mpre">-- * Simple instances of cache mechanism</span></span><span class="mpre">
    , exceptionValidationCache
    , tofuValidationCache
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Cache.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 8, srcSpanEndLine = 24, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre">
import Data.Default.Class
import Data.X509
import Data.X509.Validation.Types
import Data.X509.Validation.Fingerprint

</span><span class="hl_comment"><span class="mpre">-- | The result of a cache query</span></span><span class="mpre">
data </span><a name="loc_31_6_31_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_6_31_27&#39;)"><span class="hl_tycondecl"><span class="mpre">ValidationCacheResult</span></span></a><span class="mpre"> =
      </span><a name="loc_32_7_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_26&#39;)"><span class="hl_condecl"><span class="mpre">ValidationCachePass</span></span></a><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^ cache allow this fingerprint to go through</span></span><span class="mpre">
    | </span><a name="loc_33_7_33_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_28&#39;)"><span class="hl_condecl"><span class="mpre">ValidationCacheDenied</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ cache denied this fingerprint for further validation</span></span><span class="mpre">
    | </span><a name="loc_34_7_34_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_29&#39;)"><span class="hl_condecl"><span class="mpre">ValidationCacheUnknown</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ unknown fingerprint in cache</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Cache.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 5, srcSpanEndLine = 35, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Cache.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 5, srcSpanEndLine = 35, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/D"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Validation cache query callback type</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Cache.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 1, srcSpanEndLine = 41, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Cache.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 1, srcSpanEndLine = 38, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Da"><span class="mpre">type ValidationCacheQueryCallback = ServiceID          </span><span class="hl_comment"><span class="mpre">-- ^ connection&#39;s identification</span></span><span class="mpre">
                                 -&gt; Fingerprint        </span><span class="hl_comment"><span class="mpre">-- ^ fingerprint of the leaf certificate</span></span><span class="mpre">
                                 -&gt; Certificate        </span><span class="hl_comment"><span class="mpre">-- ^ leaf certificate</span></span><span class="mpre">
                                 -&gt; IO ValidationCacheResult</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ return if the operation is succesful or not</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Validation cache callback type</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Cache.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 1, srcSpanEndLine = 47, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Cache.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 1, srcSpanEndLine = 44, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Da"><span class="mpre">type ValidationCacheAddCallback = ServiceID   </span><span class="hl_comment"><span class="mpre">-- ^ connection&#39;s identification</span></span><span class="mpre">
                               -&gt; Fingerprint </span><span class="hl_comment"><span class="mpre">-- ^ fingerprint of the leaf certificate</span></span><span class="mpre">
                               -&gt; Certificate </span><span class="hl_comment"><span class="mpre">-- ^ leaf certificate</span></span><span class="mpre">
                               -&gt; IO ()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | All the callbacks needed for querying and adding to the cache.</span></span><span class="mpre">
data </span><a name="loc_50_6_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_21&#39;)"><span class="hl_tycondecl"><span class="mpre">ValidationCache</span></span></a><span class="mpre"> = </span><a name="loc_50_24_50_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_24_50_39&#39;)"><span class="hl_condecl"><span class="mpre">ValidationCache</span></span></a><span class="mpre">
    { </span><a name="loc_51_7_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_7_51_17&#39;)"><span class="hl_fielddecl"><span class="mpre">cacheQuery</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ValidationCacheQueryCallback</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ cache querying callback</span></span><span class="mpre">
    , </span><a name="loc_52_7_52_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_15&#39;)"><span class="hl_fielddecl"><span class="mpre">cacheAdd</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">ValidationCacheAddCallback</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ cache adding callback</span></span><span class="mpre">
    }

instance </span><a href="Data.Default.Class.html#loc_38_7_38_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_38_7_38_14&#39;)"><span class="hl_classref"><span class="mpre">Default</span></span></a><span class="mpre"> </span><a href="#loc_50_6_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_21&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationCache</span></span></a><span class="mpre"> where
    </span><a href="Data.Default.Class.html#loc_40_5_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_40_5_40_8&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> = </span><a href="#loc_72_1_72_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_25&#39;)"><span class="hl_varref"><span class="mpre">exceptionValidationCache</span></span></a><span class="mpre"> []

</span><span class="hl_comment"><span class="mpre">-- | create a simple constant cache that list exceptions to the certification</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- validation. Typically this is use to allow self-signed certificates for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- specific use, with out-of-bounds user checks.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- No fingerprints will be added after the instance is created.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The underlying structure for the check is kept as a list, as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- usually the exception list will be short, but when the list go above</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a dozen exceptions it&#39;s recommended to use another cache mechanism with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a faster lookup mechanism (hashtable, map, etc).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that only one fingerprint is allowed per ServiceID, for other use,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- another cache mechanism need to be use.</span></span><span class="mpre">
</span><a href="#loc_72_1_72_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_25&#39;)"><span class="mpre">exceptionValidationCache</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">ServiceID</span></span><span class="mpre">, </span><a href="Data.X509.Validation.Fingerprint.html#loc_21_9_21_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Fingerprint.html#loc_21_9_21_20&#39;)"><span class="hl_tyconref"><span class="mpre">Fingerprint</span></span></a><span class="mpre">)] -&gt; </span><a href="#loc_50_6_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_21&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationCache</span></span></a><span class="mpre">
</span><a name="loc_72_1_72_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_25&#39;)"><span class="hl_fundecl"><span class="mpre">exceptionValidationCache</span></span></a><span class="mpre"> </span><a name="loc_72_26_72_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_26_72_38&#39;)"><span class="hl_vardecl"><span class="mpre">fingerprints</span></span></a><span class="mpre"> =
    </span><a href="#loc_50_24_50_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_24_50_39&#39;)"><span class="hl_conref"><span class="mpre">ValidationCache</span></span></a><span class="mpre"> (</span><a href="#loc_92_1_92_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_18&#39;)"><span class="hl_varref"><span class="mpre">queryListCallback</span></span></a><span class="mpre"> </span><a href="#loc_72_26_72_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_26_72_38&#39;)"><span class="hl_varref"><span class="mpre">fingerprints</span></span></a><span class="mpre">)
                    (\_ _ _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Trust on first use (TOFU) cache with an optional list of exceptions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this is similar to the exceptionCache, except that after</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- each succesfull validation it does add the fingerprint</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the database. This prevent any further modification of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fingerprint for the remaining</span></span><span class="mpre">
</span><a href="#loc_84_1_84_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_20&#39;)"><span class="mpre">tofuValidationCache</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">ServiceID</span></span><span class="mpre">, </span><a href="Data.X509.Validation.Fingerprint.html#loc_21_9_21_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Fingerprint.html#loc_21_9_21_20&#39;)"><span class="hl_tyconref"><span class="mpre">Fingerprint</span></span></a><span class="mpre">)] </span><span class="hl_comment"><span class="mpre">-- ^ a list of exceptions</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_50_6_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_21&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationCache</span></span></a><span class="mpre">
</span><a name="loc_84_1_84_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_20&#39;)"><span class="hl_fundecl"><span class="mpre">tofuValidationCache</span></span></a><span class="mpre"> </span><a name="loc_84_21_84_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_21_84_33&#39;)"><span class="hl_vardecl"><span class="mpre">fingerprints</span></span></a><span class="mpre"> = do
    </span><a name="loc_85_5_85_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_6&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newMVar</span></span><span class="mpre"> </span><a href="#loc_84_21_84_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_21_84_33&#39;)"><span class="hl_varref"><span class="mpre">fingerprints</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_50_24_50_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_24_50_39&#39;)"><span class="hl_conref"><span class="mpre">ValidationCache</span></span></a><span class="mpre"> (\</span><a name="loc_86_32_86_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_32_86_33&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_86_34_86_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_34_86_35&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_86_36_86_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_36_86_37&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">readMVar</span></span><span class="mpre"> </span><a href="#loc_85_5_85_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_86_57_86_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_57_86_61&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_92_1_92_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_18&#39;)"><span class="hl_varref"><span class="mpre">queryListCallback</span></span></a><span class="mpre"> </span><a href="#loc_86_57_86_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_57_86_61&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre">) </span><a href="#loc_86_32_86_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_32_86_33&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_86_34_86_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_34_86_35&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_86_36_86_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_36_86_37&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
                             (\</span><a name="loc_87_32_87_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_32_87_33&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_87_34_87_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_34_87_35&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">modifyMVar_</span></span><span class="mpre"> </span><a href="#loc_85_5_85_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> (\</span><a name="loc_87_57_87_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_57_87_61&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ((</span><a href="#loc_87_32_87_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_32_87_33&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_87_34_87_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_34_87_35&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_87_57_87_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_57_87_61&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre">)))

</span><span class="hl_comment"><span class="mpre">-- | a cache query function working on list.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- don&#39;t use when the list grows a lot.</span></span><span class="mpre">
</span><a href="#loc_92_1_92_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_18&#39;)"><span class="mpre">queryListCallback</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">ServiceID</span></span><span class="mpre">, </span><a href="Data.X509.Validation.Fingerprint.html#loc_21_9_21_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Fingerprint.html#loc_21_9_21_20&#39;)"><span class="hl_tyconref"><span class="mpre">Fingerprint</span></span></a><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">ValidationCacheQueryCallback</span></span><span class="mpre">
</span><a name="loc_92_1_92_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_18&#39;)"><span class="hl_fundecl"><span class="mpre">queryListCallback</span></span></a><span class="mpre"> </span><a name="loc_92_19_92_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_23&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> = </span><a href="#loc_93_9_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_14&#39;)"><span class="hl_varref"><span class="mpre">query</span></span></a><span class="mpre">
  where </span><a name="loc_93_9_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_14&#39;)"><span class="hl_fundecl"><span class="mpre">query</span></span></a><span class="mpre"> </span><a name="loc_93_15_93_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_24&#39;)"><span class="hl_vardecl"><span class="mpre">serviceID</span></span></a><span class="mpre"> </span><a name="loc_93_25_93_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_25_93_36&#39;)"><span class="hl_vardecl"><span class="mpre">fingerprint</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
            case </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><a href="#loc_93_15_93_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_24&#39;)"><span class="hl_varref"><span class="mpre">serviceID</span></span></a><span class="mpre"> </span><a href="#loc_92_19_92_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_23&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">                   -&gt; </span><a href="#loc_34_7_34_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_29&#39;)"><span class="hl_conref"><span class="mpre">ValidationCacheUnknown</span></span></a><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_96_22_96_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_22_96_23&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> | </span><a href="#loc_93_25_93_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_25_93_36&#39;)"><span class="hl_varref"><span class="mpre">fingerprint</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_96_22_96_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_22_96_23&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_7_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_26&#39;)"><span class="hl_conref"><span class="mpre">ValidationCachePass</span></span></a><span class="mpre">
                       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        -&gt; </span><a href="#loc_33_7_33_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_28&#39;)"><span class="hl_conref"><span class="mpre">ValidationCacheDenied</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_93_15_93_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_24&#39;)"><span class="hl_varref"><span class="mpre">serviceID</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; expected &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_96_22_96_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_22_96_23&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; but got: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_93_25_93_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_25_93_36&#39;)"><span class="hl_varref"><span class="mpre">fingerprint</span></span></a><span class="mpre">)

</span></div></body></html>