<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Handshake.Signature</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Handshake.Signature
    ( getHashAndASN1
    , prepareCertificateVerifySignatureData
    , signatureHashData
    , signatureCreate
    , signatureVerify
    , signatureVerifyWithHashDescr
    , generateSignedDHParams
    ) where

import Crypto.PubKey.HashDescr
import Network.TLS.Crypto
import Network.TLS.Context.Internal
import Network.TLS.Struct
import Network.TLS.Packet (</span><a href="Network.TLS.Packet.html#loc_580_1_580_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Packet.html#loc_580_1_580_30&#39;)"><span class="mpre">generateCertificateVerify_SSL</span></a><span class="mpre">, </span><a href="Network.TLS.Packet.html#loc_583_1_583_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Packet.html#loc_583_1_583_21&#39;)"><span class="mpre">encodeSignedDHParams</span></a><span class="mpre">)
import Network.TLS.State
import Network.TLS.Handshake.State
import Network.TLS.Handshake.Key
import Network.TLS.Util

import Control.Applicative
import Control.Monad.State

</span><a href="#loc_33_1_33_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_15&#39;)"><span class="mpre">getHashAndASN1</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Handshake/Signature.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 19, srcSpanEndLine = 32, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Handshake/Signature.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 29, srcSpanEndLine = 32, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">MonadIO m =&gt;</span></span><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_86_6_86_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_86_6_86_19&#39;)"><span class="hl_tyconref"><span class="mpre">HashAlgorithm</span></span></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_97_6_97_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_97_6_97_24&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureAlgorithm</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre">
</span><a name="loc_33_1_33_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_15&#39;)"><span class="hl_fundecl"><span class="mpre">getHashAndASN1</span></span></a><span class="mpre"> </span><a name="loc_33_16_33_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_23&#39;)"><span class="hl_vardecl"><span class="mpre">hashSig</span></span></a><span class="mpre"> = case </span><a href="#loc_33_16_33_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_23&#39;)"><span class="hl_varref"><span class="mpre">hashSig</span></span></a><span class="mpre"> of
    (</span><a href="Network.TLS.Struct.html#loc_89_7_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_89_7_89_15&#39;)"><span class="hl_conref"><span class="mpre">HashSHA1</span></span></a><span class="mpre">,   </span><a href="Network.TLS.Struct.html#loc_99_7_99_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_99_7_99_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureRSA</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Crypto.PubKey.HashDescr.html#loc_55_1_55_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_55_1_55_14&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA1</span></span></a><span class="mpre">
    (</span><a href="Network.TLS.Struct.html#loc_90_7_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_90_7_90_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA224</span></span></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_99_7_99_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_99_7_99_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureRSA</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Crypto.PubKey.HashDescr.html#loc_61_1_61_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_61_1_61_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA224</span></span></a><span class="mpre">
    (</span><a href="Network.TLS.Struct.html#loc_91_7_91_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_91_7_91_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA256</span></span></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_99_7_99_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_99_7_99_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureRSA</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Crypto.PubKey.HashDescr.html#loc_67_1_67_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_67_1_67_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA256</span></span></a><span class="mpre">
    (</span><a href="Network.TLS.Struct.html#loc_92_7_92_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_92_7_92_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA384</span></span></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_99_7_99_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_99_7_99_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureRSA</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Crypto.PubKey.HashDescr.html#loc_73_1_73_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_73_1_73_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA384</span></span></a><span class="mpre">
    (</span><a href="Network.TLS.Struct.html#loc_93_7_93_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_93_7_93_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA512</span></span></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_99_7_99_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_99_7_99_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureRSA</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Crypto.PubKey.HashDescr.html#loc_79_1_79_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_79_1_79_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA512</span></span></a><span class="mpre">
    _                          -&gt; </span><a href="Network.TLS.Context.Internal.html#loc_167_1_167_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_167_1_167_10&#39;)"><span class="hl_varref"><span class="mpre">throwCore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_122_7_122_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_122_7_122_17&#39;)"><span class="hl_conref"><span class="mpre">Error_Misc</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unsupported hash/sig algorithm&quot;</span></span><span class="mpre">

</span><a href="#loc_46_1_46_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_38&#39;)"><span class="mpre">prepareCertificateVerifySignatureData</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre">
                                      -&gt; </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
                                      -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HashAndSignatureAlgorithm</span></span><span class="mpre">
                                      -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
                                      -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">)
</span><a name="loc_46_1_46_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_38&#39;)"><span class="hl_fundecl"><span class="mpre">prepareCertificateVerifySignatureData</span></span></a><span class="mpre"> </span><a name="loc_46_39_46_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_39_46_42&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_46_43_46_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_43_46_54&#39;)"><span class="hl_vardecl"><span class="mpre">usedVersion</span></span></a><span class="mpre"> </span><a name="loc_46_55_46_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_55_46_59&#39;)"><span class="hl_vardecl"><span class="mpre">malg</span></span></a><span class="mpre"> </span><a name="loc_46_60_46_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_60_46_64&#39;)"><span class="hl_vardecl"><span class="mpre">msgs</span></span></a><span class="mpre">
    | </span><a href="#loc_46_43_46_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_43_46_54&#39;)"><span class="hl_varref"><span class="mpre">usedVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SSL3</span></span><span class="mpre"> = do
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_48_14_48_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_26&#39;)"><span class="hl_vardecl"><span class="mpre">masterSecret</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_186_1_186_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_186_1_186_12&#39;)"><span class="hl_varref"><span class="mpre">usingHState</span></span></a><span class="mpre"> </span><a href="#loc_46_39_46_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_39_46_42&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="Network.TLS.Handshake.State.html#loc_66_7_66_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.State.html#loc_66_7_66_22&#39;)"><span class="hl_varref"><span class="mpre">hstMasterSecret</span></span></a><span class="mpre">
        let </span><a name="loc_49_13_49_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_13_49_19&#39;)"><span class="hl_vardecl"><span class="mpre">digest</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Packet.html#loc_580_1_580_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Packet.html#loc_580_1_580_30&#39;)"><span class="hl_varref"><span class="mpre">generateCertificateVerify_SSL</span></span></a><span class="mpre"> </span><a href="#loc_48_14_48_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_26&#39;)"><span class="hl_varref"><span class="mpre">masterSecret</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Crypto.html#loc_113_1_113_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_113_1_113_11&#39;)"><span class="hl_varref"><span class="mpre">hashUpdate</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Crypto.html#loc_110_1_110_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_110_1_110_9&#39;)"><span class="hl_varref"><span class="mpre">hashInit</span></span></a><span class="mpre"> </span><a href="Network.TLS.Crypto.html#loc_125_1_125_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_125_1_125_12&#39;)"><span class="hl_varref"><span class="mpre">hashMD5SHA1</span></span></a><span class="mpre">) </span><a href="#loc_46_60_46_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_60_46_64&#39;)"><span class="hl_varref"><span class="mpre">msgs</span></span></a><span class="mpre">)
            </span><a name="loc_50_13_50_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_16&#39;)"><span class="hl_vardecl"><span class="mpre">hsh</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">HashDescr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_50_13_50_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_16&#39;)"><span class="hl_varref"><span class="mpre">hsh</span></span></a><span class="mpre">, </span><a href="#loc_49_13_49_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_13_49_19&#39;)"><span class="hl_varref"><span class="mpre">digest</span></span></a><span class="mpre">)
    | </span><a href="#loc_46_43_46_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_43_46_54&#39;)"><span class="hl_varref"><span class="mpre">usedVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_46_43_46_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_43_46_54&#39;)"><span class="hl_varref"><span class="mpre">usedVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS11</span></span><span class="mpre"> = do
        let </span><a name="loc_53_13_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_13_53_18&#39;)"><span class="hl_fundecl"><span class="mpre">hashf</span></span></a><span class="mpre"> </span><a name="loc_53_19_53_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_19_53_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Crypto.html#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">hashFinal</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Crypto.html#loc_113_1_113_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_113_1_113_11&#39;)"><span class="hl_varref"><span class="mpre">hashUpdate</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Crypto.html#loc_110_1_110_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_110_1_110_9&#39;)"><span class="hl_varref"><span class="mpre">hashInit</span></span></a><span class="mpre"> </span><a href="Network.TLS.Crypto.html#loc_125_1_125_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_125_1_125_12&#39;)"><span class="hl_varref"><span class="mpre">hashMD5SHA1</span></span></a><span class="mpre">) </span><a href="#loc_53_19_53_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_19_53_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
            </span><a name="loc_54_13_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_16&#39;)"><span class="hl_vardecl"><span class="mpre">hsh</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">HashDescr</span></span><span class="mpre"> </span><a href="#loc_53_13_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_13_53_18&#39;)"><span class="hl_varref"><span class="mpre">hashf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_54_13_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_16&#39;)"><span class="hl_varref"><span class="mpre">hsh</span></span></a><span class="mpre">, </span><a href="#loc_46_60_46_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_60_46_64&#39;)"><span class="hl_varref"><span class="mpre">msgs</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
        let </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_57_18_57_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_25&#39;)"><span class="hl_vardecl"><span class="mpre">hashSig</span></span></a><span class="mpre"> = </span><a href="#loc_46_55_46_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_55_46_59&#39;)"><span class="hl_varref"><span class="mpre">malg</span></span></a><span class="mpre">
        </span><a name="loc_58_9_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_12&#39;)"><span class="hl_vardecl"><span class="mpre">hsh</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_33_1_33_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_15&#39;)"><span class="hl_varref"><span class="mpre">getHashAndASN1</span></span></a><span class="mpre"> </span><a href="#loc_57_18_57_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_25&#39;)"><span class="hl_varref"><span class="mpre">hashSig</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_58_9_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_12&#39;)"><span class="hl_varref"><span class="mpre">hsh</span></span></a><span class="mpre">, </span><a href="#loc_46_60_46_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_60_46_64&#39;)"><span class="hl_varref"><span class="mpre">msgs</span></span></a><span class="mpre">)

</span><a href="#loc_62_1_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_18&#39;)"><span class="mpre">signatureHashData</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_97_6_97_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_97_6_97_24&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureAlgorithm</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_86_6_86_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_86_6_86_19&#39;)"><span class="hl_tyconref"><span class="mpre">HashAlgorithm</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre">
</span><a name="loc_62_1_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_18&#39;)"><span class="hl_fundecl"><span class="mpre">signatureHashData</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_99_7_99_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_99_7_99_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureRSA</span></span></a><span class="mpre"> </span><a name="loc_62_32_62_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_32_62_37&#39;)"><span class="hl_vardecl"><span class="mpre">mhash</span></span></a><span class="mpre"> =
    case </span><a href="#loc_62_32_62_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_32_62_37&#39;)"><span class="hl_varref"><span class="mpre">mhash</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_93_7_93_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_93_7_93_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA512</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_79_1_79_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_79_1_79_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA512</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_91_7_91_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_91_7_91_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA256</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_67_1_67_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_67_1_67_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA256</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_89_7_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_89_7_89_15&#39;)"><span class="hl_conref"><span class="mpre">HashSHA1</span></span></a><span class="mpre">   -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_55_1_55_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_55_1_55_14&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA1</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">         -&gt; </span><span class="hl_conref"><span class="mpre">HashDescr</span></span><span class="mpre"> (</span><a href="Network.TLS.Crypto.html#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">hashFinal</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Crypto.html#loc_113_1_113_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_113_1_113_11&#39;)"><span class="hl_varref"><span class="mpre">hashUpdate</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Crypto.html#loc_110_1_110_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_110_1_110_9&#39;)"><span class="hl_varref"><span class="mpre">hashInit</span></span></a><span class="mpre"> </span><a href="Network.TLS.Crypto.html#loc_125_1_125_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_125_1_125_12&#39;)"><span class="hl_varref"><span class="mpre">hashMD5SHA1</span></span></a><span class="mpre">)) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
        _               -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;unimplemented signature hash type&quot;</span></span><span class="mpre">)
</span><a href="#loc_62_1_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_18&#39;)"><span class="hl_fundecl"><span class="mpre">signatureHashData</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_100_7_100_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_100_7_100_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureDSS</span></span></a><span class="mpre"> </span><a name="loc_69_32_69_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_32_69_37&#39;)"><span class="hl_vardecl"><span class="mpre">mhash</span></span></a><span class="mpre"> =
    case </span><a href="#loc_69_32_69_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_32_69_37&#39;)"><span class="hl_varref"><span class="mpre">mhash</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">       -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_55_1_55_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_55_1_55_14&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA1</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_89_7_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_89_7_89_15&#39;)"><span class="hl_conref"><span class="mpre">HashSHA1</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_55_1_55_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_55_1_55_14&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA1</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _        -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;invalid DSA hash choice, only SHA1 allowed&quot;</span></span><span class="mpre">
</span><a href="#loc_62_1_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_18&#39;)"><span class="hl_fundecl"><span class="mpre">signatureHashData</span></span></a><span class="mpre"> </span><a name="loc_74_19_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_22&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;unimplemented signature type: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_74_19_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_22&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre">)

</span><a href="#loc_77_1_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_16&#39;)"><span class="mpre">signatureCreate</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HashAndSignatureAlgorithm</span></span><span class="mpre"> -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_109_6_109_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_6_109_21&#39;)"><span class="hl_tyconref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre">
</span><a name="loc_77_1_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_16&#39;)"><span class="hl_fundecl"><span class="mpre">signatureCreate</span></span></a><span class="mpre"> </span><a name="loc_77_17_77_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_20&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_77_21_77_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_25&#39;)"><span class="hl_vardecl"><span class="mpre">malg</span></span></a><span class="mpre"> </span><a name="loc_77_26_77_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_26_77_36&#39;)"><span class="hl_vardecl"><span class="mpre">hashMethod</span></span></a><span class="mpre"> </span><a name="loc_77_37_77_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_37_77_43&#39;)"><span class="hl_vardecl"><span class="mpre">toSign</span></span></a><span class="mpre"> = do
    </span><a name="loc_78_5_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_7&#39;)"><span class="hl_vardecl"><span class="mpre">cc</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_183_1_183_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_183_1_183_12&#39;)"><span class="hl_varref"><span class="mpre">usingState_</span></span></a><span class="mpre"> </span><a href="#loc_77_17_77_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_20&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.State.html#loc_204_1_204_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_204_1_204_16&#39;)"><span class="hl_varref"><span class="mpre">isClientContext</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_109_24_109_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_24_109_39&#39;)"><span class="hl_conref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre"> </span><a href="#loc_77_21_77_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_25&#39;)"><span class="hl_varref"><span class="mpre">malg</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Handshake.Key.html#loc_40_1_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.Key.html#loc_40_1_40_8&#39;)"><span class="hl_varref"><span class="mpre">signRSA</span></span></a><span class="mpre"> </span><a href="#loc_77_17_77_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_20&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_78_5_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_7&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre"> </span><a href="#loc_77_26_77_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_26_77_36&#39;)"><span class="hl_varref"><span class="mpre">hashMethod</span></span></a><span class="mpre"> </span><a href="#loc_77_37_77_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_37_77_43&#39;)"><span class="hl_varref"><span class="mpre">toSign</span></span></a><span class="mpre">

</span><a href="#loc_82_1_82_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_16&#39;)"><span class="mpre">signatureVerify</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_97_6_97_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_97_6_97_24&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureAlgorithm</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_109_6_109_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_6_109_21&#39;)"><span class="hl_tyconref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_82_1_82_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">signatureVerify</span></span></a><span class="mpre"> </span><a name="loc_82_17_82_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_17_82_20&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_82_21_82_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_21_82_35&#39;)"><span class="hl_vardecl"><span class="mpre">sigAlgExpected</span></span></a><span class="mpre"> </span><a name="loc_82_36_82_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_36_82_44&#39;)"><span class="hl_vardecl"><span class="mpre">toVerify</span></span></a><span class="mpre"> </span><a name="loc_82_45_82_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_45_82_51&#39;)"><span class="hl_specname"><span class="mpre">digSig</span></span></a><span class="mpre">@(</span><a href="Network.TLS.Struct.html#loc_109_24_109_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_24_109_39&#39;)"><span class="hl_conref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre"> </span><a name="loc_82_69_82_79" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_69_82_79&#39;)"><span class="hl_vardecl"><span class="mpre">hashSigAlg</span></span></a><span class="mpre"> _) = do
    </span><a name="loc_83_5_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_16&#39;)"><span class="hl_vardecl"><span class="mpre">usedVersion</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_183_1_183_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_183_1_183_12&#39;)"><span class="hl_varref"><span class="mpre">usingState_</span></span></a><span class="mpre"> </span><a href="#loc_82_17_82_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_17_82_20&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="Network.TLS.State.html#loc_165_1_165_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_165_1_165_11&#39;)"><span class="hl_varref"><span class="mpre">getVersion</span></span></a><span class="mpre">
    let </span><a name="loc_84_9_84_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_18&#39;)"><span class="hl_vardecl"><span class="mpre">hashDescr</span></span></a><span class="mpre"> = case (</span><a href="#loc_83_5_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_16&#39;)"><span class="hl_varref"><span class="mpre">usedVersion</span></span></a><span class="mpre">, </span><a href="#loc_82_69_82_79" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_69_82_79&#39;)"><span class="hl_varref"><span class="mpre">hashSigAlg</span></span></a><span class="mpre">) of
            (</span><span class="hl_conref"><span class="mpre">TLS12</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)    -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;expecting hash and signature algorithm in a TLS12 digitally signed structure&quot;</span></span><span class="mpre">
            (</span><span class="hl_conref"><span class="mpre">TLS12</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_86_27_86_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_27_86_28&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">,</span><a name="loc_86_29_86_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_30&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)) | </span><a href="#loc_86_29_86_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_30&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_82_21_82_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_21_82_35&#39;)"><span class="hl_varref"><span class="mpre">sigAlgExpected</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_62_1_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_18&#39;)"><span class="hl_varref"><span class="mpre">signatureHashData</span></span></a><span class="mpre"> </span><a href="#loc_82_21_82_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_21_82_35&#39;)"><span class="hl_varref"><span class="mpre">sigAlgExpected</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_86_27_86_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_27_86_28&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)
                                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;expecting different signature algorithm&quot;</span></span><span class="mpre">
            (_,     </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)    -&gt; </span><a href="#loc_62_1_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_18&#39;)"><span class="hl_varref"><span class="mpre">signatureHashData</span></span></a><span class="mpre"> </span><a href="#loc_82_21_82_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_21_82_35&#39;)"><span class="hl_varref"><span class="mpre">sigAlgExpected</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
            (_,     </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _)     -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not expecting hash and signature algorithm in a &lt; TLS12 digitially signed structure&quot;</span></span><span class="mpre">
    </span><a href="#loc_98_1_98_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_29&#39;)"><span class="hl_varref"><span class="mpre">signatureVerifyWithHashDescr</span></span></a><span class="mpre"> </span><a href="#loc_82_17_82_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_17_82_20&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_82_21_82_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_21_82_35&#39;)"><span class="hl_varref"><span class="mpre">sigAlgExpected</span></span></a><span class="mpre"> </span><a href="#loc_84_9_84_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_18&#39;)"><span class="hl_varref"><span class="mpre">hashDescr</span></span></a><span class="mpre"> </span><a href="#loc_82_36_82_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_36_82_44&#39;)"><span class="hl_varref"><span class="mpre">toVerify</span></span></a><span class="mpre"> </span><a href="#loc_82_45_82_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_45_82_51&#39;)"><span class="hl_varref"><span class="mpre">digSig</span></span></a><span class="mpre">

</span><a href="#loc_98_1_98_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_29&#39;)"><span class="mpre">signatureVerifyWithHashDescr</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre">
                             -&gt; </span><a href="Network.TLS.Struct.html#loc_97_6_97_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_97_6_97_24&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureAlgorithm</span></span></a><span class="mpre">
                             -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre">
                             -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
                             -&gt; </span><a href="Network.TLS.Struct.html#loc_109_6_109_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_6_109_21&#39;)"><span class="hl_tyconref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre">
                             -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_98_1_98_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_29&#39;)"><span class="hl_fundecl"><span class="mpre">signatureVerifyWithHashDescr</span></span></a><span class="mpre"> </span><a name="loc_98_30_98_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_30_98_33&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_98_34_98_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_34_98_48&#39;)"><span class="hl_vardecl"><span class="mpre">sigAlgExpected</span></span></a><span class="mpre"> </span><a name="loc_98_49_98_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_49_98_58&#39;)"><span class="hl_vardecl"><span class="mpre">hashDescr</span></span></a><span class="mpre"> </span><a name="loc_98_59_98_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_59_98_67&#39;)"><span class="hl_vardecl"><span class="mpre">toVerify</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_109_24_109_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_24_109_39&#39;)"><span class="hl_conref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre"> _ </span><a name="loc_98_87_98_89" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_87_98_89&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = do
    </span><a name="loc_99_5_99_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_7&#39;)"><span class="hl_vardecl"><span class="mpre">cc</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_183_1_183_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_183_1_183_12&#39;)"><span class="hl_varref"><span class="mpre">usingState_</span></span></a><span class="mpre"> </span><a href="#loc_98_30_98_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_30_98_33&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.State.html#loc_204_1_204_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_204_1_204_16&#39;)"><span class="hl_varref"><span class="mpre">isClientContext</span></span></a><span class="mpre">
    case </span><a href="#loc_98_34_98_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_34_98_48&#39;)"><span class="hl_varref"><span class="mpre">sigAlgExpected</span></span></a><span class="mpre"> of
        </span><a href="Network.TLS.Struct.html#loc_99_7_99_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_99_7_99_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureRSA</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Handshake.Key.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.Key.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">verifyRSA</span></span></a><span class="mpre"> </span><a href="#loc_98_30_98_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_30_98_33&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_99_5_99_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_7&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre"> </span><a href="#loc_98_49_98_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_49_98_58&#39;)"><span class="hl_varref"><span class="mpre">hashDescr</span></span></a><span class="mpre"> </span><a href="#loc_98_59_98_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_59_98_67&#39;)"><span class="hl_varref"><span class="mpre">toVerify</span></span></a><span class="mpre"> </span><a href="#loc_98_87_98_89" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_87_98_89&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        </span><a href="Network.TLS.Struct.html#loc_100_7_100_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_100_7_100_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureDSS</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Handshake.Key.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.Key.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">verifyRSA</span></span></a><span class="mpre"> </span><a href="#loc_98_30_98_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_30_98_33&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_99_5_99_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_7&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre"> </span><a href="#loc_98_49_98_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_49_98_58&#39;)"><span class="hl_varref"><span class="mpre">hashDescr</span></span></a><span class="mpre"> </span><a href="#loc_98_59_98_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_59_98_67&#39;)"><span class="hl_varref"><span class="mpre">toVerify</span></span></a><span class="mpre"> </span><a href="#loc_98_87_98_89" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_87_98_89&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        _            -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not implemented yet&quot;</span></span><span class="mpre">

</span><a href="#loc_106_1_106_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_23&#39;)"><span class="mpre">generateSignedDHParams</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_226_6_226_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_226_6_226_20&#39;)"><span class="hl_tyconref"><span class="mpre">ServerDHParams</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_106_1_106_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_23&#39;)"><span class="hl_fundecl"><span class="mpre">generateSignedDHParams</span></span></a><span class="mpre"> </span><a name="loc_106_24_106_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_24_106_27&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_106_28_106_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_40&#39;)"><span class="hl_vardecl"><span class="mpre">serverParams</span></span></a><span class="mpre"> = do
    (</span><a name="loc_107_6_107_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_6_107_10&#39;)"><span class="hl_vardecl"><span class="mpre">cran</span></span></a><span class="mpre">, </span><a name="loc_107_12_107_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_12_107_16&#39;)"><span class="hl_vardecl"><span class="mpre">sran</span></span></a><span class="mpre">) &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_186_1_186_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_186_1_186_12&#39;)"><span class="hl_varref"><span class="mpre">usingHState</span></span></a><span class="mpre"> </span><a href="#loc_106_24_106_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_24_106_27&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                        </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="Network.TLS.Handshake.State.html#loc_64_7_64_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.State.html#loc_64_7_64_22&#39;)"><span class="hl_varref"><span class="mpre">hstClientRandom</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Util.html#loc_53_1_53_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Util.html#loc_53_1_53_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;server random&quot;</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="Network.TLS.Handshake.State.html#loc_65_7_65_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.State.html#loc_65_7_65_22&#39;)"><span class="hl_varref"><span class="mpre">hstServerRandom</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Packet.html#loc_583_1_583_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Packet.html#loc_583_1_583_21&#39;)"><span class="hl_varref"><span class="mpre">encodeSignedDHParams</span></span></a><span class="mpre"> </span><a href="#loc_107_6_107_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_6_107_10&#39;)"><span class="hl_varref"><span class="mpre">cran</span></span></a><span class="mpre"> </span><a href="#loc_107_12_107_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_12_107_16&#39;)"><span class="hl_varref"><span class="mpre">sran</span></span></a><span class="mpre"> </span><a href="#loc_106_28_106_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_40&#39;)"><span class="hl_varref"><span class="mpre">serverParams</span></span></a><span class="mpre">
</span></div></body></html>