<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  MacroPass</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  2004 Malcolm Wallace</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence     :  LGPL</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Malcolm Wallace &lt;Malcolm.Wallace@cs.york.ac.uk&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  All</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Perform a cpp.second-pass, accumulating \#define&#39;s and \#undef&#39;s,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- whilst doing symbol replacement and macro expansion.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Language.Preprocessor.Cpphs.MacroPass
  ( macroPass
  , preDefine
  , defineMacro
  , macroPassReturningSymTab
  ) where

import Language.Preprocessor.Cpphs.HashDefine (</span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16&#39;)"><span class="mpre">HashDefine</span></a><span class="mpre">(..), </span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_61_1_61_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_61_1_61_12&#39;)"><span class="mpre">expandMacro</span></a><span class="mpre">
                                              , </span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_115_1_115_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_115_1_115_20&#39;)"><span class="mpre">simplifyHashDefines</span></a><span class="mpre">)
import Language.Preprocessor.Cpphs.Tokenise   (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9&#39;)"><span class="mpre">tokenise</span></a><span class="mpre">, </span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_66_6_66_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_66_6_66_15&#39;)"><span class="mpre">WordStyle</span></a><span class="mpre">(..)
                                              , </span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_268_1_268_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_268_1_268_15&#39;)"><span class="mpre">parseMacroCall</span></a><span class="mpre">)
import Language.Preprocessor.Cpphs.SymTab     (SymTab, </span><a href="Language.Preprocessor.Cpphs.SymTab.html#loc_40_1_40_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.SymTab.html#loc_40_1_40_9&#39;)"><span class="mpre">lookupST</span></a><span class="mpre">, </span><a href="Language.Preprocessor.Cpphs.SymTab.html#loc_38_1_38_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.SymTab.html#loc_38_1_38_9&#39;)"><span class="mpre">insertST</span></a><span class="mpre">
                                              , </span><a href="Language.Preprocessor.Cpphs.SymTab.html#loc_37_1_37_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.SymTab.html#loc_37_1_37_8&#39;)"><span class="mpre">emptyST</span></a><span class="mpre">, </span><a href="Language.Preprocessor.Cpphs.SymTab.html#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.SymTab.html#loc_45_1_45_10&#39;)"><span class="mpre">flattenST</span></a><span class="mpre">)
import Language.Preprocessor.Cpphs.Position   (</span><a href="Language.Preprocessor.Cpphs.Position.html#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_28_6_28_10&#39;)"><span class="mpre">Posn</span></a><span class="mpre">, </span><a href="Language.Preprocessor.Cpphs.Position.html#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_42_1_42_8&#39;)"><span class="mpre">newfile</span></a><span class="mpre">, </span><a href="Language.Preprocessor.Cpphs.Position.html#loc_75_1_75_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_75_1_75_9&#39;)"><span class="mpre">filename</span></a><span class="mpre">, </span><a href="Language.Preprocessor.Cpphs.Position.html#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_74_1_74_7&#39;)"><span class="mpre">lineno</span></a><span class="mpre">)
import Language.Preprocessor.Cpphs.Options    (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17&#39;)"><span class="mpre">BoolOptions</span></a><span class="mpre">(..))
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="mpre">unsafeInterleaveIO</span></a><span class="mpre">)
import Control.Monad    (</span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="mpre">(=&lt;&lt;)</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/MacroPass.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 8, srcSpanEndLine = 32, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;System.Time&quot;"><span class="mpre">System.Time</span></span><span class="mpre">       (getClockTime, toCalendarTime, formatCalendarTime)
import System.Locale     (</span><a href="System.Locale.html#loc_50_1_50_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Locale.html#loc_50_1_50_18&#39;)"><span class="mpre">defaultTimeLocale</span></a><span class="mpre">)

</span><a href="#loc_36_1_36_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_6&#39;)"><span class="mpre">noPos</span></a><span class="mpre"> :: </span><a href="Language.Preprocessor.Cpphs.Position.html#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">
</span><a name="loc_36_1_36_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_6&#39;)"><span class="hl_vardecl"><span class="mpre">noPos</span></span></a><span class="mpre"> = </span><a href="Language.Preprocessor.Cpphs.Position.html#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_42_1_42_8&#39;)"><span class="hl_varref"><span class="mpre">newfile</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;preDefined&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Walk through the document, replacing calls of macros with the expanded RHS.</span></span><span class="mpre">
</span><a href="#loc_43_1_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_10&#39;)"><span class="mpre">macroPass</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]        </span><span class="hl_comment"><span class="mpre">-- ^ Pre-defined symbols and their values</span></span><span class="mpre">
          -&gt; </span><a href="Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17&#39;)"><span class="hl_tyconref"><span class="mpre">BoolOptions</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ Options that alter processing style</span></span><span class="mpre">
          -&gt; [(</span><a href="Language.Preprocessor.Cpphs.Position.html#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]        </span><span class="hl_comment"><span class="mpre">-- ^ The input file content</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- ^ The file after processing</span></span><span class="mpre">
</span><a name="loc_43_1_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_10&#39;)"><span class="hl_fundecl"><span class="mpre">macroPass</span></span></a><span class="mpre"> </span><a name="loc_43_11_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_15&#39;)"><span class="hl_vardecl"><span class="mpre">syms</span></span></a><span class="mpre"> </span><a name="loc_43_16_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_23&#39;)"><span class="hl_vardecl"><span class="mpre">options</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><a href="#loc_53_5_53_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_13&#39;)"><span class="hl_varref"><span class="mpre">safetail</span></span></a><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- to remove extra &quot;\n&quot; inserted below</span></span><span class="mpre">
         </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre">
         </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="hl_varref"><span class="mpre">onlyRights</span></span></a><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_48_7_48_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_48_7_48_13&#39;)"><span class="hl_varref"><span class="mpre">pragma</span></span></a><span class="mpre"> </span><a href="#loc_43_16_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_23&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">) (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_53_7_53_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_53_7_53_13&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_43_16_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_23&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">) (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_43_16_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_23&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">)
                   (</span><a href="#loc_89_1_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_10&#39;)"><span class="hl_varref"><span class="mpre">preDefine</span></span></a><span class="mpre"> </span><a href="#loc_43_16_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_23&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> </span><a href="#loc_43_11_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_15&#39;)"><span class="hl_varref"><span class="mpre">syms</span></span></a><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9&#39;)"><span class="hl_varref"><span class="mpre">tokenise</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_49_7_49_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_49_7_49_15&#39;)"><span class="hl_varref"><span class="mpre">stripEol</span></span></a><span class="mpre"> </span><a href="#loc_43_16_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_23&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">) (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_50_7_50_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_50_7_50_15&#39;)"><span class="hl_varref"><span class="mpre">stripC89</span></span></a><span class="mpre"> </span><a href="#loc_43_16_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_23&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">)
               (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_52_7_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_52_7_52_11&#39;)"><span class="hl_varref"><span class="mpre">ansi</span></span></a><span class="mpre"> </span><a href="#loc_43_16_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_23&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">) (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_43_16_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_23&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> ((</span><a href="#loc_36_1_36_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_6&#39;)"><span class="hl_varref"><span class="mpre">noPos</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)        </span><span class="hl_comment"><span class="mpre">-- ensure recognition of &quot;\n#&quot; at start of file</span></span><span class="mpre">
  where
    </span><a name="loc_53_5_53_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_13&#39;)"><span class="hl_fundecl"><span class="mpre">safetail</span></span></a><span class="mpre"> [] = []
    </span><a href="#loc_53_5_53_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_13&#39;)"><span class="hl_fundecl"><span class="mpre">safetail</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_54_17_54_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_54_17_54_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | auxiliary</span></span><span class="mpre">
</span><a href="#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="mpre">onlyRights</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">]
</span><a name="loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="hl_vardecl"><span class="mpre">onlyRights</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (\</span><a name="loc_58_26_58_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">-&gt;case </span><a href="#loc_58_26_58_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_58_45_58_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_45_58_46&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">-&gt; [</span><a href="#loc_58_45_58_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_45_58_46&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">]; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _-&gt; [];)

</span><span class="hl_comment"><span class="mpre">-- | Walk through the document, replacing calls of macros with the expanded RHS.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Additionally returns the active symbol table after processing.</span></span><span class="mpre">
</span><a href="#loc_68_1_68_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_25&#39;)"><span class="mpre">macroPassReturningSymTab</span></a><span class="mpre">
          :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]        </span><span class="hl_comment"><span class="mpre">-- ^ Pre-defined symbols and their values</span></span><span class="mpre">
          -&gt; </span><a href="Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17&#39;)"><span class="hl_tyconref"><span class="mpre">BoolOptions</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ Options that alter processing style</span></span><span class="mpre">
          -&gt; [(</span><a href="Language.Preprocessor.Cpphs.Position.html#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]        </span><span class="hl_comment"><span class="mpre">-- ^ The input file content</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,[(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)])
                                </span><span class="hl_comment"><span class="mpre">-- ^ The file and symbol table after processing</span></span><span class="mpre">
</span><a name="loc_68_1_68_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_25&#39;)"><span class="hl_fundecl"><span class="mpre">macroPassReturningSymTab</span></span></a><span class="mpre"> </span><a name="loc_68_26_68_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_26_68_30&#39;)"><span class="hl_vardecl"><span class="mpre">syms</span></span></a><span class="mpre"> </span><a name="loc_68_31_68_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_38&#39;)"><span class="hl_vardecl"><span class="mpre">options</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><a href="#loc_84_5_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_11&#39;)"><span class="hl_varref"><span class="mpre">mapFst</span></span></a><span class="mpre"> (</span><a href="#loc_78_5_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_13&#39;)"><span class="hl_varref"><span class="mpre">safetail</span></span></a><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- to remove extra &quot;\n&quot; inserted below</span></span><span class="mpre">
                 </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre">)
         </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_80_5_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_9&#39;)"><span class="hl_varref"><span class="mpre">walk</span></span></a><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_48_7_48_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_48_7_48_13&#39;)"><span class="hl_varref"><span class="mpre">pragma</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_38&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">) (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_53_7_53_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_53_7_53_13&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_38&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">) (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_38&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">)
                   (</span><a href="#loc_89_1_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_10&#39;)"><span class="hl_varref"><span class="mpre">preDefine</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_38&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> </span><a href="#loc_68_26_68_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_26_68_30&#39;)"><span class="hl_varref"><span class="mpre">syms</span></span></a><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9&#39;)"><span class="hl_varref"><span class="mpre">tokenise</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_49_7_49_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_49_7_49_15&#39;)"><span class="hl_varref"><span class="mpre">stripEol</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_38&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">) (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_50_7_50_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_50_7_50_15&#39;)"><span class="hl_varref"><span class="mpre">stripC89</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_38&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">)
               (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_52_7_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_52_7_52_11&#39;)"><span class="hl_varref"><span class="mpre">ansi</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_38&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">) (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_38&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> ((</span><a href="#loc_36_1_36_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_6&#39;)"><span class="hl_varref"><span class="mpre">noPos</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)        </span><span class="hl_comment"><span class="mpre">-- ensure recognition of &quot;\n#&quot; at start of file</span></span><span class="mpre">
  where
    </span><a name="loc_78_5_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_13&#39;)"><span class="hl_fundecl"><span class="mpre">safetail</span></span></a><span class="mpre"> [] = []
    </span><a href="#loc_78_5_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_13&#39;)"><span class="hl_fundecl"><span class="mpre">safetail</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_79_17_79_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_17_79_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_79_17_79_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_17_79_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a name="loc_80_5_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_9&#39;)"><span class="hl_fundecl"><span class="mpre">walk</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_80_17_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_17_80_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_80_20_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_20_80_24&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = let (</span><a name="loc_80_33_80_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_33_80_35&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,   </span><a name="loc_80_39_80_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_39_80_42&#39;)"><span class="hl_vardecl"><span class="mpre">foo</span></span></a><span class="mpre">) = </span><a href="#loc_80_5_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_9&#39;)"><span class="hl_varref"><span class="mpre">walk</span></span></a><span class="mpre"> </span><a href="#loc_80_20_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_20_80_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
                           in  (</span><a href="#loc_80_17_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_17_80_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_80_33_80_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_33_80_35&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">, </span><a href="#loc_80_39_80_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_39_80_42&#39;)"><span class="hl_varref"><span class="mpre">foo</span></span></a><span class="mpre">)
    </span><a href="#loc_80_5_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_9&#39;)"><span class="hl_fundecl"><span class="mpre">walk</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  </span><a name="loc_82_17_82_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_17_82_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> [])   =     ( [] , </span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_115_1_115_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_115_1_115_20&#39;)"><span class="hl_varref"><span class="mpre">simplifyHashDefines</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.SymTab.html#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.SymTab.html#loc_45_1_45_10&#39;)"><span class="hl_varref"><span class="mpre">flattenST</span></span></a><span class="mpre"> </span><a href="#loc_82_17_82_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_17_82_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) )
    </span><a href="#loc_80_5_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_9&#39;)"><span class="hl_fundecl"><span class="mpre">walk</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_83_20_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_20_83_24&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><a href="#loc_80_5_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_9&#39;)"><span class="hl_varref"><span class="mpre">walk</span></span></a><span class="mpre"> </span><a href="#loc_83_20_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_20_83_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
    </span><a name="loc_84_5_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">mapFst</span></span></a><span class="mpre"> </span><a name="loc_84_12_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_12_84_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_84_15_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_15_84_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_84_17_84_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_17_84_18&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = (</span><a href="#loc_84_12_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_12_84_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_84_15_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_15_84_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_84_17_84_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_17_84_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Turn command-line definitions (from @-D@) into &#39;HashDefine&#39;s.</span></span><span class="mpre">
</span><a href="#loc_89_1_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_10&#39;)"><span class="mpre">preDefine</span></a><span class="mpre"> :: </span><a href="Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17&#39;)"><span class="hl_tyconref"><span class="mpre">BoolOptions</span></span></a><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16&#39;)"><span class="hl_tyconref"><span class="mpre">HashDefine</span></span></a><span class="mpre">
</span><a name="loc_89_1_89_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_10&#39;)"><span class="hl_fundecl"><span class="mpre">preDefine</span></span></a><span class="mpre"> </span><a name="loc_89_11_89_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_11_89_18&#39;)"><span class="hl_vardecl"><span class="mpre">options</span></span></a><span class="mpre"> </span><a name="loc_89_19_89_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_19_89_26&#39;)"><span class="hl_vardecl"><span class="mpre">defines</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.SymTab.html#loc_38_1_38_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.SymTab.html#loc_38_1_38_9&#39;)"><span class="hl_varref"><span class="mpre">insertST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_95_1_95_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_12&#39;)"><span class="hl_varref"><span class="mpre">defineMacro</span></span></a><span class="mpre"> </span><a href="#loc_89_11_89_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_11_89_18&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (\ (</span><a name="loc_90_49_90_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_49_90_50&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">,</span><a name="loc_90_51_90_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_51_90_52&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">)-&gt; </span><a href="#loc_90_49_90_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_49_90_50&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_90_51_90_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_51_90_52&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">))
          </span><a href="Language.Preprocessor.Cpphs.SymTab.html#loc_37_1_37_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.SymTab.html#loc_37_1_37_8&#39;)"><span class="hl_varref"><span class="mpre">emptyST</span></span></a><span class="mpre"> </span><a href="#loc_89_19_89_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_19_89_26&#39;)"><span class="hl_varref"><span class="mpre">defines</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Turn a string representing a macro definition into a &#39;HashDefine&#39;.</span></span><span class="mpre">
</span><a href="#loc_95_1_95_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_12&#39;)"><span class="mpre">defineMacro</span></a><span class="mpre"> :: </span><a href="Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_44_6_44_17&#39;)"><span class="hl_tyconref"><span class="mpre">BoolOptions</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16&#39;)"><span class="hl_tyconref"><span class="mpre">HashDefine</span></span></a><span class="mpre">)
</span><a name="loc_95_1_95_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_12&#39;)"><span class="hl_fundecl"><span class="mpre">defineMacro</span></span></a><span class="mpre"> </span><a name="loc_95_13_95_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_17&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a name="loc_95_18_95_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_18_95_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    let (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56&#39;)"><span class="hl_conref"><span class="mpre">Cmd</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_96_20_96_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_20_96_22&#39;)"><span class="hl_vardecl"><span class="mpre">hd</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9&#39;)"><span class="hl_varref"><span class="mpre">tokenise</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_52_7_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_52_7_52_11&#39;)"><span class="hl_varref"><span class="mpre">ansi</span></span></a><span class="mpre"> </span><a href="#loc_95_13_95_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_17&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre">) (</span><a href="Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Options.html#loc_51_7_51_11&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_95_13_95_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_17&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre">)
                                     [(</span><a href="#loc_36_1_36_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_6&#39;)"><span class="hl_varref"><span class="mpre">noPos</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;\n#define &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_95_18_95_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_18_95_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">)]
    in (</span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_27_19_27_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_27_19_27_23&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_96_20_96_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_20_96_22&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">, </span><a href="#loc_96_20_96_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_20_96_22&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Trundle through the document, one word at a time, using the WordStyle</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   classification introduced by &#39;tokenise&#39; to decide whether to expand a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   word or macro.  Encountering a \#define or \#undef causes that symbol to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   be overwritten in the symbol table.  Any other remaining cpp directives</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   are discarded and replaced with blanks, except for \#line markers.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   All valid identifiers are checked for the presence of a definition</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of that name in the symbol table, and if so, expanded appropriately.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   (Bool arguments are: keep pragmas?  retain layout?  haskell language?)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The result lazily intersperses output text with symbol tables.  Lines</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   are emitted as they are encountered.  A symbol table is emitted after</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   each change to the defined symbols, and always at the end of processing.</span></span><span class="mpre">
</span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="mpre">macroProcess</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16&#39;)"><span class="hl_tyconref"><span class="mpre">HashDefine</span></span></a><span class="mpre"> -&gt; [</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_66_6_66_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_66_6_66_15&#39;)"><span class="hl_tyconref"><span class="mpre">WordStyle</span></span></a><span class="mpre">]
             -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_25_6_25_16&#39;)"><span class="hl_tyconref"><span class="mpre">HashDefine</span></span></a><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
</span><a name="loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">macroProcess</span></span></a><span class="mpre"> _ _ _ </span><a name="loc_114_20_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_20_114_22&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre">        []          = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_114_20_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_20_114_22&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">]
</span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a name="loc_115_14_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_14_115_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_115_18_115_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_18_115_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_115_20_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_20_115_22&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_66_38_66_43" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_66_38_66_43&#39;)"><span class="hl_conref"><span class="mpre">Other</span></span></a><span class="mpre"> </span><a name="loc_115_30_115_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_30_115_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_115_33_115_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_33_115_35&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)      = </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_115_30_115_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_30_115_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">    </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_115_14_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_14_115_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_115_18_115_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_18_115_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_115_20_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_20_115_22&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_115_33_115_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_33_115_35&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
</span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a name="loc_116_14_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_14_116_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_116_16_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_116_18_116_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_18_116_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_116_20_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_20_116_22&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56&#39;)"><span class="hl_conref"><span class="mpre">Cmd</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_116_37_116_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_37_116_39&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)  = </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_116_14_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_14_116_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_116_16_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_116_18_116_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_18_116_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_116_20_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_20_116_22&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_116_37_116_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_37_116_39&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
</span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a name="loc_117_14_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_117_16_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_16_117_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_117_18_117_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_18_117_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_117_20_117_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_20_117_22&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56&#39;)"><span class="hl_conref"><span class="mpre">Cmd</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">LineDrop</span></span><span class="mpre"> </span><a name="loc_117_44_117_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_44_117_45&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">))</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_117_49_117_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_49_117_51&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)
                                         = </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                           </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_117_44_117_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_44_117_45&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">    </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_117_14_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_117_16_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_16_117_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_117_18_117_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_18_117_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_117_20_117_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_20_117_22&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_117_49_117_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_49_117_51&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
</span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a name="loc_120_14_120_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_14_120_20&#39;)"><span class="hl_vardecl"><span class="mpre">pragma</span></span></a><span class="mpre"> </span><a name="loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_120_23_120_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_23_120_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_120_25_120_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_25_120_27&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56&#39;)"><span class="hl_conref"><span class="mpre">Cmd</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Pragma</span></span><span class="mpre"> </span><a name="loc_120_47_120_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_47_120_48&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">))</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_120_52_120_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_52_120_54&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)
               | </span><a href="#loc_120_14_120_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_14_120_20&#39;)"><span class="hl_varref"><span class="mpre">pragma</span></span></a><span class="mpre">    = </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_120_47_120_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_47_120_48&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_120_14_120_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_14_120_20&#39;)"><span class="hl_varref"><span class="mpre">pragma</span></span></a><span class="mpre"> </span><a href="#loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_120_23_120_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_23_120_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_120_25_120_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_25_120_27&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_120_52_120_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_52_120_54&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">          </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_120_14_120_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_14_120_20&#39;)"><span class="hl_varref"><span class="mpre">pragma</span></span></a><span class="mpre"> </span><a href="#loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_120_23_120_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_23_120_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_120_25_120_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_25_120_27&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_120_52_120_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_52_120_54&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
</span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a name="loc_123_14_123_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_14_123_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_123_16_123_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_16_123_22&#39;)"><span class="hl_vardecl"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a name="loc_123_23_123_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_23_123_27&#39;)"><span class="hl_vardecl"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a name="loc_123_28_123_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_28_123_30&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_66_53_66_56&#39;)"><span class="hl_conref"><span class="mpre">Cmd</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_123_42_123_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_42_123_44&#39;)"><span class="hl_vardecl"><span class="mpre">hd</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_123_47_123_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_49&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">) =
    let </span><a name="loc_124_9_124_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_9_124_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_32_19_32_29&#39;)"><span class="hl_varref"><span class="mpre">linebreaks</span></span></a><span class="mpre"> </span><a href="#loc_123_42_123_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_42_123_44&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">
        </span><a name="loc_125_9_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_9_125_14&#39;)"><span class="hl_vardecl"><span class="mpre">newST</span></span></a><span class="mpre"> = </span><a href="Language.Preprocessor.Cpphs.SymTab.html#loc_38_1_38_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.SymTab.html#loc_38_1_38_9&#39;)"><span class="hl_varref"><span class="mpre">insertST</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_27_19_27_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_27_19_27_23&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_123_42_123_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_42_123_44&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">, </span><a href="#loc_123_42_123_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_42_123_44&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">) </span><a href="#loc_123_28_123_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_28_123_30&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">
    in
    </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><a href="#loc_124_9_124_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_9_124_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="#loc_183_1_183_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_11&#39;)"><span class="hl_varref"><span class="mpre">emitSymTab</span></span></a><span class="mpre"> </span><a href="#loc_125_9_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_9_125_14&#39;)"><span class="hl_varref"><span class="mpre">newST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_123_14_123_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_14_123_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_123_16_123_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_16_123_22&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_123_23_123_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_23_123_27&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_125_9_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_9_125_14&#39;)"><span class="hl_varref"><span class="mpre">newST</span></span></a><span class="mpre"> </span><a href="#loc_123_47_123_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_47_123_49&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
</span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a name="loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a name="loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_vardecl"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a name="loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_vardecl"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a name="loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_66_18_66_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_66_18_66_23&#39;)"><span class="hl_conref"><span class="mpre">Ident</span></span></a><span class="mpre"> </span><a name="loc_130_39_130_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_39_130_40&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_130_41_130_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_41_130_42&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">) =
    case </span><a href="#loc_130_41_130_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_41_130_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
      </span><span class="hl_string"><span class="mpre">&quot;__FILE__&quot;</span></span><span class="mpre"> -&gt; </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Position.html#loc_75_1_75_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_75_1_75_9&#39;)"><span class="hl_varref"><span class="mpre">filename</span></span></a><span class="mpre"> </span><a href="#loc_130_39_130_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_39_130_40&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">))</span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
      </span><span class="hl_string"><span class="mpre">&quot;__LINE__&quot;</span></span><span class="mpre"> -&gt; </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.Position.html#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Position.html#loc_74_1_74_7&#39;)"><span class="hl_varref"><span class="mpre">lineno</span></span></a><span class="mpre"> </span><a href="#loc_130_39_130_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_39_130_40&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">))  </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
      </span><span class="hl_string"><span class="mpre">&quot;__DATE__&quot;</span></span><span class="mpre"> -&gt; do </span><a name="loc_134_24_134_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_24_134_25&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">
                            </span><span class="hl_varref"><span class="mpre">formatCalendarTime</span></span><span class="mpre"> </span><a href="System.Locale.html#loc_50_1_50_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Locale.html#loc_50_1_50_18&#39;)"><span class="hl_varref"><span class="mpre">defaultTimeLocale</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\&quot;%d %b %Y\&quot;&quot;</span></span><span class="mpre">
                            </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toCalendarTime</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getClockTime</span></span><span class="mpre">
                       </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_134_24_134_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_24_134_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
      </span><span class="hl_string"><span class="mpre">&quot;__TIME__&quot;</span></span><span class="mpre"> -&gt; do </span><a name="loc_138_24_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_24_138_25&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">
                            </span><span class="hl_varref"><span class="mpre">formatCalendarTime</span></span><span class="mpre"> </span><a href="System.Locale.html#loc_50_1_50_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Locale.html#loc_50_1_50_18&#39;)"><span class="hl_varref"><span class="mpre">defaultTimeLocale</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\&quot;%H:%M:%S\&quot;&quot;</span></span><span class="mpre">
                            </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toCalendarTime</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getClockTime</span></span><span class="mpre">
                       </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_138_24_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_24_138_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
      _ -&gt;
        case </span><a href="Language.Preprocessor.Cpphs.SymTab.html#loc_40_1_40_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.SymTab.html#loc_40_1_40_9&#39;)"><span class="hl_varref"><span class="mpre">lookupST</span></span></a><span class="mpre"> </span><a href="#loc_130_41_130_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_41_130_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_130_41_130_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_41_130_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_145_18_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_20&#39;)"><span class="hl_vardecl"><span class="mpre">hd</span></span></a><span class="mpre"> -&gt;
                case </span><a href="#loc_145_18_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_20&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre"> of
                    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/MacroPass.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 21, srcSpanEndLine = 147, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/MacroPass.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 33, srcSpanEndLine = 147, srcSpanEndColumn = 34},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Lang"><span class="mpre">AntiDefined {name=n}</span></span><span class="mpre"> -&gt; </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">n</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                            </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
                    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/MacroPass.hs&quot;, srcSpanStartLine = 149, srcSpanStartColumn = 21, srcSpanEndLine = 149, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/MacroPass.hs&quot;, srcSpanStartLine = 149, srcSpanStartColumn = 39, srcSpanEndLine = 149, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Lang"><span class="mpre">SymbolReplacement {replacement=r}</span></span><span class="mpre"> -&gt;
                        let </span><a name="loc_150_29_150_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_29_150_31&#39;)"><span class="hl_vardecl"><span class="mpre">r&#39;</span></span></a><span class="mpre"> = if </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">r</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">r</span></span><span class="mpre"> in
                        </span><span class="hl_comment"><span class="mpre">-- one-level expansion only:</span></span><span class="mpre">
                        </span><span class="hl_comment"><span class="mpre">-- emit r&#39; $ macroProcess layout st ws</span></span><span class="mpre">
                        </span><span class="hl_comment"><span class="mpre">-- multi-level expansion:</span></span><span class="mpre">
                        </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">
                                     (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9&#39;)"><span class="hl_varref"><span class="mpre">tokenise</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> [(</span><a href="#loc_130_39_130_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_39_130_40&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_150_29_150_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_29_150_31&#39;)"><span class="hl_varref"><span class="mpre">r&#39;</span></span></a><span class="mpre">)]
                                      </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">)
                    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/MacroPass.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 21, srcSpanEndLine = 157, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/MacroPass.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 36, srcSpanEndLine = 157, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Lang"><span class="mpre">MacroExpansion {}</span></span><span class="mpre"> -&gt;
                        case </span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_268_1_268_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_268_1_268_15&#39;)"><span class="hl_varref"><span class="mpre">parseMacroCall</span></span></a><span class="mpre"> </span><a href="#loc_130_39_130_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_39_130_40&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre"> of
                            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_130_41_130_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_41_130_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                       </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
                            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_161_35_161_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_35_161_39&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre">,</span><a name="loc_161_40_161_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_40_161_43&#39;)"><span class="hl_vardecl"><span class="mpre">ws&#39;</span></span></a><span class="mpre">) -&gt;
                                if </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_161_35_161_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_35_161_39&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> (</span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_41_19_41_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_41_19_41_28&#39;)"><span class="hl_varref"><span class="mpre">arguments</span></span></a><span class="mpre"> </span><a href="#loc_145_18_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_20&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">) then
                                     </span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_130_41_130_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_41_130_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_130_44_130_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_44_130_46&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
                                else do </span><a name="loc_164_41_164_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_41_164_46&#39;)"><span class="hl_vardecl"><span class="mpre">args&#39;</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="hl_varref"><span class="mpre">onlyRights</span></span></a><span class="mpre">)
                                                       </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre">
                                                                        </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">)
                                                      </span><a href="#loc_161_35_161_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_35_161_39&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">-- one-level expansion only:</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">-- emit (expandMacro hd args&#39; layout) $</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">--         macroProcess layout st ws&#39;</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">-- multi-level expansion:</span></span><span class="mpre">
                                        </span><a href="#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">macroProcess</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_31&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">
                                            (</span><a href="Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.Tokenise.html#loc_87_1_87_9&#39;)"><span class="hl_varref"><span class="mpre">tokenise</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_130_24_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_24_130_28&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre">
                                               [(</span><a href="#loc_130_39_130_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_39_130_40&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="Language.Preprocessor.Cpphs.HashDefine.html#loc_61_1_61_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Preprocessor.Cpphs.HashDefine.html#loc_61_1_61_12&#39;)"><span class="hl_varref"><span class="mpre">expandMacro</span></span></a><span class="mpre"> </span><a href="#loc_145_18_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_20&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre"> </span><a href="#loc_164_41_164_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_41_164_46&#39;)"><span class="hl_varref"><span class="mpre">args&#39;</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_23&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre">)]
                                            </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_161_40_161_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_40_161_43&#39;)"><span class="hl_varref"><span class="mpre">ws&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Useful helper function.</span></span><span class="mpre">
</span><a href="#loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="mpre">emit</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_179_1_179_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_5&#39;)"><span class="hl_fundecl"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a name="loc_179_6_179_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_6_179_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_179_8_179_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_8_179_10&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> = do </span><a name="loc_179_16_179_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_16_179_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeInterleaveIO</span></span></a><span class="mpre"> </span><a href="#loc_179_8_179_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_8_179_10&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre">
               </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_179_6_179_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_6_179_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_179_16_179_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_16_179_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">-- | Useful helper function.</span></span><span class="mpre">
</span><a href="#loc_183_1_183_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_11&#39;)"><span class="mpre">emitSymTab</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_183_1_183_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_11&#39;)"><span class="hl_fundecl"><span class="mpre">emitSymTab</span></span></a><span class="mpre"> </span><a name="loc_183_12_183_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_12_183_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_183_14_183_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_14_183_16&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> = do </span><a name="loc_183_22_183_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_22_183_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeInterleaveIO</span></span></a><span class="mpre"> </span><a href="#loc_183_14_183_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_14_183_16&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre">
                     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_183_12_183_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_12_183_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_183_22_183_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_22_183_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
</span></div></body></html>