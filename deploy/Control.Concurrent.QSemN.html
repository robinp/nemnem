<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Trustworthy #-}
{-# LANGUAGE DeriveDataTypeable, BangPatterns #-}
{-# OPTIONS_GHC -funbox-strict-fields #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Control.Concurrent.QSemN</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow 2001</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (concurrency)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Quantity semaphores in which each thread may wait for an arbitrary</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;amount\&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Control.Concurrent.QSemN
        (  </span><span class="hl_comment"><span class="mpre">-- * General Quantity Semaphores</span></span><span class="mpre">
          QSemN,        </span><span class="hl_comment"><span class="mpre">-- abstract</span></span><span class="mpre">
          newQSemN,     </span><span class="hl_comment"><span class="mpre">-- :: Int   -&gt; IO QSemN</span></span><span class="mpre">
          waitQSemN,    </span><span class="hl_comment"><span class="mpre">-- :: QSemN -&gt; Int -&gt; IO ()</span></span><span class="mpre">
          signalQSemN   </span><span class="hl_comment"><span class="mpre">-- :: QSemN -&gt; Int -&gt; IO ()</span></span><span class="mpre">
      ) where

import Control.Concurrent.MVar ( </span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="mpre">MVar</span></a><span class="mpre">, </span><a href="GHC.MVar.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_64_1_64_13&#39;)"><span class="mpre">newEmptyMVar</span></a><span class="mpre">, </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="mpre">takeMVar</span></a><span class="mpre">, </span><a href="GHC.MVar.html#loc_142_1_142_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_142_1_142_12&#39;)"><span class="mpre">tryTakeMVar</span></a><span class="mpre">
                          , </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="mpre">putMVar</span></a><span class="mpre">, </span><a href="GHC.MVar.html#loc_70_1_70_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_70_1_70_8&#39;)"><span class="mpre">newMVar</span></a><span class="mpre">
                          , </span><a href="GHC.MVar.html#loc_151_1_151_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_151_1_151_11&#39;)"><span class="mpre">tryPutMVar</span></a><span class="mpre">, </span><a href="GHC.MVar.html#loc_174_1_174_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_174_1_174_12&#39;)"><span class="mpre">isEmptyMVar</span></a><span class="mpre">)
import Data.Typeable
import Control.Exception
import Data.Maybe

</span><span class="hl_comment"><span class="mpre">-- | &#39;QSemN&#39; is a quantity semaphore in which the resource is aqcuired</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and released in units of one. It provides guaranteed FIFO ordering</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for satisfying blocked `waitQSemN` calls.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The pattern</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   bracket_ (waitQSemN n) (signalQSemN n) (...)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is safe; it never loses any of the resource.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_45_6_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_11&#39;)"><span class="hl_tycondecl"><span class="mpre">QSemN</span></span></a><span class="mpre"> = </span><a name="loc_45_14_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_19&#39;)"><span class="hl_condecl"><span class="mpre">QSemN</span></span></a><span class="mpre"> !(</span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)], [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)]))
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/QSemN.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 3, srcSpanEndLine = 46, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/QSemN.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 3, srcSpanEndLine = 46, srcSpanEndColumn = 11}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4."><span class="mpre">deriving Typeable</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- The semaphore state (i, xs, ys):</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   i is the current resource value</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   (xs,ys) is the queue of blocked threads, where the queue is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--           given by xs ++ reverse ys.  We can enqueue new blocked threads</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--           by consing onto ys, and dequeue by removing from the head of xs.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A blocked thread is represented by an empty (MVar ()).  To unblock</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the thread, we put () into the MVar.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A thread can dequeue itself by also putting () into the MVar, which</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it must do if it receives an exception while blocked in waitQSemN.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This means that when unblocking a thread in signalQSemN we must</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- first check whether the MVar is already full; the MVar lock on the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- semaphore itself resolves race conditions between signalQSemN and a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- thread attempting to dequeue itself.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Build a new &#39;QSemN&#39; with a supplied initial quantity.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  The initial quantity must be at least 0.</span></span><span class="mpre">
</span><a href="#loc_69_1_69_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_9&#39;)"><span class="mpre">newQSemN</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_45_6_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_11&#39;)"><span class="hl_tyconref"><span class="mpre">QSemN</span></span></a><span class="mpre">
</span><a name="loc_69_1_69_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_9&#39;)"><span class="hl_fundecl"><span class="mpre">newQSemN</span></span></a><span class="mpre"> </span><a name="loc_69_10_69_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_17&#39;)"><span class="hl_vardecl"><span class="mpre">initial</span></span></a><span class="mpre">
  | </span><a href="#loc_69_10_69_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_17&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;newQSemN: Initial quantity must be non-negative&quot;</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   = do
      </span><a name="loc_72_7_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_10&#39;)"><span class="hl_vardecl"><span class="mpre">sem</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_70_1_70_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_70_1_70_8&#39;)"><span class="hl_varref"><span class="mpre">newMVar</span></span></a><span class="mpre"> (</span><a href="#loc_69_10_69_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_17&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">, [], [])
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_45_14_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_19&#39;)"><span class="hl_conref"><span class="mpre">QSemN</span></span></a><span class="mpre"> </span><a href="#loc_72_7_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_10&#39;)"><span class="hl_varref"><span class="mpre">sem</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Wait for the specified quantity to become available</span></span><span class="mpre">
</span><a href="#loc_77_1_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_10&#39;)"><span class="mpre">waitQSemN</span></a><span class="mpre"> :: </span><a href="#loc_45_6_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_11&#39;)"><span class="hl_tyconref"><span class="mpre">QSemN</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_77_1_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_10&#39;)"><span class="hl_fundecl"><span class="mpre">waitQSemN</span></span></a><span class="mpre"> (</span><a href="#loc_45_14_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_19&#39;)"><span class="hl_conref"><span class="mpre">QSemN</span></span></a><span class="mpre"> </span><a name="loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) </span><a name="loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> =
  </span><a href="GHC.IO.html#loc_426_1_426_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_426_1_426_6&#39;)"><span class="hl_varref"><span class="mpre">mask_</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    (</span><a name="loc_79_6_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_6_79_7&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">,</span><a name="loc_79_8_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_10&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre">,</span><a name="loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre">) &lt;- </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
    let </span><a name="loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="#loc_79_6_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_6_79_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre">
    if </span><a href="#loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
       then do
         </span><a name="loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span></a><span class="mpre">
         </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_79_6_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_6_79_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">, </span><a href="#loc_79_8_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_10&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">, (</span><a href="#loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre">,</span><a href="#loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">)
         </span><a href="#loc_90_5_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_9&#39;)"><span class="hl_varref"><span class="mpre">wait</span></span></a><span class="mpre"> </span><a href="#loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
       else do
         </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">, </span><a href="#loc_79_8_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_10&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">, </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">)
         </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
  where
    </span><a name="loc_90_5_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_9&#39;)"><span class="hl_fundecl"><span class="mpre">wait</span></span></a><span class="mpre"> </span><a name="loc_90_10_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = do
        </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_90_10_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="Control.Exception.Base.html#loc_229_1_229_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_229_1_229_12&#39;)"><span class="hl_infix"><span class="mpre">`onException`</span></span></a><span class="mpre">
                (</span><a href="GHC.IO.html#loc_434_1_434_21" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_434_1_434_21&#39;)"><span class="hl_varref"><span class="mpre">uninterruptibleMask_</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do </span><span class="hl_comment"><span class="mpre">-- Note [signal uninterruptible]</span></span><span class="mpre">
                   (</span><a name="loc_93_21_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_21_93_22&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">,</span><a name="loc_93_23_93_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_23_93_25&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre">,</span><a name="loc_93_26_93_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_26_93_28&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre">) &lt;- </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
                   </span><a name="loc_94_20_94_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_20_94_21&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_142_1_142_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_142_1_142_12&#39;)"><span class="hl_varref"><span class="mpre">tryTakeMVar</span></span></a><span class="mpre"> </span><a href="#loc_90_10_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                   </span><a name="loc_95_20_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_20_95_22&#39;)"><span class="hl_vardecl"><span class="mpre">r&#39;</span></span></a><span class="mpre"> &lt;- if </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_94_20_94_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_20_94_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                            then </span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_varref"><span class="mpre">signal</span></span></a><span class="mpre"> </span><a href="#loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> (</span><a href="#loc_93_21_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_21_93_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">,</span><a href="#loc_93_23_93_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_23_93_25&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">,</span><a href="#loc_93_26_93_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_26_93_28&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">)
                            else do </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_90_10_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_93_21_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_21_93_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">,</span><a href="#loc_93_23_93_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_23_93_25&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">,</span><a href="#loc_93_26_93_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_26_93_28&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">)
                   </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_95_20_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_20_95_22&#39;)"><span class="hl_varref"><span class="mpre">r&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Signal that a given quantity is now available from the &#39;QSemN&#39;.</span></span><span class="mpre">
</span><a href="#loc_102_1_102_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_12&#39;)"><span class="mpre">signalQSemN</span></a><span class="mpre"> :: </span><a href="#loc_45_6_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_11&#39;)"><span class="hl_tyconref"><span class="mpre">QSemN</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_102_1_102_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_12&#39;)"><span class="hl_fundecl"><span class="mpre">signalQSemN</span></span></a><span class="mpre"> (</span><a href="#loc_45_14_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_19&#39;)"><span class="hl_conref"><span class="mpre">QSemN</span></span></a><span class="mpre"> </span><a name="loc_102_20_102_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_20_102_21&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) </span><a name="loc_102_23_102_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_23_102_25&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_434_1_434_21" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_434_1_434_21&#39;)"><span class="hl_varref"><span class="mpre">uninterruptibleMask_</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><a name="loc_103_3_103_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_4&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_102_20_102_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_20_102_21&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
  </span><a name="loc_104_3_104_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_5&#39;)"><span class="hl_vardecl"><span class="mpre">r&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_varref"><span class="mpre">signal</span></span></a><span class="mpre"> </span><a href="#loc_102_23_102_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_23_102_25&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> </span><a href="#loc_103_3_103_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_4&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
  </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_102_20_102_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_20_102_21&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_104_3_104_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_5&#39;)"><span class="hl_varref"><span class="mpre">r&#39;</span></span></a><span class="mpre">

</span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="mpre">signal</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
       -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)],[(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)])
       -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)],[(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)])

</span><a name="loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_fundecl"><span class="mpre">signal</span></span></a><span class="mpre"> </span><a name="loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_vardecl"><span class="mpre">sz0</span></span></a><span class="mpre"> (</span><a name="loc_111_13_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_13_111_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">,</span><a name="loc_111_15_111_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_17&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre">,</span><a name="loc_111_18_111_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_18_111_20&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre">) = </span><a href="#loc_113_4_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_8&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_varref"><span class="mpre">sz0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_111_13_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_13_111_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="#loc_111_15_111_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_17&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><a href="#loc_111_18_111_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_18_111_20&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre">
 where
   </span><a name="loc_113_4_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_8&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  </span><a name="loc_113_12_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_12_113_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a name="loc_113_15_113_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_15_113_17&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><a href="#loc_113_12_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_12_113_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">, </span><a href="#loc_113_15_113_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_15_113_17&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">)
   </span><a href="#loc_113_4_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_8&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> [] [] = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre">, [], [])
   </span><a href="#loc_113_4_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_8&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_115_9_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_11&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> [] </span><a name="loc_115_15_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_15_115_17&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre"> = </span><a href="#loc_113_4_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_8&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_115_9_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_11&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_115_15_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_15_115_17&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">) []
   </span><a href="#loc_113_4_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_8&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_116_9_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_11&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> ((</span><a name="loc_116_14_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_14_116_15&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre">,</span><a name="loc_116_16_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_17&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_116_19_116_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a name="loc_116_23_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_23_116_25&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre">
     | </span><a href="#loc_116_14_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_14_116_15&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_116_9_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_11&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> = do
       </span><a name="loc_118_8_118_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_8_118_9&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_174_1_174_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_174_1_174_12&#39;)"><span class="hl_varref"><span class="mpre">isEmptyMVar</span></span></a><span class="mpre"> </span><a href="#loc_116_16_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
       if </span><a href="#loc_118_8_118_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_8_118_9&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_116_9_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_11&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre">, (</span><a href="#loc_116_14_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_14_116_15&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">,</span><a href="#loc_116_16_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_116_19_116_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">, </span><a href="#loc_116_23_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_23_116_25&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">)
            else </span><a href="#loc_113_4_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_8&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_116_9_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_11&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> </span><a href="#loc_116_19_116_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_116_23_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_23_116_25&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
     | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
       </span><a name="loc_122_8_122_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_8_122_9&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_151_1_151_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_151_1_151_11&#39;)"><span class="hl_varref"><span class="mpre">tryPutMVar</span></span></a><span class="mpre"> </span><a href="#loc_116_16_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
       if </span><a href="#loc_122_8_122_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_8_122_9&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> then </span><a href="#loc_113_4_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_8&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_116_9_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_11&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_116_14_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_14_116_15&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">) </span><a href="#loc_116_19_116_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_116_23_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_23_116_25&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
            else </span><a href="#loc_113_4_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_8&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_116_9_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_11&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> </span><a href="#loc_116_19_116_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_116_23_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_23_116_25&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
</span></div></body></html>