<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- HTTP types for use with io-streams and pipes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright Â© 2012-2013 Operational Dynamics Consulting, Pty Ltd</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The code in this file, and the program it is a part of, is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- made available to you by its authors as open source software:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- you can redistribute it and/or modify it under the terms of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the BSD licence.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

{-# LANGUAGE BangPatterns       #-}
{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE OverloadedStrings  #-}
{-# OPTIONS_HADDOCK hide, prune #-}

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | If you&#39;re not http-streams or pipes-http and you&#39;re importing this,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- you&#39;re Doing It Wrong.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

module Network.Http.Internal (
    Hostname,
    Port,
    Request(..),
    EntityBody(..),
    ExpectMode(..),
    Response(..),
    StatusCode,
    TransferEncoding(..),
    ContentEncoding(..),
    getStatusCode,
    getStatusMessage,
    getHeader,
    Method(..),
    Headers,
    emptyHeaders,
    updateHeader,
    removeHeader,
    buildHeaders,
    lookupHeader,
    retrieveHeaders,
    HttpType (getHeaders),
    HttpParseException(..),

    </span><span class="hl_comment"><span class="mpre">-- for testing</span></span><span class="mpre">
    composeRequestBytes,
    composeResponseBytes
) where

import Prelude hiding (lookup)

import Blaze.ByteString.Builder (</span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="mpre">Builder</span></a><span class="mpre">)
import qualified Blaze.ByteString.Builder as Builder (</span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="mpre">copyByteString</span></a><span class="mpre">,
                                                      </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="mpre">copyByteString</span></a><span class="mpre">,
                                                      </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="mpre">fromByteString</span></a><span class="mpre">,
                                                      </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="mpre">fromByteString</span></a><span class="mpre">,
                                                      </span><a href="Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13&#39;)"><span class="mpre">toByteString</span></a><span class="mpre">)
import qualified Blaze.ByteString.Builder.Char8 as Builder (</span><a href="Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9&#39;)"><span class="mpre">fromChar</span></a><span class="mpre">,
                                                            </span><a href="Blaze.ByteString.Builder.Char8.html#loc_72_1_72_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_72_1_72_9&#39;)"><span class="mpre">fromShow</span></a><span class="mpre">,
                                                            </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="mpre">fromString</span></a><span class="mpre">)
import Control.Exception (Exception)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 8, srcSpanEndLine = 63, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 18, srcSpanEndLine = 64, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as S
import Data.CaseInsensitive (</span><a href="Data.CaseInsensitive.Internal.html#loc_86_6_86_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_6_86_8&#39;)"><span class="mpre">CI</span></a><span class="mpre">, </span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="mpre">mk</span></a><span class="mpre">, </span><a href="Data.CaseInsensitive.Internal.html#loc_86_18_86_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_18_86_26&#39;)"><span class="mpre">original</span></a><span class="mpre">)
import Data.HashMap.Strict (HashMap, delete, empty, foldrWithKey, </span><a href="Data.HashMap.Strict.html#loc_122_1_122_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.HashMap.Strict.html#loc_122_1_122_7&#39;)"><span class="mpre">insert</span></a><span class="mpre">,
                            </span><a href="Data.HashMap.Strict.html#loc_134_1_134_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.HashMap.Strict.html#loc_134_1_134_11&#39;)"><span class="mpre">insertWith</span></a><span class="mpre">, lookup, toList)
import Data.Int (</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="mpre">Int64</span></a><span class="mpre">)
import Data.List (</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">)
import Data.Monoid (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="mpre">mconcat</span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre">)
import Data.Typeable (</span><a href="Data.Typeable.Internal.html#loc_196_7_196_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.Internal.html#loc_196_7_196_15&#39;)"><span class="mpre">Typeable</span></a><span class="mpre">)
import Data.Word (Word16)

</span><span class="hl_comment"><span class="mpre">{-
    This is a String because that&#39;s what the uri package works in. There
    was a fairly detailed disucssion on haskell-cafe about this, with
    the conclusion that URLs are composed of characters, not octets.
-}</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 1, srcSpanEndLine = 80, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 1, srcSpanEndLine = 80, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Networ"><span class="mpre">type Hostname = ByteString</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 1, srcSpanEndLine = 82, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 1, srcSpanEndLine = 82, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Networ"><span class="mpre">type Port = Word16</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | HTTP Methods, as per RFC 2616</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_87_6_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_6_87_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Method</span></span></a><span class="mpre">
    = </span><a name="loc_88_7_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_10&#39;)"><span class="hl_condecl"><span class="mpre">GET</span></span></a><span class="mpre">
    | </span><a name="loc_89_7_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_11&#39;)"><span class="hl_condecl"><span class="mpre">HEAD</span></span></a><span class="mpre">
    | </span><a name="loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_condecl"><span class="mpre">POST</span></span></a><span class="mpre">
    | </span><a name="loc_91_7_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_10&#39;)"><span class="hl_condecl"><span class="mpre">PUT</span></span></a><span class="mpre">
    | </span><a name="loc_92_7_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_13&#39;)"><span class="hl_condecl"><span class="mpre">DELETE</span></span></a><span class="mpre">
    | </span><a name="loc_93_7_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_12&#39;)"><span class="hl_condecl"><span class="mpre">TRACE</span></span></a><span class="mpre">
    | </span><a name="loc_94_7_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_7_94_14&#39;)"><span class="hl_condecl"><span class="mpre">OPTIONS</span></span></a><span class="mpre">
    | </span><a name="loc_95_7_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_7_95_14&#39;)"><span class="hl_condecl"><span class="mpre">CONNECT</span></span></a><span class="mpre">
    | </span><a name="loc_96_7_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_12&#39;)"><span class="hl_condecl"><span class="mpre">PATCH</span></span></a><span class="mpre">
    | </span><a name="loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_condecl"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 9, srcSpanEndLine = 98, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 9, srcSpanEndLine = 98, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Netwo"><span class="mpre">deriving (Show, Read, Ord)</span></span><span class="mpre">


instance </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre"> </span><a href="#loc_87_6_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_6_87_12&#39;)"><span class="hl_tyconref"><span class="mpre">Method</span></span></a><span class="mpre"> where
    </span><a href="#loc_88_7_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_10&#39;)"><span class="hl_conref"><span class="mpre">GET</span></span></a><span class="mpre">          </span><a name="loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_88_7_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_10&#39;)"><span class="hl_conref"><span class="mpre">GET</span></span></a><span class="mpre">              = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_89_7_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_11&#39;)"><span class="hl_conref"><span class="mpre">HEAD</span></span></a><span class="mpre">         </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_89_7_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_11&#39;)"><span class="hl_conref"><span class="mpre">HEAD</span></span></a><span class="mpre">             = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_conref"><span class="mpre">POST</span></span></a><span class="mpre">         </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_conref"><span class="mpre">POST</span></span></a><span class="mpre">             = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_91_7_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_10&#39;)"><span class="hl_conref"><span class="mpre">PUT</span></span></a><span class="mpre">          </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_91_7_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_10&#39;)"><span class="hl_conref"><span class="mpre">PUT</span></span></a><span class="mpre">              = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_92_7_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_13&#39;)"><span class="hl_conref"><span class="mpre">DELETE</span></span></a><span class="mpre">       </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_92_7_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_13&#39;)"><span class="hl_conref"><span class="mpre">DELETE</span></span></a><span class="mpre">           = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_93_7_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_12&#39;)"><span class="hl_conref"><span class="mpre">TRACE</span></span></a><span class="mpre">        </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_93_7_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_12&#39;)"><span class="hl_conref"><span class="mpre">TRACE</span></span></a><span class="mpre">            = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_94_7_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_7_94_14&#39;)"><span class="hl_conref"><span class="mpre">OPTIONS</span></span></a><span class="mpre">      </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_94_7_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_7_94_14&#39;)"><span class="hl_conref"><span class="mpre">OPTIONS</span></span></a><span class="mpre">          = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_95_7_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_7_95_14&#39;)"><span class="hl_conref"><span class="mpre">CONNECT</span></span></a><span class="mpre">      </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_95_7_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_7_95_14&#39;)"><span class="hl_conref"><span class="mpre">CONNECT</span></span></a><span class="mpre">          = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_96_7_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_12&#39;)"><span class="hl_conref"><span class="mpre">PATCH</span></span></a><span class="mpre">        </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_96_7_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_12&#39;)"><span class="hl_conref"><span class="mpre">PATCH</span></span></a><span class="mpre">            = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_88_7_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_10&#39;)"><span class="hl_conref"><span class="mpre">GET</span></span></a><span class="mpre">          </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;GET&quot;</span></span><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_89_7_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_11&#39;)"><span class="hl_conref"><span class="mpre">HEAD</span></span></a><span class="mpre">         </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;HEAD&quot;</span></span><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_conref"><span class="mpre">POST</span></span></a><span class="mpre">         </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;POST&quot;</span></span><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_91_7_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_10&#39;)"><span class="hl_conref"><span class="mpre">PUT</span></span></a><span class="mpre">          </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;PUT&quot;</span></span><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_92_7_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_13&#39;)"><span class="hl_conref"><span class="mpre">DELETE</span></span></a><span class="mpre">       </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;DELETE&quot;</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_93_7_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_12&#39;)"><span class="hl_conref"><span class="mpre">TRACE</span></span></a><span class="mpre">        </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;TRACE&quot;</span></span><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_94_7_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_7_94_14&#39;)"><span class="hl_conref"><span class="mpre">OPTIONS</span></span></a><span class="mpre">      </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;OPTIONS&quot;</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_95_7_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_7_95_14&#39;)"><span class="hl_conref"><span class="mpre">CONNECT</span></span></a><span class="mpre">      </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;CONNECT&quot;</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_96_7_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_12&#39;)"><span class="hl_conref"><span class="mpre">PATCH</span></span></a><span class="mpre">        </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;PATCH&quot;</span></span><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><a name="loc_120_12_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_12_120_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">     </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><a name="loc_120_28_120_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_28_120_29&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">         = </span><a href="#loc_120_12_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_12_120_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_120_28_120_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_28_120_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
    </span><a name="loc_121_5_121_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_6&#39;)"><span class="hl_specname"><span class="mpre">m</span></span></a><span class="mpre">@(</span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> _) </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> </span><a name="loc_121_21_121_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_26&#39;)"><span class="hl_vardecl"><span class="mpre">other</span></span></a><span class="mpre">            = </span><a href="#loc_121_21_121_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_26&#39;)"><span class="hl_varref"><span class="mpre">other</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_121_5_121_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
    _            </span><a href="#loc_102_18_102_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_20&#39;)"><span class="hl_fundecl"><span class="mpre">==</span></span></a><span class="mpre"> _                = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A description of the request that will be sent to the server. Note</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- unlike other HTTP libraries, the request body is /not/ a part of this</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- object; that will be streamed out by you when actually sending the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- request with &#39;sendRequest&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Request&#39; has a useful @Show@ instance that will output the request</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- line and headers (as it will be sent over the wire but with the @\\r@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- characters stripped) which can be handy for debugging.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that the actual @Host:@ header is not set until the request is sent,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- so you will not see it in the Show instance (unless you call &#39;setHostname&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to override the value inherited from the @Connection@).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_138_6_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_13&#39;)"><span class="hl_tycondecl"><span class="mpre">Request</span></span></a><span class="mpre">
    = </span><span class="hl_condecl"><span class="mpre">Request</span></span><span class="mpre"> {
        </span><a name="loc_140_9_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_16&#39;)"><span class="hl_fielddecl"><span class="mpre">qMethod</span></span></a><span class="mpre">  :: !</span><a href="#loc_87_6_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_6_87_12&#39;)"><span class="hl_tyconref"><span class="mpre">Method</span></span></a><span class="mpre">,
        </span><a name="loc_141_9_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_14&#39;)"><span class="hl_fielddecl"><span class="mpre">qHost</span></span></a><span class="mpre">    :: !(</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">),
        </span><a name="loc_142_9_142_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_14&#39;)"><span class="hl_fielddecl"><span class="mpre">qPath</span></span></a><span class="mpre">    :: !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">,
        </span><a name="loc_143_9_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_14&#39;)"><span class="hl_fielddecl"><span class="mpre">qBody</span></span></a><span class="mpre">    :: !</span><a href="#loc_153_6_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_16&#39;)"><span class="hl_tyconref"><span class="mpre">EntityBody</span></span></a><span class="mpre">,
        </span><a name="loc_144_9_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_16&#39;)"><span class="hl_fielddecl"><span class="mpre">qExpect</span></span></a><span class="mpre">  :: !</span><a href="#loc_155_6_155_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_6_155_16&#39;)"><span class="hl_tyconref"><span class="mpre">ExpectMode</span></span></a><span class="mpre">,
        </span><a name="loc_145_9_145_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_17&#39;)"><span class="hl_fielddecl"><span class="mpre">qHeaders</span></span></a><span class="mpre"> :: !</span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre">
    }

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_138_6_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">q</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 149, srcSpanStartColumn = 14, srcSpanEndLine = 150, srcSpanEndColumn = 97}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 149, srcSpanStartColumn = 22, srcSpanEndLine = 149, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/sr"><span class="mpre">{-# SCC &quot;Request.show&quot; #-}
        S.unpack $ S.filter (/= &#39;\r&#39;) $ Builder.toByteString $ composeRequestBytes q &quot;&lt;default&gt;&quot;</span></span><span class="mpre">


data </span><a name="loc_153_6_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_16&#39;)"><span class="hl_tycondecl"><span class="mpre">EntityBody</span></span></a><span class="mpre"> = </span><a name="loc_153_19_153_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_24&#39;)"><span class="hl_condecl"><span class="mpre">Empty</span></span></a><span class="mpre"> | </span><a name="loc_153_27_153_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_27_153_35&#39;)"><span class="hl_condecl"><span class="mpre">Chunking</span></span></a><span class="mpre"> | </span><a name="loc_153_38_153_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_38_153_44&#39;)"><span class="hl_condecl"><span class="mpre">Static</span></span></a><span class="mpre"> </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">

data </span><a name="loc_155_6_155_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_6_155_16&#39;)"><span class="hl_tycondecl"><span class="mpre">ExpectMode</span></span></a><span class="mpre"> = </span><a name="loc_155_19_155_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_19_155_25&#39;)"><span class="hl_condecl"><span class="mpre">Normal</span></span></a><span class="mpre"> | </span><a name="loc_155_28_155_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_28_155_36&#39;)"><span class="hl_condecl"><span class="mpre">Continue</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
    The bit that builds up the actual string to be transmitted. This
    is on the critical path for every request, so we&#39;ll want to revisit
    this to improve performance.

    - Rewrite rule for Method?
    - How can serializing the Headers be made efficient?

    This code includes the RFC compliant CR-LF sequences as line
    terminators, which is why the Show instance above has to bother
    with removing them.
-}</span></span><span class="mpre">

</span><a href="#loc_171_1_171_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_20&#39;)"><span class="mpre">composeRequestBytes</span></a><span class="mpre"> :: </span><a href="#loc_138_6_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_171_1_171_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_20&#39;)"><span class="hl_fundecl"><span class="mpre">composeRequestBytes</span></span></a><span class="mpre"> </span><a name="loc_171_21_171_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_21_171_22&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_171_23_171_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_23_171_25&#39;)"><span class="hl_vardecl"><span class="mpre">h&#39;</span></span></a><span class="mpre"> =
    </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre">
       [</span><a href="#loc_178_5_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_16&#39;)"><span class="hl_varref"><span class="mpre">requestline</span></span></a><span class="mpre">,
        </span><a href="#loc_202_5_202_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_13&#39;)"><span class="hl_varref"><span class="mpre">hostLine</span></span></a><span class="mpre">,
        </span><a href="#loc_211_5_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_5_211_17&#39;)"><span class="hl_varref"><span class="mpre">headerFields</span></span></a><span class="mpre">,
        </span><a href="#loc_214_1_214_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">]
  where
    </span><a name="loc_178_5_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_16&#39;)"><span class="hl_vardecl"><span class="mpre">requestline</span></span></a><span class="mpre"> = </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre">
       [</span><a href="#loc_186_5_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_5_186_11&#39;)"><span class="hl_varref"><span class="mpre">method</span></span></a><span class="mpre">,
        </span><a href="#loc_216_1_216_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_3&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre">,
        </span><a href="#loc_198_5_198_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_8&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre">,
        </span><a href="#loc_216_1_216_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_3&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre">,
        </span><a href="#loc_200_5_200_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_12&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">,
        </span><a href="#loc_214_1_214_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">]

    </span><a name="loc_186_5_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_5_186_11&#39;)"><span class="hl_vardecl"><span class="mpre">method</span></span></a><span class="mpre"> = case </span><a href="#loc_140_9_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_16&#39;)"><span class="hl_varref"><span class="mpre">qMethod</span></span></a><span class="mpre"> </span><a href="#loc_171_21_171_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_21_171_22&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> of
        </span><a href="#loc_88_7_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_10&#39;)"><span class="hl_conref"><span class="mpre">GET</span></span></a><span class="mpre">     -&gt; </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;GET&quot;</span></span><span class="mpre">
        </span><a href="#loc_89_7_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_11&#39;)"><span class="hl_conref"><span class="mpre">HEAD</span></span></a><span class="mpre">    -&gt; </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;HEAD&quot;</span></span><span class="mpre">
        </span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_conref"><span class="mpre">POST</span></span></a><span class="mpre">    -&gt; </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;POST&quot;</span></span><span class="mpre">
        </span><a href="#loc_91_7_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_10&#39;)"><span class="hl_conref"><span class="mpre">PUT</span></span></a><span class="mpre">     -&gt; </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;PUT&quot;</span></span><span class="mpre">
        </span><a href="#loc_92_7_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_13&#39;)"><span class="hl_conref"><span class="mpre">DELETE</span></span></a><span class="mpre">  -&gt; </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;DELETE&quot;</span></span><span class="mpre">
        </span><a href="#loc_93_7_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_12&#39;)"><span class="hl_conref"><span class="mpre">TRACE</span></span></a><span class="mpre">   -&gt; </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;TRACE&quot;</span></span><span class="mpre">
        </span><a href="#loc_94_7_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_7_94_14&#39;)"><span class="hl_conref"><span class="mpre">OPTIONS</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;OPTIONS&quot;</span></span><span class="mpre">
        </span><a href="#loc_95_7_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_7_95_14&#39;)"><span class="hl_conref"><span class="mpre">CONNECT</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;CONNECT&quot;</span></span><span class="mpre">
        </span><a href="#loc_96_7_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_12&#39;)"><span class="hl_conref"><span class="mpre">PATCH</span></span></a><span class="mpre">   -&gt; </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;PATCH&quot;</span></span><span class="mpre">
        (</span><a href="#loc_97_7_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_7_97_13&#39;)"><span class="hl_conref"><span class="mpre">Method</span></span></a><span class="mpre"> </span><a name="loc_196_17_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_17_196_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) -&gt; </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_196_17_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_17_196_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

    </span><a name="loc_198_5_198_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_8&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Builder.copyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_142_9_142_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_14&#39;)"><span class="hl_varref"><span class="mpre">qPath</span></span></a><span class="mpre"> </span><a href="#loc_171_21_171_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_21_171_22&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

    </span><a name="loc_200_5_200_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_12&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1&quot;</span></span><span class="mpre">

    </span><a name="loc_202_5_202_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_13&#39;)"><span class="hl_vardecl"><span class="mpre">hostLine</span></span></a><span class="mpre"> = </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre">
       [</span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Host: &quot;</span></span><span class="mpre">,
        </span><a href="#loc_207_5_207_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_13&#39;)"><span class="hl_varref"><span class="mpre">hostname</span></span></a><span class="mpre">,
        </span><a href="#loc_214_1_214_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">]

    </span><a name="loc_207_5_207_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_13&#39;)"><span class="hl_vardecl"><span class="mpre">hostname</span></span></a><span class="mpre"> = case </span><a href="#loc_141_9_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_14&#39;)"><span class="hl_varref"><span class="mpre">qHost</span></span></a><span class="mpre"> </span><a href="#loc_171_21_171_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_21_171_22&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_208_14_208_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_14_208_16&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Builder.copyByteString</span></span></a><span class="mpre"> </span><a href="#loc_208_14_208_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_14_208_16&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Builder.copyByteString</span></span></a><span class="mpre"> </span><a href="#loc_171_23_171_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_23_171_25&#39;)"><span class="hl_varref"><span class="mpre">h&#39;</span></span></a><span class="mpre">

    </span><a name="loc_211_5_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_5_211_17&#39;)"><span class="hl_vardecl"><span class="mpre">headerFields</span></span></a><span class="mpre"> = </span><a href="#loc_364_1_364_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_12&#39;)"><span class="hl_varref"><span class="mpre">joinHeaders</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_357_5_357_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_5_357_11&#39;)"><span class="hl_varref"><span class="mpre">unWrap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_145_9_145_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_17&#39;)"><span class="hl_varref"><span class="mpre">qHeaders</span></span></a><span class="mpre"> </span><a href="#loc_171_21_171_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_21_171_22&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">


</span><a name="loc_214_1_214_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_5&#39;)"><span class="hl_vardecl"><span class="mpre">crlf</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">

</span><a name="loc_216_1_216_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_3&#39;)"><span class="hl_vardecl"><span class="mpre">sp</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromChar</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre">


</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 1, srcSpanEndLine = 219, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 1, srcSpanEndLine = 219, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Ne"><span class="mpre">type StatusCode = Int</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A description of the response received from the server. Note</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- unlike other HTTP libraries, the response body is /not/ a part</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of this object; that will be streamed in by you when calling</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;receiveResponse&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Like &#39;Request&#39;, &#39;Response&#39; has a @Show@ instance that will output</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the status line and response headers as they were received from the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- server.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_231_6_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_6_231_14&#39;)"><span class="hl_tycondecl"><span class="mpre">Response</span></span></a><span class="mpre">
    = </span><span class="hl_condecl"><span class="mpre">Response</span></span><span class="mpre"> {
        </span><a name="loc_233_9_233_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_9_233_20&#39;)"><span class="hl_fielddecl"><span class="mpre">pStatusCode</span></span></a><span class="mpre">       :: !</span><span class="hl_tyconref"><span class="mpre">StatusCode</span></span><span class="mpre">,
        </span><a name="loc_234_9_234_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_9_234_19&#39;)"><span class="hl_fielddecl"><span class="mpre">pStatusMsg</span></span></a><span class="mpre">        :: !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">,
        </span><a name="loc_235_9_235_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_26&#39;)"><span class="hl_fielddecl"><span class="mpre">pTransferEncoding</span></span></a><span class="mpre"> :: !</span><a href="#loc_246_6_246_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_22&#39;)"><span class="hl_tyconref"><span class="mpre">TransferEncoding</span></span></a><span class="mpre">,
        </span><a name="loc_236_9_236_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_9_236_25&#39;)"><span class="hl_fielddecl"><span class="mpre">pContentEncoding</span></span></a><span class="mpre">  :: !</span><a href="#loc_248_6_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_6_248_21&#39;)"><span class="hl_tyconref"><span class="mpre">ContentEncoding</span></span></a><span class="mpre">,
        </span><a name="loc_237_9_237_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_9_237_23&#39;)"><span class="hl_fielddecl"><span class="mpre">pContentLength</span></span></a><span class="mpre">    :: !(</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">),
        </span><a name="loc_238_9_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_17&#39;)"><span class="hl_fielddecl"><span class="mpre">pHeaders</span></span></a><span class="mpre">          :: !</span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre">
    }

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_231_6_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_6_231_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> =     </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 18, srcSpanEndLine = 243, srcSpanEndColumn = 86}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 26, srcSpanEndLine = 242, srcSpanEndColumn = 41},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/sr"><span class="mpre">{-# SCC &quot;Response.show&quot; #-}
        S.unpack $ S.filter (/= &#39;\r&#39;) $ Builder.toByteString $ composeResponseBytes p</span></span><span class="mpre">


data </span><a name="loc_246_6_246_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_22&#39;)"><span class="hl_tycondecl"><span class="mpre">TransferEncoding</span></span></a><span class="mpre"> = </span><a name="loc_246_25_246_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_25_246_29&#39;)"><span class="hl_condecl"><span class="mpre">None</span></span></a><span class="mpre"> | </span><a name="loc_246_32_246_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_32_246_39&#39;)"><span class="hl_condecl"><span class="mpre">Chunked</span></span></a><span class="mpre">

data </span><a name="loc_248_6_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_6_248_21&#39;)"><span class="hl_tycondecl"><span class="mpre">ContentEncoding</span></span></a><span class="mpre"> = </span><a name="loc_248_24_248_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_24_248_32&#39;)"><span class="hl_condecl"><span class="mpre">Identity</span></span></a><span class="mpre"> | </span><a name="loc_248_35_248_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_35_248_39&#39;)"><span class="hl_condecl"><span class="mpre">Gzip</span></span></a><span class="mpre"> | </span><a name="loc_248_42_248_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_42_248_49&#39;)"><span class="hl_condecl"><span class="mpre">Deflate</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 249, srcSpanStartColumn = 5, srcSpanEndLine = 249, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 249, srcSpanStartColumn = 5, srcSpanEndLine = 249, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/N"><span class="mpre">deriving (Show)</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Get the HTTP response status code.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_256_1_256_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_14&#39;)"><span class="mpre">getStatusCode</span></a><span class="mpre"> :: </span><a href="#loc_231_6_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_6_231_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">StatusCode</span></span><span class="mpre">
</span><a name="loc_256_1_256_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_14&#39;)"><span class="hl_vardecl"><span class="mpre">getStatusCode</span></span></a><span class="mpre"> = </span><a href="#loc_233_9_233_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_9_233_20&#39;)"><span class="hl_varref"><span class="mpre">pStatusCode</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_256_1_256_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_14&#39;)"><span class="mpre">getStatusCode</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Get the HTTP response status message. Keep in mind that this is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /not/ normative; whereas &#39;getStatusCode&#39; values are authoritative.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_264_1_264_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_17&#39;)"><span class="mpre">getStatusMessage</span></a><span class="mpre"> :: </span><a href="#loc_231_6_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_6_231_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_264_1_264_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_17&#39;)"><span class="hl_vardecl"><span class="mpre">getStatusMessage</span></span></a><span class="mpre"> = </span><a href="#loc_234_9_234_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_9_234_19&#39;)"><span class="hl_varref"><span class="mpre">pStatusMsg</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_264_1_264_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_17&#39;)"><span class="mpre">getStatusMessage</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Lookup a header in the response. HTTP header field names are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- case-insensitive, so you can specify the name to lookup however you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- like. If the header is not present @Nothing@ will be returned.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     let n = case getHeader p &quot;Content-Length&quot; of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                Just x&#39; -&gt; read x&#39; :: Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                Nothing -&gt; 0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which of course is essentially what goes on inside the client library when</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it receives a response from the server and has to figure out how many bytes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to read.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- There is a fair bit of complexity in some of the other HTTP response</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fields, so there are a number of specialized functions for reading</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- those values where we&#39;ve found them useful.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_10&#39;)"><span class="mpre">getHeader</span></a><span class="mpre"> :: </span><a href="#loc_231_6_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_6_231_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_285_1_285_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_10&#39;)"><span class="hl_fundecl"><span class="mpre">getHeader</span></span></a><span class="mpre"> </span><a name="loc_285_11_285_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_11_285_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_285_13_285_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_13_285_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> =
    </span><a href="#loc_432_1_432_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_13&#39;)"><span class="hl_varref"><span class="mpre">lookupHeader</span></span></a><span class="mpre"> </span><a href="#loc_288_5_288_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_6&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_285_13_285_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_13_285_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
  where
    </span><a name="loc_288_5_288_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_6&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><a href="#loc_238_9_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_17&#39;)"><span class="hl_varref"><span class="mpre">pHeaders</span></span></a><span class="mpre"> </span><a href="#loc_285_11_285_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_11_285_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Accessors common to both the outbound and return sides of an HTTP</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- connection.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
class </span><a name="loc_294_7_294_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_7_294_15&#39;)"><span class="hl_classdecl"><span class="mpre">HttpType</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">Ï</span></span><span class="mpre"> where

    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | Get the Headers from a Request or Response. Most people do not need</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- this; for most cases you just need to get a header or two from the</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- response, for which you can use &#39;getHeader&#39;. On the other hand, if you</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- do need to poke around in the raw headers,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- @ import Network.Http.Types @</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- will give you functions like &#39;lookupHeader&#39; and &#39;updateHeader&#39; to to</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- work with.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><a name="loc_307_5_307_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_5_307_15&#39;)"><span class="mpre">getHeaders</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">Ï</span></span><span class="mpre"> -&gt; </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre">

instance </span><a href="#loc_294_7_294_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_7_294_15&#39;)"><span class="hl_classref"><span class="mpre">HttpType</span></span></a><span class="mpre"> </span><a href="#loc_138_6_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> where
    </span><a href="#loc_307_5_307_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_5_307_15&#39;)"><span class="hl_fundecl"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a name="loc_310_16_310_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_16_310_17&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="#loc_145_9_145_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_17&#39;)"><span class="hl_varref"><span class="mpre">qHeaders</span></span></a><span class="mpre"> </span><a href="#loc_310_16_310_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_16_310_17&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

instance </span><a href="#loc_294_7_294_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_7_294_15&#39;)"><span class="hl_classref"><span class="mpre">HttpType</span></span></a><span class="mpre"> </span><a href="#loc_231_6_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_6_231_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> where
    </span><a href="#loc_307_5_307_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_5_307_15&#39;)"><span class="hl_fundecl"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a name="loc_313_16_313_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_16_313_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_238_9_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_17&#39;)"><span class="hl_varref"><span class="mpre">pHeaders</span></span></a><span class="mpre"> </span><a href="#loc_313_16_313_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_16_313_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">


</span><a href="#loc_317_1_317_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_1_317_21&#39;)"><span class="mpre">composeResponseBytes</span></a><span class="mpre"> :: </span><a href="#loc_231_6_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_6_231_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_317_1_317_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_1_317_21&#39;)"><span class="hl_fundecl"><span class="mpre">composeResponseBytes</span></span></a><span class="mpre"> </span><a name="loc_317_22_317_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_22_317_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> =
    </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre">
       [</span><a href="#loc_323_5_323_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_5_323_15&#39;)"><span class="hl_varref"><span class="mpre">statusline</span></span></a><span class="mpre">,
        </span><a href="#loc_337_5_337_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_5_337_17&#39;)"><span class="hl_varref"><span class="mpre">headerFields</span></span></a><span class="mpre">,
        </span><a href="#loc_214_1_214_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">]
  where
    </span><a name="loc_323_5_323_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_5_323_15&#39;)"><span class="hl_vardecl"><span class="mpre">statusline</span></span></a><span class="mpre"> = </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre">
       [</span><a href="#loc_335_5_335_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_5_335_12&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">,
        </span><a href="#loc_216_1_216_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_3&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre">,
        </span><a href="#loc_331_5_331_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_9&#39;)"><span class="hl_varref"><span class="mpre">code</span></span></a><span class="mpre">,
        </span><a href="#loc_216_1_216_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_3&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre">,
        </span><a href="#loc_333_5_333_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_5_333_12&#39;)"><span class="hl_varref"><span class="mpre">message</span></span></a><span class="mpre">,
        </span><a href="#loc_214_1_214_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">]

    </span><a name="loc_331_5_331_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_9&#39;)"><span class="hl_vardecl"><span class="mpre">code</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Char8.html#loc_72_1_72_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_72_1_72_9&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromShow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_233_9_233_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_9_233_20&#39;)"><span class="hl_varref"><span class="mpre">pStatusCode</span></span></a><span class="mpre"> </span><a href="#loc_317_22_317_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_22_317_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

    </span><a name="loc_333_5_333_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_5_333_12&#39;)"><span class="hl_vardecl"><span class="mpre">message</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Builder.copyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_234_9_234_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_9_234_19&#39;)"><span class="hl_varref"><span class="mpre">pStatusMsg</span></span></a><span class="mpre"> </span><a href="#loc_317_22_317_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_22_317_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

    </span><a name="loc_335_5_335_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_5_335_12&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1&quot;</span></span><span class="mpre">

    </span><a name="loc_337_5_337_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_5_337_17&#39;)"><span class="hl_vardecl"><span class="mpre">headerFields</span></span></a><span class="mpre"> = </span><a href="#loc_364_1_364_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_12&#39;)"><span class="hl_varref"><span class="mpre">joinHeaders</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_357_5_357_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_5_357_11&#39;)"><span class="hl_varref"><span class="mpre">unWrap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_238_9_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_17&#39;)"><span class="hl_varref"><span class="mpre">pHeaders</span></span></a><span class="mpre"> </span><a href="#loc_317_22_317_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_22_317_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The map of headers in a &#39;Request&#39; or &#39;Response&#39;. Note that HTTP</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- header field names are case insensitive, so if you call &#39;setHeader&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- on a field that&#39;s already defined but with a different capitalization</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- you will replace the existing value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-
    This is a fair bit of trouble just to avoid using a typedef here.
    Probably worth it, though; every other HTTP client library out there
    exposes the gory details of the underlying map implementation, and
    to use it you need to figure out all kinds of crazy imports. Indeed,
    this code used here in the Show instance for debugging has been
    copied &amp; pasted around various projects of mine since I started
    writing Haskell. It&#39;s quite tedious, and very arcane! So, wrap it
    up.
-}</span></span><span class="mpre">
newtype </span><a name="loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Headers</span></span></a><span class="mpre"> = </span><a name="loc_356_19_356_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_19_356_23&#39;)"><span class="hl_condecl"><span class="mpre">Wrap</span></span></a><span class="mpre"> {
    </span><a name="loc_357_5_357_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_5_357_11&#39;)"><span class="hl_fielddecl"><span class="mpre">unWrap</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HashMap</span></span><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_86_6_86_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_6_86_8&#39;)"><span class="hl_tyconref"><span class="mpre">CI</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
}

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_361_10_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_10_361_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.unpack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\r&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13&#39;)"><span class="hl_varref"><span class="mpre">Builder.toByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_364_1_364_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_12&#39;)"><span class="hl_varref"><span class="mpre">joinHeaders</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_357_5_357_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_5_357_11&#39;)"><span class="hl_varref"><span class="mpre">unWrap</span></span></a><span class="mpre"> </span><a href="#loc_361_10_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_10_361_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_364_1_364_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_12&#39;)"><span class="mpre">joinHeaders</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HashMap</span></span><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_86_6_86_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_6_86_8&#39;)"><span class="hl_tyconref"><span class="mpre">CI</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_364_1_364_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_12&#39;)"><span class="hl_fundecl"><span class="mpre">joinHeaders</span></span></a><span class="mpre"> </span><a name="loc_364_13_364_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_13_364_14&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldrWithKey</span></span><span class="mpre"> </span><a href="#loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> </span><a href="#loc_364_13_364_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_13_364_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><a href="#loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="mpre">combine</span></a><span class="mpre"> :: </span><a href="Data.CaseInsensitive.Internal.html#loc_86_6_86_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_6_86_8&#39;)"><span class="hl_tyconref"><span class="mpre">CI</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="hl_fundecl"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a name="loc_367_9_367_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_9_367_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_367_11_367_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_11_367_12&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_367_13_367_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_13_367_16&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> =
    </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> [</span><a href="#loc_367_13_367_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_13_367_16&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">, </span><a href="#loc_370_5_370_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_5_370_8&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Char8.html#loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre">, </span><a href="#loc_371_5_371_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_5_371_10&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre">, </span><a href="#loc_214_1_214_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">]
  where
    </span><a name="loc_370_5_370_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_5_370_8&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Builder.copyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.CaseInsensitive.Internal.html#loc_86_18_86_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_18_86_26&#39;)"><span class="hl_varref"><span class="mpre">original</span></span></a><span class="mpre"> </span><a href="#loc_367_9_367_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_9_367_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
    </span><a name="loc_371_5_371_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_5_371_10&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">Builder.fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_367_11_367_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_11_367_12&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="mpre">combine</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_375_1_375_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_1_375_13&#39;)"><span class="mpre">emptyHeaders</span></a><span class="mpre"> :: </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre">
</span><a name="loc_375_1_375_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_1_375_13&#39;)"><span class="hl_vardecl"><span class="mpre">emptyHeaders</span></span></a><span class="mpre"> =
    </span><a href="#loc_356_19_356_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_19_356_23&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">empty</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Set a header field to the specified value. This will overwrite</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- any existing value for the field. Remember that HTTP fields names</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are case insensitive!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_384_1_384_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_13&#39;)"><span class="mpre">updateHeader</span></a><span class="mpre"> :: </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre">
</span><a name="loc_384_1_384_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_13&#39;)"><span class="hl_fundecl"><span class="mpre">updateHeader</span></span></a><span class="mpre"> </span><a name="loc_384_14_384_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_14_384_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_384_16_384_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_16_384_17&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_384_18_384_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_18_384_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> =
    </span><a href="#loc_356_19_356_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_19_356_23&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><a href="#loc_387_6_387_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_6_387_12&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">
  where
    !</span><a name="loc_387_6_387_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_6_387_12&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> = </span><a href="Data.HashMap.Strict.html#loc_122_1_122_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.HashMap.Strict.html#loc_122_1_122_7&#39;)"><span class="hl_varref"><span class="mpre">insert</span></span></a><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">mk</span></span></a><span class="mpre"> </span><a href="#loc_384_16_384_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_16_384_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_384_18_384_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_18_384_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_388_6_388_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_6_388_7&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
    !</span><a name="loc_388_6_388_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_6_388_7&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_357_5_357_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_5_357_11&#39;)"><span class="hl_varref"><span class="mpre">unWrap</span></span></a><span class="mpre"> </span><a href="#loc_384_14_384_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_14_384_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Remove a header from the map. If a field with that name is not present,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then this will have no effect.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_395_1_395_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_13&#39;)"><span class="mpre">removeHeader</span></a><span class="mpre"> :: </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre">
</span><a name="loc_395_1_395_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_13&#39;)"><span class="hl_fundecl"><span class="mpre">removeHeader</span></span></a><span class="mpre"> </span><a name="loc_395_14_395_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_14_395_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_395_16_395_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_16_395_17&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> =
    </span><a href="#loc_356_19_356_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_19_356_23&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><a href="#loc_398_6_398_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_6_398_12&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">
  where
    !</span><a name="loc_398_6_398_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_6_398_12&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">delete</span></span><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">mk</span></span></a><span class="mpre"> </span><a href="#loc_395_16_395_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_16_395_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_399_6_399_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_6_399_7&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
    !</span><a name="loc_399_6_399_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_6_399_7&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_357_5_357_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_5_357_11&#39;)"><span class="hl_varref"><span class="mpre">unWrap</span></span></a><span class="mpre"> </span><a href="#loc_395_14_395_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_14_395_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Given a list of field-name,field-value pairs, construct a Headers map.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-
    This is only going to be used by RequestBuilder and ResponseParser,
    obviously. And yes, as usual, we go to a lot of trouble to splice out the
    function doing the work, in the name of type sanity.
-}</span></span><span class="mpre">
</span><a href="#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_13&#39;)"><span class="mpre">buildHeaders</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)] -&gt; </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre">
</span><a name="loc_411_1_411_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_13&#39;)"><span class="hl_fundecl"><span class="mpre">buildHeaders</span></span></a><span class="mpre"> </span><a name="loc_411_14_411_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_14_411_16&#39;)"><span class="hl_vardecl"><span class="mpre">hs</span></span></a><span class="mpre"> =
    </span><a href="#loc_356_19_356_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_19_356_23&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><a href="#loc_414_5_414_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_5_414_11&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">
  where
    </span><a name="loc_414_5_414_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_5_414_11&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_425_1_425_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_1_425_10&#39;)"><span class="hl_varref"><span class="mpre">addHeader</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">empty</span></span><span class="mpre"> </span><a href="#loc_411_14_411_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_14_411_16&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
    insertWith is used here for the case where a header is repeated
    (for example, Set-Cookie) and the values need to be intercalated
    with &#39;,&#39; as per RFC 2616 Â§4.2.
-}</span></span><span class="mpre">
</span><a href="#loc_425_1_425_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_1_425_10&#39;)"><span class="mpre">addHeader</span></a><span class="mpre">
    :: </span><span class="hl_tyconref"><span class="mpre">HashMap</span></span><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_86_6_86_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_6_86_8&#39;)"><span class="hl_tyconref"><span class="mpre">CI</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
    -&gt; </span><span class="hl_tyconref"><span class="mpre">HashMap</span></span><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_86_6_86_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_6_86_8&#39;)"><span class="hl_tyconref"><span class="mpre">CI</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_425_1_425_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_1_425_10&#39;)"><span class="hl_fundecl"><span class="mpre">addHeader</span></span></a><span class="mpre"> </span><a name="loc_425_11_425_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_11_425_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a name="loc_425_14_425_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_14_425_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">,</span><a name="loc_425_16_425_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_16_425_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) =
    </span><a href="Data.HashMap.Strict.html#loc_134_1_134_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.HashMap.Strict.html#loc_134_1_134_11&#39;)"><span class="hl_varref"><span class="mpre">insertWith</span></span></a><span class="mpre"> </span><a href="#loc_428_5_428_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_5_428_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">mk</span></span></a><span class="mpre"> </span><a href="#loc_425_14_425_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_14_425_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_425_16_425_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_16_425_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_425_11_425_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_11_425_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
  where
    </span><a name="loc_428_5_428_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_5_428_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_428_7_428_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_7_428_10&#39;)"><span class="hl_vardecl"><span class="mpre">new</span></span></a><span class="mpre"> </span><a name="loc_428_11_428_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_11_428_14&#39;)"><span class="hl_vardecl"><span class="mpre">old</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> [</span><a href="#loc_428_11_428_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_11_428_14&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="mpre">, </span><a href="#loc_428_7_428_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_7_428_10&#39;)"><span class="hl_varref"><span class="mpre">new</span></span></a><span class="mpre">]


</span><a href="#loc_432_1_432_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_13&#39;)"><span class="mpre">lookupHeader</span></a><span class="mpre"> :: </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_432_1_432_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_13&#39;)"><span class="hl_fundecl"><span class="mpre">lookupHeader</span></span></a><span class="mpre"> </span><a name="loc_432_14_432_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_14_432_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_432_16_432_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_16_432_17&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">mk</span></span></a><span class="mpre"> </span><a href="#loc_432_16_432_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_16_432_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_435_6_435_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_6_435_7&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
  where
    !</span><a name="loc_435_6_435_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_6_435_7&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_357_5_357_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_5_357_11&#39;)"><span class="hl_varref"><span class="mpre">unWrap</span></span></a><span class="mpre"> </span><a href="#loc_432_14_432_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_14_432_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Get the headers as a field-name,field-value association list.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_442_1_442_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_1_442_16&#39;)"><span class="mpre">retrieveHeaders</span></a><span class="mpre"> :: </span><a href="#loc_356_9_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_9_356_16&#39;)"><span class="hl_tyconref"><span class="mpre">Headers</span></span></a><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)]
</span><a name="loc_442_1_442_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_1_442_16&#39;)"><span class="hl_fundecl"><span class="mpre">retrieveHeaders</span></span></a><span class="mpre"> </span><a name="loc_442_17_442_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_17_442_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_448_1_448_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_1_448_5&#39;)"><span class="hl_varref"><span class="mpre">down</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toList</span></span><span class="mpre"> </span><a href="#loc_445_6_445_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_6_445_7&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
  where
    !</span><a name="loc_445_6_445_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_6_445_7&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_357_5_357_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_5_357_11&#39;)"><span class="hl_varref"><span class="mpre">unWrap</span></span></a><span class="mpre"> </span><a href="#loc_442_17_442_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_17_442_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_448_1_448_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_1_448_5&#39;)"><span class="mpre">down</span></a><span class="mpre"> :: (</span><a href="Data.CaseInsensitive.Internal.html#loc_86_6_86_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_6_86_8&#39;)"><span class="hl_tyconref"><span class="mpre">CI</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_448_1_448_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_1_448_5&#39;)"><span class="hl_fundecl"><span class="mpre">down</span></span></a><span class="mpre"> (</span><a name="loc_448_7_448_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_7_448_8&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_448_10_448_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_10_448_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) =
    (</span><a href="Data.CaseInsensitive.Internal.html#loc_86_18_86_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_86_18_86_26&#39;)"><span class="hl_varref"><span class="mpre">original</span></span></a><span class="mpre"> </span><a href="#loc_448_7_448_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_7_448_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">, </span><a href="#loc_448_10_448_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_10_448_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)

data </span><a name="loc_451_6_451_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_6_451_24&#39;)"><span class="hl_tycondecl"><span class="mpre">HttpParseException</span></span></a><span class="mpre"> = </span><a name="loc_451_27_451_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_27_451_45&#39;)"><span class="hl_condecl"><span class="mpre">HttpParseException</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 452, srcSpanStartColumn = 9, srcSpanEndLine = 452, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/Network/Http/Internal.hs&quot;, srcSpanStartLine = 452, srcSpanStartColumn = 9, srcSpanEndLine = 452, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-common-0.7.1.1/src/N"><span class="mpre">deriving (Typeable, Show)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Exception</span></span><span class="mpre"> </span><a href="#loc_451_6_451_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_6_451_24&#39;)"><span class="hl_tyconref"><span class="mpre">HttpParseException</span></span></a><span class="mpre">
</span></div></body></html>