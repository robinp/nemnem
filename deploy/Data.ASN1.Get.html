<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ASN1.Get</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Simple get module with really simple accessor for ASN1.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Original code is pulled from the Get module from cereal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which is covered by:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : Lennart Kolmodin, Galois Inc. 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The original code has been tailored and reduced to only cover the useful</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- case for asn1 and augmented by a position.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE Rank2Types #-}
module Data.ASN1.Get
    ( Result(..)
    , Input
    , Get
    , runGetPos
    , runGet
    , getBytes
    , getBytesCopy
    , getWord8
    ) where

import Control.Applicative (</span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="mpre">Applicative</span></a><span class="mpre">(..),</span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="mpre">Alternative</span></a><span class="mpre">(..))
import Control.Monad (</span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="mpre">ap</span></a><span class="mpre">,</span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="mpre">MonadPlus</span></a><span class="mpre">(..))
import Data.Maybe (</span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="mpre">fromMaybe</span></a><span class="mpre">)
import Foreign

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 18, srcSpanEndLine = 35, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">          as B
import qualified Data.ByteString.Unsafe   as B

</span><span class="hl_comment"><span class="mpre">-- | The result of a parse.</span></span><span class="mpre">
data </span><a name="loc_39_6_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_6_39_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> = </span><a name="loc_39_17_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_21&#39;)"><span class="hl_condecl"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- ^ The parse failed. The &#39;String&#39; is the</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">--   message describing the error, if any.</span></span><span class="mpre">
              | </span><a name="loc_42_17_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_24&#39;)"><span class="hl_condecl"><span class="mpre">Partial</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_39_6_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_6_39_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
              </span><span class="hl_comment"><span class="mpre">-- ^ Supply this continuation with more input so that</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">--   the parser can resume. To indicate that no more</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">--   input is available, use an &#39;B.empty&#39; string.</span></span><span class="mpre">
              | </span><a name="loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_condecl"><span class="mpre">Done</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Position</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- ^ The parse succeeded.  The &#39;B.ByteString&#39; is the</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">--   input that had not yet been consumed (if any) when</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">--   the parse succeeded.</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 10, srcSpanEndLine = 51, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 17, srcSpanEndLine = 51, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-enc"><span class="mpre">Show r =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> (</span><a href="#loc_39_6_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_6_39_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) where
    </span><a name="loc_52_5_52_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_5_52_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> (</span><a href="#loc_39_17_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a name="loc_52_16_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_19&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre">)  = </span><span class="hl_string"><span class="mpre">&quot;Fail &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_52_16_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_19&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
    </span><a href="#loc_52_5_52_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_5_52_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_24&#39;)"><span class="hl_conref"><span class="mpre">Partial</span></span></a><span class="mpre"> _) = </span><span class="hl_string"><span class="mpre">&quot;Partial _&quot;</span></span><span class="mpre">
    </span><a href="#loc_52_5_52_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_5_52_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> (</span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> </span><a name="loc_54_16_54_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_16_54_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_54_18_54_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_18_54_21&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a name="loc_54_22_54_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_22_54_24&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = </span><span class="hl_string"><span class="mpre">&quot;Done &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_54_16_54_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_16_54_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_54_18_54_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_18_54_21&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_54_22_54_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_22_54_24&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_39_6_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_6_39_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> where
    </span><a name="loc_57_5_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> _ (</span><a href="#loc_39_17_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a name="loc_57_18_57_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_21&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre">)  = </span><a href="#loc_39_17_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a href="#loc_57_18_57_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_21&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
    </span><a href="#loc_57_5_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_58_10_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_24&#39;)"><span class="hl_conref"><span class="mpre">Partial</span></span></a><span class="mpre"> </span><a name="loc_58_21_58_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_21_58_22&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">) = </span><a href="#loc_42_17_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_24&#39;)"><span class="hl_conref"><span class="mpre">Partial</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_58_10_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_58_21_58_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_21_58_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
    </span><a href="#loc_57_5_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> </span><a name="loc_59_18_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_18_59_19&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_59_20_59_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_20_59_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_59_22_59_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_22_59_24&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = </span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> (</span><a href="#loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_59_18_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_18_59_19&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">) </span><a href="#loc_59_20_59_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_20_59_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_59_22_59_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_22_59_24&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 1, srcSpanEndLine = 61, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 1, srcSpanEndLine = 61, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanSt"><span class="mpre">type Input  = B.ByteString</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 1, srcSpanEndLine = 62, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 1, srcSpanEndLine = 62, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanSt"><span class="mpre">type Buffer = Maybe B.ByteString</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 1, srcSpanEndLine = 64, srcSpanEndColumn = 77}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 1, srcSpanEndLine = 64, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanSt"><span class="mpre">type Failure   r = Input -&gt; Buffer -&gt; More -&gt; Position -&gt; String -&gt; Result r</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 1, srcSpanEndLine = 65, srcSpanEndColumn = 77}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 1, srcSpanEndLine = 65, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanSt"><span class="mpre">type Success a r = Input -&gt; Buffer -&gt; More -&gt; Position -&gt; a      -&gt; Result r</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 1, srcSpanEndLine = 66, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 1, srcSpanEndLine = 66, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanSt"><span class="mpre">type Position    = Word64</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Have we read all available input?</span></span><span class="mpre">
data </span><a name="loc_69_6_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_6_69_10&#39;)"><span class="hl_tycondecl"><span class="mpre">More</span></span></a><span class="mpre"> = </span><a name="loc_69_13_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_13_69_21&#39;)"><span class="hl_condecl"><span class="mpre">Complete</span></span></a><span class="mpre">
          | </span><a name="loc_70_13_70_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_13_70_23&#39;)"><span class="hl_condecl"><span class="mpre">Incomplete</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
          </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 11, srcSpanEndLine = 71, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 11, srcSpanEndLine = 71, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Get.hs&quot;, srcSpa"><span class="mpre">deriving (Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The Get monad is an Exception and State monad.</span></span><span class="mpre">
newtype </span><a name="loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_condecl"><span class="mpre">Get</span></span></a><span class="mpre">
        { </span><a name="loc_75_11_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_16&#39;)"><span class="hl_fielddecl"><span class="mpre">unGet</span></span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">. </span><span class="hl_tyconref"><span class="mpre">Input</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre"> -&gt; </span><a href="#loc_69_6_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_6_69_10&#39;)"><span class="hl_tyconref"><span class="mpre">More</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Position</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Failure</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Success</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><a href="#loc_39_6_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_6_39_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> }

</span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="mpre">append</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre">
</span><a name="loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_fundecl"><span class="mpre">append</span></span></a><span class="mpre"> </span><a name="loc_78_8_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_78_10_78_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_10_78_11&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.append</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_78_8_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_78_10_78_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_10_78_11&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="mpre">append</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_82_1_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_12&#39;)"><span class="mpre">bufferBytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_82_1_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_12&#39;)"><span class="hl_vardecl"><span class="mpre">bufferBytes</span></span></a><span class="mpre">  = </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_82_1_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_12&#39;)"><span class="mpre">bufferBytes</span></a><span class="mpre"> #-}</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_86_10_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_10_86_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_86_12_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> =
      </span><a href="#loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_87_14_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_87_17_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_19&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a name="loc_87_20_87_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_20_87_22&#39;)"><span class="hl_vardecl"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a name="loc_87_23_87_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_23_87_25&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a name="loc_87_26_87_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_26_87_28&#39;)"><span class="hl_vardecl"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a name="loc_87_29_87_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_29_87_31&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre"> -&gt;
        let </span><a name="loc_88_13_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_16&#39;)"><span class="hl_fundecl"><span class="mpre">ks&#39;</span></span></a><span class="mpre"> </span><a name="loc_88_17_88_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_17_88_19&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> </span><a name="loc_88_20_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_20_88_22&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a name="loc_88_23_88_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_23_88_25&#39;)"><span class="hl_vardecl"><span class="mpre">m1</span></span></a><span class="mpre"> </span><a name="loc_88_26_88_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_26_88_28&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a name="loc_88_29_88_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_29_88_30&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_87_29_87_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_29_87_31&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre"> </span><a href="#loc_88_17_88_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_17_88_19&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> </span><a href="#loc_88_20_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_20_88_22&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a href="#loc_88_23_88_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_23_88_25&#39;)"><span class="hl_varref"><span class="mpre">m1</span></span></a><span class="mpre"> </span><a href="#loc_88_26_88_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_26_88_28&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> (</span><a href="#loc_86_10_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_10_86_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_88_29_88_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_29_88_30&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
         in </span><a href="#loc_75_11_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_16&#39;)"><span class="hl_varref"><span class="mpre">unGet</span></span></a><span class="mpre"> </span><a href="#loc_86_12_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_87_14_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_16&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_87_17_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_19&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_87_20_87_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_20_87_22&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_87_23_87_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_23_87_25&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a href="#loc_87_26_87_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_26_87_28&#39;)"><span class="hl_varref"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a href="#loc_88_13_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_16&#39;)"><span class="hl_varref"><span class="mpre">ks&#39;</span></span></a><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> where
    </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
    </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="hl_classref"><span class="mpre">Alternative</span></span></a><span class="mpre"> </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> where
    </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><a href="#loc_170_1_170_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_9&#39;)"><span class="hl_varref"><span class="mpre">failDesc</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;empty&quot;</span></span><span class="mpre">
    </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;|&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_varref"><span class="mpre">mplus</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Definition directly from Control.Monad.State.Strict</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_101_24_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_24_101_26&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_101_27_101_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_29&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a name="loc_101_30_101_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_30_101_32&#39;)"><span class="hl_vardecl"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a name="loc_101_33_101_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_33_101_35&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> _ </span><a name="loc_101_38_101_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_38_101_40&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_101_38_101_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_38_101_40&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre"> </span><a href="#loc_101_24_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_24_101_26&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_101_27_101_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_29&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_101_30_101_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_30_101_32&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_101_33_101_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_33_101_35&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a href="#loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

    </span><a name="loc_103_5_103_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_103_11_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_12&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">  = </span><a href="#loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_103_23_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_25&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_103_26_103_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_28&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a name="loc_103_29_103_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_29_103_31&#39;)"><span class="hl_vardecl"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a name="loc_103_32_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_32_103_34&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a name="loc_103_35_103_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_35_103_37&#39;)"><span class="hl_vardecl"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a name="loc_103_38_103_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_38_103_40&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre"> -&gt;
        let </span><a name="loc_104_13_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_16&#39;)"><span class="hl_fundecl"><span class="mpre">ks&#39;</span></span></a><span class="mpre"> </span><a name="loc_104_17_104_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_19&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> </span><a name="loc_104_20_104_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_22&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a name="loc_104_23_104_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_23_104_25&#39;)"><span class="hl_vardecl"><span class="mpre">m1</span></span></a><span class="mpre"> </span><a name="loc_104_26_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_26_104_28&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a name="loc_104_29_104_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_29_104_30&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_75_11_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_16&#39;)"><span class="hl_varref"><span class="mpre">unGet</span></span></a><span class="mpre"> (</span><a href="#loc_103_11_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_12&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_104_29_104_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_29_104_30&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_104_17_104_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_19&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> </span><a href="#loc_104_20_104_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_22&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a href="#loc_104_23_104_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_23_104_25&#39;)"><span class="hl_varref"><span class="mpre">m1</span></span></a><span class="mpre"> </span><a href="#loc_104_26_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_26_104_28&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a href="#loc_103_35_103_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_35_103_37&#39;)"><span class="hl_varref"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a href="#loc_103_38_103_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_38_103_40&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre">
         in </span><a href="#loc_75_11_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_16&#39;)"><span class="hl_varref"><span class="mpre">unGet</span></span></a><span class="mpre"> </span><a href="#loc_103_5_103_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_103_23_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_25&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_103_26_103_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_28&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_103_29_103_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_29_103_31&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_103_32_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_32_103_34&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a href="#loc_103_35_103_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_35_103_37&#39;)"><span class="hl_varref"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a href="#loc_104_13_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_16&#39;)"><span class="hl_varref"><span class="mpre">ks&#39;</span></span></a><span class="mpre">

    </span><span class="hl_vardecl"><span class="mpre">fail</span></span><span class="mpre">     = </span><a href="#loc_170_1_170_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_9&#39;)"><span class="hl_varref"><span class="mpre">failDesc</span></span></a><span class="mpre">

instance </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="hl_classref"><span class="mpre">MonadPlus</span></span></a><span class="mpre"> </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> where
    </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">mzero</span></span></a><span class="mpre">     = </span><a href="#loc_170_1_170_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_9&#39;)"><span class="hl_varref"><span class="mpre">failDesc</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mzero&quot;</span></span><span class="mpre">
    </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">mplus</span></span></a><span class="mpre"> </span><a name="loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_111_13_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_13_111_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> =
      </span><a href="#loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_112_14_112_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_14_112_16&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_112_17_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_17_112_19&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a name="loc_112_20_112_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_22&#39;)"><span class="hl_vardecl"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a name="loc_112_23_112_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_23_112_25&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a name="loc_112_26_112_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_26_112_28&#39;)"><span class="hl_vardecl"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a name="loc_112_29_112_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_29_112_31&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre"> -&gt;
        let </span><a name="loc_113_13_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_16&#39;)"><span class="hl_fundecl"><span class="mpre">kf&#39;</span></span></a><span class="mpre"> _ </span><a name="loc_113_19_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_19_113_21&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a name="loc_113_22_113_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_22_113_24&#39;)"><span class="hl_vardecl"><span class="mpre">m1</span></span></a><span class="mpre"> </span><a name="loc_113_25_113_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_25_113_27&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre"> _ = </span><a href="#loc_75_11_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_16&#39;)"><span class="hl_varref"><span class="mpre">unGet</span></span></a><span class="mpre"> </span><a href="#loc_111_13_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_13_111_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="#loc_112_14_112_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_14_112_16&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> </span><a href="#loc_82_1_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_12&#39;)"><span class="hl_varref"><span class="mpre">bufferBytes</span></span></a><span class="mpre"> </span><a href="#loc_113_19_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_19_113_21&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">)
                                       (</span><a href="#loc_112_17_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_17_112_19&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_infix"><span class="mpre">`append`</span></span></a><span class="mpre"> </span><a href="#loc_113_19_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_19_113_21&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">) </span><a href="#loc_113_22_113_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_22_113_24&#39;)"><span class="hl_varref"><span class="mpre">m1</span></span></a><span class="mpre"> </span><a href="#loc_113_25_113_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_25_113_27&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a href="#loc_112_26_112_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_26_112_28&#39;)"><span class="hl_varref"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a href="#loc_112_29_112_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_29_112_31&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre">
         in </span><a href="#loc_75_11_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_16&#39;)"><span class="hl_varref"><span class="mpre">unGet</span></span></a><span class="mpre"> </span><a href="#loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_112_14_112_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_14_112_16&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">) </span><a href="#loc_112_20_112_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_22&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_112_23_112_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_23_112_25&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a href="#loc_113_13_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_16&#39;)"><span class="hl_varref"><span class="mpre">kf&#39;</span></span></a><span class="mpre"> </span><a href="#loc_112_29_112_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_29_112_31&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_120_1_120_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_4&#39;)"><span class="mpre">put</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Position</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_120_1_120_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_4&#39;)"><span class="hl_fundecl"><span class="mpre">put</span></span></a><span class="mpre"> </span><a name="loc_120_5_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a name="loc_120_9_120_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> (\_ </span><a name="loc_120_21_120_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_23&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a name="loc_120_24_120_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_24_120_25&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_120_26_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_26_120_28&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> _ </span><a name="loc_120_31_120_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_31_120_32&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_120_31_120_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_31_120_32&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_120_9_120_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_120_21_120_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_23&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_120_24_120_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_24_120_25&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_120_26_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_26_120_28&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_120_1_120_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_4&#39;)"><span class="mpre">put</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_124_1_124_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_7&#39;)"><span class="mpre">finalK</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">t1</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Position</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><a href="#loc_39_6_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_6_39_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_124_1_124_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_7&#39;)"><span class="hl_fundecl"><span class="mpre">finalK</span></span></a><span class="mpre"> </span><a name="loc_124_8_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_8_124_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> _ _ </span><a name="loc_124_14_124_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_14_124_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_124_16_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_16_124_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> </span><a href="#loc_124_16_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_16_124_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_124_14_124_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_14_124_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_124_8_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_8_124_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_127_1_127_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_6&#39;)"><span class="mpre">failK</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Failure</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_127_1_127_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_6&#39;)"><span class="hl_fundecl"><span class="mpre">failK</span></span></a><span class="mpre"> _ _ _ </span><a name="loc_127_13_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_13_127_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_127_15_127_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_39_17_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_127_13_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_13_127_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_127_15_127_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Run the Get monad applies a &#39;get&#39;-based parser on the input ByteString</span></span><span class="mpre">
</span><a href="#loc_131_1_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_10&#39;)"><span class="mpre">runGetPos</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Position</span></span><span class="mpre"> -&gt; </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_39_6_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_6_39_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_131_1_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_10&#39;)"><span class="hl_fundecl"><span class="mpre">runGetPos</span></span></a><span class="mpre"> </span><a name="loc_131_11_131_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_14&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a name="loc_131_15_131_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_16&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_131_17_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_17_131_20&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="#loc_75_11_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_16&#39;)"><span class="hl_varref"><span class="mpre">unGet</span></span></a><span class="mpre"> </span><a href="#loc_131_15_131_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_16&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_131_17_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_17_131_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (</span><a href="#loc_70_13_70_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_13_70_23&#39;)"><span class="hl_conref"><span class="mpre">Incomplete</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><a href="#loc_131_11_131_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_14&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_127_1_127_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_6&#39;)"><span class="hl_varref"><span class="mpre">failK</span></span></a><span class="mpre"> </span><a href="#loc_124_1_124_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_7&#39;)"><span class="hl_varref"><span class="mpre">finalK</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_131_1_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_10&#39;)"><span class="mpre">runGetPos</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_135_1_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_7&#39;)"><span class="mpre">runGet</span></a><span class="mpre"> :: </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_39_6_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_6_39_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_135_1_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_7&#39;)"><span class="hl_vardecl"><span class="mpre">runGet</span></span></a><span class="mpre"> = </span><a href="#loc_131_1_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_10&#39;)"><span class="hl_varref"><span class="mpre">runGetPos</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_135_1_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_7&#39;)"><span class="mpre">runGet</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | If at least @n@ bytes of input are available, return the current</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   input, otherwise fail.</span></span><span class="mpre">
</span><a href="#loc_141_1_141_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_7&#39;)"><span class="mpre">ensure</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_141_1_141_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_7&#39;)"><span class="hl_fundecl"><span class="mpre">ensure</span></span></a><span class="mpre"> </span><a name="loc_141_8_141_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_141_8_141_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="#loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_141_28_141_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_28_141_30&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_141_31_141_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_31_141_33&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a name="loc_141_34_141_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_34_141_36&#39;)"><span class="hl_vardecl"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a name="loc_141_37_141_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_37_141_39&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a name="loc_141_40_141_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_40_141_42&#39;)"><span class="hl_vardecl"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a name="loc_141_43_141_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_43_141_45&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre"> -&gt;
    if </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_141_28_141_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_28_141_30&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_141_8_141_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    then </span><a href="#loc_141_43_141_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_43_141_45&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre"> </span><a href="#loc_141_28_141_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_28_141_30&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_141_31_141_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_31_141_33&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_141_34_141_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_34_141_36&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_141_37_141_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_37_141_39&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a href="#loc_141_28_141_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_28_141_30&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre">
    else </span><a href="#loc_75_11_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_16&#39;)"><span class="hl_varref"><span class="mpre">unGet</span></span></a><span class="mpre"> (</span><a href="#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_12&#39;)"><span class="hl_varref"><span class="mpre">demandInput</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="hl_varref"><span class="mpre">ensureRec</span></span></a><span class="mpre"> </span><a href="#loc_141_8_141_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_141_28_141_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_28_141_30&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_141_31_141_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_31_141_33&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_141_34_141_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_34_141_36&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_141_37_141_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_37_141_39&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a href="#loc_141_40_141_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_40_141_42&#39;)"><span class="hl_varref"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a href="#loc_141_43_141_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_43_141_45&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_141_1_141_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_7&#39;)"><span class="mpre">ensure</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | If at least @n@ bytes of input are available, return the current</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   input, otherwise fail.</span></span><span class="mpre">
</span><a href="#loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="mpre">ensureRec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="hl_fundecl"><span class="mpre">ensureRec</span></span></a><span class="mpre"> </span><a name="loc_150_11_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_150_22_150_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_22_150_24&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_150_25_150_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_25_150_27&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a name="loc_150_28_150_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_28_150_30&#39;)"><span class="hl_vardecl"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a name="loc_150_31_150_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_31_150_33&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a name="loc_150_34_150_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_34_150_36&#39;)"><span class="hl_vardecl"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a name="loc_150_37_150_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_37_150_39&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre"> -&gt;
    if </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_150_22_150_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_22_150_24&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_150_11_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    then </span><a href="#loc_150_37_150_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_37_150_39&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre"> </span><a href="#loc_150_22_150_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_22_150_24&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_150_25_150_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_25_150_27&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_150_28_150_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_28_150_30&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_150_31_150_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_31_150_33&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a href="#loc_150_22_150_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_22_150_24&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre">
    else </span><a href="#loc_75_11_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_16&#39;)"><span class="hl_varref"><span class="mpre">unGet</span></span></a><span class="mpre"> (</span><a href="#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_12&#39;)"><span class="hl_varref"><span class="mpre">demandInput</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="hl_varref"><span class="mpre">ensureRec</span></span></a><span class="mpre"> </span><a href="#loc_150_11_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_150_22_150_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_22_150_24&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_150_25_150_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_25_150_27&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_150_28_150_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_28_150_30&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_150_31_150_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_31_150_33&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a href="#loc_150_34_150_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_34_150_36&#39;)"><span class="hl_varref"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a href="#loc_150_37_150_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_37_150_39&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Immediately demand more input via a &#39;Partial&#39; continuation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   result.</span></span><span class="mpre">
</span><a href="#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_12&#39;)"><span class="mpre">demandInput</span></a><span class="mpre"> :: </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_158_1_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_12&#39;)"><span class="hl_vardecl"><span class="mpre">demandInput</span></span></a><span class="mpre"> = </span><a href="#loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_158_22_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_22_158_24&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_158_25_158_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_25_158_27&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a name="loc_158_28_158_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_28_158_30&#39;)"><span class="hl_vardecl"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a name="loc_158_31_158_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_31_158_33&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a name="loc_158_34_158_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_34_158_36&#39;)"><span class="hl_vardecl"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a name="loc_158_37_158_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_37_158_39&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre"> -&gt;
  case </span><a href="#loc_158_28_158_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_28_158_30&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> of
    </span><a href="#loc_69_13_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_13_69_21&#39;)"><span class="hl_conref"><span class="mpre">Complete</span></span></a><span class="mpre">      -&gt; </span><a href="#loc_158_34_158_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_34_158_36&#39;)"><span class="hl_varref"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a href="#loc_158_22_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_22_158_24&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_158_25_158_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_25_158_27&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_158_28_158_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_28_158_30&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_158_31_158_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_31_158_33&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;too few bytes&quot;</span></span><span class="mpre">
    </span><a href="#loc_70_13_70_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_13_70_23&#39;)"><span class="hl_conref"><span class="mpre">Incomplete</span></span></a><span class="mpre"> </span><a name="loc_161_16_161_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_16_161_18&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_42_17_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_24&#39;)"><span class="hl_conref"><span class="mpre">Partial</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_161_33_161_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_33_161_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
      if </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_161_33_161_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_33_161_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
      then </span><a href="#loc_158_34_158_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_34_158_36&#39;)"><span class="hl_varref"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a href="#loc_158_22_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_22_158_24&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_158_25_158_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_25_158_27&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_158_28_158_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_28_158_30&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_158_31_158_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_31_158_33&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;too few bytes&quot;</span></span><span class="mpre">
      else let </span><a name="loc_164_16_164_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_16_164_22&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> </span><a name="loc_164_23_164_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_23_164_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_164_23_164_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_23_164_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_161_33_161_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_33_161_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
               </span><a name="loc_165_16_165_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_16_165_18&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> = </span><a href="#loc_158_22_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_22_158_24&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> </span><a href="#loc_161_33_161_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_33_161_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
               </span><a name="loc_166_16_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_16_166_18&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> = </span><a href="#loc_158_25_158_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_25_158_27&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_infix"><span class="mpre">`append`</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_161_33_161_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_33_161_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
            in </span><a href="#loc_158_37_158_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_37_158_39&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre"> </span><a href="#loc_165_16_165_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_16_165_18&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> </span><a href="#loc_166_16_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_16_166_18&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> (</span><a href="#loc_70_13_70_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_13_70_23&#39;)"><span class="hl_conref"><span class="mpre">Incomplete</span></span></a><span class="mpre"> (</span><a href="#loc_164_16_164_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_16_164_22&#39;)"><span class="hl_varref"><span class="mpre">update</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_161_16_161_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_16_161_18&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">)) </span><a href="#loc_158_31_158_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_31_158_33&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_170_1_170_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_9&#39;)"><span class="mpre">failDesc</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_170_1_170_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_9&#39;)"><span class="hl_fundecl"><span class="mpre">failDesc</span></span></a><span class="mpre"> </span><a name="loc_170_10_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_13&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> = </span><a href="#loc_74_17_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_20&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> (\</span><a name="loc_170_22_170_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_22_170_24&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_170_25_170_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_25_170_27&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a name="loc_170_28_170_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_28_170_30&#39;)"><span class="hl_vardecl"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a name="loc_170_31_170_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_31_170_33&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a name="loc_170_34_170_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_34_170_36&#39;)"><span class="hl_vardecl"><span class="mpre">kf</span></span></a><span class="mpre"> _ -&gt; </span><a href="#loc_170_34_170_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_34_170_36&#39;)"><span class="hl_varref"><span class="mpre">kf</span></span></a><span class="mpre"> </span><a href="#loc_170_22_170_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_22_170_24&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_170_25_170_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_25_170_27&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="#loc_170_28_170_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_28_170_30&#39;)"><span class="hl_varref"><span class="mpre">m0</span></span></a><span class="mpre"> </span><a href="#loc_170_31_170_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_31_170_33&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Failed reading: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_170_10_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_13&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Utility with ByteStrings</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | An efficient &#39;get&#39; method for strict ByteStrings. Fails if fewer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- than @n@ bytes are left in the input. This function creates a fresh</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- copy of the underlying bytes.</span></span><span class="mpre">
</span><a href="#loc_179_1_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_13&#39;)"><span class="mpre">getBytesCopy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_179_1_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_13&#39;)"><span class="hl_fundecl"><span class="mpre">getBytesCopy</span></span></a><span class="mpre"> </span><a name="loc_179_14_179_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_14_179_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = do
  </span><a name="loc_180_3_180_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_3_180_5&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_188_1_188_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre"> </span><a href="#loc_179_14_179_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_14_179_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.copy</span></span><span class="mpre"> </span><a href="#loc_180_3_180_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_3_180_5&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Helpers</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Pull @n@ bytes from the input, as a strict ByteString.</span></span><span class="mpre">
</span><a href="#loc_188_1_188_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_9&#39;)"><span class="mpre">getBytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_188_1_188_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_9&#39;)"><span class="hl_fundecl"><span class="mpre">getBytes</span></span></a><span class="mpre"> </span><a name="loc_188_10_188_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_10_188_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = do
     </span><a name="loc_189_6_189_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_141_1_141_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_7&#39;)"><span class="hl_varref"><span class="mpre">ensure</span></span></a><span class="mpre"> </span><a href="#loc_188_10_188_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_10_188_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
     </span><a href="#loc_120_1_120_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_4&#39;)"><span class="hl_varref"><span class="mpre">put</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_188_10_188_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_10_188_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_148_1_148_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_148_1_148_11&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeDrop</span></span></a><span class="mpre"> </span><a href="#loc_188_10_188_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_10_188_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_189_6_189_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_142_1_142_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_142_1_142_11&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeTake</span></span></a><span class="mpre"> </span><a href="#loc_188_10_188_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_10_188_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_189_6_189_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_194_1_194_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_9&#39;)"><span class="mpre">getWord8</span></a><span class="mpre"> :: </span><a href="#loc_74_9_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
</span><a name="loc_194_1_194_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_9&#39;)"><span class="hl_vardecl"><span class="mpre">getWord8</span></span></a><span class="mpre"> = do
     </span><a name="loc_195_6_195_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_6_195_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_141_1_141_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_7&#39;)"><span class="hl_varref"><span class="mpre">ensure</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
     </span><a href="#loc_120_1_120_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_4&#39;)"><span class="hl_varref"><span class="mpre">put</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_112_1_112_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_112_1_112_11&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeTail</span></span></a><span class="mpre"> </span><a href="#loc_195_6_195_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_6_195_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeHead</span></span></a><span class="mpre"> </span><a href="#loc_195_6_195_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_6_195_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span></div></body></html>