<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module CookieTest (cookieTest) where

import Prelude hiding (exp)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 4, srcSpanStartColumn = 8, srcSpanEndLine = 4, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 5, srcSpanStartColumn = 18, srcSpanEndLine = 5, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as BS
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 6, srcSpanStartColumn = 8, srcSpanEndLine = 6, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre"> hiding (path)
import Network.HTTP.Client
import qualified Network.HTTP.Conduit as HC
import Data.ByteString.UTF8
import Data.Monoid
import Data.Maybe
import Data.Time.Clock
import Data.Time.Calendar
import qualified Data.CaseInsensitive as CI
import Web.Cookie

</span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="mpre">default_request</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">HC.Request</span></span></a><span class="mpre">
</span><a name="loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_vardecl"><span class="mpre">default_request</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">HC.parseUrl</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;http://www.google.com/&quot;</span></span><span class="mpre">

</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="mpre">default_cookie</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_115_6_115_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_115_6_115_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">
</span><a name="loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_vardecl"><span class="mpre">default_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 18, srcSpanEndLine = 32, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 25, srcSpanEndLine = 21, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanS"><span class="mpre">Cookie { cookie_name = fromString &quot;name&quot;
                        , cookie_value = fromString &quot;value&quot;
                        , cookie_expiry_time = default_time
                        , cookie_domain = fromString &quot;www.google.com&quot;
                        , cookie_path = fromString &quot;/&quot;
                        , cookie_creation_time = default_time
                        , cookie_last_access_time = default_time
                        , cookie_persistent = False
                        , cookie_host_only = False
                        , cookie_secure_only = False
                        , cookie_http_only = False
                        }</span></span><span class="mpre">

</span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="mpre">default_time</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
</span><a name="loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_vardecl"><span class="mpre">default_time</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">56200</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

</span><a href="#loc_38_1_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_18&#39;)"><span class="mpre">default_diff_time</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.Scale.html#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre">
</span><a name="loc_38_1_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_18&#39;)"><span class="hl_vardecl"><span class="mpre">default_diff_time</span></span></a><span class="mpre"> = </span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1209600</span></span><span class="mpre">

</span><a href="#loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="mpre">default_set_cookie</span></a><span class="mpre"> :: </span><a href="Web.Cookie.html#loc_97_6_97_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_97_6_97_15&#39;)"><span class="hl_tyconref"><span class="mpre">SetCookie</span></span></a><span class="mpre">
</span><a name="loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="hl_vardecl"><span class="mpre">default_set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 22, srcSpanEndLine = 49, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 32, srcSpanEndLine = 41, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanS"><span class="mpre">def       { setCookieName = fromString &quot;name&quot;
                               , setCookieValue = fromString &quot;value&quot;
                               , setCookiePath = Just $ fromString &quot;/&quot;
                               , setCookieExpires = Just default_time
                               , setCookieMaxAge = Just default_diff_time
                               , setCookieDomain = Just $ fromString &quot;www.google.com&quot;
                               , setCookieHttpOnly = False
                               , setCookieSecure = False
                               }</span></span><span class="mpre">

</span><a href="#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="mpre">testValidIp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="hl_vardecl"><span class="mpre">testValidIp</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Couldn&#39;t parse valid IP address&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="Network.HTTP.Client.Cookies.html#loc_41_1_41_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_41_1_41_12&#39;)"><span class="hl_varref"><span class="mpre">isIpAddress</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;1.2.3.4&quot;</span></span><span class="mpre">

</span><a href="#loc_56_1_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_17&#39;)"><span class="mpre">testIpNumTooHigh</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_56_1_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_17&#39;)"><span class="hl_vardecl"><span class="mpre">testIpNumTooHigh</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;One of the digits in the IP address is too large&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_41_1_41_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_41_1_41_12&#39;)"><span class="hl_varref"><span class="mpre">isIpAddress</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;501.2.3.4&quot;</span></span><span class="mpre">

</span><a href="#loc_60_1_60_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_24&#39;)"><span class="mpre">testTooManySegmentsInIp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_60_1_60_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_24&#39;)"><span class="hl_vardecl"><span class="mpre">testTooManySegmentsInIp</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Too many segments in the ip address&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_41_1_41_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_41_1_41_12&#39;)"><span class="hl_varref"><span class="mpre">isIpAddress</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;1.2.3.4.5&quot;</span></span><span class="mpre">

</span><a href="#loc_64_1_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_14&#39;)"><span class="mpre">testCharsInIp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_64_1_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_14&#39;)"><span class="hl_vardecl"><span class="mpre">testCharsInIp</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Chars are not allowed in IP addresses&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_41_1_41_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_41_1_41_12&#39;)"><span class="hl_varref"><span class="mpre">isIpAddress</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;1.2a3.4.5&quot;</span></span><span class="mpre">

</span><a href="#loc_68_1_68_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_25&#39;)"><span class="mpre">testDomainMatchesSuccess</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_68_1_68_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_25&#39;)"><span class="hl_vardecl"><span class="mpre">testDomainMatchesSuccess</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Domains should match&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="Network.HTTP.Client.Cookies.html#loc_56_1_56_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_56_1_56_14&#39;)"><span class="hl_varref"><span class="mpre">domainMatches</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;www.google.com&quot;</span></span><span class="mpre">) (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;google.com&quot;</span></span><span class="mpre">)

</span><a href="#loc_72_1_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_15&#39;)"><span class="mpre">testSameDomain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_72_1_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_15&#39;)"><span class="hl_vardecl"><span class="mpre">testSameDomain</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Same domain should match&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="Network.HTTP.Client.Cookies.html#loc_56_1_56_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_56_1_56_14&#39;)"><span class="hl_varref"><span class="mpre">domainMatches</span></span></a><span class="mpre"> </span><a href="#loc_74_9_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_15&#39;)"><span class="hl_varref"><span class="mpre">domain</span></span></a><span class="mpre"> </span><a href="#loc_74_9_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_15&#39;)"><span class="hl_varref"><span class="mpre">domain</span></span></a><span class="mpre">
  where </span><a name="loc_74_9_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_15&#39;)"><span class="hl_vardecl"><span class="mpre">domain</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;www.google.com&quot;</span></span><span class="mpre">

</span><a href="#loc_77_1_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_18&#39;)"><span class="mpre">testSiblingDomain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_77_1_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_18&#39;)"><span class="hl_vardecl"><span class="mpre">testSiblingDomain</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Sibling domain should not match&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_56_1_56_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_56_1_56_14&#39;)"><span class="hl_varref"><span class="mpre">domainMatches</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;www.google.com&quot;</span></span><span class="mpre">) (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;secure.google.com&quot;</span></span><span class="mpre">)

</span><a href="#loc_81_1_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_17&#39;)"><span class="mpre">testParentDomain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_81_1_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_17&#39;)"><span class="hl_vardecl"><span class="mpre">testParentDomain</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Parent domain should fail&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_56_1_56_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_56_1_56_14&#39;)"><span class="hl_varref"><span class="mpre">domainMatches</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;google.com&quot;</span></span><span class="mpre">) (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;www.google.com&quot;</span></span><span class="mpre">)

</span><a href="#loc_85_1_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_22&#39;)"><span class="mpre">testNaiveSuffixDomain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_85_1_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_22&#39;)"><span class="hl_vardecl"><span class="mpre">testNaiveSuffixDomain</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Naively checking for suffix for domain matching should fail&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_56_1_56_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_56_1_56_14&#39;)"><span class="hl_varref"><span class="mpre">domainMatches</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;agoogle.com&quot;</span></span><span class="mpre">) (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;google.com&quot;</span></span><span class="mpre">)

</span><a href="#loc_89_1_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_16&#39;)"><span class="mpre">testDefaultPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_89_1_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_16&#39;)"><span class="hl_vardecl"><span class="mpre">testDefaultPath</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Getting default path from a request&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_66_1_66_12&#39;)"><span class="hl_varref"><span class="mpre">defaultPath</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre">)

</span><a href="#loc_93_1_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_21&#39;)"><span class="mpre">testShortDefaultPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_93_1_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_21&#39;)"><span class="hl_vardecl"><span class="mpre">testShortDefaultPath</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Getting default path from a short path&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_66_1_66_12&#39;)"><span class="hl_varref"><span class="mpre">defaultPath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 35, srcSpanEndLine = 94, srcSpanEndColumn = 83}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 51, srcSpanEndLine = 94, srcSpanEndColumn = 52},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanS"><span class="mpre">default_request {HC.path = fromString &quot;/search&quot;}</span></span><span class="mpre">)

</span><a href="#loc_97_1_97_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_25&#39;)"><span class="mpre">testPopulatedDefaultPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_97_1_97_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_25&#39;)"><span class="hl_vardecl"><span class="mpre">testPopulatedDefaultPath</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Getting default path from a request with a path&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/search&quot;</span></span><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_66_1_66_12&#39;)"><span class="hl_varref"><span class="mpre">defaultPath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 41, srcSpanEndLine = 98, srcSpanEndColumn = 94}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 57, srcSpanEndLine = 98, srcSpanEndColumn = 58},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanS"><span class="mpre">default_request {HC.path = fromString &quot;/search/term&quot;}</span></span><span class="mpre">)

</span><a href="#loc_101_1_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_22&#39;)"><span class="mpre">testParamsDefaultPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_101_1_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_22&#39;)"><span class="hl_vardecl"><span class="mpre">testParamsDefaultPath</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Getting default path from a request with a path and GET params&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/search&quot;</span></span><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_66_1_66_12&#39;)"><span class="hl_varref"><span class="mpre">defaultPath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 41, srcSpanEndLine = 102, srcSpanEndColumn = 102}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 57, srcSpanEndLine = 102, srcSpanEndColumn = 58},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, src"><span class="mpre">default_request {HC.path = fromString &quot;/search/term?var=val&quot;}</span></span><span class="mpre">)

</span><a href="#loc_105_1_105_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_29&#39;)"><span class="mpre">testDefaultPathEndingInSlash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_105_1_105_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_29&#39;)"><span class="hl_vardecl"><span class="mpre">testDefaultPathEndingInSlash</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Getting default path that ends in a slash&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/search/term&quot;</span></span><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_66_1_66_12&#39;)"><span class="hl_varref"><span class="mpre">defaultPath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 46, srcSpanEndLine = 106, srcSpanEndColumn = 100}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 62, srcSpanEndLine = 106, srcSpanEndColumn = 63},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, src"><span class="mpre">default_request {HC.path = fromString &quot;/search/term/&quot;}</span></span><span class="mpre">)

</span><a href="#loc_109_1_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_19&#39;)"><span class="mpre">testSamePathsMatch</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_109_1_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_19&#39;)"><span class="hl_vardecl"><span class="mpre">testSamePathsMatch</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;The same path should match&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="Network.HTTP.Client.Cookies.html#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_76_1_76_12&#39;)"><span class="hl_varref"><span class="mpre">pathMatches</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_14&#39;)"><span class="hl_varref"><span class="mpre">path&#39;</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_14&#39;)"><span class="hl_varref"><span class="mpre">path&#39;</span></span></a><span class="mpre">
  where </span><a name="loc_111_9_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_14&#39;)"><span class="hl_vardecl"><span class="mpre">path&#39;</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/a/path&quot;</span></span><span class="mpre">

</span><a href="#loc_114_1_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_19&#39;)"><span class="mpre">testPathSlashAtEnd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_114_1_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_19&#39;)"><span class="hl_vardecl"><span class="mpre">testPathSlashAtEnd</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Putting the slash at the end should still match paths&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="Network.HTTP.Client.Cookies.html#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_76_1_76_12&#39;)"><span class="hl_varref"><span class="mpre">pathMatches</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/a/path/to/here&quot;</span></span><span class="mpre">) (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/a/path/&quot;</span></span><span class="mpre">)

</span><a href="#loc_118_1_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_21&#39;)"><span class="mpre">testPathNoSlashAtEnd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_118_1_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_21&#39;)"><span class="hl_vardecl"><span class="mpre">testPathNoSlashAtEnd</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Not putting the slash at the end should still match paths&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="Network.HTTP.Client.Cookies.html#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_76_1_76_12&#39;)"><span class="hl_varref"><span class="mpre">pathMatches</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/a/path/to/here&quot;</span></span><span class="mpre">) (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/a/path&quot;</span></span><span class="mpre">)

</span><a href="#loc_122_1_122_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_19&#39;)"><span class="mpre">testDivergingPaths</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_122_1_122_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_19&#39;)"><span class="hl_vardecl"><span class="mpre">testDivergingPaths</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Diverging paths don&#39;t match&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_76_1_76_12&#39;)"><span class="hl_varref"><span class="mpre">pathMatches</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/a/path/to/here&quot;</span></span><span class="mpre">) (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/a/different/path&quot;</span></span><span class="mpre">)

</span><a href="#loc_126_1_126_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_26&#39;)"><span class="mpre">testCookieEqualitySuccess</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_126_1_126_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_26&#39;)"><span class="hl_vardecl"><span class="mpre">testCookieEqualitySuccess</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;The same cookies should be equal&quot;</span></span><span class="mpre">
  </span><a href="#loc_128_9_128_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_9_128_15&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><a href="#loc_128_9_128_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_9_128_15&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre">
  where </span><a name="loc_128_9_128_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_9_128_15&#39;)"><span class="hl_vardecl"><span class="mpre">cookie</span></span></a><span class="mpre"> = </span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">

</span><a href="#loc_131_1_131_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_29&#39;)"><span class="mpre">testCookieEqualityResiliance</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_131_1_131_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_29&#39;)"><span class="hl_vardecl"><span class="mpre">testCookieEqualityResiliance</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Cookies should still be equal if extra options are changed&quot;</span></span><span class="mpre">
  (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 4, srcSpanEndLine = 132, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 19, srcSpanEndLine = 132, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSp"><span class="mpre">default_cookie {cookie_persistent = True}</span></span><span class="mpre">) (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 48, srcSpanEndLine = 132, srcSpanEndColumn = 88}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 63, srcSpanEndLine = 132, srcSpanEndColumn = 64},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_host_only = True}</span></span><span class="mpre">)

</span><a href="#loc_135_1_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_26&#39;)"><span class="mpre">testDomainChangesEquality</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_135_1_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_26&#39;)"><span class="hl_vardecl"><span class="mpre">testDomainChangesEquality</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Changing the domain should make cookies not equal&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 136, srcSpanStartColumn = 22, srcSpanEndLine = 136, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 136, srcSpanStartColumn = 37, srcSpanEndLine = 136, srcSpanEndColumn = 38},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_domain = fromString &quot;/search&quot;}</span></span><span class="mpre">)

</span><a href="#loc_139_1_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_17&#39;)"><span class="mpre">testRemoveCookie</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_139_1_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_17&#39;)"><span class="hl_vardecl"><span class="mpre">testRemoveCookie</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Removing a cookie works&quot;</span></span><span class="mpre">
  (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []) (</span><a href="Network.HTTP.Client.Cookies.html#loc_97_1_97_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_97_1_97_34&#39;)"><span class="hl_varref"><span class="mpre">removeExistingCookieFromCookieJar</span></span></a><span class="mpre"> </span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">])

</span><a href="#loc_143_1_143_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_28&#39;)"><span class="mpre">testRemoveNonexistantCookie</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_143_1_143_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_28&#39;)"><span class="hl_vardecl"><span class="mpre">testRemoveNonexistantCookie</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Removing a nonexistant cookie doesn&#39;t work&quot;</span></span><span class="mpre">
  (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">]) (</span><a href="Network.HTTP.Client.Cookies.html#loc_97_1_97_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_97_1_97_34&#39;)"><span class="hl_varref"><span class="mpre">removeExistingCookieFromCookieJar</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 83, srcSpanEndLine = 144, srcSpanEndColumn = 131}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 98, srcSpanEndLine = 144, srcSpanEndColumn = 99},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, src"><span class="mpre">default_cookie {cookie_name = fromString &quot;key2&quot;}</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">])

</span><a href="#loc_147_1_147_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_24&#39;)"><span class="mpre">testRemoveCorrectCookie</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_147_1_147_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_24&#39;)"><span class="hl_vardecl"><span class="mpre">testRemoveCorrectCookie</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Removing only the correct cookie&quot;</span></span><span class="mpre">
  (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_149_9_149_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_19&#39;)"><span class="hl_varref"><span class="mpre">search_for</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_150_9_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_20&#39;)"><span class="hl_varref"><span class="mpre">red_herring</span></span></a><span class="mpre">]) (</span><a href="Network.HTTP.Client.Cookies.html#loc_97_1_97_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_97_1_97_34&#39;)"><span class="hl_varref"><span class="mpre">removeExistingCookieFromCookieJar</span></span></a><span class="mpre"> </span><a href="#loc_149_9_149_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_19&#39;)"><span class="hl_varref"><span class="mpre">search_for</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_150_9_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_20&#39;)"><span class="hl_varref"><span class="mpre">red_herring</span></span></a><span class="mpre">, </span><a href="#loc_149_9_149_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_19&#39;)"><span class="hl_varref"><span class="mpre">search_for</span></span></a><span class="mpre">])
  where </span><a name="loc_149_9_149_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_19&#39;)"><span class="hl_vardecl"><span class="mpre">search_for</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 149, srcSpanStartColumn = 22, srcSpanEndLine = 149, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 149, srcSpanStartColumn = 37, srcSpanEndLine = 149, srcSpanEndColumn = 38},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_name = fromString &quot;name1&quot;}</span></span><span class="mpre">
        </span><a name="loc_150_9_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_20&#39;)"><span class="hl_vardecl"><span class="mpre">red_herring</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 150, srcSpanStartColumn = 23, srcSpanEndLine = 150, srcSpanEndColumn = 72}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 150, srcSpanStartColumn = 38, srcSpanEndLine = 150, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_name = fromString &quot;name2&quot;}</span></span><span class="mpre">

</span><a href="#loc_153_1_153_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_24&#39;)"><span class="mpre">testEvictExpiredCookies</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_153_1_153_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_24&#39;)"><span class="hl_vardecl"><span class="mpre">testEvictExpiredCookies</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Evicting expired cookies works&quot;</span></span><span class="mpre">
  (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_155_9_155_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_161_9_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">]) (</span><a href="Network.HTTP.Client.Cookies.html#loc_116_1_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_116_1_116_20&#39;)"><span class="hl_varref"><span class="mpre">evictExpiredCookies</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_155_9_155_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_158_9_158_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_9_158_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_161_9_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="#loc_164_9_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_9_164_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">]) </span><a href="#loc_167_9_167_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_15&#39;)"><span class="hl_varref"><span class="mpre">middle</span></span></a><span class="mpre">)
  where </span><a name="loc_155_9_155_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 13, srcSpanEndLine = 157, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 28, srcSpanEndLine = 155, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;a&quot;
                           , cookie_expiry_time = UTCTime (ModifiedJulianDay 3) (secondsToDiffTime 0)
                           }</span></span><span class="mpre">
        </span><a name="loc_158_9_158_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_9_158_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 13, srcSpanEndLine = 160, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 28, srcSpanEndLine = 158, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;b&quot;
                           , cookie_expiry_time = UTCTime (ModifiedJulianDay 1) (secondsToDiffTime 0)
                           }</span></span><span class="mpre">
        </span><a name="loc_161_9_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 13, srcSpanEndLine = 163, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 28, srcSpanEndLine = 161, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;c&quot;
                           , cookie_expiry_time = UTCTime (ModifiedJulianDay 3) (secondsToDiffTime 0)
                           }</span></span><span class="mpre">
        </span><a name="loc_164_9_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_9_164_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 164, srcSpanStartColumn = 13, srcSpanEndLine = 166, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 164, srcSpanStartColumn = 28, srcSpanEndLine = 164, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;d&quot;
                           , cookie_expiry_time = UTCTime (ModifiedJulianDay 1) (secondsToDiffTime 0)
                           }</span></span><span class="mpre">
        </span><a name="loc_167_9_167_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_15&#39;)"><span class="hl_vardecl"><span class="mpre">middle</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

</span><a href="#loc_170_1_170_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_19&#39;)"><span class="mpre">testEvictNoCookies</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_170_1_170_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_19&#39;)"><span class="hl_vardecl"><span class="mpre">testEvictNoCookies</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Evicting empty cookie jar&quot;</span></span><span class="mpre">
  (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []) (</span><a href="Network.HTTP.Client.Cookies.html#loc_116_1_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_116_1_116_20&#39;)"><span class="hl_varref"><span class="mpre">evictExpiredCookies</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []) </span><a href="#loc_172_9_172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_9_172_15&#39;)"><span class="hl_varref"><span class="mpre">middle</span></span></a><span class="mpre">)
  where </span><a name="loc_172_9_172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_9_172_15&#39;)"><span class="hl_vardecl"><span class="mpre">middle</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

</span><a href="#loc_175_1_175_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_44&#39;)"><span class="mpre">testComputeCookieStringUpdateLastAccessTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_175_1_175_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_44&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringUpdateLastAccessTime</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Updates last access time upon using cookies&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;name=value&quot;</span></span><span class="mpre">, </span><a href="#loc_180_9_180_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_9_180_23&#39;)"><span class="hl_varref"><span class="mpre">out_cookie_jar</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_177_9_177_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_9_177_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_178_9_178_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_179_9_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_9_179_12&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
  where </span><a name="loc_177_9_177_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_9_177_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre">
        </span><a name="loc_178_9_178_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">]
        </span><a name="loc_179_9_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_9_179_12&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a name="loc_180_9_180_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_9_180_23&#39;)"><span class="hl_vardecl"><span class="mpre">out_cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 180, srcSpanStartColumn = 43, srcSpanEndLine = 180, srcSpanEndColumn = 89}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 180, srcSpanStartColumn = 58, srcSpanEndLine = 180, srcSpanEndColumn = 59},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_last_access_time = now}</span></span><span class="mpre">]

</span><a href="#loc_183_1_183_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_32&#39;)"><span class="mpre">testComputeCookieStringHostOnly</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_183_1_183_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_32&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringHostOnly</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Host only cookies should match host exactly&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;name=value&quot;</span></span><span class="mpre">, </span><a href="#loc_186_9_186_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_185_9_185_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_186_9_186_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
  where </span><a name="loc_185_9_185_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre">
        </span><a name="loc_186_9_186_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 39, srcSpanEndLine = 186, srcSpanEndColumn = 79}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 54, srcSpanEndLine = 186, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_host_only = True}</span></span><span class="mpre">]

</span><a href="#loc_189_1_189_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_38&#39;)"><span class="mpre">testComputeCookieStringHostOnlyFilter</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_189_1_189_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_38&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringHostOnlyFilter</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Host only cookies shouldn&#39;t match subdomain&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><a href="#loc_192_9_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_191_9_191_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_9_191_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_192_9_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
  where </span><a name="loc_191_9_191_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_9_191_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 191, srcSpanStartColumn = 19, srcSpanEndLine = 191, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 191, srcSpanStartColumn = 35, srcSpanEndLine = 191, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_request {HC.host = fromString &quot;sub1.sub2.google.com&quot;}</span></span><span class="mpre">
        </span><a name="loc_192_9_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 192, srcSpanStartColumn = 39, srcSpanEndLine = 194, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 192, srcSpanStartColumn = 54, srcSpanEndLine = 192, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_host_only = True
                                                     , cookie_domain = fromString &quot;sub2.google.com&quot;
                                                     }</span></span><span class="mpre">
                                     ]

</span><a href="#loc_198_1_198_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_38&#39;)"><span class="mpre">testComputeCookieStringDomainMatching</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_198_1_198_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_38&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringDomainMatching</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Domain matching works for new requests&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;name=value&quot;</span></span><span class="mpre">, </span><a href="#loc_201_9_201_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_200_9_200_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_9_200_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_201_9_201_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
  where </span><a name="loc_200_9_200_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_9_200_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 200, srcSpanStartColumn = 19, srcSpanEndLine = 200, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 200, srcSpanStartColumn = 35, srcSpanEndLine = 200, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_request {HC.host = fromString &quot;sub1.sub2.google.com&quot;}</span></span><span class="mpre">
        </span><a name="loc_201_9_201_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 201, srcSpanStartColumn = 39, srcSpanEndLine = 201, srcSpanEndColumn = 100}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 201, srcSpanStartColumn = 54, srcSpanEndLine = 201, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, src"><span class="mpre">default_cookie {cookie_domain = fromString &quot;sub2.google.com&quot;}</span></span><span class="mpre">]

</span><a href="#loc_204_1_204_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_36&#39;)"><span class="mpre">testComputeCookieStringPathMatching</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_204_1_204_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_36&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringPathMatching</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path matching works for new requests&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;name=value&quot;</span></span><span class="mpre">, </span><a href="#loc_207_9_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_9_207_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_206_9_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_207_9_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_9_207_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
  where </span><a name="loc_206_9_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 206, srcSpanStartColumn = 19, srcSpanEndLine = 206, srcSpanEndColumn = 78}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 206, srcSpanStartColumn = 35, srcSpanEndLine = 206, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_request {HC.path = fromString &quot;/a/path/to/nowhere&quot;}</span></span><span class="mpre">
        </span><a name="loc_207_9_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_9_207_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 207, srcSpanStartColumn = 39, srcSpanEndLine = 207, srcSpanEndColumn = 90}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 207, srcSpanStartColumn = 54, srcSpanEndLine = 207, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_path = fromString &quot;/a/path&quot;}</span></span><span class="mpre">]

</span><a href="#loc_210_1_210_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_41&#39;)"><span class="mpre">testComputeCookieStringPathMatchingFails</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_210_1_210_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_41&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringPathMatchingFails</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path matching fails when it should&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><a href="#loc_213_9_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_212_9_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_213_9_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
  where </span><a name="loc_212_9_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 212, srcSpanStartColumn = 19, srcSpanEndLine = 212, srcSpanEndColumn = 88}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 212, srcSpanStartColumn = 35, srcSpanEndLine = 212, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_request {HC.path = fromString &quot;/a/different/path/to/nowhere&quot;}</span></span><span class="mpre">
        </span><a name="loc_213_9_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 213, srcSpanStartColumn = 39, srcSpanEndLine = 213, srcSpanEndColumn = 90}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 213, srcSpanStartColumn = 54, srcSpanEndLine = 213, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_path = fromString &quot;/a/path&quot;}</span></span><span class="mpre">]

</span><a href="#loc_216_1_216_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_45&#39;)"><span class="mpre">testComputeCookieStringPathMatchingWithParms</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_216_1_216_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_45&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringPathMatchingWithParms</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path matching succeeds when request has GET params&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;name=value&quot;</span></span><span class="mpre">, </span><a href="#loc_219_9_219_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_218_9_218_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_219_9_219_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
  where </span><a name="loc_218_9_218_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 218, srcSpanStartColumn = 19, srcSpanEndLine = 218, srcSpanEndColumn = 86}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 218, srcSpanStartColumn = 35, srcSpanEndLine = 218, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_request {HC.path = fromString &quot;/a/path/to/nowhere?var=val&quot;}</span></span><span class="mpre">
        </span><a name="loc_219_9_219_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 39, srcSpanEndLine = 219, srcSpanEndColumn = 90}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 54, srcSpanEndLine = 219, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_path = fromString &quot;/a/path&quot;}</span></span><span class="mpre">]

</span><a href="#loc_222_1_222_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_30&#39;)"><span class="mpre">testComputeCookieStringSecure</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_222_1_222_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_30&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringSecure</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Secure flag filters properly&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><a href="#loc_224_9_224_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_224_9_224_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
  where </span><a name="loc_224_9_224_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 224, srcSpanStartColumn = 39, srcSpanEndLine = 224, srcSpanEndColumn = 81}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 224, srcSpanStartColumn = 54, srcSpanEndLine = 224, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_secure_only = True}</span></span><span class="mpre">]

</span><a href="#loc_227_1_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_32&#39;)"><span class="mpre">testComputeCookieStringHttpOnly</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_227_1_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_32&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringHttpOnly</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;http-only flag filters properly&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><a href="#loc_229_9_229_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_9_229_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_229_9_229_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_9_229_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">)
  where </span><a name="loc_229_9_229_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_9_229_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 229, srcSpanStartColumn = 39, srcSpanEndLine = 229, srcSpanEndColumn = 79}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 229, srcSpanStartColumn = 54, srcSpanEndLine = 229, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_http_only = True}</span></span><span class="mpre">]

</span><a href="#loc_232_1_232_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_28&#39;)"><span class="mpre">testComputeCookieStringSort</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_232_1_232_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_28&#39;)"><span class="hl_vardecl"><span class="mpre">testComputeCookieStringSort</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Sorting works correctly&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;c1=v1;c3=v3;c4=v4;c2=v2&quot;</span></span><span class="mpre">, </span><a href="#loc_254_9_254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_23&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar_out</span></span></a><span class="mpre">) </span><a href="#loc_278_9_278_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_9_278_22&#39;)"><span class="hl_varref"><span class="mpre">format_output</span></span></a><span class="mpre">
  where </span><span class="hl_vardecl"><span class="mpre">now</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">)
        </span><a name="loc_235_9_235_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [ </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 235, srcSpanStartColumn = 40, srcSpanEndLine = 238, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 235, srcSpanStartColumn = 55, srcSpanEndLine = 235, srcSpanEndColumn = 56},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;c1&quot;
                                                      , cookie_value = fromString &quot;v1&quot;
                                                      , cookie_path = fromString &quot;/all/encompassing/request&quot;
                                                      }</span></span><span class="mpre">
                                     , </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 239, srcSpanStartColumn = 40, srcSpanEndLine = 242, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 239, srcSpanStartColumn = 55, srcSpanEndLine = 239, srcSpanEndColumn = 56},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;c2&quot;
                                                      , cookie_value = fromString &quot;v2&quot;
                                                      , cookie_path = fromString &quot;/all&quot;
                                                      }</span></span><span class="mpre">
                                     , </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 243, srcSpanStartColumn = 40, srcSpanEndLine = 247, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 243, srcSpanStartColumn = 55, srcSpanEndLine = 243, srcSpanEndColumn = 56},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;c3&quot;
                                                      , cookie_value = fromString &quot;v3&quot;
                                                      , cookie_path = fromString &quot;/all/encompassing&quot;
                                                      , cookie_creation_time = UTCTime (ModifiedJulianDay 0) (secondsToDiffTime 1)
                                                      }</span></span><span class="mpre">
                                     , </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 248, srcSpanStartColumn = 40, srcSpanEndLine = 252, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 248, srcSpanStartColumn = 55, srcSpanEndLine = 248, srcSpanEndColumn = 56},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;c4&quot;
                                                      , cookie_value = fromString &quot;v4&quot;
                                                      , cookie_path = fromString &quot;/all/encompassing&quot;
                                                      , cookie_creation_time = UTCTime (ModifiedJulianDay 0) (secondsToDiffTime 2)
                                                      }</span></span><span class="mpre">
                                     ]
        </span><a name="loc_254_9_254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_23&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar_out</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [ </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 254, srcSpanStartColumn = 44, srcSpanEndLine = 258, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 254, srcSpanStartColumn = 59, srcSpanEndLine = 254, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;c1&quot;
                                                          , cookie_value = fromString &quot;v1&quot;
                                                          , cookie_path = fromString &quot;/all/encompassing/request&quot;
                                                          , cookie_last_access_time = now
                                                          }</span></span><span class="mpre">
                                         , </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 259, srcSpanStartColumn = 44, srcSpanEndLine = 263, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 259, srcSpanStartColumn = 59, srcSpanEndLine = 259, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;c2&quot;
                                                          , cookie_value = fromString &quot;v2&quot;
                                                          , cookie_path = fromString &quot;/all&quot;
                                                          , cookie_last_access_time = now
                                                          }</span></span><span class="mpre">
                                         , </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 264, srcSpanStartColumn = 44, srcSpanEndLine = 269, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 264, srcSpanStartColumn = 59, srcSpanEndLine = 264, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;c3&quot;
                                                          , cookie_value = fromString &quot;v3&quot;
                                                          , cookie_path = fromString &quot;/all/encompassing&quot;
                                                          , cookie_creation_time = UTCTime (ModifiedJulianDay 0) (secondsToDiffTime 1)
                                                          , cookie_last_access_time = now
                                                          }</span></span><span class="mpre">
                                         , </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 270, srcSpanStartColumn = 44, srcSpanEndLine = 275, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 270, srcSpanStartColumn = 59, srcSpanEndLine = 270, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;c4&quot;
                                                          , cookie_value = fromString &quot;v4&quot;
                                                          , cookie_path = fromString &quot;/all/encompassing&quot;
                                                          , cookie_creation_time = UTCTime (ModifiedJulianDay 0) (secondsToDiffTime 2)
                                                          , cookie_last_access_time = now
                                                          }</span></span><span class="mpre">
                                         ]
        </span><a name="loc_277_9_277_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_9_277_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 277, srcSpanStartColumn = 19, srcSpanEndLine = 277, srcSpanEndColumn = 90}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 277, srcSpanStartColumn = 35, srcSpanEndLine = 277, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_request {HC.path = fromString &quot;/all/encompassing/request/path&quot;}</span></span><span class="mpre">
        </span><a name="loc_278_9_278_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_9_278_22&#39;)"><span class="hl_vardecl"><span class="mpre">format_output</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_277_9_277_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_9_277_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_235_9_235_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a href="#loc_281_1_281_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_34&#39;)"><span class="mpre">testInsertCookiesIntoRequestWorks</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_281_1_281_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_34&#39;)"><span class="hl_vardecl"><span class="mpre">testInsertCookiesIntoRequestWorks</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Inserting cookies works&quot;</span></span><span class="mpre">
  [(</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">CI.mk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Cookie&quot;</span></span><span class="mpre">, </span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;key=val&quot;</span></span><span class="mpre">)] </span><a href="#loc_283_9_283_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_9_283_20&#39;)"><span class="hl_varref"><span class="mpre">out_headers</span></span></a><span class="mpre">
  where </span><a name="loc_283_9_283_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_9_283_20&#39;)"><span class="hl_vardecl"><span class="mpre">out_headers</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_306_7_306_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_306_7_306_21&#39;)"><span class="hl_varref"><span class="mpre">HC.requestHeaders</span></span></a><span class="mpre"> </span><a href="#loc_284_10_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_10_284_13&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
        (</span><a name="loc_284_10_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_10_284_13&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre">, _) = </span><a href="Network.HTTP.Client.Cookies.html#loc_123_1_123_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_123_1_123_25&#39;)"><span class="hl_varref"><span class="mpre">insertCookiesIntoRequest</span></span></a><span class="mpre"> </span><a href="#loc_289_9_289_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_9_289_13&#39;)"><span class="hl_varref"><span class="mpre">req&#39;</span></span></a><span class="mpre"> </span><a href="#loc_285_9_285_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_9_285_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre">
        </span><a name="loc_285_9_285_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_9_285_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [ </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 285, srcSpanStartColumn = 40, srcSpanEndLine = 287, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 285, srcSpanStartColumn = 55, srcSpanEndLine = 285, srcSpanEndColumn = 56},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie { cookie_name = fromString &quot;key&quot;
                                                      , cookie_value = fromString &quot;val&quot;
                                                      }</span></span><span class="mpre">
                                     ]
        </span><a name="loc_289_9_289_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_9_289_13&#39;)"><span class="hl_vardecl"><span class="mpre">req&#39;</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 289, srcSpanStartColumn = 16, srcSpanEndLine = 290, srcSpanEndColumn = 88}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 289, srcSpanStartColumn = 32, srcSpanEndLine = 289, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_request {HC.requestHeaders = [(CI.mk $ fromString &quot;Cookie&quot;,
                                                      fromString &quot;otherkey=otherval&quot;)]}</span></span><span class="mpre">

</span><a href="#loc_293_1_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_1_293_21&#39;)"><span class="mpre">testReceiveSetCookie</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_293_1_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_1_293_21&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookie</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Receiving a Set-Cookie&quot;</span></span><span class="mpre">
  (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">]) (</span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="hl_varref"><span class="mpre">default_set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])

</span><a href="#loc_297_1_297_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_32&#39;)"><span class="mpre">testReceiveSetCookieTrailingDot</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_297_1_297_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_32&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieTrailingDot</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Receiving a Set-Cookie with a trailing domain dot&quot;</span></span><span class="mpre">
  (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []) (</span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_299_9_299_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_9_299_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_299_9_299_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_9_299_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 299, srcSpanStartColumn = 22, srcSpanEndLine = 299, srcSpanEndColumn = 96}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 299, srcSpanStartColumn = 41, srcSpanEndLine = 299, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieDomain = Just $ fromString &quot;www.google.com.&quot;}</span></span><span class="mpre">

</span><a href="#loc_302_1_302_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_31&#39;)"><span class="mpre">testReceiveSetCookieLeadingDot</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_302_1_302_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_31&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieLeadingDot</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Receiving a Set-Cookie with a leading domain dot&quot;</span></span><span class="mpre">
  (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">]) (</span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_304_9_304_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_9_304_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_304_9_304_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_9_304_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 304, srcSpanStartColumn = 22, srcSpanEndLine = 304, srcSpanEndColumn = 96}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 304, srcSpanStartColumn = 41, srcSpanEndLine = 304, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieDomain = Just $ fromString &quot;.www.google.com&quot;}</span></span><span class="mpre">

</span><a href="#loc_307_1_307_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_29&#39;)"><span class="mpre">testReceiveSetCookieNoDomain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_307_1_307_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_29&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieNoDomain</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Receiving cookie without domain&quot;</span></span><span class="mpre">
  (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">]) (</span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_309_9_309_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_9_309_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_309_9_309_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_9_309_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 22, srcSpanEndLine = 309, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 41, srcSpanEndLine = 309, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieDomain = Nothing}</span></span><span class="mpre">

</span><a href="#loc_312_1_312_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_32&#39;)"><span class="mpre">testReceiveSetCookieEmptyDomain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_312_1_312_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_32&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieEmptyDomain</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Receiving cookie with empty domain&quot;</span></span><span class="mpre">
  (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">]) (</span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_314_9_314_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_9_314_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_314_9_314_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_9_314_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 314, srcSpanStartColumn = 22, srcSpanEndLine = 314, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 314, srcSpanStartColumn = 41, srcSpanEndLine = 314, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieDomain = Just BS.empty}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Can&#39;t test public suffixes until that module is written</span></span><span class="mpre">

</span><a href="#loc_319_1_319_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_38&#39;)"><span class="mpre">testReceiveSetCookieNonMatchingDomain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_319_1_319_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_38&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieNonMatchingDomain</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Receiving cookie with non-matching domain&quot;</span></span><span class="mpre">
  (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []) (</span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_321_9_321_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_9_321_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_321_9_321_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_9_321_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 321, srcSpanStartColumn = 22, srcSpanEndLine = 321, srcSpanEndColumn = 98}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 321, srcSpanStartColumn = 41, srcSpanEndLine = 321, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieDomain = Just $ fromString &quot;www.wikipedia.org&quot;}</span></span><span class="mpre">

</span><a href="#loc_324_1_324_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_1_324_29&#39;)"><span class="mpre">testReceiveSetCookieHostOnly</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_324_1_324_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_1_324_29&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieHostOnly</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Checking host-only flag gets set&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">cookie_host_only</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_326_9_326_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_9_326_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []
  where </span><a name="loc_326_9_326_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_9_326_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 326, srcSpanStartColumn = 22, srcSpanEndLine = 326, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 326, srcSpanStartColumn = 41, srcSpanEndLine = 326, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieDomain = Nothing}</span></span><span class="mpre">

</span><a href="#loc_329_1_329_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_1_329_35&#39;)"><span class="mpre">testReceiveSetCookieHostOnlyNotSet</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_329_1_329_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_1_329_35&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieHostOnlyNotSet</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Checking host-only flag doesn&#39;t get set&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cookie_host_only</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_331_9_331_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_9_331_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []
  where </span><a name="loc_331_9_331_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_9_331_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 331, srcSpanStartColumn = 22, srcSpanEndLine = 331, srcSpanEndColumn = 91}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 331, srcSpanStartColumn = 41, srcSpanEndLine = 331, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieDomain = Just $ fromString &quot;google.com&quot;}</span></span><span class="mpre">

</span><a href="#loc_334_1_334_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_29&#39;)"><span class="mpre">testReceiveSetCookieHttpOnly</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_334_1_334_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_29&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieHttpOnly</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Checking http-only flag gets set&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">cookie_http_only</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_336_9_336_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_9_336_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []
  where </span><a name="loc_336_9_336_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_9_336_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 336, srcSpanStartColumn = 22, srcSpanEndLine = 336, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 336, srcSpanStartColumn = 41, srcSpanEndLine = 336, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieHttpOnly = True}</span></span><span class="mpre">

</span><a href="#loc_339_1_339_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_35&#39;)"><span class="mpre">testReceiveSetCookieHttpOnlyNotSet</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_339_1_339_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_35&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieHttpOnlyNotSet</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Checking http-only flag doesn&#39;t get set&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cookie_http_only</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_341_9_341_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_9_341_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []
  where </span><a name="loc_341_9_341_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_9_341_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 341, srcSpanStartColumn = 22, srcSpanEndLine = 341, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 341, srcSpanStartColumn = 41, srcSpanEndLine = 341, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieHttpOnly = False}</span></span><span class="mpre">

</span><a href="#loc_344_1_344_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_33&#39;)"><span class="mpre">testReceiveSetCookieHttpOnlyDrop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_344_1_344_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_33&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieHttpOnlyDrop</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Checking non http request gets dropped&quot;</span></span><span class="mpre">
  (</span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []) (</span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_346_9_346_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_9_346_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_346_9_346_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_9_346_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 346, srcSpanStartColumn = 22, srcSpanEndLine = 346, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 346, srcSpanStartColumn = 41, srcSpanEndLine = 346, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieHttpOnly = True}</span></span><span class="mpre">

</span><a href="#loc_349_1_349_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_25&#39;)"><span class="mpre">testReceiveSetCookieName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_349_1_349_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_25&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Name gets set correctly&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;name&quot;</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">cookie_name</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="hl_varref"><span class="mpre">default_set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])

</span><a href="#loc_353_1_353_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_26&#39;)"><span class="mpre">testReceiveSetCookieValue</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_353_1_353_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_26&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieValue</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Value gets set correctly&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;value&quot;</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">cookie_value</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="hl_varref"><span class="mpre">default_set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])

</span><a href="#loc_357_1_357_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_27&#39;)"><span class="mpre">testReceiveSetCookieExpiry</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_357_1_357_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_27&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieExpiry</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expiry gets set correctly&quot;</span></span><span class="mpre">
  </span><a href="#loc_359_9_359_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_9_359_27&#39;)"><span class="hl_varref"><span class="mpre">now_plus_diff_time</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_expiry_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="hl_varref"><span class="mpre">default_set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_359_9_359_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_9_359_27&#39;)"><span class="hl_vardecl"><span class="mpre">now_plus_diff_time</span></span></a><span class="mpre"> = ((</span><span class="hl_varref"><span class="mpre">fromRational</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre"> </span><a href="#loc_38_1_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_18&#39;)"><span class="hl_varref"><span class="mpre">default_diff_time</span></span></a><span class="mpre">) </span><a href="Data.Time.Clock.UTCDiff.html#loc_9_1_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTCDiff.html#loc_9_1_9_11&#39;)"><span class="hl_infix"><span class="mpre">`addUTCTime`</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre">)

</span><a href="#loc_362_1_362_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_29&#39;)"><span class="mpre">testReceiveSetCookieNoMaxAge</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_362_1_362_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_29&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieNoMaxAge</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expiry is based on the given value&quot;</span></span><span class="mpre">
  </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_expiry_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_364_9_364_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_9_364_31&#39;)"><span class="hl_varref"><span class="mpre">cookie_without_max_age</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_364_9_364_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_9_364_31&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_without_max_age</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 364, srcSpanStartColumn = 34, srcSpanEndLine = 364, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 364, srcSpanStartColumn = 53, srcSpanEndLine = 364, srcSpanEndColumn = 54},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieMaxAge = Nothing}</span></span><span class="mpre">

</span><a href="#loc_367_1_367_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_29&#39;)"><span class="mpre">testReceiveSetCookieNoExpiry</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_367_1_367_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_29&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieNoExpiry</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expiry is based on max age&quot;</span></span><span class="mpre">
  </span><a href="#loc_369_9_369_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_9_369_27&#39;)"><span class="hl_varref"><span class="mpre">now_plus_diff_time</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_expiry_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_370_9_370_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_9_370_30&#39;)"><span class="hl_varref"><span class="mpre">cookie_without_expiry</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_369_9_369_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_9_369_27&#39;)"><span class="hl_vardecl"><span class="mpre">now_plus_diff_time</span></span></a><span class="mpre"> = ((</span><span class="hl_varref"><span class="mpre">fromRational</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre"> </span><a href="#loc_38_1_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_18&#39;)"><span class="hl_varref"><span class="mpre">default_diff_time</span></span></a><span class="mpre">) </span><a href="Data.Time.Clock.UTCDiff.html#loc_9_1_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTCDiff.html#loc_9_1_9_11&#39;)"><span class="hl_infix"><span class="mpre">`addUTCTime`</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre">)
        </span><a name="loc_370_9_370_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_9_370_30&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_without_expiry</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 370, srcSpanStartColumn = 33, srcSpanEndLine = 370, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 370, srcSpanStartColumn = 52, srcSpanEndLine = 370, srcSpanEndColumn = 53},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieExpires = Nothing}</span></span><span class="mpre">

</span><a href="#loc_373_1_373_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_37&#39;)"><span class="mpre">testReceiveSetCookieNoExpiryNoMaxAge</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_373_1_373_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_37&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieNoExpiryNoMaxAge</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expiry is set to a future date&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_expiry_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_375_9_375_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_9_375_21&#39;)"><span class="hl_varref"><span class="mpre">basic_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_375_9_375_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_9_375_21&#39;)"><span class="hl_vardecl"><span class="mpre">basic_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 375, srcSpanStartColumn = 24, srcSpanEndLine = 375, srcSpanEndColumn = 100}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 375, srcSpanStartColumn = 43, srcSpanEndLine = 375, srcSpanEndColumn = 44},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, src"><span class="mpre">default_set_cookie { setCookieExpires = Nothing, setCookieMaxAge = Nothing }</span></span><span class="mpre">

</span><a href="#loc_378_1_378_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_1_378_25&#39;)"><span class="mpre">testReceiveSetCookiePath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_378_1_378_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_1_378_25&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookiePath</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path gets set correctly&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/a/path&quot;</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">cookie_path</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_380_9_380_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_380_9_380_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_380_9_380_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_380_9_380_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 380, srcSpanStartColumn = 22, srcSpanEndLine = 380, srcSpanEndColumn = 86}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 380, srcSpanStartColumn = 41, srcSpanEndLine = 380, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookiePath = Just $ fromString &quot;/a/path&quot;}</span></span><span class="mpre">

</span><a href="#loc_383_1_383_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_27&#39;)"><span class="mpre">testReceiveSetCookieNoPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_383_1_383_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_27&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieNoPath</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path gets set correctly when nonexistant&quot;</span></span><span class="mpre">
  (</span><a href="Data.ByteString.UTF8.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.UTF8.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/a/path/to&quot;</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">cookie_path</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_385_9_385_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_9_385_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_386_9_386_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_9_386_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_385_9_385_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_9_385_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 385, srcSpanStartColumn = 22, srcSpanEndLine = 385, srcSpanEndColumn = 66}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 385, srcSpanStartColumn = 41, srcSpanEndLine = 385, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookiePath = Nothing}</span></span><span class="mpre">
        </span><a name="loc_386_9_386_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_9_386_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 386, srcSpanStartColumn = 19, srcSpanEndLine = 386, srcSpanEndColumn = 78}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 386, srcSpanStartColumn = 35, srcSpanEndLine = 386, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_request {HC.path = fromString &quot;/a/path/to/nowhere&quot;}</span></span><span class="mpre">

</span><a href="#loc_389_1_389_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_1_389_33&#39;)"><span class="mpre">testReceiveSetCookieCreationTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_389_1_389_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_1_389_33&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieCreationTime</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Creation time gets set correctly&quot;</span></span><span class="mpre">
  </span><a href="#loc_391_9_391_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_9_391_12&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_creation_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="hl_varref"><span class="mpre">default_set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_391_9_391_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_9_391_12&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_391_9_391_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_9_391_12&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><a href="#loc_394_1_394_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_31&#39;)"><span class="mpre">testReceiveSetCookieAccessTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_394_1_394_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_31&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieAccessTime</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Last access time gets set correctly&quot;</span></span><span class="mpre">
  </span><a href="#loc_396_9_396_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_9_396_12&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_last_access_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="hl_varref"><span class="mpre">default_set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_396_9_396_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_9_396_12&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_396_9_396_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_9_396_12&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><a href="#loc_399_1_399_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_1_399_31&#39;)"><span class="mpre">testReceiveSetCookiePersistent</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_399_1_399_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_1_399_31&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookiePersistent</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Persistent flag gets set correctly&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">cookie_persistent</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_401_9_401_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_9_401_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []
  where </span><a name="loc_401_9_401_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_9_401_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 401, srcSpanStartColumn = 22, srcSpanEndLine = 401, srcSpanEndColumn = 79}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 401, srcSpanStartColumn = 41, srcSpanEndLine = 401, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieExpires = Just default_time}</span></span><span class="mpre">

</span><a href="#loc_404_1_404_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_27&#39;)"><span class="mpre">testReceiveSetCookieSecure</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_404_1_404_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_27&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieSecure</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Secure flag gets set correctly&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">cookie_secure_only</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_406_9_406_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_9_406_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> []
  where </span><a name="loc_406_9_406_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_9_406_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 406, srcSpanStartColumn = 22, srcSpanEndLine = 406, srcSpanEndColumn = 65}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 406, srcSpanStartColumn = 41, srcSpanEndLine = 406, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie {setCookieSecure = True}</span></span><span class="mpre">

</span><a href="#loc_409_1_409_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_27&#39;)"><span class="mpre">testReceiveSetCookieMaxAge</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_409_1_409_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_27&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieMaxAge</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Max-Age gets set correctly&quot;</span></span><span class="mpre">
  </span><a href="#loc_415_9_415_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_9_415_14&#39;)"><span class="hl_varref"><span class="mpre">total</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_expiry_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_411_9_411_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_9_411_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_414_9_414_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_9_414_12&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_411_9_411_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_9_411_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 411, srcSpanStartColumn = 22, srcSpanEndLine = 413, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 411, srcSpanStartColumn = 41, srcSpanEndLine = 411, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie { setCookieExpires = Nothing
                                        , setCookieMaxAge = Just $ secondsToDiffTime 10
                                        }</span></span><span class="mpre">
        </span><a name="loc_414_9_414_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_9_414_12&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)
        </span><a name="loc_415_9_415_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_9_415_14&#39;)"><span class="hl_vardecl"><span class="mpre">total</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">22</span></span><span class="mpre">)

</span><a href="#loc_418_1_418_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_1_418_33&#39;)"><span class="mpre">testReceiveSetCookiePreferMaxAge</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_418_1_418_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_1_418_33&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookiePreferMaxAge</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Max-Age is preferred over Expires&quot;</span></span><span class="mpre">
  </span><a href="#loc_425_9_425_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_9_425_14&#39;)"><span class="hl_varref"><span class="mpre">total</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_expiry_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_420_9_420_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_9_420_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_424_9_424_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_9_424_12&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [])
  where </span><a name="loc_420_9_420_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_9_420_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 420, srcSpanStartColumn = 22, srcSpanEndLine = 422, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 420, srcSpanStartColumn = 41, srcSpanEndLine = 420, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie { setCookieExpires = Just exp
                                        , setCookieMaxAge = Just $ secondsToDiffTime 10
                                        }</span></span><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">exp</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">)
        </span><a name="loc_424_9_424_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_9_424_12&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)
        </span><a name="loc_425_9_425_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_9_425_14&#39;)"><span class="hl_vardecl"><span class="mpre">total</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">22</span></span><span class="mpre">)

</span><a href="#loc_428_1_428_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_29&#39;)"><span class="mpre">testReceiveSetCookieExisting</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_428_1_428_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_29&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieExisting</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Existing cookie gets updated&quot;</span></span><span class="mpre">
  </span><a href="#loc_433_9_433_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_9_433_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_expiry_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_430_9_430_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_9_430_19&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">])
  where </span><a name="loc_430_9_430_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_9_430_19&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 430, srcSpanStartColumn = 22, srcSpanEndLine = 432, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 430, srcSpanStartColumn = 41, srcSpanEndLine = 430, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_set_cookie { setCookieExpires = Just t
                                        , setCookieMaxAge = Nothing
                                        }</span></span><span class="mpre">
        </span><a name="loc_433_9_433_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_9_433_10&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)

</span><a href="#loc_436_1_436_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_1_436_37&#39;)"><span class="mpre">testReceiveSetCookieExistingCreation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_436_1_436_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_1_436_37&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieExistingCreation</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Creation time gets updated in existing cookie&quot;</span></span><span class="mpre">
  </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_creation_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="hl_varref"><span class="mpre">default_set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_438_9_438_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_9_438_12&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_21_1_21_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_15&#39;)"><span class="hl_varref"><span class="mpre">default_cookie</span></span></a><span class="mpre">])
  where </span><a name="loc_438_9_438_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_9_438_12&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)

</span><a href="#loc_441_1_441_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_1_441_37&#39;)"><span class="mpre">testReceiveSetCookieExistingHttpOnly</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_441_1_441_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_1_441_37&#39;)"><span class="hl_vardecl"><span class="mpre">testReceiveSetCookieExistingHttpOnly</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Existing http-only cookie gets dropped&quot;</span></span><span class="mpre">
  </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cookie_expiry_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_41_1_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_19&#39;)"><span class="hl_varref"><span class="mpre">default_set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_16&#39;)"><span class="hl_varref"><span class="mpre">default_request</span></span></a><span class="mpre"> </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">default_time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_443_9_443_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_9_443_24&#39;)"><span class="hl_varref"><span class="mpre">existing_cookie</span></span></a><span class="mpre">])
  where </span><a name="loc_443_9_443_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_9_443_24&#39;)"><span class="hl_vardecl"><span class="mpre">existing_cookie</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 443, srcSpanStartColumn = 27, srcSpanEndLine = 443, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 443, srcSpanStartColumn = 42, srcSpanEndLine = 443, srcSpanEndColumn = 43},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcS"><span class="mpre">default_cookie {cookie_http_only = True}</span></span><span class="mpre">

</span><a href="#loc_446_1_446_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_23&#39;)"><span class="mpre">testMonoidPreferRecent</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_446_1_446_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_23&#39;)"><span class="hl_vardecl"><span class="mpre">testMonoidPreferRecent</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Monoid prefers more recent cookies&quot;</span></span><span class="mpre">
  (</span><a href="#loc_450_9_450_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_9_450_12&#39;)"><span class="hl_varref"><span class="mpre">cct</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_449_9_449_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_9_449_11&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">]) (</span><a href="#loc_450_9_450_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_9_450_12&#39;)"><span class="hl_varref"><span class="mpre">cct</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_448_9_448_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_9_448_11&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">] </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_87_1_87_16&#39;)"><span class="hl_varref"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> [</span><a href="#loc_449_9_449_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_9_449_11&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">])
  where </span><a name="loc_448_9_448_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_9_448_11&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 448, srcSpanStartColumn = 14, srcSpanEndLine = 448, srcSpanEndColumn = 105}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 448, srcSpanStartColumn = 29, srcSpanEndLine = 448, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, src"><span class="mpre">default_cookie {cookie_creation_time = UTCTime (ModifiedJulianDay 0) (secondsToDiffTime 1)}</span></span><span class="mpre">
        </span><a name="loc_449_9_449_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_9_449_11&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 449, srcSpanStartColumn = 14, srcSpanEndLine = 449, srcSpanEndColumn = 105}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, srcSpanStartLine = 449, srcSpanStartColumn = 29, srcSpanEndLine = 449, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-conduit-2.1.3/test/CookieTest.hs&quot;, src"><span class="mpre">default_cookie {cookie_creation_time = UTCTime (ModifiedJulianDay 0) (secondsToDiffTime 2)}</span></span><span class="mpre">
        </span><a name="loc_450_9_450_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_9_450_12&#39;)"><span class="hl_fundecl"><span class="mpre">cct</span></span></a><span class="mpre"> </span><a name="loc_450_13_450_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_13_450_15&#39;)"><span class="hl_vardecl"><span class="mpre">cj</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">cookie_creation_time</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Cookies.html#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Cookies.html#loc_90_1_90_17&#39;)"><span class="hl_varref"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> </span><a href="#loc_450_13_450_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_13_450_15&#39;)"><span class="hl_varref"><span class="mpre">cj</span></span></a><span class="mpre">

</span><a href="#loc_453_1_453_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_1_453_13&#39;)"><span class="mpre">ipParseTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_453_1_453_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_1_453_13&#39;)"><span class="hl_vardecl"><span class="mpre">ipParseTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Valid IP&quot;</span></span><span class="mpre"> </span><a href="#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="hl_varref"><span class="mpre">testValidIp</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Digit Too High&quot;</span></span><span class="mpre"> </span><a href="#loc_56_1_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_17&#39;)"><span class="hl_varref"><span class="mpre">testIpNumTooHigh</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Too Many Segments&quot;</span></span><span class="mpre"> </span><a href="#loc_60_1_60_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_24&#39;)"><span class="hl_varref"><span class="mpre">testTooManySegmentsInIp</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Chars in IP&quot;</span></span><span class="mpre"> </span><a href="#loc_64_1_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_14&#39;)"><span class="hl_varref"><span class="mpre">testCharsInIp</span></span></a><span class="mpre">

</span><a href="#loc_460_1_460_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_20&#39;)"><span class="mpre">domainMatchingTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_460_1_460_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_20&#39;)"><span class="hl_vardecl"><span class="mpre">domainMatchingTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Should Match&quot;</span></span><span class="mpre"> </span><a href="#loc_68_1_68_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_25&#39;)"><span class="hl_varref"><span class="mpre">testDomainMatchesSuccess</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Same Domain&quot;</span></span><span class="mpre"> </span><a href="#loc_72_1_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_15&#39;)"><span class="hl_varref"><span class="mpre">testSameDomain</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Sibling Domain&quot;</span></span><span class="mpre"> </span><a href="#loc_77_1_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_18&#39;)"><span class="hl_varref"><span class="mpre">testSiblingDomain</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Parent Domain&quot;</span></span><span class="mpre"> </span><a href="#loc_81_1_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_17&#39;)"><span class="hl_varref"><span class="mpre">testParentDomain</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Checking for Naive suffix-check&quot;</span></span><span class="mpre"> </span><a href="#loc_85_1_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_22&#39;)"><span class="hl_varref"><span class="mpre">testNaiveSuffixDomain</span></span></a><span class="mpre">

</span><a href="#loc_468_1_468_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_1_468_17&#39;)"><span class="mpre">defaultPathTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_468_1_468_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_1_468_17&#39;)"><span class="hl_vardecl"><span class="mpre">defaultPathTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Basic default path test&quot;</span></span><span class="mpre"> </span><a href="#loc_89_1_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_16&#39;)"><span class="hl_varref"><span class="mpre">testDefaultPath</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Basic populated default path&quot;</span></span><span class="mpre"> </span><a href="#loc_97_1_97_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_25&#39;)"><span class="hl_varref"><span class="mpre">testPopulatedDefaultPath</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Default path from request with GET params works&quot;</span></span><span class="mpre"> </span><a href="#loc_101_1_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_22&#39;)"><span class="hl_varref"><span class="mpre">testParamsDefaultPath</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Getting a default path that ends in a slash&quot;</span></span><span class="mpre"> </span><a href="#loc_105_1_105_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_29&#39;)"><span class="hl_varref"><span class="mpre">testDefaultPathEndingInSlash</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Getting a short default path&quot;</span></span><span class="mpre"> </span><a href="#loc_93_1_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_21&#39;)"><span class="hl_varref"><span class="mpre">testShortDefaultPath</span></span></a><span class="mpre">

</span><a href="#loc_476_1_476_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_18&#39;)"><span class="mpre">pathMatchingTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_476_1_476_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_18&#39;)"><span class="hl_vardecl"><span class="mpre">pathMatchingTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Same paths match&quot;</span></span><span class="mpre"> </span><a href="#loc_109_1_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_19&#39;)"><span class="hl_varref"><span class="mpre">testSamePathsMatch</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Putting slash at end&quot;</span></span><span class="mpre"> </span><a href="#loc_114_1_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_19&#39;)"><span class="hl_varref"><span class="mpre">testPathSlashAtEnd</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Not putting slash at end&quot;</span></span><span class="mpre"> </span><a href="#loc_118_1_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_21&#39;)"><span class="hl_varref"><span class="mpre">testPathNoSlashAtEnd</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Diverging paths don&#39;t match&quot;</span></span><span class="mpre"> </span><a href="#loc_122_1_122_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_19&#39;)"><span class="hl_varref"><span class="mpre">testDivergingPaths</span></span></a><span class="mpre">

</span><a href="#loc_483_1_483_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_1_483_14&#39;)"><span class="mpre">equalityTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_483_1_483_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_1_483_14&#39;)"><span class="hl_vardecl"><span class="mpre">equalityTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;The same cookie should be equal to itself&quot;</span></span><span class="mpre"> </span><a href="#loc_126_1_126_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_26&#39;)"><span class="hl_varref"><span class="mpre">testCookieEqualitySuccess</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Changing extra options shouldn&#39;t change equality&quot;</span></span><span class="mpre"> </span><a href="#loc_131_1_131_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_29&#39;)"><span class="hl_varref"><span class="mpre">testCookieEqualityResiliance</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Changing a cookie&#39;s domain should change its equality&quot;</span></span><span class="mpre"> </span><a href="#loc_135_1_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_26&#39;)"><span class="hl_varref"><span class="mpre">testDomainChangesEquality</span></span></a><span class="mpre">

</span><a href="#loc_489_1_489_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_12&#39;)"><span class="mpre">removeTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_489_1_489_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_12&#39;)"><span class="hl_vardecl"><span class="mpre">removeTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Removing a cookie works&quot;</span></span><span class="mpre"> </span><a href="#loc_139_1_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_17&#39;)"><span class="hl_varref"><span class="mpre">testRemoveCookie</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Removing a nonexistant cookie doesn&#39;t work&quot;</span></span><span class="mpre"> </span><a href="#loc_143_1_143_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_28&#39;)"><span class="hl_varref"><span class="mpre">testRemoveNonexistantCookie</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Removing the correct cookie&quot;</span></span><span class="mpre"> </span><a href="#loc_147_1_147_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_24&#39;)"><span class="hl_varref"><span class="mpre">testRemoveCorrectCookie</span></span></a><span class="mpre">

</span><a href="#loc_495_1_495_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_1_495_14&#39;)"><span class="mpre">evictionTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_495_1_495_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_1_495_14&#39;)"><span class="hl_vardecl"><span class="mpre">evictionTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Testing eviction&quot;</span></span><span class="mpre"> </span><a href="#loc_153_1_153_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_24&#39;)"><span class="hl_varref"><span class="mpre">testEvictExpiredCookies</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Evicting from empty cookie jar&quot;</span></span><span class="mpre"> </span><a href="#loc_170_1_170_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_19&#39;)"><span class="hl_varref"><span class="mpre">testEvictNoCookies</span></span></a><span class="mpre">

</span><a href="#loc_500_1_500_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_13&#39;)"><span class="mpre">sendingTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_500_1_500_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_13&#39;)"><span class="hl_vardecl"><span class="mpre">sendingTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Updates last access time upon using cookies&quot;</span></span><span class="mpre"> </span><a href="#loc_175_1_175_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_44&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringUpdateLastAccessTime</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Host-only flag matches exact host&quot;</span></span><span class="mpre"> </span><a href="#loc_183_1_183_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_32&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringHostOnly</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Host-only flag doesn&#39;t match subdomain&quot;</span></span><span class="mpre"> </span><a href="#loc_189_1_189_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_38&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringHostOnlyFilter</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Domain matching works properly&quot;</span></span><span class="mpre"> </span><a href="#loc_198_1_198_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_38&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringDomainMatching</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path matching works&quot;</span></span><span class="mpre"> </span><a href="#loc_204_1_204_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_36&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringPathMatching</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path matching fails when it should&quot;</span></span><span class="mpre"> </span><a href="#loc_210_1_210_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_41&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringPathMatchingFails</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path matching succeeds when request has GET params&quot;</span></span><span class="mpre"> </span><a href="#loc_216_1_216_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_45&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringPathMatchingWithParms</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Secure flag filters correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_222_1_222_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_30&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringSecure</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Http-only flag filters correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_227_1_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_32&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringHttpOnly</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Sorting works correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_232_1_232_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_28&#39;)"><span class="hl_varref"><span class="mpre">testComputeCookieStringSort</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Inserting cookie header works&quot;</span></span><span class="mpre"> </span><a href="#loc_281_1_281_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_34&#39;)"><span class="hl_varref"><span class="mpre">testInsertCookiesIntoRequestWorks</span></span></a><span class="mpre">

</span><a href="#loc_514_1_514_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_1_514_15&#39;)"><span class="mpre">receivingTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_514_1_514_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_1_514_15&#39;)"><span class="hl_vardecl"><span class="mpre">receivingTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Can receive set-cookie&quot;</span></span><span class="mpre"> </span><a href="#loc_293_1_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_1_293_21&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookie</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Receiving a Set-Cookie with a trailing dot on the domain&quot;</span></span><span class="mpre"> </span><a href="#loc_297_1_297_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_32&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieTrailingDot</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Receiving a Set-Cookie with a leading dot on the domain&quot;</span></span><span class="mpre"> </span><a href="#loc_302_1_302_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_31&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieLeadingDot</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Set-Cookie with no domain&quot;</span></span><span class="mpre"> </span><a href="#loc_307_1_307_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_29&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieNoDomain</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Set-Cookie with empty domain&quot;</span></span><span class="mpre"> </span><a href="#loc_312_1_312_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_32&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieEmptyDomain</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Set-Cookie with non-matching domain&quot;</span></span><span class="mpre"> </span><a href="#loc_319_1_319_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_38&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieNonMatchingDomain</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Host-only flag gets set&quot;</span></span><span class="mpre"> </span><a href="#loc_324_1_324_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_1_324_29&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieHostOnly</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Host-only flag doesn&#39;t get set&quot;</span></span><span class="mpre"> </span><a href="#loc_329_1_329_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_1_329_35&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieHostOnlyNotSet</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Http-only flag gets set&quot;</span></span><span class="mpre"> </span><a href="#loc_334_1_334_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_29&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieHttpOnly</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Http-only flag doesn&#39;t get set&quot;</span></span><span class="mpre"> </span><a href="#loc_339_1_339_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_35&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieHttpOnlyNotSet</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Checking non http request gets dropped&quot;</span></span><span class="mpre"> </span><a href="#loc_344_1_344_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_33&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieHttpOnlyDrop</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Name gets set correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_349_1_349_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_25&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieName</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Value gets set correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_353_1_353_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_26&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieValue</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expiry gets set correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_357_1_357_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_27&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieExpiry</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expiry gets set based on max age if no expiry is given&quot;</span></span><span class="mpre"> </span><a href="#loc_367_1_367_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_29&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieNoExpiry</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expiry gets set based on given value if no max age is given&quot;</span></span><span class="mpre"> </span><a href="#loc_362_1_362_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_29&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieNoMaxAge</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expiry gets set to a future date if no expiry and no max age are given&quot;</span></span><span class="mpre"> </span><a href="#loc_373_1_373_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_37&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieNoExpiryNoMaxAge</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path gets set correctly when nonexistant&quot;</span></span><span class="mpre"> </span><a href="#loc_383_1_383_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_27&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieNoPath</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Path gets set correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_378_1_378_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_1_378_25&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookiePath</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Creation time gets set correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_389_1_389_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_1_389_33&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieCreationTime</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Last access time gets set correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_394_1_394_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_31&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieAccessTime</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Persistent flag gets set correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_399_1_399_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_1_399_31&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookiePersistent</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Existing cookie gets updated&quot;</span></span><span class="mpre"> </span><a href="#loc_428_1_428_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_29&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieExisting</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Creation time gets updated in existing cookie&quot;</span></span><span class="mpre"> </span><a href="#loc_436_1_436_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_1_436_37&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieExistingCreation</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Existing http-only cookie gets dropped&quot;</span></span><span class="mpre"> </span><a href="#loc_441_1_441_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_1_441_37&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieExistingHttpOnly</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Secure flag gets set correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_404_1_404_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_27&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieSecure</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Max-Age flag gets set correctly&quot;</span></span><span class="mpre"> </span><a href="#loc_409_1_409_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_27&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookieMaxAge</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Max-Age is preferred over Expires&quot;</span></span><span class="mpre"> </span><a href="#loc_418_1_418_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_1_418_33&#39;)"><span class="hl_varref"><span class="mpre">testReceiveSetCookiePreferMaxAge</span></span></a><span class="mpre">

</span><a href="#loc_545_1_545_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_545_1_545_12&#39;)"><span class="mpre">monoidTests</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_545_1_545_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_545_1_545_12&#39;)"><span class="hl_vardecl"><span class="mpre">monoidTests</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Monoid prefers more recent cookies&quot;</span></span><span class="mpre"> </span><a href="#loc_446_1_446_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_23&#39;)"><span class="hl_varref"><span class="mpre">testMonoidPreferRecent</span></span></a><span class="mpre">

</span><a href="#loc_549_1_549_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_1_549_11&#39;)"><span class="mpre">cookieTest</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_549_1_549_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_1_549_11&#39;)"><span class="hl_vardecl"><span class="mpre">cookieTest</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ipParseTests&quot;</span></span><span class="mpre"> </span><a href="#loc_453_1_453_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_1_453_13&#39;)"><span class="hl_varref"><span class="mpre">ipParseTests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;domainMatchingTests&quot;</span></span><span class="mpre"> </span><a href="#loc_460_1_460_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_20&#39;)"><span class="hl_varref"><span class="mpre">domainMatchingTests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;defaultPathTests&quot;</span></span><span class="mpre"> </span><a href="#loc_468_1_468_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_1_468_17&#39;)"><span class="hl_varref"><span class="mpre">defaultPathTests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;pathMatchingTests&quot;</span></span><span class="mpre"> </span><a href="#loc_476_1_476_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_18&#39;)"><span class="hl_varref"><span class="mpre">pathMatchingTests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;equalityTests&quot;</span></span><span class="mpre"> </span><a href="#loc_483_1_483_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_1_483_14&#39;)"><span class="hl_varref"><span class="mpre">equalityTests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;removeTests&quot;</span></span><span class="mpre"> </span><a href="#loc_489_1_489_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_12&#39;)"><span class="hl_varref"><span class="mpre">removeTests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;evictionTests&quot;</span></span><span class="mpre"> </span><a href="#loc_495_1_495_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_1_495_14&#39;)"><span class="hl_varref"><span class="mpre">evictionTests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;sendingTests&quot;</span></span><span class="mpre"> </span><a href="#loc_500_1_500_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_13&#39;)"><span class="hl_varref"><span class="mpre">sendingTests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;receivingTests&quot;</span></span><span class="mpre"> </span><a href="#loc_514_1_514_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_1_514_15&#39;)"><span class="hl_varref"><span class="mpre">receivingTests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;monoidTest&quot;</span></span><span class="mpre"> </span><a href="#loc_545_1_545_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_545_1_545_12&#39;)"><span class="hl_varref"><span class="mpre">monoidTests</span></span></a><span class="mpre">
</span></div></body></html>