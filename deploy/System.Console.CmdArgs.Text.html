<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A module to represent text with very basic formatting. Values are of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   type [&#39;Text&#39;] and shown with &#39;showText&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   As an example of the formatting:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; [Line &quot;Cooking for hungry people.&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Line &quot;Welcome to my cookery recipe program, I sure hope you enjoy using it!&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Line &quot;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Cols [&quot;Omlette&quot;,&quot;  A tasty eggy treat.&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Cols [&quot;  -m&quot;,&quot; --mushrooms&quot;,&quot;  Some mushrooms, or in fact any other ingredients you have in the cupboards&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Cols [&quot;  -e&quot;,&quot; --eggs&quot;, &quot;  But always you need eggs&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Line &quot;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Cols [&quot;Spagetti Bolognaise&quot;, &quot;  An Italian delight.&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Cols [&quot;  -s&quot;,&quot; --spagetti&quot;,&quot;  The first word in the name&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Cols [&quot;  -b&quot;,&quot; --bolognaise&quot;,&quot;  The second word in the name&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Cols [&quot;  -d&quot;,&quot; --dolmio&quot;,&quot;  The magic ingredient!&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Line &quot;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ,Line &quot;    The author of this program explicitly disclaims any liability for poisoning people who get their recipes off the internet.&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   With @putStrLn (&#39;showText&#39; (&#39;Wrap&#39; 50) demo)@ gives:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Cooking for hungry people.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Welcome to my cookery recipe program, I sure hope</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; you enjoy using it!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Omlette              A tasty eggy treat.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   -m --mushrooms   Some mushrooms, or in fact</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                    any other ingredients you have</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                    in the cupboards</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   -e --eggs        But always you need eggs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Spagetti Bolognaise  An Italian delight.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   -s --spagetti    The first word in the name</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   -b --bolognaise  The second word in the name</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   -d --dolmio      The magic ingredient!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     The author of this program explicitly</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     disclaims any liability for poisoning people</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     who get their recipes off the internet.</span></span><span class="mpre">
module System.Console.CmdArgs.Text(TextFormat(..), defaultWrap, Text(..), showText) where

import Data.Char
import Data.Function
import Data.List
import Data.Maybe
import System.Console.CmdArgs.Default


</span><span class="hl_comment"><span class="mpre">-- | Wrap with the default width of 80 characters.</span></span><span class="mpre">
</span><a href="#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="mpre">defaultWrap</span></a><span class="mpre"> :: </span><a href="#loc_55_6_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_6_55_16&#39;)"><span class="hl_tyconref"><span class="mpre">TextFormat</span></span></a><span class="mpre">
</span><a name="loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="hl_vardecl"><span class="mpre">defaultWrap</span></span></a><span class="mpre"> = </span><a href="#loc_56_19_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_23&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">80</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | How to output the text.</span></span><span class="mpre">
data </span><a name="loc_55_6_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_6_55_16&#39;)"><span class="hl_tycondecl"><span class="mpre">TextFormat</span></span></a><span class="mpre"> = </span><a name="loc_55_19_55_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_19_55_23&#39;)"><span class="hl_condecl"><span class="mpre">HTML</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Display as HTML.</span></span><span class="mpre">
                | </span><a name="loc_56_19_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_23&#39;)"><span class="hl_condecl"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Display as text wrapped at a certain width (see &#39;defaultWrap&#39;).</span></span><span class="mpre">
                  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Text.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 19, srcSpanEndLine = 57, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Text.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 19, srcSpanEndLine = 57, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/Cmd"><span class="mpre">deriving (Read,Show,Eq,Ord)</span></span><span class="mpre">

instance </span><a href="System.Console.CmdArgs.Default.html#loc_10_7_10_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.CmdArgs.Default.html#loc_10_7_10_14&#39;)"><span class="hl_classref"><span class="mpre">Default</span></span></a><span class="mpre"> </span><a href="#loc_55_6_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_6_55_16&#39;)"><span class="hl_tyconref"><span class="mpre">TextFormat</span></span></a><span class="mpre"> where </span><a href="System.Console.CmdArgs.Default.html#loc_12_5_12_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.CmdArgs.Default.html#loc_12_5_12_8&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> = </span><a href="#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="hl_varref"><span class="mpre">defaultWrap</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The data type representing some text, typically used as @[Text]@. The formatting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   is described by:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * &#39;Line&#39; values represent a paragraph of text, and may be wrapped depending on the &#39;TextFormat&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     If a &#39;Line&#39; value is wrapped then all leading space will be treated as an indent.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * &#39;Cols&#39; values represent columns of text. Within any @[Text]@ all columns of the same length</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     are grouped in tabs, with the final column being wrapped if necessary. All columns are placed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     adjacent with no space between them - for this reason most columns will start with a space.</span></span><span class="mpre">
data </span><a name="loc_70_6_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Text</span></span></a><span class="mpre"> = </span><a name="loc_70_13_70_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_13_70_17&#39;)"><span class="hl_condecl"><span class="mpre">Line</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- a single line</span></span><span class="mpre">
          | </span><a name="loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_condecl"><span class="mpre">Cols</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- a single line with columns (always indented by 2 spaces)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_70_6_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">showList</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_80_1_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_9&#39;)"><span class="hl_varref"><span class="mpre">showText</span></span></a><span class="mpre"> </span><a href="#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="hl_varref"><span class="mpre">defaultWrap</span></span></a><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_75_10_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_80_1_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_9&#39;)"><span class="hl_varref"><span class="mpre">showText</span></span></a><span class="mpre"> </span><a href="#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_12&#39;)"><span class="hl_varref"><span class="mpre">defaultWrap</span></span></a><span class="mpre"> [</span><a href="#loc_75_10_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">-- | Show some text using the given formatting.</span></span><span class="mpre">
</span><a href="#loc_80_1_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_9&#39;)"><span class="mpre">showText</span></a><span class="mpre"> :: </span><a href="#loc_55_6_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_6_55_16&#39;)"><span class="hl_tyconref"><span class="mpre">TextFormat</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_70_6_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_80_1_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_9&#39;)"><span class="hl_fundecl"><span class="mpre">showText</span></span></a><span class="mpre"> </span><a href="#loc_55_19_55_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_19_55_23&#39;)"><span class="hl_conref"><span class="mpre">HTML</span></span></a><span class="mpre"> = </span><a href="#loc_129_1_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_9&#39;)"><span class="hl_varref"><span class="mpre">showHTML</span></span></a><span class="mpre">
</span><a href="#loc_80_1_80_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_9&#39;)"><span class="hl_fundecl"><span class="mpre">showText</span></span></a><span class="mpre"> (</span><a href="#loc_56_19_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_23&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><a name="loc_81_16_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_16_81_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_88_1_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_9&#39;)"><span class="hl_varref"><span class="mpre">showWrap</span></span></a><span class="mpre"> </span><a href="#loc_81_16_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_16_81_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TEXT OUTPUT</span></span><span class="mpre">

</span><a href="#loc_88_1_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_9&#39;)"><span class="mpre">showWrap</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><a href="#loc_70_6_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_88_1_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_9&#39;)"><span class="hl_fundecl"><span class="mpre">showWrap</span></span></a><span class="mpre"> </span><a name="loc_88_10_88_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_10_88_15&#39;)"><span class="hl_vardecl"><span class="mpre">width</span></span></a><span class="mpre"> </span><a name="loc_88_16_88_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_16_88_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="hl_varref"><span class="mpre">unlines</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_96_9_96_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_88_16_88_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_16_88_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    where
        </span><a href="#loc_91_9_91_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_9_91_11&#39;)"><span class="mpre">cs</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">])]
        </span><a name="loc_91_9_91_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_9_91_11&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_91_20_91_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_20_91_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_91_20_91_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_20_91_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.List.html#loc_523_1_523_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_523_1_523_8&#39;)"><span class="hl_varref"><span class="mpre">maximum</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_451_1_451_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_451_1_451_10&#39;)"><span class="hl_varref"><span class="mpre">transpose</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_91_20_91_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_20_91_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><a href="Data.List.html#loc_739_1_739_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_739_1_739_8&#39;)"><span class="hl_varref"><span class="mpre">groupBy</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_810_1_810_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_810_1_810_7&#39;)"><span class="hl_varref"><span class="mpre">sortBy</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">)
                [(</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_93_57_93_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_57_93_58&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><a href="#loc_93_57_93_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_57_93_58&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) | </span><a href="#loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_conref"><span class="mpre">Cols</span></span></a><span class="mpre"> </span><a name="loc_93_57_93_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_57_93_58&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_88_16_88_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_16_88_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">]
        </span><a name="loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_fundecl"><span class="mpre">pad</span></span></a><span class="mpre"> </span><a name="loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_94_15_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_94_15_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> (</span><a href="#loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_94_15_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre">

        </span><a name="loc_96_9_96_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_70_13_70_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_13_70_17&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a name="loc_96_17_96_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_17_96_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_97_20_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_105_1_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_6&#39;)"><span class="hl_varref"><span class="mpre">wrap1</span></span></a><span class="mpre"> (</span><a href="#loc_88_10_88_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_10_88_15&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_97_20_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_97_22_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_22_97_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            where (</span><a name="loc_97_20_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_97_22_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_22_97_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_96_17_96_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_17_96_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><a href="#loc_96_9_96_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_conref"><span class="mpre">Cols</span></span></a><span class="mpre"> </span><a name="loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> </span><a href="#loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> </span><a href="#loc_100_19_100_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_19_100_21&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><a href="#loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_102_19_102_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_19_102_21&#39;)"><span class="hl_varref"><span class="mpre">z1</span></span></a><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><a href="#loc_101_19_101_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_19_101_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><a href="#loc_102_22_102_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_22_102_24&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">
            where </span><a name="loc_100_19_100_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_19_100_21&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_91_9_91_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_9_91_11&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
                  </span><a name="loc_101_19_101_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_19_101_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1025_1_1025_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1025_1_1025_4&#39;)"><span class="hl_varref"><span class="mpre">sum</span></span></a><span class="mpre"> </span><a href="#loc_100_19_100_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_19_100_21&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">takeWhile</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
                  </span><a name="loc_102_19_102_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_19_102_21&#39;)"><span class="hl_vardecl"><span class="mpre">z1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_102_22_102_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_22_102_24&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre"> = </span><a href="#loc_105_1_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_6&#39;)"><span class="hl_varref"><span class="mpre">wrap1</span></span></a><span class="mpre"> (</span><a href="#loc_88_10_88_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_10_88_15&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_101_19_101_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_19_101_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)


</span><a name="loc_105_1_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_6&#39;)"><span class="hl_fundecl"><span class="mpre">wrap1</span></span></a><span class="mpre"> </span><a name="loc_105_7_105_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_7_105_12&#39;)"><span class="hl_vardecl"><span class="mpre">width</span></span></a><span class="mpre"> </span><a name="loc_105_13_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = [</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_106_11_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_11_106_14&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_106_11_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_11_106_14&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
    where </span><a name="loc_106_11_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_11_106_14&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = </span><a href="#loc_110_1_110_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_5&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a href="#loc_105_7_105_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_7_105_12&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre"> </span><a href="#loc_105_13_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Split the text into strips of no-more than the given width</span></span><span class="mpre">
</span><a href="#loc_110_1_110_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_5&#39;)"><span class="mpre">wrap</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
</span><a name="loc_110_1_110_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_5&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a name="loc_110_6_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_11&#39;)"><span class="hl_vardecl"><span class="mpre">width</span></span></a><span class="mpre"> = </span><a href="#loc_120_9_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_16&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="hl_varref"><span class="mpre">split</span></span></a><span class="mpre">
    where
        </span><a href="#loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="mpre">split</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)] </span><span class="hl_comment"><span class="mpre">-- string, amount of space after</span></span><span class="mpre">
        </span><a name="loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="hl_fundecl"><span class="mpre">split</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = []
        </span><a href="#loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="hl_fundecl"><span class="mpre">split</span></span></a><span class="mpre"> </span><a name="loc_114_15_114_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_115_20_115_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_20_115_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_116_20_116_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_20_116_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="hl_varref"><span class="mpre">split</span></span></a><span class="mpre"> </span><a href="#loc_116_22_116_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_23&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
            where (</span><a name="loc_115_20_115_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_20_115_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_115_22_115_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_22_115_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_114_15_114_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                  (</span><a name="loc_116_20_116_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_20_116_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_116_22_116_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_23&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_115_22_115_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_22_115_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- combine two adjacent chunks while they are less than width</span></span><span class="mpre">
        </span><a href="#loc_120_9_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_16&#39;)"><span class="mpre">combine</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)] -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
        </span><a name="loc_120_9_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_16&#39;)"><span class="hl_fundecl"><span class="mpre">combine</span></span></a><span class="mpre"> ((</span><a name="loc_120_19_120_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_19_120_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a name="loc_120_25_120_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_25_120_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_120_27_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_28&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_120_30_120_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_30_120_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_120_19_120_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_19_120_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_120_25_120_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_25_120_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_110_6_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_11&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre"> = </span><a href="#loc_120_9_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_16&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_120_19_120_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_19_120_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><a href="#loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_120_25_120_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_25_120_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">,</span><a href="#loc_120_27_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_28&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_120_30_120_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_30_120_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_120_9_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_16&#39;)"><span class="hl_fundecl"><span class="mpre">combine</span></span></a><span class="mpre"> (</span><a name="loc_121_18_121_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_18_121_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_121_20_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_20_121_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_121_18_121_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_18_121_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_120_9_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_16&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a href="#loc_121_20_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_20_121_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_120_9_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_16&#39;)"><span class="hl_fundecl"><span class="mpre">combine</span></span></a><span class="mpre"> [] = []


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- HTML OUTPUT</span></span><span class="mpre">

</span><a href="#loc_129_1_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_9&#39;)"><span class="mpre">showHTML</span></a><span class="mpre"> :: [</span><a href="#loc_70_6_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_129_1_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_9&#39;)"><span class="hl_fundecl"><span class="mpre">showHTML</span></span></a><span class="mpre"> </span><a name="loc_129_10_129_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_10_129_12&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="hl_varref"><span class="mpre">unlines</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    [</span><span class="hl_string"><span class="mpre">&quot;&lt;table class=&#39;cmdargs&#39;&gt;&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_136_9_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_9_136_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_129_10_129_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_10_129_12&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    [</span><span class="hl_string"><span class="mpre">&quot;&lt;/table&gt;&quot;</span></span><span class="mpre">]
    where
        </span><a name="loc_134_9_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_13&#39;)"><span class="hl_vardecl"><span class="mpre">cols</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_523_1_523_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_523_1_523_8&#39;)"><span class="hl_varref"><span class="mpre">maximum</span></span></a><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_134_41_134_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_41_134_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_conref"><span class="mpre">Cols</span></span></a><span class="mpre"> </span><a name="loc_134_41_134_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_41_134_42&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_129_10_129_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_10_129_12&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">]

        </span><a name="loc_136_9_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_9_136_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_70_13_70_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_13_70_17&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a name="loc_136_17_136_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_17_136_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_139_9_139_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_11&#39;)"><span class="hl_varref"><span class="mpre">tr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_140_9_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_11&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><a href="#loc_134_9_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_13&#39;)"><span class="hl_varref"><span class="mpre">cols</span></span></a><span class="mpre"> </span><a href="#loc_136_17_136_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_17_136_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="#loc_136_9_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_9_136_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_71_13_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_17&#39;)"><span class="hl_conref"><span class="mpre">Cols</span></span></a><span class="mpre"> </span><a name="loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_139_9_139_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_11&#39;)"><span class="hl_varref"><span class="mpre">tr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><a href="#loc_140_9_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_11&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_140_9_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_11&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> (</span><a href="#loc_134_9_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_13&#39;)"><span class="hl_varref"><span class="mpre">cols</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_137_17_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_17_137_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

        </span><a name="loc_139_9_139_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_11&#39;)"><span class="hl_fundecl"><span class="mpre">tr</span></span></a><span class="mpre"> </span><a name="loc_139_12_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_12_139_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&lt;tr&gt;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_139_12_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_12_139_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;/tr&gt;&quot;</span></span><span class="mpre">
        </span><a name="loc_140_9_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_11&#39;)"><span class="hl_fundecl"><span class="mpre">td</span></span></a><span class="mpre"> </span><a name="loc_140_12_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_16&#39;)"><span class="hl_vardecl"><span class="mpre">cols</span></span></a><span class="mpre"> </span><a name="loc_140_17_140_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&lt;td&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (if </span><a href="#loc_140_12_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_16&#39;)"><span class="hl_varref"><span class="mpre">cols</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot; colspan=&#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_140_12_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_16&#39;)"><span class="hl_varref"><span class="mpre">cols</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;&quot;</span></span><span class="mpre">)
                          </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (if </span><a href="#loc_143_20_143_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_20_143_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot; style=&#39;padding-left:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_143_20_143_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_20_143_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ex;&#39;&quot;</span></span><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
                     </span><span class="hl_string"><span class="mpre">&quot;&gt;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_143_22_143_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_22_143_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;&amp;nbsp;&quot;</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_145_9_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_12&#39;)"><span class="hl_varref"><span class="mpre">esc</span></span></a><span class="mpre"> </span><a href="#loc_143_22_143_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_22_143_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;/td&gt;&quot;</span></span><span class="mpre">
            where (</span><a name="loc_143_20_143_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_20_143_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_143_22_143_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_22_143_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_140_17_140_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><a name="loc_145_9_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_12&#39;)"><span class="hl_fundecl"><span class="mpre">esc</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&amp;&#39;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&amp;amp;&quot;</span></span><span class="mpre">
        </span><a href="#loc_145_9_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_12&#39;)"><span class="hl_fundecl"><span class="mpre">esc</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&gt;&#39;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&amp;gt;&quot;</span></span><span class="mpre">
        </span><a href="#loc_145_9_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_12&#39;)"><span class="hl_fundecl"><span class="mpre">esc</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&lt;&#39;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&amp;lt;&quot;</span></span><span class="mpre">
        </span><a href="#loc_145_9_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_12&#39;)"><span class="hl_fundecl"><span class="mpre">esc</span></span></a><span class="mpre"> </span><a name="loc_148_13_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_13_148_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = [</span><a href="#loc_148_13_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_13_148_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]
</span></div></body></html>