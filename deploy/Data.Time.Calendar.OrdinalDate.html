<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | ISO 8601 Ordinal Date format</span></span><span class="mpre">
module Data.Time.Calendar.OrdinalDate where

import Data.Time.Calendar.Days
import Data.Time.Calendar.Private

</span><span class="hl_comment"><span class="mpre">-- | convert to ISO 8601 Ordinal Date format. First element of result is year (proleptic Gregoran calendar),</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- second is the day of the year, with 1 for Jan 1, and 365 (or 366 in leap years) for Dec 31.</span></span><span class="mpre">
</span><a href="#loc_10_1_10_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_14&#39;)"><span class="mpre">toOrdinalDate</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_10_1_10_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_14&#39;)"><span class="hl_fundecl"><span class="mpre">toOrdinalDate</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><a name="loc_10_34_10_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_34_10_37&#39;)"><span class="hl_vardecl"><span class="mpre">mjd</span></span></a><span class="mpre">) = (</span><a href="#loc_20_9_20_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_9_20_13&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre">,</span><a href="#loc_19_9_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_11&#39;)"><span class="hl_varref"><span class="mpre">yd</span></span></a><span class="mpre">) where
        </span><a name="loc_11_9_11_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_9_11_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_10_34_10_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_34_10_37&#39;)"><span class="hl_varref"><span class="mpre">mjd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">678575</span></span><span class="mpre">
        </span><a name="loc_12_9_12_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_9_12_17&#39;)"><span class="hl_vardecl"><span class="mpre">quadcent</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_11_9_11_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_9_11_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">146097</span></span><span class="mpre">
        </span><a name="loc_13_9_13_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_9_13_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_11_9_11_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_9_11_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">146097</span></span><span class="mpre">
        </span><a name="loc_14_9_14_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_13&#39;)"><span class="hl_vardecl"><span class="mpre">cent</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_13_9_13_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_9_13_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">36524</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
        </span><a name="loc_15_9_15_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_13_9_13_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_9_13_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><a href="#loc_14_9_14_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_13&#39;)"><span class="hl_varref"><span class="mpre">cent</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">36524</span></span><span class="mpre">)
        </span><a name="loc_16_9_16_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_13&#39;)"><span class="hl_vardecl"><span class="mpre">quad</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_15_9_15_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1461</span></span><span class="mpre">
        </span><a name="loc_17_9_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_15_9_15_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1461</span></span><span class="mpre">
        </span><a name="loc_18_9_18_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_17_9_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
        </span><a name="loc_19_9_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_11&#39;)"><span class="hl_vardecl"><span class="mpre">yd</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><a href="#loc_17_9_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><a href="#loc_18_9_18_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a name="loc_20_9_20_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_9_20_13&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> = </span><a href="#loc_12_9_12_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_9_12_17&#39;)"><span class="hl_varref"><span class="mpre">quadcent</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">400</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_14_9_14_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_13&#39;)"><span class="hl_varref"><span class="mpre">cent</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_16_9_16_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_13&#39;)"><span class="hl_varref"><span class="mpre">quad</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_18_9_18_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | convert from ISO 8601 Ordinal Date format.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid day numbers will be clipped to the correct range (1 to 365 or 366).</span></span><span class="mpre">
</span><a href="#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="mpre">fromOrdinalDate</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="hl_fundecl"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a name="loc_25_17_25_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_17_25_21&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> </span><a name="loc_25_22_25_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_22_25_25&#39;)"><span class="hl_vardecl"><span class="mpre">day</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><a href="#loc_27_9_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_9_27_12&#39;)"><span class="hl_varref"><span class="mpre">mjd</span></span></a><span class="mpre"> where
        </span><a name="loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_25_17_25_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_17_25_21&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_27_9_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_9_27_12&#39;)"><span class="hl_vardecl"><span class="mpre">mjd</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Private.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_43_1_43_5&#39;)"><span class="hl_varref"><span class="mpre">clip</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (if </span><a href="#loc_46_1_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_11&#39;)"><span class="hl_varref"><span class="mpre">isLeapYear</span></span></a><span class="mpre"> </span><a href="#loc_25_17_25_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_17_25_21&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">366</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><a href="#loc_25_22_25_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_22_25_25&#39;)"><span class="hl_varref"><span class="mpre">day</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">400</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">678576</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | convert from ISO 8601 Ordinal Date format.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid day numbers return Nothing</span></span><span class="mpre">
</span><a href="#loc_32_1_32_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_21&#39;)"><span class="mpre">fromOrdinalDateValid</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_32_1_32_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_21&#39;)"><span class="hl_fundecl"><span class="mpre">fromOrdinalDateValid</span></span></a><span class="mpre"> </span><a name="loc_32_22_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_22_32_26&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> </span><a name="loc_32_27_32_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_30&#39;)"><span class="hl_vardecl"><span class="mpre">day</span></span></a><span class="mpre"> = do
        </span><a name="loc_33_9_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_13&#39;)"><span class="hl_vardecl"><span class="mpre">day&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Calendar.Private.html#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">clipValid</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (if </span><a href="#loc_46_1_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_11&#39;)"><span class="hl_varref"><span class="mpre">isLeapYear</span></span></a><span class="mpre"> </span><a href="#loc_32_22_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_22_32_26&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">366</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><a href="#loc_32_27_32_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_30&#39;)"><span class="hl_varref"><span class="mpre">day</span></span></a><span class="mpre">
        let
                </span><a name="loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_32_22_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_22_32_26&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                </span><a name="loc_36_17_36_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_20&#39;)"><span class="hl_vardecl"><span class="mpre">mjd</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_33_9_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_13&#39;)"><span class="hl_varref"><span class="mpre">day&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">400</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">678576</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><a href="#loc_36_17_36_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_20&#39;)"><span class="hl_varref"><span class="mpre">mjd</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | show in ISO 8601 Ordinal Date format (yyyy-ddd)</span></span><span class="mpre">
</span><a href="#loc_41_1_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_16&#39;)"><span class="mpre">showOrdinalDate</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_41_1_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_16&#39;)"><span class="hl_fundecl"><span class="mpre">showOrdinalDate</span></span></a><span class="mpre"> </span><a name="loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_vardecl"><span class="mpre">date</span></span></a><span class="mpre"> = (</span><a href="Data.Time.Calendar.Private.html#loc_34_1_34_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_34_1_34_6&#39;)"><span class="hl_varref"><span class="mpre">show4</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">) </span><a href="#loc_42_10_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_10_42_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Private.html#loc_31_1_31_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_31_1_31_6&#39;)"><span class="hl_varref"><span class="mpre">show3</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">) </span><a href="#loc_42_12_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_12_42_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">) where
        (</span><a name="loc_42_10_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_10_42_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_42_12_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_12_42_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><a href="#loc_10_1_10_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_14&#39;)"><span class="hl_varref"><span class="mpre">toOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_varref"><span class="mpre">date</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Is this year a leap year according to the proleptic Gregorian calendar?</span></span><span class="mpre">
</span><a href="#loc_46_1_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_11&#39;)"><span class="mpre">isLeapYear</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_46_1_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_11&#39;)"><span class="hl_fundecl"><span class="mpre">isLeapYear</span></span></a><span class="mpre"> </span><a name="loc_46_12_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_12_46_16&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_46_12_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_12_46_16&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_46_12_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_12_46_16&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">400</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_46_12_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_12_46_16&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Get the number of the Monday-starting week in the year and the day of the week.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The first Monday is the first day of week 1, any earlier days in the year are week 0 (as \&quot;%W\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Monday is 1, Sunday is 7 (as \&quot;%u\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
</span><a href="#loc_52_1_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_16&#39;)"><span class="mpre">mondayStartWeek</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_52_1_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_16&#39;)"><span class="hl_fundecl"><span class="mpre">mondayStartWeek</span></span></a><span class="mpre"> </span><a name="loc_52_17_52_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_21&#39;)"><span class="hl_vardecl"><span class="mpre">date</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_54_9_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_55_9_55_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">)),</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_54_9_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) where
        </span><a name="loc_53_9_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_11&#39;)"><span class="hl_vardecl"><span class="mpre">yd</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> (</span><a href="#loc_10_1_10_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_14&#39;)"><span class="hl_varref"><span class="mpre">toOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_52_17_52_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_21&#39;)"><span class="hl_varref"><span class="mpre">date</span></span></a><span class="mpre">)
        </span><a name="loc_54_9_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = (</span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> </span><a href="#loc_52_17_52_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_21&#39;)"><span class="hl_varref"><span class="mpre">date</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
        </span><a name="loc_55_9_55_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_54_9_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><a href="#loc_53_9_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_11&#39;)"><span class="hl_varref"><span class="mpre">yd</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Get the number of the Sunday-starting week in the year and the day of the week.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The first Sunday is the first day of week 1, any earlier days in the year are week 0 (as \&quot;%U\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Sunday is 0, Saturday is 6 (as \&quot;%w\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
</span><a href="#loc_61_1_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_16&#39;)"><span class="mpre">sundayStartWeek</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_61_1_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_16&#39;)"><span class="hl_fundecl"><span class="mpre">sundayStartWeek</span></span></a><span class="mpre"> </span><a name="loc_61_17_61_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_17_61_21&#39;)"><span class="hl_vardecl"><span class="mpre">date</span></span></a><span class="mpre"> =(</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_64_9_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">)),</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">)) where
        </span><a name="loc_62_9_62_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_11&#39;)"><span class="hl_vardecl"><span class="mpre">yd</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> (</span><a href="#loc_10_1_10_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_14&#39;)"><span class="hl_varref"><span class="mpre">toOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_61_17_61_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_17_61_21&#39;)"><span class="hl_varref"><span class="mpre">date</span></span></a><span class="mpre">)
        </span><a name="loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = (</span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> </span><a href="#loc_61_17_61_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_17_61_21&#39;)"><span class="hl_varref"><span class="mpre">date</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
        </span><a name="loc_64_9_64_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><a href="#loc_62_9_62_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_11&#39;)"><span class="hl_varref"><span class="mpre">yd</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The inverse of &#39;mondayStartWeek&#39;. Get a &#39;Day&#39; given the year,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the number of the Monday-starting week, and the day of the week.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The first Monday is the first day of week 1, any earlier days in the year </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are week 0 (as \&quot;%W\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
</span><a href="#loc_75_1_75_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_20&#39;)"><span class="mpre">fromMondayStartWeek</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Year.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Monday-starting week number.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Day of week. </span></span><span class="mpre">
                               </span><span class="hl_comment"><span class="mpre">-- Monday is 1, Sunday is 7 (as \&quot;%u\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
                    -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_75_1_75_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_20&#39;)"><span class="hl_fundecl"><span class="mpre">fromMondayStartWeek</span></span></a><span class="mpre"> </span><a name="loc_75_21_75_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_75_23_75_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_23_75_24&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_75_25_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> (</span><a href="#loc_78_11_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_19&#39;)"><span class="hl_varref"><span class="mpre">firstDay</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_76_11_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_11_76_13&#39;)"><span class="hl_varref"><span class="mpre">yd</span></span></a><span class="mpre">)
    where </span><a name="loc_76_11_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_11_76_13&#39;)"><span class="hl_vardecl"><span class="mpre">yd</span></span></a><span class="mpre"> = </span><a href="#loc_80_11_80_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_22&#39;)"><span class="hl_varref"><span class="mpre">firstMonday</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> (</span><a href="#loc_75_23_75_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_23_75_24&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><a href="#loc_75_25_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- first day of the year</span></span><span class="mpre">
          </span><a name="loc_78_11_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_19&#39;)"><span class="hl_vardecl"><span class="mpre">firstDay</span></span></a><span class="mpre"> = </span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> (</span><a href="#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_75_21_75_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          </span><span class="hl_comment"><span class="mpre">-- 0-based year day of first monday of the year</span></span><span class="mpre">
          </span><a name="loc_80_11_80_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_22&#39;)"><span class="hl_vardecl"><span class="mpre">firstMonday</span></span></a><span class="mpre"> = (</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_78_11_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_19&#39;)"><span class="hl_varref"><span class="mpre">firstDay</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">

</span><a href="#loc_87_1_87_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_25&#39;)"><span class="mpre">fromMondayStartWeekValid</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Year.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Monday-starting week number.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Day of week. </span></span><span class="mpre">
                               </span><span class="hl_comment"><span class="mpre">-- Monday is 1, Sunday is 7 (as \&quot;%u\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_87_1_87_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_25&#39;)"><span class="hl_fundecl"><span class="mpre">fromMondayStartWeekValid</span></span></a><span class="mpre"> </span><a name="loc_87_26_87_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_26_87_30&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> </span><a name="loc_87_31_87_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_31_87_32&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_87_33_87_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_33_87_34&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = do
        </span><a name="loc_88_9_88_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_9_88_11&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Calendar.Private.html#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">clipValid</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><a href="#loc_87_33_87_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_33_87_34&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- first day of the year</span></span><span class="mpre">
        let </span><a name="loc_90_13_90_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_21&#39;)"><span class="hl_vardecl"><span class="mpre">firstDay</span></span></a><span class="mpre"> = </span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> (</span><a href="#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_87_26_87_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_26_87_30&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><span class="hl_comment"><span class="mpre">-- 0-based year day of first monday of the year</span></span><span class="mpre">
        let </span><a name="loc_92_13_92_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_13_92_24&#39;)"><span class="hl_vardecl"><span class="mpre">firstMonday</span></span></a><span class="mpre"> = (</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_90_13_90_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_21&#39;)"><span class="hl_varref"><span class="mpre">firstDay</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">
        let </span><a name="loc_93_13_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_15&#39;)"><span class="hl_vardecl"><span class="mpre">yd</span></span></a><span class="mpre"> = </span><a href="#loc_92_13_92_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_13_92_24&#39;)"><span class="hl_varref"><span class="mpre">firstMonday</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> (</span><a href="#loc_87_31_87_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_31_87_32&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><a href="#loc_88_9_88_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_9_88_11&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">
        </span><a name="loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_vardecl"><span class="mpre">yd&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Calendar.Private.html#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">clipValid</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (if </span><a href="#loc_46_1_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_11&#39;)"><span class="hl_varref"><span class="mpre">isLeapYear</span></span></a><span class="mpre"> </span><a href="#loc_87_26_87_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_26_87_30&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">366</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><a href="#loc_93_13_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_15&#39;)"><span class="hl_varref"><span class="mpre">yd</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> (</span><a href="#loc_90_13_90_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_21&#39;)"><span class="hl_varref"><span class="mpre">firstDay</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_varref"><span class="mpre">yd&#39;</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | The inverse of &#39;sundayStartWeek&#39;. Get a &#39;Day&#39; given the year and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the number of the day of a Sunday-starting week.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The first Sunday is the first day of week 1, any earlier days in the </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- year are week 0 (as \&quot;%U\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
</span><a href="#loc_106_1_106_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_20&#39;)"><span class="mpre">fromSundayStartWeek</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Year.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Sunday-starting week number.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Day of week</span></span><span class="mpre">
                               </span><span class="hl_comment"><span class="mpre">-- Sunday is 0, Saturday is 6 (as \&quot;%w\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
                    -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_106_1_106_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_20&#39;)"><span class="hl_fundecl"><span class="mpre">fromSundayStartWeek</span></span></a><span class="mpre"> </span><a name="loc_106_21_106_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_21_106_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_106_23_106_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_24&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_106_25_106_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_25_106_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> (</span><a href="#loc_109_11_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_19&#39;)"><span class="hl_varref"><span class="mpre">firstDay</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_107_11_107_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_11_107_13&#39;)"><span class="hl_varref"><span class="mpre">yd</span></span></a><span class="mpre">)
    where </span><a name="loc_107_11_107_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_11_107_13&#39;)"><span class="hl_vardecl"><span class="mpre">yd</span></span></a><span class="mpre"> = </span><a href="#loc_111_11_111_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_22&#39;)"><span class="hl_varref"><span class="mpre">firstSunday</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> (</span><a href="#loc_106_23_106_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_24&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><a href="#loc_106_25_106_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_25_106_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- first day of the year</span></span><span class="mpre">
          </span><a name="loc_109_11_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_19&#39;)"><span class="hl_vardecl"><span class="mpre">firstDay</span></span></a><span class="mpre"> = </span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> (</span><a href="#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_106_21_106_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_21_106_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          </span><span class="hl_comment"><span class="mpre">-- 0-based year day of first sunday of the year</span></span><span class="mpre">
          </span><a name="loc_111_11_111_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_22&#39;)"><span class="hl_vardecl"><span class="mpre">firstSunday</span></span></a><span class="mpre"> = (</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_109_11_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_19&#39;)"><span class="hl_varref"><span class="mpre">firstDay</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">

</span><a href="#loc_118_1_118_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_25&#39;)"><span class="mpre">fromSundayStartWeekValid</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Year.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Monday-starting week number.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Day of week. </span></span><span class="mpre">
                               </span><span class="hl_comment"><span class="mpre">-- Monday is 1, Sunday is 7 (as \&quot;%u\&quot; in &#39;Data.Time.Format.formatTime&#39;).</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_118_1_118_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_25&#39;)"><span class="hl_fundecl"><span class="mpre">fromSundayStartWeekValid</span></span></a><span class="mpre"> </span><a name="loc_118_26_118_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_26_118_30&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> </span><a name="loc_118_31_118_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_31_118_32&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_118_33_118_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_33_118_34&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = do
        </span><a name="loc_119_9_119_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_11&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Calendar.Private.html#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">clipValid</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><a href="#loc_118_33_118_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_33_118_34&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- first day of the year</span></span><span class="mpre">
        let </span><a name="loc_121_13_121_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_13_121_21&#39;)"><span class="hl_vardecl"><span class="mpre">firstDay</span></span></a><span class="mpre"> = </span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> (</span><a href="#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">fromOrdinalDate</span></span></a><span class="mpre"> </span><a href="#loc_118_26_118_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_26_118_30&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><span class="hl_comment"><span class="mpre">-- 0-based year day of first sunday of the year</span></span><span class="mpre">
        let </span><a name="loc_123_13_123_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_24&#39;)"><span class="hl_vardecl"><span class="mpre">firstMonday</span></span></a><span class="mpre"> = (</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_121_13_121_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_13_121_21&#39;)"><span class="hl_varref"><span class="mpre">firstDay</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">
        let </span><a name="loc_124_13_124_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_13_124_15&#39;)"><span class="hl_vardecl"><span class="mpre">yd</span></span></a><span class="mpre"> = </span><a href="#loc_123_13_123_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_24&#39;)"><span class="hl_varref"><span class="mpre">firstMonday</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> (</span><a href="#loc_118_31_118_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_31_118_32&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><a href="#loc_119_9_119_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_11&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">
        </span><a name="loc_125_9_125_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_9_125_12&#39;)"><span class="hl_vardecl"><span class="mpre">yd&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Calendar.Private.html#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">clipValid</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (if </span><a href="#loc_46_1_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_11&#39;)"><span class="hl_varref"><span class="mpre">isLeapYear</span></span></a><span class="mpre"> </span><a href="#loc_118_26_118_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_26_118_30&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">366</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><a href="#loc_124_13_124_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_13_124_15&#39;)"><span class="hl_varref"><span class="mpre">yd</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> (</span><a href="#loc_121_13_121_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_13_121_21&#39;)"><span class="hl_varref"><span class="mpre">firstDay</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_125_9_125_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_9_125_12&#39;)"><span class="hl_varref"><span class="mpre">yd&#39;</span></span></a><span class="mpre">))

</span></div></body></html>