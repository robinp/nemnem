<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RecordWildCards #-}
{-# LANGUAGE OverloadedStrings #-}
module Network.HTTP.Client.Body
    ( makeChunkedReader
    , makeLengthReader
    , makeGzipReader
    , makeUnlimitedReader
    , brConsume
    , brEmpty
    , brAddCleanup
    , brReadSome
    , brRead
    ) where

import Network.HTTP.Client.Connection
import Network.HTTP.Client.Types
import Control.Exception (</span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="mpre">throwIO</span></a><span class="mpre">, assert)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Body.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString, empty, uncons)
import Data.IORef
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Body.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 18, srcSpanEndLine = 20, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Body.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 18, srcSpanEndLine = 21, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import Control.Monad (</span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="mpre">unless</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import qualified Data.Streaming.Zlib as Z

</span><span class="hl_comment"><span class="mpre">-- ^ Get a single chunk of data from the response body, or an empty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bytestring if no more data is available.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 0.1.0</span></span><span class="mpre">
</span><a href="#loc_30_1_30_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_7&#39;)"><span class="mpre">brRead</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_30_1_30_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_7&#39;)"><span class="hl_vardecl"><span class="mpre">brRead</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

</span><a href="#loc_33_1_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_11&#39;)"><span class="mpre">brReadSome</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_33_1_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_11&#39;)"><span class="hl_fundecl"><span class="mpre">brReadSome</span></span></a><span class="mpre"> </span><a name="loc_33_12_33_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_18&#39;)"><span class="hl_vardecl"><span class="mpre">brRead</span></span></a><span class="mpre"> =
    </span><a href="#loc_36_5_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_5_36_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
  where
    </span><a name="loc_36_5_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_5_36_9&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_36_10_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_15&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> </span><a name="loc_36_16_36_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_16_36_19&#39;)"><span class="hl_vardecl"><span class="mpre">rem</span></span></a><span class="mpre">
        | </span><a href="#loc_36_16_36_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_16_36_19&#39;)"><span class="hl_varref"><span class="mpre">rem</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_36_10_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_15&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
            </span><a name="loc_39_13_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_33_12_33_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_18&#39;)"><span class="hl_varref"><span class="mpre">brRead</span></span></a><span class="mpre">
            if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_39_13_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_36_10_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_15&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> []
                else </span><a href="#loc_36_5_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_5_36_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_36_10_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_15&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_39_13_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) (</span><a href="#loc_36_16_36_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_16_36_19&#39;)"><span class="hl_varref"><span class="mpre">rem</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_39_13_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)

</span><a href="#loc_45_1_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_8&#39;)"><span class="mpre">brEmpty</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre">
</span><a name="loc_45_1_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_8&#39;)"><span class="hl_vardecl"><span class="mpre">brEmpty</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">

</span><a href="#loc_48_1_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_13&#39;)"><span class="mpre">brAddCleanup</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre">
</span><a name="loc_48_1_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_13&#39;)"><span class="hl_fundecl"><span class="mpre">brAddCleanup</span></span></a><span class="mpre"> </span><a name="loc_48_14_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_21&#39;)"><span class="hl_vardecl"><span class="mpre">cleanup</span></span></a><span class="mpre"> </span><a name="loc_48_22_48_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_22_48_28&#39;)"><span class="hl_vardecl"><span class="mpre">brRead</span></span></a><span class="mpre"> = do
    </span><a name="loc_49_5_49_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_7&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_48_22_48_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_22_48_28&#39;)"><span class="hl_varref"><span class="mpre">brRead</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_49_5_49_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a href="#loc_48_14_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_21&#39;)"><span class="hl_varref"><span class="mpre">cleanup</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_49_5_49_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Strictly consume all remaining chunks of data from the stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 0.1.0</span></span><span class="mpre">
</span><a href="#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_10&#39;)"><span class="mpre">brConsume</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
</span><a name="loc_57_1_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_10&#39;)"><span class="hl_fundecl"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a name="loc_57_11_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_17&#39;)"><span class="hl_vardecl"><span class="mpre">brRead</span></span></a><span class="mpre"> =
    </span><a href="#loc_60_5_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
  where
    </span><a name="loc_60_5_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_60_8_60_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_8_60_13&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> = do
        </span><a name="loc_61_9_61_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_57_11_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_17&#39;)"><span class="hl_varref"><span class="mpre">brRead</span></span></a><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_61_9_61_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_60_8_60_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_8_60_13&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> []
            else </span><a href="#loc_60_5_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_60_8_60_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_8_60_13&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_61_9_61_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">))

</span><a href="#loc_67_1_67_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_15&#39;)"><span class="mpre">makeGzipReader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre">
</span><a name="loc_67_1_67_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_15&#39;)"><span class="hl_fundecl"><span class="mpre">makeGzipReader</span></span></a><span class="mpre"> </span><a name="loc_67_16_67_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_16_67_22&#39;)"><span class="hl_vardecl"><span class="mpre">brRead</span></span></a><span class="mpre"> = do
    </span><a name="loc_68_5_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_8&#39;)"><span class="hl_vardecl"><span class="mpre">inf</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Streaming.Zlib.html#loc_103_1_103_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Streaming.Zlib.html#loc_103_1_103_12&#39;)"><span class="hl_varref"><span class="mpre">Z.initInflate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Z.WindowBits</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">
    </span><a name="loc_69_5_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_11&#39;)"><span class="hl_vardecl"><span class="mpre">istate</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    let </span><a name="loc_70_9_70_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_17&#39;)"><span class="hl_fundecl"><span class="mpre">goPopper</span></span></a><span class="mpre"> </span><a name="loc_70_18_70_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_24&#39;)"><span class="hl_vardecl"><span class="mpre">popper</span></span></a><span class="mpre"> = do
            </span><a name="loc_71_13_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_16&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_70_18_70_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_24&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre">
            case </span><a href="#loc_71_13_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_16&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> of
                </span><a href="Data.Streaming.Zlib.html#loc_195_18_195_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Streaming.Zlib.html#loc_195_18_195_24&#39;)"><span class="hl_conref"><span class="mpre">Z.PRNext</span></span></a><span class="mpre"> </span><a name="loc_73_26_73_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_26_73_28&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> -&gt; do
                    </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_69_5_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_11&#39;)"><span class="hl_varref"><span class="mpre">istate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_70_18_70_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_24&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_73_26_73_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_26_73_28&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                </span><a href="Data.Streaming.Zlib.html#loc_194_18_194_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Streaming.Zlib.html#loc_194_18_194_24&#39;)"><span class="hl_conref"><span class="mpre">Z.PRDone</span></span></a><span class="mpre"> -&gt; do
                    </span><a name="loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Streaming.Zlib.html#loc_248_1_248_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Streaming.Zlib.html#loc_248_1_248_13&#39;)"><span class="hl_varref"><span class="mpre">Z.flushInflate</span></span></a><span class="mpre"> </span><a href="#loc_68_5_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_8&#39;)"><span class="hl_varref"><span class="mpre">inf</span></span></a><span class="mpre">
                    if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                        then </span><a href="#loc_84_9_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_14&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre">
                        else do
                            </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_69_5_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_11&#39;)"><span class="hl_varref"><span class="mpre">istate</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                </span><a href="Data.Streaming.Zlib.html#loc_196_18_196_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Streaming.Zlib.html#loc_196_18_196_25&#39;)"><span class="hl_conref"><span class="mpre">Z.PRError</span></span></a><span class="mpre"> </span><a name="loc_83_27_83_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_27_83_28&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_106_22_106_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_106_22_106_39&#39;)"><span class="hl_conref"><span class="mpre">HttpZlibException</span></span></a><span class="mpre"> </span><a href="#loc_83_27_83_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_27_83_28&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
        </span><a name="loc_84_9_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_14&#39;)"><span class="hl_vardecl"><span class="mpre">start</span></span></a><span class="mpre"> = do
            </span><a name="loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_67_16_67_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_16_67_22&#39;)"><span class="hl_varref"><span class="mpre">brRead</span></span></a><span class="mpre">
            if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
                else do
                    </span><a name="loc_89_21_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_21_89_27&#39;)"><span class="hl_vardecl"><span class="mpre">popper</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Streaming.Zlib.html#loc_174_1_174_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Streaming.Zlib.html#loc_174_1_174_12&#39;)"><span class="hl_varref"><span class="mpre">Z.feedInflate</span></span></a><span class="mpre"> </span><a href="#loc_68_5_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_8&#39;)"><span class="hl_varref"><span class="mpre">inf</span></span></a><span class="mpre"> </span><a href="#loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    </span><a href="#loc_70_9_70_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_17&#39;)"><span class="hl_varref"><span class="mpre">goPopper</span></span></a><span class="mpre"> </span><a href="#loc_89_21_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_21_89_27&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_92_9_92_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_14&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_69_5_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_11&#39;)"><span class="hl_varref"><span class="mpre">istate</span></span></a><span class="mpre">
        case </span><a href="#loc_92_9_92_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_14&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_84_9_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_14&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_95_18_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_18_95_24&#39;)"><span class="hl_vardecl"><span class="mpre">popper</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_70_9_70_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_17&#39;)"><span class="hl_varref"><span class="mpre">goPopper</span></span></a><span class="mpre"> </span><a href="#loc_95_18_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_18_95_24&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre">

</span><a href="#loc_98_1_98_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_20&#39;)"><span class="mpre">makeUnlimitedReader</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre">
</span><a name="loc_98_1_98_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_20&#39;)"><span class="hl_fundecl"><span class="mpre">makeUnlimitedReader</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Body.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 21, srcSpanEndLine = 98, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Body.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 32, srcSpanEndLine = 98, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client"><span class="mpre">Connection {..}</span></span><span class="mpre"> = do
    </span><a name="loc_99_5_99_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_14&#39;)"><span class="hl_vardecl"><span class="mpre">icomplete</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Types.html#loc_64_7_64_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_64_7_64_21&#39;)"><span class="hl_varref"><span class="mpre">connectionRead</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_99_5_99_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_14&#39;)"><span class="hl_varref"><span class="mpre">icomplete</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_106_1_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_17&#39;)"><span class="mpre">makeLengthReader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre">
</span><a name="loc_106_1_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_17&#39;)"><span class="hl_fundecl"><span class="mpre">makeLengthReader</span></span></a><span class="mpre"> </span><a name="loc_106_18_106_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_18_106_24&#39;)"><span class="hl_vardecl"><span class="mpre">count0</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Body.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 25, srcSpanEndLine = 106, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Body.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 36, srcSpanEndLine = 106, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Cl"><span class="mpre">Connection {..}</span></span><span class="mpre"> = do
    </span><a name="loc_107_5_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_5_107_11&#39;)"><span class="hl_vardecl"><span class="mpre">icount</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_106_18_106_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_18_106_24&#39;)"><span class="hl_varref"><span class="mpre">count0</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_109_9_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_14&#39;)"><span class="hl_vardecl"><span class="mpre">count</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_107_5_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_5_107_11&#39;)"><span class="hl_varref"><span class="mpre">icount</span></span></a><span class="mpre">
        if </span><a href="#loc_109_9_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_14&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">empty</span></span><span class="mpre">
            else do
                </span><a name="loc_113_17_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Types.html#loc_64_7_64_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_64_7_64_21&#39;)"><span class="hl_varref"><span class="mpre">connectionRead</span></span></a><span class="mpre">
                </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_113_17_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_96_22_96_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_96_22_96_42&#39;)"><span class="hl_conref"><span class="mpre">ResponseBodyTooShort</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_106_18_106_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_18_106_24&#39;)"><span class="hl_varref"><span class="mpre">count0</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_106_18_106_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_18_106_24&#39;)"><span class="hl_varref"><span class="mpre">count0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_109_9_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_14&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre">)
                case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_109_9_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_14&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_113_17_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; do
                        let (</span><a name="loc_117_30_117_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_30_117_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_117_33_117_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_34&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> </span><a href="#loc_109_9_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_14&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><a href="#loc_113_17_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                        </span><a href="Network.HTTP.Client.Types.html#loc_66_7_66_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_66_7_66_23&#39;)"><span class="hl_varref"><span class="mpre">connectionUnread</span></span></a><span class="mpre"> </span><a href="#loc_117_33_117_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_34&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_107_5_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_5_107_11&#39;)"><span class="hl_varref"><span class="mpre">icount</span></span></a><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_117_30_117_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_30_117_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                    </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; do
                        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_107_5_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_5_107_11&#39;)"><span class="hl_varref"><span class="mpre">icount</span></span></a><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_113_17_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; do
                        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_107_5_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_5_107_11&#39;)"><span class="hl_varref"><span class="mpre">icount</span></span></a><span class="mpre"> (</span><a href="#loc_109_9_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_14&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_113_17_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
                        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_113_17_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_131_1_131_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_18&#39;)"><span class="mpre">makeChunkedReader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ raw</span></span><span class="mpre">
                  -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre">
</span><a name="loc_131_1_131_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_18&#39;)"><span class="hl_fundecl"><span class="mpre">makeChunkedReader</span></span></a><span class="mpre"> </span><a name="loc_131_19_131_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_19_131_22&#39;)"><span class="hl_vardecl"><span class="mpre">raw</span></span></a><span class="mpre"> </span><a name="loc_131_23_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_23_131_27&#39;)"><span class="hl_specname"><span class="mpre">conn</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Body.hs&quot;, srcSpanStartLine = 131, srcSpanStartColumn = 28, srcSpanEndLine = 131, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Body.hs&quot;, srcSpanStartLine = 131, srcSpanStartColumn = 39, srcSpanEndLine = 131, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Cl"><span class="mpre">Connection {..}</span></span><span class="mpre"> = do
    </span><a name="loc_132_5_132_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_11&#39;)"><span class="hl_vardecl"><span class="mpre">icount</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_135_5_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_132_5_132_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_11&#39;)"><span class="hl_varref"><span class="mpre">icount</span></span></a><span class="mpre">
  where
    </span><a name="loc_135_5_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_135_8_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_8_135_14&#39;)"><span class="hl_vardecl"><span class="mpre">icount</span></span></a><span class="mpre"> = do
        </span><a name="loc_136_9_136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_9_136_15&#39;)"><span class="hl_vardecl"><span class="mpre">count0</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_135_8_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_8_135_14&#39;)"><span class="hl_varref"><span class="mpre">icount</span></span></a><span class="mpre">
        (</span><a name="loc_137_10_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_10_137_18&#39;)"><span class="hl_vardecl"><span class="mpre">rawCount</span></span></a><span class="mpre">, </span><a name="loc_137_20_137_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_25&#39;)"><span class="hl_vardecl"><span class="mpre">count</span></span></a><span class="mpre">) &lt;-
            if </span><a href="#loc_136_9_136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_9_136_15&#39;)"><span class="hl_varref"><span class="mpre">count0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                then </span><a href="#loc_177_5_177_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_5_177_15&#39;)"><span class="hl_varref"><span class="mpre">readHeader</span></span></a><span class="mpre">
                else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">empty</span></span><span class="mpre">, </span><a href="#loc_136_9_136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_9_136_15&#39;)"><span class="hl_varref"><span class="mpre">count0</span></span></a><span class="mpre">)
        if </span><a href="#loc_137_20_137_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_25&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
            then do
                </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_135_8_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_8_135_14&#39;)"><span class="hl_varref"><span class="mpre">icount</span></span></a><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_137_20_137_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_25&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_131_19_131_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_19_131_22&#39;)"><span class="hl_varref"><span class="mpre">raw</span></span></a><span class="mpre"> then </span><a href="#loc_137_10_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_10_137_18&#39;)"><span class="hl_varref"><span class="mpre">rawCount</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">empty</span></span><span class="mpre">
            else do
                (</span><a name="loc_146_18_146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_20&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">, </span><a name="loc_146_22_146_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_22_146_28&#39;)"><span class="hl_vardecl"><span class="mpre">count&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_154_5_154_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_5_154_14&#39;)"><span class="hl_varref"><span class="mpre">readChunk</span></span></a><span class="mpre"> </span><a href="#loc_137_20_137_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_25&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre">
                </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_135_8_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_8_135_14&#39;)"><span class="hl_varref"><span class="mpre">icount</span></span></a><span class="mpre"> </span><a href="#loc_146_22_146_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_22_146_28&#39;)"><span class="hl_varref"><span class="mpre">count&#39;</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_150_5_150_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_5_150_17&#39;)"><span class="hl_varref"><span class="mpre">appendHeader</span></span></a><span class="mpre"> </span><a href="#loc_137_10_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_10_137_18&#39;)"><span class="hl_varref"><span class="mpre">rawCount</span></span></a><span class="mpre"> </span><a href="#loc_146_18_146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_20&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

    </span><a name="loc_150_5_150_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_5_150_17&#39;)"><span class="hl_vardecl"><span class="mpre">appendHeader</span></span></a><span class="mpre">
      | </span><a href="#loc_131_19_131_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_19_131_22&#39;)"><span class="hl_varref"><span class="mpre">raw</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.append</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre">

    </span><a name="loc_154_5_154_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_5_154_14&#39;)"><span class="hl_fundecl"><span class="mpre">readChunk</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">empty</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
    </span><a href="#loc_154_5_154_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_5_154_14&#39;)"><span class="hl_fundecl"><span class="mpre">readChunk</span></span></a><span class="mpre"> </span><a name="loc_155_15_155_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_15_155_24&#39;)"><span class="hl_vardecl"><span class="mpre">remainder</span></span></a><span class="mpre"> = do
        </span><a name="loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Types.html#loc_64_7_64_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_64_7_64_21&#39;)"><span class="hl_varref"><span class="mpre">connectionRead</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_100_22_100_41" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_100_22_100_41&#39;)"><span class="hl_conref"><span class="mpre">InvalidChunkHeaders</span></span></a><span class="mpre">
        case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_155_15_155_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_15_155_24&#39;)"><span class="hl_varref"><span class="mpre">remainder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; do
                let (</span><a name="loc_160_22_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_22_160_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_160_25_160_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_25_160_26&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> </span><a href="#loc_155_15_155_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_15_155_24&#39;)"><span class="hl_varref"><span class="mpre">remainder</span></span></a><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_160_25_160_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_25_160_26&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_66_7_66_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_66_7_66_23&#39;)"><span class="hl_varref"><span class="mpre">connectionUnread</span></span></a><span class="mpre"> </span><a href="#loc_160_25_160_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_25_160_26&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                </span><a href="#loc_173_5_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_19&#39;)"><span class="hl_varref"><span class="mpre">requireNewline</span></span></a><span class="mpre">
                </span><a href="#loc_169_9_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_13&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="#loc_160_22_160_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_22_160_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; do
                </span><a href="#loc_173_5_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_19&#39;)"><span class="hl_varref"><span class="mpre">requireNewline</span></span></a><span class="mpre">
                </span><a href="#loc_169_9_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_13&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">, </span><a href="#loc_155_15_155_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_15_155_24&#39;)"><span class="hl_varref"><span class="mpre">remainder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
      where
        </span><a name="loc_169_9_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_13&#39;)"><span class="hl_fundecl"><span class="mpre">done</span></span></a><span class="mpre"> </span><a name="loc_169_14_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">
          | </span><a href="#loc_131_19_131_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_19_131_22&#39;)"><span class="hl_varref"><span class="mpre">raw</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_169_14_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`S.append`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_169_14_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

    </span><a name="loc_173_5_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_19&#39;)"><span class="hl_vardecl"><span class="mpre">requireNewline</span></span></a><span class="mpre"> = do
        </span><a name="loc_174_9_174_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_27_1_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_27_1_27_19&#39;)"><span class="hl_varref"><span class="mpre">connectionReadLine</span></span></a><span class="mpre"> </span><a href="#loc_131_23_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_23_131_27&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_174_9_174_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_100_22_100_41" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_100_22_100_41&#39;)"><span class="hl_conref"><span class="mpre">InvalidChunkHeaders</span></span></a><span class="mpre">

    </span><a name="loc_177_5_177_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_5_177_15&#39;)"><span class="hl_vardecl"><span class="mpre">readHeader</span></span></a><span class="mpre"> = do
        </span><a name="loc_178_9_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_27_1_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_27_1_27_19&#39;)"><span class="hl_varref"><span class="mpre">connectionReadLine</span></span></a><span class="mpre"> </span><a href="#loc_131_23_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_23_131_27&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        case </span><a href="#loc_183_5_183_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_5_183_13&#39;)"><span class="hl_varref"><span class="mpre">parseHex</span></span></a><span class="mpre"> </span><a href="#loc_178_9_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_100_22_100_41" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_100_22_100_41&#39;)"><span class="hl_conref"><span class="mpre">InvalidChunkHeaders</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_181_18_181_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_18_181_21&#39;)"><span class="hl_vardecl"><span class="mpre">hex</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_178_9_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`S.append`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">, </span><a href="#loc_181_18_181_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_18_181_21&#39;)"><span class="hl_varref"><span class="mpre">hex</span></span></a><span class="mpre">)

    </span><a name="loc_183_5_183_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_5_183_13&#39;)"><span class="hl_fundecl"><span class="mpre">parseHex</span></span></a><span class="mpre"> </span><a name="loc_183_14_183_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_14_183_17&#39;)"><span class="hl_vardecl"><span class="mpre">bs0</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">uncons</span></span><span class="mpre"> </span><a href="#loc_183_14_183_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_14_183_17&#39;)"><span class="hl_varref"><span class="mpre">bs0</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_185_19_185_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_19_185_21&#39;)"><span class="hl_vardecl"><span class="mpre">w0</span></span></a><span class="mpre">, </span><a name="loc_185_23_185_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_23_185_26&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;</span></span></a><span class="mpre">)
                | </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_186_24_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_24_186_26&#39;)"><span class="hl_vardecl"><span class="mpre">i0</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_194_5_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_5_194_8&#39;)"><span class="hl_varref"><span class="mpre">toI</span></span></a><span class="mpre"> </span><a href="#loc_185_19_185_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_19_185_21&#39;)"><span class="hl_varref"><span class="mpre">w0</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_188_5_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_5_188_14&#39;)"><span class="hl_varref"><span class="mpre">parseHex&#39;</span></span></a><span class="mpre"> </span><a href="#loc_186_24_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_24_186_26&#39;)"><span class="hl_varref"><span class="mpre">i0</span></span></a><span class="mpre"> </span><a href="#loc_185_23_185_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_23_185_26&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;</span></span></a><span class="mpre">
            _ -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a name="loc_188_5_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_5_188_14&#39;)"><span class="hl_fundecl"><span class="mpre">parseHex&#39;</span></span></a><span class="mpre"> </span><a name="loc_188_15_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_15_188_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_188_17_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_17_188_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">uncons</span></span><span class="mpre"> </span><a href="#loc_188_17_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_17_188_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_190_19_190_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_19_190_20&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">, </span><a name="loc_190_22_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_22_190_24&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">)
                | </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_191_24_191_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_24_191_26&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_194_5_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_5_194_8&#39;)"><span class="hl_varref"><span class="mpre">toI</span></span></a><span class="mpre"> </span><a href="#loc_190_19_190_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_19_190_20&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_188_5_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_5_188_14&#39;)"><span class="hl_varref"><span class="mpre">parseHex&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_188_15_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_15_188_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_191_24_191_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_24_191_26&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre">) </span><a href="#loc_190_22_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_22_190_24&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            _ -&gt; </span><a href="#loc_188_15_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_15_188_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

    </span><a name="loc_194_5_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_5_194_8&#39;)"><span class="hl_fundecl"><span class="mpre">toI</span></span></a><span class="mpre"> </span><a name="loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">
        | </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">57</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">
        | </span><span class="hl_num"><span class="mpre">65</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">70</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">55</span></span><span class="mpre">
        | </span><span class="hl_num"><span class="mpre">97</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">102</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">87</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span></div></body></html>