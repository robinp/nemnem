<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, MultiParamTypeClasses,
             FlexibleInstances, TypeSynonymInstances #-}
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Uses multi-param type classes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module QuickCheckUtils where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 8, srcSpanEndLine = 8, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre">
import Text.Show.Functions

import Control.Monad        ( </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="mpre">liftM2</span></a><span class="mpre"> )
import Control.Monad.Instances
import Data.Char
import Data.List
import Data.Word
import Data.Int
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 8, srcSpanEndLine = 17, srcSpanEndColumn = 21}, srcInfoPoints = []}) &quot;System.Random&quot;"><span class="mpre">System.Random</span></span><span class="mpre">
import System.IO
import Foreign.C (CChar)

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 18, srcSpanEndLine = 21, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">      as P
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 18, srcSpanEndLine = 22, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified Data.ByteString.Lazy.Internal as L (</span><a href="Data.ByteString.Lazy.Internal.html#loc_163_1_163_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_163_1_163_15&#39;)"><span class="mpre">checkInvariant</span></a><span class="mpre">,</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="mpre">ByteString</span></a><span class="mpre">(..))

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">      as PC
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre"> as LC

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_31_1_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_11&#39;)"><span class="mpre">adjustSize</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 15, srcSpanEndLine = 30, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 29, srcSpanEndLine = 30, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">Testable prop =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">prop</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Property</span></span><span class="mpre">
</span><a name="loc_31_1_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_11&#39;)"><span class="hl_fundecl"><span class="mpre">adjustSize</span></span></a><span class="mpre"> </span><a name="loc_31_12_31_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_12_31_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_31_14_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_14_31_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">sized</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_31_27_31_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_29&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">resize</span></span><span class="mpre"> (</span><a href="#loc_31_12_31_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_12_31_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_31_27_31_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_29&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">property</span></span><span class="mpre"> </span><a href="#loc_31_14_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_14_31_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-

-- HUGS needs: 

instance Functor ((-&gt;) r) where
        fmap = (.)

instance (Arbitrary a) =&gt; Arbitrary (Maybe a) where
  arbitrary            = sized arbMaybe
   where
    arbMaybe 0 = return Nothing
    arbMaybe n = fmap Just (resize (n-1) arbitrary)
  coarbitrary Nothing  = variant 0
  coarbitrary (Just x) = variant 1 . coarbitrary x

instance Monad ((-&gt;) r) where
        return = const
        f &gt;&gt;= k = \ r -&gt; k (f r) r

instance Functor ((,) a) where
        fmap f (x,y) = (x, f y)

instance Functor (Either a) where
        fmap _ (Left x) = Left x
        fmap f (Right y) = Right (f y)

-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="mpre">integralRandomR</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 20, srcSpanEndLine = 65, srcSpanEndColumn = 48}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 20, srcSpanEndLine = 65, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheck"><span class="mpre">(Integral a, RandomGen g) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="hl_fundecl"><span class="mpre">integralRandomR</span></span></a><span class="mpre">  (</span><a name="loc_66_19_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_19_66_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_66_21_66_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_21_66_22&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) </span><a name="loc_66_24_66_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_24_66_25&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">randomR</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_66_19_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_19_66_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,
                                         </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_66_21_66_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_21_66_22&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">) </span><a href="#loc_66_24_66_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_24_66_25&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> of
                            (</span><a name="loc_68_30_68_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_30_68_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_68_32_68_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_32_68_33&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_68_30_68_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_30_68_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_68_32_68_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_32_68_33&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Arbitrary</span></span><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> where
  </span><span class="hl_vardecl"><span class="mpre">arbitrary</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_163_1_163_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_163_1_163_15&#39;)"><span class="hl_varref"><span class="mpre">L.checkInvariant</span></span></a><span class="mpre">
                     </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre">
                     </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">P.null</span></span><span class="mpre">)  </span><span class="hl_comment"><span class="mpre">-- maintain the invariant.</span></span><span class="mpre">
                   </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">CoArbitrary</span></span><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">coarbitrary</span></span><span class="mpre"> </span><a name="loc_77_15_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">coarbitrary</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.unpack</span></span><span class="mpre"> </span><a href="#loc_77_15_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Arbitrary</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">P.ByteString</span></span><span class="mpre"> where
  </span><span class="hl_vardecl"><span class="mpre">arbitrary</span></span><span class="mpre"> = do
    </span><a name="loc_81_5_81_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_5_81_7&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">P.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre">
    </span><a name="loc_82_5_82_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_6&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">P.drop</span></span><span class="mpre"> </span><a href="#loc_82_5_82_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_81_5_81_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_5_81_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- to give us some with non-0 offset</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">CoArbitrary</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">P.ByteString</span></span><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">coarbitrary</span></span><span class="mpre"> </span><a name="loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">coarbitrary</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">P.unpack</span></span><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)


newtype </span><a name="loc_89_9_89_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_20&#39;)"><span class="hl_tycondecl"><span class="mpre">CByteString</span></span></a><span class="mpre"> = </span><a name="loc_89_23_89_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_23_89_34&#39;)"><span class="hl_condecl"><span class="mpre">CByteString</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">P.ByteString</span></span><span class="mpre">
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 3, srcSpanEndLine = 90, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 3, srcSpanEndLine = 90, srcSpanEndColumn = 11}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull"><span class="mpre">deriving Show</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Arbitrary</span></span><span class="mpre"> </span><a href="#loc_89_9_89_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_20&#39;)"><span class="hl_tyconref"><span class="mpre">CByteString</span></span></a><span class="mpre"> where
  </span><span class="hl_vardecl"><span class="mpre">arbitrary</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><a href="#loc_89_23_89_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_23_89_34&#39;)"><span class="hl_conref"><span class="mpre">CByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">P.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_96_7_96_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_16&#39;)"><span class="hl_varref"><span class="mpre">fromCChar</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre">
    where
      </span><a href="#loc_96_7_96_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_16&#39;)"><span class="mpre">fromCChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CChar</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
      </span><a name="loc_96_7_96_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_16&#39;)"><span class="hl_vardecl"><span class="mpre">fromCChar</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Arbitrary</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CChar</span></span><span class="mpre"> where
  </span><span class="hl_vardecl"><span class="mpre">arbitrary</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CChar</span></span><span class="mpre">)
            </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oneof</span></span><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">128</span></span><span class="mpre">,-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">), </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">127</span></span><span class="mpre">)]

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We&#39;re doing two forms of testing here. Firstly, model based testing.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For our Lazy and strict bytestring types, we have model types:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  i.e.    Lazy    ==   Byte</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--              \\      //</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 List </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- That is, the Lazy type can be modeled by functions in both the Byte</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and List type. For each of the 3 models, we have a set of tests that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- check those types match.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The Model class connects a type and its model type, via a conversion</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function. </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
class </span><a name="loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classdecl"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> where
  </span><a name="loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="mpre">model</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- get the abstract vale from a concrete value</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Connecting our Lazy and Strict types to their models. We also check</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the data invariant on Lazy types.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These instances represent the arrows in the above diagram</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">P</span></span><span class="mpre">      where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><a href="#loc_170_1_170_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_6&#39;)"><span class="hl_varref"><span class="mpre">abstr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_167_1_167_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_15&#39;)"><span class="hl_varref"><span class="mpre">checkInvariant</span></span></a><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">P</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">W</span></span><span class="mpre">]    where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">P.unpack</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">P</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">PC.unpack</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">W</span></span><span class="mpre">]    where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.unpack</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_167_1_167_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_15&#39;)"><span class="hl_varref"><span class="mpre">checkInvariant</span></span></a><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">LC.unpack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_167_1_167_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_15&#39;)"><span class="hl_varref"><span class="mpre">checkInvariant</span></span></a><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Types are trivially modeled by themselves</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">  </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">         where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">   </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">          where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">P</span></span><span class="mpre">     </span><span class="hl_tyconref"><span class="mpre">P</span></span><span class="mpre">            where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B</span></span><span class="mpre">     </span><span class="hl_tyconref"><span class="mpre">B</span></span><span class="mpre">            where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">        where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">        where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ordering</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ordering</span></span><span class="mpre">  where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">  where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">model</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- More structured types are modeled recursively, using the NatTrans class from Gofer.</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 7, srcSpanEndLine = 146, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 7, srcSpanEndLine = 146, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickChec"><span class="mpre">(Functor f, Functor g) =&gt;</span></span><span class="mpre"> </span><a name="loc_146_33_146_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_33_146_41&#39;)"><span class="hl_classdecl"><span class="mpre">NatTrans</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> where
    </span><a name="loc_147_5_147_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_8&#39;)"><span class="mpre">eta</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- The transformation of the same type is identity</span></span><span class="mpre">
instance </span><a href="#loc_146_33_146_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_33_146_41&#39;)"><span class="hl_classref"><span class="mpre">NatTrans</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">[]</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">[]</span></span><span class="mpre">             where </span><a href="#loc_147_5_147_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_8&#39;)"><span class="hl_vardecl"><span class="mpre">eta</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_146_33_146_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_33_146_41&#39;)"><span class="hl_classref"><span class="mpre">NatTrans</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre">       where </span><a href="#loc_147_5_147_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_8&#39;)"><span class="hl_vardecl"><span class="mpre">eta</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_146_33_146_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_33_146_41&#39;)"><span class="hl_classref"><span class="mpre">NatTrans</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">(-&gt;)</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">X</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">(-&gt;)</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">X</span></span><span class="mpre">) where </span><a href="#loc_147_5_147_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_8&#39;)"><span class="hl_vardecl"><span class="mpre">eta</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_146_33_146_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_33_146_41&#39;)"><span class="hl_classref"><span class="mpre">NatTrans</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">(-&gt;)</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">(-&gt;)</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">) where </span><a href="#loc_147_5_147_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_8&#39;)"><span class="hl_vardecl"><span class="mpre">eta</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

instance </span><a href="#loc_146_33_146_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_33_146_41&#39;)"><span class="hl_classref"><span class="mpre">NatTrans</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">(-&gt;)</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">W</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">(-&gt;)</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">W</span></span><span class="mpre">) where </span><a href="#loc_147_5_147_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_8&#39;)"><span class="hl_vardecl"><span class="mpre">eta</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- We have a transformation of pairs, if the pairs are in Model</span></span><span class="mpre">
instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 10, srcSpanEndLine = 158, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 20, srcSpanEndLine = 158, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">Model f g =&gt;</span></span><span class="mpre"> </span><a href="#loc_146_33_146_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_33_146_41&#39;)"><span class="hl_classref"><span class="mpre">NatTrans</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">(,)</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">(,)</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">) where </span><a href="#loc_147_5_147_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_8&#39;)"><span class="hl_fundecl"><span class="mpre">eta</span></span></a><span class="mpre"> (</span><a name="loc_158_59_158_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_59_158_60&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">,</span><a name="loc_158_61_158_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_61_158_62&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = (</span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> </span><a href="#loc_158_59_158_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_59_158_60&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><a href="#loc_158_61_158_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_61_158_62&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- And finally, we can take any (m a) to (n b), if we can Model m n, and a b</span></span><span class="mpre">
instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 10, srcSpanEndLine = 161, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 10, srcSpanEndLine = 161, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickC"><span class="mpre">(NatTrans m n, Model a b) =&gt;</span></span><span class="mpre"> </span><a href="#loc_119_7_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_12&#39;)"><span class="hl_classref"><span class="mpre">Model</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) (</span><span class="hl_tyvar"><span class="mpre">n</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) where </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">model</span></span></a><span class="mpre"> </span><a name="loc_161_69_161_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_69_161_70&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> (</span><a href="#loc_147_5_147_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_8&#39;)"><span class="hl_varref"><span class="mpre">eta</span></span></a><span class="mpre"> </span><a href="#loc_161_69_161_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_69_161_70&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- In a form more useful for QC testing (and it&#39;s lazy)</span></span><span class="mpre">
</span><a href="#loc_167_1_167_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_15&#39;)"><span class="mpre">checkInvariant</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">
</span><a name="loc_167_1_167_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_15&#39;)"><span class="hl_vardecl"><span class="mpre">checkInvariant</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Lazy.Internal.html#loc_163_1_163_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_163_1_163_15&#39;)"><span class="hl_varref"><span class="mpre">L.checkInvariant</span></span></a><span class="mpre">

</span><a href="#loc_170_1_170_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_6&#39;)"><span class="mpre">abstr</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">P.ByteString</span></span><span class="mpre">
</span><a name="loc_170_1_170_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_6&#39;)"><span class="hl_vardecl"><span class="mpre">abstr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">P.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> 

</span><span class="hl_comment"><span class="mpre">-- Some short hand.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 1, srcSpanEndLine = 173, srcSpanEndColumn = 13}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 1, srcSpanEndLine = 173, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickChe"><span class="mpre">type X = Int</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 1, srcSpanEndLine = 174, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 1, srcSpanEndLine = 174, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickChe"><span class="mpre">type W = Word8</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 175, srcSpanStartColumn = 1, srcSpanEndLine = 175, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 175, srcSpanStartColumn = 1, srcSpanEndLine = 175, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickChe"><span class="mpre">type P = P.ByteString</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 1, srcSpanEndLine = 176, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickCheckUtils.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 1, srcSpanEndLine = 176, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/QuickChe"><span class="mpre">type B = L.ByteString</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These comparison functions handle wrapping and equality.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A single class for these would be nice, but note that they differe in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the number of arguments, and those argument types, so we&#39;d need HList</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- tricks. See here: http://okmij.org/ftp/Haskell/vararg-fn.lhs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><a name="loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_fundecl"><span class="mpre">eq1</span></span></a><span class="mpre"> </span><a name="loc_187_5_187_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_187_7_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_7_187_8&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = \</span><a name="loc_187_12_187_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_12_187_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">         -&gt;
    </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> (</span><a href="#loc_187_5_187_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_187_12_187_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_12_187_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)         </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_187_7_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_7_187_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> </span><a href="#loc_187_12_187_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_12_187_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
</span><a name="loc_189_1_189_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_4&#39;)"><span class="hl_fundecl"><span class="mpre">eq2</span></span></a><span class="mpre"> </span><a name="loc_189_5_189_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_5_189_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_189_7_189_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_7_189_8&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = \</span><a name="loc_189_12_189_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_12_189_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_189_14_189_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_14_189_15&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">       -&gt;
    </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> (</span><a href="#loc_189_5_189_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_5_189_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_189_12_189_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_12_189_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_189_14_189_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_14_189_15&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)       </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_189_7_189_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_7_189_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> </span><a href="#loc_189_12_189_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_12_189_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) (</span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> </span><a href="#loc_189_14_189_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_14_189_15&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
</span><a name="loc_191_1_191_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_1_191_4&#39;)"><span class="hl_fundecl"><span class="mpre">eq3</span></span></a><span class="mpre"> </span><a name="loc_191_5_191_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_5_191_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_191_7_191_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_7_191_8&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = \</span><a name="loc_191_12_191_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_12_191_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_191_14_191_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_14_191_15&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_191_16_191_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_16_191_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">     -&gt;
    </span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> (</span><a href="#loc_191_5_191_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_5_191_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_191_12_191_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_12_191_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_191_14_191_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_14_191_15&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_191_16_191_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_16_191_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)     </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_191_7_191_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_7_191_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> </span><a href="#loc_191_12_191_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_12_191_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) (</span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> </span><a href="#loc_191_14_191_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_14_191_15&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) (</span><a href="#loc_120_3_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_3_120_8&#39;)"><span class="hl_varref"><span class="mpre">model</span></span></a><span class="mpre"> </span><a href="#loc_191_16_191_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_16_191_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- And for functions that take non-null input</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a name="loc_197_1_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_11&#39;)"><span class="hl_fundecl"><span class="mpre">eqnotnull1</span></span></a><span class="mpre"> </span><a name="loc_197_12_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_12_197_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_197_14_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_14_197_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = \</span><a name="loc_197_19_197_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_19_197_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">     -&gt; (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_201_36_201_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_36_201_42&#39;)"><span class="hl_varref"><span class="mpre">isNull</span></span></a><span class="mpre"> </span><a href="#loc_197_19_197_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_19_197_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">==&gt;</span></span><span class="mpre"> </span><a href="#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_varref"><span class="mpre">eq1</span></span></a><span class="mpre"> </span><a href="#loc_197_12_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_12_197_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_197_14_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_14_197_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_197_19_197_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_19_197_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a name="loc_198_1_198_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_11&#39;)"><span class="hl_fundecl"><span class="mpre">eqnotnull2</span></span></a><span class="mpre"> </span><a name="loc_198_12_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_12_198_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_198_14_198_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_14_198_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = \</span><a name="loc_198_19_198_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_19_198_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_198_21_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">   -&gt; (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_201_36_201_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_36_201_42&#39;)"><span class="hl_varref"><span class="mpre">isNull</span></span></a><span class="mpre"> </span><a href="#loc_198_21_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">==&gt;</span></span><span class="mpre"> </span><a href="#loc_189_1_189_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_4&#39;)"><span class="hl_varref"><span class="mpre">eq2</span></span></a><span class="mpre"> </span><a href="#loc_198_12_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_12_198_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_198_14_198_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_14_198_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_198_19_198_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_19_198_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_198_21_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
</span><a name="loc_199_1_199_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_11&#39;)"><span class="hl_fundecl"><span class="mpre">eqnotnull3</span></span></a><span class="mpre"> </span><a name="loc_199_12_199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_12_199_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_199_14_199_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_14_199_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = \</span><a name="loc_199_19_199_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_19_199_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_199_21_199_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_21_199_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_199_23_199_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_23_199_24&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_201_36_201_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_36_201_42&#39;)"><span class="hl_varref"><span class="mpre">isNull</span></span></a><span class="mpre"> </span><a href="#loc_199_23_199_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_23_199_24&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">==&gt;</span></span><span class="mpre"> </span><a href="#loc_191_1_191_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_1_191_4&#39;)"><span class="hl_varref"><span class="mpre">eq3</span></span></a><span class="mpre"> </span><a href="#loc_199_12_199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_12_199_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_199_14_199_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_14_199_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_199_19_199_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_19_199_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_199_21_199_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_21_199_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_199_23_199_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_23_199_24&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">

class    </span><a name="loc_201_10_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_10_201_16&#39;)"><span class="hl_classdecl"><span class="mpre">IsNull</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">            where </span><a name="loc_201_36_201_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_36_201_42&#39;)"><span class="mpre">isNull</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
instance </span><a href="#loc_201_10_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_10_201_16&#39;)"><span class="hl_classref"><span class="mpre">IsNull</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> where </span><a href="#loc_201_36_201_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_36_201_42&#39;)"><span class="hl_vardecl"><span class="mpre">isNull</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.null</span></span><span class="mpre">
instance </span><a href="#loc_201_10_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_10_201_16&#39;)"><span class="hl_classref"><span class="mpre">IsNull</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">P.ByteString</span></span><span class="mpre"> where </span><a href="#loc_201_36_201_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_36_201_42&#39;)"><span class="hl_vardecl"><span class="mpre">isNull</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">P.null</span></span><span class="mpre">
</span></div></body></html>