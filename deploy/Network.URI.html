<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Module      :  Network.URI</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Copyright   :  (c) 2004, Graham Klyne</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  License     :  BSD-style (see end of this file)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Maintainer  :  Graham Klyne &lt;gk@ninebynine.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Stability   :  provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  This module defines functions for handling URIs.  It presents substantially the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  same interface as the older GHC Network.URI module, but is implemented using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Parsec rather than a Regex library that is not available with Hugs.  The internal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  representation of URI has been changed so that URI strings are more</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  completely preserved when round-tripping to a URI value and back.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  In addition, four methods are provided for parsing different</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  kinds of URI string (as noted in RFC3986):</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      &#39;parseURI&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      &#39;parseURIReference&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      &#39;parseRelativeReference&#39; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      &#39;parseAbsoluteURI&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Further, four methods are provided for classifying different</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  kinds of URI string (as noted in RFC3986):</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      &#39;isURI&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      &#39;isURIReference&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      &#39;isRelativeReference&#39; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      &#39;isAbsoluteURI&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  The long-standing official reference for URI handling was RFC2396 [1],</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  as updated by RFC 2732 [2], but this was replaced by a new specification,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  RFC3986 [3] in January 2005.  This latter specification has been used</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  as the primary reference for constructing the URI parser implemented</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  here, and it is intended that there is a direct relationship between</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  the syntax definition in that document and this parser implementation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  RFC 1808 [4] contains a number of test cases for relative URI handling.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Dan Connolly&#39;s Python module @uripath.py@ [5] also contains useful details</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  and test cases.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Some of the code has been copied from the previous GHC implementation,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  but the parser is replaced with one that performs more complete</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  syntax checking of the URI itself, according to RFC3986 [3].</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  References</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (1) &lt;http://www.ietf.org/rfc/rfc2396.txt&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (2) &lt;http://www.ietf.org/rfc/rfc2732.txt&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (3) &lt;http://www.ietf.org/rfc/rfc3986.txt&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (4) &lt;http://www.ietf.org/rfc/rfc1808.txt&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (5) &lt;http://www.w3.org/2000/10/swap/uripath.py&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">

module Network.URI
    (
    </span><span class="hl_comment"><span class="mpre">-- * The URI type</span></span><span class="mpre">
      URI(..)
    , URIAuth(..)
    , nullURI

    </span><span class="hl_comment"><span class="mpre">-- * Parsing</span></span><span class="mpre">
    , parseURI
    , parseURIReference
    , parseRelativeReference
    , parseAbsoluteURI

    </span><span class="hl_comment"><span class="mpre">-- * Test for strings containing various kinds of URI</span></span><span class="mpre">
    , isURI
    , isURIReference
    , isRelativeReference
    , isAbsoluteURI
    , isIPv6address
    , isIPv4address

    </span><span class="hl_comment"><span class="mpre">-- * Predicates</span></span><span class="mpre">
    , uriIsAbsolute
    , uriIsRelative

    </span><span class="hl_comment"><span class="mpre">-- * Relative URIs</span></span><span class="mpre">
    , relativeTo
    , nonStrictRelativeTo
    , relativeFrom

    </span><span class="hl_comment"><span class="mpre">-- * Operations on URI strings</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | Support for putting strings into URI-friendly</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   escaped format and getting them back again.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   This can&#39;t be done transparently in all cases, because certain</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   characters have different meanings in different kinds of URI.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   The URI spec [3], section 2.4, indicates that all URI components</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   should be escaped before they are assembled as a URI:</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   \&quot;Once produced, a URI is always in its percent-encoded form\&quot;</span></span><span class="mpre">
    , uriToString
    , isReserved, isUnreserved
    , isAllowedInURI, isUnescapedInURI
    , isUnescapedInURIComponent
    , escapeURIChar
    , escapeURIString
    , unEscapeString

    </span><span class="hl_comment"><span class="mpre">-- * URI Normalization functions</span></span><span class="mpre">
    , normalizeCase
    , normalizeEscape
    , normalizePathSegments

    </span><span class="hl_comment"><span class="mpre">-- * Deprecated functions</span></span><span class="mpre">
    , parseabsoluteURI
    , escapeString
    , reserved, unreserved
    , scheme, authority, path, query, fragment
    ) where

import Text.ParserCombinators.Parsec
    ( GenParser, </span><a href="Text.Parsec.Error.html#loc_96_6_96_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Error.html#loc_96_6_96_16&#39;)"><span class="mpre">ParseError</span></a><span class="mpre">
    , </span><a href="Text.Parsec.Prim.html#loc_642_1_642_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_642_1_642_6&#39;)"><span class="mpre">parse</span></a><span class="mpre">, </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="mpre">(&lt;|&gt;)</span></a><span class="mpre">, </span><a href="Text.Parsec.Prim.html#loc_315_3_315_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_315_3_315_6&#39;)"><span class="mpre">(&lt;?&gt;)</span></a><span class="mpre">, </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="mpre">try</span></a><span class="mpre">
    , </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="mpre">option</span></a><span class="mpre">, </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="mpre">many</span></a><span class="mpre">, </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="mpre">many1</span></a><span class="mpre">, </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="mpre">count</span></a><span class="mpre">, </span><a href="Text.Parsec.Combinator.html#loc_257_1_257_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_257_1_257_14&#39;)"><span class="mpre">notFollowedBy</span></a><span class="mpre">
    , char, satisfy, oneOf, string, </span><a href="Text.Parsec.Combinator.html#loc_242_1_242_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_242_1_242_4&#39;)"><span class="mpre">eof</span></a><span class="mpre">
    , </span><a href="Text.Parsec.Prim.html#loc_98_1_98_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_98_1_98_11&#39;)"><span class="mpre">unexpected</span></a><span class="mpre">
    )

import Control.Monad (</span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="mpre">MonadPlus</span></a><span class="mpre">(..))
import Data.Char (ord, </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="mpre">chr</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_112_1_112_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_112_1_112_11&#39;)"><span class="mpre">isHexDigit</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_144_1_144_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_144_1_144_8&#39;)"><span class="mpre">toUpper</span></a><span class="mpre">, </span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="mpre">digitToInt</span></a><span class="mpre">)
import Data.Bits ((.|.),(.&amp;.),</span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">,</span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">)
import Debug.Trace (</span><a href="Debug.Trace.html#loc_103_1_103_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Debug.Trace.html#loc_103_1_103_6&#39;)"><span class="mpre">trace</span></a><span class="mpre">)
import Numeric (</span><a href="Numeric.html#loc_213_1_213_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Numeric.html#loc_213_1_213_14&#39;)"><span class="mpre">showIntAtBase</span></a><span class="mpre">)

import Data.Typeable (</span><a href="Data.Typeable.Internal.html#loc_196_7_196_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.Internal.html#loc_196_7_196_15&#39;)"><span class="mpre">Typeable</span></a><span class="mpre">)
#if MIN_VERSION_base(4,0,0)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 135, srcSpanStartColumn = 8, srcSpanEndLine = 135, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre"> (Data)
#else
import Data.Generics (Data)
#endif

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  The URI datatype</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Represents a general universal resource identifier using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  its component parts.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  For example, for the URI</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &gt;   foo://anonymous@www.haskell.org:42/ghc?query#frag</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  the components are:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tycondecl"><span class="mpre">URI</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">URI</span></span><span class="mpre">
    { </span><a name="loc_154_7_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_7_154_16&#39;)"><span class="hl_fielddecl"><span class="mpre">uriScheme</span></span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ @foo:@</span></span><span class="mpre">
    , </span><a name="loc_155_7_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_7_155_19&#39;)"><span class="hl_fielddecl"><span class="mpre">uriAuthority</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_162_6_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_6_162_13&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuth</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ @\/\/anonymous\@www.haskell.org:42@</span></span><span class="mpre">
    , </span><a name="loc_156_7_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_7_156_14&#39;)"><span class="hl_fielddecl"><span class="mpre">uriPath</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ @\/ghc@</span></span><span class="mpre">
    , </span><a name="loc_157_7_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_15&#39;)"><span class="hl_fielddecl"><span class="mpre">uriQuery</span></span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ @?query@</span></span><span class="mpre">
    , </span><a name="loc_158_7_158_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_7_158_18&#39;)"><span class="hl_fielddecl"><span class="mpre">uriFragment</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ @#frag@</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 159, srcSpanStartColumn = 7, srcSpanEndLine = 159, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 159, srcSpanStartColumn = 7, srcSpanEndLine = 159, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 159, srcS"><span class="mpre">deriving (Eq, Ord, Typeable, Data)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Type for authority value within a URI</span></span><span class="mpre">
data </span><a name="loc_162_6_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_6_162_13&#39;)"><span class="hl_tycondecl"><span class="mpre">URIAuth</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">URIAuth</span></span><span class="mpre">
    { </span><a name="loc_163_7_163_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_7_163_18&#39;)"><span class="hl_fielddecl"><span class="mpre">uriUserInfo</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ @anonymous\@@</span></span><span class="mpre">
    , </span><a name="loc_164_7_164_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_7_164_17&#39;)"><span class="hl_fielddecl"><span class="mpre">uriRegName</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ @www.haskell.org@</span></span><span class="mpre">
    , </span><a name="loc_165_7_165_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_7_165_14&#39;)"><span class="hl_fielddecl"><span class="mpre">uriPort</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ @:42@</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 7, srcSpanEndLine = 166, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 7, srcSpanEndLine = 166, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 166, srcS"><span class="mpre">deriving (Eq, Ord, Show, Typeable, Data)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Blank URI</span></span><span class="mpre">
</span><a href="#loc_170_1_170_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_8&#39;)"><span class="mpre">nullURI</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_170_1_170_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_8&#39;)"><span class="hl_vardecl"><span class="mpre">nullURI</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 170, srcSpanStartColumn = 11, srcSpanEndLine = 176, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 171, srcSpanStartColumn = 5, srcSpanEndLine = 171, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 172, srcS"><span class="mpre">URI
    { uriScheme     = &quot;&quot;
    , uriAuthority  = Nothing
    , uriPath       = &quot;&quot;
    , uriQuery      = &quot;&quot;
    , uriFragment   = &quot;&quot;
    }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  URI as instance of Show.  Note that for security reasons, the default</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  behaviour is to suppress any userinfo field (see RFC3986, section 7.5).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  This can be overridden by using uriToString directly with first</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  argument @id@ (noting that this returns a ShowS value rather than a string).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  [[[Another design would be to embed the userinfo mapping function in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  the URIAuth value, with the default value suppressing userinfo formatting,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  but providing a function to return a new URI value with userinfo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  data exposed by show.]]]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> _ = </span><a href="#loc_848_1_848_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_848_1_848_12&#39;)"><span class="hl_varref"><span class="mpre">uriToString</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_varref"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre">

</span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="mpre">defaultUserInfoMap</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_fundecl"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre"> </span><a name="loc_192_20_192_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_20_192_24&#39;)"><span class="hl_vardecl"><span class="mpre">uinf</span></span></a><span class="mpre"> = </span><a href="#loc_194_10_194_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_10_194_14&#39;)"><span class="hl_varref"><span class="mpre">user</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_195_9_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_16&#39;)"><span class="hl_varref"><span class="mpre">newpass</span></span></a><span class="mpre">
    where
        (</span><a name="loc_194_10_194_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_10_194_14&#39;)"><span class="hl_vardecl"><span class="mpre">user</span></span></a><span class="mpre">,</span><a name="loc_194_15_194_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_15_194_19&#39;)"><span class="hl_vardecl"><span class="mpre">pass</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">) </span><a href="#loc_192_20_192_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_20_192_24&#39;)"><span class="hl_varref"><span class="mpre">uinf</span></span></a><span class="mpre">
        </span><a name="loc_195_9_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_16&#39;)"><span class="hl_vardecl"><span class="mpre">newpass</span></span></a><span class="mpre">     = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_194_15_194_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_15_194_19&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><a href="#loc_194_15_194_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_15_194_19&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;@&quot;</span></span><span class="mpre">)
                                   </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><a href="#loc_194_15_194_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_15_194_19&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:@&quot;</span></span><span class="mpre">)
                        then </span><a href="#loc_194_15_194_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_15_194_19&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
                        else </span><span class="hl_string"><span class="mpre">&quot;:...@&quot;</span></span><span class="mpre">

</span><a href="#loc_201_1_201_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_23&#39;)"><span class="mpre">testDefaultUserInfoMap</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">]
</span><a name="loc_201_1_201_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_23&#39;)"><span class="hl_vardecl"><span class="mpre">testDefaultUserInfoMap</span></span></a><span class="mpre"> =
     [ </span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_varref"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">                </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
     , </span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_varref"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;@&quot;</span></span><span class="mpre">               </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;@&quot;</span></span><span class="mpre">
     , </span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_varref"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user@&quot;</span></span><span class="mpre">           </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user@&quot;</span></span><span class="mpre">
     , </span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_varref"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:@&quot;</span></span><span class="mpre">          </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:@&quot;</span></span><span class="mpre">
     , </span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_varref"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:anonymous@&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:...@&quot;</span></span><span class="mpre">
     , </span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_varref"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:pass@&quot;</span></span><span class="mpre">      </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:...@&quot;</span></span><span class="mpre">
     , </span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_varref"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:pass&quot;</span></span><span class="mpre">       </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:...@&quot;</span></span><span class="mpre">
     , </span><a href="#loc_192_1_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_19&#39;)"><span class="hl_varref"><span class="mpre">defaultUserInfoMap</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:anonymous&quot;</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user:...@&quot;</span></span><span class="mpre">
     ]

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Parse a URI</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Turn a string containing a URI into a &#39;URI&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Returns &#39;Nothing&#39; if the string is not a valid URI;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (an absolute URI with optional fragment identifier).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  NOTE: this is different from the previous network.URI,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  whose @parseURI@ function works like &#39;parseURIReference&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  in this module.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_225_1_225_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_9&#39;)"><span class="mpre">parseURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_225_1_225_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_9&#39;)"><span class="hl_vardecl"><span class="mpre">parseURI</span></span></a><span class="mpre"> = </span><a href="#loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="hl_varref"><span class="mpre">parseURIAny</span></span></a><span class="mpre"> </span><a href="#loc_385_1_385_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_1_385_4&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Parse a URI reference to a &#39;URI&#39; value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Returns &#39;Nothing&#39; if the string is not a valid URI reference.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (an absolute or relative URI with optional fragment identifier).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_232_1_232_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_18&#39;)"><span class="mpre">parseURIReference</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_232_1_232_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_18&#39;)"><span class="hl_vardecl"><span class="mpre">parseURIReference</span></span></a><span class="mpre"> = </span><a href="#loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="hl_varref"><span class="mpre">parseURIAny</span></span></a><span class="mpre"> </span><a href="#loc_711_1_711_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_1_711_13&#39;)"><span class="hl_varref"><span class="mpre">uriReference</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Parse a relative URI to a &#39;URI&#39; value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Returns &#39;Nothing&#39; if the string is not a valid relative URI.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (a relative URI with optional fragment identifier).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_239_1_239_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_23&#39;)"><span class="mpre">parseRelativeReference</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_239_1_239_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_23&#39;)"><span class="hl_vardecl"><span class="mpre">parseRelativeReference</span></span></a><span class="mpre"> = </span><a href="#loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="hl_varref"><span class="mpre">parseURIAny</span></span></a><span class="mpre"> </span><a href="#loc_723_1_723_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_1_723_12&#39;)"><span class="hl_varref"><span class="mpre">relativeRef</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Parse an absolute URI to a &#39;URI&#39; value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Returns &#39;Nothing&#39; if the string is not a valid absolute URI.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (an absolute URI without a fragment identifier).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_246_1_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_17&#39;)"><span class="mpre">parseAbsoluteURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_246_1_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_17&#39;)"><span class="hl_vardecl"><span class="mpre">parseAbsoluteURI</span></span></a><span class="mpre"> = </span><a href="#loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="hl_varref"><span class="mpre">parseURIAny</span></span></a><span class="mpre"> </span><a href="#loc_758_1_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_1_758_12&#39;)"><span class="hl_varref"><span class="mpre">absoluteURI</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Test if string contains a valid URI</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (an absolute URI with optional fragment identifier).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_252_1_252_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_1_252_6&#39;)"><span class="mpre">isURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_252_1_252_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_1_252_6&#39;)"><span class="hl_vardecl"><span class="mpre">isURI</span></span></a><span class="mpre"> = </span><a href="#loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="hl_varref"><span class="mpre">isValidParse</span></span></a><span class="mpre"> </span><a href="#loc_385_1_385_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_1_385_4&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Test if string contains a valid URI reference</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (an absolute or relative URI with optional fragment identifier).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_258_1_258_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_1_258_15&#39;)"><span class="mpre">isURIReference</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_258_1_258_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_1_258_15&#39;)"><span class="hl_vardecl"><span class="mpre">isURIReference</span></span></a><span class="mpre"> = </span><a href="#loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="hl_varref"><span class="mpre">isValidParse</span></span></a><span class="mpre"> </span><a href="#loc_711_1_711_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_1_711_13&#39;)"><span class="hl_varref"><span class="mpre">uriReference</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Test if string contains a valid relative URI</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (a relative URI with optional fragment identifier).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_264_1_264_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_20&#39;)"><span class="mpre">isRelativeReference</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_264_1_264_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_20&#39;)"><span class="hl_vardecl"><span class="mpre">isRelativeReference</span></span></a><span class="mpre"> = </span><a href="#loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="hl_varref"><span class="mpre">isValidParse</span></span></a><span class="mpre"> </span><a href="#loc_723_1_723_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_1_723_12&#39;)"><span class="hl_varref"><span class="mpre">relativeRef</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Test if string contains a valid absolute URI</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (an absolute URI without a fragment identifier).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_270_1_270_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_14&#39;)"><span class="mpre">isAbsoluteURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_270_1_270_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_14&#39;)"><span class="hl_vardecl"><span class="mpre">isAbsoluteURI</span></span></a><span class="mpre"> = </span><a href="#loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="hl_varref"><span class="mpre">isValidParse</span></span></a><span class="mpre"> </span><a href="#loc_758_1_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_1_758_12&#39;)"><span class="hl_varref"><span class="mpre">absoluteURI</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Test if string contains a valid IPv6 address</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_275_1_275_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_1_275_14&#39;)"><span class="mpre">isIPv6address</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_275_1_275_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_1_275_14&#39;)"><span class="hl_vardecl"><span class="mpre">isIPv6address</span></span></a><span class="mpre"> = </span><a href="#loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="hl_varref"><span class="mpre">isValidParse</span></span></a><span class="mpre"> </span><a href="#loc_476_1_476_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_12&#39;)"><span class="hl_varref"><span class="mpre">ipv6address</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Test if string contains a valid IPv4 address</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_280_1_280_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_14&#39;)"><span class="mpre">isIPv4address</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_280_1_280_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_14&#39;)"><span class="hl_vardecl"><span class="mpre">isIPv4address</span></span></a><span class="mpre"> = </span><a href="#loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="hl_varref"><span class="mpre">isValidParse</span></span></a><span class="mpre"> </span><a href="#loc_562_1_562_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_1_562_12&#39;)"><span class="hl_varref"><span class="mpre">ipv4address</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Test function: parse and reconstruct a URI reference</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_285_1_285_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_17&#39;)"><span class="mpre">testURIReference</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_285_1_285_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_17&#39;)"><span class="hl_fundecl"><span class="mpre">testURIReference</span></span></a><span class="mpre"> </span><a name="loc_285_18_285_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_18_285_24&#39;)"><span class="hl_vardecl"><span class="mpre">uristr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_303_1_303_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_9&#39;)"><span class="hl_varref"><span class="mpre">parseAll</span></span></a><span class="mpre"> </span><a href="#loc_711_1_711_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_1_711_13&#39;)"><span class="hl_varref"><span class="mpre">uriReference</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_285_18_285_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_18_285_24&#39;)"><span class="hl_varref"><span class="mpre">uristr</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">--  Helper function for turning a string into a URI</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="mpre">parseURIAny</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="hl_fundecl"><span class="mpre">parseURIAny</span></span></a><span class="mpre"> </span><a name="loc_290_13_290_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_13_290_19&#39;)"><span class="hl_vardecl"><span class="mpre">parser</span></span></a><span class="mpre"> </span><a name="loc_290_20_290_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_26&#39;)"><span class="hl_vardecl"><span class="mpre">uristr</span></span></a><span class="mpre"> = case </span><a href="#loc_303_1_303_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_9&#39;)"><span class="hl_varref"><span class="mpre">parseAll</span></span></a><span class="mpre"> </span><a href="#loc_290_13_290_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_13_290_19&#39;)"><span class="hl_varref"><span class="mpre">parser</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_290_20_290_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_26&#39;)"><span class="hl_varref"><span class="mpre">uristr</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  _ -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_292_15_292_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_15_292_16&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_292_15_292_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_15_292_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  Helper function to test a string match to a parser</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="mpre">isValidParse</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="hl_fundecl"><span class="mpre">isValidParse</span></span></a><span class="mpre"> </span><a name="loc_297_14_297_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_14_297_20&#39;)"><span class="hl_vardecl"><span class="mpre">parser</span></span></a><span class="mpre"> </span><a name="loc_297_21_297_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_21_297_27&#39;)"><span class="hl_vardecl"><span class="mpre">uristr</span></span></a><span class="mpre"> = case </span><a href="#loc_303_1_303_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_9&#39;)"><span class="hl_varref"><span class="mpre">parseAll</span></span></a><span class="mpre"> </span><a href="#loc_297_14_297_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_14_297_20&#39;)"><span class="hl_varref"><span class="mpre">parser</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_297_21_297_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_21_297_27&#39;)"><span class="hl_varref"><span class="mpre">uristr</span></span></a><span class="mpre"> of
        </span><span class="hl_comment"><span class="mpre">-- Left  e -&gt; error (show e)</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> _ -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><a href="#loc_303_1_303_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_9&#39;)"><span class="mpre">parseAll</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Text.Parsec.Error.html#loc_96_6_96_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Error.html#loc_96_6_96_16&#39;)"><span class="hl_tyconref"><span class="mpre">ParseError</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_303_1_303_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_9&#39;)"><span class="hl_fundecl"><span class="mpre">parseAll</span></span></a><span class="mpre"> </span><a name="loc_303_10_303_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_10_303_16&#39;)"><span class="hl_vardecl"><span class="mpre">parser</span></span></a><span class="mpre"> </span><a name="loc_303_17_303_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_17_303_25&#39;)"><span class="hl_vardecl"><span class="mpre">filename</span></span></a><span class="mpre"> </span><a name="loc_303_26_303_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_26_303_32&#39;)"><span class="hl_vardecl"><span class="mpre">uristr</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Prim.html#loc_642_1_642_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_642_1_642_6&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="#loc_305_9_305_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_9_305_18&#39;)"><span class="hl_varref"><span class="mpre">newparser</span></span></a><span class="mpre"> </span><a href="#loc_303_17_303_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_17_303_25&#39;)"><span class="hl_varref"><span class="mpre">filename</span></span></a><span class="mpre"> </span><a href="#loc_303_26_303_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_26_303_32&#39;)"><span class="hl_varref"><span class="mpre">uristr</span></span></a><span class="mpre">
    where
        </span><a name="loc_305_9_305_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_9_305_18&#39;)"><span class="hl_vardecl"><span class="mpre">newparser</span></span></a><span class="mpre"> =
            do  { </span><a name="loc_306_19_306_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_19_306_22&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_303_10_303_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_10_303_16&#39;)"><span class="hl_varref"><span class="mpre">parser</span></span></a><span class="mpre">
                ; </span><a href="Text.Parsec.Combinator.html#loc_242_1_242_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_242_1_242_4&#39;)"><span class="hl_varref"><span class="mpre">eof</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_306_19_306_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_19_306_22&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
                }

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Predicates</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_316_1_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_14&#39;)"><span class="mpre">uriIsAbsolute</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_316_1_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_14&#39;)"><span class="hl_fundecl"><span class="mpre">uriIsAbsolute</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 316, srcSpanStartColumn = 16, srcSpanEndLine = 316, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 316, srcSpanStartColumn = 20, srcSpanEndLine = 316, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 316, srcSpa"><span class="mpre">URI {uriScheme = scheme}</span></span><span class="mpre">) = </span><a href="#loc_1291_1_1291_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1291_1_1291_7&#39;)"><span class="hl_varref"><span class="mpre">scheme</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><a href="#loc_319_1_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_14&#39;)"><span class="mpre">uriIsRelative</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_319_1_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_14&#39;)"><span class="hl_vardecl"><span class="mpre">uriIsRelative</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_316_1_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_14&#39;)"><span class="hl_varref"><span class="mpre">uriIsAbsolute</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  URI parser body based on Parsec elements and combinators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  Parser parser type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Currently</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 327, srcSpanStartColumn = 1, srcSpanEndLine = 327, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 327, srcSpanStartColumn = 1, srcSpanEndLine = 327, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 327, srcSp"><span class="mpre">type URIParser a = GenParser Char () a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 2.1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Parse and return a &#39;pct-encoded&#39; sequence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_334_1_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_8&#39;)"><span class="mpre">escaped</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_334_1_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_8&#39;)"><span class="hl_vardecl"><span class="mpre">escaped</span></span></a><span class="mpre"> =
    do  { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="mpre">
        ; </span><a name="loc_336_11_336_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_11_336_13&#39;)"><span class="hl_vardecl"><span class="mpre">h1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_808_1_808_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_13&#39;)"><span class="hl_varref"><span class="mpre">hexDigitChar</span></span></a><span class="mpre">
        ; </span><a name="loc_337_11_337_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_11_337_13&#39;)"><span class="hl_vardecl"><span class="mpre">h2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_808_1_808_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_13&#39;)"><span class="hl_varref"><span class="mpre">hexDigitChar</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> [</span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="mpre">,</span><a href="#loc_336_11_336_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_11_336_13&#39;)"><span class="hl_varref"><span class="mpre">h1</span></span></a><span class="mpre">,</span><a href="#loc_337_11_337_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_11_337_13&#39;)"><span class="hl_varref"><span class="mpre">h2</span></span></a><span class="mpre">]
        }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 2.2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |Returns &#39;True&#39; if the character is a \&quot;reserved\&quot; character in a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  URI.  To include a literal instance of one of these characters in a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  component of a URI, it must be escaped.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="mpre">isReserved</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="hl_fundecl"><span class="mpre">isReserved</span></span></a><span class="mpre"> </span><a name="loc_348_12_348_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_12_348_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_351_1_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_1_351_12&#39;)"><span class="hl_varref"><span class="mpre">isGenDelims</span></span></a><span class="mpre"> </span><a href="#loc_348_12_348_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_12_348_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_354_1_354_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_12&#39;)"><span class="hl_varref"><span class="mpre">isSubDelims</span></span></a><span class="mpre"> </span><a href="#loc_348_12_348_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_12_348_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><a href="#loc_351_1_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_1_351_12&#39;)"><span class="mpre">isGenDelims</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_351_1_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_1_351_12&#39;)"><span class="hl_fundecl"><span class="mpre">isGenDelims</span></span></a><span class="mpre"> </span><a name="loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:/?#[]@&quot;</span></span><span class="mpre">

</span><a href="#loc_354_1_354_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_12&#39;)"><span class="mpre">isSubDelims</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_354_1_354_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_12&#39;)"><span class="hl_fundecl"><span class="mpre">isSubDelims</span></span></a><span class="mpre"> </span><a name="loc_354_13_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_13_354_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_354_13_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_13_354_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;!$&amp;&#39;()*+,;=&quot;</span></span><span class="mpre">

</span><a href="#loc_357_1_357_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_10&#39;)"><span class="mpre">genDelims</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_357_1_357_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_10&#39;)"><span class="hl_vardecl"><span class="mpre">genDelims</span></span></a><span class="mpre"> = do { </span><a name="loc_357_18_357_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_18_357_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="#loc_351_1_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_1_351_12&#39;)"><span class="hl_varref"><span class="mpre">isGenDelims</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_357_18_357_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_18_357_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] }

</span><a href="#loc_360_1_360_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_1_360_10&#39;)"><span class="mpre">subDelims</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_360_1_360_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_1_360_10&#39;)"><span class="hl_vardecl"><span class="mpre">subDelims</span></span></a><span class="mpre"> = do { </span><a name="loc_360_18_360_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_18_360_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="#loc_354_1_354_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_12&#39;)"><span class="hl_varref"><span class="mpre">isSubDelims</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_360_18_360_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_18_360_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 2.3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |Returns &#39;True&#39; if the character is an \&quot;unreserved\&quot; character in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  a URI.  These characters do not need to be escaped in a URI.  The</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  only characters allowed in a URI are either \&quot;reserved\&quot;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  \&quot;unreserved\&quot;, or an escape sequence (@%@ followed by two hex digits).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_370_1_370_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_13&#39;)"><span class="mpre">isUnreserved</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_370_1_370_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_13&#39;)"><span class="hl_fundecl"><span class="mpre">isUnreserved</span></span></a><span class="mpre"> </span><a name="loc_370_14_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_14_370_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_790_1_790_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_1_790_15&#39;)"><span class="hl_varref"><span class="mpre">isAlphaNumChar</span></span></a><span class="mpre"> </span><a href="#loc_370_14_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_14_370_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><a href="#loc_370_14_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_14_370_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-_.~&quot;</span></span><span class="mpre">)

</span><a href="#loc_373_1_373_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_15&#39;)"><span class="mpre">unreservedChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_373_1_373_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_15&#39;)"><span class="hl_vardecl"><span class="mpre">unreservedChar</span></span></a><span class="mpre"> = do { </span><a name="loc_373_23_373_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_23_373_24&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="#loc_370_1_370_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_13&#39;)"><span class="hl_varref"><span class="mpre">isUnreserved</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_373_23_373_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_23_373_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   URI         = scheme &quot;:&quot; hier-part [ &quot;?&quot; query ] [ &quot;#&quot; fragment ]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   hier-part   = &quot;//&quot; authority path-abempty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               / path-abs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               / path-rootless</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               / path-empty</span></span><span class="mpre">

</span><a href="#loc_385_1_385_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_1_385_4&#39;)"><span class="mpre">uri</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_385_1_385_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_1_385_4&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="mpre"> =
    do  { </span><span class="hl_vardecl"><span class="mpre">us</span></span><span class="mpre"> &lt;- </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><a href="#loc_420_1_420_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_1_420_8&#39;)"><span class="hl_varref"><span class="mpre">uscheme</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- ; ua &lt;- option Nothing ( do { try (string &quot;//&quot;) ; uauthority } )</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- ; up &lt;- upath</span></span><span class="mpre">
        ; (</span><span class="hl_vardecl"><span class="mpre">ua</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">up</span></span><span class="mpre">) &lt;- </span><a href="#loc_402_1_402_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_1_402_9&#39;)"><span class="hl_varref"><span class="mpre">hierPart</span></span></a><span class="mpre">
        ; </span><span class="hl_vardecl"><span class="mpre">uq</span></span><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> ( do { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="mpre"> ; </span><a href="#loc_693_1_693_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_693_1_693_7&#39;)"><span class="hl_varref"><span class="mpre">uquery</span></span></a><span class="mpre">    } )
        ; </span><span class="hl_vardecl"><span class="mpre">uf</span></span><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> ( do { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;#&#39;</span></span><span class="mpre"> ; </span><a href="#loc_701_1_701_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_1_701_10&#39;)"><span class="hl_varref"><span class="mpre">ufragment</span></span></a><span class="mpre"> } )
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 392, srcSpanStartColumn = 20, srcSpanEndLine = 398, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 393, srcSpanStartColumn = 13, srcSpanEndLine = 393, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 394, s"><span class="mpre">URI
            { uriScheme    = us
            , uriAuthority = ua
            , uriPath      = up
            , uriQuery     = uq
            , uriFragment  = uf
            }</span></span><span class="mpre">
        }

</span><a href="#loc_402_1_402_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_1_402_9&#39;)"><span class="mpre">hierPart</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> ((</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_162_6_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_6_162_13&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuth</span></span></a><span class="mpre">),</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_402_1_402_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_1_402_9&#39;)"><span class="hl_vardecl"><span class="mpre">hierPart</span></span></a><span class="mpre"> =
        do  { </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;//&quot;</span></span><span class="mpre">)
            ; </span><a name="loc_404_15_404_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_15_404_17&#39;)"><span class="hl_vardecl"><span class="mpre">ua</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_429_1_429_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_11&#39;)"><span class="hl_varref"><span class="mpre">uauthority</span></span></a><span class="mpre">
            ; </span><a name="loc_405_15_405_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_15_405_17&#39;)"><span class="hl_vardecl"><span class="mpre">up</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_628_1_628_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_1_628_12&#39;)"><span class="hl_varref"><span class="mpre">pathAbEmpty</span></span></a><span class="mpre">
            ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_404_15_404_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_15_404_17&#39;)"><span class="hl_varref"><span class="mpre">ua</span></span></a><span class="mpre">,</span><a href="#loc_405_15_405_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_15_405_17&#39;)"><span class="hl_varref"><span class="mpre">up</span></span></a><span class="mpre">)
            }
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> do  { </span><a name="loc_408_15_408_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_15_408_17&#39;)"><span class="hl_vardecl"><span class="mpre">up</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_634_1_634_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_8&#39;)"><span class="hl_varref"><span class="mpre">pathAbs</span></span></a><span class="mpre">
            ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a href="#loc_408_15_408_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_15_408_17&#39;)"><span class="hl_varref"><span class="mpre">up</span></span></a><span class="mpre">)
            }
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> do  { </span><a name="loc_411_15_411_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_15_411_17&#39;)"><span class="hl_vardecl"><span class="mpre">up</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_648_1_648_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_648_1_648_13&#39;)"><span class="hl_varref"><span class="mpre">pathRootLess</span></span></a><span class="mpre">
            ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a href="#loc_411_15_411_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_15_411_17&#39;)"><span class="hl_varref"><span class="mpre">up</span></span></a><span class="mpre">)
            }
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> do  { </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)
            }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 3.1</span></span><span class="mpre">

</span><a href="#loc_420_1_420_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_1_420_8&#39;)"><span class="mpre">uscheme</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_420_1_420_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_1_420_8&#39;)"><span class="hl_vardecl"><span class="mpre">uscheme</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_421_11_421_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_11_421_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_813_1_813_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_1_813_12&#39;)"><span class="hl_varref"><span class="mpre">oneThenMany</span></span></a><span class="mpre"> </span><a href="#loc_799_1_799_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_799_1_799_10&#39;)"><span class="hl_varref"><span class="mpre">alphaChar</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="#loc_796_1_796_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_1_796_13&#39;)"><span class="hl_varref"><span class="mpre">isSchemeChar</span></span></a><span class="mpre">)
        ; </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_421_11_421_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_11_421_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre">
        }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 3.2</span></span><span class="mpre">

</span><a href="#loc_429_1_429_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_11&#39;)"><span class="mpre">uauthority</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_162_6_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_6_162_13&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuth</span></span></a><span class="mpre">)
</span><a name="loc_429_1_429_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_11&#39;)"><span class="hl_vardecl"><span class="mpre">uauthority</span></span></a><span class="mpre"> =
    do  { </span><span class="hl_vardecl"><span class="mpre">uu</span></span><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> (</span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><a href="#loc_443_1_443_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_9&#39;)"><span class="hl_varref"><span class="mpre">userinfo</span></span></a><span class="mpre">)
        ; </span><span class="hl_vardecl"><span class="mpre">uh</span></span><span class="mpre"> &lt;- </span><a href="#loc_452_1_452_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_1_452_5&#39;)"><span class="hl_varref"><span class="mpre">host</span></span></a><span class="mpre">
        ; </span><span class="hl_vardecl"><span class="mpre">up</span></span><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_591_1_591_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_1_591_5&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 433, srcSpanStartColumn = 27, srcSpanEndLine = 437, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 434, srcSpanStartColumn = 13, srcSpanEndLine = 434, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 435, s"><span class="mpre">URIAuth
            { uriUserInfo = uu
            , uriRegName  = uh
            , uriPort     = up
            }</span></span><span class="mpre">
        }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 3.2.1</span></span><span class="mpre">

</span><a href="#loc_443_1_443_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_9&#39;)"><span class="mpre">userinfo</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_443_1_443_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_9&#39;)"><span class="hl_vardecl"><span class="mpre">userinfo</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_444_11_444_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_11_444_13&#39;)"><span class="hl_vardecl"><span class="mpre">uu</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (</span><a href="#loc_684_1_684_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_6&#39;)"><span class="hl_varref"><span class="mpre">uchar</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;;:&amp;=+$,&quot;</span></span><span class="mpre">)
        ; </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;@&#39;</span></span><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_444_11_444_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_11_444_13&#39;)"><span class="hl_varref"><span class="mpre">uu</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;@&quot;</span></span><span class="mpre">)
        }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 3.2.2</span></span><span class="mpre">

</span><a href="#loc_452_1_452_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_1_452_5&#39;)"><span class="mpre">host</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_452_1_452_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_1_452_5&#39;)"><span class="hl_vardecl"><span class="mpre">host</span></span></a><span class="mpre"> = </span><a href="#loc_455_1_455_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_10&#39;)"><span class="hl_varref"><span class="mpre">ipLiteral</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><a href="#loc_562_1_562_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_1_562_12&#39;)"><span class="hl_varref"><span class="mpre">ipv4address</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_582_1_582_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_582_1_582_8&#39;)"><span class="hl_varref"><span class="mpre">regName</span></span></a><span class="mpre">

</span><a href="#loc_455_1_455_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_10&#39;)"><span class="mpre">ipLiteral</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_455_1_455_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_10&#39;)"><span class="hl_vardecl"><span class="mpre">ipLiteral</span></span></a><span class="mpre"> =
    do  { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="mpre">
        ; </span><a name="loc_457_11_457_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_457_11_457_13&#39;)"><span class="hl_vardecl"><span class="mpre">ua</span></span></a><span class="mpre"> &lt;- ( </span><a href="#loc_476_1_476_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_12&#39;)"><span class="hl_varref"><span class="mpre">ipv6address</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_464_1_464_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_10&#39;)"><span class="hl_varref"><span class="mpre">ipvFuture</span></span></a><span class="mpre"> )
        ; </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;[&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_457_11_457_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_457_11_457_13&#39;)"><span class="hl_varref"><span class="mpre">ua</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">
        }
    </span><a href="Text.Parsec.Prim.html#loc_315_3_315_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_315_3_315_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;?&gt;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;IP address literal&quot;</span></span><span class="mpre">

</span><a href="#loc_464_1_464_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_10&#39;)"><span class="mpre">ipvFuture</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_464_1_464_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_10&#39;)"><span class="hl_vardecl"><span class="mpre">ipvFuture</span></span></a><span class="mpre"> =
    do  { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;v&#39;</span></span><span class="mpre">
        ; </span><a name="loc_466_11_466_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_11_466_12&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_808_1_808_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_13&#39;)"><span class="hl_varref"><span class="mpre">hexDigitChar</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">
        ; </span><a name="loc_468_11_468_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_11_468_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="#loc_473_1_473_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_1_473_16&#39;)"><span class="hl_varref"><span class="mpre">isIpvFutureChar</span></span></a><span class="mpre">)
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;v&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_466_11_466_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_11_466_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_468_11_468_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_11_468_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
        }

</span><a href="#loc_473_1_473_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_1_473_16&#39;)"><span class="mpre">isIpvFutureChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_473_1_473_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_1_473_16&#39;)"><span class="hl_fundecl"><span class="mpre">isIpvFutureChar</span></span></a><span class="mpre"> </span><a name="loc_473_17_473_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_17_473_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_370_1_370_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_13&#39;)"><span class="hl_varref"><span class="mpre">isUnreserved</span></span></a><span class="mpre"> </span><a href="#loc_473_17_473_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_17_473_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_354_1_354_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_12&#39;)"><span class="hl_varref"><span class="mpre">isSubDelims</span></span></a><span class="mpre"> </span><a href="#loc_473_17_473_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_17_473_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><a href="#loc_473_17_473_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_17_473_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;;&#39;</span></span><span class="mpre">)

</span><a href="#loc_476_1_476_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_12&#39;)"><span class="mpre">ipv6address</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_476_1_476_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_12&#39;)"><span class="hl_vardecl"><span class="mpre">ipv6address</span></span></a><span class="mpre"> =
        </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><a name="loc_478_19_478_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_19_478_21&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> </span><a href="#loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="hl_varref"><span class="mpre">h4c</span></span></a><span class="mpre">
                ; </span><a name="loc_479_19_479_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_19_479_21&#39;)"><span class="hl_vardecl"><span class="mpre">a3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_543_1_543_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_5&#39;)"><span class="hl_varref"><span class="mpre">ls32</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_478_19_478_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_19_478_21&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_479_19_479_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_19_479_21&#39;)"><span class="hl_varref"><span class="mpre">a3</span></span></a><span class="mpre">
                } )
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">
                ; </span><a name="loc_484_19_484_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_19_484_21&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><a href="#loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="hl_varref"><span class="mpre">h4c</span></span></a><span class="mpre">
                ; </span><a name="loc_485_19_485_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_19_485_21&#39;)"><span class="hl_vardecl"><span class="mpre">a3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_543_1_543_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_5&#39;)"><span class="hl_varref"><span class="mpre">ls32</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_484_19_484_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_19_484_21&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_485_19_485_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_19_485_21&#39;)"><span class="hl_varref"><span class="mpre">a3</span></span></a><span class="mpre">
                } )
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><a name="loc_489_19_489_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_19_489_21&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_536_1_536_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_1_536_13&#39;)"><span class="hl_varref"><span class="mpre">opt_n_h4c_h4</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">
                ; </span><a name="loc_491_19_491_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_19_491_21&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="hl_varref"><span class="mpre">h4c</span></span></a><span class="mpre">
                ; </span><a name="loc_492_19_492_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_492_19_492_21&#39;)"><span class="hl_vardecl"><span class="mpre">a3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_543_1_543_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_5&#39;)"><span class="hl_varref"><span class="mpre">ls32</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_489_19_489_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_19_489_21&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_491_19_491_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_19_491_21&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_492_19_492_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_492_19_492_21&#39;)"><span class="hl_varref"><span class="mpre">a3</span></span></a><span class="mpre">
                } )
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><a name="loc_496_19_496_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_19_496_21&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_536_1_536_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_1_536_13&#39;)"><span class="hl_varref"><span class="mpre">opt_n_h4c_h4</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">
                ; </span><a name="loc_498_19_498_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_19_498_21&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><a href="#loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="hl_varref"><span class="mpre">h4c</span></span></a><span class="mpre">
                ; </span><a name="loc_499_19_499_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_19_499_21&#39;)"><span class="hl_vardecl"><span class="mpre">a3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_543_1_543_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_5&#39;)"><span class="hl_varref"><span class="mpre">ls32</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_496_19_496_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_19_496_21&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_498_19_498_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_19_498_21&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_499_19_499_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_19_499_21&#39;)"><span class="hl_varref"><span class="mpre">a3</span></span></a><span class="mpre">
                } )
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><a name="loc_503_19_503_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_19_503_21&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_536_1_536_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_1_536_13&#39;)"><span class="hl_varref"><span class="mpre">opt_n_h4c_h4</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">
                ; </span><a name="loc_505_19_505_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_19_505_21&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="hl_varref"><span class="mpre">h4c</span></span></a><span class="mpre">
                ; </span><a name="loc_506_19_506_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_19_506_21&#39;)"><span class="hl_vardecl"><span class="mpre">a3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_543_1_543_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_5&#39;)"><span class="hl_varref"><span class="mpre">ls32</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_503_19_503_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_19_503_21&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_505_19_505_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_19_505_21&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_506_19_506_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_19_506_21&#39;)"><span class="hl_varref"><span class="mpre">a3</span></span></a><span class="mpre">
                } )
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><a name="loc_510_19_510_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_19_510_21&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_536_1_536_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_1_536_13&#39;)"><span class="hl_varref"><span class="mpre">opt_n_h4c_h4</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">
                ; </span><a name="loc_512_19_512_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_512_19_512_21&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="hl_varref"><span class="mpre">h4c</span></span></a><span class="mpre">
                ; </span><a name="loc_513_19_513_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_19_513_21&#39;)"><span class="hl_vardecl"><span class="mpre">a3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_543_1_543_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_5&#39;)"><span class="hl_varref"><span class="mpre">ls32</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_510_19_510_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_19_510_21&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_512_19_512_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_512_19_512_21&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_513_19_513_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_19_513_21&#39;)"><span class="hl_varref"><span class="mpre">a3</span></span></a><span class="mpre">
                } )
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><a name="loc_517_19_517_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_19_517_21&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_536_1_536_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_1_536_13&#39;)"><span class="hl_varref"><span class="mpre">opt_n_h4c_h4</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">
                ; </span><a name="loc_519_19_519_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_19_519_21&#39;)"><span class="hl_vardecl"><span class="mpre">a3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_543_1_543_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_5&#39;)"><span class="hl_varref"><span class="mpre">ls32</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_517_19_517_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_19_517_21&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_519_19_519_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_19_519_21&#39;)"><span class="hl_varref"><span class="mpre">a3</span></span></a><span class="mpre">
                } )
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><a name="loc_523_19_523_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_19_523_21&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_536_1_536_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_1_536_13&#39;)"><span class="hl_varref"><span class="mpre">opt_n_h4c_h4</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">
                ; </span><a name="loc_525_19_525_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_19_525_21&#39;)"><span class="hl_vardecl"><span class="mpre">a3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_559_1_559_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_1_559_3&#39;)"><span class="hl_varref"><span class="mpre">h4</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_523_19_523_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_19_523_21&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_525_19_525_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_19_525_21&#39;)"><span class="hl_varref"><span class="mpre">a3</span></span></a><span class="mpre">
                } )
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><a name="loc_529_19_529_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_19_529_21&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_536_1_536_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_1_536_13&#39;)"><span class="hl_varref"><span class="mpre">opt_n_h4c_h4</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_529_19_529_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_19_529_21&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">
                } )
    </span><a href="Text.Parsec.Prim.html#loc_315_3_315_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_315_3_315_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;?&gt;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;IPv6 address&quot;</span></span><span class="mpre">

</span><a href="#loc_536_1_536_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_1_536_13&#39;)"><span class="mpre">opt_n_h4c_h4</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_536_1_536_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_1_536_13&#39;)"><span class="hl_fundecl"><span class="mpre">opt_n_h4c_h4</span></span></a><span class="mpre"> </span><a name="loc_536_14_536_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_14_536_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    do  { </span><a name="loc_537_11_537_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_11_537_13&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="hl_varref"><span class="mpre">countMinMax</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_536_14_536_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_14_536_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="hl_varref"><span class="mpre">h4c</span></span></a><span class="mpre">
        ; </span><a name="loc_538_11_538_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_538_11_538_13&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_559_1_559_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_1_559_3&#39;)"><span class="hl_varref"><span class="mpre">h4</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_537_11_537_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_11_537_13&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_538_11_538_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_538_11_538_13&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre">
        }

</span><a href="#loc_543_1_543_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_5&#39;)"><span class="mpre">ls32</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_543_1_543_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_5&#39;)"><span class="hl_vardecl"><span class="mpre">ls32</span></span></a><span class="mpre"> =  </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> ( do
                { </span><a name="loc_544_19_544_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_19_544_21&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="hl_varref"><span class="mpre">h4c</span></span></a><span class="mpre">
                ; </span><a name="loc_545_19_545_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_545_19_545_21&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_559_1_559_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_1_559_3&#39;)"><span class="hl_varref"><span class="mpre">h4</span></span></a><span class="mpre">
                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_544_19_544_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_19_544_21&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_545_19_545_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_545_19_545_21&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre">)
                } )
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_562_1_562_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_1_562_12&#39;)"><span class="hl_varref"><span class="mpre">ipv4address</span></span></a><span class="mpre">

</span><a href="#loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="mpre">h4c</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_551_1_551_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_4&#39;)"><span class="hl_vardecl"><span class="mpre">h4c</span></span></a><span class="mpre"> = </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    do  { </span><a name="loc_552_11_552_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_11_552_13&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_559_1_559_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_1_559_3&#39;)"><span class="hl_varref"><span class="mpre">h4</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">
        ; </span><a href="Text.Parsec.Combinator.html#loc_257_1_257_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_257_1_257_14&#39;)"><span class="hl_varref"><span class="mpre">notFollowedBy</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">)
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_552_11_552_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_11_552_13&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre">
        }

</span><a href="#loc_559_1_559_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_1_559_3&#39;)"><span class="mpre">h4</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_559_1_559_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_1_559_3&#39;)"><span class="hl_vardecl"><span class="mpre">h4</span></span></a><span class="mpre"> = </span><a href="#loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="hl_varref"><span class="mpre">countMinMax</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_808_1_808_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_13&#39;)"><span class="hl_varref"><span class="mpre">hexDigitChar</span></span></a><span class="mpre">

</span><a href="#loc_562_1_562_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_1_562_12&#39;)"><span class="mpre">ipv4address</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_562_1_562_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_1_562_12&#39;)"><span class="hl_vardecl"><span class="mpre">ipv4address</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_563_11_563_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_11_563_13&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_573_1_573_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_9&#39;)"><span class="hl_varref"><span class="mpre">decOctet</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">
        ; </span><a name="loc_564_11_564_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_11_564_13&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_573_1_573_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_9&#39;)"><span class="hl_varref"><span class="mpre">decOctet</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">
        ; </span><a name="loc_565_11_565_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_11_565_13&#39;)"><span class="hl_vardecl"><span class="mpre">a3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_573_1_573_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_9&#39;)"><span class="hl_varref"><span class="mpre">decOctet</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">
        ; </span><a name="loc_566_11_566_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_566_11_566_13&#39;)"><span class="hl_vardecl"><span class="mpre">a4</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_573_1_573_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_9&#39;)"><span class="hl_varref"><span class="mpre">decOctet</span></span></a><span class="mpre">
        ; </span><a href="Text.Parsec.Combinator.html#loc_257_1_257_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_257_1_257_14&#39;)"><span class="hl_varref"><span class="mpre">notFollowedBy</span></span></a><span class="mpre"> </span><a href="#loc_582_1_582_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_582_1_582_8&#39;)"><span class="hl_varref"><span class="mpre">regName</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_563_11_563_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_11_563_13&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_564_11_564_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_11_564_13&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_565_11_565_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_11_565_13&#39;)"><span class="hl_varref"><span class="mpre">a3</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_566_11_566_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_566_11_566_13&#39;)"><span class="hl_varref"><span class="mpre">a4</span></span></a><span class="mpre">
        }
    </span><a href="Text.Parsec.Prim.html#loc_315_3_315_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_315_3_315_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;?&gt;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;IPv4 Address&quot;</span></span><span class="mpre">

</span><a href="#loc_573_1_573_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_9&#39;)"><span class="mpre">decOctet</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_573_1_573_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_9&#39;)"><span class="hl_vardecl"><span class="mpre">decOctet</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_574_11_574_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_11_574_13&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="hl_varref"><span class="mpre">countMinMax</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><a href="#loc_802_1_802_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_1_802_10&#39;)"><span class="hl_varref"><span class="mpre">digitChar</span></span></a><span class="mpre">
        ; if (</span><span class="hl_varref"><span class="mpre">read</span></span><span class="mpre"> </span><a href="#loc_574_11_574_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_11_574_13&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">255</span></span><span class="mpre"> then
            </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Decimal octet value too large&quot;</span></span><span class="mpre">
          else
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_574_11_574_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_11_574_13&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre">
        }

</span><a href="#loc_582_1_582_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_582_1_582_8&#39;)"><span class="mpre">regName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_582_1_582_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_582_1_582_8&#39;)"><span class="hl_vardecl"><span class="mpre">regName</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_583_11_583_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_11_583_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="hl_varref"><span class="mpre">countMinMax</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">255</span></span><span class="mpre"> ( </span><a href="#loc_373_1_373_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_15&#39;)"><span class="hl_varref"><span class="mpre">unreservedChar</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_334_1_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_8&#39;)"><span class="hl_varref"><span class="mpre">escaped</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_360_1_360_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_1_360_10&#39;)"><span class="hl_varref"><span class="mpre">subDelims</span></span></a><span class="mpre"> )
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_583_11_583_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_11_583_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
        }
    </span><a href="Text.Parsec.Prim.html#loc_315_3_315_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_315_3_315_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;?&gt;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Registered name&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 3.2.3</span></span><span class="mpre">

</span><a href="#loc_591_1_591_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_1_591_5&#39;)"><span class="mpre">port</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_591_1_591_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_1_591_5&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre"> =
    do  { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">
        ; </span><a name="loc_593_11_593_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_11_593_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_802_1_802_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_1_802_10&#39;)"><span class="hl_varref"><span class="mpre">digitChar</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_593_11_593_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_11_593_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
        }

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 3.3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   path          = path-abempty    ; begins with &quot;/&quot; or is empty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 / path-abs        ; begins with &quot;/&quot; but not &quot;//&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 / path-noscheme   ; begins with a non-colon segment</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 / path-rootless   ; begins with a segment</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 / path-empty      ; zero characters</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   path-abempty  = *( &quot;/&quot; segment )</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   path-abs      = &quot;/&quot; [ segment-nz *( &quot;/&quot; segment ) ]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   path-noscheme = segment-nzc *( &quot;/&quot; segment )</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   path-rootless = segment-nz *( &quot;/&quot; segment )</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   path-empty    = 0&lt;pchar&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   segment       = *pchar</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   segment-nz    = 1*pchar</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   segment-nzc   = 1*( unreserved / pct-encoded / sub-delims / &quot;@&quot; )</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   pchar         = unreserved / pct-encoded / sub-delims / &quot;:&quot; / &quot;@&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
upath :: URIParser String
upath = pathAbEmpty
    &lt;|&gt; pathAbs
    &lt;|&gt; pathNoScheme
    &lt;|&gt; pathRootLess
    &lt;|&gt; pathEmpty
-}</span></span><span class="mpre">

</span><a href="#loc_628_1_628_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_1_628_12&#39;)"><span class="mpre">pathAbEmpty</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_628_1_628_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_1_628_12&#39;)"><span class="hl_vardecl"><span class="mpre">pathAbEmpty</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_629_11_629_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_11_629_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_655_1_655_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_1_655_13&#39;)"><span class="hl_varref"><span class="mpre">slashSegment</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_629_11_629_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_11_629_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
        }

</span><a href="#loc_634_1_634_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_8&#39;)"><span class="mpre">pathAbs</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_634_1_634_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_8&#39;)"><span class="hl_vardecl"><span class="mpre">pathAbs</span></span></a><span class="mpre"> =
    do  { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">
        ; </span><a name="loc_636_11_636_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_11_636_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_648_1_648_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_648_1_648_13&#39;)"><span class="hl_varref"><span class="mpre">pathRootLess</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_636_11_636_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_11_636_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
        }

</span><a href="#loc_641_1_641_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_641_1_641_13&#39;)"><span class="mpre">pathNoScheme</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_641_1_641_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_641_1_641_13&#39;)"><span class="hl_vardecl"><span class="mpre">pathNoScheme</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_642_11_642_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_11_642_13&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_674_1_674_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_1_674_11&#39;)"><span class="hl_varref"><span class="mpre">segmentNzc</span></span></a><span class="mpre">
        ; </span><a name="loc_643_11_643_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_643_11_643_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_655_1_655_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_1_655_13&#39;)"><span class="hl_varref"><span class="mpre">slashSegment</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><a href="#loc_642_11_642_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_11_642_13&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_643_11_643_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_643_11_643_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
        }

</span><a href="#loc_648_1_648_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_648_1_648_13&#39;)"><span class="mpre">pathRootLess</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_648_1_648_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_648_1_648_13&#39;)"><span class="hl_vardecl"><span class="mpre">pathRootLess</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_649_11_649_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_11_649_13&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_668_1_668_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_10&#39;)"><span class="hl_varref"><span class="mpre">segmentNz</span></span></a><span class="mpre">
        ; </span><a name="loc_650_11_650_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_11_650_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_655_1_655_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_1_655_13&#39;)"><span class="hl_varref"><span class="mpre">slashSegment</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><a href="#loc_649_11_649_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_11_649_13&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_650_11_650_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_11_650_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
        }

</span><a href="#loc_655_1_655_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_1_655_13&#39;)"><span class="mpre">slashSegment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_655_1_655_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_1_655_13&#39;)"><span class="hl_vardecl"><span class="mpre">slashSegment</span></span></a><span class="mpre"> =
    do  { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">
        ; </span><a name="loc_657_11_657_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_657_11_657_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_662_1_662_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_1_662_8&#39;)"><span class="hl_varref"><span class="mpre">segment</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_657_11_657_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_657_11_657_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
        }

</span><a href="#loc_662_1_662_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_1_662_8&#39;)"><span class="mpre">segment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_662_1_662_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_1_662_8&#39;)"><span class="hl_vardecl"><span class="mpre">segment</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_663_11_663_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_663_11_663_13&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_680_1_680_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_6&#39;)"><span class="hl_varref"><span class="mpre">pchar</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_663_11_663_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_663_11_663_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
        }

</span><a href="#loc_668_1_668_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_10&#39;)"><span class="mpre">segmentNz</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_668_1_668_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_10&#39;)"><span class="hl_vardecl"><span class="mpre">segmentNz</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_669_11_669_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_669_11_669_13&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> </span><a href="#loc_680_1_680_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_6&#39;)"><span class="hl_varref"><span class="mpre">pchar</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_669_11_669_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_669_11_669_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
        }

</span><a href="#loc_674_1_674_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_1_674_11&#39;)"><span class="mpre">segmentNzc</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_674_1_674_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_1_674_11&#39;)"><span class="hl_vardecl"><span class="mpre">segmentNzc</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_675_11_675_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_11_675_13&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> (</span><a href="#loc_684_1_684_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_6&#39;)"><span class="hl_varref"><span class="mpre">uchar</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;@&quot;</span></span><span class="mpre">)
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_675_11_675_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_11_675_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
        }

</span><a href="#loc_680_1_680_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_6&#39;)"><span class="mpre">pchar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_680_1_680_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_6&#39;)"><span class="hl_vardecl"><span class="mpre">pchar</span></span></a><span class="mpre"> = </span><a href="#loc_684_1_684_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_6&#39;)"><span class="hl_varref"><span class="mpre">uchar</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:@&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- helper function for pchar and friends</span></span><span class="mpre">
</span><a href="#loc_684_1_684_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_6&#39;)"><span class="mpre">uchar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_684_1_684_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_6&#39;)"><span class="hl_fundecl"><span class="mpre">uchar</span></span></a><span class="mpre"> </span><a name="loc_684_7_684_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_7_684_13&#39;)"><span class="hl_vardecl"><span class="mpre">extras</span></span></a><span class="mpre"> =
        </span><a href="#loc_373_1_373_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_15&#39;)"><span class="hl_varref"><span class="mpre">unreservedChar</span></span></a><span class="mpre">
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_334_1_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_8&#39;)"><span class="hl_varref"><span class="mpre">escaped</span></span></a><span class="mpre">
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_360_1_360_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_1_360_10&#39;)"><span class="hl_varref"><span class="mpre">subDelims</span></span></a><span class="mpre">
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> do { </span><a name="loc_688_14_688_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_14_688_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">oneOf</span></span><span class="mpre"> </span><a href="#loc_684_7_684_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_7_684_13&#39;)"><span class="hl_varref"><span class="mpre">extras</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_688_14_688_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_14_688_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 3.4</span></span><span class="mpre">

</span><a href="#loc_693_1_693_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_693_1_693_7&#39;)"><span class="mpre">uquery</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_693_1_693_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_693_1_693_7&#39;)"><span class="hl_vardecl"><span class="mpre">uquery</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_694_11_694_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_694_11_694_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_684_1_684_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_6&#39;)"><span class="hl_varref"><span class="mpre">uchar</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;:@&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;/?&quot;</span></span><span class="mpre">)
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_694_11_694_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_694_11_694_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
        }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 3.5</span></span><span class="mpre">

</span><a href="#loc_701_1_701_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_1_701_10&#39;)"><span class="mpre">ufragment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_701_1_701_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_1_701_10&#39;)"><span class="hl_vardecl"><span class="mpre">ufragment</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_702_11_702_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_11_702_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_684_1_684_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_6&#39;)"><span class="hl_varref"><span class="mpre">uchar</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;:@&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;/?&quot;</span></span><span class="mpre">)
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;#&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_702_11_702_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_11_702_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
        }

</span><span class="hl_comment"><span class="mpre">--  Reference, Relative and Absolute URI forms</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 4.1</span></span><span class="mpre">

</span><a href="#loc_711_1_711_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_1_711_13&#39;)"><span class="mpre">uriReference</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_711_1_711_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_1_711_13&#39;)"><span class="hl_vardecl"><span class="mpre">uriReference</span></span></a><span class="mpre"> = </span><a href="#loc_385_1_385_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_1_385_4&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_723_1_723_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_1_723_12&#39;)"><span class="hl_varref"><span class="mpre">relativeRef</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 4.2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   relative-URI  = relative-part [ &quot;?&quot; query ] [ &quot;#&quot; fragment ]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   relative-part = &quot;//&quot; authority path-abempty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 / path-abs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 / path-noscheme</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 / path-empty</span></span><span class="mpre">

</span><a href="#loc_723_1_723_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_1_723_12&#39;)"><span class="mpre">relativeRef</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_723_1_723_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_1_723_12&#39;)"><span class="hl_vardecl"><span class="mpre">relativeRef</span></span></a><span class="mpre"> =
    do  { </span><a href="#loc_833_1_833_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_1_833_12&#39;)"><span class="hl_varref"><span class="mpre">notMatching</span></span></a><span class="mpre"> </span><a href="#loc_420_1_420_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_1_420_8&#39;)"><span class="hl_varref"><span class="mpre">uscheme</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- ; ua &lt;- option Nothing ( do { try (string &quot;//&quot;) ; uauthority } )</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- ; up &lt;- upath</span></span><span class="mpre">
        ; (</span><span class="hl_vardecl"><span class="mpre">ua</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">up</span></span><span class="mpre">) &lt;- </span><a href="#loc_740_1_740_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_1_740_13&#39;)"><span class="hl_varref"><span class="mpre">relativePart</span></span></a><span class="mpre">
        ; </span><span class="hl_vardecl"><span class="mpre">uq</span></span><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> ( do { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="mpre"> ; </span><a href="#loc_693_1_693_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_693_1_693_7&#39;)"><span class="hl_varref"><span class="mpre">uquery</span></span></a><span class="mpre">    } )
        ; </span><span class="hl_vardecl"><span class="mpre">uf</span></span><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> ( do { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;#&#39;</span></span><span class="mpre"> ; </span><a href="#loc_701_1_701_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_1_701_10&#39;)"><span class="hl_varref"><span class="mpre">ufragment</span></span></a><span class="mpre"> } )
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 730, srcSpanStartColumn = 20, srcSpanEndLine = 736, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 731, srcSpanStartColumn = 13, srcSpanEndLine = 731, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 732, s"><span class="mpre">URI
            { uriScheme    = &quot;&quot;
            , uriAuthority = ua
            , uriPath      = up
            , uriQuery     = uq
            , uriFragment  = uf
            }</span></span><span class="mpre">
        }

</span><a href="#loc_740_1_740_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_1_740_13&#39;)"><span class="mpre">relativePart</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> ((</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_162_6_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_6_162_13&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuth</span></span></a><span class="mpre">),</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_740_1_740_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_1_740_13&#39;)"><span class="hl_vardecl"><span class="mpre">relativePart</span></span></a><span class="mpre"> =
        do  { </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;//&quot;</span></span><span class="mpre">)
            ; </span><a name="loc_742_15_742_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_15_742_17&#39;)"><span class="hl_vardecl"><span class="mpre">ua</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_429_1_429_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_11&#39;)"><span class="hl_varref"><span class="mpre">uauthority</span></span></a><span class="mpre">
            ; </span><a name="loc_743_15_743_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_15_743_17&#39;)"><span class="hl_vardecl"><span class="mpre">up</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_628_1_628_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_1_628_12&#39;)"><span class="hl_varref"><span class="mpre">pathAbEmpty</span></span></a><span class="mpre">
            ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_742_15_742_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_15_742_17&#39;)"><span class="hl_varref"><span class="mpre">ua</span></span></a><span class="mpre">,</span><a href="#loc_743_15_743_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_15_743_17&#39;)"><span class="hl_varref"><span class="mpre">up</span></span></a><span class="mpre">)
            }
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> do  { </span><a name="loc_746_15_746_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_746_15_746_17&#39;)"><span class="hl_vardecl"><span class="mpre">up</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_634_1_634_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_8&#39;)"><span class="hl_varref"><span class="mpre">pathAbs</span></span></a><span class="mpre">
            ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a href="#loc_746_15_746_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_746_15_746_17&#39;)"><span class="hl_varref"><span class="mpre">up</span></span></a><span class="mpre">)
            }
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> do  { </span><a name="loc_749_15_749_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_749_15_749_17&#39;)"><span class="hl_vardecl"><span class="mpre">up</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_641_1_641_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_641_1_641_13&#39;)"><span class="hl_varref"><span class="mpre">pathNoScheme</span></span></a><span class="mpre">
            ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a href="#loc_749_15_749_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_749_15_749_17&#39;)"><span class="hl_varref"><span class="mpre">up</span></span></a><span class="mpre">)
            }
    </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> do  { </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)
            }

</span><span class="hl_comment"><span class="mpre">--  RFC3986, section 4.3</span></span><span class="mpre">

</span><a href="#loc_758_1_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_1_758_12&#39;)"><span class="mpre">absoluteURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_758_1_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_1_758_12&#39;)"><span class="hl_vardecl"><span class="mpre">absoluteURI</span></span></a><span class="mpre"> =
    do  { </span><span class="hl_vardecl"><span class="mpre">us</span></span><span class="mpre"> &lt;- </span><a href="#loc_420_1_420_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_1_420_8&#39;)"><span class="hl_varref"><span class="mpre">uscheme</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- ; ua &lt;- option Nothing ( do { try (string &quot;//&quot;) ; uauthority } )</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- ; up &lt;- upath</span></span><span class="mpre">
        ; (</span><span class="hl_vardecl"><span class="mpre">ua</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">up</span></span><span class="mpre">) &lt;- </span><a href="#loc_402_1_402_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_1_402_9&#39;)"><span class="hl_varref"><span class="mpre">hierPart</span></span></a><span class="mpre">
        ; </span><span class="hl_vardecl"><span class="mpre">uq</span></span><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> ( do { </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="mpre"> ; </span><a href="#loc_693_1_693_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_693_1_693_7&#39;)"><span class="hl_varref"><span class="mpre">uquery</span></span></a><span class="mpre">    } )
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 764, srcSpanStartColumn = 20, srcSpanEndLine = 770, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 765, srcSpanStartColumn = 13, srcSpanEndLine = 765, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 766, s"><span class="mpre">URI
            { uriScheme    = us
            , uriAuthority = ua
            , uriPath      = up
            , uriQuery     = uq
            , uriFragment  = &quot;&quot;
            }</span></span><span class="mpre">
        }

</span><span class="hl_comment"><span class="mpre">--  Imports from RFC 2234</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- NOTE: can&#39;t use isAlphaNum etc. because these deal with ISO 8859</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- (and possibly Unicode!) chars.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- [[[Above was a comment originally in GHC Network/URI.hs:</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--    when IRIs are introduced then most codepoints above 128(?) should</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--    be treated as unreserved, and higher codepoints for letters should</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--    certainly be allowed.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ]]]</span></span><span class="mpre">

</span><a href="#loc_784_1_784_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_784_1_784_12&#39;)"><span class="mpre">isAlphaChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_784_1_784_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_784_1_784_12&#39;)"><span class="hl_fundecl"><span class="mpre">isAlphaChar</span></span></a><span class="mpre"> </span><a name="loc_784_13_784_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_784_13_784_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">    = (</span><a href="#loc_784_13_784_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_784_13_784_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;A&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_784_13_784_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_784_13_784_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;Z&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><a href="#loc_784_13_784_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_784_13_784_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;a&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_784_13_784_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_784_13_784_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;z&#39;</span></span><span class="mpre">)

</span><a href="#loc_787_1_787_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_12&#39;)"><span class="mpre">isDigitChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_787_1_787_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_12&#39;)"><span class="hl_fundecl"><span class="mpre">isDigitChar</span></span></a><span class="mpre"> </span><a name="loc_787_13_787_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_13_787_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">    = (</span><a href="#loc_787_13_787_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_13_787_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_787_13_787_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_13_787_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;9&#39;</span></span><span class="mpre">)

</span><a href="#loc_790_1_790_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_1_790_15&#39;)"><span class="mpre">isAlphaNumChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_790_1_790_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_1_790_15&#39;)"><span class="hl_fundecl"><span class="mpre">isAlphaNumChar</span></span></a><span class="mpre"> </span><a name="loc_790_16_790_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_16_790_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_784_1_784_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_784_1_784_12&#39;)"><span class="hl_varref"><span class="mpre">isAlphaChar</span></span></a><span class="mpre"> </span><a href="#loc_790_16_790_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_16_790_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_787_1_787_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_12&#39;)"><span class="hl_varref"><span class="mpre">isDigitChar</span></span></a><span class="mpre"> </span><a href="#loc_790_16_790_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_16_790_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><a href="#loc_793_1_793_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_15&#39;)"><span class="mpre">isHexDigitChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_793_1_793_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_15&#39;)"><span class="hl_fundecl"><span class="mpre">isHexDigitChar</span></span></a><span class="mpre"> </span><a name="loc_793_16_793_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_16_793_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="GHC.Unicode.html#loc_112_1_112_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_112_1_112_11&#39;)"><span class="hl_varref"><span class="mpre">isHexDigit</span></span></a><span class="mpre"> </span><a href="#loc_793_16_793_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_16_793_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><a href="#loc_796_1_796_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_1_796_13&#39;)"><span class="mpre">isSchemeChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_796_1_796_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_1_796_13&#39;)"><span class="hl_fundecl"><span class="mpre">isSchemeChar</span></span></a><span class="mpre"> </span><a name="loc_796_14_796_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_14_796_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">   = (</span><a href="#loc_790_1_790_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_1_790_15&#39;)"><span class="hl_varref"><span class="mpre">isAlphaNumChar</span></span></a><span class="mpre"> </span><a href="#loc_796_14_796_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_14_796_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><a href="#loc_796_14_796_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_14_796_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;+-.&quot;</span></span><span class="mpre">)

</span><a href="#loc_799_1_799_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_799_1_799_10&#39;)"><span class="mpre">alphaChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_799_1_799_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_799_1_799_10&#39;)"><span class="hl_vardecl"><span class="mpre">alphaChar</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="#loc_784_1_784_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_784_1_784_12&#39;)"><span class="hl_varref"><span class="mpre">isAlphaChar</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- or: Parsec.letter ?</span></span><span class="mpre">

</span><a href="#loc_802_1_802_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_1_802_10&#39;)"><span class="mpre">digitChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_802_1_802_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_1_802_10&#39;)"><span class="hl_vardecl"><span class="mpre">digitChar</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="#loc_787_1_787_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_12&#39;)"><span class="hl_varref"><span class="mpre">isDigitChar</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- or: Parsec.digit ?</span></span><span class="mpre">

</span><a href="#loc_805_1_805_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_1_805_13&#39;)"><span class="mpre">alphaNumChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_805_1_805_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_1_805_13&#39;)"><span class="hl_vardecl"><span class="mpre">alphaNumChar</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="#loc_790_1_790_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_1_790_15&#39;)"><span class="hl_varref"><span class="mpre">isAlphaNumChar</span></span></a><span class="mpre">

</span><a href="#loc_808_1_808_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_13&#39;)"><span class="mpre">hexDigitChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">URIParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_808_1_808_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_13&#39;)"><span class="hl_vardecl"><span class="mpre">hexDigitChar</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="#loc_793_1_793_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_15&#39;)"><span class="hl_varref"><span class="mpre">isHexDigitChar</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- or: Parsec.hexDigit ?</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  Additional parser combinators for common patterns</span></span><span class="mpre">

</span><a href="#loc_813_1_813_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_1_813_12&#39;)"><span class="mpre">oneThenMany</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_813_1_813_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_1_813_12&#39;)"><span class="hl_fundecl"><span class="mpre">oneThenMany</span></span></a><span class="mpre"> </span><a name="loc_813_13_813_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_13_813_15&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a name="loc_813_16_813_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_16_813_18&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre"> =
    do  { </span><a name="loc_814_11_814_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_814_11_814_13&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_813_13_813_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_13_813_15&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre">
        ; </span><a name="loc_815_11_815_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_11_815_13&#39;)"><span class="hl_vardecl"><span class="mpre">ar</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_813_16_813_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_16_813_18&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_814_11_814_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_814_11_814_13&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_815_11_815_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_11_815_13&#39;)"><span class="hl_varref"><span class="mpre">ar</span></span></a><span class="mpre">)
        }

</span><a href="#loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="mpre">countMinMax</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="hl_fundecl"><span class="mpre">countMinMax</span></span></a><span class="mpre"> </span><a name="loc_820_13_820_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_13_820_14&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_820_15_820_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_15_820_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_820_17_820_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_17_820_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> | </span><a href="#loc_820_13_820_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_13_820_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> =
    do  { </span><a name="loc_821_11_821_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_11_821_13&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_820_17_820_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_17_820_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        ; </span><a name="loc_822_11_822_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_11_822_13&#39;)"><span class="hl_vardecl"><span class="mpre">ar</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="hl_varref"><span class="mpre">countMinMax</span></span></a><span class="mpre"> (</span><a href="#loc_820_13_820_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_13_820_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_820_15_820_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_15_820_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_820_17_820_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_17_820_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_821_11_821_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_11_821_13&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_822_11_822_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_11_822_13&#39;)"><span class="hl_varref"><span class="mpre">ar</span></span></a><span class="mpre">)
        }
</span><a href="#loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="hl_fundecl"><span class="mpre">countMinMax</span></span></a><span class="mpre"> _ </span><a name="loc_825_15_825_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_825_15_825_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ | </span><a href="#loc_825_15_825_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_825_15_825_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
</span><a href="#loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="hl_fundecl"><span class="mpre">countMinMax</span></span></a><span class="mpre"> _ </span><a name="loc_826_15_826_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_15_826_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_826_17_826_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_17_826_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    do  { </span><a name="loc_827_11_827_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_827_11_827_13&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_826_17_826_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_17_826_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        ; </span><a name="loc_828_11_828_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_828_11_828_13&#39;)"><span class="hl_vardecl"><span class="mpre">ar</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_820_1_820_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_820_1_820_12&#39;)"><span class="hl_varref"><span class="mpre">countMinMax</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="#loc_826_15_826_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_15_826_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_826_17_826_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_17_826_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_827_11_827_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_827_11_827_13&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_828_11_828_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_828_11_828_13&#39;)"><span class="hl_varref"><span class="mpre">ar</span></span></a><span class="mpre">)
        }

</span><a href="#loc_833_1_833_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_1_833_12&#39;)"><span class="mpre">notMatching</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 832, srcSpanStartColumn = 16, srcSpanEndLine = 832, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 832, srcSpanStartColumn = 23, srcSpanEndLine = 832, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Netw"><span class="mpre">Show a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">tok</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">tok</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_833_1_833_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_1_833_12&#39;)"><span class="hl_fundecl"><span class="mpre">notMatching</span></span></a><span class="mpre"> </span><a name="loc_833_13_833_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_13_833_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do { </span><a name="loc_833_22_833_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_22_833_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><a href="#loc_833_13_833_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_13_833_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> ; </span><a href="Text.Parsec.Prim.html#loc_98_1_98_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_98_1_98_11&#39;)"><span class="hl_varref"><span class="mpre">unexpected</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_833_22_833_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_22_833_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) } </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Reconstruct a URI string</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |Turn a &#39;URI&#39; into a string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Uses a supplied function to map the userinfo part of the URI.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  The Show instance for URI uses a mapping that hides any password</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  that may be present in the URI.  Use this function with argument @id@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  to preserve the password in the formatted output.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_848_1_848_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_848_1_848_12&#39;)"><span class="mpre">uriToString</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">-&gt;</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ShowS</span></span><span class="mpre">
</span><a name="loc_848_1_848_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_848_1_848_12&#39;)"><span class="hl_fundecl"><span class="mpre">uriToString</span></span></a><span class="mpre"> </span><a name="loc_848_13_848_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_848_13_848_24&#39;)"><span class="hl_vardecl"><span class="mpre">userinfomap</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 848, srcSpanStartColumn = 25, srcSpanEndLine = 853, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 848, srcSpanStartColumn = 29, srcSpanEndLine = 848, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 849, srcSpa"><span class="mpre">URI { uriScheme=myscheme
                            , uriAuthority=myauthority
                            , uriPath=mypath
                            , uriQuery=myquery
                            , uriFragment=myfragment
                            }</span></span><span class="mpre"> =
    (</span><span class="hl_varref"><span class="mpre">myscheme</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_858_1_858_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_858_1_858_16&#39;)"><span class="hl_varref"><span class="mpre">uriAuthToString</span></span></a><span class="mpre"> </span><a href="#loc_848_13_848_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_848_13_848_24&#39;)"><span class="hl_varref"><span class="mpre">userinfomap</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">myauthority</span></span><span class="mpre">)
               </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mypath</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">myquery</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">myfragment</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">)

</span><a href="#loc_858_1_858_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_858_1_858_16&#39;)"><span class="mpre">uriAuthToString</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">-&gt;</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_162_6_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_6_162_13&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuth</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ShowS</span></span><span class="mpre">
</span><a name="loc_858_1_858_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_858_1_858_16&#39;)"><span class="hl_fundecl"><span class="mpre">uriAuthToString</span></span></a><span class="mpre"> _           </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- shows &quot;&quot;</span></span><span class="mpre">
</span><a href="#loc_858_1_858_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_858_1_858_16&#39;)"><span class="hl_fundecl"><span class="mpre">uriAuthToString</span></span></a><span class="mpre"> </span><a name="loc_859_17_859_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_859_17_859_28&#39;)"><span class="hl_vardecl"><span class="mpre">userinfomap</span></span></a><span class="mpre">
        (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 860, srcSpanStartColumn = 15, srcSpanEndLine = 863, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 860, srcSpanStartColumn = 23, srcSpanEndLine = 860, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 861, srcSpa"><span class="mpre">URIAuth { uriUserInfo = myuinfo
                      , uriRegName  = myregname
                      , uriPort     = myport
                      }</span></span><span class="mpre"> ) =
    (</span><span class="hl_string"><span class="mpre">&quot;//&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">myuinfo</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> else ((</span><a href="#loc_859_17_859_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_859_17_859_28&#39;)"><span class="hl_varref"><span class="mpre">userinfomap</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">myuinfo</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">))
             </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">myregname</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">)
             </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">myport</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Character classes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Returns &#39;True&#39; if the character is allowed in a URI.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_875_1_875_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_875_1_875_15&#39;)"><span class="mpre">isAllowedInURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_875_1_875_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_875_1_875_15&#39;)"><span class="hl_fundecl"><span class="mpre">isAllowedInURI</span></span></a><span class="mpre"> </span><a name="loc_875_16_875_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_875_16_875_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="hl_varref"><span class="mpre">isReserved</span></span></a><span class="mpre"> </span><a href="#loc_875_16_875_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_875_16_875_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_370_1_370_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_13&#39;)"><span class="hl_varref"><span class="mpre">isUnreserved</span></span></a><span class="mpre"> </span><a href="#loc_875_16_875_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_875_16_875_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_875_16_875_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_875_16_875_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- escape char</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Returns &#39;True&#39; if the character is allowed unescaped in a URI.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_880_1_880_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_1_880_17&#39;)"><span class="mpre">isUnescapedInURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_880_1_880_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_1_880_17&#39;)"><span class="hl_fundecl"><span class="mpre">isUnescapedInURI</span></span></a><span class="mpre"> </span><a name="loc_880_18_880_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_18_880_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="hl_varref"><span class="mpre">isReserved</span></span></a><span class="mpre"> </span><a href="#loc_880_18_880_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_18_880_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_370_1_370_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_13&#39;)"><span class="hl_varref"><span class="mpre">isUnreserved</span></span></a><span class="mpre"> </span><a href="#loc_880_18_880_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_18_880_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Returns &#39;True&#39; if the character is allowed unescaped in a URI component.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_885_1_885_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_885_1_885_26&#39;)"><span class="mpre">isUnescapedInURIComponent</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_885_1_885_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_885_1_885_26&#39;)"><span class="hl_fundecl"><span class="mpre">isUnescapedInURIComponent</span></span></a><span class="mpre"> </span><a name="loc_885_27_885_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_885_27_885_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="hl_varref"><span class="mpre">isReserved</span></span></a><span class="mpre"> </span><a href="#loc_885_27_885_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_885_27_885_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_880_1_880_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_1_880_17&#39;)"><span class="hl_varref"><span class="mpre">isUnescapedInURI</span></span></a><span class="mpre"> </span><a href="#loc_885_27_885_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_885_27_885_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Escape sequence handling</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Escape character if supplied predicate is not satisfied,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  otherwise return character as singleton string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_895_1_895_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_895_1_895_14&#39;)"><span class="mpre">escapeURIChar</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">-&gt;</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_895_1_895_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_895_1_895_14&#39;)"><span class="hl_fundecl"><span class="mpre">escapeURIChar</span></span></a><span class="mpre"> </span><a name="loc_895_15_895_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_895_15_895_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_895_17_895_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_895_17_895_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">
    | </span><a href="#loc_895_15_895_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_895_15_895_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_895_17_895_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_895_17_895_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">       = [</span><a href="#loc_895_17_895_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_895_17_895_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">]
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (\</span><a name="loc_897_31_897_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_897_31_897_32&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_900_9_900_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_900_9_900_18&#39;)"><span class="hl_varref"><span class="mpre">myShowHex</span></span></a><span class="mpre"> </span><a href="#loc_897_31_897_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_897_31_897_32&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) (</span><a href="#loc_912_1_912_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_912_1_912_15&#39;)"><span class="hl_varref"><span class="mpre">utf8EncodeChar</span></span></a><span class="mpre"> </span><a href="#loc_895_17_895_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_895_17_895_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
    where
        </span><a href="#loc_900_9_900_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_900_9_900_18&#39;)"><span class="mpre">myShowHex</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ShowS</span></span><span class="mpre">
        </span><a name="loc_900_9_900_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_900_9_900_18&#39;)"><span class="hl_fundecl"><span class="mpre">myShowHex</span></span></a><span class="mpre"> </span><a name="loc_900_19_900_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_900_19_900_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_900_21_900_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_900_21_900_22&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> =  case </span><a href="Numeric.html#loc_213_1_213_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Numeric.html#loc_213_1_213_14&#39;)"><span class="hl_varref"><span class="mpre">showIntAtBase</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> (</span><a href="#loc_904_9_904_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_9_904_17&#39;)"><span class="hl_varref"><span class="mpre">toChrHex</span></span></a><span class="mpre">) </span><a href="#loc_900_19_900_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_900_19_900_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_900_21_900_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_900_21_900_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> of
            []  -&gt; </span><span class="hl_string"><span class="mpre">&quot;00&quot;</span></span><span class="mpre">
            [</span><a name="loc_902_14_902_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_902_14_902_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">] -&gt; [</span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">,</span><a href="#loc_902_14_902_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_902_14_902_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]
            </span><a name="loc_903_13_903_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_903_13_903_15&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_903_13_903_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_903_13_903_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
        </span><a name="loc_904_9_904_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_9_904_17&#39;)"><span class="hl_fundecl"><span class="mpre">toChrHex</span></span></a><span class="mpre"> </span><a name="loc_904_18_904_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_18_904_19&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">
            | </span><a href="#loc_904_18_904_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_18_904_19&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">    = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_904_18_904_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_18_904_19&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;A&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_904_18_904_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_18_904_19&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- From http://hackage.haskell.org/package/utf8-string</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by Eric Mertens, BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Returns [Int] for use with showIntAtBase</span></span><span class="mpre">
</span><a href="#loc_912_1_912_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_912_1_912_15&#39;)"><span class="mpre">utf8EncodeChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]
</span><a name="loc_912_1_912_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_912_1_912_15&#39;)"><span class="hl_vardecl"><span class="mpre">utf8EncodeChar</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_914_3_914_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_3_914_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">
 where
  </span><a name="loc_914_3_914_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_3_914_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_vardecl"><span class="mpre">oc</span></span></a><span class="mpre">
   | </span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7f</span></span><span class="mpre">       = [</span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre">]

   | </span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7ff</span></span><span class="mpre">      = [ </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                        ]

   | </span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xffff</span></span><span class="mpre">     = [ </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                        ]
   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = [ </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_914_6_914_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_6_914_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                        ]

</span><span class="hl_comment"><span class="mpre">-- |Can be used to make a string valid for use in a URI.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_938_1_938_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_938_1_938_16&#39;)"><span class="mpre">escapeURIString</span></a><span class="mpre">
    :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">-&gt;</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)     </span><span class="hl_comment"><span class="mpre">-- ^ a predicate which returns &#39;False&#39;</span></span><span class="mpre">
                        </span><span class="hl_comment"><span class="mpre">--   if the character should be escaped</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ the string to process</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ the resulting URI string</span></span><span class="mpre">
</span><a name="loc_938_1_938_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_938_1_938_16&#39;)"><span class="hl_fundecl"><span class="mpre">escapeURIString</span></span></a><span class="mpre"> </span><a name="loc_938_17_938_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_938_17_938_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_938_19_938_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_938_19_938_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><a href="#loc_895_1_895_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_895_1_895_14&#39;)"><span class="hl_varref"><span class="mpre">escapeURIChar</span></span></a><span class="mpre"> </span><a href="#loc_938_17_938_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_938_17_938_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="#loc_938_19_938_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_938_19_938_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Turns all instances of escaped characters in the string back</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  into literal characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="mpre">unEscapeString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_fundecl"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> [] = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
</span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_fundecl"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a name="loc_945_16_945_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_16_945_17&#39;)"><span class="hl_specname"><span class="mpre">s</span></span></a><span class="mpre">@(</span><a name="loc_945_19_945_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_19_945_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_945_21_945_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_21_945_23&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = case </span><a href="#loc_950_1_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_1_950_13&#39;)"><span class="hl_varref"><span class="mpre">unEscapeByte</span></span></a><span class="mpre"> </span><a href="#loc_945_16_945_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_16_945_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_946_11_946_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_946_11_946_15&#39;)"><span class="hl_vardecl"><span class="mpre">byte</span></span></a><span class="mpre">, </span><a name="loc_946_17_946_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_946_17_946_21&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_957_1_957_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_1_957_13&#39;)"><span class="hl_varref"><span class="mpre">unEscapeUtf8</span></span></a><span class="mpre"> </span><a href="#loc_946_11_946_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_946_11_946_15&#39;)"><span class="hl_varref"><span class="mpre">byte</span></span></a><span class="mpre"> </span><a href="#loc_946_17_946_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_946_17_946_21&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_945_19_945_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_19_945_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_945_21_945_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_21_945_23&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

</span><a href="#loc_950_1_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_1_950_13&#39;)"><span class="mpre">unEscapeByte</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_950_1_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_1_950_13&#39;)"><span class="hl_fundecl"><span class="mpre">unEscapeByte</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_950_19_950_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_19_950_21&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_950_22_950_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_22_950_24&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_950_25_950_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_25_950_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) | </span><a href="GHC.Unicode.html#loc_112_1_112_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_112_1_112_11&#39;)"><span class="hl_varref"><span class="mpre">isHexDigit</span></span></a><span class="mpre"> </span><a href="#loc_950_19_950_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_19_950_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_112_1_112_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_112_1_112_11&#39;)"><span class="hl_varref"><span class="mpre">isHexDigit</span></span></a><span class="mpre"> </span><a href="#loc_950_22_950_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_22_950_24&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> =
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="hl_varref"><span class="mpre">digitToInt</span></span></a><span class="mpre"> </span><a href="#loc_950_19_950_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_19_950_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="hl_varref"><span class="mpre">digitToInt</span></span></a><span class="mpre"> </span><a href="#loc_950_22_950_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_22_950_24&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">, </span><a href="#loc_950_25_950_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_25_950_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
</span><a href="#loc_950_1_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_1_950_13&#39;)"><span class="hl_fundecl"><span class="mpre">unEscapeByte</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Adapted from http://hackage.haskell.org/package/utf8-string</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by Eric Mertens, BSD3</span></span><span class="mpre">
</span><a href="#loc_957_1_957_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_1_957_13&#39;)"><span class="mpre">unEscapeUtf8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_957_1_957_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_1_957_13&#39;)"><span class="hl_fundecl"><span class="mpre">unEscapeUtf8</span></span></a><span class="mpre"> </span><a name="loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_957_16_957_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_16_957_20&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">
    | </span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_957_16_957_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_16_957_20&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
    | </span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> = </span><a href="#loc_967_5_967_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_5_967_26&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_957_16_957_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_16_957_20&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
    | </span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre"> = </span><a href="#loc_968_5_968_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_5_968_11&#39;)"><span class="hl_varref"><span class="mpre">multi1</span></span></a><span class="mpre">
    | </span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre"> = </span><a href="#loc_975_5_975_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_5_975_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x800</span></span><span class="mpre">
    | </span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf8</span></span><span class="mpre"> = </span><a href="#loc_975_5_975_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_5_975_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">
    | </span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfc</span></span><span class="mpre"> = </span><a href="#loc_975_5_975_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_5_975_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x200000</span></span><span class="mpre">
    | </span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfe</span></span><span class="mpre"> = </span><a href="#loc_975_5_975_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_5_975_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x4000000</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    = </span><a href="#loc_967_5_967_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_5_967_26&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_957_16_957_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_16_957_20&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
    where
    </span><a name="loc_967_5_967_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_5_967_26&#39;)"><span class="hl_vardecl"><span class="mpre">replacement_character</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;\xfffd&#39;</span></span><span class="mpre">
    </span><a name="loc_968_5_968_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_5_968_11&#39;)"><span class="hl_vardecl"><span class="mpre">multi1</span></span></a><span class="mpre"> = case </span><a href="#loc_950_1_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_1_950_13&#39;)"><span class="hl_varref"><span class="mpre">unEscapeByte</span></span></a><span class="mpre"> </span><a href="#loc_957_16_957_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_16_957_20&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_969_13_969_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_13_969_15&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre">, </span><a name="loc_969_17_969_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_17_969_19&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">) | </span><a href="#loc_969_13_969_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_13_969_15&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> -&gt;
        let </span><a name="loc_970_13_970_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_970_13_970_14&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = ((</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1f</span></span><span class="mpre">) </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre">  </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_969_13_969_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_13_969_15&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
        in if </span><a href="#loc_970_13_970_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_970_13_970_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x000080</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_970_13_970_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_970_13_970_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_969_17_969_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_17_969_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
                            else </span><a href="#loc_967_5_967_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_5_967_26&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_969_17_969_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_17_969_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
      _ -&gt; </span><a href="#loc_967_5_967_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_5_967_26&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_957_16_957_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_16_957_20&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">

    </span><a name="loc_975_5_975_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_5_975_15&#39;)"><span class="hl_fundecl"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><a name="loc_975_16_975_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_16_975_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_975_18_975_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_18_975_22&#39;)"><span class="hl_vardecl"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a name="loc_975_23_975_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_23_975_31&#39;)"><span class="hl_vardecl"><span class="mpre">overlong</span></span></a><span class="mpre"> =
      </span><a href="#loc_978_9_978_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_9_978_12&#39;)"><span class="hl_varref"><span class="mpre">aux</span></span></a><span class="mpre"> </span><a href="#loc_975_16_975_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_16_975_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_957_16_957_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_16_957_20&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> (</span><a href="#loc_950_1_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_1_950_13&#39;)"><span class="hl_varref"><span class="mpre">unEscapeByte</span></span></a><span class="mpre"> </span><a href="#loc_957_16_957_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_16_957_20&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">) (</span><a href="#loc_957_14_957_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_957_14_957_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><a href="#loc_975_18_975_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_18_975_22&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre">)
      where
        </span><a name="loc_978_9_978_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_9_978_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_978_15_978_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_15_978_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> _ </span><a name="loc_978_20_978_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_20_978_23&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
          | </span><a href="#loc_975_23_975_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_975_23_975_31&#39;)"><span class="hl_varref"><span class="mpre">overlong</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_978_20_978_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_20_978_23&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_978_20_978_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_20_978_23&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10ffff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
            (</span><a href="#loc_978_20_978_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_20_978_23&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xd800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xdfff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_978_20_978_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_20_978_23&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)     </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
            (</span><a href="#loc_978_20_978_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_20_978_23&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfffe</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xffff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_978_20_978_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_20_978_23&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)      = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><a href="#loc_978_20_978_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_20_978_23&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_978_15_978_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_15_978_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_967_5_967_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_5_967_26&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_978_15_978_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_15_978_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">

        </span><a href="#loc_978_9_978_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_9_978_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> </span><a name="loc_984_13_984_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_13_984_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_984_24_984_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_24_984_25&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">, </span><a name="loc_984_27_984_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_27_984_29&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">)) </span><a name="loc_984_32_984_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_32_984_35&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
          | </span><a href="#loc_984_24_984_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_24_984_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> = </span><a href="#loc_978_9_978_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_9_978_12&#39;)"><span class="hl_varref"><span class="mpre">aux</span></span></a><span class="mpre"> (</span><a href="#loc_984_13_984_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_13_984_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_984_27_984_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_27_984_29&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre"> (</span><a href="#loc_950_1_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_1_950_13&#39;)"><span class="hl_varref"><span class="mpre">unEscapeByte</span></span></a><span class="mpre"> </span><a href="#loc_984_27_984_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_27_984_29&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
                               </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_984_32_984_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_32_984_35&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><a href="#loc_984_24_984_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_24_984_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)

        </span><a href="#loc_978_9_978_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_9_978_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> _ </span><a name="loc_988_15_988_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_988_15_988_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> _ _ = </span><a href="#loc_967_5_967_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_5_967_26&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_944_1_944_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_15&#39;)"><span class="hl_varref"><span class="mpre">unEscapeString</span></span></a><span class="mpre"> </span><a href="#loc_988_15_988_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_988_15_988_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Resolving a relative URI relative to a base URI</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Returns a new &#39;URI&#39; which represents the value of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  first &#39;URI&#39; interpreted as relative to the second &#39;URI&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  For example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &gt; &quot;foo&quot; `relativeTo` &quot;http://bar.org/&quot; = &quot;http://bar.org/foo&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &gt; &quot;http:foo&quot; `nonStrictRelativeTo` &quot;http://bar.org/&quot; = &quot;http://bar.org/foo&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Algorithm from RFC3986 [3], section 5.2.2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><a href="#loc_1005_1_1005_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1005_1_1005_20&#39;)"><span class="mpre">nonStrictRelativeTo</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_1005_1_1005_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1005_1_1005_20&#39;)"><span class="hl_fundecl"><span class="mpre">nonStrictRelativeTo</span></span></a><span class="mpre"> </span><a name="loc_1005_21_1005_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1005_21_1005_24&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_1005_25_1005_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1005_25_1005_29&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> = </span><a href="#loc_1019_1_1019_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_1_1019_11&#39;)"><span class="hl_varref"><span class="mpre">relativeTo</span></span></a><span class="mpre"> </span><a href="#loc_1007_9_1007_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1007_9_1007_13&#39;)"><span class="hl_varref"><span class="mpre">ref&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1005_25_1005_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1005_25_1005_29&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre">
    where
        </span><a name="loc_1007_9_1007_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1007_9_1007_13&#39;)"><span class="hl_vardecl"><span class="mpre">ref&#39;</span></span></a><span class="mpre"> = if </span><a href="#loc_154_7_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_7_154_16&#39;)"><span class="hl_varref"><span class="mpre">uriScheme</span></span></a><span class="mpre"> </span><a href="#loc_1005_21_1005_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1005_21_1005_24&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_154_7_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_7_154_16&#39;)"><span class="hl_varref"><span class="mpre">uriScheme</span></span></a><span class="mpre"> </span><a href="#loc_1005_25_1005_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1005_25_1005_29&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre">
               then </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1008, srcSpanStartColumn = 21, srcSpanEndLine = 1008, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1008, srcSpanStartColumn = 25, srcSpanEndLine = 1008, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 10"><span class="mpre">ref { uriScheme=&quot;&quot; }</span></span><span class="mpre">
               else </span><a href="#loc_1005_21_1005_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1005_21_1005_24&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

</span><a href="#loc_1012_1_1012_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1012_1_1012_10&#39;)"><span class="mpre">isDefined</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1011, srcSpanStartColumn = 14, srcSpanEndLine = 1011, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1011, srcSpanStartColumn = 14, srcSpanEndLine = 1011, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1011"><span class="mpre">( MonadPlus m, Eq (m a) ) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_1012_1_1012_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1012_1_1012_10&#39;)"><span class="hl_fundecl"><span class="mpre">isDefined</span></span></a><span class="mpre"> </span><a name="loc_1012_11_1012_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1012_11_1012_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_1012_11_1012_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1012_11_1012_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Returns a new &#39;URI&#39; which represents the value of the first &#39;URI&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- interpreted as relative to the second &#39;URI&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Algorithm from RFC3986 [3], section 5.2</span></span><span class="mpre">
</span><a href="#loc_1019_1_1019_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_1_1019_11&#39;)"><span class="mpre">relativeTo</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_1019_1_1019_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_1_1019_11&#39;)"><span class="hl_fundecl"><span class="mpre">relativeTo</span></span></a><span class="mpre"> </span><a name="loc_1019_12_1019_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_12_1019_15&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">base</span></span><span class="mpre">
    | </span><a href="#loc_1012_1_1012_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1012_1_1012_10&#39;)"><span class="hl_varref"><span class="mpre">isDefined</span></span></a><span class="mpre"> ( </span><a href="#loc_154_7_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_7_154_16&#39;)"><span class="hl_varref"><span class="mpre">uriScheme</span></span></a><span class="mpre"> </span><a href="#loc_1019_12_1019_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_12_1019_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> ) =
        </span><a href="#loc_1050_9_1050_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_9_1050_22&#39;)"><span class="hl_varref"><span class="mpre">just_segments</span></span></a><span class="mpre"> </span><a href="#loc_1019_12_1019_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_12_1019_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
    | </span><a href="#loc_1012_1_1012_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1012_1_1012_10&#39;)"><span class="hl_varref"><span class="mpre">isDefined</span></span></a><span class="mpre"> ( </span><a href="#loc_155_7_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_7_155_19&#39;)"><span class="hl_varref"><span class="mpre">uriAuthority</span></span></a><span class="mpre"> </span><a href="#loc_1019_12_1019_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_12_1019_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> ) =
        </span><a href="#loc_1050_9_1050_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_9_1050_22&#39;)"><span class="hl_varref"><span class="mpre">just_segments</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1023, srcSpanStartColumn = 23, srcSpanEndLine = 1023, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1023, srcSpanStartColumn = 27, srcSpanEndLine = 1023, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 10"><span class="mpre">ref { uriScheme = uriScheme base }</span></span><span class="mpre">
    | </span><a href="#loc_1012_1_1012_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1012_1_1012_10&#39;)"><span class="hl_varref"><span class="mpre">isDefined</span></span></a><span class="mpre"> ( </span><a href="#loc_156_7_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_7_156_14&#39;)"><span class="hl_varref"><span class="mpre">uriPath</span></span></a><span class="mpre"> </span><a href="#loc_1019_12_1019_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_12_1019_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> ) =
        if (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> (</span><a href="#loc_156_7_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_7_156_14&#39;)"><span class="hl_varref"><span class="mpre">uriPath</span></span></a><span class="mpre"> </span><a href="#loc_1019_12_1019_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_12_1019_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">) then
            </span><a href="#loc_1050_9_1050_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_9_1050_22&#39;)"><span class="hl_varref"><span class="mpre">just_segments</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1026, srcSpanStartColumn = 27, srcSpanEndLine = 1029, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1027, srcSpanStartColumn = 17, srcSpanEndLine = 1027, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 10"><span class="mpre">ref
                { uriScheme    = uriScheme base
                , uriAuthority = uriAuthority base
                }</span></span><span class="mpre">
        else
            </span><a href="#loc_1050_9_1050_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_9_1050_22&#39;)"><span class="hl_varref"><span class="mpre">just_segments</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1031, srcSpanStartColumn = 27, srcSpanEndLine = 1035, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1032, srcSpanStartColumn = 17, srcSpanEndLine = 1032, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 10"><span class="mpre">ref
                { uriScheme    = uriScheme base
                , uriAuthority = uriAuthority base
                , uriPath      = mergePaths base ref
                }</span></span><span class="mpre">
    | </span><a href="#loc_1012_1_1012_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1012_1_1012_10&#39;)"><span class="hl_varref"><span class="mpre">isDefined</span></span></a><span class="mpre"> ( </span><a href="#loc_157_7_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_15&#39;)"><span class="hl_varref"><span class="mpre">uriQuery</span></span></a><span class="mpre"> </span><a href="#loc_1019_12_1019_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_12_1019_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> ) =
        </span><a href="#loc_1050_9_1050_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_9_1050_22&#39;)"><span class="hl_varref"><span class="mpre">just_segments</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1037, srcSpanStartColumn = 23, srcSpanEndLine = 1041, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1038, srcSpanStartColumn = 13, srcSpanEndLine = 1038, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 10"><span class="mpre">ref
            { uriScheme    = uriScheme base
            , uriAuthority = uriAuthority base
            , uriPath      = uriPath base
            }</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
        </span><a href="#loc_1050_9_1050_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_9_1050_22&#39;)"><span class="hl_varref"><span class="mpre">just_segments</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1043, srcSpanStartColumn = 23, srcSpanEndLine = 1048, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1044, srcSpanStartColumn = 13, srcSpanEndLine = 1044, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 10"><span class="mpre">ref
            { uriScheme    = uriScheme base
            , uriAuthority = uriAuthority base
            , uriPath      = uriPath base
            , uriQuery     = uriQuery base
            }</span></span><span class="mpre">
    where
        </span><a name="loc_1050_9_1050_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_9_1050_22&#39;)"><span class="hl_fundecl"><span class="mpre">just_segments</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">u</span></span><span class="mpre"> =
            </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1051, srcSpanStartColumn = 13, srcSpanEndLine = 1051, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1051, srcSpanStartColumn = 15, srcSpanEndLine = 1051, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 10"><span class="mpre">u { uriPath = removeDotSegments (uriPath u) }</span></span><span class="mpre">
        </span><span class="hl_fundecl"><span class="mpre">mergePaths</span></span><span class="mpre"> </span><a name="loc_1052_20_1052_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1052_20_1052_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_1052_22_1052_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1052_22_1052_23&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">
            | </span><a href="#loc_1012_1_1012_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1012_1_1012_10&#39;)"><span class="hl_varref"><span class="mpre">isDefined</span></span></a><span class="mpre"> (</span><a href="#loc_155_7_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_7_155_19&#39;)"><span class="hl_varref"><span class="mpre">uriAuthority</span></span></a><span class="mpre"> </span><a href="#loc_1052_20_1052_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1052_20_1052_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_1056_17_1056_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1056_17_1056_19&#39;)"><span class="hl_varref"><span class="mpre">pb</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1057_17_1057_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1057_17_1057_19&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                             = </span><a href="#loc_1058_9_1058_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1058_9_1058_17&#39;)"><span class="hl_varref"><span class="mpre">dropLast</span></span></a><span class="mpre"> </span><a href="#loc_1056_17_1056_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1056_17_1056_19&#39;)"><span class="hl_varref"><span class="mpre">pb</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_1057_17_1057_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1057_17_1057_19&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
            where
                </span><a name="loc_1056_17_1056_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1056_17_1056_19&#39;)"><span class="hl_vardecl"><span class="mpre">pb</span></span></a><span class="mpre"> = </span><a href="#loc_156_7_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_7_156_14&#39;)"><span class="hl_varref"><span class="mpre">uriPath</span></span></a><span class="mpre"> </span><a href="#loc_1052_20_1052_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1052_20_1052_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                </span><a name="loc_1057_17_1057_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1057_17_1057_19&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre"> = </span><a href="#loc_156_7_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_7_156_14&#39;)"><span class="hl_varref"><span class="mpre">uriPath</span></span></a><span class="mpre"> </span><a href="#loc_1052_22_1052_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1052_22_1052_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
        </span><a name="loc_1058_9_1058_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1058_9_1058_17&#39;)"><span class="hl_vardecl"><span class="mpre">dropLast</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1089_1_1089_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1089_1_1089_10&#39;)"><span class="hl_varref"><span class="mpre">splitLast</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- reverse . dropWhile (/=&#39;/&#39;) . reverse</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  Remove dot segments, but protect leading &#39;/&#39; character</span></span><span class="mpre">
</span><a href="#loc_1062_1_1062_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_1_1062_18&#39;)"><span class="mpre">removeDotSegments</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1062_1_1062_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_1_1062_18&#39;)"><span class="hl_fundecl"><span class="mpre">removeDotSegments</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1062_24_1062_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_24_1062_26&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) = </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_varref"><span class="mpre">elimDots</span></span></a><span class="mpre"> </span><a href="#loc_1062_24_1062_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_24_1062_26&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> []
</span><a href="#loc_1062_1_1062_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_1_1062_18&#39;)"><span class="hl_fundecl"><span class="mpre">removeDotSegments</span></span></a><span class="mpre"> </span><a name="loc_1063_19_1063_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1063_19_1063_21&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">       = </span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_varref"><span class="mpre">elimDots</span></span></a><span class="mpre"> </span><a href="#loc_1063_19_1063_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1063_19_1063_21&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> []

</span><span class="hl_comment"><span class="mpre">--  Second arg accumulates segments processed so far in reverse order</span></span><span class="mpre">
</span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="mpre">elimDots</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- elimDots ps rs | traceVal &quot;\nps &quot; ps $ traceVal &quot;rs &quot; rs $ False = error &quot;&quot;</span></span><span class="mpre">
</span><a name="loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_fundecl"><span class="mpre">elimDots</span></span></a><span class="mpre"> [] [] = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
</span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_fundecl"><span class="mpre">elimDots</span></span></a><span class="mpre"> [] </span><a name="loc_1069_13_1069_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1069_13_1069_15&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_1069_13_1069_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1069_13_1069_15&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
</span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_fundecl"><span class="mpre">elimDots</span></span></a><span class="mpre"> (    </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1070_23_1070_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1070_23_1070_25&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">)     </span><a name="loc_1070_31_1070_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1070_31_1070_33&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_varref"><span class="mpre">elimDots</span></span></a><span class="mpre"> </span><a href="#loc_1070_23_1070_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1070_23_1070_25&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_1070_31_1070_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1070_31_1070_33&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
</span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_fundecl"><span class="mpre">elimDots</span></span></a><span class="mpre"> (    </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]    )     </span><a name="loc_1071_31_1071_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_31_1071_33&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_varref"><span class="mpre">elimDots</span></span></a><span class="mpre"> [] </span><a href="#loc_1071_31_1071_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_31_1071_33&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
</span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_fundecl"><span class="mpre">elimDots</span></span></a><span class="mpre"> (    </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1072_27_1072_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1072_27_1072_29&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) </span><a name="loc_1072_31_1072_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1072_31_1072_33&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_varref"><span class="mpre">elimDots</span></span></a><span class="mpre"> </span><a href="#loc_1072_27_1072_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1072_27_1072_29&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_1072_31_1072_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1072_31_1072_33&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
</span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_fundecl"><span class="mpre">elimDots</span></span></a><span class="mpre"> (    </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]    ) </span><a name="loc_1073_31_1073_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1073_31_1073_33&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_varref"><span class="mpre">elimDots</span></span></a><span class="mpre"> [] (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_1073_31_1073_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1073_31_1073_33&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
</span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_fundecl"><span class="mpre">elimDots</span></span></a><span class="mpre"> </span><a name="loc_1074_10_1074_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1074_10_1074_12&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a name="loc_1074_13_1074_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1074_13_1074_15&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><a href="#loc_1068_1_1068_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1068_1_1068_9&#39;)"><span class="hl_varref"><span class="mpre">elimDots</span></span></a><span class="mpre"> </span><a href="#loc_1076_12_1076_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_12_1076_15&#39;)"><span class="hl_varref"><span class="mpre">ps1</span></span></a><span class="mpre"> (</span><a href="#loc_1076_10_1076_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_10_1076_11&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1074_13_1074_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1074_13_1074_15&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
    where
        (</span><a name="loc_1076_10_1076_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_10_1076_11&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">,</span><a name="loc_1076_12_1076_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_12_1076_15&#39;)"><span class="hl_vardecl"><span class="mpre">ps1</span></span></a><span class="mpre">) = </span><a href="#loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="hl_varref"><span class="mpre">nextSegment</span></span></a><span class="mpre"> </span><a href="#loc_1074_10_1074_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1074_10_1074_12&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  Returns the next segment and the rest of the path from a path string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Each segment ends with the next &#39;/&#39; or the end of string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="mpre">nextSegment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="hl_fundecl"><span class="mpre">nextSegment</span></span></a><span class="mpre"> </span><a name="loc_1082_13_1082_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_13_1082_15&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> =
    case </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">) </span><a href="#loc_1082_13_1082_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_13_1082_15&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> of
        (</span><a name="loc_1084_10_1084_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_10_1084_11&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">,</span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1084_16_1084_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_16_1084_19&#39;)"><span class="hl_vardecl"><span class="mpre">ps1</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_1084_10_1084_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_10_1084_11&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">,</span><a href="#loc_1084_16_1084_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_16_1084_19&#39;)"><span class="hl_varref"><span class="mpre">ps1</span></span></a><span class="mpre">)
        (</span><a name="loc_1085_10_1085_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1085_10_1085_11&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">,_)       -&gt; (</span><a href="#loc_1085_10_1085_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1085_10_1085_11&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">,[])

</span><span class="hl_comment"><span class="mpre">--  Split last (name) segment from path, returning (path,name)</span></span><span class="mpre">
</span><a href="#loc_1089_1_1089_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1089_1_1089_10&#39;)"><span class="mpre">splitLast</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_1089_1_1089_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1089_1_1089_10&#39;)"><span class="hl_fundecl"><span class="mpre">splitLast</span></span></a><span class="mpre"> </span><a name="loc_1089_11_1089_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1089_11_1089_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_1091_18_1091_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1091_18_1091_25&#39;)"><span class="hl_varref"><span class="mpre">revpath</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_1091_10_1091_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1091_10_1091_17&#39;)"><span class="hl_varref"><span class="mpre">revname</span></span></a><span class="mpre">)
    where
        (</span><a name="loc_1091_10_1091_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1091_10_1091_17&#39;)"><span class="hl_vardecl"><span class="mpre">revname</span></span></a><span class="mpre">,</span><a name="loc_1091_18_1091_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1091_18_1091_25&#39;)"><span class="hl_vardecl"><span class="mpre">revpath</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_1089_11_1089_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1089_11_1089_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Finding a URI relative to a base URI</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Returns a new &#39;URI&#39; which represents the relative location of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  the first &#39;URI&#39; with respect to the second &#39;URI&#39;.  Thus, the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  values supplied are expected to be absolute URIs, and the result</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  returned may be a relative URI.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &gt; &quot;http://example.com/Root/sub1/name2#frag&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &gt;   `relativeFrom` &quot;http://example.com/Root/sub2/name2#frag&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &gt;   == &quot;../sub1/name2#frag&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  There is no single correct implementation of this function,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  but any acceptable implementation must satisfy the following:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &gt; (uabs `relativeFrom` ubase) `relativeTo` ubase == uabs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  For any valid absolute URI.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (cf. &lt;http://lists.w3.org/Archives/Public/uri/2003Jan/0008.html&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       &lt;http://lists.w3.org/Archives/Public/uri/2003Jan/0005.html&gt;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1118_1_1118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_1_1118_13&#39;)"><span class="mpre">relativeFrom</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_1118_1_1118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_1_1118_13&#39;)"><span class="hl_fundecl"><span class="mpre">relativeFrom</span></span></a><span class="mpre"> </span><a name="loc_1118_14_1118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_14_1118_18&#39;)"><span class="hl_vardecl"><span class="mpre">uabs</span></span></a><span class="mpre"> </span><a name="loc_1118_19_1118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_19_1118_23&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre">
    | </span><a href="#loc_1140_9_1140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_9_1140_13&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><a href="#loc_154_7_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_7_154_16&#39;)"><span class="hl_varref"><span class="mpre">uriScheme</span></span></a><span class="mpre">    </span><a href="#loc_1118_14_1118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_14_1118_18&#39;)"><span class="hl_varref"><span class="mpre">uabs</span></span></a><span class="mpre"> </span><a href="#loc_1118_19_1118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_19_1118_23&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> = </span><a href="#loc_1118_14_1118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_14_1118_18&#39;)"><span class="hl_varref"><span class="mpre">uabs</span></span></a><span class="mpre">
    | </span><a href="#loc_1140_9_1140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_9_1140_13&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><a href="#loc_155_7_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_7_155_19&#39;)"><span class="hl_varref"><span class="mpre">uriAuthority</span></span></a><span class="mpre"> </span><a href="#loc_1118_14_1118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_14_1118_18&#39;)"><span class="hl_varref"><span class="mpre">uabs</span></span></a><span class="mpre"> </span><a href="#loc_1118_19_1118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_19_1118_23&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1120, srcSpanStartColumn = 37, srcSpanEndLine = 1120, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1120, srcSpanStartColumn = 42, srcSpanEndLine = 1120, srcSpanEndColumn = 43},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 11"><span class="mpre">uabs { uriScheme = &quot;&quot; }</span></span><span class="mpre">
    | </span><a href="#loc_1140_9_1140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_9_1140_13&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><a href="#loc_156_7_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_7_156_14&#39;)"><span class="hl_varref"><span class="mpre">uriPath</span></span></a><span class="mpre">      </span><a href="#loc_1118_14_1118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_14_1118_18&#39;)"><span class="hl_varref"><span class="mpre">uabs</span></span></a><span class="mpre"> </span><a href="#loc_1118_19_1118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_19_1118_23&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1121, srcSpanStartColumn = 37, srcSpanEndLine = 1126, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1122, srcSpanStartColumn = 9, srcSpanEndLine = 1122, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 112"><span class="mpre">uabs
        { uriScheme    = &quot;&quot;
        , uriAuthority = Nothing
        , uriPath      = relPathFrom (removeBodyDotSegments $ uriPath uabs)
                                     (removeBodyDotSegments $ uriPath base)
        }</span></span><span class="mpre">
    | </span><a href="#loc_1140_9_1140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_9_1140_13&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><a href="#loc_157_7_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_15&#39;)"><span class="hl_varref"><span class="mpre">uriQuery</span></span></a><span class="mpre">     </span><a href="#loc_1118_14_1118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_14_1118_18&#39;)"><span class="hl_varref"><span class="mpre">uabs</span></span></a><span class="mpre"> </span><a href="#loc_1118_19_1118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_19_1118_23&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1127, srcSpanStartColumn = 37, srcSpanEndLine = 1131, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1128, srcSpanStartColumn = 9, srcSpanEndLine = 1128, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 112"><span class="mpre">uabs
        { uriScheme    = &quot;&quot;
        , uriAuthority = Nothing
        , uriPath      = &quot;&quot;
        }</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1132, srcSpanStartColumn = 19, srcSpanEndLine = 1137, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1133, srcSpanStartColumn = 9, srcSpanEndLine = 1133, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 113"><span class="mpre">uabs          </span><span class="hl_comment"><span class="mpre">-- Always carry fragment from uabs</span></span><span class="mpre">
        { uriScheme    = &quot;&quot;
        , uriAuthority = Nothing
        , uriPath      = &quot;&quot;
        , uriQuery     = &quot;&quot;
        }</span></span><span class="mpre">
    where
        </span><a href="#loc_1140_9_1140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_9_1140_13&#39;)"><span class="mpre">diff</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1139, srcSpanStartColumn = 17, srcSpanEndLine = 1139, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1139, srcSpanStartColumn = 22, srcSpanEndLine = 1139, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/"><span class="mpre">Eq b =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
        </span><a name="loc_1140_9_1140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_9_1140_13&#39;)"><span class="hl_fundecl"><span class="mpre">diff</span></span></a><span class="mpre"> </span><a name="loc_1140_14_1140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_14_1140_17&#39;)"><span class="hl_vardecl"><span class="mpre">sel</span></span></a><span class="mpre"> </span><a name="loc_1140_18_1140_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_18_1140_20&#39;)"><span class="hl_vardecl"><span class="mpre">u1</span></span></a><span class="mpre"> </span><a name="loc_1140_21_1140_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_21_1140_23&#39;)"><span class="hl_vardecl"><span class="mpre">u2</span></span></a><span class="mpre"> = </span><a href="#loc_1140_14_1140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_14_1140_17&#39;)"><span class="hl_varref"><span class="mpre">sel</span></span></a><span class="mpre"> </span><a href="#loc_1140_18_1140_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_18_1140_20&#39;)"><span class="hl_varref"><span class="mpre">u1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_1140_14_1140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_14_1140_17&#39;)"><span class="hl_varref"><span class="mpre">sel</span></span></a><span class="mpre"> </span><a href="#loc_1140_21_1140_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_21_1140_23&#39;)"><span class="hl_varref"><span class="mpre">u2</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Remove dot segments except the final segment</span></span><span class="mpre">
        </span><span class="hl_fundecl"><span class="mpre">removeBodyDotSegments</span></span><span class="mpre"> </span><a name="loc_1142_31_1142_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1142_31_1142_32&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_1062_1_1062_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_1_1062_18&#39;)"><span class="hl_varref"><span class="mpre">removeDotSegments</span></span></a><span class="mpre"> </span><a href="#loc_1144_18_1144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1144_18_1144_20&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_1144_21_1144_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1144_21_1144_23&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre">
            where
                (</span><a name="loc_1144_18_1144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1144_18_1144_20&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre">,</span><a name="loc_1144_21_1144_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1144_21_1144_23&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="mpre">) = </span><a href="#loc_1089_1_1089_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1089_1_1089_10&#39;)"><span class="hl_varref"><span class="mpre">splitLast</span></span></a><span class="mpre"> </span><a href="#loc_1142_31_1142_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1142_31_1142_32&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_1147_1_1147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1147_1_1147_12&#39;)"><span class="mpre">relPathFrom</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1147_1_1147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1147_1_1147_12&#39;)"><span class="hl_fundecl"><span class="mpre">relPathFrom</span></span></a><span class="mpre"> []   _    = </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">
</span><a href="#loc_1147_1_1147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1147_1_1147_12&#39;)"><span class="hl_fundecl"><span class="mpre">relPathFrom</span></span></a><span class="mpre"> </span><a name="loc_1148_13_1148_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_13_1148_17&#39;)"><span class="hl_vardecl"><span class="mpre">pabs</span></span></a><span class="mpre"> []   = </span><a href="#loc_1148_13_1148_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_13_1148_17&#39;)"><span class="hl_varref"><span class="mpre">pabs</span></span></a><span class="mpre">
</span><a href="#loc_1147_1_1147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1147_1_1147_12&#39;)"><span class="hl_fundecl"><span class="mpre">relPathFrom</span></span></a><span class="mpre"> </span><a name="loc_1149_13_1149_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_13_1149_17&#39;)"><span class="hl_vardecl"><span class="mpre">pabs</span></span></a><span class="mpre"> </span><a name="loc_1149_18_1149_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_18_1149_22&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> =                 </span><span class="hl_comment"><span class="mpre">-- Construct a relative path segments</span></span><span class="mpre">
    if </span><a href="#loc_1158_10_1158_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_10_1158_13&#39;)"><span class="hl_varref"><span class="mpre">sa1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_1159_10_1159_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1159_10_1159_13&#39;)"><span class="hl_varref"><span class="mpre">sb1</span></span></a><span class="mpre">                       </span><span class="hl_comment"><span class="mpre">-- if the paths share a leading segment</span></span><span class="mpre">
        then if (</span><a href="#loc_1158_10_1158_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_10_1158_13&#39;)"><span class="hl_varref"><span class="mpre">sa1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">)            </span><span class="hl_comment"><span class="mpre">-- other than a leading &#39;/&#39;</span></span><span class="mpre">
            then if (</span><a href="#loc_1160_10_1160_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1160_10_1160_13&#39;)"><span class="hl_varref"><span class="mpre">sa2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_1161_10_1161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1161_10_1161_13&#39;)"><span class="hl_varref"><span class="mpre">sb2</span></span></a><span class="mpre">)
                then </span><a href="#loc_1167_1_1167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1167_1_1167_13&#39;)"><span class="hl_varref"><span class="mpre">relPathFrom1</span></span></a><span class="mpre"> </span><a href="#loc_1160_14_1160_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1160_14_1160_17&#39;)"><span class="hl_varref"><span class="mpre">ra2</span></span></a><span class="mpre"> </span><a href="#loc_1161_14_1161_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1161_14_1161_17&#39;)"><span class="hl_varref"><span class="mpre">rb2</span></span></a><span class="mpre">
                else </span><a href="#loc_1149_13_1149_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_13_1149_17&#39;)"><span class="hl_varref"><span class="mpre">pabs</span></span></a><span class="mpre">
            else </span><a href="#loc_1167_1_1167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1167_1_1167_13&#39;)"><span class="hl_varref"><span class="mpre">relPathFrom1</span></span></a><span class="mpre"> </span><a href="#loc_1158_14_1158_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_14_1158_17&#39;)"><span class="hl_varref"><span class="mpre">ra1</span></span></a><span class="mpre"> </span><a href="#loc_1159_14_1159_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1159_14_1159_17&#39;)"><span class="hl_varref"><span class="mpre">rb1</span></span></a><span class="mpre">
        else </span><a href="#loc_1149_13_1149_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_13_1149_17&#39;)"><span class="hl_varref"><span class="mpre">pabs</span></span></a><span class="mpre">
    where
        (</span><a name="loc_1158_10_1158_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_10_1158_13&#39;)"><span class="hl_vardecl"><span class="mpre">sa1</span></span></a><span class="mpre">,</span><a name="loc_1158_14_1158_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_14_1158_17&#39;)"><span class="hl_vardecl"><span class="mpre">ra1</span></span></a><span class="mpre">) = </span><a href="#loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="hl_varref"><span class="mpre">nextSegment</span></span></a><span class="mpre"> </span><a href="#loc_1149_13_1149_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_13_1149_17&#39;)"><span class="hl_varref"><span class="mpre">pabs</span></span></a><span class="mpre">
        (</span><a name="loc_1159_10_1159_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1159_10_1159_13&#39;)"><span class="hl_vardecl"><span class="mpre">sb1</span></span></a><span class="mpre">,</span><a name="loc_1159_14_1159_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1159_14_1159_17&#39;)"><span class="hl_vardecl"><span class="mpre">rb1</span></span></a><span class="mpre">) = </span><a href="#loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="hl_varref"><span class="mpre">nextSegment</span></span></a><span class="mpre"> </span><a href="#loc_1149_18_1149_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_18_1149_22&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre">
        (</span><a name="loc_1160_10_1160_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1160_10_1160_13&#39;)"><span class="hl_vardecl"><span class="mpre">sa2</span></span></a><span class="mpre">,</span><a name="loc_1160_14_1160_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1160_14_1160_17&#39;)"><span class="hl_vardecl"><span class="mpre">ra2</span></span></a><span class="mpre">) = </span><a href="#loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="hl_varref"><span class="mpre">nextSegment</span></span></a><span class="mpre"> </span><a href="#loc_1158_14_1158_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_14_1158_17&#39;)"><span class="hl_varref"><span class="mpre">ra1</span></span></a><span class="mpre">
        (</span><a name="loc_1161_10_1161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1161_10_1161_13&#39;)"><span class="hl_vardecl"><span class="mpre">sb2</span></span></a><span class="mpre">,</span><a name="loc_1161_14_1161_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1161_14_1161_17&#39;)"><span class="hl_vardecl"><span class="mpre">rb2</span></span></a><span class="mpre">) = </span><a href="#loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="hl_varref"><span class="mpre">nextSegment</span></span></a><span class="mpre"> </span><a href="#loc_1159_14_1159_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1159_14_1159_17&#39;)"><span class="hl_varref"><span class="mpre">rb1</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  relPathFrom1 strips off trailing names from the supplied paths,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  and calls difPathFrom to find the relative path from base to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  target</span></span><span class="mpre">
</span><a href="#loc_1167_1_1167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1167_1_1167_13&#39;)"><span class="mpre">relPathFrom1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1167_1_1167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1167_1_1167_13&#39;)"><span class="hl_fundecl"><span class="mpre">relPathFrom1</span></span></a><span class="mpre"> </span><a name="loc_1167_14_1167_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1167_14_1167_18&#39;)"><span class="hl_vardecl"><span class="mpre">pabs</span></span></a><span class="mpre"> </span><a name="loc_1167_19_1167_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1167_19_1167_23&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> = </span><a href="#loc_1172_9_1172_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_9_1172_16&#39;)"><span class="hl_varref"><span class="mpre">relName</span></span></a><span class="mpre">
    where
        (</span><a name="loc_1169_10_1169_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1169_10_1169_12&#39;)"><span class="hl_vardecl"><span class="mpre">sa</span></span></a><span class="mpre">,</span><a name="loc_1169_13_1169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1169_13_1169_15&#39;)"><span class="hl_vardecl"><span class="mpre">na</span></span></a><span class="mpre">) = </span><a href="#loc_1089_1_1089_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1089_1_1089_10&#39;)"><span class="hl_varref"><span class="mpre">splitLast</span></span></a><span class="mpre"> </span><a href="#loc_1167_14_1167_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1167_14_1167_18&#39;)"><span class="hl_varref"><span class="mpre">pabs</span></span></a><span class="mpre">
        (</span><a name="loc_1170_10_1170_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1170_10_1170_12&#39;)"><span class="hl_vardecl"><span class="mpre">sb</span></span></a><span class="mpre">,</span><a name="loc_1170_13_1170_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1170_13_1170_15&#39;)"><span class="hl_vardecl"><span class="mpre">nb</span></span></a><span class="mpre">) = </span><a href="#loc_1089_1_1089_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1089_1_1089_10&#39;)"><span class="hl_varref"><span class="mpre">splitLast</span></span></a><span class="mpre"> </span><a href="#loc_1167_19_1167_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1167_19_1167_23&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre">
        </span><a name="loc_1171_9_1171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_9_1171_11&#39;)"><span class="hl_vardecl"><span class="mpre">rp</span></span></a><span class="mpre">      = </span><a href="#loc_1193_1_1193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1193_1_1193_12&#39;)"><span class="hl_varref"><span class="mpre">relSegsFrom</span></span></a><span class="mpre"> </span><a href="#loc_1169_10_1169_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1169_10_1169_12&#39;)"><span class="hl_varref"><span class="mpre">sa</span></span></a><span class="mpre"> </span><a href="#loc_1170_10_1170_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1170_10_1170_12&#39;)"><span class="hl_varref"><span class="mpre">sb</span></span></a><span class="mpre">
        </span><a name="loc_1172_9_1172_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_9_1172_16&#39;)"><span class="hl_vardecl"><span class="mpre">relName</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_1171_9_1171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_9_1171_11&#39;)"><span class="hl_varref"><span class="mpre">rp</span></span></a><span class="mpre"> then
                      if (</span><a href="#loc_1169_13_1169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1169_13_1169_15&#39;)"><span class="hl_varref"><span class="mpre">na</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_1170_13_1170_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1170_13_1170_15&#39;)"><span class="hl_varref"><span class="mpre">nb</span></span></a><span class="mpre">) then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                      else if </span><a href="#loc_1179_9_1179_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1179_9_1179_16&#39;)"><span class="hl_varref"><span class="mpre">protect</span></span></a><span class="mpre"> </span><a href="#loc_1169_13_1169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1169_13_1169_15&#39;)"><span class="hl_varref"><span class="mpre">na</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;./&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_1169_13_1169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1169_13_1169_15&#39;)"><span class="hl_varref"><span class="mpre">na</span></span></a><span class="mpre">
                      else </span><a href="#loc_1169_13_1169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1169_13_1169_15&#39;)"><span class="hl_varref"><span class="mpre">na</span></span></a><span class="mpre">
                  else
                      </span><a href="#loc_1171_9_1171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_9_1171_11&#39;)"><span class="hl_varref"><span class="mpre">rp</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_1169_13_1169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1169_13_1169_15&#39;)"><span class="hl_varref"><span class="mpre">na</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Precede name with some path if it is null or contains a &#39;:&#39;</span></span><span class="mpre">
        </span><a name="loc_1179_9_1179_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1179_9_1179_16&#39;)"><span class="hl_fundecl"><span class="mpre">protect</span></span></a><span class="mpre"> </span><a name="loc_1179_17_1179_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1179_17_1179_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_1179_17_1179_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1179_17_1179_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_1179_17_1179_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1179_17_1179_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  relSegsFrom discards any common leading segments from both paths,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  then invokes difSegsFrom to calculate a relative path from the end</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  of the base path to the end of the target path.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  The final name is handled separately, so this deals only with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &quot;directory&quot; segtments.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1193_1_1193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1193_1_1193_12&#39;)"><span class="mpre">relSegsFrom</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-
relSegsFrom sabs base
    | traceVal &quot;\nrelSegsFrom\nsabs &quot; sabs $ traceVal &quot;base &quot; base $
      False = error &quot;&quot;
-}</span></span><span class="mpre">
</span><a name="loc_1193_1_1193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1193_1_1193_12&#39;)"><span class="hl_fundecl"><span class="mpre">relSegsFrom</span></span></a><span class="mpre"> []   []   = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- paths are identical</span></span><span class="mpre">
</span><a href="#loc_1193_1_1193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1193_1_1193_12&#39;)"><span class="hl_fundecl"><span class="mpre">relSegsFrom</span></span></a><span class="mpre"> </span><a name="loc_1194_13_1194_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1194_13_1194_17&#39;)"><span class="hl_vardecl"><span class="mpre">sabs</span></span></a><span class="mpre"> </span><a name="loc_1194_18_1194_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1194_18_1194_22&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> =
    if </span><a href="#loc_1199_10_1199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1199_10_1199_13&#39;)"><span class="hl_varref"><span class="mpre">sa1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_1200_10_1200_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1200_10_1200_13&#39;)"><span class="hl_varref"><span class="mpre">sb1</span></span></a><span class="mpre">
        then </span><a href="#loc_1193_1_1193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1193_1_1193_12&#39;)"><span class="hl_varref"><span class="mpre">relSegsFrom</span></span></a><span class="mpre"> </span><a href="#loc_1199_14_1199_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1199_14_1199_17&#39;)"><span class="hl_varref"><span class="mpre">ra1</span></span></a><span class="mpre"> </span><a href="#loc_1200_14_1200_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1200_14_1200_17&#39;)"><span class="hl_varref"><span class="mpre">rb1</span></span></a><span class="mpre">
        else </span><a href="#loc_1216_1_1216_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1216_1_1216_12&#39;)"><span class="hl_varref"><span class="mpre">difSegsFrom</span></span></a><span class="mpre"> </span><a href="#loc_1194_13_1194_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1194_13_1194_17&#39;)"><span class="hl_varref"><span class="mpre">sabs</span></span></a><span class="mpre"> </span><a href="#loc_1194_18_1194_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1194_18_1194_22&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre">
    where
        (</span><a name="loc_1199_10_1199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1199_10_1199_13&#39;)"><span class="hl_vardecl"><span class="mpre">sa1</span></span></a><span class="mpre">,</span><a name="loc_1199_14_1199_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1199_14_1199_17&#39;)"><span class="hl_vardecl"><span class="mpre">ra1</span></span></a><span class="mpre">) = </span><a href="#loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="hl_varref"><span class="mpre">nextSegment</span></span></a><span class="mpre"> </span><a href="#loc_1194_13_1194_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1194_13_1194_17&#39;)"><span class="hl_varref"><span class="mpre">sabs</span></span></a><span class="mpre">
        (</span><a name="loc_1200_10_1200_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1200_10_1200_13&#39;)"><span class="hl_vardecl"><span class="mpre">sb1</span></span></a><span class="mpre">,</span><a name="loc_1200_14_1200_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1200_14_1200_17&#39;)"><span class="hl_vardecl"><span class="mpre">rb1</span></span></a><span class="mpre">) = </span><a href="#loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="hl_varref"><span class="mpre">nextSegment</span></span></a><span class="mpre"> </span><a href="#loc_1194_18_1194_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1194_18_1194_22&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  difSegsFrom calculates a path difference from base to target,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  not including the final name at the end of the path</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (i.e. results always ends with &#39;/&#39;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  This function operates under the invariant that the supplied</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  value of sabs is the desired path relative to the beginning of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  base.  Thus, when base is empty, the desired path has been found.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1216_1_1216_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1216_1_1216_12&#39;)"><span class="mpre">difSegsFrom</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-
difSegsFrom sabs base
    | traceVal &quot;\ndifSegsFrom\nsabs &quot; sabs $ traceVal &quot;base &quot; base $
      False = error &quot;&quot;
-}</span></span><span class="mpre">
</span><a name="loc_1216_1_1216_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1216_1_1216_12&#39;)"><span class="hl_fundecl"><span class="mpre">difSegsFrom</span></span></a><span class="mpre"> </span><a name="loc_1216_13_1216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1216_13_1216_17&#39;)"><span class="hl_vardecl"><span class="mpre">sabs</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">   = </span><a href="#loc_1216_13_1216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1216_13_1216_17&#39;)"><span class="hl_varref"><span class="mpre">sabs</span></span></a><span class="mpre">
</span><a href="#loc_1216_1_1216_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1216_1_1216_12&#39;)"><span class="hl_fundecl"><span class="mpre">difSegsFrom</span></span></a><span class="mpre"> </span><a name="loc_1217_13_1217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1217_13_1217_17&#39;)"><span class="hl_vardecl"><span class="mpre">sabs</span></span></a><span class="mpre"> </span><a name="loc_1217_18_1217_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1217_18_1217_22&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> = </span><a href="#loc_1216_1_1216_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1216_1_1216_12&#39;)"><span class="hl_varref"><span class="mpre">difSegsFrom</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;../&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_1217_13_1217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1217_13_1217_17&#39;)"><span class="hl_varref"><span class="mpre">sabs</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_1082_1_1082_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1082_1_1082_12&#39;)"><span class="hl_varref"><span class="mpre">nextSegment</span></span></a><span class="mpre"> </span><a href="#loc_1217_18_1217_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1217_18_1217_22&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Other normalization functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Case normalization; cf. RFC3986 section 6.2.2.1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  NOTE:  authority case normalization is not performed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1227_1_1227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1227_1_1227_14&#39;)"><span class="mpre">normalizeCase</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1227_1_1227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1227_1_1227_14&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeCase</span></span></a><span class="mpre"> </span><a name="loc_1227_15_1227_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1227_15_1227_21&#39;)"><span class="hl_vardecl"><span class="mpre">uristr</span></span></a><span class="mpre"> = </span><a href="#loc_1229_9_1229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1229_9_1229_17&#39;)"><span class="hl_varref"><span class="mpre">ncScheme</span></span></a><span class="mpre"> </span><a href="#loc_1227_15_1227_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1227_15_1227_21&#39;)"><span class="hl_varref"><span class="mpre">uristr</span></span></a><span class="mpre">
    where
        </span><a name="loc_1229_9_1229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1229_9_1229_17&#39;)"><span class="hl_fundecl"><span class="mpre">ncScheme</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1229_23_1229_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1229_23_1229_25&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)                = </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1232_9_1232_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_9_1232_17&#39;)"><span class="hl_varref"><span class="mpre">ncEscape</span></span></a><span class="mpre"> </span><a href="#loc_1229_23_1229_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1229_23_1229_25&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
        </span><a href="#loc_1229_9_1229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1229_9_1229_17&#39;)"><span class="hl_fundecl"><span class="mpre">ncScheme</span></span></a><span class="mpre"> (</span><a name="loc_1230_19_1230_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_19_1230_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1230_21_1230_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_21_1230_23&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) | </span><a href="#loc_796_1_796_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_1_796_13&#39;)"><span class="hl_varref"><span class="mpre">isSchemeChar</span></span></a><span class="mpre"> </span><a href="#loc_1230_19_1230_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_19_1230_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_1230_19_1230_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_19_1230_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1229_9_1229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1229_9_1229_17&#39;)"><span class="hl_varref"><span class="mpre">ncScheme</span></span></a><span class="mpre"> </span><a href="#loc_1230_21_1230_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_21_1230_23&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
        </span><a href="#loc_1229_9_1229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1229_9_1229_17&#39;)"><span class="hl_fundecl"><span class="mpre">ncScheme</span></span></a><span class="mpre"> _                       = </span><a href="#loc_1232_9_1232_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_9_1232_17&#39;)"><span class="hl_varref"><span class="mpre">ncEscape</span></span></a><span class="mpre"> </span><a href="#loc_1227_15_1227_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1227_15_1227_21&#39;)"><span class="hl_varref"><span class="mpre">uristr</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- no scheme present</span></span><span class="mpre">
        </span><a name="loc_1232_9_1232_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_9_1232_17&#39;)"><span class="hl_fundecl"><span class="mpre">ncEscape</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1232_23_1232_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_23_1232_25&#39;)"><span class="hl_vardecl"><span class="mpre">h1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1232_26_1232_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_26_1232_28&#39;)"><span class="hl_vardecl"><span class="mpre">h2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1232_29_1232_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_29_1232_31&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="GHC.Unicode.html#loc_144_1_144_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_144_1_144_8&#39;)"><span class="hl_varref"><span class="mpre">toUpper</span></span></a><span class="mpre"> </span><a href="#loc_1232_23_1232_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_23_1232_25&#39;)"><span class="hl_varref"><span class="mpre">h1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="GHC.Unicode.html#loc_144_1_144_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_144_1_144_8&#39;)"><span class="hl_varref"><span class="mpre">toUpper</span></span></a><span class="mpre"> </span><a href="#loc_1232_26_1232_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_26_1232_28&#39;)"><span class="hl_varref"><span class="mpre">h2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1232_9_1232_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_9_1232_17&#39;)"><span class="hl_varref"><span class="mpre">ncEscape</span></span></a><span class="mpre"> </span><a href="#loc_1232_29_1232_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_29_1232_31&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
        </span><a href="#loc_1232_9_1232_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_9_1232_17&#39;)"><span class="hl_fundecl"><span class="mpre">ncEscape</span></span></a><span class="mpre"> (</span><a name="loc_1233_19_1233_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_19_1233_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1233_21_1233_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_21_1233_23&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)         = </span><a href="#loc_1233_19_1233_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_19_1233_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1232_9_1232_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_9_1232_17&#39;)"><span class="hl_varref"><span class="mpre">ncEscape</span></span></a><span class="mpre"> </span><a href="#loc_1233_21_1233_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_21_1233_23&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
        </span><a href="#loc_1232_9_1232_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1232_9_1232_17&#39;)"><span class="hl_fundecl"><span class="mpre">ncEscape</span></span></a><span class="mpre"> []             = []

</span><span class="hl_comment"><span class="mpre">-- |Encoding normalization; cf. RFC3986 section 6.2.2.2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1239_1_1239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_1_1239_16&#39;)"><span class="mpre">normalizeEscape</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1239_1_1239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_1_1239_16&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeEscape</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1239_22_1239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_22_1239_24&#39;)"><span class="hl_vardecl"><span class="mpre">h1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1239_25_1239_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_25_1239_27&#39;)"><span class="hl_vardecl"><span class="mpre">h2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1239_28_1239_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_28_1239_30&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
    | </span><a href="GHC.Unicode.html#loc_112_1_112_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_112_1_112_11&#39;)"><span class="hl_varref"><span class="mpre">isHexDigit</span></span></a><span class="mpre"> </span><a href="#loc_1239_22_1239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_22_1239_24&#39;)"><span class="hl_varref"><span class="mpre">h1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_112_1_112_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_112_1_112_11&#39;)"><span class="hl_varref"><span class="mpre">isHexDigit</span></span></a><span class="mpre"> </span><a href="#loc_1239_25_1239_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_25_1239_27&#39;)"><span class="hl_varref"><span class="mpre">h2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_370_1_370_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_13&#39;)"><span class="hl_varref"><span class="mpre">isUnreserved</span></span></a><span class="mpre"> </span><a href="#loc_1243_9_1243_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1243_9_1243_15&#39;)"><span class="hl_varref"><span class="mpre">escval</span></span></a><span class="mpre"> =
        </span><a href="#loc_1243_9_1243_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1243_9_1243_15&#39;)"><span class="hl_varref"><span class="mpre">escval</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1239_1_1239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_1_1239_16&#39;)"><span class="hl_varref"><span class="mpre">normalizeEscape</span></span></a><span class="mpre"> </span><a href="#loc_1239_28_1239_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_28_1239_30&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
    where
        </span><a name="loc_1243_9_1243_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1243_9_1243_15&#39;)"><span class="hl_vardecl"><span class="mpre">escval</span></span></a><span class="mpre"> = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="hl_varref"><span class="mpre">digitToInt</span></span></a><span class="mpre"> </span><a href="#loc_1239_22_1239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_22_1239_24&#39;)"><span class="hl_varref"><span class="mpre">h1</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">16</span></span><span class="hl_infix"><span class="mpre">+</span></span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="hl_varref"><span class="mpre">digitToInt</span></span></a><span class="mpre"> </span><a href="#loc_1239_25_1239_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_25_1239_27&#39;)"><span class="hl_varref"><span class="mpre">h2</span></span></a><span class="mpre">)
</span><a href="#loc_1239_1_1239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_1_1239_16&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeEscape</span></span></a><span class="mpre"> (</span><a name="loc_1244_18_1244_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1244_18_1244_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1244_20_1244_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1244_20_1244_22&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)         = </span><a href="#loc_1244_18_1244_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1244_18_1244_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1239_1_1239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_1_1239_16&#39;)"><span class="hl_varref"><span class="mpre">normalizeEscape</span></span></a><span class="mpre"> </span><a href="#loc_1244_20_1244_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1244_20_1244_22&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
</span><a href="#loc_1239_1_1239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_1_1239_16&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeEscape</span></span></a><span class="mpre"> []             = []

</span><span class="hl_comment"><span class="mpre">-- |Path segment normalization; cf. RFC3986 section 6.2.2.4</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1250_1_1250_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1250_1_1250_22&#39;)"><span class="mpre">normalizePathSegments</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1250_1_1250_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1250_1_1250_22&#39;)"><span class="hl_fundecl"><span class="mpre">normalizePathSegments</span></span></a><span class="mpre"> </span><a name="loc_1250_23_1250_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1250_23_1250_29&#39;)"><span class="hl_vardecl"><span class="mpre">uristr</span></span></a><span class="mpre"> = </span><a href="#loc_1253_9_1253_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1253_9_1253_16&#39;)"><span class="hl_varref"><span class="mpre">normstr</span></span></a><span class="mpre"> </span><a href="#loc_1252_9_1252_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1252_9_1252_13&#39;)"><span class="hl_varref"><span class="mpre">juri</span></span></a><span class="mpre">
    where
        </span><a name="loc_1252_9_1252_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1252_9_1252_13&#39;)"><span class="hl_vardecl"><span class="mpre">juri</span></span></a><span class="mpre"> = </span><a href="#loc_225_1_225_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_9&#39;)"><span class="hl_varref"><span class="mpre">parseURI</span></span></a><span class="mpre"> </span><a href="#loc_1250_23_1250_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1250_23_1250_29&#39;)"><span class="hl_varref"><span class="mpre">uristr</span></span></a><span class="mpre">
        </span><a name="loc_1253_9_1253_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1253_9_1253_16&#39;)"><span class="hl_fundecl"><span class="mpre">normstr</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  = </span><a href="#loc_1250_23_1250_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1250_23_1250_29&#39;)"><span class="hl_varref"><span class="mpre">uristr</span></span></a><span class="mpre">
        </span><a href="#loc_1253_9_1253_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1253_9_1253_16&#39;)"><span class="hl_fundecl"><span class="mpre">normstr</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_1254_23_1254_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1254_23_1254_24&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_1255_9_1255_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1255_9_1255_16&#39;)"><span class="hl_varref"><span class="mpre">normuri</span></span></a><span class="mpre"> </span><a href="#loc_1254_23_1254_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1254_23_1254_24&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)
        </span><a name="loc_1255_9_1255_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1255_9_1255_16&#39;)"><span class="hl_fundecl"><span class="mpre">normuri</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">u</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1255, srcSpanStartColumn = 21, srcSpanEndLine = 1255, srcSpanEndColumn = 66}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1255, srcSpanStartColumn = 23, srcSpanEndLine = 1255, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 12"><span class="mpre">u { uriPath = removeDotSegments (uriPath u) }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Local trace helper functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_1262_1_1262_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1262_1_1262_10&#39;)"><span class="mpre">traceShow</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1261, srcSpanStartColumn = 14, srcSpanEndLine = 1261, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1261, srcSpanStartColumn = 21, srcSpanEndLine = 1261, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/"><span class="mpre">Show a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_1262_1_1262_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1262_1_1262_10&#39;)"><span class="hl_fundecl"><span class="mpre">traceShow</span></span></a><span class="mpre"> </span><a name="loc_1262_11_1262_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1262_11_1262_14&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a name="loc_1262_15_1262_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1262_15_1262_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Debug.Trace.html#loc_103_1_103_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Debug.Trace.html#loc_103_1_103_6&#39;)"><span class="hl_varref"><span class="mpre">trace</span></span></a><span class="mpre"> (</span><a href="#loc_1262_11_1262_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1262_11_1262_14&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_1262_15_1262_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1262_15_1262_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_1262_15_1262_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1262_15_1262_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_1265_1_1265_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_1_1265_9&#39;)"><span class="mpre">traceVal</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1264, srcSpanStartColumn = 13, srcSpanEndLine = 1264, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1264, srcSpanStartColumn = 20, srcSpanEndLine = 1264, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/"><span class="mpre">Show a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_1265_1_1265_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_1_1265_9&#39;)"><span class="hl_fundecl"><span class="mpre">traceVal</span></span></a><span class="mpre"> </span><a name="loc_1265_10_1265_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_10_1265_13&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a name="loc_1265_14_1265_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_14_1265_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1265_16_1265_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_16_1265_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="Debug.Trace.html#loc_103_1_103_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Debug.Trace.html#loc_103_1_103_6&#39;)"><span class="hl_varref"><span class="mpre">trace</span></span></a><span class="mpre"> (</span><a href="#loc_1265_10_1265_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_10_1265_13&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_1265_14_1265_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_14_1265_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_1265_16_1265_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_16_1265_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Deprecated functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1271, srcSpanStartColumn = 1, srcSpanEndLine = 1271, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1271, srcSpanStartColumn = 1, srcSpanEndLine = 1271, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine ="><span class="mpre">{-# DEPRECATED parseabsoluteURI &quot;use parseAbsoluteURI&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_1273_1_1273_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1273_1_1273_17&#39;)"><span class="mpre">parseabsoluteURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
</span><a name="loc_1273_1_1273_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1273_1_1273_17&#39;)"><span class="hl_vardecl"><span class="mpre">parseabsoluteURI</span></span></a><span class="mpre"> = </span><a href="#loc_246_1_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_17&#39;)"><span class="hl_varref"><span class="mpre">parseAbsoluteURI</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1275, srcSpanStartColumn = 1, srcSpanEndLine = 1275, srcSpanEndColumn = 86}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1275, srcSpanStartColumn = 1, srcSpanEndLine = 1275, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine ="><span class="mpre">{-# DEPRECATED escapeString &quot;use escapeURIString, and note the flipped arguments&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_1277_1_1277_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_1_1277_13&#39;)"><span class="mpre">escapeString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">-&gt;</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1277_1_1277_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_1_1277_13&#39;)"><span class="hl_vardecl"><span class="mpre">escapeString</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_938_1_938_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_938_1_938_16&#39;)"><span class="hl_varref"><span class="mpre">escapeURIString</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1279, srcSpanStartColumn = 1, srcSpanEndLine = 1279, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1279, srcSpanStartColumn = 1, srcSpanEndLine = 1279, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine ="><span class="mpre">{-# DEPRECATED reserved &quot;use isReserved&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_1281_1_1281_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1281_1_1281_9&#39;)"><span class="mpre">reserved</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_1281_1_1281_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1281_1_1281_9&#39;)"><span class="hl_vardecl"><span class="mpre">reserved</span></span></a><span class="mpre"> = </span><a href="#loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="hl_varref"><span class="mpre">isReserved</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1283, srcSpanStartColumn = 1, srcSpanEndLine = 1283, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1283, srcSpanStartColumn = 1, srcSpanEndLine = 1283, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine ="><span class="mpre">{-# DEPRECATED unreserved &quot;use isUnreserved&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_1285_1_1285_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1285_1_1285_11&#39;)"><span class="mpre">unreserved</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_1285_1_1285_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1285_1_1285_11&#39;)"><span class="hl_vardecl"><span class="mpre">unreserved</span></span></a><span class="mpre"> = </span><a href="#loc_370_1_370_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_13&#39;)"><span class="hl_varref"><span class="mpre">isUnreserved</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  Additional component access functions for backward compatibility</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1289, srcSpanStartColumn = 1, srcSpanEndLine = 1289, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1289, srcSpanStartColumn = 1, srcSpanEndLine = 1289, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine ="><span class="mpre">{-# DEPRECATED scheme &quot;use uriScheme&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_1291_1_1291_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1291_1_1291_7&#39;)"><span class="mpre">scheme</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1291_1_1291_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1291_1_1291_7&#39;)"><span class="hl_vardecl"><span class="mpre">scheme</span></span></a><span class="mpre"> = </span><a href="#loc_1314_1_1314_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1314_1_1314_7&#39;)"><span class="hl_varref"><span class="mpre">orNull</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_154_7_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_7_154_16&#39;)"><span class="hl_varref"><span class="mpre">uriScheme</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1293, srcSpanStartColumn = 1, srcSpanEndLine = 1293, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1293, srcSpanStartColumn = 1, srcSpanEndLine = 1293, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine ="><span class="mpre">{-# DEPRECATED authority &quot;use uriAuthority, and note changed functionality&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_1295_1_1295_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1295_1_1295_10&#39;)"><span class="mpre">authority</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1295_1_1295_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1295_1_1295_10&#39;)"><span class="hl_vardecl"><span class="mpre">authority</span></span></a><span class="mpre"> = </span><a href="#loc_1298_9_1298_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1298_9_1298_15&#39;)"><span class="hl_varref"><span class="mpre">dropss</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">$</span></span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_858_1_858_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_858_1_858_16&#39;)"><span class="hl_varref"><span class="mpre">uriAuthToString</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_155_7_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_7_155_19&#39;)"><span class="hl_varref"><span class="mpre">uriAuthority</span></span></a><span class="mpre">
    where
        </span><span class="hl_comment"><span class="mpre">-- Old-style authority component does not include leading &#39;//&#39;</span></span><span class="mpre">
        </span><a name="loc_1298_9_1298_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1298_9_1298_15&#39;)"><span class="hl_fundecl"><span class="mpre">dropss</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1298_25_1298_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1298_25_1298_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_1298_25_1298_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1298_25_1298_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        </span><a href="#loc_1298_9_1298_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1298_9_1298_15&#39;)"><span class="hl_fundecl"><span class="mpre">dropss</span></span></a><span class="mpre"> </span><a name="loc_1299_16_1299_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1299_16_1299_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">           = </span><a href="#loc_1299_16_1299_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1299_16_1299_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1301, srcSpanStartColumn = 1, srcSpanEndLine = 1301, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1301, srcSpanStartColumn = 1, srcSpanEndLine = 1301, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine ="><span class="mpre">{-# DEPRECATED path &quot;use uriPath&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_1303_1_1303_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1303_1_1303_5&#39;)"><span class="mpre">path</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1303_1_1303_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1303_1_1303_5&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> = </span><a href="#loc_156_7_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_7_156_14&#39;)"><span class="hl_varref"><span class="mpre">uriPath</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1305, srcSpanStartColumn = 1, srcSpanEndLine = 1305, srcSpanEndColumn = 72}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1305, srcSpanStartColumn = 1, srcSpanEndLine = 1305, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine ="><span class="mpre">{-# DEPRECATED query &quot;use uriQuery, and note changed functionality&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_1307_1_1307_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1307_1_1307_6&#39;)"><span class="mpre">query</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1307_1_1307_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1307_1_1307_6&#39;)"><span class="hl_vardecl"><span class="mpre">query</span></span></a><span class="mpre"> = </span><a href="#loc_1314_1_1314_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1314_1_1314_7&#39;)"><span class="hl_varref"><span class="mpre">orNull</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_157_7_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_15&#39;)"><span class="hl_varref"><span class="mpre">uriQuery</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1309, srcSpanStartColumn = 1, srcSpanEndLine = 1309, srcSpanEndColumn = 78}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine = 1309, srcSpanStartColumn = 1, srcSpanEndLine = 1309, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/network-2.5.0.0/Network/URI.hs&quot;, srcSpanStartLine ="><span class="mpre">{-# DEPRECATED fragment &quot;use uriFragment, and note changed functionality&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_1311_1_1311_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1311_1_1311_9&#39;)"><span class="mpre">fragment</span></a><span class="mpre"> :: </span><a href="#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1311_1_1311_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1311_1_1311_9&#39;)"><span class="hl_vardecl"><span class="mpre">fragment</span></span></a><span class="mpre"> = </span><a href="#loc_1314_1_1314_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1314_1_1314_7&#39;)"><span class="hl_varref"><span class="mpre">orNull</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_158_7_158_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_7_158_18&#39;)"><span class="hl_varref"><span class="mpre">uriFragment</span></span></a><span class="mpre">

</span><a href="#loc_1314_1_1314_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1314_1_1314_7&#39;)"><span class="mpre">orNull</span></a><span class="mpre"> :: ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]-&gt;[</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]) -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_1314_1_1314_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1314_1_1314_7&#39;)"><span class="hl_fundecl"><span class="mpre">orNull</span></span></a><span class="mpre"> _ [] = []
</span><a href="#loc_1314_1_1314_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1314_1_1314_7&#39;)"><span class="hl_fundecl"><span class="mpre">orNull</span></span></a><span class="mpre"> </span><a name="loc_1315_8_1315_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1315_8_1315_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_1315_10_1315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1315_10_1315_12&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre"> = </span><a href="#loc_1315_8_1315_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1315_8_1315_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1315_10_1315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1315_10_1315_12&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Copyright (c) 2004, G. KLYNE.  All rights reserved.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Distributed as free software under the following license.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  Redistribution and use in source and binary forms, with or without</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  modification, are permitted provided that the following conditions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  are met:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  - Redistributions of source code must retain the above copyright notice,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  this list of conditions and the following disclaimer.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  - Redistributions in binary form must reproduce the above copyright</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  notice, this list of conditions and the following disclaimer in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  documentation and/or other materials provided with the distribution.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  - Neither name of the copyright holders nor the names of its</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  contributors may be used to endorse or promote products derived from</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  this software without specific prior written permission.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND THE CONTRIBUTORS</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  HOLDERS OR THE CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">
</span></div></body></html>