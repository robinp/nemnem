<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.PubKey.ElGamal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module is a work in progress. do not use:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it might eat your dog, your data or even both.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TODO: provide a mapping between integer and ciphertext</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       generate numbers correctly</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.PubKey.ElGamal
    ( Params
    , PublicNumber
    , PrivateNumber
    , EphemeralKey(..)
    , SharedKey
    , Signature
    </span><span class="hl_comment"><span class="mpre">-- * generation</span></span><span class="mpre">
    , generatePrivate
    , generatePublic
    </span><span class="hl_comment"><span class="mpre">-- * encryption and decryption with no scheme</span></span><span class="mpre">
    , encryptWith
    , encrypt
    , decrypt
    </span><span class="hl_comment"><span class="mpre">-- * signature primitives</span></span><span class="mpre">
    , signWith
    , sign
    </span><span class="hl_comment"><span class="mpre">-- * verification primitives</span></span><span class="mpre">
    , verify
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ElGamal.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 8, srcSpanEndLine = 35, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Crypto.Number.ModArithmetic (</span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="mpre">expSafe</span></a><span class="mpre">, </span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="mpre">expFast</span></a><span class="mpre">, </span><a href="Crypto.Number.ModArithmetic.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_126_1_126_8&#39;)"><span class="mpre">inverse</span></a><span class="mpre">)
import Crypto.Number.Generate (</span><a href="Crypto.Number.Generate.html#loc_24_1_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_24_1_24_12&#39;)"><span class="mpre">generateMax</span></a><span class="mpre">)
import Crypto.Number.Serialize (</span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="mpre">os2ip</span></a><span class="mpre">)
import Crypto.Number.Basic (</span><a href="Crypto.Number.Basic.html#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Basic.html#loc_83_1_83_12&#39;)"><span class="mpre">gcde_binary</span></a><span class="mpre">)
import Crypto.Types.PubKey.DH
import Crypto.Random.API
import Control.Arrow (</span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="mpre">first</span></a><span class="mpre">)
import Data.Maybe (</span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="mpre">fromJust</span></a><span class="mpre">)
import Crypto.PubKey.HashDescr (HashFunction)

</span><span class="hl_comment"><span class="mpre">-- | ElGamal Signature</span></span><span class="mpre">
data </span><a name="loc_47_6_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Signature</span></span></a><span class="mpre"> = </span><a name="loc_47_18_47_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_18_47_27&#39;)"><span class="hl_condecl"><span class="mpre">Signature</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | ElGamal Ephemeral key. also called Temporary key.</span></span><span class="mpre">
newtype </span><a name="loc_50_9_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_21&#39;)"><span class="hl_tycondecl"><span class="mpre">EphemeralKey</span></span></a><span class="mpre"> = </span><a name="loc_50_24_50_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_24_50_36&#39;)"><span class="hl_condecl"><span class="mpre">EphemeralKey</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | generate a private number with no specific property</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this number is usually called a and need to be between</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 0 and q (order of the group G).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_57_1_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_16&#39;)"><span class="mpre">generatePrivate</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ElGamal.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 20, srcSpanEndLine = 56, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ElGamal.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 27, srcSpanEndLine = 56, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><a href="Crypto.Types.PubKey.DH.html#loc_42_9_42_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_9_42_22&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_57_1_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_16&#39;)"><span class="hl_fundecl"><span class="mpre">generatePrivate</span></span></a><span class="mpre"> </span><a name="loc_57_17_57_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_20&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_57_21_57_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_21_57_22&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> </span><a href="Crypto.Types.PubKey.DH.html#loc_42_25_42_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_25_42_38&#39;)"><span class="hl_conref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Number.Generate.html#loc_24_1_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_24_1_24_12&#39;)"><span class="hl_varref"><span class="mpre">generateMax</span></span></a><span class="mpre"> </span><a href="#loc_57_17_57_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_20&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_57_21_57_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_21_57_22&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | generate an ephemeral key which is a number with no specific property,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and need to be between 0 and q (order of the group G).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_63_1_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_18&#39;)"><span class="mpre">generateEphemeral</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ElGamal.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 22, srcSpanEndLine = 62, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ElGamal.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 29, srcSpanEndLine = 62, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><a href="#loc_50_9_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_21&#39;)"><span class="hl_tyconref"><span class="mpre">EphemeralKey</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_63_1_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_18&#39;)"><span class="hl_fundecl"><span class="mpre">generateEphemeral</span></span></a><span class="mpre"> </span><a name="loc_63_19_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_22&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_63_23_63_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_23_63_24&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> </span><a href="#loc_64_11_64_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_22&#39;)"><span class="hl_varref"><span class="mpre">toEphemeral</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_57_1_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_16&#39;)"><span class="hl_varref"><span class="mpre">generatePrivate</span></span></a><span class="mpre"> </span><a href="#loc_63_19_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_22&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_63_23_63_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_23_63_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
    where </span><a name="loc_64_11_64_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_22&#39;)"><span class="hl_fundecl"><span class="mpre">toEphemeral</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.DH.html#loc_42_25_42_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_25_42_38&#39;)"><span class="hl_conref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre"> </span><a name="loc_64_38_64_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_38_64_39&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) = </span><a href="#loc_50_24_50_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_24_50_36&#39;)"><span class="hl_conref"><span class="mpre">EphemeralKey</span></span></a><span class="mpre"> </span><a href="#loc_64_38_64_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_38_64_39&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | generate a public number that is for the other party benefits.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this number is usually called h=g^a</span></span><span class="mpre">
</span><a href="#loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="mpre">generatePublic</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.DH.html#loc_21_6_21_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_21_6_21_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_42_9_42_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_9_42_22&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_38_9_38_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_9_38_21&#39;)"><span class="hl_tyconref"><span class="mpre">PublicNumber</span></span></a><span class="mpre">
</span><a name="loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="hl_fundecl"><span class="mpre">generatePublic</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_69_24_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_24_69_25&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_69_26_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_26_69_27&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.DH.html#loc_42_25_42_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_25_42_38&#39;)"><span class="hl_conref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre"> </span><a name="loc_69_44_69_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_44_69_45&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="Crypto.Types.PubKey.DH.html#loc_38_24_38_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_24_38_36&#39;)"><span class="hl_conref"><span class="mpre">PublicNumber</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_69_26_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_26_69_27&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_69_44_69_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_44_69_45&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_69_24_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_24_69_25&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | encrypt with a specified ephemeral key</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- do not reuse ephemeral key.</span></span><span class="mpre">
</span><a href="#loc_74_1_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_12&#39;)"><span class="mpre">encryptWith</span></a><span class="mpre"> :: </span><a href="#loc_50_9_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_21&#39;)"><span class="hl_tyconref"><span class="mpre">EphemeralKey</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_21_6_21_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_21_6_21_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_38_9_38_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_9_38_21&#39;)"><span class="hl_tyconref"><span class="mpre">PublicNumber</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">)
</span><a name="loc_74_1_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_12&#39;)"><span class="hl_fundecl"><span class="mpre">encryptWith</span></span></a><span class="mpre"> (</span><a href="#loc_50_24_50_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_24_50_36&#39;)"><span class="hl_conref"><span class="mpre">EphemeralKey</span></span></a><span class="mpre"> </span><a name="loc_74_27_74_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_27_74_28&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_74_38_74_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_38_74_39&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_74_40_74_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_40_74_41&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.DH.html#loc_38_24_38_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_24_38_36&#39;)"><span class="hl_conref"><span class="mpre">PublicNumber</span></span></a><span class="mpre"> </span><a name="loc_74_57_74_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_57_74_58&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">) </span><a name="loc_74_60_74_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_60_74_61&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = (</span><a href="#loc_76_11_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_11_76_13&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">,</span><a href="#loc_77_11_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_13&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">)
    where </span><a name="loc_75_11_75_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_74_57_74_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_57_74_58&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_74_27_74_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_27_74_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_74_38_74_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_38_74_39&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
          </span><a name="loc_76_11_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_11_76_13&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_74_40_74_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_40_74_41&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_74_27_74_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_27_74_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_74_38_74_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_38_74_39&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
          </span><a name="loc_77_11_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_13&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> = (</span><a href="#loc_75_11_75_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_74_60_74_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_60_74_61&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_74_38_74_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_38_74_39&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | encrypt a message using params and public keys</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will generate b (called the ephemeral key)</span></span><span class="mpre">
</span><a href="#loc_82_1_82_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_8&#39;)"><span class="mpre">encrypt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ElGamal.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 12, srcSpanEndLine = 81, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ElGamal.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 19, srcSpanEndLine = 81, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_21_6_21_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_21_6_21_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_38_9_38_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_9_38_21&#39;)"><span class="hl_tyconref"><span class="mpre">PublicNumber</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; ((</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">), </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_82_1_82_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_8&#39;)"><span class="hl_fundecl"><span class="mpre">encrypt</span></span></a><span class="mpre"> </span><a name="loc_82_9_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_9_82_12&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_82_13_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_13_82_19&#39;)"><span class="hl_specname"><span class="mpre">params</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_82_28_82_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_28_82_29&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> _) </span><a name="loc_82_33_82_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_33_82_39&#39;)"><span class="hl_vardecl"><span class="mpre">public</span></span></a><span class="mpre"> </span><a name="loc_82_40_82_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_40_82_41&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> (\</span><a name="loc_82_52_82_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_52_82_53&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_74_1_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_12&#39;)"><span class="hl_varref"><span class="mpre">encryptWith</span></span></a><span class="mpre"> </span><a href="#loc_82_52_82_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_52_82_53&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_82_13_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_13_82_19&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><a href="#loc_82_33_82_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_33_82_39&#39;)"><span class="hl_varref"><span class="mpre">public</span></span></a><span class="mpre"> </span><a href="#loc_82_40_82_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_40_82_41&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_63_1_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_18&#39;)"><span class="hl_varref"><span class="mpre">generateEphemeral</span></span></a><span class="mpre"> </span><a href="#loc_82_9_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_9_82_12&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_83_11_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_11_83_12&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
    where </span><a name="loc_83_11_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_11_83_12&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="#loc_82_28_82_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_28_82_29&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- p is prime, hence order of the group is p-1</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | decrypt message</span></span><span class="mpre">
</span><a href="#loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="mpre">decrypt</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.DH.html#loc_21_6_21_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_21_6_21_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_42_9_42_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_9_42_22&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="hl_fundecl"><span class="mpre">decrypt</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_87_17_87_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> _) (</span><a href="Crypto.Types.PubKey.DH.html#loc_42_25_42_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_25_42_38&#39;)"><span class="hl_conref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre"> </span><a name="loc_87_37_87_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_37_87_38&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) (</span><a name="loc_87_41_87_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_41_87_43&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre">,</span><a name="loc_87_44_87_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_44_87_46&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre">) = (</span><a href="#loc_87_44_87_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_44_87_46&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_89_11_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_11_89_14&#39;)"><span class="hl_varref"><span class="mpre">sm1</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_87_17_87_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    where </span><a name="loc_88_11_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_11_88_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">   = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_87_41_87_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_41_87_43&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a href="#loc_87_37_87_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_37_87_38&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_87_17_87_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
          </span><a name="loc_89_11_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_11_89_14&#39;)"><span class="hl_vardecl"><span class="mpre">sm1</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Number.ModArithmetic.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_126_1_126_8&#39;)"><span class="hl_varref"><span class="mpre">inverse</span></span></a><span class="mpre"> </span><a href="#loc_88_11_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_11_88_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_87_17_87_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- always inversible in Zp</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | sign a message with an explicit k number</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- if k is not appropriate, then no signature is returned.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with some appropriate value of k, the signature generation can fail,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and no signature is returned. User of this function need to retry</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with a different k value.</span></span><span class="mpre">
</span><a href="#loc_104_1_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_9&#39;)"><span class="mpre">signWith</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ random number k, between 0 and p-1 and gcd(k,p-1)=1</span></span><span class="mpre">
         -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_21_6_21_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_21_6_21_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^ DH params (p,g)</span></span><span class="mpre">
         -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_42_9_42_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_9_42_22&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ DH private key</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ collision resistant hash function</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ message to sign</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_47_6_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Signature</span></span></a><span class="mpre">
</span><a name="loc_104_1_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_9&#39;)"><span class="hl_fundecl"><span class="mpre">signWith</span></span></a><span class="mpre"> </span><a name="loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_104_22_104_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_22_104_23&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.DH.html#loc_42_25_42_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_25_42_38&#39;)"><span class="hl_conref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre"> </span><a name="loc_104_40_104_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_40_104_41&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) </span><a name="loc_104_43_104_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_43_104_48&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a name="loc_104_49_104_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_49_104_52&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre">
    | </span><a href="#loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_111_19_111_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_20&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- gcd(k,p-1) is not 1</span></span><span class="mpre">
    | </span><a href="#loc_110_11_110_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_11_110_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">            = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_47_18_47_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_18_47_27&#39;)"><span class="hl_conref"><span class="mpre">Signature</span></span></a><span class="mpre"> (</span><a href="#loc_108_11_108_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">,</span><a href="#loc_110_11_110_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_11_110_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    where </span><a name="loc_108_11_108_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">          = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_104_22_104_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_22_104_23&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
          </span><a name="loc_109_11_109_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_12&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">          = </span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="hl_varref"><span class="mpre">os2ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_104_43_104_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_43_104_48&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a href="#loc_104_49_104_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_49_104_52&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
          </span><a name="loc_110_11_110_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_11_110_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">          = ((</span><a href="#loc_109_11_109_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_104_40_104_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_40_104_41&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_108_11_108_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_111_12_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_16&#39;)"><span class="hl_varref"><span class="mpre">kInv</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> (</span><a href="#loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          (</span><a name="loc_111_12_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_16&#39;)"><span class="hl_vardecl"><span class="mpre">kInv</span></span></a><span class="mpre">,_,</span><a name="loc_111_19_111_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_20&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><a href="Crypto.Number.Basic.html#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Basic.html#loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">gcde_binary</span></span></a><span class="mpre"> </span><a href="#loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | sign message</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function will generate a random number, however</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as the signature might fail, the function will automatically retry</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- until a proper signature has been created.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="mpre">sign</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ElGamal.hs&quot;, srcSpanStartLine = 119, srcSpanStartColumn = 9, srcSpanEndLine = 120, srcSpanEndColumn = 8}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/ElGamal.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 6, srcSpanEndLine = 120, srcSpanEndColumn = 8}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">CPRG g
     =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- ^ random number generator</span></span><span class="mpre">
     -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_21_6_21_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_21_6_21_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ DH params (p,g)</span></span><span class="mpre">
     -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_42_9_42_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_9_42_22&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateNumber</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ DH private key</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ collision resistant hash function</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ message to sign</span></span><span class="mpre">
     -&gt; (</span><a href="#loc_47_6_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Signature</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="hl_fundecl"><span class="mpre">sign</span></span></a><span class="mpre"> </span><a name="loc_126_6_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_6_126_9&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_126_10_126_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_10_126_16&#39;)"><span class="hl_specname"><span class="mpre">params</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_126_25_126_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_25_126_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> _) </span><a name="loc_126_30_126_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_30_126_34&#39;)"><span class="hl_vardecl"><span class="mpre">priv</span></span></a><span class="mpre"> </span><a name="loc_126_35_126_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_35_126_40&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a name="loc_126_41_126_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_41_126_44&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
    let (</span><a name="loc_127_10_127_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_10_127_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_127_13_127_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_13_127_17&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.Number.Generate.html#loc_24_1_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_24_1_24_12&#39;)"><span class="hl_varref"><span class="mpre">generateMax</span></span></a><span class="mpre"> </span><a href="#loc_126_6_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_6_126_9&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> (</span><a href="#loc_126_25_126_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_25_126_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
     in case </span><a href="#loc_104_1_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_9&#39;)"><span class="hl_varref"><span class="mpre">signWith</span></span></a><span class="mpre"> </span><a href="#loc_127_10_127_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_10_127_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_126_10_126_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_10_126_16&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><a href="#loc_126_30_126_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_30_126_34&#39;)"><span class="hl_varref"><span class="mpre">priv</span></span></a><span class="mpre"> </span><a href="#loc_126_35_126_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_35_126_40&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a href="#loc_126_41_126_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_41_126_44&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> of
             </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  -&gt; </span><a href="#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">sign</span></span></a><span class="mpre"> </span><a href="#loc_127_13_127_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_13_127_17&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre"> </span><a href="#loc_126_10_126_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_10_126_16&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><a href="#loc_126_30_126_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_30_126_34&#39;)"><span class="hl_varref"><span class="mpre">priv</span></span></a><span class="mpre"> </span><a href="#loc_126_35_126_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_35_126_40&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a href="#loc_126_41_126_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_41_126_44&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
             </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_130_19_130_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_19_130_22&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_130_19_130_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_19_130_22&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre">, </span><a href="#loc_127_13_127_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_13_127_17&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | verify a signature</span></span><span class="mpre">
</span><a href="#loc_139_1_139_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_7&#39;)"><span class="mpre">verify</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.DH.html#loc_21_6_21_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_21_6_21_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre">
       -&gt; </span><a href="Crypto.Types.PubKey.DH.html#loc_38_9_38_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_9_38_21&#39;)"><span class="hl_tyconref"><span class="mpre">PublicNumber</span></span></a><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
       -&gt; </span><a href="#loc_47_6_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Signature</span></span></a><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_139_1_139_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_7&#39;)"><span class="hl_fundecl"><span class="mpre">verify</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_139_16_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_16_139_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_139_18_139_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_19&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.DH.html#loc_38_24_38_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_24_38_36&#39;)"><span class="hl_conref"><span class="mpre">PublicNumber</span></span></a><span class="mpre"> </span><a name="loc_139_35_139_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_35_139_36&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) </span><a name="loc_139_38_139_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_38_139_43&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a name="loc_139_44_139_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_44_139_47&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> (</span><a href="#loc_47_18_47_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_18_47_27&#39;)"><span class="hl_conref"><span class="mpre">Signature</span></span></a><span class="mpre"> (</span><a name="loc_139_60_139_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_60_139_61&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">,</span><a name="loc_139_62_139_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_62_139_63&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">))
    | </span><span class="hl_varref"><span class="mpre">or</span></span><span class="mpre"> [</span><a href="#loc_139_60_139_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_60_139_61&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_139_60_139_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_60_139_61&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_139_16_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_16_139_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_139_62_139_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_62_139_63&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_139_62_139_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_62_139_63&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> (</span><a href="#loc_139_16_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_16_139_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)] = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                            = </span><a href="#loc_143_11_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_11_143_14&#39;)"><span class="hl_varref"><span class="mpre">lhs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_144_11_144_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_11_144_14&#39;)"><span class="hl_varref"><span class="mpre">rhs</span></span></a><span class="mpre">
    where </span><a name="loc_142_11_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_11_142_12&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">   = </span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="hl_varref"><span class="mpre">os2ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_139_38_139_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_38_139_43&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a href="#loc_139_44_139_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_44_139_47&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
          </span><a name="loc_143_11_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_11_143_14&#39;)"><span class="hl_vardecl"><span class="mpre">lhs</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="hl_varref"><span class="mpre">expFast</span></span></a><span class="mpre"> </span><a href="#loc_139_18_139_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_142_11_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_11_142_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_139_16_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_16_139_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
          </span><a name="loc_144_11_144_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_11_144_14&#39;)"><span class="hl_vardecl"><span class="mpre">rhs</span></span></a><span class="mpre"> = (</span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="hl_varref"><span class="mpre">expFast</span></span></a><span class="mpre"> </span><a href="#loc_139_35_139_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_35_139_36&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_139_60_139_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_60_139_61&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_139_16_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_16_139_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="hl_varref"><span class="mpre">expFast</span></span></a><span class="mpre"> </span><a href="#loc_139_60_139_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_60_139_61&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_139_62_139_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_62_139_63&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_139_16_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_16_139_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_139_16_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_16_139_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span></div></body></html>