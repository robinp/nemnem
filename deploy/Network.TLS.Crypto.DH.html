<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Network.TLS.Crypto.DH
    (
    </span><span class="hl_comment"><span class="mpre">-- * DH types</span></span><span class="mpre">
      DHParams
    , DHPublic
    , DHPrivate

    </span><span class="hl_comment"><span class="mpre">-- * DH methods</span></span><span class="mpre">
    , dhPublic
    , dhPrivate
    , dhParams
    , dhGenerateKeyPair
    , dhGetShared
    , dhUnwrap
    , dhUnwrapPublic
    ) where

import Network.TLS.Util.Serialization (</span><a href="Crypto.Number.Serialize.html#loc_62_1_62_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_62_1_62_6&#39;)"><span class="mpre">i2osp</span></a><span class="mpre">)
import qualified Crypto.PubKey.DH as DH
import qualified Crypto.Types.PubKey.DH as DH
import Crypto.Random (</span><a href="Crypto.Random.Generator.html#loc_16_7_16_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Generator.html#loc_16_7_16_11&#39;)"><span class="mpre">CPRG</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 8, srcSpanEndLine = 22, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 1, srcSpanEndLine = 24, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 1, srcSpanEndLine = 24, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 24"><span class="mpre">type DHPublic   = DH.PublicNumber</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 25, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 25, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 25"><span class="mpre">type DHPrivate  = DH.PrivateNumber</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 1, srcSpanEndLine = 26, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 1, srcSpanEndLine = 26, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 26"><span class="mpre">type DHParams   = DH.Params</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 1, srcSpanEndLine = 27, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 1, srcSpanEndLine = 27, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 27"><span class="mpre">type DHKey      = ByteString</span></span><span class="mpre">

</span><a href="#loc_30_1_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_9&#39;)"><span class="mpre">dhPublic</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DHPublic</span></span><span class="mpre">
</span><a name="loc_30_1_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_9&#39;)"><span class="hl_vardecl"><span class="mpre">dhPublic</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.DH.html#loc_38_24_38_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_24_38_36&#39;)"><span class="hl_conref"><span class="mpre">DH.PublicNumber</span></span></a><span class="mpre">

</span><a href="#loc_33_1_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_10&#39;)"><span class="mpre">dhPrivate</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DHPrivate</span></span><span class="mpre">
</span><a name="loc_33_1_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_10&#39;)"><span class="hl_vardecl"><span class="mpre">dhPrivate</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.DH.html#loc_42_25_42_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_42_25_42_38&#39;)"><span class="hl_conref"><span class="mpre">DH.PrivateNumber</span></span></a><span class="mpre">

</span><a href="#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="mpre">dhParams</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DHParams</span></span><span class="mpre">
</span><a name="loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="hl_vardecl"><span class="mpre">dhParams</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">DH.Params</span></span><span class="mpre">

</span><a href="#loc_39_1_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_18&#39;)"><span class="mpre">dhGenerateKeyPair</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 22, srcSpanEndLine = 38, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Crypto/DH.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 29, srcSpanEndLine = 38, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Networ"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DHParams</span></span><span class="mpre"> -&gt; ((</span><span class="hl_tyconref"><span class="mpre">DHPrivate</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">DHPublic</span></span><span class="mpre">), </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_39_1_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_18&#39;)"><span class="hl_fundecl"><span class="mpre">dhGenerateKeyPair</span></span></a><span class="mpre"> </span><a name="loc_39_19_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_22&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_39_23_39_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_29&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre"> =
    let (</span><a name="loc_40_10_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_10_40_14&#39;)"><span class="hl_vardecl"><span class="mpre">priv</span></span></a><span class="mpre">, </span><a name="loc_40_16_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_16_40_18&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.PubKey.DH.html#loc_38_1_38_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.DH.html#loc_38_1_38_16&#39;)"><span class="hl_varref"><span class="mpre">DH.generatePrivate</span></span></a><span class="mpre"> </span><a href="#loc_39_19_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_22&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_39_23_39_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_29&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">
        </span><a name="loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_vardecl"><span class="mpre">pub</span></span></a><span class="mpre">        = </span><a href="Crypto.PubKey.DH.html#loc_50_1_50_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.DH.html#loc_50_1_50_15&#39;)"><span class="hl_varref"><span class="mpre">DH.generatePublic</span></span></a><span class="mpre"> </span><a href="#loc_39_23_39_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_29&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><a href="#loc_40_10_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_10_40_14&#39;)"><span class="hl_varref"><span class="mpre">priv</span></span></a><span class="mpre">
     in ((</span><a href="#loc_40_10_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_10_40_14&#39;)"><span class="hl_varref"><span class="mpre">priv</span></span></a><span class="mpre">, </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_varref"><span class="mpre">pub</span></span></a><span class="mpre">), </span><a href="#loc_40_16_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_16_40_18&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">)

</span><a href="#loc_45_1_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_12&#39;)"><span class="mpre">dhGetShared</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DHParams</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DHPrivate</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DHPublic</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DHKey</span></span><span class="mpre">
</span><a name="loc_45_1_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_12&#39;)"><span class="hl_fundecl"><span class="mpre">dhGetShared</span></span></a><span class="mpre"> </span><a name="loc_45_13_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_19&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre"> </span><a name="loc_45_20_45_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_20_45_24&#39;)"><span class="hl_vardecl"><span class="mpre">priv</span></span></a><span class="mpre"> </span><a name="loc_45_25_45_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_25_45_28&#39;)"><span class="hl_vardecl"><span class="mpre">pub</span></span></a><span class="mpre"> =
    let (</span><a href="Crypto.Types.PubKey.DH.html#loc_46_21_46_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_46_21_46_30&#39;)"><span class="hl_conref"><span class="mpre">DH.SharedKey</span></span></a><span class="mpre"> </span><a name="loc_46_23_46_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_23_46_25&#39;)"><span class="hl_vardecl"><span class="mpre">sk</span></span></a><span class="mpre">) = </span><a href="Crypto.PubKey.DH.html#loc_55_1_55_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.DH.html#loc_55_1_55_10&#39;)"><span class="hl_varref"><span class="mpre">DH.getShared</span></span></a><span class="mpre"> </span><a href="#loc_45_13_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_19&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><a href="#loc_45_20_45_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_20_45_24&#39;)"><span class="hl_varref"><span class="mpre">priv</span></span></a><span class="mpre"> </span><a href="#loc_45_25_45_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_25_45_28&#39;)"><span class="hl_varref"><span class="mpre">pub</span></span></a><span class="mpre">
     in </span><a href="Crypto.Number.Serialize.html#loc_62_1_62_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_62_1_62_6&#39;)"><span class="hl_varref"><span class="mpre">i2osp</span></span></a><span class="mpre"> </span><a href="#loc_46_23_46_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_23_46_25&#39;)"><span class="hl_varref"><span class="mpre">sk</span></span></a><span class="mpre">

</span><a href="#loc_50_1_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_9&#39;)"><span class="mpre">dhUnwrap</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DHParams</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DHPublic</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">]
</span><a name="loc_50_1_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_9&#39;)"><span class="hl_fundecl"><span class="mpre">dhUnwrap</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">DH.Params</span></span><span class="mpre"> </span><a name="loc_50_21_50_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_21_50_22&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_50_23_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_23_50_24&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.DH.html#loc_38_24_38_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_24_38_36&#39;)"><span class="hl_conref"><span class="mpre">DH.PublicNumber</span></span></a><span class="mpre"> </span><a name="loc_50_43_50_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_43_50_44&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = [</span><a href="#loc_50_21_50_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_21_50_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_50_23_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_23_50_24&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">,</span><a href="#loc_50_43_50_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_43_50_44&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">]

</span><a href="#loc_53_1_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_15&#39;)"><span class="mpre">dhUnwrapPublic</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DHPublic</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_53_1_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_15&#39;)"><span class="hl_fundecl"><span class="mpre">dhUnwrapPublic</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.DH.html#loc_38_24_38_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DH.html#loc_38_24_38_36&#39;)"><span class="hl_conref"><span class="mpre">DH.PublicNumber</span></span></a><span class="mpre"> </span><a name="loc_53_33_53_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_33_53_34&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><a href="#loc_53_33_53_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_33_53_34&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
</span></div></body></html>