<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.MAC.HMAC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provide the HMAC (Hash based Message Authentification Code) base algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://en.wikipedia.org/wiki/HMAC&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.MAC.HMAC
    ( hmac
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/MAC/HMAC.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 8, srcSpanEndLine = 15, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/MAC/HMAC.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 18, srcSpanEndLine = 16, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Data.Bits (</span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="mpre">xor</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | compute a MAC using the supplied hashing function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- An incremental API can be found in the module &quot;Crypto.Hash&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_28_1_28_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_5&#39;)"><span class="mpre">hmac</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ hash function</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ block size</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ secret</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ message</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_28_1_28_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_5&#39;)"><span class="hl_fundecl"><span class="mpre">hmac</span></span></a><span class="mpre"> </span><a name="loc_28_6_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_11&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a name="loc_28_12_28_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_12_28_21&#39;)"><span class="hl_vardecl"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a name="loc_28_22_28_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_22_28_28&#39;)"><span class="hl_vardecl"><span class="mpre">secret</span></span></a><span class="mpre"> </span><a name="loc_28_29_28_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_29_28_32&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><a href="#loc_28_6_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_11&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.append</span></span><span class="mpre"> </span><a href="#loc_29_11_29_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_11_29_15&#39;)"><span class="hl_varref"><span class="mpre">opad</span></span></a><span class="mpre"> (</span><a href="#loc_28_6_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_11&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.append</span></span><span class="mpre"> </span><a href="#loc_30_11_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_11_30_15&#39;)"><span class="hl_varref"><span class="mpre">ipad</span></span></a><span class="mpre"> </span><a href="#loc_28_29_28_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_29_28_32&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">)
    where </span><a name="loc_29_11_29_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_11_29_15&#39;)"><span class="hl_vardecl"><span class="mpre">opad</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.map</span></span><span class="mpre"> (</span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">xor</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x5c</span></span><span class="mpre">) </span><a href="#loc_32_11_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_13&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre">
          </span><a name="loc_30_11_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_11_30_15&#39;)"><span class="hl_vardecl"><span class="mpre">ipad</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.map</span></span><span class="mpre"> (</span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">xor</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x36</span></span><span class="mpre">) </span><a href="#loc_32_11_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_13&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre">

          </span><a name="loc_32_11_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_13&#39;)"><span class="hl_vardecl"><span class="mpre">k&#39;</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">B.append</span></span><span class="mpre"> </span><a href="#loc_33_11_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_11_33_13&#39;)"><span class="hl_varref"><span class="mpre">kt</span></span></a><span class="mpre"> </span><a href="#loc_34_11_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_11_34_14&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre">
          </span><a name="loc_33_11_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_11_33_13&#39;)"><span class="hl_vardecl"><span class="mpre">kt</span></span></a><span class="mpre">  = if </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_28_22_28_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_22_28_28&#39;)"><span class="hl_varref"><span class="mpre">secret</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_28_12_28_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_12_28_21&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> then </span><a href="#loc_28_6_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_11&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a href="#loc_28_22_28_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_22_28_28&#39;)"><span class="hl_varref"><span class="mpre">secret</span></span></a><span class="mpre"> else </span><a href="#loc_28_22_28_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_22_28_28&#39;)"><span class="hl_varref"><span class="mpre">secret</span></span></a><span class="mpre">
          </span><a name="loc_34_11_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_11_34_14&#39;)"><span class="hl_vardecl"><span class="mpre">pad</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_28_12_28_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_12_28_21&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_33_11_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_11_33_13&#39;)"><span class="hl_varref"><span class="mpre">kt</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span></div></body></html>