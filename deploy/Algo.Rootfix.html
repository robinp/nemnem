<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Algo.Rootfix where

import Data.Vector.Unboxed as V

</span><a href="#loc_7_1_7_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_1_7_8&#39;)"><span class="mpre">rootfix</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">V.Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">V.Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">V.Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_7_1_7_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_1_7_8&#39;)"><span class="mpre">rootfix</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_7_1_7_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_1_7_8&#39;)"><span class="hl_fundecl"><span class="mpre">rootfix</span></span></a><span class="mpre"> (</span><a name="loc_7_10_7_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_10_7_12&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre">, </span><a name="loc_7_14_7_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_14_7_16&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) = </span><a href="#loc_9_7_9_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_7_9_14&#39;)"><span class="hl_varref"><span class="mpre">rootfix</span></span></a><span class="mpre"> (</span><a href="Data.Vector.Unboxed.html#loc_449_1_449_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_449_1_449_10&#39;)"><span class="hl_varref"><span class="mpre">V.replicate</span></span></a><span class="mpre"> (</span><a href="Data.Vector.Unboxed.html#loc_255_1_255_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_255_1_255_7&#39;)"><span class="hl_varref"><span class="mpre">V.length</span></span></a><span class="mpre"> </span><a href="#loc_7_10_7_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_10_7_12&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_7_10_7_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_10_7_12&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a href="#loc_7_14_7_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_14_7_16&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
    where
      </span><a name="loc_9_7_9_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_7_9_14&#39;)"><span class="hl_fundecl"><span class="mpre">rootfix</span></span></a><span class="mpre"> </span><a name="loc_9_15_9_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_15_9_17&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_9_18_9_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_18_9_20&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a name="loc_9_21_9_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_21_9_23&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">
        = let </span><a name="loc_10_15_10_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_15_10_17&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre">   = </span><a href="Data.Vector.Unboxed.html#loc_449_1_449_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_449_1_449_10&#39;)"><span class="hl_varref"><span class="mpre">V.replicate</span></span></a><span class="mpre"> (</span><a href="Data.Vector.Unboxed.html#loc_255_1_255_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_255_1_255_7&#39;)"><span class="hl_varref"><span class="mpre">V.length</span></span></a><span class="mpre"> </span><a href="#loc_9_18_9_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_18_9_20&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
              </span><a name="loc_11_15_11_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_15_11_17&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">   = </span><a href="Data.Vector.Unboxed.html#loc_648_1_648_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_648_1_648_8&#39;)"><span class="hl_varref"><span class="mpre">V.update_</span></span></a><span class="mpre"> (</span><a href="Data.Vector.Unboxed.html#loc_648_1_648_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_648_1_648_8&#39;)"><span class="hl_varref"><span class="mpre">V.update_</span></span></a><span class="mpre"> </span><a href="#loc_10_15_10_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_15_10_17&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre"> </span><a href="#loc_9_18_9_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_18_9_20&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a href="#loc_9_15_9_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_15_9_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_9_21_9_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_21_9_23&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre"> (</span><a href="Data.Vector.Unboxed.html#loc_781_1_781_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_781_1_781_4&#39;)"><span class="hl_varref"><span class="mpre">V.map</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">negate</span></span><span class="mpre"> </span><a href="#loc_9_15_9_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_15_9_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
              </span><a name="loc_12_15_12_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_15_12_19&#39;)"><span class="hl_vardecl"><span class="mpre">sums</span></span></a><span class="mpre"> = </span><a href="Data.Vector.Unboxed.html#loc_1222_1_1222_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_1222_1_1222_10&#39;)"><span class="hl_varref"><span class="mpre">V.prescanl&#39;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(+)</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_11_15_11_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_15_11_17&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">
          in
          </span><a href="Data.Vector.Unboxed.html#loc_746_1_746_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_746_1_746_12&#39;)"><span class="hl_varref"><span class="mpre">V.backpermute</span></span></a><span class="mpre"> </span><a href="#loc_12_15_12_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_15_12_19&#39;)"><span class="hl_varref"><span class="mpre">sums</span></span></a><span class="mpre"> </span><a href="#loc_9_18_9_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_18_9_20&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">

</span></div></body></html>