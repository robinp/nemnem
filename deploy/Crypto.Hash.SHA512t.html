<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Hash.SHA512t</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A module containing SHA512/t</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Hash.SHA512t
    ( Ctx(..)

    </span><span class="hl_comment"><span class="mpre">-- * Incremental hashing Functions</span></span><span class="mpre">
    , init     </span><span class="hl_comment"><span class="mpre">-- :: Ctx</span></span><span class="mpre">
    , update   </span><span class="hl_comment"><span class="mpre">-- :: Ctx -&gt; ByteString -&gt; Ctx</span></span><span class="mpre">
    , finalize </span><span class="hl_comment"><span class="mpre">-- :: Ctx -&gt; ByteString</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- * Single Pass hashing</span></span><span class="mpre">
    , hash     </span><span class="hl_comment"><span class="mpre">-- :: ByteString -&gt; ByteString</span></span><span class="mpre">
    , hashlazy </span><span class="hl_comment"><span class="mpre">-- :: ByteString -&gt; ByteString</span></span><span class="mpre">
    ) where

import Prelude hiding (init)
import Data.List (</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512t.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512t.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512t.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 18, srcSpanEndLine = 27, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L

import qualified Crypto.Hash.SHA512 as SHA512

</span><span class="hl_comment"><span class="mpre">-- | SHA512 Context with variable size output</span></span><span class="mpre">
data </span><a name="loc_32_6_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_9&#39;)"><span class="hl_tycondecl"><span class="mpre">Ctx</span></span></a><span class="mpre"> = </span><a name="loc_32_12_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_15&#39;)"><span class="hl_condecl"><span class="mpre">Ctx</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> !</span><a href="Crypto.Hash.SHA512.html#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.SHA512.html#loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">SHA512.Ctx</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | init a context</span></span><span class="mpre">
</span><a href="#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_5&#39;)"><span class="mpre">init</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_9&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_36_1_36_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_5&#39;)"><span class="hl_fundecl"><span class="mpre">init</span></span></a><span class="mpre"> </span><a name="loc_36_6_36_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_6_36_7&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_32_12_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_15&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><a href="#loc_36_6_36_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_6_36_7&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a href="Crypto.Hash.SHA512.html#loc_103_1_103_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.SHA512.html#loc_103_1_103_7&#39;)"><span class="hl_varref"><span class="mpre">SHA512.init_t</span></span></a><span class="mpre"> </span><a href="#loc_36_6_36_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_6_36_7&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | update a context with a bytestring</span></span><span class="mpre">
</span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="mpre">update</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_9&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_9&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> (</span><a href="#loc_32_12_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_15&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><a name="loc_40_13_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_13_40_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_40_15_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_15_40_18&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre">) </span><a name="loc_40_20_40_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_21&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="#loc_32_12_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_15&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><a href="#loc_40_13_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_13_40_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a href="Crypto.Hash.SHA512.html#loc_120_1_120_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.SHA512.html#loc_120_1_120_7&#39;)"><span class="hl_varref"><span class="mpre">SHA512.update</span></span></a><span class="mpre"> </span><a href="#loc_40_15_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_15_40_18&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_40_20_40_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_21&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | finalize the context into a digest bytestring</span></span><span class="mpre">
</span><a href="#loc_44_1_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_9&#39;)"><span class="mpre">finalize</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_9&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_44_1_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_9&#39;)"><span class="hl_fundecl"><span class="mpre">finalize</span></span></a><span class="mpre"> (</span><a href="#loc_32_12_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_15&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><a name="loc_44_15_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_15_44_17&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> </span><a name="loc_44_18_44_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_18_44_21&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre"> (</span><a href="#loc_44_15_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_15_44_17&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) (</span><a href="Crypto.Hash.SHA512.html#loc_130_1_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.SHA512.html#loc_130_1_130_9&#39;)"><span class="hl_varref"><span class="mpre">SHA512.finalize</span></span></a><span class="mpre"> </span><a href="#loc_44_18_44_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_18_44_21&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | hash a strict bytestring into a digest bytestring</span></span><span class="mpre">
</span><a href="#loc_48_1_48_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_5&#39;)"><span class="mpre">hash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_48_1_48_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_5&#39;)"><span class="hl_fundecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_48_6_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_6_48_7&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_44_1_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_9&#39;)"><span class="hl_varref"><span class="mpre">finalize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_varref"><span class="mpre">update</span></span></a><span class="mpre"> (</span><a href="#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_5&#39;)"><span class="hl_varref"><span class="mpre">init</span></span></a><span class="mpre"> </span><a href="#loc_48_6_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_6_48_7&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | hash a lazy bytestring into a digest bytestring</span></span><span class="mpre">
</span><a href="#loc_52_1_52_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_9&#39;)"><span class="mpre">hashlazy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_52_1_52_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_9&#39;)"><span class="hl_fundecl"><span class="mpre">hashlazy</span></span></a><span class="mpre"> </span><a name="loc_52_10_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_10_52_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_44_1_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_9&#39;)"><span class="hl_varref"><span class="mpre">finalize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_varref"><span class="mpre">update</span></span></a><span class="mpre"> (</span><a href="#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_5&#39;)"><span class="hl_varref"><span class="mpre">init</span></span></a><span class="mpre"> </span><a href="#loc_52_10_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_10_52_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
</span></div></body></html>