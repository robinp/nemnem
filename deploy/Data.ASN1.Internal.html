<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ASN1.Internal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.ASN1.Internal
    ( uintOfBytes
    , intOfBytes
    , bytesOfUInt
    , bytesOfInt
    , putVarEncodingIntegral
    ) where

import Data.Word
import Data.Bits
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Internal.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Internal.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 18, srcSpanEndLine = 19, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B

</span><span class="hl_comment"><span class="mpre">{- | uintOfBytes returns the number of bytes and the unsigned integer represented by the bytes -}</span></span><span class="mpre">
</span><a href="#loc_23_1_23_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_12&#39;)"><span class="mpre">uintOfBytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">)
</span><a name="loc_23_1_23_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_12&#39;)"><span class="hl_fundecl"><span class="mpre">uintOfBytes</span></span></a><span class="mpre"> </span><a name="loc_23_13_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_13_23_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_23_13_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_13_23_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.foldl</span></span><span class="mpre"> (\</span><a name="loc_23_40_23_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_40_23_43&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_23_44_23_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_44_23_45&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_23_40_23_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_40_23_43&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_23_44_23_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_44_23_45&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_23_13_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_13_23_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">--bytesOfUInt i = B.unfoldr (\x -&gt; if x == 0 then Nothing else Just (fromIntegral (x .&amp;. 0xff), x `shiftR` 8)) i</span></span><span class="mpre">
</span><a href="#loc_27_1_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_12&#39;)"><span class="mpre">bytesOfUInt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_27_1_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_12&#39;)"><span class="hl_fundecl"><span class="mpre">bytesOfUInt</span></span></a><span class="mpre"> </span><a name="loc_27_13_27_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_13_27_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> (</span><a href="#loc_28_11_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_15&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> </span><a href="#loc_27_13_27_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_13_27_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    where </span><a name="loc_28_11_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_15&#39;)"><span class="hl_fundecl"><span class="mpre">list</span></span></a><span class="mpre"> </span><a name="loc_28_16_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = if </span><a href="#loc_28_16_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre"> then [</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_28_16_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">] else (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_28_16_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_28_11_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_15&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> (</span><a href="#loc_28_16_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{- | intOfBytes returns the number of bytes in the list and
   the represented integer by a two&#39;s completement list of bytes -}</span></span><span class="mpre">
</span><a href="#loc_33_1_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_11&#39;)"><span class="mpre">intOfBytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">)
</span><a name="loc_33_1_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_11&#39;)"><span class="hl_fundecl"><span class="mpre">intOfBytes</span></span></a><span class="mpre"> </span><a name="loc_33_12_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_33_12_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">   = (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = (</span><a href="#loc_37_10_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_13&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">, if </span><a href="#loc_39_9_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_14&#39;)"><span class="hl_varref"><span class="mpre">isNeg</span></span></a><span class="mpre"> then -(</span><a href="#loc_38_9_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_18&#39;)"><span class="hl_varref"><span class="mpre">maxIntLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_37_15_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_15_37_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) else </span><a href="#loc_37_15_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_15_37_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
    where
        (</span><a name="loc_37_10_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_13&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">, </span><a name="loc_37_15_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_15_37_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">)  = </span><a href="#loc_23_1_23_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_12&#39;)"><span class="hl_varref"><span class="mpre">uintOfBytes</span></span></a><span class="mpre"> </span><a href="#loc_33_12_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
        </span><a name="loc_38_9_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_18&#39;)"><span class="hl_vardecl"><span class="mpre">maxIntLen</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_37_10_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_13&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_39_9_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_14&#39;)"><span class="hl_vardecl"><span class="mpre">isNeg</span></span></a><span class="mpre">     = </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">testBit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.head</span></span><span class="mpre"> </span><a href="#loc_33_12_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- | bytesOfInt convert an integer into a two&#39;s completemented list of bytes -}</span></span><span class="mpre">
</span><a href="#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="mpre">bytesOfInt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="hl_fundecl"><span class="mpre">bytesOfInt</span></span></a><span class="mpre"> </span><a name="loc_43_12_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
    | </span><a href="#loc_43_12_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">      = if </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">testBit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_48_9_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_14&#39;)"><span class="hl_varref"><span class="mpre">uints</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_48_9_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_14&#39;)"><span class="hl_varref"><span class="mpre">uints</span></span></a><span class="mpre"> else </span><a href="#loc_48_9_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_14&#39;)"><span class="hl_varref"><span class="mpre">uints</span></span></a><span class="mpre">
    | </span><a href="#loc_43_12_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">     = [</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = if </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">testBit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_49_9_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_14&#39;)"><span class="hl_varref"><span class="mpre">nints</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> then </span><a href="#loc_49_9_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_14&#39;)"><span class="hl_varref"><span class="mpre">nints</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_49_9_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_14&#39;)"><span class="hl_varref"><span class="mpre">nints</span></span></a><span class="mpre">
    where
        </span><a name="loc_48_9_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_14&#39;)"><span class="hl_vardecl"><span class="mpre">uints</span></span></a><span class="mpre"> = </span><a href="#loc_27_1_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_12&#39;)"><span class="hl_varref"><span class="mpre">bytesOfUInt</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_43_12_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
        </span><a name="loc_49_9_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_14&#39;)"><span class="hl_vardecl"><span class="mpre">nints</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_50_9_50_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_16&#39;)"><span class="hl_varref"><span class="mpre">plusOne</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.Bits.html#loc_90_5_90_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_90_5_90_15&#39;)"><span class="hl_varref"><span class="mpre">complement</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_48_9_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_14&#39;)"><span class="hl_varref"><span class="mpre">uints</span></span></a><span class="mpre">
        </span><a name="loc_50_9_50_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_16&#39;)"><span class="hl_fundecl"><span class="mpre">plusOne</span></span></a><span class="mpre"> []     = [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">]
        </span><a href="#loc_50_9_50_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_16&#39;)"><span class="hl_fundecl"><span class="mpre">plusOne</span></span></a><span class="mpre"> (</span><a name="loc_51_18_51_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_51_20_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_20_51_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = if </span><a href="#loc_51_18_51_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_50_9_50_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_16&#39;)"><span class="hl_varref"><span class="mpre">plusOne</span></span></a><span class="mpre"> </span><a href="#loc_51_20_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_20_51_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> else (</span><a href="#loc_51_18_51_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_51_20_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_20_51_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- ASN1 often uses a particular kind of 7-bit encoding of integers like
   in the case of long tags or encoding of integer component of OID&#39;s.
   Use this function for such an encoding. Assumes a positive integer.

   Here is the description of the algorithm of the above encoding:

   1. The integer is chunked up into 7-bit groups. Each of these 7bit
      chunks are encoded as a single octet.

   2. All the octets except the last one has its 8th bit set.
-}</span></span><span class="mpre">
</span><a href="#loc_65_1_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_23&#39;)"><span class="mpre">putVarEncodingIntegral</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Internal.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 27, srcSpanEndLine = 64, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Internal.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 27, srcSpanEndLine = 64, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Intern"><span class="mpre">(Bits i, Integral i) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_65_1_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_23&#39;)"><span class="hl_fundecl"><span class="mpre">putVarEncodingIntegral</span></span></a><span class="mpre"> </span><a name="loc_65_24_65_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_24_65_25&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unfoldr</span></span><span class="mpre"> </span><a href="#loc_66_11_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_11_66_20&#39;)"><span class="hl_varref"><span class="mpre">genOctets</span></span></a><span class="mpre"> (</span><a href="#loc_65_24_65_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_24_65_25&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
    where </span><a name="loc_66_11_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_11_66_20&#39;)"><span class="hl_fundecl"><span class="mpre">genOctets</span></span></a><span class="mpre"> (</span><a name="loc_66_22_66_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_22_66_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_66_24_66_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_24_66_29&#39;)"><span class="hl_vardecl"><span class="mpre">first</span></span></a><span class="mpre">)
            | </span><a href="#loc_66_22_66_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_22_66_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">     =
                let </span><a name="loc_68_21_68_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_21_68_24&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_66_22_66_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_22_66_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7F</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (if </span><a href="#loc_66_24_66_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_24_66_29&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">) in
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_68_21_68_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_21_68_24&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">, (</span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_varref"><span class="mpre">shiftR</span></span></a><span class="mpre"> </span><a href="#loc_66_22_66_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_22_66_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">))
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span></div></body></html>