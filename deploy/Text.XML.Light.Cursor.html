<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module    : Text.XML.Light.Cursor</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright : (c) Galois, Inc. 2008</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License   : BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer: Iavor S. Diatchki &lt;diatchki@galois.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability : provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability: portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- XML cursors for working XML content withing the context of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an XML document.  This implementation is based on the general</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- tree zipper written by Krasimir Angelov and Iavor S. Diatchki.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

module Text.XML.Light.Cursor
  ( Tag(..), getTag, setTag, fromTag
  , Cursor(..), Path

  </span><span class="hl_comment"><span class="mpre">-- * Conversions</span></span><span class="mpre">
  , fromContent
  , fromElement
  , fromForest
  , toForest
  , toTree

  </span><span class="hl_comment"><span class="mpre">-- * Moving around</span></span><span class="mpre">
  , parent
  , root
  , getChild
  , firstChild
  , lastChild
  , left
  , right
  , nextDF

  </span><span class="hl_comment"><span class="mpre">-- ** Searching</span></span><span class="mpre">
  , findChild
  , findLeft
  , findRight
  , findRec

  </span><span class="hl_comment"><span class="mpre">-- * Node classification</span></span><span class="mpre">
  , isRoot
  , isFirst
  , isLast
  , isLeaf
  , isChild
  , hasChildren
  , getNodeIndex

  </span><span class="hl_comment"><span class="mpre">-- * Updates</span></span><span class="mpre">
  , setContent
  , modifyContent
  , modifyContentM

  </span><span class="hl_comment"><span class="mpre">-- ** Inserting content</span></span><span class="mpre">
  , insertLeft
  , insertRight
  , insertGoLeft
  , insertGoRight

  </span><span class="hl_comment"><span class="mpre">-- ** Removing content</span></span><span class="mpre">
  , removeLeft
  , removeRight
  , removeGoLeft
  , removeGoRight
  , removeGoUp

  ) where

import Text.XML.Light.Types
import Data.Maybe(</span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="mpre">isNothing</span></a><span class="mpre">)
import Control.Monad(</span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="mpre">mplus</span></a><span class="mpre">)

data </span><a name="loc_76_6_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_9&#39;)"><span class="hl_tycondecl"><span class="mpre">Tag</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Tag</span></span><span class="mpre"> { </span><a name="loc_76_18_76_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_18_76_25&#39;)"><span class="hl_fielddecl"><span class="mpre">tagName</span></span></a><span class="mpre">    :: </span><a href="Text.XML.Light.Types.html#loc_57_6_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_57_6_57_11&#39;)"><span class="hl_tyconref"><span class="mpre">QName</span></span></a><span class="mpre">
               , </span><a name="loc_77_18_77_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_28&#39;)"><span class="hl_fielddecl"><span class="mpre">tagAttribs</span></span></a><span class="mpre"> :: [</span><a href="Text.XML.Light.Types.html#loc_38_6_38_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_38_6_38_10&#39;)"><span class="hl_tyconref"><span class="mpre">Attr</span></span></a><span class="mpre">]
               , </span><a name="loc_78_18_78_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_18_78_25&#39;)"><span class="hl_fielddecl"><span class="mpre">tagLine</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Line</span></span><span class="mpre">
               } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 18, srcSpanEndLine = 79, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 18, srcSpanEndLine = 79, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLin"><span class="mpre">deriving (Show)</span></span><span class="mpre">

</span><a href="#loc_82_1_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_7&#39;)"><span class="mpre">getTag</span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_30_6_30_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_30_6_30_13&#39;)"><span class="hl_tyconref"><span class="mpre">Element</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_76_6_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre">
</span><a name="loc_82_1_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_7&#39;)"><span class="hl_fundecl"><span class="mpre">getTag</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">e</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 12, srcSpanEndLine = 85, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 16, srcSpanEndLine = 82, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLi"><span class="mpre">Tag { tagName = elName e
               , tagAttribs = elAttribs e
               , tagLine = elLine e
               }</span></span><span class="mpre">

</span><a href="#loc_88_1_88_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_7&#39;)"><span class="mpre">setTag</span></a><span class="mpre"> :: </span><a href="#loc_76_6_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> -&gt; </span><a href="Text.XML.Light.Types.html#loc_30_6_30_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_30_6_30_13&#39;)"><span class="hl_tyconref"><span class="mpre">Element</span></span></a><span class="mpre"> -&gt; </span><a href="Text.XML.Light.Types.html#loc_30_6_30_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_30_6_30_13&#39;)"><span class="hl_tyconref"><span class="mpre">Element</span></span></a><span class="mpre">
</span><a name="loc_88_1_88_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_7&#39;)"><span class="hl_fundecl"><span class="mpre">setTag</span></span></a><span class="mpre"> </span><a name="loc_88_8_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_8_88_9&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_88_10_88_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_10_88_11&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="#loc_91_1_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_8&#39;)"><span class="hl_varref"><span class="mpre">fromTag</span></span></a><span class="mpre"> </span><a href="#loc_88_8_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_8_88_9&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a href="Text.XML.Light.Types.html#loc_33_19_33_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_33_19_33_28&#39;)"><span class="hl_varref"><span class="mpre">elContent</span></span></a><span class="mpre"> </span><a href="#loc_88_10_88_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_10_88_11&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)

</span><a href="#loc_91_1_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_8&#39;)"><span class="mpre">fromTag</span></a><span class="mpre"> :: </span><a href="#loc_76_6_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> -&gt; [</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">] -&gt; </span><a href="Text.XML.Light.Types.html#loc_30_6_30_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_30_6_30_13&#39;)"><span class="hl_tyconref"><span class="mpre">Element</span></span></a><span class="mpre">
</span><a name="loc_91_1_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_8&#39;)"><span class="hl_fundecl"><span class="mpre">fromTag</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cs</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 16, srcSpanEndLine = 95, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 24, srcSpanEndLine = 91, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLi"><span class="mpre">Element { elName    = tagName t
                       , elAttribs = tagAttribs t
                       , elLine    = tagLine t
                       , elContent = cs
                       }</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 1, srcSpanEndLine = 97, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 1, srcSpanEndLine = 97, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine ="><span class="mpre">type Path = [([Content],Tag,[Content])]</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The position of a piece of content in an XML document.</span></span><span class="mpre">
data </span><a name="loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Cursor</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Cur</span></span><span class="mpre">
  { </span><a name="loc_101_5_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_12&#39;)"><span class="hl_fielddecl"><span class="mpre">current</span></span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ The currently selected content.</span></span><span class="mpre">
  , </span><a name="loc_102_5_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_10&#39;)"><span class="hl_fielddecl"><span class="mpre">lefts</span></span></a><span class="mpre">   :: [</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">]    </span><span class="hl_comment"><span class="mpre">-- ^ Siblings on the left, closest first.</span></span><span class="mpre">
  , </span><a name="loc_103_5_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_11&#39;)"><span class="hl_fielddecl"><span class="mpre">rights</span></span></a><span class="mpre">  :: [</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">]    </span><span class="hl_comment"><span class="mpre">-- ^ Siblings on the right, closest first.</span></span><span class="mpre">
  , </span><a name="loc_104_5_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_12&#39;)"><span class="hl_fielddecl"><span class="mpre">parents</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Path</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ The contexts of the parent elements of this location.</span></span><span class="mpre">
  } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 5, srcSpanEndLine = 105, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 5, srcSpanEndLine = 105, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartL"><span class="mpre">deriving (Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Moving around ---------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The parent of the given location.</span></span><span class="mpre">
</span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="mpre">parent</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_fundecl"><span class="mpre">parent</span></span></a><span class="mpre"> </span><a name="loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> =
  case </span><a href="#loc_104_5_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_12&#39;)"><span class="hl_varref"><span class="mpre">parents</span></span></a><span class="mpre"> </span><a href="#loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> of
    (</span><span class="hl_vardecl"><span class="mpre">pls</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">v</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">prs</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ps</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">
      </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 114, srcSpanStartColumn = 7, srcSpanEndLine = 118, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 114, srcSpanStartColumn = 11, srcSpanEndLine = 114, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStar"><span class="mpre">Cur { current = Elem
                    (fromTag v
                    (combChildren (lefts loc) (current loc) (rights loc)))
          , lefts = pls, rights = prs, parents = ps
          }</span></span><span class="mpre">
    [] -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The top-most parent of the given location.</span></span><span class="mpre">
</span><a href="#loc_124_1_124_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_5&#39;)"><span class="mpre">root</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_124_1_124_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_5&#39;)"><span class="hl_fundecl"><span class="mpre">root</span></span></a><span class="mpre"> </span><a name="loc_124_6_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_6_124_9&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><a href="#loc_124_6_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_6_124_9&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_124_1_124_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_5&#39;)"><span class="hl_varref"><span class="mpre">root</span></span></a><span class="mpre"> (</span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_varref"><span class="mpre">parent</span></span></a><span class="mpre"> </span><a href="#loc_124_6_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_6_124_9&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The left sibling of the given location.</span></span><span class="mpre">
</span><a href="#loc_128_1_128_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_5&#39;)"><span class="mpre">left</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_128_1_128_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_5&#39;)"><span class="hl_fundecl"><span class="mpre">left</span></span></a><span class="mpre"> </span><a name="loc_128_6_128_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_6_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> =
  case </span><a href="#loc_102_5_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_10&#39;)"><span class="hl_varref"><span class="mpre">lefts</span></span></a><span class="mpre"> </span><a href="#loc_128_6_128_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_6_128_9&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> of
    </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ts</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 20, srcSpanEndLine = 131, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 24, srcSpanEndLine = 130, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { current = t, lefts = ts
                                    , rights = current loc : rights loc }</span></span><span class="mpre">
    []     -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The right sibling of the given location.</span></span><span class="mpre">
</span><a href="#loc_136_1_136_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_6&#39;)"><span class="mpre">right</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_136_1_136_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_6&#39;)"><span class="hl_fundecl"><span class="mpre">right</span></span></a><span class="mpre"> </span><a name="loc_136_7_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_7_136_10&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> =
  case </span><a href="#loc_103_5_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_11&#39;)"><span class="hl_varref"><span class="mpre">rights</span></span></a><span class="mpre"> </span><a href="#loc_136_7_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_7_136_10&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> of
    </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ts</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 138, srcSpanStartColumn = 20, srcSpanEndLine = 139, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 138, srcSpanStartColumn = 24, srcSpanEndLine = 138, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { current = t, lefts = current loc : lefts loc
                                    , rights = ts }</span></span><span class="mpre">
    []     -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The first child of the given location.</span></span><span class="mpre">
</span><a href="#loc_144_1_144_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_11&#39;)"><span class="mpre">firstChild</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_144_1_144_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_11&#39;)"><span class="hl_fundecl"><span class="mpre">firstChild</span></span></a><span class="mpre"> </span><a name="loc_144_12_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_12_144_15&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> =
  do (</span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ts</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">ps</span></span><span class="mpre">) &lt;- </span><a href="#loc_195_1_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_12&#39;)"><span class="hl_varref"><span class="mpre">downParents</span></span></a><span class="mpre"> </span><a href="#loc_144_12_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_12_144_15&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">
     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 13, srcSpanEndLine = 146, srcSpanEndColumn = 72}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 17, srcSpanEndLine = 146, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">Cur { current = t, lefts = [], rights = ts , parents = ps }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The last child of the given location.</span></span><span class="mpre">
</span><a href="#loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="mpre">lastChild</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="hl_fundecl"><span class="mpre">lastChild</span></span></a><span class="mpre"> </span><a name="loc_150_11_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_14&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> =
  do (</span><a name="loc_151_7_151_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_7_151_9&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">ps</span></span><span class="mpre">) &lt;- </span><a href="#loc_195_1_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_12&#39;)"><span class="hl_varref"><span class="mpre">downParents</span></span></a><span class="mpre"> </span><a href="#loc_150_11_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_14&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">
     case </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_151_7_151_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_7_151_9&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> of
       </span><span class="hl_vardecl"><span class="mpre">l</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ls</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 153, srcSpanStartColumn = 25, srcSpanEndLine = 154, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 153, srcSpanStartColumn = 29, srcSpanEndLine = 153, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">Cur { current = l, lefts = ls, rights = []
                                                     , parents = ps }</span></span><span class="mpre">
       [] -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Find the next left sibling that satisfies a predicate.</span></span><span class="mpre">
</span><a href="#loc_159_1_159_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_9&#39;)"><span class="mpre">findLeft</span></a><span class="mpre"> :: (</span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_159_1_159_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_9&#39;)"><span class="hl_fundecl"><span class="mpre">findLeft</span></span></a><span class="mpre"> </span><a name="loc_159_10_159_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_10_159_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_159_12_159_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_12_159_15&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = do </span><a name="loc_159_21_159_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_21_159_25&#39;)"><span class="hl_vardecl"><span class="mpre">loc1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_128_1_128_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_5&#39;)"><span class="hl_varref"><span class="mpre">left</span></span></a><span class="mpre"> </span><a href="#loc_159_12_159_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_12_159_15&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">
                    if </span><a href="#loc_159_10_159_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_10_159_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_159_21_159_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_21_159_25&#39;)"><span class="hl_varref"><span class="mpre">loc1</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_159_21_159_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_21_159_25&#39;)"><span class="hl_varref"><span class="mpre">loc1</span></span></a><span class="mpre"> else </span><a href="#loc_159_1_159_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_9&#39;)"><span class="hl_varref"><span class="mpre">findLeft</span></span></a><span class="mpre"> </span><a href="#loc_159_10_159_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_10_159_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_159_21_159_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_21_159_25&#39;)"><span class="hl_varref"><span class="mpre">loc1</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Find the next right sibling that satisfies a predicate.</span></span><span class="mpre">
</span><a href="#loc_164_1_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_10&#39;)"><span class="mpre">findRight</span></a><span class="mpre"> :: (</span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_164_1_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_10&#39;)"><span class="hl_fundecl"><span class="mpre">findRight</span></span></a><span class="mpre"> </span><a name="loc_164_11_164_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_11_164_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_164_13_164_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_13_164_16&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = do </span><a name="loc_164_22_164_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_22_164_26&#39;)"><span class="hl_vardecl"><span class="mpre">loc1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_136_1_136_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_6&#39;)"><span class="hl_varref"><span class="mpre">right</span></span></a><span class="mpre"> </span><a href="#loc_164_13_164_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_13_164_16&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">
                     if </span><a href="#loc_164_11_164_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_11_164_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_164_22_164_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_22_164_26&#39;)"><span class="hl_varref"><span class="mpre">loc1</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_164_22_164_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_22_164_26&#39;)"><span class="hl_varref"><span class="mpre">loc1</span></span></a><span class="mpre"> else </span><a href="#loc_164_1_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_10&#39;)"><span class="hl_varref"><span class="mpre">findRight</span></span></a><span class="mpre"> </span><a href="#loc_164_11_164_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_11_164_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_164_22_164_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_22_164_26&#39;)"><span class="hl_varref"><span class="mpre">loc1</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The first child that satisfies a predicate.</span></span><span class="mpre">
</span><a href="#loc_169_1_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_10&#39;)"><span class="mpre">findChild</span></a><span class="mpre"> :: (</span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_169_1_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_10&#39;)"><span class="hl_fundecl"><span class="mpre">findChild</span></span></a><span class="mpre"> </span><a name="loc_169_11_169_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_11_169_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_169_13_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_13_169_16&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> =
  do </span><a name="loc_170_6_170_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_10&#39;)"><span class="hl_vardecl"><span class="mpre">loc1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_144_1_144_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_11&#39;)"><span class="hl_varref"><span class="mpre">firstChild</span></span></a><span class="mpre"> </span><a href="#loc_169_13_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_13_169_16&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">
     if </span><a href="#loc_169_11_169_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_11_169_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_170_6_170_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_10&#39;)"><span class="hl_varref"><span class="mpre">loc1</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_170_6_170_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_10&#39;)"><span class="hl_varref"><span class="mpre">loc1</span></span></a><span class="mpre"> else </span><a href="#loc_164_1_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_10&#39;)"><span class="hl_varref"><span class="mpre">findRight</span></span></a><span class="mpre"> </span><a href="#loc_169_11_169_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_11_169_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_170_6_170_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_10&#39;)"><span class="hl_varref"><span class="mpre">loc1</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The next position in a left-to-right depth-first traversal of a document:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- either the first child, right sibling, or the right sibling of a parent that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- has one.</span></span><span class="mpre">
</span><a href="#loc_177_1_177_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_7&#39;)"><span class="mpre">nextDF</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_177_1_177_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_7&#39;)"><span class="hl_fundecl"><span class="mpre">nextDF</span></span></a><span class="mpre"> </span><a name="loc_177_8_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_8_177_9&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_144_1_144_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_11&#39;)"><span class="hl_varref"><span class="mpre">firstChild</span></span></a><span class="mpre"> </span><a href="#loc_177_8_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_8_177_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_178_9_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_11&#39;)"><span class="hl_varref"><span class="mpre">up</span></span></a><span class="mpre"> </span><a href="#loc_177_8_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_8_177_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
  where </span><a name="loc_178_9_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_11&#39;)"><span class="hl_fundecl"><span class="mpre">up</span></span></a><span class="mpre"> </span><a name="loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_136_1_136_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_6&#39;)"><span class="hl_varref"><span class="mpre">right</span></span></a><span class="mpre"> </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> (</span><a href="#loc_178_9_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_11&#39;)"><span class="hl_varref"><span class="mpre">up</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_varref"><span class="mpre">parent</span></span></a><span class="mpre"> </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Perform a depth first search for a descendant that satisfies the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- given predicate.</span></span><span class="mpre">
</span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="mpre">findRec</span></a><span class="mpre"> :: (</span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_fundecl"><span class="mpre">findRec</span></span></a><span class="mpre"> </span><a name="loc_183_9_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_183_11_183_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_12&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = if </span><a href="#loc_183_9_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_183_11_183_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_183_11_183_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> else </span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_varref"><span class="mpre">findRec</span></span></a><span class="mpre"> </span><a href="#loc_183_9_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="#loc_177_1_177_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_7&#39;)"><span class="hl_varref"><span class="mpre">nextDF</span></span></a><span class="mpre"> </span><a href="#loc_183_11_183_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The child with the given index (starting from 0).</span></span><span class="mpre">
</span><a href="#loc_187_1_187_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_9&#39;)"><span class="mpre">getChild</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_187_1_187_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_9&#39;)"><span class="hl_fundecl"><span class="mpre">getChild</span></span></a><span class="mpre"> </span><a name="loc_187_10_187_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_187_12_187_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_12_187_15&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> =
  do (</span><a name="loc_188_7_188_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_9&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">ps</span></span><span class="mpre">) &lt;- </span><a href="#loc_195_1_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_12&#39;)"><span class="hl_varref"><span class="mpre">downParents</span></span></a><span class="mpre"> </span><a href="#loc_187_12_187_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_12_187_15&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">
     (</span><span class="hl_vardecl"><span class="mpre">ls</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">rs</span></span><span class="mpre">) &lt;- </span><a href="#loc_334_1_334_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_14&#39;)"><span class="hl_varref"><span class="mpre">splitChildren</span></span></a><span class="mpre"> </span><a href="#loc_188_7_188_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_9&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> </span><a href="#loc_187_10_187_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 13, srcSpanEndLine = 190, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 17, srcSpanEndLine = 190, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">Cur { current = t, lefts = ls, rights = rs, parents = ps }</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | private: computes the parent for &quot;down&quot; operations.</span></span><span class="mpre">
</span><a href="#loc_195_1_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_12&#39;)"><span class="mpre">downParents</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> ([</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Path</span></span><span class="mpre">)
</span><a name="loc_195_1_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_12&#39;)"><span class="hl_fundecl"><span class="mpre">downParents</span></span></a><span class="mpre"> </span><a name="loc_195_13_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_13_195_16&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> =
  case </span><a href="#loc_101_5_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_12&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre"> </span><a href="#loc_195_13_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_13_195_16&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> of
    </span><a href="Text.XML.Light.Types.html#loc_24_17_24_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_17_24_21&#39;)"><span class="hl_conref"><span class="mpre">Elem</span></span></a><span class="mpre"> </span><a name="loc_197_10_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_10_197_11&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> ( </span><a href="Text.XML.Light.Types.html#loc_33_19_33_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_33_19_33_28&#39;)"><span class="hl_varref"><span class="mpre">elContent</span></span></a><span class="mpre"> </span><a href="#loc_197_10_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_10_197_11&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                   , (</span><a href="#loc_102_5_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_10&#39;)"><span class="hl_varref"><span class="mpre">lefts</span></span></a><span class="mpre"> </span><a href="#loc_195_13_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_13_195_16&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">, </span><a href="#loc_82_1_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_7&#39;)"><span class="hl_varref"><span class="mpre">getTag</span></span></a><span class="mpre"> </span><a href="#loc_197_10_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_10_197_11&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">, </span><a href="#loc_103_5_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_11&#39;)"><span class="hl_varref"><span class="mpre">rights</span></span></a><span class="mpre"> </span><a href="#loc_195_13_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_13_195_16&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_104_5_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_12&#39;)"><span class="hl_varref"><span class="mpre">parents</span></span></a><span class="mpre"> </span><a href="#loc_195_13_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_13_195_16&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">
                   )
    _      -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Conversions -----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A cursor for the given content.</span></span><span class="mpre">
</span><a href="#loc_206_1_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_12&#39;)"><span class="mpre">fromContent</span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_206_1_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_12&#39;)"><span class="hl_fundecl"><span class="mpre">fromContent</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 206, srcSpanStartColumn = 17, srcSpanEndLine = 206, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 206, srcSpanStartColumn = 21, srcSpanEndLine = 206, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">Cur { current = t, lefts = [], rights = [], parents = [] }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A cursor for the given element.</span></span><span class="mpre">
</span><a href="#loc_210_1_210_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_12&#39;)"><span class="mpre">fromElement</span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_30_6_30_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_30_6_30_13&#39;)"><span class="hl_tyconref"><span class="mpre">Element</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_210_1_210_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_12&#39;)"><span class="hl_fundecl"><span class="mpre">fromElement</span></span></a><span class="mpre"> </span><a name="loc_210_13_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_13_210_14&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="#loc_206_1_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_12&#39;)"><span class="hl_varref"><span class="mpre">fromContent</span></span></a><span class="mpre"> (</span><a href="Text.XML.Light.Types.html#loc_24_17_24_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_17_24_21&#39;)"><span class="hl_conref"><span class="mpre">Elem</span></span></a><span class="mpre"> </span><a href="#loc_210_13_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_13_210_14&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The location of the first tree in a forest.</span></span><span class="mpre">
</span><a href="#loc_214_1_214_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_11&#39;)"><span class="mpre">fromForest</span></a><span class="mpre"> :: [</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_214_1_214_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_11&#39;)"><span class="hl_fundecl"><span class="mpre">fromForest</span></span></a><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_vardecl"><span class="mpre">ts</span></span><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 214, srcSpanStartColumn = 26, srcSpanEndLine = 215, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 214, srcSpanStartColumn = 30, srcSpanEndLine = 214, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">Cur { current = t, lefts = [], rights = ts
                                                      , parents = [] }</span></span><span class="mpre">
</span><a href="#loc_214_1_214_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_11&#39;)"><span class="hl_fundecl"><span class="mpre">fromForest</span></span></a><span class="mpre"> []     = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Computes the tree containing this location.</span></span><span class="mpre">
</span><a href="#loc_220_1_220_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_7&#39;)"><span class="mpre">toTree</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">
</span><a name="loc_220_1_220_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_7&#39;)"><span class="hl_fundecl"><span class="mpre">toTree</span></span></a><span class="mpre"> </span><a name="loc_220_8_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_8_220_11&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><a href="#loc_101_5_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_12&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre"> (</span><a href="#loc_124_1_124_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_5&#39;)"><span class="hl_varref"><span class="mpre">root</span></span></a><span class="mpre"> </span><a href="#loc_220_8_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_8_220_11&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Computes the forest containing this location.</span></span><span class="mpre">
</span><a href="#loc_224_1_224_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_9&#39;)"><span class="mpre">toForest</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; [</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">]
</span><a name="loc_224_1_224_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_9&#39;)"><span class="hl_fundecl"><span class="mpre">toForest</span></span></a><span class="mpre"> </span><a name="loc_224_10_224_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_10_224_13&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = let </span><a name="loc_224_20_224_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_20_224_21&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_124_1_124_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_5&#39;)"><span class="hl_varref"><span class="mpre">root</span></span></a><span class="mpre"> </span><a href="#loc_224_10_224_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_10_224_13&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> in </span><a href="#loc_342_1_342_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_13&#39;)"><span class="hl_varref"><span class="mpre">combChildren</span></span></a><span class="mpre"> (</span><a href="#loc_102_5_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_10&#39;)"><span class="hl_varref"><span class="mpre">lefts</span></span></a><span class="mpre"> </span><a href="#loc_224_20_224_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_20_224_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">) (</span><a href="#loc_101_5_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_12&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre"> </span><a href="#loc_224_20_224_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_20_224_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">) (</span><a href="#loc_103_5_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_11&#39;)"><span class="hl_varref"><span class="mpre">rights</span></span></a><span class="mpre"> </span><a href="#loc_224_20_224_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_20_224_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- Queries ---------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Are we at the top of the document?</span></span><span class="mpre">
</span><a href="#loc_231_1_231_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_7&#39;)"><span class="mpre">isRoot</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_231_1_231_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_7&#39;)"><span class="hl_fundecl"><span class="mpre">isRoot</span></span></a><span class="mpre"> </span><a name="loc_231_8_231_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_8_231_11&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> (</span><a href="#loc_104_5_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_12&#39;)"><span class="hl_varref"><span class="mpre">parents</span></span></a><span class="mpre"> </span><a href="#loc_231_8_231_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_8_231_11&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Are we at the left end of the the document?</span></span><span class="mpre">
</span><a href="#loc_235_1_235_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_8&#39;)"><span class="mpre">isFirst</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_235_1_235_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_8&#39;)"><span class="hl_fundecl"><span class="mpre">isFirst</span></span></a><span class="mpre"> </span><a name="loc_235_9_235_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_12&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> (</span><a href="#loc_102_5_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_10&#39;)"><span class="hl_varref"><span class="mpre">lefts</span></span></a><span class="mpre"> </span><a href="#loc_235_9_235_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_12&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Are we at the right end of the document?</span></span><span class="mpre">
</span><a href="#loc_239_1_239_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_7&#39;)"><span class="mpre">isLast</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_239_1_239_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_7&#39;)"><span class="hl_fundecl"><span class="mpre">isLast</span></span></a><span class="mpre"> </span><a name="loc_239_8_239_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_8_239_11&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> (</span><a href="#loc_103_5_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_11&#39;)"><span class="hl_varref"><span class="mpre">rights</span></span></a><span class="mpre"> </span><a href="#loc_239_8_239_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_8_239_11&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Are we at the bottom of the document?</span></span><span class="mpre">
</span><a href="#loc_243_1_243_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_7&#39;)"><span class="mpre">isLeaf</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_243_1_243_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_7&#39;)"><span class="hl_fundecl"><span class="mpre">isLeaf</span></span></a><span class="mpre"> </span><a name="loc_243_8_243_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_8_243_11&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="hl_varref"><span class="mpre">isNothing</span></span></a><span class="mpre"> (</span><a href="#loc_195_1_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_12&#39;)"><span class="hl_varref"><span class="mpre">downParents</span></span></a><span class="mpre"> </span><a href="#loc_243_8_243_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_8_243_11&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Do we have a parent?</span></span><span class="mpre">
</span><a href="#loc_247_1_247_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_8&#39;)"><span class="mpre">isChild</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_247_1_247_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_8&#39;)"><span class="hl_fundecl"><span class="mpre">isChild</span></span></a><span class="mpre"> </span><a name="loc_247_9_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_9_247_12&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_231_1_231_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_7&#39;)"><span class="hl_varref"><span class="mpre">isRoot</span></span></a><span class="mpre"> </span><a href="#loc_247_9_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_9_247_12&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Get the node index inside the sequence of children</span></span><span class="mpre">
</span><a href="#loc_251_1_251_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_13&#39;)"><span class="mpre">getNodeIndex</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_251_1_251_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_13&#39;)"><span class="hl_fundecl"><span class="mpre">getNodeIndex</span></span></a><span class="mpre"> </span><a name="loc_251_14_251_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_14_251_17&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> (</span><a href="#loc_102_5_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_10&#39;)"><span class="hl_varref"><span class="mpre">lefts</span></span></a><span class="mpre"> </span><a href="#loc_251_14_251_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_14_251_17&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Do we have children?</span></span><span class="mpre">
</span><a href="#loc_255_1_255_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_12&#39;)"><span class="mpre">hasChildren</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_255_1_255_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_12&#39;)"><span class="hl_fundecl"><span class="mpre">hasChildren</span></span></a><span class="mpre"> </span><a name="loc_255_13_255_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_13_255_16&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_243_1_243_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_7&#39;)"><span class="hl_varref"><span class="mpre">isLeaf</span></span></a><span class="mpre"> </span><a href="#loc_255_13_255_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_13_255_16&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)



</span><span class="hl_comment"><span class="mpre">-- Updates ---------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Change the current content.</span></span><span class="mpre">
</span><a href="#loc_263_1_263_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_11&#39;)"><span class="mpre">setContent</span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_263_1_263_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_11&#39;)"><span class="hl_fundecl"><span class="mpre">setContent</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">loc</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 263, srcSpanStartColumn = 20, srcSpanEndLine = 263, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 263, srcSpanStartColumn = 24, srcSpanEndLine = 263, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { current = t }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Modify the current content.</span></span><span class="mpre">
</span><a href="#loc_267_1_267_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_14&#39;)"><span class="mpre">modifyContent</span></a><span class="mpre"> :: (</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre"> -&gt; </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_267_1_267_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_14&#39;)"><span class="hl_fundecl"><span class="mpre">modifyContent</span></span></a><span class="mpre"> </span><a name="loc_267_15_267_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_15_267_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_267_17_267_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_17_267_20&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><a href="#loc_263_1_263_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_11&#39;)"><span class="hl_varref"><span class="mpre">setContent</span></span></a><span class="mpre"> (</span><a href="#loc_267_15_267_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_15_267_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_101_5_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_12&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre"> </span><a href="#loc_267_17_267_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_17_267_20&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)) </span><a href="#loc_267_17_267_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_17_267_20&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Modify the current content, allowing for an effect.</span></span><span class="mpre">
</span><a href="#loc_271_1_271_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_15&#39;)"><span class="mpre">modifyContentM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 270, srcSpanStartColumn = 19, srcSpanEndLine = 270, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 270, srcSpanStartColumn = 27, srcSpanEndLine = 270, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_271_1_271_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_15&#39;)"><span class="hl_fundecl"><span class="mpre">modifyContentM</span></span></a><span class="mpre"> </span><a name="loc_271_16_271_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_16_271_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_271_18_271_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_18_271_21&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = do </span><a name="loc_271_27_271_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_27_271_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_271_16_271_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_16_271_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_101_5_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_12&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre"> </span><a href="#loc_271_18_271_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_18_271_21&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)
                          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_263_1_263_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_11&#39;)"><span class="hl_varref"><span class="mpre">setContent</span></span></a><span class="mpre"> </span><a href="#loc_271_27_271_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_27_271_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_271_18_271_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_18_271_21&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Insert content to the left of the current position.</span></span><span class="mpre">
</span><a href="#loc_276_1_276_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_1_276_11&#39;)"><span class="mpre">insertLeft</span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_276_1_276_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_1_276_11&#39;)"><span class="hl_fundecl"><span class="mpre">insertLeft</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">loc</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 276, srcSpanStartColumn = 20, srcSpanEndLine = 276, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 276, srcSpanStartColumn = 24, srcSpanEndLine = 276, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { lefts = t : lefts loc }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Insert content to the right of the current position.</span></span><span class="mpre">
</span><a href="#loc_280_1_280_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_12&#39;)"><span class="mpre">insertRight</span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_280_1_280_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_12&#39;)"><span class="hl_fundecl"><span class="mpre">insertRight</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">loc</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 280, srcSpanStartColumn = 21, srcSpanEndLine = 280, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 280, srcSpanStartColumn = 25, srcSpanEndLine = 280, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { rights = t : rights loc }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Remove the content on the left of the current position, if any.</span></span><span class="mpre">
</span><a href="#loc_284_1_284_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_1_284_11&#39;)"><span class="mpre">removeLeft</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">,</span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">)
</span><a name="loc_284_1_284_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_1_284_11&#39;)"><span class="hl_fundecl"><span class="mpre">removeLeft</span></span></a><span class="mpre"> </span><a name="loc_284_12_284_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_12_284_15&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = case </span><a href="#loc_102_5_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_10&#39;)"><span class="hl_varref"><span class="mpre">lefts</span></span></a><span class="mpre"> </span><a href="#loc_284_12_284_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_12_284_15&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> of
                   </span><a name="loc_285_20_285_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_20_285_21&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ls</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_285_20_285_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_20_285_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 285, srcSpanStartColumn = 40, srcSpanEndLine = 285, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 285, srcSpanStartColumn = 44, srcSpanEndLine = 285, srcSpanEndColumn = 45},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { lefts = ls }</span></span><span class="mpre">)
                   [] -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Remove the content on the right of the current position, if any.</span></span><span class="mpre">
</span><a href="#loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="mpre">removeRight</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">,</span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">)
</span><a name="loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="hl_fundecl"><span class="mpre">removeRight</span></span></a><span class="mpre"> </span><a name="loc_290_13_290_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_13_290_16&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = case </span><a href="#loc_103_5_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_11&#39;)"><span class="hl_varref"><span class="mpre">rights</span></span></a><span class="mpre"> </span><a href="#loc_290_13_290_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_13_290_16&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> of
                    </span><a name="loc_291_21_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_21_291_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ls</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_291_21_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_21_291_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 291, srcSpanStartColumn = 41, srcSpanEndLine = 291, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 291, srcSpanStartColumn = 45, srcSpanEndLine = 291, srcSpanEndColumn = 46},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { rights = ls }</span></span><span class="mpre">)
                    [] -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Insert content to the left of the current position.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The new content becomes the current position.</span></span><span class="mpre">
</span><a href="#loc_298_1_298_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_13&#39;)"><span class="mpre">insertGoLeft</span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_298_1_298_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_13&#39;)"><span class="hl_fundecl"><span class="mpre">insertGoLeft</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">loc</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 298, srcSpanStartColumn = 22, srcSpanEndLine = 298, srcSpanEndColumn = 76}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 298, srcSpanStartColumn = 26, srcSpanEndLine = 298, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { current = t, rights = current loc : rights loc }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Insert content to the right of the current position.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The new content becomes the current position.</span></span><span class="mpre">
</span><a href="#loc_303_1_303_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_14&#39;)"><span class="mpre">insertGoRight</span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_303_1_303_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_14&#39;)"><span class="hl_fundecl"><span class="mpre">insertGoRight</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">loc</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 303, srcSpanStartColumn = 23, srcSpanEndLine = 303, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 303, srcSpanStartColumn = 27, srcSpanEndLine = 303, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { current = t, lefts = current loc : lefts loc }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Remove the current element.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The new position is the one on the left.</span></span><span class="mpre">
</span><a href="#loc_308_1_308_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_13&#39;)"><span class="mpre">removeGoLeft</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_308_1_308_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_13&#39;)"><span class="hl_fundecl"><span class="mpre">removeGoLeft</span></span></a><span class="mpre"> </span><a name="loc_308_14_308_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_14_308_17&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = case </span><a href="#loc_102_5_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_10&#39;)"><span class="hl_varref"><span class="mpre">lefts</span></span></a><span class="mpre"> </span><a href="#loc_308_14_308_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_14_308_17&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> of
                     </span><span class="hl_vardecl"><span class="mpre">l</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ls</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 37, srcSpanEndLine = 309, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 41, srcSpanEndLine = 309, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { current = l, lefts = ls }</span></span><span class="mpre">
                     []     -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Remove the current element.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The new position is the one on the right.</span></span><span class="mpre">
</span><a href="#loc_315_1_315_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_14&#39;)"><span class="mpre">removeGoRight</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_315_1_315_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_14&#39;)"><span class="hl_fundecl"><span class="mpre">removeGoRight</span></span></a><span class="mpre"> </span><a name="loc_315_15_315_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_15_315_18&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = case </span><a href="#loc_103_5_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_11&#39;)"><span class="hl_varref"><span class="mpre">rights</span></span></a><span class="mpre"> </span><a href="#loc_315_15_315_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_15_315_18&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> of
                     </span><span class="hl_vardecl"><span class="mpre">l</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ls</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 316, srcSpanStartColumn = 37, srcSpanEndLine = 316, srcSpanEndColumn = 69}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 316, srcSpanStartColumn = 41, srcSpanEndLine = 316, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanSta"><span class="mpre">loc { current = l, rights = ls }</span></span><span class="mpre">
                     []     -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Remove the current element.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The new position is the parent of the old position.</span></span><span class="mpre">
</span><a href="#loc_322_1_322_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_1_322_11&#39;)"><span class="mpre">removeGoUp</span></a><span class="mpre"> :: </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cursor</span></span></a><span class="mpre">
</span><a name="loc_322_1_322_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_1_322_11&#39;)"><span class="hl_fundecl"><span class="mpre">removeGoUp</span></span></a><span class="mpre"> </span><a name="loc_322_12_322_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_12_322_15&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> =
  case </span><a href="#loc_104_5_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_12&#39;)"><span class="hl_varref"><span class="mpre">parents</span></span></a><span class="mpre"> </span><a href="#loc_322_12_322_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_12_322_15&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> of
    (</span><span class="hl_vardecl"><span class="mpre">pls</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">v</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">prs</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ps</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">
      </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 325, srcSpanStartColumn = 7, srcSpanEndLine = 327, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStartLine = 325, srcSpanStartColumn = 11, srcSpanEndLine = 325, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Cursor.hs&quot;, srcSpanStar"><span class="mpre">Cur { current = Elem (fromTag v (reverse (lefts loc) ++ rights loc))
          , lefts = pls, rights = prs, parents = ps
          }</span></span><span class="mpre">
    [] -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | private: Gets the given element of a list.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Also returns the preceding elements (reversed) and the following elements.</span></span><span class="mpre">
</span><a href="#loc_334_1_334_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_14&#39;)"><span class="mpre">splitChildren</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">],</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">])
</span><a name="loc_334_1_334_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitChildren</span></span></a><span class="mpre"> _ </span><a name="loc_334_17_334_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_17_334_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> | </span><a href="#loc_334_17_334_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_17_334_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_334_1_334_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitChildren</span></span></a><span class="mpre"> </span><a name="loc_335_15_335_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_15_335_17&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> </span><a name="loc_335_18_335_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_18_335_21&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> = </span><a href="#loc_336_9_336_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_9_336_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> [] </span><a href="#loc_335_15_335_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_15_335_17&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> </span><a href="#loc_335_18_335_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_18_335_21&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre">
  where </span><a name="loc_336_9_336_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_9_336_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_336_14_336_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_14_336_17&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> (</span><a name="loc_336_19_336_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_19_336_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_336_21_336_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_21_336_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_336_14_336_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_14_336_17&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">,</span><a href="#loc_336_19_336_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_19_336_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_336_21_336_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_21_336_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        </span><a href="#loc_336_9_336_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_9_336_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_337_14_337_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_14_337_17&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> (</span><a name="loc_337_19_337_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_19_337_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_337_21_337_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_21_337_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_337_25_337_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_25_337_26&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_336_9_336_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_9_336_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_337_19_337_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_19_337_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_337_14_337_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_14_337_17&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) </span><a href="#loc_337_21_337_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_21_337_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_337_25_337_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_25_337_26&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a href="#loc_336_9_336_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_9_336_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> _ _ _        = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | private: combChildren ls x ys = reverse ls ++ [x] ++ ys</span></span><span class="mpre">
</span><a href="#loc_342_1_342_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_13&#39;)"><span class="mpre">combChildren</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_342_1_342_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_13&#39;)"><span class="hl_fundecl"><span class="mpre">combChildren</span></span></a><span class="mpre"> </span><a name="loc_342_14_342_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_14_342_16&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a name="loc_342_17_342_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_17_342_18&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_342_19_342_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_19_342_21&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) (</span><a href="#loc_342_17_342_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_17_342_18&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_342_19_342_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_19_342_21&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">) </span><a href="#loc_342_14_342_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_14_342_16&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">
</span></div></body></html>