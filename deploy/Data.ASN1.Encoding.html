<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ASN1.Encoding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.ASN1.Encoding
    (
    </span><span class="hl_comment"><span class="mpre">-- * generic class for decoding and encoding stream</span></span><span class="mpre">
      ASN1Decoding(..)
    , ASN1DecodingRepr(..)
    , ASN1Encoding(..)
    </span><span class="hl_comment"><span class="mpre">-- * strict bytestring version</span></span><span class="mpre">
    , decodeASN1&#39;
    , decodeASN1Repr&#39;
    , encodeASN1&#39;
    ) where

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Encoding.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 18, srcSpanEndLine = 20, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Encoding.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 18, srcSpanEndLine = 21, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import Data.ASN1.Stream
import Data.ASN1.Types
import Data.ASN1.Error

</span><span class="hl_comment"><span class="mpre">-- | Describe an ASN1 decoding, that transform a bytestream into an asn1stream</span></span><span class="mpre">
class </span><a name="loc_27_7_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_19&#39;)"><span class="hl_classdecl"><span class="mpre">ASN1Decoding</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
    </span><span class="hl_comment"><span class="mpre">-- | decode a lazy bytestring into an ASN1 stream</span></span><span class="mpre">
    </span><a name="loc_29_5_29_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_5_29_15&#39;)"><span class="mpre">decodeASN1</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | transition class.</span></span><span class="mpre">
class </span><a name="loc_32_7_32_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_23&#39;)"><span class="hl_classdecl"><span class="mpre">ASN1DecodingRepr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
    </span><span class="hl_comment"><span class="mpre">-- | decode a lazy bytestring into an ASN1 stream</span></span><span class="mpre">
    </span><a name="loc_34_5_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_19&#39;)"><span class="mpre">decodeASN1Repr</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">ASN1Repr</span></span><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | Describe an ASN1 encoding, that transform an asn1stream into a bytestream</span></span><span class="mpre">
class </span><a name="loc_37_7_37_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_19&#39;)"><span class="hl_classdecl"><span class="mpre">ASN1Encoding</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
    </span><span class="hl_comment"><span class="mpre">-- | encode a stream into a lazy bytestring</span></span><span class="mpre">
    </span><a name="loc_39_5_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_15&#39;)"><span class="mpre">encodeASN1</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | decode a strict bytestring into an ASN1 stream</span></span><span class="mpre">
</span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="mpre">decodeASN1&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Encoding.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 16, srcSpanEndLine = 42, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Encoding.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 31, srcSpanEndLine = 42, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">ASN1Decoding a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">]
</span><a name="loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_fundecl"><span class="mpre">decodeASN1&#39;</span></span></a><span class="mpre"> </span><a name="loc_43_13_43_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_21&#39;)"><span class="hl_vardecl"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><a name="loc_43_22_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_22_43_24&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_29_5_29_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_5_29_15&#39;)"><span class="hl_varref"><span class="mpre">decodeASN1</span></span></a><span class="mpre"> </span><a href="#loc_43_13_43_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_21&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><a href="#loc_43_22_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_22_43_24&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | decode a strict bytestring into an ASN1Repr stream</span></span><span class="mpre">
</span><a href="#loc_47_1_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_16&#39;)"><span class="mpre">decodeASN1Repr&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Encoding.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 20, srcSpanEndLine = 46, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Encoding.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 39, srcSpanEndLine = 46, srcSpanEndColumn = 41}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">ASN1DecodingRepr a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">ASN1Repr</span></span><span class="mpre">]
</span><a name="loc_47_1_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_16&#39;)"><span class="hl_fundecl"><span class="mpre">decodeASN1Repr&#39;</span></span></a><span class="mpre"> </span><a name="loc_47_17_47_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_25&#39;)"><span class="hl_vardecl"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><a name="loc_47_26_47_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_26_47_28&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_34_5_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_19&#39;)"><span class="hl_varref"><span class="mpre">decodeASN1Repr</span></span></a><span class="mpre"> </span><a href="#loc_47_17_47_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_25&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><a href="#loc_47_26_47_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_26_47_28&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | encode a stream into a strict bytestring</span></span><span class="mpre">
</span><a href="#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_12&#39;)"><span class="mpre">encodeASN1&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Encoding.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 16, srcSpanEndLine = 50, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/Encoding.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 31, srcSpanEndLine = 50, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">ASN1Encoding a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_51_1_51_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_12&#39;)"><span class="hl_fundecl"><span class="mpre">encodeASN1&#39;</span></span></a><span class="mpre"> </span><a name="loc_51_13_51_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_21&#39;)"><span class="hl_vardecl"><span class="mpre">encoding</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_39_5_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_15&#39;)"><span class="hl_varref"><span class="mpre">encodeASN1</span></span></a><span class="mpre"> </span><a href="#loc_51_13_51_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_21&#39;)"><span class="hl_varref"><span class="mpre">encoding</span></span></a><span class="mpre">
</span></div></body></html>