<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ScopedTypeVariables #-}
</span><span class="hl_comment"><span class="mpre">-- | Support for making connections via the connection package and, in turn,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the tls package suite.</span></span><span class="mpre">
module Network.HTTP.Client.TLS
    ( tlsManagerSettings
    , mkManagerSettings
    , getTlsConnection
    ) where

import Data.Default.Class
import Network.HTTP.Client
import Network.HTTP.Client.Internal
import Control.Exception
import qualified Network.Connection as NC
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Network/HTTP/Client/TLS.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 8, srcSpanEndLine = 15, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre"> (HostAddress)
import qualified Network.TLS as TLS
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Network/HTTP/Client/TLS.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 18, srcSpanEndLine = 17, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S

</span><a href="#loc_22_1_22_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_18&#39;)"><span class="mpre">mkManagerSettings</span></a><span class="mpre"> :: </span><a href="Network.Connection.Types.html#loc_65_6_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.Types.html#loc_65_6_65_17&#39;)"><span class="hl_tyconref"><span class="mpre">NC.TLSSettings</span></span></a><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">NC.SockSettings</span></span><span class="mpre">
                  -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_447_6_447_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_447_6_447_21&#39;)"><span class="hl_tyconref"><span class="mpre">ManagerSettings</span></span></a><span class="mpre">
</span><a name="loc_22_1_22_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_18&#39;)"><span class="hl_fundecl"><span class="mpre">mkManagerSettings</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">tls</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">sock</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Network/HTTP/Client/TLS.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 30, srcSpanEndLine = 60, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Network/HTTP/Client/TLS.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 5, srcSpanEndLine = 23, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Network"><span class="mpre">defaultManagerSettings
    { managerTlsConnection = getTlsConnection (Just tls) sock
    , managerTlsProxyConnection = getTlsProxyConnection tls sock
    , managerRawConnection =
        case sock of
            Nothing -&gt; managerRawConnection defaultManagerSettings
            Just _ -&gt; getTlsConnection Nothing sock
    , managerRetryableException = \e -&gt;
        case () of
            ()
                | ((fromException e)::(Maybe TLS.TLSError))==Just TLS.Error_EOF -&gt; True
                | otherwise -&gt; case fromException e of
                    Just (_ :: IOException) -&gt; True
                    _ -&gt;
                        case fromException e of
                            </span><span class="hl_comment"><span class="mpre">-- Note: Some servers will timeout connections by accepting</span></span><span class="mpre">
                            </span><span class="hl_comment"><span class="mpre">-- the incoming packets for the new request, but closing</span></span><span class="mpre">
                            </span><span class="hl_comment"><span class="mpre">-- the connection as soon as we try to read. To make sure</span></span><span class="mpre">
                            </span><span class="hl_comment"><span class="mpre">-- we open a new connection under these circumstances, we</span></span><span class="mpre">
                            </span><span class="hl_comment"><span class="mpre">-- check for the NoResponseDataReceived exception.</span></span><span class="mpre">
                            Just NoResponseDataReceived -&gt; True
                            Just IncompleteHeaders -&gt; True
                            _ -&gt; False
    , managerWrapIOException =
        let wrapper se =
                case fromException se of
                    Just e -&gt; toException $ InternalIOException e
                    Nothing -&gt;
                        case fromException se of
                            Just TLS.Terminated{} -&gt; toException $ TlsException se
                            _ -&gt;
                                case fromException se of
                                    Just TLS.HandshakeFailed{} -&gt; toException $ TlsException se
                                    _ -&gt;
                                        case fromException se of
                                            Just TLS.ConnectionNotEstablished -&gt; toException $ TlsException se
                                            _ -&gt; se
         in handle $ throwIO . wrapper
    }</span></span><span class="mpre">

</span><a href="#loc_63_1_63_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_19&#39;)"><span class="mpre">tlsManagerSettings</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_447_6_447_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_447_6_447_21&#39;)"><span class="hl_tyconref"><span class="mpre">ManagerSettings</span></span></a><span class="mpre">
</span><a name="loc_63_1_63_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_19&#39;)"><span class="hl_vardecl"><span class="mpre">tlsManagerSettings</span></span></a><span class="mpre"> = </span><a href="#loc_22_1_22_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_18&#39;)"><span class="hl_varref"><span class="mpre">mkManagerSettings</span></span></a><span class="mpre"> </span><a href="Data.Default.Class.html#loc_40_5_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_40_5_40_8&#39;)"><span class="hl_varref"><span class="mpre">def</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><a href="#loc_68_1_68_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_17&#39;)"><span class="mpre">getTlsConnection</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Network.Connection.Types.html#loc_65_6_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.Types.html#loc_65_6_65_17&#39;)"><span class="hl_tyconref"><span class="mpre">NC.TLSSettings</span></span></a><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">NC.SockSettings</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HostAddress</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">)
</span><a name="loc_68_1_68_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_17&#39;)"><span class="hl_fundecl"><span class="mpre">getTlsConnection</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">tls</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">sock</span></span><span class="mpre"> = do
    </span><a name="loc_69_5_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_12&#39;)"><span class="hl_vardecl"><span class="mpre">context</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Connection.html#loc_94_1_94_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.html#loc_94_1_94_22&#39;)"><span class="hl_varref"><span class="mpre">NC.initConnectionContext</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">_ha</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">host</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">port</span></span><span class="mpre"> -&gt; do
        </span><a name="loc_71_9_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_13&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Connection.html#loc_144_1_144_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.html#loc_144_1_144_10&#39;)"><span class="hl_varref"><span class="mpre">NC.connectTo</span></span></a><span class="mpre"> </span><a href="#loc_69_5_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_12&#39;)"><span class="hl_varref"><span class="mpre">context</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Network/HTTP/Client/TLS.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 38, srcSpanEndLine = 76, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Network/HTTP/Client/TLS.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 13, srcSpanEndLine = 72, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Netw"><span class="mpre">NC.ConnectionParams
            { NC.connectionHostname = host
            , NC.connectionPort = fromIntegral port
            , NC.connectionUseSecure = tls
            , NC.connectionUseSocks = sock
            }</span></span><span class="mpre">
        </span><a href="#loc_107_1_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_18&#39;)"><span class="hl_varref"><span class="mpre">convertConnection</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_13&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">

</span><a href="#loc_83_1_83_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_22&#39;)"><span class="mpre">getTlsProxyConnection</span></a><span class="mpre">
    :: </span><a href="Network.Connection.Types.html#loc_65_6_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.Types.html#loc_65_6_65_17&#39;)"><span class="hl_tyconref"><span class="mpre">NC.TLSSettings</span></span></a><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">NC.SockSettings</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; (</span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HostAddress</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">)
</span><a name="loc_83_1_83_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_22&#39;)"><span class="hl_fundecl"><span class="mpre">getTlsProxyConnection</span></span></a><span class="mpre"> </span><a name="loc_83_23_83_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_23_83_26&#39;)"><span class="hl_vardecl"><span class="mpre">tls</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">sock</span></span><span class="mpre"> = do
    </span><a name="loc_84_5_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_12&#39;)"><span class="hl_vardecl"><span class="mpre">context</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Connection.html#loc_94_1_94_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.html#loc_94_1_94_22&#39;)"><span class="hl_varref"><span class="mpre">NC.initConnectionContext</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_85_15_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_15_85_22&#39;)"><span class="hl_vardecl"><span class="mpre">connstr</span></span></a><span class="mpre"> </span><a name="loc_85_23_85_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_23_85_32&#39;)"><span class="hl_vardecl"><span class="mpre">checkConn</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">serverName</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_ha</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">host</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">port</span></span><span class="mpre"> -&gt; do
        </span><span class="hl_comment"><span class="mpre">--error $ show (connstr, host, port)</span></span><span class="mpre">
        </span><a name="loc_87_9_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_13&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Connection.html#loc_144_1_144_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.html#loc_144_1_144_10&#39;)"><span class="hl_varref"><span class="mpre">NC.connectTo</span></span></a><span class="mpre"> </span><a href="#loc_84_5_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_12&#39;)"><span class="hl_varref"><span class="mpre">context</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Network/HTTP/Client/TLS.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 38, srcSpanEndLine = 95, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Network/HTTP/Client/TLS.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 13, srcSpanEndLine = 88, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-tls-0.2.2/Netw"><span class="mpre">NC.ConnectionParams
            { NC.connectionHostname = serverName
            , NC.connectionPort = fromIntegral port
            , NC.connectionUseSecure = Nothing
            , NC.connectionUseSocks =
                case sock of
                    Just _ -&gt; error &quot;Cannot use SOCKS and TLS proxying together&quot;
                    Nothing -&gt; Just $ NC.OtherProxy host $ fromIntegral port
            }</span></span><span class="mpre">

        </span><a href="Network.Connection.html#loc_176_1_176_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.html#loc_176_1_176_14&#39;)"><span class="hl_varref"><span class="mpre">NC.connectionPut</span></span></a><span class="mpre"> </span><a href="#loc_87_9_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_13&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre"> </span><a href="#loc_85_15_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_15_85_22&#39;)"><span class="hl_varref"><span class="mpre">connstr</span></span></a><span class="mpre">
        </span><a name="loc_98_9_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_107_1_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_18&#39;)"><span class="hl_varref"><span class="mpre">convertConnection</span></span></a><span class="mpre"> </span><a href="#loc_87_9_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_13&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">

        </span><a href="#loc_85_23_85_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_23_85_32&#39;)"><span class="hl_varref"><span class="mpre">checkConn</span></span></a><span class="mpre"> </span><a href="#loc_98_9_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_14&#39;)"><span class="hl_varref"><span class="mpre">conn&#39;</span></span></a><span class="mpre">

        </span><a href="Network.Connection.html#loc_297_1_297_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.html#loc_297_1_297_20&#39;)"><span class="hl_varref"><span class="mpre">NC.connectionSetSecure</span></span></a><span class="mpre"> </span><a href="#loc_84_5_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_12&#39;)"><span class="hl_varref"><span class="mpre">context</span></span></a><span class="mpre"> </span><a href="#loc_87_9_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_13&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre"> </span><a href="#loc_83_23_83_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_23_83_26&#39;)"><span class="hl_varref"><span class="mpre">tls</span></span></a><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_98_9_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_14&#39;)"><span class="hl_varref"><span class="mpre">conn&#39;</span></span></a><span class="mpre">

</span><a href="#loc_107_1_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_18&#39;)"><span class="mpre">convertConnection</span></a><span class="mpre"> :: </span><a href="Network.Connection.Types.html#loc_84_6_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.Types.html#loc_84_6_84_16&#39;)"><span class="hl_tyconref"><span class="mpre">NC.Connection</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">
</span><a name="loc_107_1_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_18&#39;)"><span class="hl_fundecl"><span class="mpre">convertConnection</span></span></a><span class="mpre"> </span><a name="loc_107_19_107_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_23&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Connection.html#loc_85_1_85_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_85_1_85_15&#39;)"><span class="hl_varref"><span class="mpre">makeConnection</span></span></a><span class="mpre">
    (</span><a href="Network.Connection.html#loc_196_1_196_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.html#loc_196_1_196_19&#39;)"><span class="hl_varref"><span class="mpre">NC.connectionGetChunk</span></span></a><span class="mpre"> </span><a href="#loc_107_19_107_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_23&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">)
    (</span><a href="Network.Connection.html#loc_176_1_176_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.html#loc_176_1_176_14&#39;)"><span class="hl_varref"><span class="mpre">NC.connectionPut</span></span></a><span class="mpre"> </span><a href="#loc_107_19_107_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_23&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">)
    </span><span class="hl_comment"><span class="mpre">-- Closing an SSL connection gracefully involves writing/reading</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- on the socket.  But when this is called the socket might be</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- already closed, and we get a @ResourceVanished@.</span></span><span class="mpre">
    (</span><a href="Network.Connection.html#loc_281_1_281_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Connection.html#loc_281_1_281_16&#39;)"><span class="hl_varref"><span class="mpre">NC.connectionClose</span></span></a><span class="mpre"> </span><a href="#loc_107_19_107_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_23&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre"> </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="hl_infix"><span class="mpre">`Control.Exception.catch`</span></span></a><span class="mpre"> \(_ :: </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)
</span></div></body></html>