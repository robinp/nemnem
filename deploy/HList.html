<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

module HList (tests) where

</span><span class="hl_comment"><span class="mpre">{-

This module illustrates heterogeneously typed lists.

-}</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 8, srcSpanEndLine = 11, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">

import Data.Typeable


</span><span class="hl_comment"><span class="mpre">-- Heterogeneously typed lists</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 1, srcSpanEndLine = 17, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 1, srcSpanEndLine = 17, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 12, src"><span class="mpre">type HList = [DontKnow]</span></span><span class="mpre">

data </span><span class="hl_tycondecl"><span class="mpre">DontKnow</span></span><span class="mpre"> = forall a. Typeable a =&gt; </span><a name="loc_19_41_19_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_41_19_49&#39;)"><span class="hl_condecl"><span class="mpre">DontKnow</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> 

</span><span class="hl_comment"><span class="mpre">-- The empty list</span></span><span class="mpre">
</span><a href="#loc_23_1_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_10&#39;)"><span class="mpre">initHList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HList</span></span><span class="mpre">
</span><a name="loc_23_1_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_10&#39;)"><span class="hl_vardecl"><span class="mpre">initHList</span></span></a><span class="mpre"> = []

</span><span class="hl_comment"><span class="mpre">-- Add an entry</span></span><span class="mpre">
</span><a href="#loc_27_1_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_9&#39;)"><span class="mpre">addHList</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 13, srcSpanEndLine = 26, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 24, srcSpanEndLine = 26, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanSt"><span class="mpre">Typeable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">HList</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">HList</span></span><span class="mpre">
</span><a name="loc_27_1_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_9&#39;)"><span class="hl_fundecl"><span class="mpre">addHList</span></span></a><span class="mpre"> </span><a name="loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_27_12_27_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_12_27_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = (</span><a href="#loc_19_41_19_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_41_19_49&#39;)"><span class="hl_conref"><span class="mpre">DontKnow</span></span></a><span class="mpre"> </span><a href="#loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_27_12_27_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_12_27_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Test for an empty list</span></span><span class="mpre">
</span><a href="#loc_31_1_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_10&#39;)"><span class="mpre">nullHList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HList</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_31_1_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_10&#39;)"><span class="hl_vardecl"><span class="mpre">nullHList</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Retrieve head by type case</span></span><span class="mpre">
</span><a href="#loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="mpre">headHList</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 14, srcSpanEndLine = 34, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 25, srcSpanEndLine = 34, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanSt"><span class="mpre">Typeable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HList</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="hl_fundecl"><span class="mpre">headHList</span></span></a><span class="mpre"> [] = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="hl_fundecl"><span class="mpre">headHList</span></span></a><span class="mpre"> (</span><a href="#loc_19_41_19_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_41_19_49&#39;)"><span class="hl_conref"><span class="mpre">DontKnow</span></span></a><span class="mpre"> </span><a name="loc_36_21_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_21_36_22&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="Data.Typeable.html#loc_112_1_112_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.html#loc_112_1_112_5&#39;)"><span class="hl_varref"><span class="mpre">cast</span></span></a><span class="mpre"> </span><a href="#loc_36_21_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_21_36_22&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Retrieve tail by type case</span></span><span class="mpre">
</span><a href="#loc_40_1_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_10&#39;)"><span class="mpre">tailHList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HList</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">HList</span></span><span class="mpre">
</span><a name="loc_40_1_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_10&#39;)"><span class="hl_vardecl"><span class="mpre">tailHList</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Access per index; starts at 1</span></span><span class="mpre">
</span><a href="#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="mpre">nth1HList</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 14, srcSpanEndLine = 43, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 25, srcSpanEndLine = 43, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HList.hs&quot;, srcSpanSt"><span class="mpre">Typeable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">HList</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="hl_fundecl"><span class="mpre">nth1HList</span></span></a><span class="mpre"> </span><a name="loc_44_11_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_44_13_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = case (</span><a href="#loc_44_13_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!!</span></span><span class="mpre"> (</span><a href="#loc_44_11_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) of (</span><a href="#loc_19_41_19_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_41_19_49&#39;)"><span class="hl_conref"><span class="mpre">DontKnow</span></span></a><span class="mpre"> </span><a name="loc_44_48_44_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_48_44_49&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) -&gt; </span><a href="Data.Typeable.html#loc_112_1_112_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.html#loc_112_1_112_5&#39;)"><span class="hl_varref"><span class="mpre">cast</span></span></a><span class="mpre"> </span><a href="#loc_44_48_44_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_48_44_49&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- A demo list</span></span><span class="mpre">
</span><a name="loc_50_1_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_7&#39;)"><span class="hl_vardecl"><span class="mpre">mylist</span></span></a><span class="mpre"> = </span><a href="#loc_27_1_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_9&#39;)"><span class="hl_varref"><span class="mpre">addHList</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)       </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
         </span><a href="#loc_27_1_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_9&#39;)"><span class="hl_varref"><span class="mpre">addHList</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)   </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
         </span><a href="#loc_27_1_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_9&#39;)"><span class="hl_varref"><span class="mpre">addHList</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;42&quot;</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
         </span><a href="#loc_23_1_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_10&#39;)"><span class="hl_varref"><span class="mpre">initHList</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Main function for testing</span></span><span class="mpre">
</span><a name="loc_56_1_56_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = (   </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="hl_varref"><span class="mpre">nth1HList</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_50_1_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_7&#39;)"><span class="hl_varref"><span class="mpre">mylist</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)    </span><span class="hl_comment"><span class="mpre">-- shows Just 1</span></span><span class="mpre">
        , ( </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="hl_varref"><span class="mpre">nth1HList</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_50_1_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_7&#39;)"><span class="hl_varref"><span class="mpre">mylist</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)   </span><span class="hl_comment"><span class="mpre">-- shows Nothing</span></span><span class="mpre">
        , ( </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="hl_varref"><span class="mpre">nth1HList</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_50_1_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_7&#39;)"><span class="hl_varref"><span class="mpre">mylist</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)   </span><span class="hl_comment"><span class="mpre">-- shows Just True</span></span><span class="mpre">
        , ( </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="hl_varref"><span class="mpre">nth1HList</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><a href="#loc_50_1_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_7&#39;)"><span class="hl_varref"><span class="mpre">mylist</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- shows Just &quot;42&quot;</span></span><span class="mpre">
        )))) </span><span class="hl_infix"><span class="mpre">~=?</span></span><span class="mpre"> </span><a href="#loc_62_1_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_7&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

</span><a name="loc_62_1_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_7&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = (</span><span class="hl_string"><span class="mpre">&quot;Just 1&quot;</span></span><span class="mpre">,(</span><span class="hl_string"><span class="mpre">&quot;Nothing&quot;</span></span><span class="mpre">,(</span><span class="hl_string"><span class="mpre">&quot;Just True&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;Just \&quot;42\&quot;&quot;</span></span><span class="mpre">)))</span></div></body></html>