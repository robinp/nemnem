<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE FlexibleInstances #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Crypto.Cipher.DES.Primitive</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module is copy of DES module from Crypto package.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- http://hackage.haskell.org/package/Crypto</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">


module Crypto.Cipher.DES.Primitive (encrypt, decrypt, Block(..)) where

import Data.Word
import Data.Bits

newtype </span><a name="loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tycondecl"><span class="mpre">Block</span></span></a><span class="mpre"> = </span><a name="loc_19_17_19_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_17_19_22&#39;)"><span class="hl_condecl"><span class="mpre">Block</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 1, srcSpanEndLine = 21, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 1, srcSpanEndLine = 21, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/D"><span class="mpre">type Rotation = Int</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/D"><span class="mpre">type Key     = Word64</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 1, srcSpanEndLine = 24, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 1, srcSpanEndLine = 24, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/D"><span class="mpre">type Bits4  = [Bool]</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 25, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 25, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/D"><span class="mpre">type Bits6  = [Bool]</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 1, srcSpanEndLine = 26, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 1, srcSpanEndLine = 26, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/D"><span class="mpre">type Bits32 = [Bool]</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 1, srcSpanEndLine = 27, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 1, srcSpanEndLine = 27, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/D"><span class="mpre">type Bits48 = [Bool]</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 1, srcSpanEndLine = 28, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 1, srcSpanEndLine = 28, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/D"><span class="mpre">type Bits56 = [Bool]</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 1, srcSpanEndLine = 29, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 1, srcSpanEndLine = 29, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/D"><span class="mpre">type Bits64 = [Bool]</span></span><span class="mpre">

</span><a href="#loc_32_1_32_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_7&#39;)"><span class="mpre">desXor</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">]
</span><a name="loc_32_1_32_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_7&#39;)"><span class="hl_fundecl"><span class="mpre">desXor</span></span></a><span class="mpre"> </span><a name="loc_32_8_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_8_32_9&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_32_10_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_10_32_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> (\</span><a name="loc_32_24_32_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_24_32_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_32_26_32_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_26_32_27&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_32_24_32_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_24_32_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_32_26_32_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_26_32_27&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><a href="#loc_32_24_32_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_24_32_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_32_26_32_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_26_32_27&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)) </span><a href="#loc_32_8_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_8_32_9&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_32_10_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_10_32_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><a href="#loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="mpre">desRotate</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">]
</span><a name="loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="hl_fundecl"><span class="mpre">desRotate</span></span></a><span class="mpre"> </span><a name="loc_35_11_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_11_35_15&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="mpre"> </span><a name="loc_35_16_35_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_19&#39;)"><span class="hl_vardecl"><span class="mpre">rot</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><a href="#loc_36_9_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_13&#39;)"><span class="hl_varref"><span class="mpre">rot&#39;</span></span></a><span class="mpre"> </span><a href="#loc_35_11_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_11_35_15&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_36_9_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_13&#39;)"><span class="hl_varref"><span class="mpre">rot&#39;</span></span></a><span class="mpre"> </span><a href="#loc_35_11_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_11_35_15&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre">
  where </span><a name="loc_36_9_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_13&#39;)"><span class="hl_vardecl"><span class="mpre">rot&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_35_16_35_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_19&#39;)"><span class="hl_varref"><span class="mpre">rot</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_35_11_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_11_35_15&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre">

</span><a href="#loc_39_1_39_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_7&#39;)"><span class="mpre">bitify</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits64</span></span><span class="mpre">
</span><a name="loc_39_1_39_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_7&#39;)"><span class="hl_fundecl"><span class="mpre">bitify</span></span></a><span class="mpre"> </span><a name="loc_39_8_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_8_39_9&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_39_18_39_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_19&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_39_8_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_8_39_9&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">shiftL</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_39_18_39_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="warning" data-warning="ExpEnumFromThenTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 48, srcSpanEndLine = 39, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Primitive.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 48, srcSpanEndLine = 39, srcSpanEndColumn = 49},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto"><span class="mpre">[63,62..0]</span></span><span class="mpre">

</span><a href="#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_9&#39;)"><span class="mpre">unbitify</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
</span><a name="loc_42_1_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_9&#39;)"><span class="hl_fundecl"><span class="mpre">unbitify</span></span></a><span class="mpre"> </span><a name="loc_42_10_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_10_42_12&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> (\</span><a name="loc_42_23_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_23_42_24&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_42_25_42_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_25_42_26&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; if </span><a href="#loc_42_25_42_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_25_42_26&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">shiftL</span></span><span class="mpre"> </span><a href="#loc_42_23_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_23_42_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">shiftL</span></span><span class="mpre"> </span><a href="#loc_42_23_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_23_42_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_42_10_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_10_42_12&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_45_1_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_20&#39;)"><span class="mpre">initial_permutation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits64</span></span><span class="mpre">
</span><a name="loc_45_1_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_20&#39;)"><span class="hl_fundecl"><span class="mpre">initial_permutation</span></span></a><span class="mpre"> </span><a name="loc_45_21_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_21_45_23&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">(!!)</span></span><span class="mpre"> </span><a href="#loc_45_21_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_21_45_23&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">) </span><a href="#loc_46_8_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_8_46_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_46_8_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_8_46_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">57</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">49</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">41</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">33</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">25</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">17</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">51</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">43</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">35</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">27</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">61</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">53</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">45</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">37</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">29</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">21</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">63</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">55</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">39</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">58</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">50</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">42</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">34</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">26</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">52</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">44</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">36</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">62</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">54</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">46</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">38</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">22</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">]

</span><a href="#loc_52_1_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_19&#39;)"><span class="mpre">key_transformation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits56</span></span><span class="mpre">
</span><a name="loc_52_1_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_19&#39;)"><span class="hl_fundecl"><span class="mpre">key_transformation</span></span></a><span class="mpre"> </span><a name="loc_52_20_52_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_20_52_22&#39;)"><span class="hl_vardecl"><span class="mpre">kb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">(!!)</span></span><span class="mpre"> </span><a href="#loc_52_20_52_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_20_52_22&#39;)"><span class="hl_varref"><span class="mpre">kb</span></span></a><span class="mpre">) </span><a href="#loc_53_8_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_8_53_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_53_8_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_8_53_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">57</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">49</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">41</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">33</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">25</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">17</span></span><span class="mpre">,
             </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">58</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">50</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">42</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">34</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">26</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">51</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">43</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">35</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">62</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">54</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">46</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">38</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">22</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">61</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">53</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">45</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">37</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">29</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">21</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">52</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">44</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">36</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">27</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">]

</span><a href="#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_8&#39;)"><span class="mpre">des_enc</span></a><span class="mpre"> :: </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Key</span></span><span class="mpre"> -&gt; </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">
</span><a name="loc_59_1_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_8&#39;)"><span class="hl_vardecl"><span class="mpre">des_enc</span></span></a><span class="mpre"> = </span><a href="#loc_65_1_65_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_7&#39;)"><span class="hl_varref"><span class="mpre">do_des</span></span></a><span class="mpre"> [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">17</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">21</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">25</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">27</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">]

</span><a href="#loc_62_1_62_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_8&#39;)"><span class="mpre">des_dec</span></a><span class="mpre"> :: </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Key</span></span><span class="mpre"> -&gt; </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">
</span><a name="loc_62_1_62_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_8&#39;)"><span class="hl_vardecl"><span class="mpre">des_dec</span></span></a><span class="mpre"> = </span><a href="#loc_65_1_65_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_7&#39;)"><span class="hl_varref"><span class="mpre">do_des</span></span></a><span class="mpre"> [</span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">27</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">25</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">21</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">17</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">]

</span><a href="#loc_65_1_65_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_7&#39;)"><span class="mpre">do_des</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Rotation</span></span><span class="mpre">] -&gt; </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Key</span></span><span class="mpre"> -&gt; </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">
</span><a name="loc_65_1_65_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_7&#39;)"><span class="hl_fundecl"><span class="mpre">do_des</span></span></a><span class="mpre"> </span><a name="loc_65_8_65_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_8_65_12&#39;)"><span class="hl_vardecl"><span class="mpre">rots</span></span></a><span class="mpre"> (</span><a href="#loc_19_17_19_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_17_19_22&#39;)"><span class="hl_conref"><span class="mpre">Block</span></span></a><span class="mpre"> </span><a name="loc_65_20_65_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_20_65_21&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) </span><a name="loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_19_17_19_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_17_19_22&#39;)"><span class="hl_conref"><span class="mpre">Block</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_70_1_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_9&#39;)"><span class="hl_varref"><span class="mpre">des_work</span></span></a><span class="mpre"> </span><a href="#loc_65_8_65_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_8_65_12&#39;)"><span class="hl_varref"><span class="mpre">rots</span></span></a><span class="mpre"> (</span><a href="#loc_189_1_189_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_9&#39;)"><span class="hl_varref"><span class="mpre">takeDrop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><a href="#loc_67_8_67_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_8_67_10&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">) </span><a href="#loc_66_8_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_8_66_10&#39;)"><span class="hl_varref"><span class="mpre">kb</span></span></a><span class="mpre">
 where </span><a name="loc_66_8_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_8_66_10&#39;)"><span class="hl_vardecl"><span class="mpre">kb</span></span></a><span class="mpre"> = </span><a href="#loc_52_1_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_19&#39;)"><span class="hl_varref"><span class="mpre">key_transformation</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_39_1_39_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_7&#39;)"><span class="hl_varref"><span class="mpre">bitify</span></span></a><span class="mpre"> </span><a href="#loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
       </span><a name="loc_67_8_67_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_8_67_10&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> = </span><a href="#loc_45_1_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_20&#39;)"><span class="hl_varref"><span class="mpre">initial_permutation</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_39_1_39_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_7&#39;)"><span class="hl_varref"><span class="mpre">bitify</span></span></a><span class="mpre"> </span><a href="#loc_65_20_65_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_20_65_21&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><a href="#loc_70_1_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_9&#39;)"><span class="mpre">des_work</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Rotation</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyconref"><span class="mpre">Bits32</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bits32</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits56</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
</span><a name="loc_70_1_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_9&#39;)"><span class="hl_fundecl"><span class="mpre">des_work</span></span></a><span class="mpre"> [] (</span><a name="loc_70_14_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_14_70_16&#39;)"><span class="hl_vardecl"><span class="mpre">ml</span></span></a><span class="mpre">, </span><a name="loc_70_18_70_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_20&#39;)"><span class="hl_vardecl"><span class="mpre">mr</span></span></a><span class="mpre">) _ = </span><a href="#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">unbitify</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_182_1_182_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_11&#39;)"><span class="hl_varref"><span class="mpre">final_perm</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_70_18_70_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_20&#39;)"><span class="hl_varref"><span class="mpre">mr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_70_14_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_14_70_16&#39;)"><span class="hl_varref"><span class="mpre">ml</span></span></a><span class="mpre">)
</span><a href="#loc_70_1_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_9&#39;)"><span class="hl_fundecl"><span class="mpre">des_work</span></span></a><span class="mpre"> (</span><a name="loc_71_11_71_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_11_71_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_71_13_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_15&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) </span><a name="loc_71_17_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_17_71_19&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> </span><a name="loc_71_20_71_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_20_71_22&#39;)"><span class="hl_vardecl"><span class="mpre">kb</span></span></a><span class="mpre"> = </span><a href="#loc_70_1_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_9&#39;)"><span class="hl_varref"><span class="mpre">des_work</span></span></a><span class="mpre"> </span><a href="#loc_71_13_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_15&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre"> </span><a href="#loc_72_8_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_8_72_11&#39;)"><span class="hl_varref"><span class="mpre">mb&#39;</span></span></a><span class="mpre"> </span><a href="#loc_71_20_71_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_20_71_22&#39;)"><span class="hl_varref"><span class="mpre">kb</span></span></a><span class="mpre">
 where </span><a name="loc_72_8_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_8_72_11&#39;)"><span class="hl_vardecl"><span class="mpre">mb&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="hl_varref"><span class="mpre">do_round</span></span></a><span class="mpre"> </span><a href="#loc_71_11_71_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_11_71_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_71_17_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_17_71_19&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> </span><a href="#loc_71_20_71_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_20_71_22&#39;)"><span class="hl_varref"><span class="mpre">kb</span></span></a><span class="mpre">

</span><a href="#loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="mpre">do_round</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Rotation</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Bits32</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bits32</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits56</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Bits32</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bits32</span></span><span class="mpre">)
</span><a name="loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="hl_fundecl"><span class="mpre">do_round</span></span></a><span class="mpre"> </span><a name="loc_75_10_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_11&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> (</span><a name="loc_75_13_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_15&#39;)"><span class="hl_vardecl"><span class="mpre">ml</span></span></a><span class="mpre">, </span><a name="loc_75_17_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_19&#39;)"><span class="hl_vardecl"><span class="mpre">mr</span></span></a><span class="mpre">) </span><a name="loc_75_21_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_23&#39;)"><span class="hl_vardecl"><span class="mpre">kb</span></span></a><span class="mpre"> = (</span><a href="#loc_75_17_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_19&#39;)"><span class="hl_varref"><span class="mpre">mr</span></span></a><span class="mpre">, </span><a href="#loc_87_8_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_8_87_10&#39;)"><span class="hl_varref"><span class="mpre">m&#39;</span></span></a><span class="mpre">)
 where </span><a name="loc_76_8_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_8_76_11&#39;)"><span class="hl_vardecl"><span class="mpre">kb&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="hl_varref"><span class="mpre">get_key</span></span></a><span class="mpre"> </span><a href="#loc_75_21_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_23&#39;)"><span class="hl_varref"><span class="mpre">kb</span></span></a><span class="mpre"> </span><a href="#loc_75_10_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_11&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
       </span><a name="loc_77_8_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_8_77_15&#39;)"><span class="hl_vardecl"><span class="mpre">comp_kb</span></span></a><span class="mpre"> = </span><a href="#loc_95_1_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_24&#39;)"><span class="hl_varref"><span class="mpre">compression_permutation</span></span></a><span class="mpre"> </span><a href="#loc_76_8_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_8_76_11&#39;)"><span class="hl_varref"><span class="mpre">kb&#39;</span></span></a><span class="mpre">
       </span><a name="loc_78_8_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_15&#39;)"><span class="hl_vardecl"><span class="mpre">expa_mr</span></span></a><span class="mpre"> = </span><a href="#loc_102_1_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_22&#39;)"><span class="hl_varref"><span class="mpre">expansion_permutation</span></span></a><span class="mpre"> </span><a href="#loc_75_17_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_19&#39;)"><span class="hl_varref"><span class="mpre">mr</span></span></a><span class="mpre">
       </span><a name="loc_79_8_79_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_11&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = </span><a href="#loc_77_8_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_8_77_15&#39;)"><span class="hl_varref"><span class="mpre">comp_kb</span></span></a><span class="mpre"> </span><a href="#loc_32_1_32_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_7&#39;)"><span class="hl_infix"><span class="mpre">`desXor`</span></span></a><span class="mpre"> </span><a href="#loc_78_8_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_15&#39;)"><span class="hl_varref"><span class="mpre">expa_mr</span></span></a><span class="mpre">
       </span><a name="loc_80_8_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_8_80_12&#39;)"><span class="hl_vardecl"><span class="mpre">res&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iterate</span></span><span class="mpre"> (</span><a href="#loc_81_8_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_8_81_13&#39;)"><span class="hl_varref"><span class="mpre">trans</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) ([], </span><a href="#loc_79_8_79_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_11&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">)
       </span><a name="loc_81_8_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_8_81_13&#39;)"><span class="hl_fundecl"><span class="mpre">trans</span></span></a><span class="mpre"> </span><a name="loc_81_14_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (_, </span><a name="loc_81_20_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_20_81_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_81_14_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_81_20_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_20_81_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><a href="#loc_81_14_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_81_20_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_20_81_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
       </span><a name="loc_82_8_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_8_82_13&#39;)"><span class="hl_vardecl"><span class="mpre">res_s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> (\</span><a name="loc_82_35_82_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_35_82_36&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_82_38_82_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_38_82_39&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,_) -&gt; </span><a href="#loc_82_35_82_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_35_82_36&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_82_38_82_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_38_82_39&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) [</span><a href="#loc_121_1_121_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_8&#39;)"><span class="hl_varref"><span class="mpre">s_box_1</span></span></a><span class="mpre">, </span><a href="#loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="hl_varref"><span class="mpre">s_box_2</span></span></a><span class="mpre">,
                                                   </span><a href="#loc_135_1_135_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_8&#39;)"><span class="hl_varref"><span class="mpre">s_box_3</span></span></a><span class="mpre">, </span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_varref"><span class="mpre">s_box_4</span></span></a><span class="mpre">,
                                                   </span><a href="#loc_149_1_149_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_8&#39;)"><span class="hl_varref"><span class="mpre">s_box_5</span></span></a><span class="mpre">, </span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_varref"><span class="mpre">s_box_6</span></span></a><span class="mpre">,
                                                   </span><a href="#loc_163_1_163_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_8&#39;)"><span class="hl_varref"><span class="mpre">s_box_7</span></span></a><span class="mpre">, </span><a href="#loc_170_1_170_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_8&#39;)"><span class="hl_varref"><span class="mpre">s_box_8</span></span></a><span class="mpre">] </span><a href="#loc_80_8_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_8_80_12&#39;)"><span class="hl_varref"><span class="mpre">res&#39;</span></span></a><span class="mpre">
       </span><a name="loc_86_8_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_8_86_13&#39;)"><span class="hl_vardecl"><span class="mpre">res_p</span></span></a><span class="mpre"> = </span><a href="#loc_177_1_177_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_6&#39;)"><span class="hl_varref"><span class="mpre">p_box</span></span></a><span class="mpre"> </span><a href="#loc_82_8_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_8_82_13&#39;)"><span class="hl_varref"><span class="mpre">res_s</span></span></a><span class="mpre">
       </span><a name="loc_87_8_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_8_87_10&#39;)"><span class="hl_vardecl"><span class="mpre">m&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_86_8_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_8_86_13&#39;)"><span class="hl_varref"><span class="mpre">res_p</span></span></a><span class="mpre"> </span><a href="#loc_32_1_32_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_7&#39;)"><span class="hl_infix"><span class="mpre">`desXor`</span></span></a><span class="mpre"> </span><a href="#loc_75_13_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_15&#39;)"><span class="hl_varref"><span class="mpre">ml</span></span></a><span class="mpre">

</span><a href="#loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="mpre">get_key</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits56</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Rotation</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits56</span></span><span class="mpre">
</span><a name="loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="hl_fundecl"><span class="mpre">get_key</span></span></a><span class="mpre"> </span><a name="loc_90_9_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_11&#39;)"><span class="hl_vardecl"><span class="mpre">kb</span></span></a><span class="mpre"> </span><a name="loc_90_12_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_92_8_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_8_92_11&#39;)"><span class="hl_varref"><span class="mpre">kb&#39;</span></span></a><span class="mpre">
 where (</span><a name="loc_91_9_91_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_9_91_11&#39;)"><span class="hl_vardecl"><span class="mpre">kl</span></span></a><span class="mpre">, </span><a name="loc_91_13_91_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_13_91_15&#39;)"><span class="hl_vardecl"><span class="mpre">kr</span></span></a><span class="mpre">) = </span><a href="#loc_189_1_189_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_9&#39;)"><span class="hl_varref"><span class="mpre">takeDrop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre"> </span><a href="#loc_90_9_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_11&#39;)"><span class="hl_varref"><span class="mpre">kb</span></span></a><span class="mpre">
       </span><a name="loc_92_8_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_8_92_11&#39;)"><span class="hl_vardecl"><span class="mpre">kb&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="hl_varref"><span class="mpre">desRotate</span></span></a><span class="mpre"> </span><a href="#loc_91_9_91_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_9_91_11&#39;)"><span class="hl_varref"><span class="mpre">kl</span></span></a><span class="mpre"> </span><a href="#loc_90_12_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="hl_varref"><span class="mpre">desRotate</span></span></a><span class="mpre"> </span><a href="#loc_91_13_91_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_13_91_15&#39;)"><span class="hl_varref"><span class="mpre">kr</span></span></a><span class="mpre"> </span><a href="#loc_90_12_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_95_1_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_24&#39;)"><span class="mpre">compression_permutation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits56</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits48</span></span><span class="mpre">
</span><a name="loc_95_1_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_24&#39;)"><span class="hl_fundecl"><span class="mpre">compression_permutation</span></span></a><span class="mpre"> </span><a name="loc_95_25_95_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_25_95_27&#39;)"><span class="hl_vardecl"><span class="mpre">kb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">(!!)</span></span><span class="mpre"> </span><a href="#loc_95_25_95_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_25_95_27&#39;)"><span class="hl_varref"><span class="mpre">kb</span></span></a><span class="mpre">) </span><a href="#loc_96_8_96_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_8_96_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_96_8_96_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_8_96_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">27</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">22</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">25</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">26</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">51</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">36</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">46</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">54</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">29</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">39</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">50</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">44</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">43</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">38</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">55</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">33</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">52</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">45</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">41</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">49</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">35</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">]

</span><a href="#loc_102_1_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_22&#39;)"><span class="mpre">expansion_permutation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits32</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits48</span></span><span class="mpre">
</span><a name="loc_102_1_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_22&#39;)"><span class="hl_fundecl"><span class="mpre">expansion_permutation</span></span></a><span class="mpre"> </span><a name="loc_102_23_102_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_23_102_25&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">(!!)</span></span><span class="mpre"> </span><a href="#loc_102_23_102_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_23_102_25&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">) </span><a href="#loc_103_8_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_8_103_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_103_8_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_8_103_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,
             </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">17</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">21</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">22</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">25</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">26</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">27</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">27</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">29</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]

</span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="mpre">s_box</span></a><span class="mpre"> :: [[</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]] -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits6</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits4</span></span><span class="mpre">
</span><a name="loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_fundecl"><span class="mpre">s_box</span></span></a><span class="mpre"> </span><a name="loc_109_7_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_7_109_8&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> [</span><a name="loc_109_10_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_109_12_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_12_109_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,</span><a name="loc_109_14_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_14_109_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_109_16_109_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_16_109_17&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">,</span><a name="loc_109_18_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_18_109_19&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">,</span><a name="loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">] = </span><a href="#loc_116_8_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_8_116_15&#39;)"><span class="hl_varref"><span class="mpre">to_bool</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_109_7_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_7_109_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!!</span></span><span class="mpre"> </span><a href="#loc_110_8_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_8_110_11&#39;)"><span class="hl_varref"><span class="mpre">row</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">!!</span></span><span class="mpre"> </span><a href="#loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_varref"><span class="mpre">col</span></span></a><span class="mpre">
 where </span><a name="loc_110_8_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_8_110_11&#39;)"><span class="hl_vardecl"><span class="mpre">row</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">sum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> </span><a href="#loc_113_8_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_8_113_18&#39;)"><span class="hl_varref"><span class="mpre">numericise</span></span></a><span class="mpre"> [</span><a href="#loc_109_10_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">]     [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
       </span><a name="loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_vardecl"><span class="mpre">col</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">sum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> </span><a href="#loc_113_8_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_8_113_18&#39;)"><span class="hl_varref"><span class="mpre">numericise</span></span></a><span class="mpre"> [</span><a href="#loc_109_12_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_12_109_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">,</span><a href="#loc_109_14_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_14_109_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">,</span><a href="#loc_109_16_109_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_16_109_17&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">,</span><a href="#loc_109_18_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_18_109_19&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">] [</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
       </span><a href="#loc_113_8_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_8_113_18&#39;)"><span class="mpre">numericise</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
       </span><a name="loc_113_8_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_8_113_18&#39;)"><span class="hl_vardecl"><span class="mpre">numericise</span></span></a><span class="mpre"> = (\</span><a name="loc_113_23_113_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_23_113_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_113_25_113_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_25_113_26&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; if </span><a href="#loc_113_23_113_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_23_113_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">^</span></span><a href="#loc_113_25_113_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_25_113_26&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

       </span><a href="#loc_116_8_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_8_116_15&#39;)"><span class="mpre">to_bool</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">]
       </span><a name="loc_116_8_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_8_116_15&#39;)"><span class="hl_fundecl"><span class="mpre">to_bool</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> _ = []
       </span><a href="#loc_116_8_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_8_116_15&#39;)"><span class="hl_fundecl"><span class="mpre">to_bool</span></span></a><span class="mpre"> </span><a name="loc_117_16_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_16_117_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_117_18_117_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_18_117_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = ((</span><a href="#loc_117_18_117_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_18_117_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_116_8_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_8_116_15&#39;)"><span class="hl_varref"><span class="mpre">to_bool</span></span></a><span class="mpre"> (</span><a href="#loc_117_16_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_16_117_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">shiftL</span></span><span class="mpre"> </span><a href="#loc_117_18_117_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_18_117_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
</span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_fundecl"><span class="mpre">s_box</span></span></a><span class="mpre"> _ _             = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;DES: internal error bits6 more than 6 elements&quot;</span></span><span class="mpre">

</span><a href="#loc_121_1_121_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_8&#39;)"><span class="mpre">s_box_1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits6</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits4</span></span><span class="mpre">
</span><a name="loc_121_1_121_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_8&#39;)"><span class="hl_vardecl"><span class="mpre">s_box_1</span></span></a><span class="mpre"> = </span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_varref"><span class="mpre">s_box</span></span></a><span class="mpre"> </span><a href="#loc_122_8_122_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_8_122_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_122_8_122_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_8_122_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [[</span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">],
            [ </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">],
            [ </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">]]

</span><a href="#loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="mpre">s_box_2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits6</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits4</span></span><span class="mpre">
</span><a name="loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="hl_vardecl"><span class="mpre">s_box_2</span></span></a><span class="mpre"> = </span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_varref"><span class="mpre">s_box</span></span></a><span class="mpre"> </span><a href="#loc_129_8_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_8_129_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_129_8_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_8_129_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [[</span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">]]

</span><a href="#loc_135_1_135_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_8&#39;)"><span class="mpre">s_box_3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits6</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits4</span></span><span class="mpre">
</span><a name="loc_135_1_135_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_8&#39;)"><span class="hl_vardecl"><span class="mpre">s_box_3</span></span></a><span class="mpre"> = </span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_varref"><span class="mpre">s_box</span></span></a><span class="mpre"> </span><a href="#loc_136_8_136_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_8_136_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_136_8_136_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_8_136_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [[</span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">]]

</span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="mpre">s_box_4</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits6</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits4</span></span><span class="mpre">
</span><a name="loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_vardecl"><span class="mpre">s_box_4</span></span></a><span class="mpre"> = </span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_varref"><span class="mpre">s_box</span></span></a><span class="mpre"> </span><a href="#loc_143_8_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_8_143_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_143_8_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_8_143_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [[</span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">]]

</span><a href="#loc_149_1_149_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_8&#39;)"><span class="mpre">s_box_5</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits6</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits4</span></span><span class="mpre">
</span><a name="loc_149_1_149_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_8&#39;)"><span class="hl_vardecl"><span class="mpre">s_box_5</span></span></a><span class="mpre"> = </span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_varref"><span class="mpre">s_box</span></span></a><span class="mpre"> </span><a href="#loc_150_8_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_150_8_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [[</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,   </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">]]

</span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="mpre">s_box_6</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits6</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits4</span></span><span class="mpre">
</span><a name="loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_vardecl"><span class="mpre">s_box_6</span></span></a><span class="mpre"> = </span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_varref"><span class="mpre">s_box</span></span></a><span class="mpre"> </span><a href="#loc_157_8_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_8_157_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_157_8_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_8_157_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [[</span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,   </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">]]

</span><a href="#loc_163_1_163_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_8&#39;)"><span class="mpre">s_box_7</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits6</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits4</span></span><span class="mpre">
</span><a name="loc_163_1_163_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_8&#39;)"><span class="hl_vardecl"><span class="mpre">s_box_7</span></span></a><span class="mpre"> = </span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_varref"><span class="mpre">s_box</span></span></a><span class="mpre"> </span><a href="#loc_164_8_164_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_8_164_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_164_8_164_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_8_164_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [[</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">]]

</span><a href="#loc_170_1_170_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_8&#39;)"><span class="mpre">s_box_8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits6</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits4</span></span><span class="mpre">
</span><a name="loc_170_1_170_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_8&#39;)"><span class="hl_vardecl"><span class="mpre">s_box_8</span></span></a><span class="mpre"> = </span><a href="#loc_109_1_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_6&#39;)"><span class="hl_varref"><span class="mpre">s_box</span></span></a><span class="mpre"> </span><a href="#loc_171_8_171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_8_171_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_171_8_171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_8_171_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [[</span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">],
            [</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,   </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">]]

</span><a href="#loc_177_1_177_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_6&#39;)"><span class="mpre">p_box</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits32</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits32</span></span><span class="mpre">
</span><a name="loc_177_1_177_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_6&#39;)"><span class="hl_fundecl"><span class="mpre">p_box</span></span></a><span class="mpre"> </span><a name="loc_177_7_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_7_177_9&#39;)"><span class="hl_vardecl"><span class="mpre">kb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">(!!)</span></span><span class="mpre"> </span><a href="#loc_177_7_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_7_177_9&#39;)"><span class="hl_varref"><span class="mpre">kb</span></span></a><span class="mpre">) </span><a href="#loc_178_8_178_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_8_178_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_178_8_178_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_8_178_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">27</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">22</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">25</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">17</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">,
             </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">26</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">29</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">21</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">]

</span><a href="#loc_182_1_182_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_11&#39;)"><span class="mpre">final_perm</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bits64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bits64</span></span><span class="mpre">
</span><a name="loc_182_1_182_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_11&#39;)"><span class="hl_fundecl"><span class="mpre">final_perm</span></span></a><span class="mpre"> </span><a name="loc_182_12_182_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_12_182_14&#39;)"><span class="hl_vardecl"><span class="mpre">kb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">(!!)</span></span><span class="mpre"> </span><a href="#loc_182_12_182_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_12_182_14&#39;)"><span class="hl_varref"><span class="mpre">kb</span></span></a><span class="mpre">) </span><a href="#loc_183_8_183_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_8_183_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
 where </span><a name="loc_183_8_183_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_8_183_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">39</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">55</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">63</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">38</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">46</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">54</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">22</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">62</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">37</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">45</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">53</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">21</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">61</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">29</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">36</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">44</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">52</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">35</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">43</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">51</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">27</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">34</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">42</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">50</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">58</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">26</span></span><span class="mpre">,
            </span><span class="hl_num"><span class="mpre">33</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">41</span></span><span class="mpre">,  </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">49</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">17</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">57</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">25</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">]

</span><a href="#loc_189_1_189_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_9&#39;)"><span class="mpre">takeDrop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">], [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">])
</span><a name="loc_189_1_189_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_9&#39;)"><span class="hl_fundecl"><span class="mpre">takeDrop</span></span></a><span class="mpre"> _ [] = ([], [])
</span><a href="#loc_189_1_189_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_9&#39;)"><span class="hl_fundecl"><span class="mpre">takeDrop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_190_12_190_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_12_190_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = ([], </span><a href="#loc_190_12_190_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_12_190_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
</span><a href="#loc_189_1_189_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_9&#39;)"><span class="hl_fundecl"><span class="mpre">takeDrop</span></span></a><span class="mpre"> </span><a name="loc_191_10_191_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_10_191_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a name="loc_191_13_191_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_13_191_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_191_15_191_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_15_191_17&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = (</span><a href="#loc_191_13_191_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_13_191_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_192_9_192_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_11&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">, </span><a href="#loc_192_13_192_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_13_192_15&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">)
 where (</span><a name="loc_192_9_192_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_11&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">, </span><a name="loc_192_13_192_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_13_192_15&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre">) = </span><a href="#loc_189_1_189_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_9&#39;)"><span class="hl_varref"><span class="mpre">takeDrop</span></span></a><span class="mpre"> (</span><a href="#loc_191_10_191_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_10_191_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_191_15_191_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_15_191_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Basic DES encryption which takes a key and a block of plaintext</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and returns the encrypted block of ciphertext according to the standard.</span></span><span class="mpre">

</span><a href="#loc_199_1_199_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_8&#39;)"><span class="mpre">encrypt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">
</span><a name="loc_199_1_199_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_8&#39;)"><span class="hl_vardecl"><span class="mpre">encrypt</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">des_enc</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Basic DES decryption which takes a key and a block of ciphertext and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returns the decrypted block of plaintext according to the standard.</span></span><span class="mpre">

</span><a href="#loc_205_1_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_8&#39;)"><span class="mpre">decrypt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">
</span><a name="loc_205_1_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_8&#39;)"><span class="hl_vardecl"><span class="mpre">decrypt</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_62_1_62_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_8&#39;)"><span class="hl_varref"><span class="mpre">des_dec</span></span></a><span class="mpre">
</span></div></body></html>