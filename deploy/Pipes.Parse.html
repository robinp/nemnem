<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">{-| Element-agnostic parsing utilities for @pipes@

    See &quot;Pipes.Parse.Tutorial&quot; for an extended tutorial
-}</span></span><span class="mpre">

{-# LANGUAGE RankNTypes #-}

module Pipes.Parse (
    </span><span class="hl_comment"><span class="mpre">-- * Parsing</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $parsing</span></span><span class="mpre">
      Parser
    , draw
    , skip
    , drawAll
    , skipAll
    , unDraw
    , peek
    , isEndOfInput
    , foldAll
    , foldAllM

    </span><span class="hl_comment"><span class="mpre">-- * Parsing Lenses</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $parsinglenses</span></span><span class="mpre">
    , span
    , splitAt
    , groupBy
    , group

    </span><span class="hl_comment"><span class="mpre">-- * Utilities</span></span><span class="mpre">
    , toParser
    , toParser_

    </span><span class="hl_comment"><span class="mpre">-- * Re-exports</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $reexports</span></span><span class="mpre">
    , module Control.Monad.Trans.Class
    , module Control.Monad.Trans.State.Strict
    , module Pipes
    ) where

import Control.Monad (</span><a href="Control.Monad.html#loc_204_1_204_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_204_1_204_5&#39;)"><span class="mpre">join</span></a><span class="mpre">)
import Control.Monad.Trans.Class (</span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="mpre">lift</span></a><span class="mpre">)
import qualified Control.Monad.Trans.State.Strict as S
import Control.Monad.Trans.State.Strict (
    </span><a href="Control.Monad.Trans.State.Strict.html#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_139_9_139_15&#39;)"><span class="mpre">StateT</span></a><span class="mpre">(StateT, </span><a href="Control.Monad.Trans.State.Strict.html#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_139_33_139_42&#39;)"><span class="mpre">runStateT</span></a><span class="mpre">), </span><a href="Control.Monad.Trans.State.Strict.html#loc_146_1_146_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_146_1_146_11&#39;)"><span class="mpre">evalStateT</span></a><span class="mpre">, </span><a href="Control.Monad.Trans.State.Strict.html#loc_155_1_155_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_155_1_155_11&#39;)"><span class="mpre">execStateT</span></a><span class="mpre"> )
import Data.Functor.Constant (</span><a href="Data.Functor.Constant.html#loc_24_9_24_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Constant.html#loc_24_9_24_17&#39;)"><span class="mpre">Constant</span></a><span class="mpre">(Constant, </span><a href="Data.Functor.Constant.html#loc_24_35_24_46" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Constant.html#loc_24_35_24_46&#39;)"><span class="mpre">getConstant</span></a><span class="mpre">))
import Pipes.Internal (</span><a href="Pipes.Internal.html#loc_128_1_128_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Internal.html#loc_128_1_128_12&#39;)"><span class="mpre">unsafeHoist</span></a><span class="mpre">, </span><a href="Pipes.Internal.html#loc_259_1_259_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Internal.html#loc_259_1_259_7&#39;)"><span class="mpre">closed</span></a><span class="mpre">)
import Pipes (Producer, </span><a href="Pipes.html#loc_132_1_132_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_132_1_132_6&#39;)"><span class="mpre">yield</span></a><span class="mpre">, </span><a href="Pipes.html#loc_454_1_454_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_454_1_454_5&#39;)"><span class="mpre">next</span></a><span class="mpre">)
import Pipes as NoReexport

import Prelude hiding (span, splitAt)

</span><span class="hl_comment"><span class="mpre">{- $parsing
    @pipes-parse@ handles end-of-input and pushback by storing a &#39;Producer&#39; in
    a &#39;StateT&#39; layer.

    Connect &#39;Parser&#39;s to &#39;Producer&#39;s using either &#39;runStateT&#39;, &#39;evalStateT&#39;, or
    &#39;execStateT&#39;:

&gt; runStateT  :: Parser a m r -&gt; Producer a m x -&gt; m (r, Producer a m x)
&gt; evalStateT :: Parser a m r -&gt; Producer a m x -&gt; m  r
&gt; execStateT :: Parser a m r -&gt; Producer a m x -&gt; m    (Producer a m x)
&gt;                                                       ^^^^^^^^^^^^^^
&gt;                                                          Leftovers
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A &#39;Parser&#39; is an action that reads from and writes to a stored &#39;Producer&#39;</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 1, srcSpanEndLine = 67, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 1, srcSpanEndLine = 67, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLin"><span class="mpre">type Parser a m r = forall x . StateT (Producer a m x) m r</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| Draw one element from the underlying &#39;Producer&#39;, returning &#39;Nothing&#39; if the
    &#39;Producer&#39; is empty
-}</span></span><span class="mpre">
</span><a href="#loc_73_1_73_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_5&#39;)"><span class="mpre">draw</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 9, srcSpanEndLine = 72, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 17, srcSpanEndLine = 72, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_73_1_73_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_5&#39;)"><span class="hl_vardecl"><span class="mpre">draw</span></span></a><span class="mpre"> = do
    </span><a name="loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.State.Strict.html#loc_209_1_209_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_209_1_209_4&#39;)"><span class="hl_varref"><span class="mpre">S.get</span></span></a><span class="mpre">
    </span><a name="loc_75_5_75_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> (</span><a href="Pipes.html#loc_454_1_454_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_454_1_454_5&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
    case </span><a href="#loc_75_5_75_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">   </span><a name="loc_77_16_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_16_77_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">      -&gt; do
            </span><a href="Control.Monad.Trans.State.Strict.html#loc_213_1_213_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_213_1_213_4&#39;)"><span class="hl_varref"><span class="mpre">S.put</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_77_16_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_16_77_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_80_16_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_80_19_80_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_21&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre">) -&gt; do
            </span><a href="Control.Monad.Trans.State.Strict.html#loc_213_1_213_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_213_1_213_4&#39;)"><span class="hl_varref"><span class="mpre">S.put</span></span></a><span class="mpre"> </span><a href="#loc_80_19_80_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_21&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_80_16_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE draw #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| Skip one element from the underlying &#39;Producer&#39;, returning &#39;True&#39; if
    successful or &#39;False&#39; if the &#39;Producer&#39; is empty

&gt; skip = fmap isJust draw
-}</span></span><span class="mpre">
</span><a href="#loc_91_1_91_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_5&#39;)"><span class="mpre">skip</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 9, srcSpanEndLine = 90, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 17, srcSpanEndLine = 90, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_91_1_91_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_5&#39;)"><span class="hl_vardecl"><span class="mpre">skip</span></span></a><span class="mpre"> = do
    </span><a name="loc_92_5_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_73_1_73_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_5&#39;)"><span class="hl_varref"><span class="mpre">draw</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><a href="#loc_92_5_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> _  -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE skip #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| Draw all elements from the underlying &#39;Producer&#39;

    Note that &#39;drawAll&#39; is not an idiomatic use of @pipes-parse@, but I provide
    it for simple testing purposes.  Idiomatic @pipes-parse@ style consumes the
    elements immediately as they are generated instead of loading all elements
    into memory.  For example, you can use &#39;foldAll&#39; or &#39;foldAllM&#39; for this
    purpose.
-}</span></span><span class="mpre">
</span><a href="#loc_107_1_107_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_8&#39;)"><span class="mpre">drawAll</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 12, srcSpanEndLine = 106, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 20, srcSpanEndLine = 106, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-pa"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_107_1_107_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_8&#39;)"><span class="hl_vardecl"><span class="mpre">drawAll</span></span></a><span class="mpre"> = </span><a href="#loc_109_5_109_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_5_109_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
  where
    </span><a name="loc_109_5_109_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_5_109_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_109_8_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_8_109_14&#39;)"><span class="hl_vardecl"><span class="mpre">diffAs</span></span></a><span class="mpre"> = do
        </span><a name="loc_110_9_110_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_73_1_73_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_5&#39;)"><span class="hl_varref"><span class="mpre">draw</span></span></a><span class="mpre">
        case </span><a href="#loc_110_9_110_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_109_8_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_8_109_14&#39;)"><span class="hl_varref"><span class="mpre">diffAs</span></span></a><span class="mpre"> [])
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_113_18_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_18_113_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_109_5_109_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_5_109_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_109_8_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_8_109_14&#39;)"><span class="hl_varref"><span class="mpre">diffAs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_113_18_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_18_113_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">))
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE drawAll #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Drain all elements from the underlying &#39;Producer&#39;</span></span><span class="mpre">
</span><a href="#loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="mpre">skipAll</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 117, srcSpanStartColumn = 12, srcSpanEndLine = 117, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 117, srcSpanStartColumn = 20, srcSpanEndLine = 117, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-pa"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="hl_vardecl"><span class="mpre">skipAll</span></span></a><span class="mpre"> = </span><a href="#loc_120_5_120_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_120_5_120_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_7&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = do
        </span><a name="loc_121_9_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_73_1_73_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_5&#39;)"><span class="hl_varref"><span class="mpre">draw</span></span></a><span class="mpre">
        case </span><a href="#loc_121_9_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">  of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> _  -&gt; </span><a href="#loc_120_5_120_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE skipAll #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Push back an element onto the underlying &#39;Producer&#39;</span></span><span class="mpre">
</span><a href="#loc_129_1_129_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_7&#39;)"><span class="mpre">unDraw</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 128, srcSpanStartColumn = 11, srcSpanEndLine = 128, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 128, srcSpanStartColumn = 19, srcSpanEndLine = 128, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-pa"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_129_1_129_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_7&#39;)"><span class="hl_fundecl"><span class="mpre">unDraw</span></span></a><span class="mpre"> </span><a name="loc_129_8_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_8_129_9&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="Control.Monad.Trans.State.Strict.html#loc_220_1_220_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Strict.html#loc_220_1_220_7&#39;)"><span class="hl_varref"><span class="mpre">S.modify</span></span></a><span class="mpre"> (</span><a href="Pipes.html#loc_132_1_132_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_132_1_132_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_129_8_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_8_129_9&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE unDraw #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| &#39;peek&#39; checks the first element of the stream, but uses &#39;unDraw&#39; to push the
    element back so that it is available for the next &#39;draw&#39; command.

&gt; peek = do
&gt;     x &lt;- draw
&gt;     case x of
&gt;         Nothing -&gt; return ()
&gt;         Just a  -&gt; unDraw a
&gt;     return x
-}</span></span><span class="mpre">
</span><a href="#loc_143_1_143_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_5&#39;)"><span class="mpre">peek</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 142, srcSpanStartColumn = 9, srcSpanEndLine = 142, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 142, srcSpanStartColumn = 17, srcSpanEndLine = 142, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-par"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_143_1_143_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_5&#39;)"><span class="hl_vardecl"><span class="mpre">peek</span></span></a><span class="mpre"> = do
    </span><a name="loc_144_5_144_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_5_144_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_73_1_73_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_5&#39;)"><span class="hl_varref"><span class="mpre">draw</span></span></a><span class="mpre">
    case </span><a href="#loc_144_5_144_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_5_144_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_147_14_147_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_14_147_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_129_1_129_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_7&#39;)"><span class="hl_varref"><span class="mpre">unDraw</span></span></a><span class="mpre"> </span><a href="#loc_147_14_147_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_14_147_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_144_5_144_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_5_144_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE peek #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| Check if the underlying &#39;Producer&#39; is empty

&gt; isEndOfInput = fmap isNothing peek
-}</span></span><span class="mpre">
</span><a href="#loc_156_1_156_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_13&#39;)"><span class="mpre">isEndOfInput</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 17, srcSpanEndLine = 155, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 25, srcSpanEndLine = 155, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-pa"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_156_1_156_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_13&#39;)"><span class="hl_vardecl"><span class="mpre">isEndOfInput</span></span></a><span class="mpre"> = do
    </span><a name="loc_157_5_157_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_5_157_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_143_1_143_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_5&#39;)"><span class="hl_varref"><span class="mpre">peek</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (case </span><a href="#loc_157_5_157_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_5_157_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> _  -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> )
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE isEndOfInput #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| Fold all input values

&gt; Control.Foldl.purely foldAll :: Monad m =&gt; Fold a b -&gt; Parser a m b
-}</span></span><span class="mpre">
</span><a href="#loc_176_1_176_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_8&#39;)"><span class="mpre">foldAll</span></a><span class="mpre"> 
    :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 168, srcSpanStartColumn = 8, srcSpanEndLine = 169, srcSpanEndColumn = 7}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 5, srcSpanEndLine = 169, srcSpanEndColumn = 7}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-"><span class="mpre">Monad m
    =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">)
    </span><span class="hl_comment"><span class="mpre">-- ^ Step function</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ^ Initial accumulator</span></span><span class="mpre">
    -&gt; (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
    </span><span class="hl_comment"><span class="mpre">-- ^ Extraction function</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_176_1_176_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_8&#39;)"><span class="hl_fundecl"><span class="mpre">foldAll</span></span></a><span class="mpre"> </span><a name="loc_176_9_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_9_176_13&#39;)"><span class="hl_vardecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_176_14_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_14_176_19&#39;)"><span class="hl_vardecl"><span class="mpre">begin</span></span></a><span class="mpre"> </span><a name="loc_176_20_176_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_20_176_24&#39;)"><span class="hl_vardecl"><span class="mpre">done</span></span></a><span class="mpre"> = </span><a href="#loc_178_5_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_176_14_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_14_176_19&#39;)"><span class="hl_varref"><span class="mpre">begin</span></span></a><span class="mpre">
  where
    </span><a name="loc_178_5_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_178_8_178_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_8_178_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do
        </span><a name="loc_179_9_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_9_179_11&#39;)"><span class="hl_vardecl"><span class="mpre">ea</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_73_1_73_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_5&#39;)"><span class="hl_varref"><span class="mpre">draw</span></span></a><span class="mpre">
        case </span><a href="#loc_179_9_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_9_179_11&#39;)"><span class="hl_varref"><span class="mpre">ea</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_176_20_176_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_20_176_24&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="#loc_178_8_178_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_8_178_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_182_18_182_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_178_5_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_176_9_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_9_176_13&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_178_8_178_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_8_178_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_182_18_182_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE foldAll #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| Fold all input values monadically

&gt; Control.Foldl.impurely foldAllM :: Monad m =&gt; FoldM a m b -&gt; Parser a m b
-}</span></span><span class="mpre">
</span><a href="#loc_198_1_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_9&#39;)"><span class="mpre">foldAllM</span></a><span class="mpre">
    :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 8, srcSpanEndLine = 191, srcSpanEndColumn = 7}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 191, srcSpanStartColumn = 5, srcSpanEndLine = 191, srcSpanEndColumn = 7}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-"><span class="mpre">Monad m
    =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">)
    </span><span class="hl_comment"><span class="mpre">-- ^ Step function</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ^ Initial accumulator</span></span><span class="mpre">
    -&gt; (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
    </span><span class="hl_comment"><span class="mpre">-- ^ Extraction function</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_198_1_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_9&#39;)"><span class="hl_fundecl"><span class="mpre">foldAllM</span></span></a><span class="mpre"> </span><a name="loc_198_10_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_10_198_14&#39;)"><span class="hl_vardecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_198_15_198_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_20&#39;)"><span class="hl_vardecl"><span class="mpre">begin</span></span></a><span class="mpre"> </span><a name="loc_198_21_198_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_25&#39;)"><span class="hl_vardecl"><span class="mpre">done</span></span></a><span class="mpre"> = do
    </span><a name="loc_199_5_199_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_5_199_7&#39;)"><span class="hl_vardecl"><span class="mpre">x0</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><a href="#loc_198_15_198_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_20&#39;)"><span class="hl_varref"><span class="mpre">begin</span></span></a><span class="mpre">
    </span><a href="#loc_202_5_202_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_199_5_199_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_5_199_7&#39;)"><span class="hl_varref"><span class="mpre">x0</span></span></a><span class="mpre">
  where
    </span><a name="loc_202_5_202_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_202_8_202_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_8_202_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do
        </span><a name="loc_203_9_203_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_11&#39;)"><span class="hl_vardecl"><span class="mpre">ea</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_73_1_73_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_5&#39;)"><span class="hl_varref"><span class="mpre">draw</span></span></a><span class="mpre">
        case </span><a href="#loc_203_9_203_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_11&#39;)"><span class="hl_varref"><span class="mpre">ea</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> (</span><a href="#loc_198_21_198_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_25&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="#loc_202_8_202_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_8_202_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_206_18_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  -&gt; do
                </span><a name="loc_207_17_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_17_207_19&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> (</span><a href="#loc_198_10_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_10_198_14&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_202_8_202_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_8_202_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_206_18_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
                </span><a href="#loc_202_5_202_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_207_17_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_17_207_19&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE foldAllM #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- $parsinglenses
    Connect lenses to &#39;Producer&#39;s using (&#39;Lens.Family.^.&#39;) or
    &#39;Lens.Family.view&#39;:

&gt; (^.) :: Producer a m x
&gt;      -&gt; Lens&#39; (Producer a m x) (Producer b m y)
&gt;      -&gt; Producer b m y

    Connect lenses to &#39;Parser&#39;s using &#39;Lens.Family.State.Strict.zoom&#39;:

&gt; zoom :: Lens&#39; (Producer a m x) (Producer b m y)
&gt;      -&gt; Parser b m r
&gt;      -&gt; Parser a m r

    Connect lenses to each other using (&#39;.&#39;) (i.e. function composition):

&gt; (.) :: Lens&#39; (Producer a m x) (Producer b m y)
&gt;     -&gt; Lens&#39; (Producer b m y) (Producer c m z)
&gt;     -&gt; Lens&#39; (Producer a m y) (Producer c m z)
-}</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 232, srcSpanStartColumn = 1, srcSpanEndLine = 232, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 232, srcSpanStartColumn = 1, srcSpanEndLine = 232, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStar"><span class="mpre">type Lens&#39; a b = forall f . (Functor f) =&gt; (b -&gt; f b) -&gt; (a -&gt; f a)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| &#39;span&#39; is an improper lens that splits the &#39;Producer&#39; into two &#39;Producer&#39;s,
    where the outer &#39;Producer&#39; is the longest consecutive group of elements that
    satisfy the predicate
-}</span></span><span class="mpre">
</span><a href="#loc_241_1_241_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_1_241_5&#39;)"><span class="mpre">span</span></a><span class="mpre">
    :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 239, srcSpanStartColumn = 8, srcSpanEndLine = 240, srcSpanEndColumn = 7}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 240, srcSpanStartColumn = 5, srcSpanEndLine = 240, srcSpanEndColumn = 7}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-"><span class="mpre">Monad m
    =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">))
</span><a name="loc_241_1_241_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_1_241_5&#39;)"><span class="hl_fundecl"><span class="mpre">span</span></span></a><span class="mpre"> </span><a name="loc_241_6_241_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_6_241_15&#39;)"><span class="hl_vardecl"><span class="mpre">predicate</span></span></a><span class="mpre"> </span><a name="loc_241_16_241_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_16_241_17&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_241_18_241_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_18_241_20&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_204_1_204_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_204_1_204_5&#39;)"><span class="hl_varref"><span class="mpre">join</span></span></a><span class="mpre"> (</span><a href="#loc_241_16_241_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_16_241_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_244_5_244_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_5_244_7&#39;)"><span class="hl_varref"><span class="mpre">to</span></span></a><span class="mpre"> </span><a href="#loc_241_18_241_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_18_241_20&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre">))
  where
</span><span class="hl_comment"><span class="mpre">--  to :: Monad m =&gt; Producer a m x -&gt; Producer a m (Producer a m x)</span></span><span class="mpre">
    </span><a name="loc_244_5_244_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_5_244_7&#39;)"><span class="hl_fundecl"><span class="mpre">to</span></span></a><span class="mpre"> </span><a name="loc_244_8_244_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_8_244_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do
        </span><a name="loc_245_9_245_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> (</span><a href="Pipes.html#loc_454_1_454_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_454_1_454_5&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_244_8_244_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_8_244_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
        case </span><a href="#loc_245_9_245_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">   </span><a name="loc_247_20_247_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_20_247_21&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_247_20_247_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_20_247_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
            </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_248_20_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_20_248_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_248_23_248_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_23_248_25&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre">) -&gt;
                if (</span><a href="#loc_241_6_241_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_6_241_15&#39;)"><span class="hl_varref"><span class="mpre">predicate</span></span></a><span class="mpre"> </span><a href="#loc_248_20_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_20_248_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
                then do
                    </span><a href="Pipes.html#loc_132_1_132_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_132_1_132_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_248_20_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_20_248_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                    </span><a href="#loc_244_5_244_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_5_244_7&#39;)"><span class="hl_varref"><span class="mpre">to</span></span></a><span class="mpre"> </span><a href="#loc_248_23_248_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_23_248_25&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">
                else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Pipes.html#loc_132_1_132_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_132_1_132_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_248_20_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_20_248_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_248_23_248_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_23_248_25&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE span #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| &#39;splitAt&#39; is an improper lens that splits a &#39;Producer&#39; into two &#39;Producer&#39;s
    after a fixed number of elements
-}</span></span><span class="mpre">
</span><a href="#loc_262_1_262_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_8&#39;)"><span class="mpre">splitAt</span></a><span class="mpre">
    :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 260, srcSpanStartColumn = 8, srcSpanEndLine = 261, srcSpanEndColumn = 7}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 261, srcSpanStartColumn = 5, srcSpanEndLine = 261, srcSpanEndColumn = 7}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-"><span class="mpre">Monad m
    =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">))
</span><a name="loc_262_1_262_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_8&#39;)"><span class="hl_fundecl"><span class="mpre">splitAt</span></span></a><span class="mpre"> </span><a name="loc_262_9_262_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_9_262_11&#39;)"><span class="hl_vardecl"><span class="mpre">n0</span></span></a><span class="mpre"> </span><a name="loc_262_12_262_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_12_262_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_262_14_262_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_14_262_16&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_204_1_204_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_204_1_204_5&#39;)"><span class="hl_varref"><span class="mpre">join</span></span></a><span class="mpre"> (</span><a href="#loc_262_12_262_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_12_262_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_265_5_265_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_5_265_7&#39;)"><span class="hl_varref"><span class="mpre">to</span></span></a><span class="mpre"> </span><a href="#loc_262_9_262_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_9_262_11&#39;)"><span class="hl_varref"><span class="mpre">n0</span></span></a><span class="mpre"> </span><a href="#loc_262_14_262_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_14_262_16&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre">))
  where
</span><span class="hl_comment"><span class="mpre">--  to :: Monad m =&gt; Int -&gt; Producer a m x -&gt; Producer a m (Producer a m x)</span></span><span class="mpre">
    </span><a name="loc_265_5_265_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_5_265_7&#39;)"><span class="hl_fundecl"><span class="mpre">to</span></span></a><span class="mpre"> </span><a name="loc_265_8_265_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_8_265_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_265_10_265_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_10_265_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> =
        if (</span><a href="#loc_265_8_265_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_8_265_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
        then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_265_10_265_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_10_265_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        else do
            </span><a name="loc_269_13_269_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_13_269_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> (</span><a href="Pipes.html#loc_454_1_454_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_454_1_454_5&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_265_10_265_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_10_265_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
            case </span><a href="#loc_269_13_269_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_13_269_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">   </span><a name="loc_271_24_271_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_24_271_25&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_271_24_271_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_24_271_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_272_24_272_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_24_272_25&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_272_27_272_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_27_272_29&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre">) -&gt; do
                    </span><a href="Pipes.html#loc_132_1_132_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_132_1_132_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_272_24_272_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_24_272_25&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                    </span><a href="#loc_265_5_265_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_5_265_7&#39;)"><span class="hl_varref"><span class="mpre">to</span></span></a><span class="mpre"> (</span><a href="#loc_265_8_265_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_8_265_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_272_27_272_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_27_272_29&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE splitAt #-}</span></span><span class="mpre">

</span><a href="#loc_278_3_278_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_3_278_5&#39;)"><span class="mpre">(^.)</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; ((</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="Data.Functor.Constant.html#loc_24_9_24_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Constant.html#loc_24_9_24_17&#39;)"><span class="hl_tyconref"><span class="mpre">Constant</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Functor.Constant.html#loc_24_9_24_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Constant.html#loc_24_9_24_17&#39;)"><span class="hl_tyconref"><span class="mpre">Constant</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_278_1_278_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_2&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_278_3_278_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_3_278_5&#39;)"><span class="hl_fundecl"><span class="mpre">^.</span></span></a><span class="mpre"> </span><a name="loc_278_6_278_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_10&#39;)"><span class="hl_vardecl"><span class="mpre">lens</span></span></a><span class="mpre"> = </span><a href="Data.Functor.Constant.html#loc_24_35_24_46" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Constant.html#loc_24_35_24_46&#39;)"><span class="hl_varref"><span class="mpre">getConstant</span></span></a><span class="mpre"> (</span><a href="#loc_278_6_278_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_10&#39;)"><span class="hl_varref"><span class="mpre">lens</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Constant</span></span><span class="mpre"> </span><a href="#loc_278_1_278_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_2&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{-| &#39;groupBy&#39; splits a &#39;Producer&#39; into two &#39;Producer&#39;s after the first group of
     elements that are equal according to the equality predicate
-}</span></span><span class="mpre">
</span><a href="#loc_287_1_287_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_8&#39;)"><span class="mpre">groupBy</span></a><span class="mpre">
    :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 284, srcSpanStartColumn = 8, srcSpanEndLine = 285, srcSpanEndColumn = 7}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 285, srcSpanStartColumn = 5, srcSpanEndLine = 285, srcSpanEndColumn = 7}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-"><span class="mpre">Monad m
    =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
    -&gt; </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">))
</span><a name="loc_287_1_287_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_8&#39;)"><span class="hl_fundecl"><span class="mpre">groupBy</span></span></a><span class="mpre"> </span><a name="loc_287_9_287_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_9_287_15&#39;)"><span class="hl_vardecl"><span class="mpre">equals</span></span></a><span class="mpre"> </span><a name="loc_287_16_287_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_16_287_17&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_287_18_287_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_18_287_20&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_204_1_204_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_204_1_204_5&#39;)"><span class="hl_varref"><span class="mpre">join</span></span></a><span class="mpre"> (</span><a href="#loc_287_16_287_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_16_287_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_290_5_290_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_5_290_7&#39;)"><span class="hl_varref"><span class="mpre">to</span></span></a><span class="mpre"> </span><a href="#loc_287_18_287_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_18_287_20&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre">))
  where
</span><span class="hl_comment"><span class="mpre">--  to :: Monad m =&gt; Producer a m r -&gt; Producer a m (Producer a m x)</span></span><span class="mpre">
    </span><a name="loc_290_5_290_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_5_290_7&#39;)"><span class="hl_fundecl"><span class="mpre">to</span></span></a><span class="mpre"> </span><a name="loc_290_8_290_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_8_290_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do
        </span><a name="loc_291_9_291_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> (</span><a href="Pipes.html#loc_454_1_454_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_454_1_454_5&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_290_8_290_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_8_290_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
        case </span><a href="#loc_291_9_291_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">   </span><a name="loc_293_20_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_20_293_21&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_293_20_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_20_293_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
            </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_294_20_294_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_20_294_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_294_23_294_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_23_294_25&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre">) -&gt; (</span><a href="Pipes.html#loc_132_1_132_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_132_1_132_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_294_20_294_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_20_294_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_294_23_294_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_23_294_25&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">) </span><a href="#loc_278_3_278_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_3_278_5&#39;)"><span class="hl_infix"><span class="mpre">^.</span></span></a><span class="mpre"> </span><a href="#loc_241_1_241_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_1_241_5&#39;)"><span class="hl_varref"><span class="mpre">span</span></span></a><span class="mpre"> (</span><a href="#loc_287_9_287_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_9_287_15&#39;)"><span class="hl_varref"><span class="mpre">equals</span></span></a><span class="mpre"> </span><a href="#loc_294_20_294_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_20_294_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE groupBy #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;groupBy&#39;, where the equality predicate is (&#39;==&#39;)</span></span><span class="mpre">
</span><a href="#loc_300_1_300_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_6&#39;)"><span class="mpre">group</span></a><span class="mpre">
    :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 299, srcSpanStartColumn = 8, srcSpanEndLine = 299, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 299, srcSpanStartColumn = 8, srcSpanEndLine = 299, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStart"><span class="mpre">(Monad m, Eq a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">))
</span><a name="loc_300_1_300_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_6&#39;)"><span class="hl_vardecl"><span class="mpre">group</span></span></a><span class="mpre"> = </span><a href="#loc_287_1_287_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_8&#39;)"><span class="hl_varref"><span class="mpre">groupBy</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE group #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-| Convert a &#39;Consumer&#39; to a &#39;Parser&#39;

    &#39;Nothing&#39; signifies end of input
-}</span></span><span class="mpre">
</span><a href="#loc_308_1_308_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_9&#39;)"><span class="mpre">toParser</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 307, srcSpanStartColumn = 13, srcSpanEndLine = 307, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 307, srcSpanStartColumn = 21, srcSpanEndLine = 307, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-pa"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Consumer</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_308_1_308_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_9&#39;)"><span class="hl_fundecl"><span class="mpre">toParser</span></span></a><span class="mpre"> </span><a name="loc_308_10_308_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_10_308_18&#39;)"><span class="hl_vardecl"><span class="mpre">consumer</span></span></a><span class="mpre"> = </span><a href="Pipes.Core.html#loc_119_1_119_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Core.html#loc_119_1_119_10&#39;)"><span class="hl_varref"><span class="mpre">runEffect</span></span></a><span class="mpre"> (</span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><a href="#loc_73_1_73_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_5&#39;)"><span class="hl_varref"><span class="mpre">draw</span></span></a><span class="mpre"> </span><a href="Pipes.html#loc_265_4_265_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_265_4_265_6&#39;)"><span class="hl_infix"><span class="mpre">&gt;~</span></span></a><span class="mpre"> </span><a href="Pipes.Internal.html#loc_128_1_128_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Internal.html#loc_128_1_128_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeHoist</span></span></a><span class="mpre"> </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><a href="#loc_308_10_308_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_10_308_18&#39;)"><span class="hl_varref"><span class="mpre">consumer</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE toParser #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a never-ending &#39;Consumer&#39; to a &#39;Parser&#39;</span></span><span class="mpre">
</span><a href="#loc_313_1_313_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_1_313_10&#39;)"><span class="mpre">toParser_</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 312, srcSpanStartColumn = 14, srcSpanEndLine = 312, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-parse-3.0.2/src/Pipes/Parse.hs&quot;, srcSpanStartLine = 312, srcSpanStartColumn = 22, srcSpanEndLine = 312, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-pa"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Consumer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><a href="Pipes.Internal.html#loc_255_9_255_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Internal.html#loc_255_9_255_10&#39;)"><span class="hl_tyconref"><span class="mpre">X</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_313_1_313_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_1_313_10&#39;)"><span class="hl_fundecl"><span class="mpre">toParser_</span></span></a><span class="mpre"> </span><a name="loc_313_11_313_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_11_313_19&#39;)"><span class="hl_vardecl"><span class="mpre">consumer</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">StateT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_313_32_313_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_32_313_40&#39;)"><span class="hl_vardecl"><span class="mpre">producer</span></span></a><span class="mpre"> -&gt; do
    </span><a name="loc_314_5_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_5_314_6&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="Pipes.Core.html#loc_119_1_119_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Core.html#loc_119_1_119_10&#39;)"><span class="hl_varref"><span class="mpre">runEffect</span></span></a><span class="mpre"> (</span><a href="#loc_313_32_313_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_32_313_40&#39;)"><span class="hl_varref"><span class="mpre">producer</span></span></a><span class="mpre"> </span><a href="Pipes.html#loc_318_4_318_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_318_4_318_7&#39;)"><span class="hl_infix"><span class="mpre">&gt;-&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Pipes.Internal.html#loc_259_1_259_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Internal.html#loc_259_1_259_7&#39;)"><span class="hl_varref"><span class="mpre">closed</span></span></a><span class="mpre"> </span><a href="#loc_313_11_313_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_11_313_19&#39;)"><span class="hl_varref"><span class="mpre">consumer</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_314_5_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_5_314_6&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE toParser_ #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- $reexports
    &quot;Control.Monad.Trans.Class&quot; re-exports &#39;lift&#39;.

    &quot;Control.Monad.Trans.State.Strict&quot; re-exports &#39;StateT&#39;, &#39;runStateT&#39;,
    &#39;evalStateT&#39;, and &#39;execStateT&#39;.

    &quot;Pipes&quot; re-exports &#39;Producer&#39;, &#39;yield&#39;, and &#39;next&#39;.
-}</span></span><span class="mpre">
</span></div></body></html>