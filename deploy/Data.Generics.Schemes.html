<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RankNTypes, ScopedTypeVariables, CPP #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.Generics.Schemes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow, CWI 2001--2003</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the LICENSE file)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  generics@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (local universal quantification)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;Scrap your boilerplate\&quot; --- Generic programming in Haskell </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See &lt;http://www.cs.uu.nl/wiki/GenericProgramming/SYB&gt;. The present module</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provides frequently used generic traversal schemes.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Data.Generics.Schemes (

        everywhere,
        everywhere&#39;,
        everywhereBut,
        everywhereM,
        somewhere,
        everything,
        everythingBut,
        everythingWithContext,
        listify,
        something,
        synthesize,
        gsize,
        glength,
        gdepth,
        gcount,
        gnodecount,
        gtypecount,
        gfindtype

 ) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

#ifdef __HADDOCK__
import Prelude
#endif
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 8, srcSpanEndLine = 46, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
import Data.Generics.Aliases
import Control.Monad


</span><span class="hl_comment"><span class="mpre">-- | Apply a transformation everywhere in bottom-up manner</span></span><span class="mpre">
</span><a href="#loc_59_1_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_11&#39;)"><span class="mpre">everywhere</span></a><span class="mpre"> :: (forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 26, srcSpanEndLine = 52, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 33, srcSpanEndLine = 52, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
           -&gt; (forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 26, srcSpanEndLine = 53, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 33, srcSpanEndLine = 53, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Use gmapT to recurse into immediate subterms;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- recall: gmapT preserves the outermost constructor;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- post-process recursively transformed result via f</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a name="loc_59_1_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_11&#39;)"><span class="hl_fundecl"><span class="mpre">everywhere</span></span></a><span class="mpre"> </span><a name="loc_59_12_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_12_59_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_59_12_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_12_59_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gmapT</span></span><span class="mpre"> (</span><a href="#loc_59_1_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_11&#39;)"><span class="hl_varref"><span class="mpre">everywhere</span></span></a><span class="mpre"> </span><a href="#loc_59_12_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_12_59_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Apply a transformation everywhere in top-down manner</span></span><span class="mpre">
</span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="mpre">everywhere&#39;</span></a><span class="mpre"> :: (forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 27, srcSpanEndLine = 63, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 34, srcSpanEndLine = 63, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
            -&gt; (forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 27, srcSpanEndLine = 64, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 34, srcSpanEndLine = 64, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Arguments of (.) are flipped compared to everywhere</span></span><span class="mpre">
</span><a name="loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_fundecl"><span class="mpre">everywhere&#39;</span></span></a><span class="mpre"> </span><a name="loc_67_13_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_13_67_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">gmapT</span></span><span class="mpre"> (</span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_varref"><span class="mpre">everywhere&#39;</span></span></a><span class="mpre"> </span><a href="#loc_67_13_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_13_67_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_67_13_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_13_67_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Variation on everywhere with an extra stop condition</span></span><span class="mpre">
</span><a href="#loc_74_1_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_14&#39;)"><span class="mpre">everywhereBut</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericT</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericT</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Guarded to let traversal cease if predicate q holds for x</span></span><span class="mpre">
</span><a name="loc_74_1_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_14&#39;)"><span class="hl_fundecl"><span class="mpre">everywhereBut</span></span></a><span class="mpre"> </span><a name="loc_74_15_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_16&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_74_17_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_74_19_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">
    | </span><a href="#loc_74_15_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_16&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><a href="#loc_74_19_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">       = </span><a href="#loc_74_19_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_74_17_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapT</span></span><span class="mpre"> (</span><a href="#loc_74_1_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_14&#39;)"><span class="hl_varref"><span class="mpre">everywhereBut</span></span></a><span class="mpre"> </span><a href="#loc_74_15_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_16&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><a href="#loc_74_17_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_74_19_74_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Monadic variation on everywhere</span></span><span class="mpre">
</span><a href="#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="mpre">everywhereM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 16, srcSpanEndLine = 80, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 24, srcSpanEndLine = 80, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">GenericM</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericM</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Bottom-up order is also reflected in order of do-actions</span></span><span class="mpre">
</span><a name="loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="hl_fundecl"><span class="mpre">everywhereM</span></span></a><span class="mpre"> </span><a name="loc_83_13_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_83_15_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_15_83_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do </span><a name="loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">gmapM</span></span><span class="mpre"> (</span><a href="#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">everywhereM</span></span></a><span class="mpre"> </span><a href="#loc_83_13_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_83_15_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_15_83_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                     </span><a href="#loc_83_13_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_83_22_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_22_83_24&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Apply a monadic transformation at least somewhere</span></span><span class="mpre">
</span><a href="#loc_94_1_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_10&#39;)"><span class="mpre">somewhere</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 14, srcSpanEndLine = 88, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 26, srcSpanEndLine = 88, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">MonadPlus m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">GenericM</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericM</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- We try &quot;f&quot; in top-down manner, but descent into &quot;x&quot; when we fail</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- at the root of the term. The transformation fails if &quot;f&quot; fails</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- everywhere, say succeeds nowhere.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a name="loc_94_1_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_10&#39;)"><span class="hl_fundecl"><span class="mpre">somewhere</span></span></a><span class="mpre"> </span><a name="loc_94_11_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_94_11_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gmapMp</span></span><span class="mpre"> (</span><a href="#loc_94_1_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_10&#39;)"><span class="hl_varref"><span class="mpre">somewhere</span></span></a><span class="mpre"> </span><a href="#loc_94_11_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Summarise all nodes in top-down, left-to-right order</span></span><span class="mpre">
</span><a href="#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_11&#39;)"><span class="mpre">everything</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Apply f to x to summarise top-level node;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- use gmapQ to recurse into immediate subterms;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- use ordinary foldl to reduce list of intermediate results</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a name="loc_104_1_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_11&#39;)"><span class="hl_fundecl"><span class="mpre">everything</span></span></a><span class="mpre"> </span><a name="loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_104_14_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_14_104_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_104_16_104_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_16_104_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="#loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_104_14_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_14_104_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_104_16_104_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_16_104_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (</span><a href="#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">everything</span></span></a><span class="mpre"> </span><a href="#loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_104_14_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_14_104_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_104_16_104_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_16_104_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Variation of &quot;everything&quot; with an added stop condition</span></span><span class="mpre">
</span><a href="#loc_108_1_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_14&#39;)"><span class="mpre">everythingBut</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_108_1_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_14&#39;)"><span class="hl_fundecl"><span class="mpre">everythingBut</span></span></a><span class="mpre"> </span><a name="loc_108_15_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_15_108_16&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_108_19_108_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = let (</span><a name="loc_108_28_108_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_28_108_29&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">, </span><a name="loc_108_31_108_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_31_108_35&#39;)"><span class="hl_vardecl"><span class="mpre">stop</span></span></a><span class="mpre">) = </span><a href="#loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_108_19_108_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                      in if </span><a href="#loc_108_31_108_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_31_108_35&#39;)"><span class="hl_varref"><span class="mpre">stop</span></span></a><span class="mpre">
                           then </span><a href="#loc_108_28_108_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_28_108_29&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
                           else </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="#loc_108_15_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_15_108_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_108_28_108_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_28_108_29&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (</span><a href="#loc_108_1_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_14&#39;)"><span class="hl_varref"><span class="mpre">everythingBut</span></span></a><span class="mpre"> </span><a href="#loc_108_15_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_15_108_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_108_19_108_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Summarise all nodes in top-down, left-to-right order, carrying some state</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- down the tree during the computation, but not left-to-right to siblings.</span></span><span class="mpre">
</span><a href="#loc_116_1_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_22&#39;)"><span class="mpre">everythingWithContext</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_116_1_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_22&#39;)"><span class="hl_fundecl"><span class="mpre">everythingWithContext</span></span></a><span class="mpre"> </span><a name="loc_116_23_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_23_116_25&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_116_26_116_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_26_116_27&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_116_28_116_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_28_116_29&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_116_30_116_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_30_116_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="#loc_116_26_116_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_26_116_27&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_118_12_118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_12_118_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (</span><a href="#loc_116_1_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_22&#39;)"><span class="hl_varref"><span class="mpre">everythingWithContext</span></span></a><span class="mpre"> </span><a href="#loc_118_15_118_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_17&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_116_26_116_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_26_116_27&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_116_28_116_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_28_116_29&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">) </span><a href="#loc_116_30_116_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_30_116_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    where (</span><a name="loc_118_12_118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_12_118_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">, </span><a name="loc_118_15_118_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_17&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_116_28_116_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_28_116_29&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><a href="#loc_116_30_116_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_30_116_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_116_23_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_23_116_25&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get a list of all entities that meet a predicate</span></span><span class="mpre">
</span><a href="#loc_122_1_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_8&#39;)"><span class="mpre">listify</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 121, srcSpanStartColumn = 12, srcSpanEndLine = 121, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 121, srcSpanStartColumn = 23, srcSpanEndLine = 121, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-"><span class="mpre">Typeable r =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">]
</span><a name="loc_122_1_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_8&#39;)"><span class="hl_fundecl"><span class="mpre">listify</span></span></a><span class="mpre"> </span><a name="loc_122_9_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">everything</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(++)</span></span><span class="mpre"> ([] </span><a href="Data.Generics.Aliases.html#loc_100_4_100_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_100_4_100_9&#39;)"><span class="hl_infix"><span class="mpre">`mkQ`</span></span></a><span class="mpre"> (\</span><a name="loc_122_41_122_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_41_122_42&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; if </span><a href="#loc_122_9_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_122_41_122_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_41_122_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then [</span><a href="#loc_122_41_122_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_41_122_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">] else []))


</span><span class="hl_comment"><span class="mpre">-- | Look up a subterm by means of a maybe-typed filter</span></span><span class="mpre">
</span><a href="#loc_131_1_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_10&#39;)"><span class="mpre">something</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">u</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">u</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- &quot;something&quot; can be defined in terms of &quot;everything&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- when a suitable &quot;choice&quot; operator is used for reduction</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a name="loc_131_1_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_10&#39;)"><span class="hl_vardecl"><span class="mpre">something</span></span></a><span class="mpre"> = </span><a href="#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">everything</span></span></a><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_274_3_274_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_274_3_274_11&#39;)"><span class="hl_varref"><span class="mpre">orElse</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Bottom-up synthesis of a data structure;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   1st argument z is the initial element for the synthesis;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   2nd argument o is for reduction of results from subterms;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   3rd argument f updates the synthesised data according to the given term</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_140_1_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_11&#39;)"><span class="mpre">synthesize</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">  -&gt; (</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_140_1_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_11&#39;)"><span class="hl_fundecl"><span class="mpre">synthesize</span></span></a><span class="mpre"> </span><a name="loc_140_12_140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_13&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_140_14_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_14_140_15&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_140_16_140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_16_140_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_140_18_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_18_140_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_140_16_140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_16_140_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_140_18_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_18_140_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_140_14_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_14_140_15&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_140_12_140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_13&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (</span><a href="#loc_140_1_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_11&#39;)"><span class="hl_varref"><span class="mpre">synthesize</span></span></a><span class="mpre"> </span><a href="#loc_140_12_140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_13&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_140_14_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_14_140_15&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_140_16_140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_16_140_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_140_18_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_18_140_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))


</span><span class="hl_comment"><span class="mpre">-- | Compute size of an arbitrary data structure</span></span><span class="mpre">
</span><a href="#loc_145_1_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_6&#39;)"><span class="mpre">gsize</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 10, srcSpanEndLine = 144, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 17, srcSpanEndLine = 144, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_145_1_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_6&#39;)"><span class="hl_fundecl"><span class="mpre">gsize</span></span></a><span class="mpre"> </span><a name="loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Data.List.html#loc_1025_1_1025_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1025_1_1025_4&#39;)"><span class="hl_varref"><span class="mpre">sum</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><a href="#loc_145_1_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_6&#39;)"><span class="hl_varref"><span class="mpre">gsize</span></span></a><span class="mpre"> </span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Count the number of immediate subterms of the given term</span></span><span class="mpre">
</span><a href="#loc_150_1_150_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_8&#39;)"><span class="mpre">glength</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_150_1_150_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_8&#39;)"><span class="hl_vardecl"><span class="mpre">glength</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Determine depth of the given term</span></span><span class="mpre">
</span><a href="#loc_155_1_155_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_7&#39;)"><span class="mpre">gdepth</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_155_1_155_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_7&#39;)"><span class="hl_vardecl"><span class="mpre">gdepth</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">(+)</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><a href="#loc_155_1_155_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_7&#39;)"><span class="hl_varref"><span class="mpre">gdepth</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Determine the number of all suitable nodes in a given term</span></span><span class="mpre">
</span><a href="#loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="mpre">gcount</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="hl_fundecl"><span class="mpre">gcount</span></span></a><span class="mpre"> </span><a name="loc_160_8_160_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_8_160_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> =  </span><a href="#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">everything</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(+)</span></span><span class="mpre"> (\</span><a name="loc_160_30_160_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_30_160_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; if </span><a href="#loc_160_8_160_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_8_160_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_160_30_160_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_30_160_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Determine the number of all nodes in a given term</span></span><span class="mpre">
</span><a href="#loc_165_1_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_11&#39;)"><span class="mpre">gnodecount</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_165_1_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_11&#39;)"><span class="hl_vardecl"><span class="mpre">gnodecount</span></span></a><span class="mpre"> = </span><a href="#loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="hl_varref"><span class="mpre">gcount</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Determine the number of nodes of a given type in a given term</span></span><span class="mpre">
</span><a href="#loc_170_1_170_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_11&#39;)"><span class="mpre">gtypecount</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 15, srcSpanEndLine = 169, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 26, srcSpanEndLine = 169, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-"><span class="mpre">Typeable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_170_1_170_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_11&#39;)"><span class="hl_fundecl"><span class="mpre">gtypecount</span></span></a><span class="mpre"> (_::</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) = </span><a href="#loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="hl_varref"><span class="mpre">gcount</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_100_4_100_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_100_4_100_9&#39;)"><span class="hl_infix"><span class="mpre">`mkQ`</span></span></a><span class="mpre"> (\(_::</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">))


</span><span class="hl_comment"><span class="mpre">-- | Find (unambiguously) an immediate subterm of a given type</span></span><span class="mpre">
</span><a href="#loc_175_1_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_10&#39;)"><span class="mpre">gfindtype</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 14, srcSpanEndLine = 174, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 14, srcSpanEndLine = 174, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Schemes.hs&quot;, src"><span class="mpre">(Data x, Typeable y) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">
</span><a name="loc_175_1_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_10&#39;)"><span class="hl_vardecl"><span class="mpre">gfindtype</span></span></a><span class="mpre"> = </span><a href="#loc_181_3_181_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_3_181_12&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre">
          </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="#loc_179_3_179_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_9&#39;)"><span class="hl_varref"><span class="mpre">unJust</span></span></a><span class="mpre"> []
          </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_100_4_100_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_100_4_100_9&#39;)"><span class="hl_infix"><span class="mpre">`mkQ`</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre">)
 where
  </span><a name="loc_179_3_179_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_9&#39;)"><span class="hl_fundecl"><span class="mpre">unJust</span></span></a><span class="mpre"> </span><a name="loc_179_10_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_179_18_179_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_18_179_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_179_18_179_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_18_179_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_179_10_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  </span><a href="#loc_179_3_179_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_9&#39;)"><span class="hl_fundecl"><span class="mpre">unJust</span></span></a><span class="mpre"> </span><a name="loc_180_10_180_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_10_180_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">  = </span><a href="#loc_180_10_180_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_10_180_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  </span><a name="loc_181_3_181_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_3_181_12&#39;)"><span class="hl_fundecl"><span class="mpre">singleton</span></span></a><span class="mpre"> [</span><a name="loc_181_14_181_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_14_181_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">] = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_181_14_181_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_14_181_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  </span><a href="#loc_181_3_181_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_3_181_12&#39;)"><span class="hl_fundecl"><span class="mpre">singleton</span></span></a><span class="mpre"> _   = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
</span></div></body></html>