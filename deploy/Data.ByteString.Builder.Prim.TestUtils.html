<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, ScopedTypeVariables #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2011 Simon Meier</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Simon Meier &lt;iridcode@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : tested on GHC only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Testing utilities for comparing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for an example on how to use the functions provided here.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.ByteString.Builder.Prim.TestUtils (

  </span><span class="hl_comment"><span class="mpre">-- * Showing</span></span><span class="mpre">
    evalF
  , evalB

  , showF
  , showB

  </span><span class="hl_comment"><span class="mpre">-- * Testing &#39;FixedPrim&#39;s</span></span><span class="mpre">
  , testF
  , testBoundedF

  , testFixedBoundF

  , compareImpls

  </span><span class="hl_comment"><span class="mpre">-- * Testing &#39;BoundedPrim&#39;s</span></span><span class="mpre">
  , testBoundedB

  </span><span class="hl_comment"><span class="mpre">-- * Encoding reference implementations</span></span><span class="mpre">

  , charUtf8_list
  , char8_list

  </span><span class="hl_comment"><span class="mpre">-- ** ASCII-based encodings</span></span><span class="mpre">
  , encodeASCII
  , encodeForcedASCII
  , char7_list
  , dec_list
  , hex_list
  , wordHexFixed_list
  , int8HexFixed_list
  , int16HexFixed_list
  , int32HexFixed_list
  , int64HexFixed_list
  , floatHexFixed_list
  , doubleHexFixed_list

  </span><span class="hl_comment"><span class="mpre">-- ** Binary</span></span><span class="mpre">
  , parseVar

  , bigEndian_list
  , littleEndian_list
  , hostEndian_list
  , float_list
  , double_list
  , coerceFloatToWord32
  , coerceDoubleToWord64

  ) where

import           Control.Arrow (</span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="mpre">first</span></a><span class="mpre">)

import           Data.ByteString.Builder.Prim

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 69, srcSpanStartColumn = 18, srcSpanEndLine = 69, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">               as S
import qualified Data.ByteString.Internal      as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 18, srcSpanEndLine = 71, srcSpanEndColumn = 55}, srcInfoPoints = []}) &quot;Data.ByteString.Builder.Prim.Internal&quot;"><span class="mpre">Data.ByteString.Builder.Prim.Internal</span></span><span class="mpre"> as I

import           Data.Char (</span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="mpre">chr</span></a><span class="mpre">, ord)

import           Numeric (</span><a href="Numeric.html#loc_228_1_228_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Numeric.html#loc_228_1_228_8&#39;)"><span class="mpre">showHex</span></a><span class="mpre">)

#if MIN_VERSION_base(4,4,0)
import Foreign hiding (unsafePerformIO)
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)
#else
import Foreign
#endif

import           System.ByteOrder

#if defined(HAVE_TEST_FRAMEWORK)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 18, srcSpanEndLine = 87, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre"> (assertBool)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 18, srcSpanEndLine = 88, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Test.Framework&quot;"><span class="mpre">Test.Framework</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 18, srcSpanEndLine = 89, srcSpanEndColumn = 48}, srcInfoPoints = []}) &quot;Test.Framework.Providers.HUnit&quot;"><span class="mpre">Test.Framework.Providers.HUnit</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 18, srcSpanEndLine = 90, srcSpanEndColumn = 54}, srcInfoPoints = []}) &quot;Test.Framework.Providers.QuickCheck2&quot;"><span class="mpre">Test.Framework.Providers.QuickCheck2</span></span><span class="mpre">
#else
import           TestFramework
#endif
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 18, srcSpanEndLine = 94, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre"> (Arbitrary(..))

</span><span class="hl_comment"><span class="mpre">-- Helper functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Quickcheck test that includes a check that the property holds on the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bounds of a bounded value.</span></span><span class="mpre">
</span><a href="#loc_103_1_103_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_20&#39;)"><span class="mpre">testBoundedProperty</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 34, srcSpanEndLine = 102, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 34, srcSpanEndLine = 101, srcSpanEndColumn = 35},SrcSpan {srcSpanFilename"><span class="mpre">(Arbitrary a, Show a, Bounded a)
                    =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_103_1_103_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_20&#39;)"><span class="hl_fundecl"><span class="mpre">testBoundedProperty</span></span></a><span class="mpre"> </span><a name="loc_103_21_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_21_103_25&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_103_26_103_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_27&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="TestFramework.html#loc_34_1_34_10" onmouseover="nemnem.highlightLocalToRemote(&#39;TestFramework.html#loc_34_1_34_10&#39;)"><span class="hl_varref"><span class="mpre">testGroup</span></span></a><span class="mpre"> </span><a href="#loc_103_21_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_21_103_25&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">
  [ </span><a href="TestFramework.html#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToRemote(&#39;TestFramework.html#loc_37_1_37_13&#39;)"><span class="hl_varref"><span class="mpre">testProperty</span></span></a><span class="mpre"> </span><a href="#loc_103_21_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_21_103_25&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_103_26_103_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
  , </span><a href="TestFramework.html#loc_54_1_54_9" onmouseover="nemnem.highlightLocalToRemote(&#39;TestFramework.html#loc_54_1_54_9&#39;)"><span class="hl_varref"><span class="mpre">testCase</span></span></a><span class="mpre"> (</span><a href="#loc_103_21_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_21_103_25&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; minBound&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="TestFramework.html#loc_51_1_51_11" onmouseover="nemnem.highlightLocalToRemote(&#39;TestFramework.html#loc_51_1_51_11&#39;)"><span class="hl_varref"><span class="mpre">assertBool</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;minBound&quot;</span></span><span class="mpre"> (</span><a href="#loc_103_26_103_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">minBound</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
  , </span><a href="TestFramework.html#loc_54_1_54_9" onmouseover="nemnem.highlightLocalToRemote(&#39;TestFramework.html#loc_54_1_54_9&#39;)"><span class="hl_varref"><span class="mpre">testCase</span></span></a><span class="mpre"> (</span><a href="#loc_103_21_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_21_103_25&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; maxBound&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="TestFramework.html#loc_51_1_51_11" onmouseover="nemnem.highlightLocalToRemote(&#39;TestFramework.html#loc_51_1_51_11&#39;)"><span class="hl_varref"><span class="mpre">assertBool</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;minBound&quot;</span></span><span class="mpre"> (</span><a href="#loc_103_26_103_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">maxBound</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
  ]

</span><span class="hl_comment"><span class="mpre">-- | Quote a &#39;String&#39; nicely.</span></span><span class="mpre">
</span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="mpre">quote</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_fundecl"><span class="mpre">quote</span></span></a><span class="mpre"> </span><a name="loc_111_7_111_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_7_111_9&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;`&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_111_7_111_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_7_111_9&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Quote a @[Word8]@ list as as &#39;String&#39;.</span></span><span class="mpre">
</span><a href="#loc_115_1_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_12&#39;)"><span class="mpre">quoteWord8s</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_115_1_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_12&#39;)"><span class="hl_vardecl"><span class="mpre">quoteWord8s</span></span></a><span class="mpre"> = </span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_varref"><span class="mpre">quote</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Testing encodings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /For testing use only./ Evaluate a &#39;FixedPrim&#39; on a given value.</span></span><span class="mpre">
</span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="mpre">evalF</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FixedPrim</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_fundecl"><span class="mpre">evalF</span></span></a><span class="mpre"> </span><a name="loc_124_7_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_9&#39;)"><span class="hl_vardecl"><span class="mpre">fe</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.unpack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeCreate</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">I.size</span></span><span class="mpre"> </span><a href="#loc_124_7_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_9&#39;)"><span class="hl_varref"><span class="mpre">fe</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">I.runF</span></span><span class="mpre"> </span><a href="#loc_124_7_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_9&#39;)"><span class="hl_varref"><span class="mpre">fe</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /For testing use only./ Evaluate a &#39;BoundedPrim&#39; on a given value.</span></span><span class="mpre">
</span><a href="#loc_128_1_128_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_6&#39;)"><span class="mpre">evalB</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BoundedPrim</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_128_1_128_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_6&#39;)"><span class="hl_fundecl"><span class="mpre">evalB</span></span></a><span class="mpre"> </span><a name="loc_128_7_128_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_7_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">be</span></span></a><span class="mpre"> </span><a name="loc_128_10_128_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_10_128_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.unpack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="Data.ByteString.Internal.html#loc_466_1_466_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_466_1_466_14&#39;)"><span class="hl_varref"><span class="mpre">S.createAndTrim</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">I.sizeBound</span></span><span class="mpre"> </span><a href="#loc_128_7_128_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_7_128_9&#39;)"><span class="hl_varref"><span class="mpre">be</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_129_41_129_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_41_129_43&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_130_9_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_12&#39;)"><span class="hl_vardecl"><span class="mpre">op&#39;</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">I.runB</span></span><span class="mpre"> </span><a href="#loc_128_7_128_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_7_128_9&#39;)"><span class="hl_varref"><span class="mpre">be</span></span></a><span class="mpre"> </span><a href="#loc_128_10_128_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_10_128_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_129_41_129_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_41_129_43&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_130_9_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_12&#39;)"><span class="hl_varref"><span class="mpre">op&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_129_41_129_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_41_129_43&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | /For testing use only./ Show the result of a &#39;FixedPrim&#39; of a given</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- value as a &#39;String&#39; by interpreting the resulting bytes as Unicode</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- codepoints.</span></span><span class="mpre">
</span><a href="#loc_137_1_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_6&#39;)"><span class="mpre">showF</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FixedPrim</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_137_1_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_6&#39;)"><span class="hl_fundecl"><span class="mpre">showF</span></span></a><span class="mpre"> </span><a name="loc_137_7_137_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_7_137_9&#39;)"><span class="hl_vardecl"><span class="mpre">fe</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_varref"><span class="mpre">evalF</span></span></a><span class="mpre"> </span><a href="#loc_137_7_137_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_7_137_9&#39;)"><span class="hl_varref"><span class="mpre">fe</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /For testing use only./ Show the result of a &#39;BoundedPrim&#39; of a given</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- value as a &#39;String&#39; by interpreting the resulting bytes as Unicode</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- codepoints.</span></span><span class="mpre">
</span><a href="#loc_143_1_143_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_6&#39;)"><span class="mpre">showB</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BoundedPrim</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_143_1_143_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_6&#39;)"><span class="hl_fundecl"><span class="mpre">showB</span></span></a><span class="mpre"> </span><a name="loc_143_7_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_7_143_9&#39;)"><span class="hl_vardecl"><span class="mpre">be</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_128_1_128_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_6&#39;)"><span class="hl_varref"><span class="mpre">evalB</span></span></a><span class="mpre"> </span><a href="#loc_143_7_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_7_143_9&#39;)"><span class="hl_varref"><span class="mpre">be</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- FixedPrim</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- TODO: Port code that checks for low-level properties of basic encodings (no</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- overwrites, all bytes written, etc.) from old &#39;system-io-write&#39; library</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Test a &#39;FixedPrim&#39; against a reference implementation.</span></span><span class="mpre">
</span><a href="#loc_158_1_158_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_6&#39;)"><span class="mpre">testF</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 153, srcSpanStartColumn = 10, srcSpanEndLine = 154, srcSpanEndColumn = 9}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 153, srcSpanStartColumn = 10, srcSpanEndLine = 153, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename "><span class="mpre">(Arbitrary a, Show a)
      =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
      -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">])
      -&gt; </span><span class="hl_tyconref"><span class="mpre">FixedPrim</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
      -&gt; </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_158_1_158_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_6&#39;)"><span class="hl_fundecl"><span class="mpre">testF</span></span></a><span class="mpre"> </span><a name="loc_158_7_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_7_158_11&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_158_12_158_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_12_158_15&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_158_16_158_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_16_158_18&#39;)"><span class="hl_vardecl"><span class="mpre">fe</span></span></a><span class="mpre"> =
    </span><a href="TestFramework.html#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToRemote(&#39;TestFramework.html#loc_37_1_37_13&#39;)"><span class="hl_varref"><span class="mpre">testProperty</span></span></a><span class="mpre"> </span><a href="#loc_158_7_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_7_158_11&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_161_5_161_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a name="loc_161_5_161_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">
      | </span><a href="#loc_169_9_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_170_9_170_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_11&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          [ </span><span class="hl_string"><span class="mpre">&quot;testF: results disagree for &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_varref"><span class="mpre">quote</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
          , </span><span class="hl_string"><span class="mpre">&quot; fixed encoding: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_169_9_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_115_1_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_12&#39;)"><span class="hl_varref"><span class="mpre">quoteWord8s</span></span></a><span class="mpre"> </span><a href="#loc_169_9_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
          , </span><span class="hl_string"><span class="mpre">&quot; reference:      &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_170_9_170_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_11&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_115_1_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_12&#39;)"><span class="hl_varref"><span class="mpre">quoteWord8s</span></span></a><span class="mpre"> </span><a href="#loc_170_9_170_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_11&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">
          ]
      where
        </span><a name="loc_169_9_169_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">  = </span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_varref"><span class="mpre">evalF</span></span></a><span class="mpre"> </span><a href="#loc_158_16_158_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_16_158_18&#39;)"><span class="hl_varref"><span class="mpre">fe</span></span></a><span class="mpre"> </span><a href="#loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_170_9_170_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_11&#39;)"><span class="hl_vardecl"><span class="mpre">y&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_158_12_158_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_12_158_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Test a &#39;FixedPrim&#39; of a bounded value against a reference implementation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and ensure that the bounds are always included as testcases.</span></span><span class="mpre">
</span><a href="#loc_179_1_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_13&#39;)"><span class="mpre">testBoundedF</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 17, srcSpanEndLine = 175, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 17, srcSpanEndLine = 174, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename"><span class="mpre">(Arbitrary a, Bounded a, Show a)
             =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">])
             -&gt; </span><span class="hl_tyconref"><span class="mpre">FixedPrim</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_179_1_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_13&#39;)"><span class="hl_fundecl"><span class="mpre">testBoundedF</span></span></a><span class="mpre"> </span><a name="loc_179_14_179_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_14_179_18&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_179_19_179_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_19_179_22&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_179_23_179_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_23_179_25&#39;)"><span class="hl_vardecl"><span class="mpre">fe</span></span></a><span class="mpre"> =
    </span><a href="#loc_103_1_103_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_20&#39;)"><span class="hl_varref"><span class="mpre">testBoundedProperty</span></span></a><span class="mpre"> </span><a href="#loc_179_14_179_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_14_179_18&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_180_33_180_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_33_180_34&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_varref"><span class="mpre">evalF</span></span></a><span class="mpre"> </span><a href="#loc_179_23_179_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_23_179_25&#39;)"><span class="hl_varref"><span class="mpre">fe</span></span></a><span class="mpre"> </span><a href="#loc_180_33_180_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_33_180_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_179_19_179_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_19_179_22&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_180_33_180_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_33_180_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- FixedPrim derived from a bound on a given value.</span></span><span class="mpre">

</span><a href="#loc_189_1_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_16&#39;)"><span class="mpre">testFixedBoundF</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 184, srcSpanStartColumn = 20, srcSpanEndLine = 185, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 184, srcSpanStartColumn = 20, srcSpanEndLine = 184, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename"><span class="mpre">(Arbitrary a, Show a, Integral a)
                =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">])
                -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FixedPrim</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
                -&gt; </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_189_1_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_16&#39;)"><span class="hl_fundecl"><span class="mpre">testFixedBoundF</span></span></a><span class="mpre"> </span><a name="loc_189_17_189_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_17_189_21&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_189_22_189_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_22_189_25&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_189_26_189_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_26_189_29&#39;)"><span class="hl_vardecl"><span class="mpre">bfe</span></span></a><span class="mpre"> =
    </span><a href="TestFramework.html#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToRemote(&#39;TestFramework.html#loc_37_1_37_13&#39;)"><span class="hl_varref"><span class="mpre">testProperty</span></span></a><span class="mpre"> </span><a href="#loc_189_17_189_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_17_189_21&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_192_5_192_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_5_192_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a name="loc_192_5_192_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_5_192_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> (</span><a name="loc_192_11_192_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_11_192_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">, </span><a name="loc_192_14_192_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_14_192_16&#39;)"><span class="hl_vardecl"><span class="mpre">x0</span></span></a><span class="mpre">)
      | </span><a href="#loc_202_9_202_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_203_9_203_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_11&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          [ </span><span class="hl_string"><span class="mpre">&quot;testF: results disagree for &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_varref"><span class="mpre">quote</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_192_11_192_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_11_192_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_200_9_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_9_200_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))
          , </span><span class="hl_string"><span class="mpre">&quot; fixed encoding: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_202_9_202_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_115_1_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_12&#39;)"><span class="hl_varref"><span class="mpre">quoteWord8s</span></span></a><span class="mpre"> </span><a href="#loc_202_9_202_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
          , </span><span class="hl_string"><span class="mpre">&quot; reference:      &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_203_9_203_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_11&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_115_1_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_12&#39;)"><span class="hl_varref"><span class="mpre">quoteWord8s</span></span></a><span class="mpre"> </span><a href="#loc_203_9_203_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_11&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">
          ]
      where
        </span><a name="loc_200_9_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_9_200_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  | </span><a href="#loc_192_11_192_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_11_192_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_192_14_192_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_14_192_16&#39;)"><span class="hl_varref"><span class="mpre">x0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_192_11_192_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_11_192_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
        </span><a name="loc_202_9_202_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">  = </span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_varref"><span class="mpre">evalF</span></span></a><span class="mpre"> (</span><a href="#loc_189_26_189_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_26_189_29&#39;)"><span class="hl_varref"><span class="mpre">bfe</span></span></a><span class="mpre"> </span><a href="#loc_192_11_192_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_11_192_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="#loc_200_9_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_9_200_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_203_9_203_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_11&#39;)"><span class="hl_vardecl"><span class="mpre">y&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_189_22_189_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_22_189_25&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_192_11_192_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_11_192_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_200_9_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_9_200_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- BoundedPrim</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Test a &#39;BoundedPrim&#39; of a bounded value against a reference implementation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and ensure that the bounds are always included as testcases.</span></span><span class="mpre">
</span><a href="#loc_216_1_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_13&#39;)"><span class="mpre">testBoundedB</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 211, srcSpanStartColumn = 17, srcSpanEndLine = 212, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 211, srcSpanStartColumn = 17, srcSpanEndLine = 211, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename"><span class="mpre">(Arbitrary a, Bounded a, Show a)
             =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">])
             -&gt; </span><span class="hl_tyconref"><span class="mpre">BoundedPrim</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_216_1_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_13&#39;)"><span class="hl_fundecl"><span class="mpre">testBoundedB</span></span></a><span class="mpre"> </span><a name="loc_216_14_216_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_14_216_18&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_216_19_216_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_19_216_22&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_216_23_216_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_23_216_25&#39;)"><span class="hl_vardecl"><span class="mpre">fe</span></span></a><span class="mpre"> =
    </span><a href="#loc_103_1_103_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_20&#39;)"><span class="hl_varref"><span class="mpre">testBoundedProperty</span></span></a><span class="mpre"> </span><a href="#loc_216_14_216_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_14_216_18&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_219_5_219_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_5_219_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre">
  where
    </span><a name="loc_219_5_219_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_5_219_10&#39;)"><span class="hl_fundecl"><span class="mpre">check</span></span></a><span class="mpre"> </span><a name="loc_219_11_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_11_219_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">
      | </span><a href="#loc_227_9_227_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_228_9_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_11&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          [ </span><span class="hl_string"><span class="mpre">&quot;testBoundedB: results disagree for &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_varref"><span class="mpre">quote</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_219_11_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_11_219_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
          , </span><span class="hl_string"><span class="mpre">&quot; fixed encoding: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_227_9_227_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_115_1_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_12&#39;)"><span class="hl_varref"><span class="mpre">quoteWord8s</span></span></a><span class="mpre"> </span><a href="#loc_227_9_227_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
          , </span><span class="hl_string"><span class="mpre">&quot; reference:      &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_228_9_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_11&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_115_1_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_12&#39;)"><span class="hl_varref"><span class="mpre">quoteWord8s</span></span></a><span class="mpre"> </span><a href="#loc_228_9_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_11&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">
          ]
      where
        </span><a name="loc_227_9_227_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">  = </span><a href="#loc_128_1_128_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_6&#39;)"><span class="hl_varref"><span class="mpre">evalB</span></span></a><span class="mpre"> </span><a href="#loc_216_23_216_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_23_216_25&#39;)"><span class="hl_varref"><span class="mpre">fe</span></span></a><span class="mpre"> </span><a href="#loc_219_11_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_11_219_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_228_9_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_11&#39;)"><span class="hl_vardecl"><span class="mpre">y&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_216_19_216_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_19_216_22&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_219_11_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_11_219_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Compare two implementations of a function.</span></span><span class="mpre">
</span><a href="#loc_233_1_233_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_13&#39;)"><span class="mpre">compareImpls</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 231, srcSpanStartColumn = 17, srcSpanEndLine = 232, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 231, srcSpanStartColumn = 17, srcSpanEndLine = 231, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename"><span class="mpre">(Arbitrary a, Show a, Show b, Eq b)
             =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TestName</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_233_1_233_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_13&#39;)"><span class="hl_fundecl"><span class="mpre">compareImpls</span></span></a><span class="mpre"> </span><a name="loc_233_14_233_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_14_233_18&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_233_19_233_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_19_233_21&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a name="loc_233_22_233_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_22_233_24&#39;)"><span class="hl_vardecl"><span class="mpre">f2</span></span></a><span class="mpre"> =
    </span><a href="TestFramework.html#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToRemote(&#39;TestFramework.html#loc_37_1_37_13&#39;)"><span class="hl_varref"><span class="mpre">testProperty</span></span></a><span class="mpre"> </span><a href="#loc_233_14_233_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_14_233_18&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_236_5_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_5_236_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre">
  where
    </span><a name="loc_236_5_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_5_236_10&#39;)"><span class="hl_fundecl"><span class="mpre">check</span></span></a><span class="mpre"> </span><a name="loc_236_11_236_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_11_236_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">
      | </span><a href="#loc_244_9_244_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_9_244_11&#39;)"><span class="hl_varref"><span class="mpre">y1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_245_9_245_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_11&#39;)"><span class="hl_varref"><span class="mpre">y2</span></span></a><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          [ </span><span class="hl_string"><span class="mpre">&quot;compareImpls: results disagree for &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_varref"><span class="mpre">quote</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_236_11_236_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_11_236_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
          , </span><span class="hl_string"><span class="mpre">&quot; f1: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_244_9_244_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_9_244_11&#39;)"><span class="hl_varref"><span class="mpre">y1</span></span></a><span class="mpre">
          , </span><span class="hl_string"><span class="mpre">&quot; f2: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_245_9_245_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_11&#39;)"><span class="hl_varref"><span class="mpre">y2</span></span></a><span class="mpre">
          ]
      where
        </span><a name="loc_244_9_244_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_9_244_11&#39;)"><span class="hl_vardecl"><span class="mpre">y1</span></span></a><span class="mpre"> = </span><a href="#loc_233_19_233_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_19_233_21&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a href="#loc_236_11_236_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_11_236_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_245_9_245_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_11&#39;)"><span class="hl_vardecl"><span class="mpre">y2</span></span></a><span class="mpre"> = </span><a href="#loc_233_22_233_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_22_233_24&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a href="#loc_236_11_236_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_11_236_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Encoding reference implementations</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Char8 encoding: truncate Unicode codepoint to 8-bits.</span></span><span class="mpre">
</span><a href="#loc_255_1_255_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_11&#39;)"><span class="mpre">char8_list</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_255_1_255_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_11&#39;)"><span class="hl_vardecl"><span class="mpre">char8_list</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode a Haskell String to a list of Word8 values, in UTF8 format.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copied from &#39;utf8-string-0.3.6&#39; to make tests self-contained.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright (c) 2007, Galois Inc. All rights reserved.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_263_1_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_14&#39;)"><span class="mpre">charUtf8_list</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_263_1_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_14&#39;)"><span class="hl_vardecl"><span class="mpre">charUtf8_list</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_266_5_266_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_5_266_11&#39;)"><span class="hl_varref"><span class="mpre">encode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">
  where
    </span><a name="loc_266_5_266_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_5_266_11&#39;)"><span class="hl_fundecl"><span class="mpre">encode</span></span></a><span class="mpre"> </span><a name="loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_vardecl"><span class="mpre">oc</span></span></a><span class="mpre">
      | </span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7f</span></span><span class="mpre">       = [</span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre">]

      | </span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7ff</span></span><span class="mpre">      = [ </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)
                           , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                           ]

      | </span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xffff</span></span><span class="mpre">     = [ </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)
                           , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                           , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                           ]
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = [ </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">)
                           , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                           , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                           , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_266_12_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_12_266_14&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                           ]

</span><span class="hl_comment"><span class="mpre">-- ASCII-based encodings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode a &#39;String&#39; of only ASCII characters using the ASCII encoding.</span></span><span class="mpre">
</span><a href="#loc_288_1_288_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_12&#39;)"><span class="mpre">encodeASCII</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_288_1_288_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_12&#39;)"><span class="hl_vardecl"><span class="mpre">encodeASCII</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_291_5_291_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_5_291_11&#39;)"><span class="hl_varref"><span class="mpre">encode</span></span></a><span class="mpre">
  where
    </span><a name="loc_291_5_291_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_5_291_11&#39;)"><span class="hl_fundecl"><span class="mpre">encode</span></span></a><span class="mpre"> </span><a name="loc_291_12_291_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_12_291_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">
      | </span><a href="#loc_291_12_291_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_12_291_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\x7f&#39;</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_291_12_291_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_12_291_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;encodeASCII: non-ASCII character &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_291_12_291_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_12_291_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode an arbitrary &#39;String&#39; by truncating its characters to the least</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- significant 7-bits.</span></span><span class="mpre">
</span><a href="#loc_298_1_298_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_18&#39;)"><span class="mpre">encodeForcedASCII</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_298_1_298_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_18&#39;)"><span class="hl_vardecl"><span class="mpre">encodeForcedASCII</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7f</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">)

</span><a href="#loc_301_1_301_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_11&#39;)"><span class="mpre">char7_list</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_301_1_301_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_11&#39;)"><span class="hl_vardecl"><span class="mpre">char7_list</span></span></a><span class="mpre"> = </span><a href="#loc_298_1_298_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_18&#39;)"><span class="hl_varref"><span class="mpre">encodeForcedASCII</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">

</span><a href="#loc_304_1_304_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_1_304_9&#39;)"><span class="mpre">dec_list</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 303, srcSpanStartColumn = 13, srcSpanEndLine = 303, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 303, srcSpanStartColumn = 20, srcSpanEndLine = 303, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo"><span class="mpre">Show a =&gt;</span></span><span class="mpre">  </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_304_1_304_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_1_304_9&#39;)"><span class="hl_vardecl"><span class="mpre">dec_list</span></span></a><span class="mpre"> = </span><a href="#loc_288_1_288_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASCII</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">

</span><a href="#loc_307_1_307_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_9&#39;)"><span class="mpre">hex_list</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 306, srcSpanStartColumn = 13, srcSpanEndLine = 306, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 306, srcSpanStartColumn = 13, srcSpanEndLine = 306, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename"><span class="mpre">(Integral a, Show a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_307_1_307_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_9&#39;)"><span class="hl_vardecl"><span class="mpre">hex_list</span></span></a><span class="mpre"> = </span><a href="#loc_288_1_288_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASCII</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (\</span><a name="loc_307_28_307_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_28_307_29&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="Numeric.html#loc_228_1_228_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Numeric.html#loc_228_1_228_8&#39;)"><span class="hl_varref"><span class="mpre">showHex</span></span></a><span class="mpre"> </span><a href="#loc_307_28_307_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_28_307_29&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)

</span><a href="#loc_310_1_310_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_18&#39;)"><span class="mpre">wordHexFixed_list</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 22, srcSpanEndLine = 309, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 22, srcSpanEndLine = 309, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename"><span class="mpre">(Storable a, Integral a, Show a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_310_1_310_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_18&#39;)"><span class="hl_fundecl"><span class="mpre">wordHexFixed_list</span></span></a><span class="mpre"> </span><a name="loc_310_19_310_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_19_310_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
   </span><a href="#loc_288_1_288_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASCII</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_313_4_313_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_4_313_7&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> </span><a href="#loc_310_19_310_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_19_310_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Numeric.html#loc_228_1_228_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Numeric.html#loc_228_1_228_8&#39;)"><span class="hl_varref"><span class="mpre">showHex</span></span></a><span class="mpre"> </span><a href="#loc_310_19_310_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_19_310_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
 where
   </span><a name="loc_313_4_313_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_4_313_7&#39;)"><span class="hl_fundecl"><span class="mpre">pad</span></span></a><span class="mpre"> </span><a name="loc_313_8_313_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_8_313_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_313_10_313_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_10_313_12&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> (</span><a href="#loc_313_8_313_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_8_313_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_313_10_313_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_10_313_12&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_313_10_313_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_10_313_12&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

</span><a href="#loc_316_1_316_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_18&#39;)"><span class="mpre">int8HexFixed_list</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int8</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_316_1_316_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_18&#39;)"><span class="hl_vardecl"><span class="mpre">int8HexFixed_list</span></span></a><span class="mpre">  = </span><a href="#loc_310_1_310_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_18&#39;)"><span class="hl_varref"><span class="mpre">wordHexFixed_list</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int8</span></span><span class="mpre">  -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> )

</span><a href="#loc_319_1_319_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_19&#39;)"><span class="mpre">int16HexFixed_list</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int16</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_319_1_319_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_19&#39;)"><span class="hl_vardecl"><span class="mpre">int16HexFixed_list</span></span></a><span class="mpre"> = </span><a href="#loc_310_1_310_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_18&#39;)"><span class="hl_varref"><span class="mpre">wordHexFixed_list</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">)

</span><a href="#loc_322_1_322_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_1_322_19&#39;)"><span class="mpre">int32HexFixed_list</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int32</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_322_1_322_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_1_322_19&#39;)"><span class="hl_vardecl"><span class="mpre">int32HexFixed_list</span></span></a><span class="mpre"> = </span><a href="#loc_310_1_310_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_18&#39;)"><span class="hl_varref"><span class="mpre">wordHexFixed_list</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int32</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">)

</span><a href="#loc_325_1_325_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_1_325_19&#39;)"><span class="mpre">int64HexFixed_list</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int64</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_325_1_325_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_1_325_19&#39;)"><span class="hl_vardecl"><span class="mpre">int64HexFixed_list</span></span></a><span class="mpre"> = </span><a href="#loc_310_1_310_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_18&#39;)"><span class="hl_varref"><span class="mpre">wordHexFixed_list</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">)

</span><a href="#loc_328_1_328_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_19&#39;)"><span class="mpre">floatHexFixed_list</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_328_1_328_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_19&#39;)"><span class="hl_vardecl"><span class="mpre">floatHexFixed_list</span></span></a><span class="mpre">  = </span><a href="#loc_352_1_352_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_1_352_11&#39;)"><span class="hl_varref"><span class="mpre">float_list</span></span></a><span class="mpre"> </span><a href="#loc_310_1_310_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_18&#39;)"><span class="hl_varref"><span class="mpre">wordHexFixed_list</span></span></a><span class="mpre">

</span><a href="#loc_331_1_331_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_1_331_20&#39;)"><span class="mpre">doubleHexFixed_list</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_331_1_331_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_1_331_20&#39;)"><span class="hl_vardecl"><span class="mpre">doubleHexFixed_list</span></span></a><span class="mpre"> = </span><a href="#loc_355_1_355_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_1_355_12&#39;)"><span class="hl_varref"><span class="mpre">double_list</span></span></a><span class="mpre"> </span><a href="#loc_310_1_310_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_18&#39;)"><span class="hl_varref"><span class="mpre">wordHexFixed_list</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Binary</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">---------</span></span><span class="mpre">

</span><a href="#loc_337_1_337_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_1_337_15&#39;)"><span class="mpre">bigEndian_list</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 336, srcSpanStartColumn = 19, srcSpanEndLine = 336, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 336, srcSpanStartColumn = 19, srcSpanEndLine = 336, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename"><span class="mpre">(Storable a, Bits a, Integral a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_337_1_337_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_1_337_15&#39;)"><span class="hl_vardecl"><span class="mpre">bigEndian_list</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_340_1_340_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_1_340_18&#39;)"><span class="hl_varref"><span class="mpre">littleEndian_list</span></span></a><span class="mpre">

</span><a href="#loc_340_1_340_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_1_340_18&#39;)"><span class="mpre">littleEndian_list</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 339, srcSpanStartColumn = 22, srcSpanEndLine = 339, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 339, srcSpanStartColumn = 22, srcSpanEndLine = 339, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename"><span class="mpre">(Storable a, Bits a, Integral a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_340_1_340_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_1_340_18&#39;)"><span class="hl_fundecl"><span class="mpre">littleEndian_list</span></span></a><span class="mpre"> </span><a name="loc_340_19_340_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_19_340_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_340_19_340_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_19_340_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">8</span></span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 341, srcSpanStartColumn = 48, srcSpanEndLine = 341, srcSpanEndColumn = 65}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 341, srcSpanStartColumn = 48, srcSpanEndLine = 341, srcSpanEndColumn = 49},SrcSpan {srcSpanFilen"><span class="mpre">[0..sizeOf x - 1]</span></span><span class="mpre">

</span><a href="#loc_344_1_344_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_16&#39;)"><span class="mpre">hostEndian_list</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 343, srcSpanStartColumn = 20, srcSpanEndLine = 343, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 343, srcSpanStartColumn = 20, srcSpanEndLine = 343, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename"><span class="mpre">(Storable a, Bits a, Integral a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_344_1_344_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_16&#39;)"><span class="hl_vardecl"><span class="mpre">hostEndian_list</span></span></a><span class="mpre"> = case </span><a href="System.ByteOrder.html#loc_42_1_42_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.ByteOrder.html#loc_42_1_42_10&#39;)"><span class="hl_varref"><span class="mpre">byteOrder</span></span></a><span class="mpre"> of
    </span><a href="System.ByteOrder.html#loc_33_7_33_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.ByteOrder.html#loc_33_7_33_19&#39;)"><span class="hl_conref"><span class="mpre">LittleEndian</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_340_1_340_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_1_340_18&#39;)"><span class="hl_varref"><span class="mpre">littleEndian_list</span></span></a><span class="mpre">
    </span><a href="System.ByteOrder.html#loc_32_7_32_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.ByteOrder.html#loc_32_7_32_16&#39;)"><span class="hl_conref"><span class="mpre">BigEndian</span></span></a><span class="mpre">    -&gt; </span><a href="#loc_337_1_337_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_1_337_15&#39;)"><span class="hl_varref"><span class="mpre">bigEndian_list</span></span></a><span class="mpre">
    _            -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;bounded-encoding: unsupported byteorder &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="System.ByteOrder.html#loc_42_1_42_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.ByteOrder.html#loc_42_1_42_10&#39;)"><span class="hl_varref"><span class="mpre">byteOrder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;&quot;</span></span><span class="mpre">


</span><a href="#loc_352_1_352_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_1_352_11&#39;)"><span class="mpre">float_list</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]) -&gt; </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_352_1_352_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_1_352_11&#39;)"><span class="hl_fundecl"><span class="mpre">float_list</span></span></a><span class="mpre"> </span><a name="loc_352_12_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_12_352_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  = </span><a href="#loc_352_12_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_12_352_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_360_1_360_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_1_360_20&#39;)"><span class="hl_varref"><span class="mpre">coerceFloatToWord32</span></span></a><span class="mpre">

</span><a href="#loc_355_1_355_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_1_355_12&#39;)"><span class="mpre">double_list</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]) -&gt; </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_355_1_355_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_1_355_12&#39;)"><span class="hl_fundecl"><span class="mpre">double_list</span></span></a><span class="mpre"> </span><a name="loc_355_13_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_13_355_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_355_13_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_13_355_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_365_1_365_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_21&#39;)"><span class="hl_varref"><span class="mpre">coerceDoubleToWord64</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a &#39;Float&#39; to a &#39;Word32&#39;.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_360_1_360_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_1_360_20&#39;)"><span class="mpre">coerceFloatToWord32</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_360_1_360_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_1_360_20&#39;)"><span class="mpre">coerceFloatToWord32</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
</span><a name="loc_360_1_360_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_1_360_20&#39;)"><span class="hl_fundecl"><span class="mpre">coerceFloatToWord32</span></span></a><span class="mpre"> </span><a name="loc_360_21_360_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_21_360_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">with</span></span><span class="mpre"> </span><a href="#loc_360_21_360_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_21_360_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Convert a &#39;Double&#39; to a &#39;Word64&#39;.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_365_1_365_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_21&#39;)"><span class="mpre">coerceDoubleToWord64</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_365_1_365_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_21&#39;)"><span class="mpre">coerceDoubleToWord64</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
</span><a name="loc_365_1_365_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_21&#39;)"><span class="hl_fundecl"><span class="mpre">coerceDoubleToWord64</span></span></a><span class="mpre"> </span><a name="loc_365_22_365_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_22_365_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">with</span></span><span class="mpre"> </span><a href="#loc_365_22_365_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_22_365_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Parse a variable length encoding</span></span><span class="mpre">
</span><a href="#loc_369_1_369_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_1_369_9&#39;)"><span class="mpre">parseVar</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 368, srcSpanStartColumn = 13, srcSpanEndLine = 368, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/builder/Data/ByteString/Builder/Prim/TestUtils.hs&quot;, srcSpanStartLine = 368, srcSpanStartColumn = 13, srcSpanEndLine = 368, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename"><span class="mpre">(Num a, Bits a) =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">])
</span><a name="loc_369_1_369_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_1_369_9&#39;)"><span class="hl_vardecl"><span class="mpre">parseVar</span></span></a><span class="mpre"> =
    </span><a href="#loc_372_5_372_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_5_372_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_372_5_372_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_5_372_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> []    = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parseVar: unterminated variable length int&quot;</span></span><span class="mpre">
    </span><a href="#loc_372_5_372_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_5_372_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_373_9_373_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_9_373_10&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_373_11_373_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_11_373_13&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)
      | </span><a href="#loc_373_9_373_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_9_373_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_373_9_373_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_9_373_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">, </span><a href="#loc_373_11_373_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_11_373_13&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">)
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = </span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> </span><a href="#loc_377_9_377_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_12&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> (</span><a href="#loc_372_5_372_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_5_372_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_373_11_373_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_11_373_13&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">)
      where
        </span><a name="loc_377_9_377_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_12&#39;)"><span class="hl_fundecl"><span class="mpre">add</span></span></a><span class="mpre"> </span><a name="loc_377_13_377_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_13_377_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_377_13_377_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_13_377_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_373_9_373_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_9_373_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7f</span></span><span class="mpre">)
</span></div></body></html>