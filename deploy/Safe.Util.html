<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Internal utilities.</span></span><span class="mpre">
module Safe.Util where

import Data.Maybe


</span><a href="#loc_9_1_9_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_1_9_5&#39;)"><span class="mpre">(.^)</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a1</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a2</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a1</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a2</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
</span><a name="loc_9_1_9_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_1_9_5&#39;)"><span class="hl_fundecl"><span class="mpre">(.^)</span></span></a><span class="mpre"> </span><a name="loc_9_6_9_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_9_8_9_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_8_9_9&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_9_10_9_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_10_9_12&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_9_13_9_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_13_9_15&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><a href="#loc_9_6_9_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_9_8_9_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_8_9_9&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_9_10_9_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_10_9_12&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_9_13_9_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_13_9_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">)

</span><a href="#loc_12_1_12_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_6&#39;)"><span class="mpre">(.^^)</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a1</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a2</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a3</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a1</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a2</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a3</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
</span><a name="loc_12_1_12_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_6&#39;)"><span class="hl_fundecl"><span class="mpre">(.^^)</span></span></a><span class="mpre"> </span><a name="loc_12_7_12_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_7_12_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_12_9_12_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_9_12_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_12_11_12_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_11_12_13&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_12_14_12_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_14_12_16&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a name="loc_12_17_12_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_17_12_19&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre"> = </span><a href="#loc_12_7_12_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_7_12_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_12_9_12_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_9_12_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_12_11_12_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_11_12_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_12_14_12_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_14_12_16&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a href="#loc_12_17_12_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_17_12_19&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre">)

</span><a href="#loc_15_1_15_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_8&#39;)"><span class="mpre">liftMay</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_15_1_15_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_8&#39;)"><span class="hl_fundecl"><span class="mpre">liftMay</span></span></a><span class="mpre"> </span><a name="loc_15_9_15_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_13&#39;)"><span class="hl_vardecl"><span class="mpre">test</span></span></a><span class="mpre"> </span><a name="loc_15_14_15_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_14_15_18&#39;)"><span class="hl_vardecl"><span class="mpre">func</span></span></a><span class="mpre"> </span><a name="loc_15_19_15_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_19_15_22&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> = if </span><a href="#loc_15_9_15_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_13&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><a href="#loc_15_19_15_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_19_15_22&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> else </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_15_14_15_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_14_15_18&#39;)"><span class="hl_varref"><span class="mpre">func</span></span></a><span class="mpre"> </span><a href="#loc_15_19_15_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_19_15_22&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">

</span><a href="#loc_18_1_18_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_15&#39;)"><span class="mpre">fromNoteModule</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_18_1_18_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_15&#39;)"><span class="hl_fundecl"><span class="mpre">fromNoteModule</span></span></a><span class="mpre"> </span><a name="loc_18_16_18_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_16_18_20&#39;)"><span class="hl_vardecl"><span class="mpre">modu</span></span></a><span class="mpre"> </span><a name="loc_18_21_18_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_25&#39;)"><span class="hl_vardecl"><span class="mpre">note</span></span></a><span class="mpre"> </span><a name="loc_18_26_18_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_26_18_30&#39;)"><span class="hl_vardecl"><span class="mpre">func</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromMaybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><a href="#loc_19_11_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_11_19_14&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">)
    where </span><a name="loc_19_11_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_11_19_14&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><a href="#loc_18_16_18_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_16_18_20&#39;)"><span class="hl_varref"><span class="mpre">modu</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_18_26_18_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_26_18_30&#39;)"><span class="hl_varref"><span class="mpre">func</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_18_21_18_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_25&#39;)"><span class="hl_varref"><span class="mpre">note</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot;, &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_18_21_18_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_25&#39;)"><span class="hl_varref"><span class="mpre">note</span></span></a><span class="mpre">)

</span><a href="#loc_22_1_22_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_21&#39;)"><span class="mpre">fromNoteEitherModule</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_22_1_22_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_21&#39;)"><span class="hl_fundecl"><span class="mpre">fromNoteEitherModule</span></span></a><span class="mpre"> </span><a name="loc_22_22_22_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_22_22_26&#39;)"><span class="hl_vardecl"><span class="mpre">modu</span></span></a><span class="mpre"> </span><a name="loc_22_27_22_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_27_22_31&#39;)"><span class="hl_vardecl"><span class="mpre">note</span></span></a><span class="mpre"> </span><a name="loc_22_32_22_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_32_22_36&#39;)"><span class="hl_vardecl"><span class="mpre">func</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_23_11_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_14&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    where </span><a name="loc_23_11_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_14&#39;)"><span class="hl_fundecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a name="loc_23_15_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_15_23_17&#39;)"><span class="hl_vardecl"><span class="mpre">ex</span></span></a><span class="mpre"> = </span><a href="#loc_22_22_22_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_22_22_26&#39;)"><span class="hl_varref"><span class="mpre">modu</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_22_32_22_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_32_22_36&#39;)"><span class="hl_varref"><span class="mpre">func</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_23_15_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_15_23_17&#39;)"><span class="hl_varref"><span class="mpre">ex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_22_27_22_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_27_22_31&#39;)"><span class="hl_varref"><span class="mpre">note</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot;, &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_22_27_22_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_27_22_31&#39;)"><span class="hl_varref"><span class="mpre">note</span></span></a><span class="mpre">)

</span><a href="#loc_26_1_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_14&#39;)"><span class="mpre">eitherToMaybe</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_26_1_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_14&#39;)"><span class="hl_vardecl"><span class="mpre">eitherToMaybe</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">
</span></div></body></html>