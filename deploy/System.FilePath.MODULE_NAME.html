<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">#if __GLASGOW_HASKELL__ &gt;= 704
{-# LANGUAGE Safe #-}
#endif

</span><span class="hl_comment"><span class="mpre">-- This template expects CPP definitions for:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     MODULE_NAME = Posix | Windows</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     IS_WINDOWS  = False | True</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  System.FilePath.MODULE_NAME</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Neil Mitchell 2005-2007</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A library for FilePath manipulations, using MODULE_NAME style paths on</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- all platforms. Importing &quot;System.FilePath&quot; is usually better.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Some short examples:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- You are given a C file, you want to figure out the corresponding object (.o) file:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @&#39;replaceExtension&#39; file \&quot;o\&quot;@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Haskell module Main imports Test, you have the file named main:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @[&#39;replaceFileName&#39; path_to_main \&quot;Test\&quot; &#39;&lt;.&gt;&#39; ext | ext &lt;- [\&quot;hs\&quot;,\&quot;lhs\&quot;] ]@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- You want to download a file from the web and save it to disk:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @do let file = &#39;makeValid&#39; url</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    System.IO.createDirectoryIfMissing True (&#39;takeDirectory&#39; file)@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- You want to compile a Haskell file, but put the hi file under \&quot;interface\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @&#39;takeDirectory&#39; file &#39;&lt;/&gt;&#39; \&quot;interface\&quot; &#39;&lt;/&gt;&#39; (&#39;takeFileName&#39; file \`replaceExtension\` \&quot;hi\&quot;@)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The examples in code format descibed by each function are used to generate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- tests, and should give clear semantics for the functions.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module System.FilePath.MODULE_NAME
    (
    </span><span class="hl_comment"><span class="mpre">-- * Separator predicates</span></span><span class="mpre">
    FilePath,
    pathSeparator, pathSeparators, isPathSeparator,
    searchPathSeparator, isSearchPathSeparator,
    extSeparator, isExtSeparator,

    </span><span class="hl_comment"><span class="mpre">-- * Path methods (environment $PATH)</span></span><span class="mpre">
    splitSearchPath, getSearchPath,

    </span><span class="hl_comment"><span class="mpre">-- * Extension methods</span></span><span class="mpre">
    splitExtension,
    takeExtension, replaceExtension, dropExtension, addExtension, hasExtension, (&lt;.&gt;),
    splitExtensions, dropExtensions, takeExtensions,

    </span><span class="hl_comment"><span class="mpre">-- * Drive methods</span></span><span class="mpre">
    splitDrive, joinDrive,
    takeDrive, hasDrive, dropDrive, isDrive,

    </span><span class="hl_comment"><span class="mpre">-- * Operations on a FilePath, as a list of directories</span></span><span class="mpre">
    splitFileName,
    takeFileName, replaceFileName, dropFileName,
    takeBaseName, replaceBaseName,
    takeDirectory, replaceDirectory,
    combine, (&lt;/&gt;),
    splitPath, joinPath, splitDirectories,

    </span><span class="hl_comment"><span class="mpre">-- * Low level FilePath operators</span></span><span class="mpre">
    hasTrailingPathSeparator,
    addTrailingPathSeparator,
    dropTrailingPathSeparator,

    </span><span class="hl_comment"><span class="mpre">-- * File name manipulators</span></span><span class="mpre">
    normalise, equalFilePath,
    makeRelative,
    isRelative, isAbsolute,
    isValid, makeValid

#ifdef TESTING
    , isRelativeDrive
#endif

    )
    where

import Data.Char(toLower, toUpper, isAsciiLower, isAsciiUpper)
import Data.Maybe(isJust, fromJust)
import Data.List(isPrefixOf)

import System.Environment(getEnv)


</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/filepath-1.3.0.2/System/FilePath/Internal.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 1, srcSpanEndLine = 97, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/filepath-1.3.0.2/System/FilePath/Internal.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 8, srcSpanEndLine = 97, srcSpanEndColumn = 9}]}) (AssocRight (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">infixr 7  &lt;.&gt;</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/filepath-1.3.0.2/System/FilePath/Internal.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 1, srcSpanEndLine = 98, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/filepath-1.3.0.2/System/FilePath/Internal.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 8, srcSpanEndLine = 98, srcSpanEndColumn = 9}]}) (AssocRight (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">infixr 5  &lt;/&gt;</span></span><span class="mpre">





</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Platform Abstraction Methods (private)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Is the operating system Unix or Linux like</span></span><span class="mpre">
</span><a href="#loc_109_1_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_8&#39;)"><span class="mpre">isPosix</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_109_1_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_8&#39;)"><span class="hl_vardecl"><span class="mpre">isPosix</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="hl_varref"><span class="mpre">isWindows</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Is the operating system Windows like</span></span><span class="mpre">
</span><a href="#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="mpre">isWindows</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="hl_vardecl"><span class="mpre">isWindows</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">IS_WINDOWS</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The basic functions</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The character that separates directories. In the case where more than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   one character is possible, &#39;pathSeparator&#39; is the \&#39;ideal\&#39; one.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: pathSeparator == &#39;\\&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   pathSeparator ==  &#39;/&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; isPathSeparator pathSeparator</span></span><span class="mpre">
</span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="mpre">pathSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_vardecl"><span class="mpre">pathSeparator</span></span></a><span class="mpre"> = if </span><a href="#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="hl_varref"><span class="mpre">isWindows</span></span></a><span class="mpre"> then </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="mpre"> else </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The list of all possible separators.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: pathSeparators == [&#39;\\&#39;, &#39;/&#39;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   pathSeparators == [&#39;/&#39;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; pathSeparator `elem` pathSeparators</span></span><span class="mpre">
</span><a href="#loc_134_1_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_15&#39;)"><span class="mpre">pathSeparators</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
</span><a name="loc_134_1_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_15&#39;)"><span class="hl_vardecl"><span class="mpre">pathSeparators</span></span></a><span class="mpre"> = if </span><a href="#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="hl_varref"><span class="mpre">isWindows</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;\\/&quot;</span></span><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Rather than using @(== &#39;pathSeparator&#39;)@, use this. Test if something</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   is a path separator.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; isPathSeparator a == (a `elem` pathSeparators)</span></span><span class="mpre">
</span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="mpre">isPathSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_vardecl"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> = (</span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_134_1_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_15&#39;)"><span class="hl_varref"><span class="mpre">pathSeparators</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | The character that is used to separate the entries in the $PATH environment variable.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: searchPathSeparator == &#39;;&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   searchPathSeparator == &#39;:&#39;</span></span><span class="mpre">
</span><a href="#loc_149_1_149_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_20&#39;)"><span class="mpre">searchPathSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_149_1_149_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_20&#39;)"><span class="hl_vardecl"><span class="mpre">searchPathSeparator</span></span></a><span class="mpre"> = if </span><a href="#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="hl_varref"><span class="mpre">isWindows</span></span></a><span class="mpre"> then </span><span class="hl_char"><span class="mpre">&#39;;&#39;</span></span><span class="mpre"> else </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Is the character a file separator?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; isSearchPathSeparator a == (a == searchPathSeparator)</span></span><span class="mpre">
</span><a href="#loc_155_1_155_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_22&#39;)"><span class="mpre">isSearchPathSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_155_1_155_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_22&#39;)"><span class="hl_vardecl"><span class="mpre">isSearchPathSeparator</span></span></a><span class="mpre"> = (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_149_1_149_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_20&#39;)"><span class="hl_varref"><span class="mpre">searchPathSeparator</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | File extension character</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; extSeparator == &#39;.&#39;</span></span><span class="mpre">
</span><a href="#loc_162_1_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_13&#39;)"><span class="mpre">extSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_162_1_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_13&#39;)"><span class="hl_vardecl"><span class="mpre">extSeparator</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Is the character an extension character?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; isExtSeparator a == (a == extSeparator)</span></span><span class="mpre">
</span><a href="#loc_168_1_168_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_15&#39;)"><span class="mpre">isExtSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_168_1_168_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_15&#39;)"><span class="hl_vardecl"><span class="mpre">isExtSeparator</span></span></a><span class="mpre"> = (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_162_1_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_13&#39;)"><span class="hl_varref"><span class="mpre">extSeparator</span></span></a><span class="mpre">)




</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Path methods (environment $PATH)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Take a string, split it on the &#39;searchPathSeparator&#39; character.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Follows the recommendations in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &lt;http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap08.html&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   splitSearchPath &quot;File1:File2:File3&quot;  == [&quot;File1&quot;,&quot;File2&quot;,&quot;File3&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   splitSearchPath &quot;File1::File2:File3&quot; == [&quot;File1&quot;,&quot;.&quot;,&quot;File2&quot;,&quot;File3&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitSearchPath &quot;File1;File2;File3&quot;  == [&quot;File1&quot;,&quot;File2&quot;,&quot;File3&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitSearchPath &quot;File1;;File2;File3&quot; == [&quot;File1&quot;,&quot;File2&quot;,&quot;File3&quot;]</span></span><span class="mpre">
</span><a href="#loc_186_1_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_16&#39;)"><span class="mpre">splitSearchPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
</span><a name="loc_186_1_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_16&#39;)"><span class="hl_vardecl"><span class="mpre">splitSearchPath</span></span></a><span class="mpre"> = </span><a href="#loc_188_5_188_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_5_188_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
    where
    </span><a name="loc_188_5_188_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_5_188_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_188_7_188_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_9&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> </span><a href="#loc_155_1_155_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_22&#39;)"><span class="hl_varref"><span class="mpre">isSearchPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_188_7_188_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_9&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
           (</span><a name="loc_189_13_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_13_189_16&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, []    ) -&gt; </span><a href="#loc_192_5_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_5_192_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_189_13_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_13_189_16&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre">
           (</span><a name="loc_190_13_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_13_190_16&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, _</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_190_20_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_24&#39;)"><span class="hl_vardecl"><span class="mpre">post</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_192_5_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_5_192_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_190_13_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_13_190_16&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_188_5_188_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_5_188_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_190_20_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_24&#39;)"><span class="hl_varref"><span class="mpre">post</span></span></a><span class="mpre">

    </span><a name="loc_192_5_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_5_192_6&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = [</span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> | </span><a href="#loc_109_1_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_8&#39;)"><span class="hl_varref"><span class="mpre">isPosix</span></span></a><span class="mpre">]
    </span><a href="#loc_192_5_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_5_192_6&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_193_7_193_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_7_193_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = [</span><a href="#loc_193_7_193_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_7_193_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">-- | Get a list of filepaths in the $PATH.</span></span><span class="mpre">
</span><a href="#loc_198_1_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_14&#39;)"><span class="mpre">getSearchPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
</span><a name="loc_198_1_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_14&#39;)"><span class="hl_vardecl"><span class="mpre">getSearchPath</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_186_1_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_16&#39;)"><span class="hl_varref"><span class="mpre">splitSearchPath</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">getEnv</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;PATH&quot;</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Extension methods</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Split on the extension. &#39;addExtension&#39; is the inverse.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; uncurry (++) (splitExtension x) == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; uncurry addExtension (splitExtension x) == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitExtension &quot;file.txt&quot; == (&quot;file&quot;,&quot;.txt&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitExtension &quot;file&quot; == (&quot;file&quot;,&quot;&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitExtension &quot;file/file.txt&quot; == (&quot;file/file&quot;,&quot;.txt&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitExtension &quot;file.txt/boris&quot; == (&quot;file.txt/boris&quot;,&quot;&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitExtension &quot;file.txt/boris.ext&quot; == (&quot;file.txt/boris&quot;,&quot;.ext&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitExtension &quot;file/path.txt.bob.fred&quot; == (&quot;file/path.txt.bob&quot;,&quot;.fred&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitExtension &quot;file/path.txt/&quot; == (&quot;file/path.txt/&quot;,&quot;&quot;)</span></span><span class="mpre">
</span><a href="#loc_216_1_216_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_15&#39;)"><span class="mpre">splitExtension</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_216_1_216_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_15&#39;)"><span class="hl_fundecl"><span class="mpre">splitExtension</span></span></a><span class="mpre"> </span><a name="loc_216_16_216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_16_216_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = case </span><a href="#loc_221_12_221_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_12_221_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> of
                       </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> -&gt; (</span><a href="#loc_216_16_216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_16_216_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)
                       (</span><a name="loc_218_25_218_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_25_218_26&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_218_27_218_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_27_218_29&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_220_10_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_10_220_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_218_27_218_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_27_218_29&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">, </span><a href="#loc_218_25_218_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_25_218_26&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_221_10_221_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_10_221_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
    where
        (</span><a name="loc_220_10_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_10_220_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_220_12_220_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_12_220_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_444_1_444_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_15&#39;)"><span class="hl_varref"><span class="mpre">splitFileName_</span></span></a><span class="mpre"> </span><a href="#loc_216_16_216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_16_216_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        (</span><a name="loc_221_10_221_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_10_221_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_221_12_221_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_12_221_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> </span><a href="#loc_168_1_168_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_15&#39;)"><span class="hl_varref"><span class="mpre">isExtSeparator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_220_12_220_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_12_220_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the extension of a file, returns @\&quot;\&quot;@ for no extension, @.ext@ otherwise.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeExtension x == snd (splitExtension x)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; takeExtension (addExtension x &quot;ext&quot;) == &quot;.ext&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; takeExtension (replaceExtension x &quot;ext&quot;) == &quot;.ext&quot;</span></span><span class="mpre">
</span><a href="#loc_229_1_229_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_14&#39;)"><span class="mpre">takeExtension</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_229_1_229_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_14&#39;)"><span class="hl_vardecl"><span class="mpre">takeExtension</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_216_1_216_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_15&#39;)"><span class="hl_varref"><span class="mpre">splitExtension</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Set the extension of a file, overwriting one if already present.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceExtension &quot;file.txt&quot; &quot;.bob&quot; == &quot;file.bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceExtension &quot;file.txt&quot; &quot;bob&quot; == &quot;file.bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceExtension &quot;file&quot; &quot;.bob&quot; == &quot;file.bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceExtension &quot;file.txt&quot; &quot;&quot; == &quot;file&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceExtension &quot;file.fred.bob&quot; &quot;txt&quot; == &quot;file.fred.txt&quot;</span></span><span class="mpre">
</span><a href="#loc_239_1_239_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_17&#39;)"><span class="mpre">replaceExtension</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_239_1_239_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_17&#39;)"><span class="hl_fundecl"><span class="mpre">replaceExtension</span></span></a><span class="mpre"> </span><a name="loc_239_18_239_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_18_239_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_239_20_239_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_20_239_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="hl_varref"><span class="mpre">dropExtension</span></span></a><span class="mpre"> </span><a href="#loc_239_18_239_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_18_239_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_243_1_243_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span></a><span class="mpre"> </span><a href="#loc_239_20_239_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_20_239_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Alias to &#39;addExtension&#39;, for people who like that sort of thing.</span></span><span class="mpre">
</span><a href="#loc_243_1_243_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_6&#39;)"><span class="mpre">(&lt;.&gt;)</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_243_1_243_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_6&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;.&gt;)</span></span></a><span class="mpre"> = </span><a href="#loc_261_1_261_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_13&#39;)"><span class="hl_varref"><span class="mpre">addExtension</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Remove last extension, and the \&quot;.\&quot; preceding it.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; dropExtension x == fst (splitExtension x)</span></span><span class="mpre">
</span><a href="#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="mpre">dropExtension</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="hl_vardecl"><span class="mpre">dropExtension</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_216_1_216_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_15&#39;)"><span class="hl_varref"><span class="mpre">splitExtension</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Add an extension, even if there is already one there.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   E.g. @addExtension \&quot;foo.txt\&quot; \&quot;bat\&quot; -&gt; \&quot;foo.txt.bat\&quot;@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; addExtension &quot;file.txt&quot; &quot;bib&quot; == &quot;file.txt.bib&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; addExtension &quot;file.&quot; &quot;.bib&quot; == &quot;file..bib&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; addExtension &quot;file&quot; &quot;.bib&quot; == &quot;file.bib&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; addExtension &quot;/&quot; &quot;x&quot; == &quot;/.x&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; takeFileName (addExtension (addTrailingPathSeparator x) &quot;ext&quot;) == &quot;.ext&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: addExtension &quot;\\\\share&quot; &quot;.txt&quot; == &quot;\\\\share\\.txt&quot;</span></span><span class="mpre">
</span><a href="#loc_261_1_261_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_13&#39;)"><span class="mpre">addExtension</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_261_1_261_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_13&#39;)"><span class="hl_fundecl"><span class="mpre">addExtension</span></span></a><span class="mpre"> </span><a name="loc_261_14_261_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_14_261_18&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = </span><a href="#loc_261_14_261_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_14_261_18&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
</span><a href="#loc_261_1_261_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_13&#39;)"><span class="hl_fundecl"><span class="mpre">addExtension</span></span></a><span class="mpre"> </span><a name="loc_262_14_262_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_14_262_18&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> </span><a name="loc_262_19_262_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_19_262_21&#39;)"><span class="hl_specname"><span class="mpre">xs</span></span></a><span class="mpre">@(</span><a name="loc_262_23_262_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_23_262_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="#loc_388_1_388_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_10&#39;)"><span class="hl_varref"><span class="mpre">joinDrive</span></span></a><span class="mpre"> </span><a href="#loc_267_10_267_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_10_267_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_264_9_264_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_9_264_12&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
    where
        </span><a name="loc_264_9_264_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_9_264_12&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = if </span><a href="#loc_168_1_168_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_15&#39;)"><span class="hl_varref"><span class="mpre">isExtSeparator</span></span></a><span class="mpre"> </span><a href="#loc_262_23_262_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_23_262_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><a href="#loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_262_19_262_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_19_262_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
              else </span><a href="#loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_162_1_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_13&#39;)"><span class="hl_varref"><span class="mpre">extSeparator</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_262_19_262_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_19_262_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

        (</span><a name="loc_267_10_267_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_10_267_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_varref"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a href="#loc_262_14_262_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_14_262_18&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Does the given filename have an extension?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; null (takeExtension x) == not (hasExtension x)</span></span><span class="mpre">
</span><a href="#loc_273_1_273_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_13&#39;)"><span class="mpre">hasExtension</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_273_1_273_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_13&#39;)"><span class="hl_vardecl"><span class="mpre">hasExtension</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> </span><a href="#loc_168_1_168_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_15&#39;)"><span class="hl_varref"><span class="mpre">isExtSeparator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_471_1_471_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_1_471_13&#39;)"><span class="hl_varref"><span class="mpre">takeFileName</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Split on all extensions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; uncurry (++) (splitExtensions x) == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; uncurry addExtension (splitExtensions x) == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitExtensions &quot;file.tar.gz&quot; == (&quot;file&quot;,&quot;.tar.gz&quot;)</span></span><span class="mpre">
</span><a href="#loc_282_1_282_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_16&#39;)"><span class="mpre">splitExtensions</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_282_1_282_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_16&#39;)"><span class="hl_fundecl"><span class="mpre">splitExtensions</span></span></a><span class="mpre"> </span><a name="loc_282_17_282_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_284_10_284_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_10_284_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_285_10_285_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_10_285_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="#loc_285_12_285_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_12_285_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
    where
        (</span><a name="loc_284_10_284_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_10_284_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_284_12_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_12_284_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_444_1_444_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_15&#39;)"><span class="hl_varref"><span class="mpre">splitFileName_</span></span></a><span class="mpre"> </span><a href="#loc_282_17_282_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        (</span><a name="loc_285_10_285_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_10_285_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_285_12_285_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_12_285_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> </span><a href="#loc_168_1_168_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_15&#39;)"><span class="hl_varref"><span class="mpre">isExtSeparator</span></span></a><span class="mpre"> </span><a href="#loc_284_12_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_12_284_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Drop all extensions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; not $ hasExtension (dropExtensions x)</span></span><span class="mpre">
</span><a href="#loc_291_1_291_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_15&#39;)"><span class="mpre">dropExtensions</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_291_1_291_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_15&#39;)"><span class="hl_vardecl"><span class="mpre">dropExtensions</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_282_1_282_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_16&#39;)"><span class="hl_varref"><span class="mpre">splitExtensions</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get all extensions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeExtensions &quot;file.tar.gz&quot; == &quot;.tar.gz&quot;</span></span><span class="mpre">
</span><a href="#loc_297_1_297_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_15&#39;)"><span class="mpre">takeExtensions</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_297_1_297_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_15&#39;)"><span class="hl_vardecl"><span class="mpre">takeExtensions</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_282_1_282_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_16&#39;)"><span class="hl_varref"><span class="mpre">splitExtensions</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Drive methods</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Is the given character a valid drive letter?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- only a-z and A-Z are letters, not isAlpha which is more unicodey</span></span><span class="mpre">
</span><a href="#loc_307_1_307_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_9&#39;)"><span class="mpre">isLetter</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_307_1_307_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_9&#39;)"><span class="hl_fundecl"><span class="mpre">isLetter</span></span></a><span class="mpre"> </span><a name="loc_307_10_307_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_10_307_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">isAsciiLower</span></span><span class="mpre"> </span><a href="#loc_307_10_307_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_10_307_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isAsciiUpper</span></span><span class="mpre"> </span><a href="#loc_307_10_307_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_10_307_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Split a path into a drive and a path.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   On Unix, \/ is a Drive.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; uncurry (++) (splitDrive x) == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitDrive &quot;file&quot; == (&quot;&quot;,&quot;file&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitDrive &quot;c:/file&quot; == (&quot;c:/&quot;,&quot;file&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitDrive &quot;c:\\file&quot; == (&quot;c:\\&quot;,&quot;file&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitDrive &quot;\\\\shared\\test&quot; == (&quot;\\\\shared\\&quot;,&quot;test&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitDrive &quot;\\\\shared&quot; == (&quot;\\\\shared&quot;,&quot;&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitDrive &quot;\\\\?\\UNC\\shared\\file&quot; == (&quot;\\\\?\\UNC\\shared\\&quot;,&quot;file&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitDrive &quot;\\\\?\\UNCshared\\file&quot; == (&quot;\\\\?\\&quot;,&quot;UNCshared\\file&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitDrive &quot;\\\\?\\d:\\file&quot; == (&quot;\\\\?\\d:\\&quot;,&quot;file&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitDrive &quot;/d&quot; == (&quot;&quot;,&quot;/d&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   splitDrive &quot;/test&quot; == (&quot;/&quot;,&quot;test&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   splitDrive &quot;//test&quot; == (&quot;//&quot;,&quot;test&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   splitDrive &quot;test/file&quot; == (&quot;&quot;,&quot;test/file&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   splitDrive &quot;file&quot; == (&quot;&quot;,&quot;file&quot;)</span></span><span class="mpre">
</span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="mpre">splitDrive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_fundecl"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a name="loc_328_12_328_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_12_328_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_109_1_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_8&#39;)"><span class="hl_varref"><span class="mpre">isPosix</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">) </span><a href="#loc_328_12_328_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_12_328_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_fundecl"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a name="loc_330_12_330_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_12_330_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">isJust</span></span><span class="mpre"> </span><a href="#loc_331_11_331_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_11_331_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromJust</span></span><span class="mpre"> </span><a href="#loc_331_11_331_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_11_331_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
    where </span><a name="loc_331_11_331_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_11_331_12&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_361_1_361_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_16&#39;)"><span class="hl_varref"><span class="mpre">readDriveLetter</span></span></a><span class="mpre"> </span><a href="#loc_330_12_330_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_12_330_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_fundecl"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a name="loc_333_12_333_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_12_333_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">isJust</span></span><span class="mpre"> </span><a href="#loc_334_11_334_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_11_334_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromJust</span></span><span class="mpre"> </span><a href="#loc_334_11_334_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_11_334_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
    where </span><a name="loc_334_11_334_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_11_334_12&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_349_1_349_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_13&#39;)"><span class="hl_varref"><span class="mpre">readDriveUNC</span></span></a><span class="mpre"> </span><a href="#loc_333_12_333_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_12_333_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_fundecl"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a name="loc_336_12_336_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_12_336_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">isJust</span></span><span class="mpre"> </span><a href="#loc_337_11_337_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_11_337_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromJust</span></span><span class="mpre"> </span><a href="#loc_337_11_337_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_11_337_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
    where </span><a name="loc_337_11_337_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_11_337_12&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_367_1_367_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_15&#39;)"><span class="hl_varref"><span class="mpre">readDriveShare</span></span></a><span class="mpre"> </span><a href="#loc_336_12_336_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_12_336_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_fundecl"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a name="loc_339_12_339_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_12_339_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">,</span><a href="#loc_339_12_339_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_12_339_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><a href="#loc_342_1_342_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_9&#39;)"><span class="mpre">addSlash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_342_1_342_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_9&#39;)"><span class="hl_fundecl"><span class="mpre">addSlash</span></span></a><span class="mpre"> </span><a name="loc_342_10_342_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_10_342_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_342_12_342_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_12_342_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = (</span><a href="#loc_342_10_342_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_10_342_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_343_12_343_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_12_343_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">,</span><a href="#loc_343_14_343_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_14_343_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
    where (</span><a name="loc_343_12_343_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_12_343_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_343_14_343_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_14_343_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_342_12_342_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_12_342_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/naming_a_file.asp</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;\\?\D:\&lt;path&gt;&quot; or &quot;\\?\UNC\&lt;server&gt;\&lt;share&gt;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a is &quot;\\?\&quot;</span></span><span class="mpre">
</span><a href="#loc_349_1_349_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_13&#39;)"><span class="mpre">readDriveUNC</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_349_1_349_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_13&#39;)"><span class="hl_fundecl"><span class="mpre">readDriveUNC</span></span></a><span class="mpre"> (</span><a name="loc_349_15_349_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_15_349_17&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_349_18_349_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_20&#39;)"><span class="hl_vardecl"><span class="mpre">s2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_349_25_349_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_25_349_27&#39;)"><span class="hl_vardecl"><span class="mpre">s3</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_349_28_349_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_28_349_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> [</span><a href="#loc_349_15_349_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_15_349_17&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre">,</span><a href="#loc_349_18_349_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_20&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="mpre">,</span><a href="#loc_349_25_349_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_25_349_27&#39;)"><span class="hl_varref"><span class="mpre">s3</span></span></a><span class="mpre">] =
    case </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toUpper</span></span><span class="mpre"> </span><a href="#loc_349_28_349_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_28_349_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
        (</span><span class="hl_char"><span class="mpre">&#39;U&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;N&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;C&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_351_22_351_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_22_351_24&#39;)"><span class="hl_vardecl"><span class="mpre">s4</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) | </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_351_22_351_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_22_351_24&#39;)"><span class="hl_varref"><span class="mpre">s4</span></span></a><span class="mpre"> -&gt;
            let (</span><a name="loc_352_18_352_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_18_352_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_352_20_352_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_20_352_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_375_1_375_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_1_375_19&#39;)"><span class="hl_varref"><span class="mpre">readDriveShareName</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_349_28_349_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_28_349_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
            in </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_349_15_349_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_15_349_17&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_349_18_349_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_20&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_349_25_349_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_25_349_27&#39;)"><span class="hl_varref"><span class="mpre">s3</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_349_28_349_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_28_349_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_352_18_352_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_18_352_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_352_20_352_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_20_352_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        _ -&gt; case </span><a href="#loc_361_1_361_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_16&#39;)"><span class="hl_varref"><span class="mpre">readDriveLetter</span></span></a><span class="mpre"> </span><a href="#loc_349_28_349_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_28_349_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                 </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_355_24_355_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_24_355_25&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_355_26_355_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_26_355_27&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_349_15_349_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_15_349_17&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_349_18_349_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_20&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_349_25_349_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_25_349_27&#39;)"><span class="hl_varref"><span class="mpre">s3</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_355_24_355_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_24_355_25&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_355_26_355_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_26_355_27&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
                 </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_349_1_349_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_13&#39;)"><span class="hl_fundecl"><span class="mpre">readDriveUNC</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- c:\ -}</span></span><span class="mpre">
</span><a href="#loc_361_1_361_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_16&#39;)"><span class="mpre">readDriveLetter</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_361_1_361_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_16&#39;)"><span class="hl_fundecl"><span class="mpre">readDriveLetter</span></span></a><span class="mpre"> (</span><a name="loc_361_18_361_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_18_361_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_361_24_361_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_24_361_25&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_361_26_361_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_26_361_28&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><a href="#loc_307_1_307_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_9&#39;)"><span class="hl_varref"><span class="mpre">isLetter</span></span></a><span class="mpre"> </span><a href="#loc_361_18_361_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_18_361_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_361_24_361_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_24_361_25&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_342_1_342_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_9&#39;)"><span class="hl_varref"><span class="mpre">addSlash</span></span></a><span class="mpre"> [</span><a href="#loc_361_18_361_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_18_361_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">] (</span><a href="#loc_361_24_361_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_24_361_25&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_361_26_361_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_26_361_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
</span><a href="#loc_361_1_361_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_16&#39;)"><span class="hl_fundecl"><span class="mpre">readDriveLetter</span></span></a><span class="mpre"> (</span><a name="loc_362_18_362_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_18_362_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_362_24_362_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_24_362_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><a href="#loc_307_1_307_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_9&#39;)"><span class="hl_varref"><span class="mpre">isLetter</span></span></a><span class="mpre"> </span><a href="#loc_362_18_362_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_18_362_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> ([</span><a href="#loc_362_18_362_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_18_362_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">], </span><a href="#loc_362_24_362_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_24_362_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
</span><a href="#loc_361_1_361_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_16&#39;)"><span class="hl_fundecl"><span class="mpre">readDriveLetter</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- \\sharename\ -}</span></span><span class="mpre">
</span><a href="#loc_367_1_367_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_15&#39;)"><span class="mpre">readDriveShare</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_367_1_367_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_15&#39;)"><span class="hl_fundecl"><span class="mpre">readDriveShare</span></span></a><span class="mpre"> (</span><a name="loc_367_17_367_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_17_367_19&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_367_20_367_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_20_367_22&#39;)"><span class="hl_vardecl"><span class="mpre">s2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_367_23_367_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_23_367_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_367_17_367_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_17_367_19&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_367_20_367_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_20_367_22&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="mpre"> =
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_367_17_367_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_17_367_19&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_367_20_367_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_20_367_22&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_369_12_369_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_12_369_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_369_14_369_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_14_369_15&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
    where (</span><a name="loc_369_12_369_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_12_369_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_369_14_369_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_14_369_15&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_375_1_375_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_1_375_19&#39;)"><span class="hl_varref"><span class="mpre">readDriveShareName</span></span></a><span class="mpre"> </span><a href="#loc_367_23_367_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_23_367_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
</span><a href="#loc_367_1_367_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_15&#39;)"><span class="hl_fundecl"><span class="mpre">readDriveShare</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- assume you have already seen \\ -}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{- share\bob -&gt; &quot;share&quot;,&quot;\&quot;,&quot;bob&quot; -}</span></span><span class="mpre">
</span><a href="#loc_375_1_375_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_1_375_19&#39;)"><span class="mpre">readDriveShareName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_375_1_375_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_1_375_19&#39;)"><span class="hl_fundecl"><span class="mpre">readDriveShareName</span></span></a><span class="mpre"> </span><a name="loc_375_20_375_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_20_375_24&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> = </span><a href="#loc_342_1_342_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_9&#39;)"><span class="hl_varref"><span class="mpre">addSlash</span></span></a><span class="mpre"> </span><a href="#loc_376_12_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_376_14_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_15&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
    where (</span><a name="loc_376_12_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_376_14_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_15&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_375_20_375_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_20_375_24&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- | Join a drive and the rest of the path.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          uncurry joinDrive (splitDrive x) == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: joinDrive &quot;C:&quot; &quot;foo&quot; == &quot;C:foo&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: joinDrive &quot;C:\\&quot; &quot;bar&quot; == &quot;C:\\bar&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: joinDrive &quot;\\\\share&quot; &quot;foo&quot; == &quot;\\\\share\\foo&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: joinDrive &quot;/:&quot; &quot;foo&quot; == &quot;/:\\foo&quot;</span></span><span class="mpre">
</span><a href="#loc_388_1_388_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_10&#39;)"><span class="mpre">joinDrive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_388_1_388_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_10&#39;)"><span class="hl_fundecl"><span class="mpre">joinDrive</span></span></a><span class="mpre"> </span><a name="loc_388_11_388_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_11_388_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_388_13_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_13_388_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> | </span><a href="#loc_109_1_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_8&#39;)"><span class="hl_varref"><span class="mpre">isPosix</span></span></a><span class="mpre"> = </span><a href="#loc_388_11_388_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_11_388_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_388_13_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_13_388_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_388_11_388_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_11_388_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_388_13_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_13_388_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_388_13_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_13_388_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_388_11_388_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_11_388_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
              | </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_388_11_388_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_11_388_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_388_11_388_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_11_388_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_388_13_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_13_388_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = case </span><a href="#loc_388_11_388_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_11_388_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> of
                                [</span><a name="loc_393_34_393_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_34_393_36&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre">,</span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">] | </span><a href="#loc_307_1_307_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_9&#39;)"><span class="hl_varref"><span class="mpre">isLetter</span></span></a><span class="mpre"> </span><a href="#loc_393_34_393_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_34_393_36&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_388_11_388_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_11_388_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_388_13_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_13_388_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                                _ -&gt; </span><a href="#loc_388_11_388_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_11_388_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_388_13_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_13_388_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the drive from a filepath.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeDrive x == fst (splitDrive x)</span></span><span class="mpre">
</span><a href="#loc_400_1_400_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_10&#39;)"><span class="mpre">takeDrive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_400_1_400_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_10&#39;)"><span class="hl_vardecl"><span class="mpre">takeDrive</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_varref"><span class="mpre">splitDrive</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Delete the drive, if it exists.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; dropDrive x == snd (splitDrive x)</span></span><span class="mpre">
</span><a href="#loc_406_1_406_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_10&#39;)"><span class="mpre">dropDrive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_406_1_406_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_10&#39;)"><span class="hl_vardecl"><span class="mpre">dropDrive</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_varref"><span class="mpre">splitDrive</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Does a path have a drive.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; not (hasDrive x) == null (takeDrive x)</span></span><span class="mpre">
</span><a href="#loc_412_1_412_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_9&#39;)"><span class="mpre">hasDrive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_412_1_412_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_9&#39;)"><span class="hl_vardecl"><span class="mpre">hasDrive</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_400_1_400_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_10&#39;)"><span class="hl_varref"><span class="mpre">takeDrive</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Is an element a drive</span></span><span class="mpre">
</span><a href="#loc_417_1_417_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_8&#39;)"><span class="mpre">isDrive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_417_1_417_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_8&#39;)"><span class="hl_vardecl"><span class="mpre">isDrive</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_406_1_406_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_10&#39;)"><span class="hl_varref"><span class="mpre">dropDrive</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Operations on a filepath, as a list of directories</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Split a filename into directory and file. &#39;combine&#39; is the inverse.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; uncurry (&lt;/&gt;) (splitFileName x) == x || fst (splitFileName x) == &quot;./&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; isValid (fst (splitFileName x))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitFileName &quot;file/bob.txt&quot; == (&quot;file/&quot;, &quot;bob.txt&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitFileName &quot;file/&quot; == (&quot;file/&quot;, &quot;&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitFileName &quot;bob&quot; == (&quot;./&quot;, &quot;bob&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   splitFileName &quot;/&quot; == (&quot;/&quot;,&quot;&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitFileName &quot;c:&quot; == (&quot;c:&quot;,&quot;&quot;)</span></span><span class="mpre">
</span><a href="#loc_433_1_433_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_1_433_14&#39;)"><span class="mpre">splitFileName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_433_1_433_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_1_433_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitFileName</span></span></a><span class="mpre"> </span><a name="loc_433_15_433_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_15_433_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_435_10_435_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_10_435_13&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;./&quot;</span></span><span class="mpre"> else </span><a href="#loc_435_10_435_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_10_435_13&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">, </span><a href="#loc_435_15_435_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_15_435_19&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">)
    where
        (</span><a name="loc_435_10_435_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_10_435_13&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre">, </span><a name="loc_435_15_435_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_15_435_19&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">) = </span><a href="#loc_444_1_444_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_15&#39;)"><span class="hl_varref"><span class="mpre">splitFileName_</span></span></a><span class="mpre"> </span><a href="#loc_433_15_433_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_15_433_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- version of splitFileName where, if the FilePath has no directory</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- component, the returned directory is &quot;&quot; rather than &quot;./&quot;.  This</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is used in cases where we are going to combine the returned</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- directory to make a valid FilePath, and having a &quot;./&quot; appear would</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- look strange and upset simple equality properties.  See</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- e.g. replaceFileName.</span></span><span class="mpre">
</span><a href="#loc_444_1_444_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_15&#39;)"><span class="mpre">splitFileName_</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_444_1_444_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_15&#39;)"><span class="hl_fundecl"><span class="mpre">splitFileName_</span></span></a><span class="mpre"> </span><a name="loc_444_16_444_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_16_444_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_447_10_447_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_10_447_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_446_12_446_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_12_446_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_446_10_446_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_10_446_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
    where
        (</span><a name="loc_446_10_446_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_10_446_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_446_12_446_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_12_446_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_447_12_447_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_12_447_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
        (</span><a name="loc_447_10_447_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_10_447_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_447_12_447_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_12_447_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_varref"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a href="#loc_444_16_444_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_16_444_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Set the filename.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; replaceFileName x (takeFileName x) == x</span></span><span class="mpre">
</span><a href="#loc_453_1_453_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_1_453_16&#39;)"><span class="mpre">replaceFileName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_453_1_453_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_1_453_16&#39;)"><span class="hl_fundecl"><span class="mpre">replaceFileName</span></span></a><span class="mpre"> </span><a name="loc_453_17_453_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_17_453_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_453_19_453_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_19_453_20&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_453_38_453_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_38_453_39&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_574_1_574_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span></a><span class="mpre"> </span><a href="#loc_453_19_453_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_19_453_20&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> where (</span><a name="loc_453_38_453_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_38_453_39&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,_) = </span><a href="#loc_444_1_444_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_15&#39;)"><span class="hl_varref"><span class="mpre">splitFileName_</span></span></a><span class="mpre"> </span><a href="#loc_453_17_453_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_17_453_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Drop the filename.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; dropFileName x == fst (splitFileName x)</span></span><span class="mpre">
</span><a href="#loc_459_1_459_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_1_459_13&#39;)"><span class="mpre">dropFileName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_459_1_459_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_1_459_13&#39;)"><span class="hl_vardecl"><span class="mpre">dropFileName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_433_1_433_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_1_433_14&#39;)"><span class="hl_varref"><span class="mpre">splitFileName</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Get the file name.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeFileName &quot;test/&quot; == &quot;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeFileName x `isSuffixOf` x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeFileName x == snd (splitFileName x)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; takeFileName (replaceFileName x &quot;fred&quot;) == &quot;fred&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; takeFileName (x &lt;/&gt; &quot;fred&quot;) == &quot;fred&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; isRelative (takeFileName x)</span></span><span class="mpre">
</span><a href="#loc_471_1_471_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_1_471_13&#39;)"><span class="mpre">takeFileName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_471_1_471_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_1_471_13&#39;)"><span class="hl_vardecl"><span class="mpre">takeFileName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_433_1_433_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_1_433_14&#39;)"><span class="hl_varref"><span class="mpre">splitFileName</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the base name, without an extension or path.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeBaseName &quot;file/test.txt&quot; == &quot;test&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeBaseName &quot;dave.ext&quot; == &quot;dave&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeBaseName &quot;&quot; == &quot;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeBaseName &quot;test&quot; == &quot;test&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeBaseName (addTrailingPathSeparator x) == &quot;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; takeBaseName &quot;file/file.tar.gz&quot; == &quot;file.tar&quot;</span></span><span class="mpre">
</span><a href="#loc_482_1_482_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_1_482_13&#39;)"><span class="mpre">takeBaseName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_482_1_482_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_1_482_13&#39;)"><span class="hl_vardecl"><span class="mpre">takeBaseName</span></span></a><span class="mpre"> = </span><a href="#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="hl_varref"><span class="mpre">dropExtension</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_471_1_471_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_1_471_13&#39;)"><span class="hl_varref"><span class="mpre">takeFileName</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Set the base name.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceBaseName &quot;file/test.txt&quot; &quot;bob&quot; == &quot;file/bob.txt&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceBaseName &quot;fred&quot; &quot;bill&quot; == &quot;bill&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceBaseName &quot;/dave/fred/bob.gz.tar&quot; &quot;new&quot; == &quot;/dave/fred/new.tar&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; replaceBaseName x (takeBaseName x) == x</span></span><span class="mpre">
</span><a href="#loc_491_1_491_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_1_491_16&#39;)"><span class="mpre">replaceBaseName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_491_1_491_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_1_491_16&#39;)"><span class="hl_fundecl"><span class="mpre">replaceBaseName</span></span></a><span class="mpre"> </span><a name="loc_491_17_491_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_17_491_20&#39;)"><span class="hl_vardecl"><span class="mpre">pth</span></span></a><span class="mpre"> </span><a name="loc_491_21_491_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_21_491_24&#39;)"><span class="hl_vardecl"><span class="mpre">nam</span></span></a><span class="mpre"> = </span><a href="#loc_565_1_565_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_1_565_14&#39;)"><span class="hl_varref"><span class="mpre">combineAlways</span></span></a><span class="mpre"> </span><a href="#loc_493_10_493_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_10_493_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_491_21_491_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_21_491_24&#39;)"><span class="hl_varref"><span class="mpre">nam</span></span></a><span class="mpre"> </span><a href="#loc_243_1_243_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span></a><span class="mpre"> </span><a href="#loc_494_9_494_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_9_494_12&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre">)
    where
        (</span><a name="loc_493_10_493_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_10_493_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_493_12_493_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_12_493_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_444_1_444_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_15&#39;)"><span class="hl_varref"><span class="mpre">splitFileName_</span></span></a><span class="mpre"> </span><a href="#loc_491_17_491_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_17_491_20&#39;)"><span class="hl_varref"><span class="mpre">pth</span></span></a><span class="mpre">
        </span><a name="loc_494_9_494_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_9_494_12&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre"> = </span><a href="#loc_229_1_229_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_14&#39;)"><span class="hl_varref"><span class="mpre">takeExtension</span></span></a><span class="mpre"> </span><a href="#loc_493_12_493_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_12_493_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Is an item either a directory or the last character a path separator?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; hasTrailingPathSeparator &quot;test&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; hasTrailingPathSeparator &quot;test/&quot; == True</span></span><span class="mpre">
</span><a href="#loc_501_1_501_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_25&#39;)"><span class="mpre">hasTrailingPathSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_501_1_501_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_25&#39;)"><span class="hl_fundecl"><span class="mpre">hasTrailingPathSeparator</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_501_1_501_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_25&#39;)"><span class="hl_fundecl"><span class="mpre">hasTrailingPathSeparator</span></span></a><span class="mpre"> </span><a name="loc_502_26_502_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_26_502_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_502_26_502_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_26_502_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Add a trailing file path separator if one is not already present.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; hasTrailingPathSeparator (addTrailingPathSeparator x)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; hasTrailingPathSeparator x ==&gt; addTrailingPathSeparator x == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:    addTrailingPathSeparator &quot;test/rest&quot; == &quot;test/rest/&quot;</span></span><span class="mpre">
</span><a href="#loc_511_1_511_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_1_511_25&#39;)"><span class="mpre">addTrailingPathSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_511_1_511_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_1_511_25&#39;)"><span class="hl_fundecl"><span class="mpre">addTrailingPathSeparator</span></span></a><span class="mpre"> </span><a name="loc_511_26_511_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_26_511_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><a href="#loc_501_1_501_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_25&#39;)"><span class="hl_varref"><span class="mpre">hasTrailingPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_511_26_511_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_26_511_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><a href="#loc_511_26_511_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_26_511_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> else </span><a href="#loc_511_26_511_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_26_511_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">-- | Remove any trailing path separators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; dropTrailingPathSeparator &quot;file/test/&quot; == &quot;file/test&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:    not (hasTrailingPathSeparator (dropTrailingPathSeparator x)) || isDrive x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:    dropTrailingPathSeparator &quot;/&quot; == &quot;/&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows:  dropTrailingPathSeparator &quot;\\&quot; == &quot;\\&quot;</span></span><span class="mpre">
</span><a href="#loc_521_1_521_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_1_521_26&#39;)"><span class="mpre">dropTrailingPathSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_521_1_521_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_1_521_26&#39;)"><span class="hl_fundecl"><span class="mpre">dropTrailingPathSeparator</span></span></a><span class="mpre"> </span><a name="loc_521_27_521_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_27_521_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
    if </span><a href="#loc_501_1_501_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_25&#39;)"><span class="hl_varref"><span class="mpre">hasTrailingPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_521_27_521_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_27_521_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_417_1_417_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_8&#39;)"><span class="hl_varref"><span class="mpre">isDrive</span></span></a><span class="mpre"> </span><a href="#loc_521_27_521_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_27_521_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    then let </span><a name="loc_523_14_523_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_14_523_16&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_521_27_521_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_27_521_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
         in if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_523_14_523_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_14_523_16&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre"> then [</span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre">] else </span><a href="#loc_523_14_523_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_14_523_16&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
    else </span><a href="#loc_521_27_521_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_27_521_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Get the directory name, move up one level.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;           takeDirectory x `isPrefixOf` x || takeDirectory x == &quot;.&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;           takeDirectory &quot;foo&quot; == &quot;.&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;           takeDirectory &quot;/foo/bar/baz&quot; == &quot;/foo/bar&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;           takeDirectory &quot;/foo/bar/baz/&quot; == &quot;/foo/bar/baz&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;           takeDirectory &quot;foo/bar/baz&quot; == &quot;foo/bar&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows:  takeDirectory &quot;foo\\bar&quot; == &quot;foo&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows:  takeDirectory &quot;foo\\bar\\\\&quot; == &quot;foo\\bar&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows:  takeDirectory &quot;C:\\&quot; == &quot;C:\\&quot;</span></span><span class="mpre">
</span><a href="#loc_539_1_539_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_1_539_14&#39;)"><span class="mpre">takeDirectory</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_539_1_539_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_1_539_14&#39;)"><span class="hl_fundecl"><span class="mpre">takeDirectory</span></span></a><span class="mpre"> </span><a name="loc_539_15_539_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_15_539_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><a href="#loc_417_1_417_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_8&#39;)"><span class="hl_varref"><span class="mpre">isDrive</span></span></a><span class="mpre"> </span><a href="#loc_542_9_542_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_9_542_13&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_541_9_541_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_9_541_12&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_542_9_542_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_9_542_13&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">)) then </span><a href="#loc_542_9_542_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_9_542_13&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre"> else </span><a href="#loc_541_9_541_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_9_541_12&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
    where
        </span><a name="loc_541_9_541_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_9_541_12&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_542_9_542_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_9_542_13&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
        </span><a name="loc_542_9_542_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_9_542_13&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> = </span><a href="#loc_459_1_459_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_1_459_13&#39;)"><span class="hl_varref"><span class="mpre">dropFileName</span></span></a><span class="mpre"> </span><a href="#loc_539_15_539_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_15_539_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        _ = </span><span class="hl_varref"><span class="mpre">isPrefixOf</span></span><span class="mpre"> </span><a href="#loc_539_15_539_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_15_539_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- warning suppression</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Set the directory, keeping the filename the same.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; replaceDirectory x (takeDirectory x) `equalFilePath` x</span></span><span class="mpre">
</span><a href="#loc_549_1_549_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_1_549_17&#39;)"><span class="mpre">replaceDirectory</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_549_1_549_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_1_549_17&#39;)"><span class="hl_fundecl"><span class="mpre">replaceDirectory</span></span></a><span class="mpre"> </span><a name="loc_549_18_549_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_18_549_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_549_20_549_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_20_549_23&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> = </span><a href="#loc_565_1_565_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_1_565_14&#39;)"><span class="hl_varref"><span class="mpre">combineAlways</span></span></a><span class="mpre"> </span><a href="#loc_549_20_549_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_20_549_23&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> (</span><a href="#loc_471_1_471_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_1_471_13&#39;)"><span class="hl_varref"><span class="mpre">takeFileName</span></span></a><span class="mpre"> </span><a href="#loc_549_18_549_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_18_549_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Combine two paths, if the second path &#39;isAbsolute&#39;, then it returns the second.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; combine (takeDirectory x) (takeFileName x) `equalFilePath` x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   combine &quot;/&quot; &quot;test&quot; == &quot;/test&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   combine &quot;home&quot; &quot;bob&quot; == &quot;home/bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: combine &quot;home&quot; &quot;bob&quot; == &quot;home\\bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: combine &quot;home&quot; &quot;/bob&quot; == &quot;/bob&quot;</span></span><span class="mpre">
</span><a href="#loc_560_1_560_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_1_560_8&#39;)"><span class="mpre">combine</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_560_1_560_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_1_560_8&#39;)"><span class="hl_fundecl"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a name="loc_560_9_560_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_9_560_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_560_11_560_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_11_560_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> | </span><a href="#loc_412_1_412_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_9&#39;)"><span class="hl_varref"><span class="mpre">hasDrive</span></span></a><span class="mpre"> </span><a href="#loc_560_11_560_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_11_560_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_560_11_560_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_11_560_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_560_11_560_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_11_560_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)) = </span><a href="#loc_560_11_560_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_11_560_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_565_1_565_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_1_565_14&#39;)"><span class="hl_varref"><span class="mpre">combineAlways</span></span></a><span class="mpre"> </span><a href="#loc_560_9_560_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_9_560_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_560_11_560_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_11_560_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Combine two paths, assuming rhs is NOT absolute.</span></span><span class="mpre">
</span><a href="#loc_565_1_565_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_1_565_14&#39;)"><span class="mpre">combineAlways</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_565_1_565_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_1_565_14&#39;)"><span class="hl_fundecl"><span class="mpre">combineAlways</span></span></a><span class="mpre"> </span><a name="loc_565_15_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_565_17_565_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_17_565_18&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_565_15_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_565_17_565_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_17_565_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_565_17_565_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_17_565_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_565_15_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                  | </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_565_15_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_565_15_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_565_17_565_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_17_565_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                  | </span><a href="#loc_417_1_417_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_8&#39;)"><span class="hl_varref"><span class="mpre">isDrive</span></span></a><span class="mpre"> </span><a href="#loc_565_15_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_388_1_388_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_10&#39;)"><span class="hl_varref"><span class="mpre">joinDrive</span></span></a><span class="mpre"> </span><a href="#loc_565_15_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_565_17_565_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_17_565_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_565_15_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_565_17_565_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_17_565_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | A nice alias for &#39;combine&#39;.</span></span><span class="mpre">
</span><a href="#loc_574_1_574_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_6&#39;)"><span class="mpre">(&lt;/&gt;)</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_574_1_574_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_6&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;/&gt;)</span></span></a><span class="mpre"> = </span><a href="#loc_560_1_560_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_1_560_8&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Split a path by the directory separator.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; concat (splitPath x) == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitPath &quot;test//item/&quot; == [&quot;test//&quot;,&quot;item/&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitPath &quot;test/item/file&quot; == [&quot;test/&quot;,&quot;item/&quot;,&quot;file&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitPath &quot;&quot; == []</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: splitPath &quot;c:\\test\\path&quot; == [&quot;c:\\&quot;,&quot;test\\&quot;,&quot;path&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   splitPath &quot;/file/test&quot; == [&quot;/&quot;,&quot;file/&quot;,&quot;test&quot;]</span></span><span class="mpre">
</span><a href="#loc_586_1_586_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_1_586_10&#39;)"><span class="mpre">splitPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
</span><a name="loc_586_1_586_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_1_586_10&#39;)"><span class="hl_fundecl"><span class="mpre">splitPath</span></span></a><span class="mpre"> </span><a name="loc_586_11_586_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_11_586_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = [</span><a href="#loc_588_10_588_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_10_588_15&#39;)"><span class="hl_varref"><span class="mpre">drive</span></span></a><span class="mpre"> | </span><a href="#loc_588_10_588_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_10_588_15&#39;)"><span class="hl_varref"><span class="mpre">drive</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_590_9_590_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_9_590_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_588_16_588_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_16_588_20&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
    where
        (</span><a name="loc_588_10_588_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_10_588_15&#39;)"><span class="hl_vardecl"><span class="mpre">drive</span></span></a><span class="mpre">,</span><a name="loc_588_16_588_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_16_588_20&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre">) = </span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_varref"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a href="#loc_586_11_586_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_11_586_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><a name="loc_590_9_590_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_9_590_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = []
        </span><a href="#loc_590_9_590_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_9_590_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_591_11_591_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_11_591_12&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = (</span><a href="#loc_593_18_593_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_18_593_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_594_18_594_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_18_594_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_590_9_590_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_9_590_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_594_20_594_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_20_594_21&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
            where
                (</span><a name="loc_593_18_593_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_18_593_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_593_20_593_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_20_593_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_591_11_591_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_11_591_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                (</span><a name="loc_594_18_594_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_18_594_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_594_20_594_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_20_594_21&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre">  </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_593_20_593_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_20_593_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Just as &#39;splitPath&#39;, but don&#39;t add the trailing slashes to each element.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitDirectories &quot;test/file&quot; == [&quot;test&quot;,&quot;file&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitDirectories &quot;/test/file&quot; == [&quot;/&quot;,&quot;test&quot;,&quot;file&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; joinPath (splitDirectories x) `equalFilePath` x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitDirectories &quot;&quot; == []</span></span><span class="mpre">
</span><a href="#loc_603_1_603_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_1_603_17&#39;)"><span class="mpre">splitDirectories</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
</span><a name="loc_603_1_603_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_1_603_17&#39;)"><span class="hl_fundecl"><span class="mpre">splitDirectories</span></span></a><span class="mpre"> </span><a name="loc_603_18_603_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_18_603_22&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> =
        if </span><a href="#loc_412_1_412_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_9&#39;)"><span class="hl_varref"><span class="mpre">hasDrive</span></span></a><span class="mpre"> </span><a href="#loc_603_18_603_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_18_603_22&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_607_9_607_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_9_607_23&#39;)"><span class="hl_varref"><span class="mpre">pathComponents</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_609_9_609_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_9_609_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_607_9_607_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_9_607_23&#39;)"><span class="hl_varref"><span class="mpre">pathComponents</span></span></a><span class="mpre">)
        else </span><a href="#loc_609_9_609_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_9_609_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_607_9_607_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_9_607_23&#39;)"><span class="hl_varref"><span class="mpre">pathComponents</span></span></a><span class="mpre">
    where
        </span><a name="loc_607_9_607_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_9_607_23&#39;)"><span class="hl_vardecl"><span class="mpre">pathComponents</span></span></a><span class="mpre"> = </span><a href="#loc_586_1_586_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_1_586_10&#39;)"><span class="hl_varref"><span class="mpre">splitPath</span></span></a><span class="mpre"> </span><a href="#loc_603_18_603_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_18_603_22&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">

        </span><a name="loc_609_9_609_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_9_609_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_610_9_610_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_9_610_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
        </span><a name="loc_610_9_610_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_9_610_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_610_11_610_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_11_610_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_611_19_611_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_19_611_22&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> then </span><a href="#loc_610_11_610_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_11_610_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> else </span><a href="#loc_611_19_611_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_19_611_22&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
            where </span><a name="loc_611_19_611_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_19_611_22&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">takeWhile</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre">) </span><a href="#loc_610_11_610_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_11_610_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Join path elements back together.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Valid x =&gt; joinPath (splitPath x) == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; joinPath [] == &quot;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix: joinPath [&quot;test&quot;,&quot;file&quot;,&quot;path&quot;] == &quot;test/file/path&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Note that this definition on c:\\c:\\, join then split will give c:\\.</span></span><span class="mpre">
</span><a href="#loc_622_1_622_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_622_1_622_9&#39;)"><span class="mpre">joinPath</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_622_1_622_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_622_1_622_9&#39;)"><span class="hl_vardecl"><span class="mpre">joinPath</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_560_1_560_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_1_560_8&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">






</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- File name manipulators</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Equality of two &#39;FilePath&#39;s.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If you call @System.Directory.canonicalizePath@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   first this has a much better chance of working.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Note that this doesn&#39;t follow symlinks or DOSNAM~1s.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          x == y ==&gt; equalFilePath x y</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          normalise x == normalise y ==&gt; equalFilePath x y</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   equalFilePath &quot;foo&quot; &quot;foo/&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   not (equalFilePath &quot;foo&quot; &quot;/foo&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   not (equalFilePath &quot;foo&quot; &quot;FOO&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: equalFilePath &quot;foo&quot; &quot;FOO&quot;</span></span><span class="mpre">
</span><a href="#loc_644_1_644_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_14&#39;)"><span class="mpre">equalFilePath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_644_1_644_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_14&#39;)"><span class="hl_fundecl"><span class="mpre">equalFilePath</span></span></a><span class="mpre"> </span><a name="loc_644_15_644_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_15_644_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_644_17_644_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_17_644_18&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_646_9_646_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_9_646_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_644_15_644_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_15_644_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_646_9_646_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_9_646_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_644_17_644_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_17_644_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
    where
        </span><a name="loc_646_9_646_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_9_646_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_646_11_646_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_11_646_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="hl_varref"><span class="mpre">isWindows</span></span></a><span class="mpre"> = </span><a href="#loc_649_9_649_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_9_649_23&#39;)"><span class="hl_varref"><span class="mpre">dropTrailSlash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toLower</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_716_1_716_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_716_1_716_10&#39;)"><span class="hl_varref"><span class="mpre">normalise</span></span></a><span class="mpre"> </span><a href="#loc_646_11_646_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_11_646_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_649_9_649_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_9_649_23&#39;)"><span class="hl_varref"><span class="mpre">dropTrailSlash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_716_1_716_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_716_1_716_10&#39;)"><span class="hl_varref"><span class="mpre">normalise</span></span></a><span class="mpre"> </span><a href="#loc_646_11_646_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_11_646_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><a name="loc_649_9_649_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_9_649_23&#39;)"><span class="hl_fundecl"><span class="mpre">dropTrailSlash</span></span></a><span class="mpre"> </span><a name="loc_649_24_649_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_24_649_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_649_24_649_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_24_649_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_649_24_649_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_24_649_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><a href="#loc_649_24_649_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_24_649_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_649_24_649_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_24_649_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Contract a filename, based on a relative path.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   There is no corresponding @makeAbsolute@ function, instead use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   @System.Directory.canonicalizePath@ which has the same effect.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          Valid y =&gt; equalFilePath x y || (isRelative x &amp;&amp; makeRelative y x == x) || equalFilePath (y &lt;/&gt; makeRelative y x) x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          makeRelative x x == &quot;.&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          null y || equalFilePath (makeRelative x (x &lt;/&gt; y)) y || null (takeFileName x)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeRelative &quot;C:\\Home&quot; &quot;c:\\home\\bob&quot; == &quot;bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeRelative &quot;C:\\Home&quot; &quot;c:/home/bob&quot; == &quot;bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeRelative &quot;C:\\Home&quot; &quot;D:\\Home\\Bob&quot; == &quot;D:\\Home\\Bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeRelative &quot;C:\\Home&quot; &quot;C:Home\\Bob&quot; == &quot;C:Home\\Bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeRelative &quot;/Home&quot; &quot;/home/bob&quot; == &quot;bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   makeRelative &quot;/Home&quot; &quot;/home/bob&quot; == &quot;/home/bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   makeRelative &quot;/home/&quot; &quot;/home/bob/foo/bar&quot; == &quot;bob/foo/bar&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   makeRelative &quot;/fred&quot; &quot;bob&quot; == &quot;bob&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   makeRelative &quot;/file/test&quot; &quot;/file/test/fred&quot; == &quot;fred&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   makeRelative &quot;/file/test&quot; &quot;/file/test/fred/&quot; == &quot;fred/&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   makeRelative &quot;some/path&quot; &quot;some/path/a/b/c&quot; == &quot;a/b/c&quot;</span></span><span class="mpre">
</span><a href="#loc_673_1_673_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_1_673_13&#39;)"><span class="mpre">makeRelative</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_673_1_673_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_1_673_13&#39;)"><span class="hl_fundecl"><span class="mpre">makeRelative</span></span></a><span class="mpre"> </span><a name="loc_673_14_673_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_14_673_18&#39;)"><span class="hl_vardecl"><span class="mpre">root</span></span></a><span class="mpre"> </span><a name="loc_673_19_673_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_19_673_23&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre">
 | </span><a href="#loc_644_1_644_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_14&#39;)"><span class="hl_varref"><span class="mpre">equalFilePath</span></span></a><span class="mpre"> </span><a href="#loc_673_14_673_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_14_673_18&#39;)"><span class="hl_varref"><span class="mpre">root</span></span></a><span class="mpre"> </span><a href="#loc_673_19_673_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_19_673_23&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre">
 | </span><a href="#loc_690_9_690_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_9_690_16&#39;)"><span class="hl_varref"><span class="mpre">takeAbs</span></span></a><span class="mpre"> </span><a href="#loc_673_14_673_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_14_673_18&#39;)"><span class="hl_varref"><span class="mpre">root</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_690_9_690_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_9_690_16&#39;)"><span class="hl_varref"><span class="mpre">takeAbs</span></span></a><span class="mpre"> </span><a href="#loc_673_19_673_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_19_673_23&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> = </span><a href="#loc_673_19_673_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_19_673_23&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_678_9_678_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_9_678_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_687_9_687_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_9_687_16&#39;)"><span class="hl_varref"><span class="mpre">dropAbs</span></span></a><span class="mpre"> </span><a href="#loc_673_14_673_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_14_673_18&#39;)"><span class="hl_varref"><span class="mpre">root</span></span></a><span class="mpre">) (</span><a href="#loc_687_9_687_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_9_687_16&#39;)"><span class="hl_varref"><span class="mpre">dropAbs</span></span></a><span class="mpre"> </span><a href="#loc_673_19_673_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_19_673_23&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">)
    where
        </span><a name="loc_678_9_678_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_9_678_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a name="loc_678_14_678_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_14_678_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_678_14_678_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_14_678_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
        </span><a href="#loc_678_9_678_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_9_678_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_679_11_679_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_11_679_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_679_13_679_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_13_679_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = let (</span><a name="loc_679_22_679_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_22_679_24&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre">,</span><a name="loc_679_25_679_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_25_679_27&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre">) = </span><a href="#loc_683_9_683_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_9_683_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_679_11_679_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_11_679_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                    (</span><a name="loc_680_22_680_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_22_680_24&#39;)"><span class="hl_vardecl"><span class="mpre">y1</span></span></a><span class="mpre">,</span><a name="loc_680_25_680_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_25_680_27&#39;)"><span class="hl_vardecl"><span class="mpre">y2</span></span></a><span class="mpre">) = </span><a href="#loc_683_9_683_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_9_683_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_679_13_679_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_13_679_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                in if </span><a href="#loc_644_1_644_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_14&#39;)"><span class="hl_varref"><span class="mpre">equalFilePath</span></span></a><span class="mpre"> </span><a href="#loc_679_22_679_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_22_679_24&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_680_22_680_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_22_680_24&#39;)"><span class="hl_varref"><span class="mpre">y1</span></span></a><span class="mpre"> then </span><a href="#loc_678_9_678_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_9_678_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_679_25_679_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_25_679_27&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a href="#loc_680_25_680_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_25_680_27&#39;)"><span class="hl_varref"><span class="mpre">y2</span></span></a><span class="mpre"> else </span><a href="#loc_673_19_673_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_19_673_23&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">

        </span><a name="loc_683_9_683_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_9_683_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_683_11_683_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_11_683_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_684_20_684_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_20_684_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_684_22_684_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_22_684_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
            where (</span><a name="loc_684_20_684_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_20_684_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_684_22_684_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_22_684_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_683_11_683_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_11_683_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- on windows, need to drop &#39;/&#39; which is kind of absolute, but not a drive</span></span><span class="mpre">
        </span><a name="loc_687_9_687_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_9_687_16&#39;)"><span class="hl_fundecl"><span class="mpre">dropAbs</span></span></a><span class="mpre"> (</span><a name="loc_687_18_687_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_18_687_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_687_20_687_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_20_687_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_687_18_687_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_18_687_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_687_20_687_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_20_687_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_687_9_687_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_9_687_16&#39;)"><span class="hl_fundecl"><span class="mpre">dropAbs</span></span></a><span class="mpre"> </span><a name="loc_688_17_688_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_17_688_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_406_1_406_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_10&#39;)"><span class="hl_varref"><span class="mpre">dropDrive</span></span></a><span class="mpre"> </span><a href="#loc_688_17_688_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_17_688_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><a name="loc_690_9_690_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_9_690_16&#39;)"><span class="hl_fundecl"><span class="mpre">takeAbs</span></span></a><span class="mpre"> (</span><a name="loc_690_18_690_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_18_690_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) | </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_690_18_690_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_18_690_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = [</span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre">]
        </span><a href="#loc_690_9_690_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_9_690_16&#39;)"><span class="hl_fundecl"><span class="mpre">takeAbs</span></span></a><span class="mpre"> </span><a name="loc_691_17_691_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_17_691_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_691_27_691_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_27_691_28&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; if </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_691_27_691_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_27_691_28&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> then </span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">toLower</span></span><span class="mpre"> </span><a href="#loc_691_27_691_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_27_691_28&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_400_1_400_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_10&#39;)"><span class="hl_varref"><span class="mpre">takeDrive</span></span></a><span class="mpre"> </span><a href="#loc_691_17_691_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_17_691_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Normalise a file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * \/\/ outside of the drive can be made blank</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * \/ -&gt; &#39;pathSeparator&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * .\/ -&gt; \&quot;\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   normalise &quot;/file/\\test////&quot; == &quot;/file/\\test/&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   normalise &quot;/file/./test&quot; == &quot;/file/test&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   normalise &quot;/test/file/../bob/fred/&quot; == &quot;/test/file/../bob/fred/&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   normalise &quot;../bob/fred/&quot; == &quot;../bob/fred/&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   normalise &quot;./bob/fred/&quot; == &quot;bob/fred/&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: normalise &quot;c:\\file/bob\\&quot; == &quot;C:\\file\\bob\\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: normalise &quot;c:\\&quot; == &quot;C:\\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: normalise &quot;\\\\server\\test&quot; == &quot;\\\\server\\test&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: normalise &quot;c:/file&quot; == &quot;C:\\file&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          normalise &quot;.&quot; == &quot;.&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   normalise &quot;./&quot; == &quot;./&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   normalise &quot;./.&quot; == &quot;./&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   normalise &quot;/&quot; == &quot;/&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   normalise &quot;bob/fred/.&quot; == &quot;bob/fred/&quot;</span></span><span class="mpre">
</span><a href="#loc_716_1_716_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_716_1_716_10&#39;)"><span class="mpre">normalise</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_716_1_716_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_716_1_716_10&#39;)"><span class="hl_fundecl"><span class="mpre">normalise</span></span></a><span class="mpre"> </span><a name="loc_716_11_716_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_716_11_716_15&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> = </span><a href="#loc_721_9_721_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_9_721_19&#39;)"><span class="hl_varref"><span class="mpre">joinDrive&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_740_1_740_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_1_740_15&#39;)"><span class="hl_varref"><span class="mpre">normaliseDrive</span></span></a><span class="mpre"> </span><a href="#loc_719_10_719_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_10_719_13&#39;)"><span class="hl_varref"><span class="mpre">drv</span></span></a><span class="mpre">) (</span><a href="#loc_728_9_728_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_9_728_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_719_14_719_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_14_719_17&#39;)"><span class="hl_varref"><span class="mpre">pth</span></span></a><span class="mpre">)
              </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre"> | </span><a href="#loc_724_9_724_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_9_724_18&#39;)"><span class="hl_varref"><span class="mpre">isDirPath</span></span></a><span class="mpre"> </span><a href="#loc_719_14_719_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_14_719_17&#39;)"><span class="hl_varref"><span class="mpre">pth</span></span></a><span class="mpre">]
    where
        (</span><a name="loc_719_10_719_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_10_719_13&#39;)"><span class="hl_vardecl"><span class="mpre">drv</span></span></a><span class="mpre">,</span><a name="loc_719_14_719_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_14_719_17&#39;)"><span class="hl_vardecl"><span class="mpre">pth</span></span></a><span class="mpre">) = </span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_varref"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a href="#loc_716_11_716_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_716_11_716_15&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">

        </span><a name="loc_721_9_721_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_9_721_19&#39;)"><span class="hl_fundecl"><span class="mpre">joinDrive&#39;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre">
        </span><a href="#loc_721_9_721_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_9_721_19&#39;)"><span class="hl_fundecl"><span class="mpre">joinDrive&#39;</span></span></a><span class="mpre"> </span><a name="loc_722_20_722_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_722_20_722_21&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_722_22_722_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_722_22_722_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_388_1_388_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_10&#39;)"><span class="hl_varref"><span class="mpre">joinDrive</span></span></a><span class="mpre"> </span><a href="#loc_722_20_722_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_722_20_722_21&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_722_22_722_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_722_22_722_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

        </span><a name="loc_724_9_724_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_9_724_18&#39;)"><span class="hl_fundecl"><span class="mpre">isDirPath</span></span></a><span class="mpre"> </span><a name="loc_724_19_724_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_19_724_21&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_726_9_726_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_9_726_16&#39;)"><span class="hl_varref"><span class="mpre">lastSep</span></span></a><span class="mpre"> </span><a href="#loc_724_19_724_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_19_724_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_724_19_724_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_19_724_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_724_19_724_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_19_724_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_726_9_726_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_9_726_16&#39;)"><span class="hl_varref"><span class="mpre">lastSep</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><a href="#loc_724_19_724_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_19_724_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        </span><a name="loc_726_9_726_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_9_726_16&#39;)"><span class="hl_fundecl"><span class="mpre">lastSep</span></span></a><span class="mpre"> </span><a name="loc_726_17_726_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_17_726_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_726_17_726_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_17_726_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_726_17_726_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_17_726_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

        </span><a name="loc_728_9_728_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_9_728_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_622_1_622_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_622_1_622_9&#39;)"><span class="hl_varref"><span class="mpre">joinPath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_737_9_737_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_9_737_17&#39;)"><span class="hl_varref"><span class="mpre">dropDots</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_603_1_603_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_1_603_17&#39;)"><span class="hl_varref"><span class="mpre">splitDirectories</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_730_9_730_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_9_730_16&#39;)"><span class="hl_varref"><span class="mpre">propSep</span></span></a><span class="mpre">

        </span><a name="loc_730_9_730_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_9_730_16&#39;)"><span class="hl_fundecl"><span class="mpre">propSep</span></span></a><span class="mpre"> (</span><a name="loc_730_18_730_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_18_730_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_730_20_730_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_20_730_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_730_22_730_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_22_730_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
         | </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_730_18_730_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_18_730_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_730_20_730_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_20_730_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_730_9_730_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_9_730_16&#39;)"><span class="hl_varref"><span class="mpre">propSep</span></span></a><span class="mpre"> (</span><a href="#loc_730_18_730_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_18_730_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_730_22_730_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_22_730_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        </span><a href="#loc_730_9_730_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_9_730_16&#39;)"><span class="hl_fundecl"><span class="mpre">propSep</span></span></a><span class="mpre"> (</span><a name="loc_732_18_732_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_732_18_732_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_732_20_732_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_732_20_732_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
         | </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_732_18_732_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_732_18_732_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_730_9_730_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_9_730_16&#39;)"><span class="hl_varref"><span class="mpre">propSep</span></span></a><span class="mpre"> </span><a href="#loc_732_20_732_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_732_20_732_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_730_9_730_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_9_730_16&#39;)"><span class="hl_fundecl"><span class="mpre">propSep</span></span></a><span class="mpre"> (</span><a name="loc_734_18_734_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_18_734_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_734_20_734_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_20_734_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_734_18_734_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_18_734_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_730_9_730_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_9_730_16&#39;)"><span class="hl_varref"><span class="mpre">propSep</span></span></a><span class="mpre"> </span><a href="#loc_734_20_734_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_20_734_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_730_9_730_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_9_730_16&#39;)"><span class="hl_fundecl"><span class="mpre">propSep</span></span></a><span class="mpre"> [] = []

        </span><a name="loc_737_9_737_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_9_737_17&#39;)"><span class="hl_vardecl"><span class="mpre">dropDots</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre">)

</span><a href="#loc_740_1_740_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_1_740_15&#39;)"><span class="mpre">normaliseDrive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_740_1_740_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_1_740_15&#39;)"><span class="hl_fundecl"><span class="mpre">normaliseDrive</span></span></a><span class="mpre"> </span><a name="loc_740_16_740_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_16_740_21&#39;)"><span class="hl_vardecl"><span class="mpre">drive</span></span></a><span class="mpre"> | </span><a href="#loc_109_1_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_8&#39;)"><span class="hl_varref"><span class="mpre">isPosix</span></span></a><span class="mpre"> = </span><a href="#loc_740_16_740_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_16_740_21&#39;)"><span class="hl_varref"><span class="mpre">drive</span></span></a><span class="mpre">
</span><a href="#loc_740_1_740_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_1_740_15&#39;)"><span class="hl_fundecl"><span class="mpre">normaliseDrive</span></span></a><span class="mpre"> </span><a name="loc_741_16_741_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_16_741_21&#39;)"><span class="hl_vardecl"><span class="mpre">drive</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">isJust</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_361_1_361_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_16&#39;)"><span class="hl_varref"><span class="mpre">readDriveLetter</span></span></a><span class="mpre"> </span><a href="#loc_745_9_745_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_9_745_11&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">
                       then </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toUpper</span></span><span class="mpre"> </span><a href="#loc_745_9_745_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_9_745_11&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">
                       else </span><a href="#loc_741_16_741_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_16_741_21&#39;)"><span class="hl_varref"><span class="mpre">drive</span></span></a><span class="mpre">
    where
        </span><a name="loc_745_9_745_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_9_745_11&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_747_9_747_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_9_747_17&#39;)"><span class="hl_varref"><span class="mpre">repSlash</span></span></a><span class="mpre"> </span><a href="#loc_741_16_741_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_16_741_21&#39;)"><span class="hl_varref"><span class="mpre">drive</span></span></a><span class="mpre">

        </span><a name="loc_747_9_747_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_9_747_17&#39;)"><span class="hl_fundecl"><span class="mpre">repSlash</span></span></a><span class="mpre"> </span><a name="loc_747_18_747_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_18_747_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_747_18_747_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_18_747_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><a href="#loc_126_1_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre"> else </span><a href="#loc_747_18_747_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_18_747_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- information for validity functions on Windows</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- see http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/naming_a_file.asp</span></span><span class="mpre">
</span><a href="#loc_752_1_752_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_1_752_14&#39;)"><span class="mpre">badCharacters</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
</span><a name="loc_752_1_752_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_1_752_14&#39;)"><span class="hl_vardecl"><span class="mpre">badCharacters</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;:*?&gt;&lt;|\&quot;&quot;</span></span><span class="mpre">
</span><a href="#loc_754_1_754_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_1_754_12&#39;)"><span class="mpre">badElements</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
</span><a name="loc_754_1_754_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_1_754_12&#39;)"><span class="hl_vardecl"><span class="mpre">badElements</span></span></a><span class="mpre"> = [</span><span class="hl_string"><span class="mpre">&quot;CON&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;PRN&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;AUX&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;NUL&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;COM1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;COM2&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;COM3&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;COM4&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;COM5&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;COM6&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;COM7&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;COM8&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;COM9&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;LPT1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;LPT2&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;LPT3&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;LPT4&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;LPT5&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;LPT6&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;LPT7&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;LPT8&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;LPT9&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;CLOCK$&quot;</span></span><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">-- | Is a FilePath valid, i.e. could you create a file like it?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          isValid &quot;&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   isValid &quot;/random_ path:*&quot; == True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   isValid x == not (null x)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isValid &quot;c:\\test&quot; == True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isValid &quot;c:\\test:of_test&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isValid &quot;test*&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isValid &quot;c:\\test\\nul&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isValid &quot;c:\\test\\prn.txt&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isValid &quot;c:\\nul\\file&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isValid &quot;\\\\&quot; == False</span></span><span class="mpre">
</span><a href="#loc_770_1_770_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_770_1_770_8&#39;)"><span class="mpre">isValid</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_770_1_770_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_770_1_770_8&#39;)"><span class="hl_fundecl"><span class="mpre">isValid</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_770_1_770_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_770_1_770_8&#39;)"><span class="hl_fundecl"><span class="mpre">isValid</span></span></a><span class="mpre"> _ | </span><a href="#loc_109_1_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_8&#39;)"><span class="hl_varref"><span class="mpre">isPosix</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_770_1_770_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_770_1_770_8&#39;)"><span class="hl_fundecl"><span class="mpre">isValid</span></span></a><span class="mpre"> </span><a name="loc_772_9_772_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_9_772_13&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> =
        </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_752_1_752_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_1_752_14&#39;)"><span class="hl_varref"><span class="mpre">badCharacters</span></span></a><span class="mpre">) </span><a href="#loc_777_9_777_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_9_777_11&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> </span><a href="#loc_778_9_778_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_9_778_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_603_1_603_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_1_603_17&#39;)"><span class="hl_varref"><span class="mpre">splitDirectories</span></span></a><span class="mpre"> </span><a href="#loc_777_9_777_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_9_777_11&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_772_9_772_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_9_772_13&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_772_9_772_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_9_772_13&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">)
    where
        </span><a name="loc_777_9_777_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_9_777_11&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><a href="#loc_406_1_406_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_10&#39;)"><span class="hl_varref"><span class="mpre">dropDrive</span></span></a><span class="mpre"> </span><a href="#loc_772_9_772_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_9_772_13&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
        </span><a name="loc_778_9_778_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_9_778_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_778_11_778_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_11_778_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toUpper</span></span><span class="mpre"> (</span><a href="#loc_291_1_291_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_15&#39;)"><span class="hl_varref"><span class="mpre">dropExtensions</span></span></a><span class="mpre"> </span><a href="#loc_778_11_778_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_11_778_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_754_1_754_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_1_754_12&#39;)"><span class="hl_varref"><span class="mpre">badElements</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Take a FilePath and make it valid; does not change already valid FilePaths.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; isValid (makeValid x)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; isValid x ==&gt; makeValid x == x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; makeValid &quot;&quot; == &quot;_&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeValid &quot;c:\\test:of_test&quot; == &quot;c:\\test_of_test&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeValid &quot;test*&quot; == &quot;test_&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeValid &quot;c:\\test\\nul&quot; == &quot;c:\\test\\nul_&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeValid &quot;c:\\test\\prn.txt&quot; == &quot;c:\\test\\prn_.txt&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeValid &quot;c:\\test/prn.txt&quot; == &quot;c:\\test/prn_.txt&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: makeValid &quot;c:\\nul\\file&quot; == &quot;c:\\nul_\\file&quot;</span></span><span class="mpre">
</span><a href="#loc_793_1_793_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_10&#39;)"><span class="mpre">makeValid</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_793_1_793_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_10&#39;)"><span class="hl_fundecl"><span class="mpre">makeValid</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;_&quot;</span></span><span class="mpre">
</span><a href="#loc_793_1_793_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_10&#39;)"><span class="hl_fundecl"><span class="mpre">makeValid</span></span></a><span class="mpre"> </span><a name="loc_794_11_794_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_11_794_15&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> | </span><a href="#loc_109_1_109_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_8&#39;)"><span class="hl_varref"><span class="mpre">isPosix</span></span></a><span class="mpre"> = </span><a href="#loc_794_11_794_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_11_794_15&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
</span><a href="#loc_793_1_793_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_10&#39;)"><span class="hl_fundecl"><span class="mpre">makeValid</span></span></a><span class="mpre"> </span><a name="loc_795_11_795_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_795_11_795_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_795_11_795_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_795_11_795_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><a href="#loc_795_11_795_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_795_11_795_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_795_11_795_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_795_11_795_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;drive&quot;</span></span><span class="mpre">
</span><a href="#loc_793_1_793_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_10&#39;)"><span class="hl_fundecl"><span class="mpre">makeValid</span></span></a><span class="mpre"> </span><a name="loc_796_11_796_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_11_796_15&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> = </span><a href="#loc_388_1_388_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_10&#39;)"><span class="hl_varref"><span class="mpre">joinDrive</span></span></a><span class="mpre"> </span><a href="#loc_798_10_798_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_10_798_13&#39;)"><span class="hl_varref"><span class="mpre">drv</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_804_9_804_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_9_804_22&#39;)"><span class="hl_varref"><span class="mpre">validElements</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_800_9_800_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_800_9_800_19&#39;)"><span class="hl_varref"><span class="mpre">validChars</span></span></a><span class="mpre"> </span><a href="#loc_798_14_798_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_14_798_17&#39;)"><span class="hl_varref"><span class="mpre">pth</span></span></a><span class="mpre">
    where
        (</span><a name="loc_798_10_798_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_10_798_13&#39;)"><span class="hl_vardecl"><span class="mpre">drv</span></span></a><span class="mpre">,</span><a name="loc_798_14_798_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_14_798_17&#39;)"><span class="hl_vardecl"><span class="mpre">pth</span></span></a><span class="mpre">) = </span><a href="#loc_328_1_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_11&#39;)"><span class="hl_varref"><span class="mpre">splitDrive</span></span></a><span class="mpre"> </span><a href="#loc_796_11_796_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_11_796_15&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">

        </span><a name="loc_800_9_800_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_800_9_800_19&#39;)"><span class="hl_vardecl"><span class="mpre">validChars</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_801_9_801_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_9_801_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
        </span><a name="loc_801_9_801_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_9_801_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_801_11_801_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_11_801_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_801_11_801_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_11_801_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_752_1_752_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_1_752_14&#39;)"><span class="hl_varref"><span class="mpre">badCharacters</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_801_11_801_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_11_801_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><a name="loc_804_9_804_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_9_804_22&#39;)"><span class="hl_fundecl"><span class="mpre">validElements</span></span></a><span class="mpre"> </span><a name="loc_804_23_804_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_23_804_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_622_1_622_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_622_1_622_9&#39;)"><span class="hl_varref"><span class="mpre">joinPath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_805_9_805_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_9_805_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_586_1_586_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_1_586_10&#39;)"><span class="hl_varref"><span class="mpre">splitPath</span></span></a><span class="mpre"> </span><a href="#loc_804_23_804_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_23_804_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_805_9_805_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_9_805_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_805_11_805_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_11_805_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_807_9_807_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_807_9_807_10&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_806_22_806_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_22_806_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_806_20_806_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_20_806_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
            where (</span><a name="loc_806_20_806_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_20_806_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_806_22_806_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_22_806_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_805_11_805_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_11_805_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_807_9_807_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_807_9_807_10&#39;)"><span class="hl_fundecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_807_11_807_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_807_11_807_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toUpper</span></span><span class="mpre"> </span><a href="#loc_808_20_808_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_20_808_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_754_1_754_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_1_754_12&#39;)"><span class="hl_varref"><span class="mpre">badElements</span></span></a><span class="mpre"> then </span><a href="#loc_808_20_808_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_20_808_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;_&quot;</span></span><span class="mpre"> </span><a href="#loc_243_1_243_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span></a><span class="mpre"> </span><a href="#loc_808_22_808_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_22_808_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> else </span><a href="#loc_807_11_807_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_807_11_807_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            where (</span><a name="loc_808_20_808_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_20_808_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_808_22_808_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_22_808_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_282_1_282_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_16&#39;)"><span class="hl_varref"><span class="mpre">splitExtensions</span></span></a><span class="mpre"> </span><a href="#loc_807_11_807_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_807_11_807_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Is a path relative, or is it fixed to the root?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isRelative &quot;path\\test&quot; == True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isRelative &quot;c:\\test&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isRelative &quot;c:test&quot; == True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isRelative &quot;c:&quot; == True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isRelative &quot;\\\\foo&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Windows: isRelative &quot;/foo&quot; == True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   isRelative &quot;test/path&quot; == True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; Posix:   isRelative &quot;/test&quot; == False</span></span><span class="mpre">
</span><a href="#loc_822_1_822_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_11&#39;)"><span class="mpre">isRelative</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_822_1_822_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_11&#39;)"><span class="hl_vardecl"><span class="mpre">isRelative</span></span></a><span class="mpre"> = </span><a href="#loc_834_1_834_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_1_834_16&#39;)"><span class="hl_varref"><span class="mpre">isRelativeDrive</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_400_1_400_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_10&#39;)"><span class="hl_varref"><span class="mpre">takeDrive</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Disable these tests for now, as we want to be able to run the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- testsuite without doing a special TESTING compilation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- -- &gt; isRelativeDrive &quot;&quot; == True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- -- &gt; Windows: isRelativeDrive &quot;c:\\&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- -- &gt; Windows: isRelativeDrive &quot;c:/&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- -- &gt; Windows: isRelativeDrive &quot;c:&quot; == True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- -- &gt; Windows: isRelativeDrive &quot;\\\\foo&quot; == False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- -- &gt; Posix:   isRelativeDrive &quot;/&quot; == False</span></span><span class="mpre">
</span><a href="#loc_834_1_834_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_1_834_16&#39;)"><span class="mpre">isRelativeDrive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_834_1_834_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_1_834_16&#39;)"><span class="hl_fundecl"><span class="mpre">isRelativeDrive</span></span></a><span class="mpre"> </span><a name="loc_834_17_834_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_17_834_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_834_17_834_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_17_834_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_141_1_141_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_16&#39;)"><span class="hl_varref"><span class="mpre">isPathSeparator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) (</span><a href="#loc_361_1_361_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_16&#39;)"><span class="hl_varref"><span class="mpre">readDriveLetter</span></span></a><span class="mpre"> </span><a href="#loc_834_17_834_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_17_834_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | @not . &#39;isRelative&#39;@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; isAbsolute x == not (isRelative x)</span></span><span class="mpre">
</span><a href="#loc_842_1_842_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_842_1_842_11&#39;)"><span class="mpre">isAbsolute</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_842_1_842_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_842_1_842_11&#39;)"><span class="hl_vardecl"><span class="mpre">isAbsolute</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_822_1_822_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_11&#39;)"><span class="hl_varref"><span class="mpre">isRelative</span></span></a><span class="mpre">
</span></div></body></html>