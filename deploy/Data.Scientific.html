<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE ScopedTypeVariables #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.Scientific</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Bas van Dijk 2013</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Bas van Dijk &lt;v.dijk.bas@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @Data.Scientific@ provides a space efficient and arbitrary precision</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- scientific number type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Scientific&#39; numbers are represented using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://en.wikipedia.org/wiki/Scientific_notation scientific notation&gt;. It</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- uses an &#39;Integer&#39; &#39;coefficient&#39; @c@ and an &#39;Int&#39; &#39;base10Exponent&#39; @e@ (do</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- note that since we&#39;re using an &#39;Int&#39; to represent the exponent these numbers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- aren&#39;t truly arbitrary precision). A scientific number corresponds to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Fractional&#39; number: @&#39;fromInteger&#39; c * 10 &#39;^^&#39; e@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The main application of &#39;Scientific&#39; is to be used as the target of parsing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- arbitrary precision numbers coming from an untrusted source. The advantages</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- over using &#39;Rational&#39; for this are that:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * A &#39;Scientific&#39; is more efficient to construct. Rational numbers need to be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- constructed using &#39;%&#39; which has to compute the &#39;gcd&#39; of the &#39;numerator&#39; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;denominator&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * &#39;Scientific&#39; is safe against numbers with huge exponents. For example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @1e1000000000 :: &#39;Rational&#39;@ will fill up all space and crash your</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- program. Scientific works as expected:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &gt; &gt; read &quot;1e1000000000&quot; :: Scientific</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  &gt; 1.0e1000000000</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Also, the space usage of converting scientific numbers with huge exponents</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to @&#39;Integral&#39;s@ (like: &#39;Int&#39;) or @&#39;RealFloat&#39;s@ (like: &#39;Double&#39; or &#39;Float&#39;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will always be bounded by the target type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module is designed to be imported qualified:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @import Data.Scientific as Scientific@</span></span><span class="mpre">
module Data.Scientific
    ( Scientific

      </span><span class="hl_comment"><span class="mpre">-- * Construction</span></span><span class="mpre">
    , scientific

      </span><span class="hl_comment"><span class="mpre">-- * Projections</span></span><span class="mpre">
    , coefficient
    , base10Exponent

      </span><span class="hl_comment"><span class="mpre">-- * Conversions</span></span><span class="mpre">
    , fromFloatDigits
    , toRealFloat
    , floatingOrInteger

      </span><span class="hl_comment"><span class="mpre">-- * Pretty printing</span></span><span class="mpre">
    , formatScientific
    , FPFormat(..)

    , toDecimalDigits

      </span><span class="hl_comment"><span class="mpre">-- * Normalization</span></span><span class="mpre">
    , normalize
    ) where


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Imports</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

import           Control.Monad                (</span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="mpre">mplus</span></a><span class="mpre">)
import           Control.DeepSeq              (</span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="mpre">NFData</span></a><span class="mpre">)
import           Data.Array                   (Array, listArray, (!))
import           Data.Char                    (intToDigit, ord)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 18, srcSpanEndLine = 78, srcSpanEndColumn = 27}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">                    (Data)
import           Data.Function                (</span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="mpre">on</span></a><span class="mpre">)
import           Data.Functor                 (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)
import           Data.Hashable                (Hashable(..))
import           Data.Ratio                   ((%), numerator, denominator)
import           Data.Typeable                (</span><a href="Data.Typeable.Internal.html#loc_196_7_196_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.Internal.html#loc_196_7_196_15&#39;)"><span class="mpre">Typeable</span></a><span class="mpre">)
import           Math.NumberTheory.Logarithms (</span><a href="Math.NumberTheory.Logarithms.html#loc_116_1_116_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Math.NumberTheory.Logarithms.html#loc_116_1_116_14&#39;)"><span class="mpre">integerLog10&#39;</span></a><span class="mpre">)
import qualified Numeric                      (floatToDigits)
import           Text.Read                    (readPrec)
import qualified Text.ParserCombinators.ReadPrec as ReadPrec
import qualified Text.ParserCombinators.ReadP    as ReadP
import           Text.ParserCombinators.ReadP     ( </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="mpre">ReadP</span></a><span class="mpre"> )
import           Data.Text.Lazy.Builder.RealFloat (</span><a href="Data.Text.Lazy.Builder.RealFloat.html#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.RealFloat.html#loc_29_6_29_14&#39;)"><span class="mpre">FPFormat</span></a><span class="mpre">(..))

#if MIN_VERSION_base(4,5,0)
import           Data.Bits                    (</span><a href="Data.Bits.html#loc_240_5_240_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_240_5_240_17&#39;)"><span class="mpre">unsafeShiftR</span></a><span class="mpre">)
#else
import           Data.Bits                    (</span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">)
#endif


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | An arbitrary-precision number represented using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://en.wikipedia.org/wiki/Scientific_notation scientific notation&gt;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This type describes the set of all @&#39;Real&#39;s@ which have a finite</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- decimal expansion.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A scientific number with &#39;coefficient&#39; @c@ and &#39;base10Exponent&#39; @e@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- corresponds to the &#39;Fractional&#39; number: @&#39;fromInteger&#39; c * 10 &#39;^^&#39; e@</span></span><span class="mpre">
data </span><a name="loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Scientific</span></span></a><span class="mpre"> = </span><a name="loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_condecl"><span class="mpre">Scientific</span></span></a><span class="mpre">
    { </span><a name="loc_112_7_112_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_7_112_18&#39;)"><span class="hl_fielddecl"><span class="mpre">coefficient</span></span></a><span class="mpre">    ::                !</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- ^ The coefficient of a scientific number.</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- Note that this number is not necessarily normalized, i.e.</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- it could contain trailing zeros.</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- Scientific numbers are automatically normalized when pretty printed or</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- in &#39;toDecimalDigits&#39;.</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- Use &#39;normalize&#39; to do manual normalization.</span></span><span class="mpre">

    , </span><a name="loc_123_7_123_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_21&#39;)"><span class="hl_fielddecl"><span class="mpre">base10Exponent</span></span></a><span class="mpre"> :: {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- ^ The base-10 exponent of a scientific number.</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 125, srcSpanStartColumn = 7, srcSpanEndLine = 125, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 125, srcSpanStartColumn = 7, srcSpanEndLine = 125, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific."><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @scientific c e@ constructs a scientific number which corresponds</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the &#39;Fractional&#39; number: @&#39;fromInteger&#39; c * 10 &#39;^^&#39; e@.</span></span><span class="mpre">
</span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="mpre">scientific</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre">
</span><a name="loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_vardecl"><span class="mpre">scientific</span></span></a><span class="mpre"> = </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Instances</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

instance </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Hashable</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">hashWithSalt</span></span><span class="mpre"> </span><a name="loc_140_18_140_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_18_140_22&#39;)"><span class="hl_vardecl"><span class="mpre">salt</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hashWithSalt</span></span><span class="mpre"> </span><a href="#loc_140_18_140_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_18_140_22&#39;)"><span class="hl_varref"><span class="mpre">salt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">(==)</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (==) #-}</span></span><span class="mpre">

    </span><span class="hl_vardecl"><span class="mpre">(/=)</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">(/=)</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (/=) #-}</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Ord</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">(&lt;)</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">(&lt;)</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&lt;) #-}</span></span><span class="mpre">

    </span><span class="hl_vardecl"><span class="mpre">(&lt;=)</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">(&lt;=)</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&lt;=) #-}</span></span><span class="mpre">

    </span><span class="hl_vardecl"><span class="mpre">(&gt;)</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">(&gt;)</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&gt;) #-}</span></span><span class="mpre">

    </span><span class="hl_vardecl"><span class="mpre">(&gt;=)</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">(&gt;=)</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&gt;=) #-}</span></span><span class="mpre">

    </span><span class="hl_vardecl"><span class="mpre">compare</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE compare #-}</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Num</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> where
    </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_166_16_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_16_166_18&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a name="loc_166_19_166_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_19_166_21&#39;)"><span class="hl_vardecl"><span class="mpre">e1</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_166_35_166_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_35_166_37&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> </span><a name="loc_166_38_166_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_38_166_40&#39;)"><span class="hl_vardecl"><span class="mpre">e2</span></span></a><span class="mpre">
       | </span><a href="#loc_166_19_166_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_19_166_21&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_166_38_166_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_38_166_40&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre">   = </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> (</span><a href="#loc_166_16_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_16_166_18&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">   </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_166_35_166_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_35_166_37&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_170_12_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_12_170_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_166_19_166_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_19_166_21&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> (</span><a href="#loc_166_16_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_16_166_18&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_171_12_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_12_171_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_166_35_166_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_35_166_37&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">  ) </span><a href="#loc_166_38_166_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_38_166_40&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre">
         where
           </span><a name="loc_170_12_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_12_170_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (</span><a href="#loc_166_38_166_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_38_166_40&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_166_19_166_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_19_166_21&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre">)
           </span><a name="loc_171_12_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_12_171_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (</span><a href="#loc_166_19_166_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_19_166_21&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_166_38_166_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_38_166_40&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (+) #-}</span></span><span class="mpre">

    </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_174_16_174_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_16_174_18&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a name="loc_174_19_174_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_19_174_21&#39;)"><span class="hl_vardecl"><span class="mpre">e1</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_174_35_174_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_35_174_37&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> </span><a name="loc_174_38_174_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_38_174_40&#39;)"><span class="hl_vardecl"><span class="mpre">e2</span></span></a><span class="mpre">
       | </span><a href="#loc_174_19_174_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_19_174_21&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_174_38_174_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_38_174_40&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre">   = </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> (</span><a href="#loc_174_16_174_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_16_174_18&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">   </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_174_35_174_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_35_174_37&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_174_19_174_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_19_174_21&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> (</span><a href="#loc_174_16_174_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_16_174_18&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_179_12_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_12_179_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_174_35_174_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_35_174_37&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">  ) </span><a href="#loc_174_38_174_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_38_174_40&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre">
         where
           </span><a name="loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (</span><a href="#loc_174_38_174_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_38_174_40&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_174_19_174_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_19_174_21&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre">)
           </span><a name="loc_179_12_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_12_179_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (</span><a href="#loc_174_19_174_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_19_174_21&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_174_38_174_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_38_174_40&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (-) #-}</span></span><span class="mpre">

    </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_182_16_182_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_16_182_18&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a name="loc_182_19_182_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_19_182_21&#39;)"><span class="hl_vardecl"><span class="mpre">e1</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_182_35_182_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_35_182_37&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> </span><a name="loc_182_38_182_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_38_182_40&#39;)"><span class="hl_vardecl"><span class="mpre">e2</span></span></a><span class="mpre"> =
        </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> (</span><a href="#loc_182_16_182_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_16_182_18&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_182_35_182_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_35_182_37&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">) (</span><a href="#loc_182_19_182_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_19_182_21&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_182_38_182_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_38_182_40&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (*) #-}</span></span><span class="mpre">

    </span><span class="hl_fundecl"><span class="mpre">abs</span></span><span class="mpre"> (</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_186_21_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_21_186_22&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_186_23_186_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_23_186_24&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) = </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_186_21_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_21_186_22&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_186_23_186_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_23_186_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE abs #-}</span></span><span class="mpre">

    </span><span class="hl_fundecl"><span class="mpre">negate</span></span><span class="mpre"> (</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_189_24_189_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_24_189_25&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_189_26_189_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_26_189_27&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) = </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">negate</span></span><span class="mpre"> </span><a href="#loc_189_24_189_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_24_189_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_189_26_189_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_26_189_27&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE negate #-}</span></span><span class="mpre">

    </span><span class="hl_fundecl"><span class="mpre">signum</span></span><span class="mpre"> (</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_192_24_192_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_24_192_25&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> _) = </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">signum</span></span><span class="mpre"> </span><a href="#loc_192_24_192_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_24_192_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE signum #-}</span></span><span class="mpre">

    </span><span class="hl_fundecl"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a name="loc_195_17_195_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_17_195_18&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> </span><a href="#loc_195_17_195_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_17_195_18&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE fromInteger #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /WARNING:/ &#39;toRational&#39; needs to compute the &#39;Integer&#39; magnitude:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @10^e@. If applied to a huge exponent this could fill up all space</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and crash your program!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Avoid applying &#39;toRational&#39; (or &#39;realToFrac&#39;) to scientific numbers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- coming from an untrusted source and use &#39;toRealFloat&#39; instead. The</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- latter guards against excessive space usage.</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Real</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">toRational</span></span><span class="mpre"> (</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_206_28_206_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_28_206_29&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_206_30_206_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_30_206_31&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)
      | </span><a href="#loc_206_30_206_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_30_206_31&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">     =  </span><a href="#loc_206_28_206_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_28_206_29&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">%</span></span><span class="mpre"> </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (-</span><a href="#loc_206_30_206_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_30_206_31&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (</span><a href="#loc_206_28_206_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_28_206_29&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre">   </span><a href="#loc_206_30_206_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_30_206_31&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">%</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE toRational #-}</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# RULES
  &quot;realToFrac_toRealFloat_Double&quot;
   realToFrac = toRealFloat :: Scientific -&gt; Double #-}</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# RULES
  &quot;realToFrac_toRealFloat_Float&quot;
   realToFrac = toRealFloat :: Scientific -&gt; Float #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /WARNING:/ &#39;recip&#39; and &#39;/&#39; will diverge when their outputs have</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an infinite decimal expansion. &#39;fromRational&#39; will diverge when the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- input &#39;Rational&#39; has an infinite decimal expansion.</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Fractional</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">recip</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromRational</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">recip</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE recip #-}</span></span><span class="mpre">

    </span><span class="hl_fundecl"><span class="mpre">fromRational</span></span><span class="mpre"> </span><a name="loc_226_18_226_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_18_226_26&#39;)"><span class="hl_vardecl"><span class="mpre">rational</span></span></a><span class="mpre"> = </span><a href="#loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="hl_varref"><span class="mpre">positivize</span></span></a><span class="mpre"> (</span><a href="#loc_230_9_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_16&#39;)"><span class="hl_varref"><span class="mpre">longDiv</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">numerator</span></span><span class="mpre"> </span><a href="#loc_226_18_226_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_18_226_26&#39;)"><span class="hl_varref"><span class="mpre">rational</span></span></a><span class="mpre">)
      where
        </span><span class="hl_comment"><span class="mpre">-- Divide the numerator by the denominator using long division.</span></span><span class="mpre">
        </span><a href="#loc_230_9_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_16&#39;)"><span class="mpre">longDiv</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre">)
        </span><a name="loc_230_9_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_16&#39;)"><span class="hl_fundecl"><span class="mpre">longDiv</span></span></a><span class="mpre"> !</span><a name="loc_230_18_230_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_18_230_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> !</span><a name="loc_230_21_230_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_21_230_22&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> </span><a href="#loc_230_18_230_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_18_230_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_230_21_230_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_21_230_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
        </span><a href="#loc_230_9_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_16&#39;)"><span class="hl_fundecl"><span class="mpre">longDiv</span></span></a><span class="mpre"> !</span><a name="loc_231_18_231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_18_231_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> !</span><a name="loc_231_21_231_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_21_231_22&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> !</span><a name="loc_231_24_231_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_24_231_25&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
                          </span><span class="hl_comment"><span class="mpre">-- TODO: Use a logarithm here!</span></span><span class="mpre">
            | </span><a href="#loc_231_24_231_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_24_231_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_238_9_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">     = </span><a href="#loc_230_9_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_16&#39;)"><span class="hl_varref"><span class="mpre">longDiv</span></span></a><span class="mpre"> (</span><a href="#loc_231_18_231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_18_231_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) (</span><a href="#loc_231_21_231_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_21_231_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_231_24_231_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_24_231_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_230_9_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_16&#39;)"><span class="hl_varref"><span class="mpre">longDiv</span></span></a><span class="mpre"> (</span><a href="#loc_231_18_231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_18_231_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_236_32_236_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_32_236_33&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">)   </span><a href="#loc_231_21_231_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_21_231_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">      </span><a href="#loc_236_35_236_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_35_236_36&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                            where
                              (</span><a name="loc_236_32_236_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_32_236_33&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">, </span><a name="loc_236_35_236_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_35_236_36&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_231_24_231_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_24_231_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><a href="#loc_238_9_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

        </span><a name="loc_238_9_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">denominator</span></span><span class="mpre"> </span><a href="#loc_226_18_226_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_18_226_26&#39;)"><span class="hl_varref"><span class="mpre">rational</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">RealFrac</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> where
    </span><span class="hl_comment"><span class="mpre">-- | The function &#39;properFraction&#39; takes a Scientific number @s@</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- and returns a pair @(n,f)@ such that @s = n+f@, and:</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- * @n@ is an integral number with the same sign as @s@; and</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- * @f@ is a fraction with the same type and sign as @s@,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   and with absolute value less than @1@.</span></span><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">properFraction</span></span><span class="mpre"> </span><a name="loc_248_20_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_20_248_21&#39;)"><span class="hl_specname"><span class="mpre">s</span></span></a><span class="mpre">@(</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_248_34_248_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_34_248_35&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_248_36_248_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_36_248_37&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)
        | </span><a href="#loc_248_36_248_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_36_248_37&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">     = if </span><a href="#loc_341_1_341_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_17&#39;)"><span class="hl_varref"><span class="mpre">dangerouslySmall</span></span></a><span class="mpre"> </span><a href="#loc_248_34_248_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_34_248_35&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_248_36_248_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_36_248_37&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                      then (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="#loc_248_20_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_20_248_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                      else let (</span><a name="loc_251_33_251_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_33_251_34&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">, </span><a name="loc_251_36_251_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_36_251_37&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_248_34_248_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_34_248_35&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (-</span><a href="#loc_248_36_248_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_36_248_37&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
                           in (</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a href="#loc_251_33_251_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_33_251_34&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">, </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> </span><a href="#loc_251_36_251_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_36_251_37&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_248_36_248_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_36_248_37&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (</span><a href="#loc_361_1_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_11&#39;)"><span class="hl_varref"><span class="mpre">toIntegral</span></span></a><span class="mpre"> </span><a href="#loc_248_20_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_20_248_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE properFraction #-}</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | @&#39;truncate&#39; s@ returns the integer nearest @s@</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- between zero and @s@</span></span><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">truncate</span></span><span class="mpre"> = </span><a href="#loc_353_1_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_13&#39;)"><span class="hl_varref"><span class="mpre">whenFloating</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_258_32_258_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_32_258_33&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_258_34_258_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_34_258_35&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
                 if </span><a href="#loc_341_1_341_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_17&#39;)"><span class="hl_varref"><span class="mpre">dangerouslySmall</span></span></a><span class="mpre"> </span><a href="#loc_258_32_258_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_32_258_33&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_258_34_258_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_34_258_35&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                 then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                 else </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_258_32_258_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_32_258_33&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (-</span><a href="#loc_258_34_258_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_34_258_35&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE truncate #-}</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | @&#39;round&#39; s@ returns the nearest integer to @s@;</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   the even integer if @s@ is equidistant between two integers</span></span><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">round</span></span><span class="mpre"> = </span><a href="#loc_353_1_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_13&#39;)"><span class="hl_varref"><span class="mpre">whenFloating</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_266_29_266_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_29_266_30&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_266_31_266_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_31_266_32&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
              if </span><a href="#loc_341_1_341_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_17&#39;)"><span class="hl_varref"><span class="mpre">dangerouslySmall</span></span></a><span class="mpre"> </span><a href="#loc_266_29_266_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_29_266_30&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_266_31_266_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_31_266_32&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
              then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
              else let (</span><a name="loc_269_25_269_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_25_269_26&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">, </span><a name="loc_269_28_269_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_28_269_29&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_266_29_266_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_29_266_30&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (-</span><a href="#loc_266_31_266_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_31_266_32&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
                       </span><a name="loc_270_24_270_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_24_270_25&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a href="#loc_269_25_269_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_25_269_26&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
                       </span><a name="loc_271_24_271_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_24_271_25&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = if </span><a href="#loc_269_28_269_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_28_269_29&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><a href="#loc_270_24_270_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_24_270_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> else </span><a href="#loc_270_24_270_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_24_270_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                       </span><a name="loc_272_24_272_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_24_272_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> </span><a href="#loc_269_28_269_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_28_269_29&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_266_31_266_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_31_266_32&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                   in case </span><span class="hl_varref"><span class="mpre">signum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_112_7_112_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_7_112_18&#39;)"><span class="hl_varref"><span class="mpre">coefficient</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_272_24_272_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_24_272_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.5</span></span><span class="mpre"> of
                        </span><span class="warning" data-warning="PatPNeg (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 274, srcSpanStartColumn = 25, srcSpanEndLine = 274, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 274, srcSpanStartColumn = 25, srcSpanEndLine = 274, srcSpanEndColumn = 26}]}) (PLit (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scie"><span class="mpre">-1</span></span><span class="mpre"> -&gt; </span><a href="#loc_270_24_270_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_24_270_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
                        </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  -&gt; if </span><span class="hl_varref"><span class="mpre">even</span></span><span class="mpre"> </span><a href="#loc_270_24_270_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_24_270_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> then </span><a href="#loc_270_24_270_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_24_270_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> else </span><a href="#loc_271_24_271_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_24_271_25&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
                        </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">  -&gt; </span><a href="#loc_271_24_271_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_24_271_25&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
                        _  -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;round default defn: Bad value&quot;</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE round #-}</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | @&#39;ceiling&#39; s@ returns the least integer not less than @s@</span></span><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">ceiling</span></span><span class="mpre"> = </span><a href="#loc_353_1_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_13&#39;)"><span class="hl_varref"><span class="mpre">whenFloating</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_281_31_281_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_31_281_32&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_281_33_281_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_33_281_34&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
                if </span><a href="#loc_341_1_341_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_17&#39;)"><span class="hl_varref"><span class="mpre">dangerouslySmall</span></span></a><span class="mpre"> </span><a href="#loc_281_31_281_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_31_281_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_281_33_281_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_33_281_34&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                then if </span><a href="#loc_281_31_281_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_31_281_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                     then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                     else </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                else let (</span><a name="loc_286_27_286_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_27_286_28&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">, </span><a name="loc_286_30_286_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_30_286_31&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_281_31_281_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_31_281_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (-</span><a href="#loc_281_33_281_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_33_281_34&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
                     in </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> if </span><a href="#loc_286_30_286_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_30_286_31&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><a href="#loc_286_27_286_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_27_286_28&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> else </span><a href="#loc_286_27_286_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_27_286_28&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE ceiling #-}</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | @&#39;floor&#39; s@ returns the greatest integer not greater than @s@</span></span><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">floor</span></span><span class="mpre"> = </span><a href="#loc_353_1_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_13&#39;)"><span class="hl_varref"><span class="mpre">whenFloating</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_291_29_291_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_29_291_30&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_291_31_291_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_31_291_32&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
              if </span><a href="#loc_341_1_341_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_17&#39;)"><span class="hl_varref"><span class="mpre">dangerouslySmall</span></span></a><span class="mpre"> </span><a href="#loc_291_29_291_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_29_291_30&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_291_31_291_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_31_291_32&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
              then if </span><a href="#loc_291_29_291_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_29_291_30&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                   then -</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                   else </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
              else </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><a href="#loc_291_29_291_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_29_291_30&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> (-</span><a href="#loc_291_31_291_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_31_291_32&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">))
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE floor #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Internal utilities</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This function is used in the &#39;RealFrac&#39; methods to guard against</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- computing a huge magnitude (-e) which could take up all space.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Think about parsing a scientific number from an untrusted</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- string. An attacker could supply 1e-1000000000. Lets say we want to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;floor&#39; that number to an &#39;Int&#39;. When we naively try to floor it</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- floor = whenFloating $ \c e -&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--           fromInteger (c `div` magnitude (-e))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We will compute the huge Integer: @magnitude 1000000000@. This</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- computation will quickly fill up all space and crash the program.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that for large /positive/ exponents there is no risk of a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- space-leak since &#39;whenFloating&#39; will compute:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @fromInteger c * magnitude e :: a@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- where @a@ is the target type (Int in this example). So here the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- space usage is bounded by the target type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For large negative exponents we check if the exponent is smaller</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- than some limit (currently -1100). In that case we know that the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- scientific number is really small (unless the coefficient has many</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- digits) so we can immediately return -1 for negative scientific</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- numbers or 0 for positive numbers.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- More precisely if @dangerouslySmall c e@ returns &#39;True&#39; the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- scientific number @s@ is guaranteed to be between:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @-0.1 &gt; s &lt; 0.1@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that we avoid computing the number of decimal digits in c</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (log10 c) if the exponent is not below the limit.</span></span><span class="mpre">
</span><a href="#loc_341_1_341_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_17&#39;)"><span class="mpre">dangerouslySmall</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_341_1_341_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_17&#39;)"><span class="hl_fundecl"><span class="mpre">dangerouslySmall</span></span></a><span class="mpre"> </span><a name="loc_341_18_341_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_18_341_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> (-</span><a href="#loc_345_1_345_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_1_345_6&#39;)"><span class="hl_varref"><span class="mpre">limit</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> (-</span><a href="Math.NumberTheory.Logarithms.html#loc_116_1_116_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Math.NumberTheory.Logarithms.html#loc_116_1_116_14&#39;)"><span class="hl_varref"><span class="mpre">integerLog10&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_341_18_341_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_18_341_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_341_1_341_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_17&#39;)"><span class="mpre">dangerouslySmall</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_345_1_345_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_1_345_6&#39;)"><span class="mpre">limit</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_345_1_345_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_1_345_6&#39;)"><span class="hl_vardecl"><span class="mpre">limit</span></span></a><span class="mpre"> = </span><a href="#loc_371_1_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_8&#39;)"><span class="hl_varref"><span class="mpre">maxExpt</span></span></a><span class="mpre">

</span><a href="#loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="mpre">positivize</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 347, srcSpanStartColumn = 15, srcSpanEndLine = 347, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 347, srcSpanStartColumn = 15, srcSpanEndLine = 347, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific"><span class="mpre">(Ord a, Num a, Num b) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="hl_fundecl"><span class="mpre">positivize</span></span></a><span class="mpre"> </span><a name="loc_348_12_348_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_12_348_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_348_14_348_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_14_348_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_348_14_348_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_14_348_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">      = -(</span><a href="#loc_348_12_348_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_12_348_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (-</span><a href="#loc_348_14_348_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_14_348_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =    </span><a href="#loc_348_12_348_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_12_348_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">   </span><a href="#loc_348_14_348_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_14_348_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="mpre">positivize</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_353_1_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_13&#39;)"><span class="mpre">whenFloating</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 352, srcSpanStartColumn = 17, srcSpanEndLine = 352, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 352, srcSpanStartColumn = 17, srcSpanEndLine = 352, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific"><span class="mpre">(Num a) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_353_1_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_13&#39;)"><span class="hl_fundecl"><span class="mpre">whenFloating</span></span></a><span class="mpre"> </span><a name="loc_353_14_353_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_14_353_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_353_16_353_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_16_353_17&#39;)"><span class="hl_specname"><span class="mpre">s</span></span></a><span class="mpre">@(</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_353_30_353_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_30_353_31&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_353_32_353_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_32_353_33&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)
    | </span><a href="#loc_353_32_353_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_32_353_33&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">     = </span><a href="#loc_353_14_353_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_14_353_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_353_30_353_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_30_353_31&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_353_32_353_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_32_353_33&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_361_1_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_11&#39;)"><span class="hl_varref"><span class="mpre">toIntegral</span></span></a><span class="mpre"> </span><a href="#loc_353_16_353_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_16_353_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_353_1_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_13&#39;)"><span class="mpre">whenFloating</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Precondition: the &#39;Scientific&#39; @s@ needs to be an integer:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @base10Exponent (normalize s) &gt;= 0@</span></span><span class="mpre">
</span><a href="#loc_361_1_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_11&#39;)"><span class="mpre">toIntegral</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 360, srcSpanStartColumn = 15, srcSpanEndLine = 360, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 360, srcSpanStartColumn = 15, srcSpanEndLine = 360, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific"><span class="mpre">(Num a) =&gt;</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_361_1_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_11&#39;)"><span class="hl_fundecl"><span class="mpre">toIntegral</span></span></a><span class="mpre"> (</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_361_24_361_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_24_361_25&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_361_26_361_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_26_361_27&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a href="#loc_361_24_361_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_24_361_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> </span><a href="#loc_361_26_361_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_26_361_27&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_361_1_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_11&#39;)"><span class="mpre">toIntegral</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Exponentiation with a cache for the most common numbers.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The same limit as in GHC.Float.</span></span><span class="mpre">
</span><a href="#loc_371_1_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_8&#39;)"><span class="mpre">maxExpt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_371_1_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_8&#39;)"><span class="hl_vardecl"><span class="mpre">maxExpt</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">324</span></span><span class="mpre">

</span><a href="#loc_374_1_374_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_8&#39;)"><span class="mpre">expts10</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_374_1_374_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_8&#39;)"><span class="hl_vardecl"><span class="mpre">expts10</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">listArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="#loc_371_1_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_8&#39;)"><span class="hl_varref"><span class="mpre">maxExpt</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_377_7_377_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_7_377_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
    where
      </span><a href="#loc_377_7_377_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_7_377_9&#39;)"><span class="mpre">go</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">]
      </span><a name="loc_377_7_377_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_7_377_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_377_11_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_11_377_13&#39;)"><span class="hl_vardecl"><span class="mpre">ix</span></span></a><span class="mpre"> = </span><a href="#loc_379_13_379_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_13_379_15&#39;)"><span class="hl_varref"><span class="mpre">xx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_379_13_379_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_13_379_15&#39;)"><span class="hl_varref"><span class="mpre">xx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_377_7_377_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_7_377_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_377_11_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_11_377_13&#39;)"><span class="hl_varref"><span class="mpre">ix</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
          where
            </span><a name="loc_379_13_379_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_13_379_15&#39;)"><span class="hl_vardecl"><span class="mpre">xx</span></span></a><span class="mpre"> = </span><a href="#loc_380_13_380_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_380_13_380_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_380_13_380_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_380_13_380_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            </span><a name="loc_380_13_380_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_380_13_380_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  = </span><a href="#loc_374_1_374_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_8&#39;)"><span class="hl_varref"><span class="mpre">expts10</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!</span></span><span class="mpre"> </span><a href="#loc_383_13_383_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_13_383_17&#39;)"><span class="hl_varref"><span class="mpre">half</span></span></a><span class="mpre">

#if MIN_VERSION_base(4,5,0)
            </span><a name="loc_383_13_383_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_13_383_17&#39;)"><span class="hl_vardecl"><span class="mpre">half</span></span></a><span class="mpre"> = </span><a href="#loc_377_11_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_11_377_13&#39;)"><span class="hl_varref"><span class="mpre">ix</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_240_5_240_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_240_5_240_17&#39;)"><span class="hl_infix"><span class="mpre">`unsafeShiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
#else
            </span><span class="hl_vardecl"><span class="mpre">half</span></span><span class="mpre"> = </span><a href="#loc_377_11_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_11_377_13&#39;)"><span class="hl_varref"><span class="mpre">ix</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | @magnitude e == 10 ^ e@</span></span><span class="mpre">
</span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="mpre">magnitude</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 389, srcSpanStartColumn = 14, srcSpanEndLine = 389, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 389, srcSpanStartColumn = 14, srcSpanEndLine = 389, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific"><span class="mpre">(Num a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="hl_fundecl"><span class="mpre">magnitude</span></span></a><span class="mpre"> </span><a name="loc_390_11_390_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_11_390_12&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> | </span><a href="#loc_390_11_390_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_11_390_12&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_371_1_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_8&#39;)"><span class="hl_varref"><span class="mpre">maxExpt</span></span></a><span class="mpre"> = </span><a href="#loc_393_7_393_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_7_393_18&#39;)"><span class="hl_varref"><span class="mpre">cachedPow10</span></span></a><span class="mpre"> </span><a href="#loc_390_11_390_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_11_390_12&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    = </span><a href="#loc_393_7_393_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_7_393_18&#39;)"><span class="hl_varref"><span class="mpre">cachedPow10</span></span></a><span class="mpre"> </span><a href="#loc_371_1_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_8&#39;)"><span class="hl_varref"><span class="mpre">maxExpt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre"> (</span><a href="#loc_390_11_390_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_11_390_12&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_371_1_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_8&#39;)"><span class="hl_varref"><span class="mpre">maxExpt</span></span></a><span class="mpre">)
    where
      </span><a name="loc_393_7_393_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_7_393_18&#39;)"><span class="hl_fundecl"><span class="mpre">cachedPow10</span></span></a><span class="mpre"> </span><a name="loc_393_19_393_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_19_393_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><a href="#loc_374_1_374_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_8&#39;)"><span class="hl_varref"><span class="mpre">expts10</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!</span></span><span class="mpre"> </span><a href="#loc_393_19_393_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_19_393_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_390_1_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_10&#39;)"><span class="mpre">magnitude</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Conversions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a &#39;RealFloat&#39; (like a &#39;Double&#39; or &#39;Float&#39;) into a &#39;Scientific&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- number.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that this function uses &#39;Numeric.floatToDigits&#39; to compute the digits</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and exponent of the &#39;RealFloat&#39; number. Be aware that the algorithm used in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Numeric.floatToDigits&#39; doesn&#39;t work as expected for some numbers, e.g. as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the &#39;Double&#39; @1e23@ is converted to @9.9999999999999991611392e22@, and that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- value is shown as @9.999999999999999e22@ rather than the shorter @1e23@; the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- algorithm doesn&#39;t take the rounding direction for values exactly half-way</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- between two adjacent representable values into account, so if you have a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- value with a short decimal representation exactly half-way between two</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- adjacent representable values, like @5^23*2^e@ for @e@ close to 23, the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- algorithm doesn&#39;t know in which direction the short decimal representation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- would be rounded and computes more digits</span></span><span class="mpre">
</span><a href="#loc_416_1_416_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_16&#39;)"><span class="mpre">fromFloatDigits</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 415, srcSpanStartColumn = 20, srcSpanEndLine = 415, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 415, srcSpanStartColumn = 20, srcSpanEndLine = 415, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific"><span class="mpre">(RealFloat a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre">
</span><a name="loc_416_1_416_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_16&#39;)"><span class="hl_vardecl"><span class="mpre">fromFloatDigits</span></span></a><span class="mpre"> = </span><a href="#loc_348_1_348_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_11&#39;)"><span class="hl_varref"><span class="mpre">positivize</span></span></a><span class="mpre"> </span><a href="#loc_418_7_418_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_7_418_26&#39;)"><span class="hl_varref"><span class="mpre">fromNonNegRealFloat</span></span></a><span class="mpre">
    where
      </span><a name="loc_418_7_418_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_7_418_26&#39;)"><span class="hl_fundecl"><span class="mpre">fromNonNegRealFloat</span></span></a><span class="mpre"> </span><a name="loc_418_27_418_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_27_418_28&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_422_11_422_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_11_422_13&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_420_12_420_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_12_420_18&#39;)"><span class="hl_varref"><span class="mpre">digits</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        where
          (</span><a name="loc_420_12_420_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_12_420_18&#39;)"><span class="hl_vardecl"><span class="mpre">digits</span></span></a><span class="mpre">, </span><a name="loc_420_20_420_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_20_420_21&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">Numeric.floatToDigits</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_418_27_418_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_27_418_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

          </span><a name="loc_422_11_422_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_11_422_13&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> []     !</span><a name="loc_422_22_422_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_22_422_23&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> !</span><a name="loc_422_25_422_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_25_422_26&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a href="#loc_422_22_422_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_22_422_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_420_20_420_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_20_420_21&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_422_25_422_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_25_422_26&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
          </span><a href="#loc_422_11_422_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_11_422_13&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_423_15_423_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_15_423_16&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_423_17_423_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_17_423_19&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">) !</span><a name="loc_423_22_423_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_22_423_23&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> !</span><a name="loc_423_25_423_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_25_423_26&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_422_11_422_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_11_422_13&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_423_17_423_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_17_423_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre"> (</span><a href="#loc_423_22_423_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_22_423_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_423_15_423_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_15_423_16&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">) (</span><a href="#loc_423_25_423_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_25_423_26&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Convert a &#39;Scientific&#39; number into a &#39;RealFloat&#39; (like a &#39;Double&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or a &#39;Float&#39;).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that this function uses &#39;realToFrac&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (@&#39;fromRational&#39; . &#39;toRational&#39;@) internally but it guards against</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- computing huge Integer magnitudes (@10^e@) that could fill up all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- space and crash your program.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Always prefer &#39;toRealFloat&#39; over &#39;realToFrac&#39; when converting from</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- scientific numbers coming from an untrusted source.</span></span><span class="mpre">
</span><a href="#loc_436_1_436_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_1_436_12&#39;)"><span class="mpre">toRealFloat</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 435, srcSpanStartColumn = 26, srcSpanEndLine = 435, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 435, srcSpanStartColumn = 26, srcSpanEndLine = 435, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific"><span class="mpre">(RealFloat a) =&gt;</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_436_1_436_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_1_436_12&#39;)"><span class="hl_fundecl"><span class="mpre">toRealFloat</span></span></a><span class="mpre"> </span><a name="loc_436_13_436_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_13_436_14&#39;)"><span class="hl_specname"><span class="mpre">s</span></span></a><span class="mpre">@(</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_436_27_436_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_27_436_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_436_29_436_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_29_436_30&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)
    | </span><a href="#loc_436_29_436_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_29_436_30&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre">  </span><a href="#loc_345_1_345_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_1_345_6&#39;)"><span class="hl_varref"><span class="mpre">limit</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_436_29_436_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_29_436_30&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_441_15_441_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_15_441_22&#39;)"><span class="hl_varref"><span class="mpre">hiLimit</span></span></a><span class="mpre">                    = </span><a href="#loc_445_5_445_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_5_445_9&#39;)"><span class="hl_varref"><span class="mpre">sign</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="hl_infix"><span class="mpre">/</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- Infinity</span></span><span class="mpre">
    | </span><a href="#loc_436_29_436_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_29_436_30&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> -</span><a href="#loc_345_1_345_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_1_345_6&#39;)"><span class="hl_varref"><span class="mpre">limit</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_436_29_436_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_29_436_30&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_441_6_441_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_6_441_13&#39;)"><span class="hl_varref"><span class="mpre">loLimit</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_436_29_436_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_29_436_30&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_443_5_443_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_5_443_6&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_441_6_441_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_6_441_13&#39;)"><span class="hl_varref"><span class="mpre">loLimit</span></span></a><span class="mpre"> = </span><a href="#loc_445_5_445_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_5_445_9&#39;)"><span class="hl_varref"><span class="mpre">sign</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                                    = </span><span class="hl_varref"><span class="mpre">realToFrac</span></span><span class="mpre"> </span><a href="#loc_436_13_436_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_13_436_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  where
    (</span><a name="loc_441_6_441_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_6_441_13&#39;)"><span class="hl_vardecl"><span class="mpre">loLimit</span></span></a><span class="mpre">, </span><a name="loc_441_15_441_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_15_441_22&#39;)"><span class="hl_vardecl"><span class="mpre">hiLimit</span></span></a><span class="mpre">) = </span><a href="#loc_449_1_449_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_1_449_15&#39;)"><span class="hl_varref"><span class="mpre">exponentLimits</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)

    </span><a name="loc_443_5_443_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_5_443_6&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="Math.NumberTheory.Logarithms.html#loc_116_1_116_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Math.NumberTheory.Logarithms.html#loc_116_1_116_14&#39;)"><span class="hl_varref"><span class="mpre">integerLog10&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_436_27_436_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_27_436_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

    </span><a name="loc_445_5_445_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_5_445_9&#39;)"><span class="hl_fundecl"><span class="mpre">sign</span></span></a><span class="mpre"> </span><a name="loc_445_10_445_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_10_445_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_436_27_436_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_27_436_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">     = -</span><a href="#loc_445_10_445_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_10_445_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =  </span><a href="#loc_445_10_445_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_10_445_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_449_1_449_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_1_449_15&#39;)"><span class="mpre">exponentLimits</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 448, srcSpanStartColumn = 29, srcSpanEndLine = 448, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 448, srcSpanStartColumn = 29, srcSpanEndLine = 448, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific"><span class="mpre">(RealFloat a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_449_1_449_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_1_449_15&#39;)"><span class="hl_fundecl"><span class="mpre">exponentLimits</span></span></a><span class="mpre"> _ = (</span><a href="#loc_451_7_451_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_7_451_14&#39;)"><span class="hl_varref"><span class="mpre">loLimit</span></span></a><span class="mpre">, </span><a href="#loc_453_7_453_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_7_453_14&#39;)"><span class="hl_varref"><span class="mpre">hiLimit</span></span></a><span class="mpre">)
    where
      </span><a name="loc_451_7_451_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_7_451_14&#39;)"><span class="hl_vardecl"><span class="mpre">loLimit</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">floor</span></span><span class="mpre">   (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_460_8_460_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_8_460_10&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre">     </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_456_7_456_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_7_456_17&#39;)"><span class="hl_varref"><span class="mpre">log10Radix</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">ceiling</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_459_7_459_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_7_459_13&#39;)"><span class="hl_varref"><span class="mpre">digits</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_456_7_456_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_7_456_17&#39;)"><span class="hl_varref"><span class="mpre">log10Radix</span></span></a><span class="mpre">)
      </span><a name="loc_453_7_453_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_7_453_14&#39;)"><span class="hl_vardecl"><span class="mpre">hiLimit</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">ceiling</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_460_12_460_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_12_460_14&#39;)"><span class="hl_varref"><span class="mpre">hi</span></span></a><span class="mpre">     </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_456_7_456_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_7_456_17&#39;)"><span class="hl_varref"><span class="mpre">log10Radix</span></span></a><span class="mpre">)

      </span><a href="#loc_456_7_456_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_7_456_17&#39;)"><span class="mpre">log10Radix</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
      </span><a name="loc_456_7_456_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_7_456_17&#39;)"><span class="hl_vardecl"><span class="mpre">log10Radix</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">logBase</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a href="#loc_458_7_458_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_7_458_12&#39;)"><span class="hl_varref"><span class="mpre">radix</span></span></a><span class="mpre">

      </span><a name="loc_458_7_458_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_7_458_12&#39;)"><span class="hl_vardecl"><span class="mpre">radix</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">floatRadix</span></span><span class="mpre">  (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
      </span><a name="loc_459_7_459_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_7_459_13&#39;)"><span class="hl_vardecl"><span class="mpre">digits</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">floatDigits</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
      (</span><a name="loc_460_8_460_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_8_460_10&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre">, </span><a name="loc_460_12_460_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_12_460_14&#39;)"><span class="hl_vardecl"><span class="mpre">hi</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">floatRange</span></span><span class="mpre">  (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @floatingOrInteger@ determines if the scientific is floating point</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or integer. In case it&#39;s floating-point the scientific is converted</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the desired &#39;RealFloat&#39; using &#39;toRealFloat&#39;.</span></span><span class="mpre">
</span><a href="#loc_466_1_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_18&#39;)"><span class="mpre">floatingOrInteger</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 465, srcSpanStartColumn = 22, srcSpanEndLine = 465, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 465, srcSpanStartColumn = 22, srcSpanEndLine = 465, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific"><span class="mpre">(RealFloat r, Integral i) =&gt;</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre">
</span><a name="loc_466_1_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_18&#39;)"><span class="hl_fundecl"><span class="mpre">floatingOrInteger</span></span></a><span class="mpre"> </span><a name="loc_466_19_466_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_19_466_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">
    | </span><a href="#loc_123_7_123_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_21&#39;)"><span class="hl_varref"><span class="mpre">base10Exponent</span></span></a><span class="mpre"> </span><a href="#loc_466_19_466_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_19_466_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_361_1_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_11&#39;)"><span class="hl_varref"><span class="mpre">toIntegral</span></span></a><span class="mpre">   </span><a href="#loc_466_19_466_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_19_466_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    | </span><a href="#loc_123_7_123_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_21&#39;)"><span class="hl_varref"><span class="mpre">base10Exponent</span></span></a><span class="mpre"> </span><a href="#loc_471_5_471_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_5_471_7&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_361_1_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_11&#39;)"><span class="hl_varref"><span class="mpre">toIntegral</span></span></a><span class="mpre">   </span><a href="#loc_471_5_471_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_5_471_7&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  (</span><a href="#loc_436_1_436_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_1_436_12&#39;)"><span class="hl_varref"><span class="mpre">toRealFloat</span></span></a><span class="mpre">  </span><a href="#loc_471_5_471_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_5_471_7&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">)
  where
    </span><a name="loc_471_5_471_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_5_471_7&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_684_1_684_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_10&#39;)"><span class="hl_varref"><span class="mpre">normalize</span></span></a><span class="mpre"> </span><a href="#loc_466_19_466_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_19_466_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Parsing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Read</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">readPrec</span></span><span class="mpre"> = </span><a href="Text.ParserCombinators.ReadPrec.html#loc_99_1_99_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadPrec.html#loc_99_1_99_5&#39;)"><span class="hl_varref"><span class="mpre">ReadPrec.lift</span></span></a><span class="mpre"> </span><a href="#loc_485_1_485_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_1_485_12&#39;)"><span class="hl_varref"><span class="mpre">scientificP</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- A strict pair</span></span><span class="mpre">
data </span><span class="hl_tycondecl"><span class="mpre">SP</span></span><span class="mpre"> = </span><a name="loc_482_11_482_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_11_482_13&#39;)"><span class="hl_condecl"><span class="mpre">SP</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> {-# UNPACK #-}!</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">

</span><a href="#loc_485_1_485_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_1_485_12&#39;)"><span class="mpre">scientificP</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre">
</span><a name="loc_485_1_485_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_1_485_12&#39;)"><span class="hl_vardecl"><span class="mpre">scientificP</span></span></a><span class="mpre"> = do
  let </span><a name="loc_486_7_486_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_486_7_486_15&#39;)"><span class="hl_vardecl"><span class="mpre">positive</span></span></a><span class="mpre"> = ((</span><span class="hl_char"><span class="mpre">&#39;+&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.ReadP.html#loc_238_1_238_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_238_1_238_8&#39;)"><span class="hl_varref"><span class="mpre">ReadP.satisfy</span></span></a><span class="mpre"> </span><a href="#loc_531_1_531_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_1_531_7&#39;)"><span class="hl_varref"><span class="mpre">isSign</span></span></a><span class="mpre">) </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  </span><a name="loc_487_3_487_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_3_487_6&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_486_7_486_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_486_7_486_15&#39;)"><span class="hl_varref"><span class="mpre">positive</span></span></a><span class="mpre">

  let </span><a href="#loc_490_7_490_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_7_490_11&#39;)"><span class="mpre">step</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 489, srcSpanStartColumn = 15, srcSpanEndLine = 489, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Data/Scientific.hs&quot;, srcSpanStartLine = 489, srcSpanStartColumn = 21, srcSpanEndLine = 489, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">Num a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
      </span><a name="loc_490_7_490_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_7_490_11&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_490_12_490_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_12_490_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_490_14_490_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_14_490_19&#39;)"><span class="hl_vardecl"><span class="mpre">digit</span></span></a><span class="mpre"> = </span><a href="#loc_490_12_490_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_12_490_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_490_14_490_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_14_490_19&#39;)"><span class="hl_varref"><span class="mpre">digit</span></span></a><span class="mpre">
      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_490_7_490_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_7_490_11&#39;)"><span class="mpre">step</span></a><span class="mpre"> #-}</span></span><span class="mpre">

  </span><a name="loc_493_3_493_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_3_493_4&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_516_1_516_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_1_516_11&#39;)"><span class="hl_varref"><span class="mpre">foldDigits</span></span></a><span class="mpre"> </span><a href="#loc_490_7_490_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_7_490_11&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

  let </span><a name="loc_495_7_495_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_7_495_8&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_482_11_482_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_11_482_13&#39;)"><span class="hl_conref"><span class="mpre">SP</span></span></a><span class="mpre"> </span><a href="#loc_493_3_493_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_3_493_4&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      </span><a name="loc_496_7_496_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_7_496_17&#39;)"><span class="hl_vardecl"><span class="mpre">fractional</span></span></a><span class="mpre"> = </span><a href="#loc_516_1_516_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_1_516_11&#39;)"><span class="hl_varref"><span class="mpre">foldDigits</span></span></a><span class="mpre"> (\(</span><a href="#loc_482_11_482_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_11_482_13&#39;)"><span class="hl_conref"><span class="mpre">SP</span></span></a><span class="mpre"> </span><a name="loc_496_37_496_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_37_496_38&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_496_39_496_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_39_496_40&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) </span><a name="loc_496_42_496_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_42_496_47&#39;)"><span class="hl_vardecl"><span class="mpre">digit</span></span></a><span class="mpre"> -&gt;
                                 </span><a href="#loc_482_11_482_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_11_482_13&#39;)"><span class="hl_conref"><span class="mpre">SP</span></span></a><span class="mpre"> (</span><a href="#loc_490_7_490_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_7_490_11&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_496_37_496_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_37_496_38&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_496_42_496_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_42_496_47&#39;)"><span class="hl_varref"><span class="mpre">digit</span></span></a><span class="mpre">) (</span><a href="#loc_496_39_496_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_39_496_40&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) </span><a href="#loc_495_7_495_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_7_495_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

  </span><a href="#loc_482_11_482_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_11_482_13&#39;)"><span class="hl_conref"><span class="mpre">SP</span></span></a><span class="mpre"> </span><a name="loc_499_6_499_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_6_499_11&#39;)"><span class="hl_vardecl"><span class="mpre">coeff</span></span></a><span class="mpre"> </span><a name="loc_499_12_499_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_12_499_17&#39;)"><span class="hl_vardecl"><span class="mpre">expnt</span></span></a><span class="mpre"> &lt;- (</span><a href="Text.ParserCombinators.ReadP.html#loc_238_1_238_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_238_1_238_8&#39;)"><span class="hl_varref"><span class="mpre">ReadP.satisfy</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_496_7_496_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_7_496_17&#39;)"><span class="hl_varref"><span class="mpre">fractional</span></span></a><span class="mpre">)
                      </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_495_7_495_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_7_495_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

  let </span><a name="loc_502_7_502_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_7_502_18&#39;)"><span class="hl_vardecl"><span class="mpre">signedCoeff</span></span></a><span class="mpre"> | </span><a href="#loc_487_3_487_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_3_487_6&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre">       =   </span><a href="#loc_499_6_499_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_6_499_11&#39;)"><span class="hl_varref"><span class="mpre">coeff</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (-</span><a href="#loc_499_6_499_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_6_499_11&#39;)"><span class="hl_varref"><span class="mpre">coeff</span></span></a><span class="mpre">)

      </span><a name="loc_505_7_505_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_7_505_9&#39;)"><span class="hl_vardecl"><span class="mpre">eP</span></span></a><span class="mpre"> = do </span><a name="loc_505_15_505_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_15_505_19&#39;)"><span class="hl_vardecl"><span class="mpre">posE</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_486_7_486_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_486_7_486_15&#39;)"><span class="hl_varref"><span class="mpre">positive</span></span></a><span class="mpre">
              </span><a name="loc_506_15_506_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_15_506_16&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_516_1_516_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_1_516_11&#39;)"><span class="hl_varref"><span class="mpre">foldDigits</span></span></a><span class="mpre"> </span><a href="#loc_490_7_490_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_7_490_11&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
              if </span><a href="#loc_505_15_505_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_15_505_19&#39;)"><span class="hl_varref"><span class="mpre">posE</span></span></a><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">   </span><a href="#loc_506_15_506_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_15_506_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (-</span><a href="#loc_506_15_506_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_15_506_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)

  (</span><a href="Text.ParserCombinators.ReadP.html#loc_238_1_238_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_238_1_238_8&#39;)"><span class="hl_varref"><span class="mpre">ReadP.satisfy</span></span></a><span class="mpre"> </span><a href="#loc_535_1_535_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_1_535_4&#39;)"><span class="hl_varref"><span class="mpre">isE</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre">
           ((</span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> </span><a href="#loc_502_7_502_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_7_502_18&#39;)"><span class="hl_varref"><span class="mpre">signedCoeff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_499_12_499_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_12_499_17&#39;)"><span class="hl_varref"><span class="mpre">expnt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre">)) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_505_7_505_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_7_505_9&#39;)"><span class="hl_varref"><span class="mpre">eP</span></span></a><span class="mpre">)) </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre">
     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">scientific</span></span></a><span class="mpre"> </span><a href="#loc_502_7_502_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_7_502_18&#39;)"><span class="hl_varref"><span class="mpre">signedCoeff</span></span></a><span class="mpre">    </span><a href="#loc_499_12_499_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_12_499_17&#39;)"><span class="hl_varref"><span class="mpre">expnt</span></span></a><span class="mpre">)

</span><a href="#loc_516_1_516_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_1_516_11&#39;)"><span class="mpre">foldDigits</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_516_1_516_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_1_516_11&#39;)"><span class="hl_fundecl"><span class="mpre">foldDigits</span></span></a><span class="mpre"> </span><a name="loc_516_12_516_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_12_516_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_516_14_516_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_14_516_15&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="Text.ParserCombinators.ReadP.html#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_190_1_190_5&#39;)"><span class="hl_varref"><span class="mpre">ReadP.look</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_518_7_518_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_7_518_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_516_14_516_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_14_516_15&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
    where
      </span><a name="loc_518_7_518_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_7_518_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_518_11_518_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_11_518_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_518_11_518_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_11_518_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
      </span><a href="#loc_518_7_518_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_7_518_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_519_11_519_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_11_519_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a name="loc_519_14_519_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_14_519_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_519_16_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_16_519_18&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
          | </span><a href="#loc_527_1_527_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_527_1_527_10&#39;)"><span class="hl_varref"><span class="mpre">isDecimal</span></span></a><span class="mpre"> </span><a href="#loc_519_14_519_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_14_519_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = do
              _ &lt;- </span><a href="Text.ParserCombinators.ReadP.html#loc_185_1_185_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_185_1_185_4&#39;)"><span class="hl_varref"><span class="mpre">ReadP.get</span></span></a><span class="mpre">
              let </span><a name="loc_522_19_522_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_19_522_24&#39;)"><span class="hl_vardecl"><span class="mpre">digit</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_519_14_519_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_14_519_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">
              </span><a href="#loc_518_7_518_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_7_518_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_516_12_516_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_12_516_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_519_11_519_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_11_519_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_522_19_522_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_19_522_24&#39;)"><span class="hl_varref"><span class="mpre">digit</span></span></a><span class="mpre">) </span><a href="#loc_519_16_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_16_519_18&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_519_11_519_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_11_519_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

</span><a href="#loc_527_1_527_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_527_1_527_10&#39;)"><span class="mpre">isDecimal</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_527_1_527_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_527_1_527_10&#39;)"><span class="hl_fundecl"><span class="mpre">isDecimal</span></span></a><span class="mpre"> </span><a name="loc_527_11_527_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_527_11_527_12&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_527_11_527_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_527_11_527_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_527_11_527_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_527_11_527_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;9&#39;</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_527_1_527_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_527_1_527_10&#39;)"><span class="mpre">isDecimal</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_531_1_531_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_1_531_7&#39;)"><span class="mpre">isSign</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_531_1_531_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_1_531_7&#39;)"><span class="hl_fundecl"><span class="mpre">isSign</span></span></a><span class="mpre"> </span><a name="loc_531_8_531_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_8_531_9&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_531_8_531_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_8_531_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_531_8_531_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_8_531_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;+&#39;</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_531_1_531_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_1_531_7&#39;)"><span class="mpre">isSign</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_535_1_535_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_1_535_4&#39;)"><span class="mpre">isE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_535_1_535_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_1_535_4&#39;)"><span class="hl_fundecl"><span class="mpre">isE</span></span></a><span class="mpre"> </span><a name="loc_535_5_535_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_5_535_6&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_535_5_535_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_5_535_6&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;e&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_535_5_535_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_5_535_6&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;E&#39;</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_535_1_535_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_1_535_4&#39;)"><span class="mpre">isE</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Pretty Printing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">show</span></span><span class="mpre"> = </span><a href="#loc_551_1_551_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_17&#39;)"><span class="hl_varref"><span class="mpre">formatScientific</span></span></a><span class="mpre"> </span><a href="Data.Text.Lazy.Builder.RealFloat.html#loc_33_17_33_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.RealFloat.html#loc_33_17_33_24&#39;)"><span class="hl_conref"><span class="mpre">Generic</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;show&#39; but provides rendering options.</span></span><span class="mpre">
</span><a href="#loc_551_1_551_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_17&#39;)"><span class="mpre">formatScientific</span></a><span class="mpre"> :: </span><a href="Data.Text.Lazy.Builder.RealFloat.html#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.RealFloat.html#loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">FPFormat</span></span></a><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Number of decimal places to render.</span></span><span class="mpre">
                 -&gt; </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_551_1_551_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_17&#39;)"><span class="hl_fundecl"><span class="mpre">formatScientific</span></span></a><span class="mpre"> </span><a name="loc_551_18_551_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_18_551_21&#39;)"><span class="hl_vardecl"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><a name="loc_551_22_551_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_22_551_26&#39;)"><span class="hl_vardecl"><span class="mpre">decs</span></span></a><span class="mpre"> </span><a name="loc_551_27_551_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_27_551_33&#39;)"><span class="hl_specname"><span class="mpre">scntfc</span></span></a><span class="mpre">@(</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_551_46_551_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_46_551_47&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> _)
   | </span><a href="#loc_551_46_551_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_46_551_47&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">     = </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_556_5_556_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_5_556_10&#39;)"><span class="hl_varref"><span class="mpre">doFmt</span></span></a><span class="mpre"> </span><a href="#loc_551_18_551_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_18_551_21&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> (</span><a href="#loc_654_1_654_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_654_1_654_16&#39;)"><span class="hl_varref"><span class="mpre">toDecimalDigits</span></span></a><span class="mpre"> (-</span><a href="#loc_551_27_551_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_27_551_33&#39;)"><span class="hl_varref"><span class="mpre">scntfc</span></span></a><span class="mpre">))
   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =     </span><a href="#loc_556_5_556_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_5_556_10&#39;)"><span class="hl_varref"><span class="mpre">doFmt</span></span></a><span class="mpre"> </span><a href="#loc_551_18_551_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_18_551_21&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> (</span><a href="#loc_654_1_654_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_654_1_654_16&#39;)"><span class="hl_varref"><span class="mpre">toDecimalDigits</span></span></a><span class="mpre">   </span><a href="#loc_551_27_551_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_27_551_33&#39;)"><span class="hl_varref"><span class="mpre">scntfc</span></span></a><span class="mpre"> )
  where
    </span><a href="#loc_556_5_556_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_5_556_10&#39;)"><span class="mpre">doFmt</span></a><span class="mpre"> :: </span><a href="Data.Text.Lazy.Builder.RealFloat.html#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.RealFloat.html#loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">FPFormat</span></span></a><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    </span><a name="loc_556_5_556_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_5_556_10&#39;)"><span class="hl_fundecl"><span class="mpre">doFmt</span></span></a><span class="mpre"> </span><a name="loc_556_11_556_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_11_556_17&#39;)"><span class="hl_vardecl"><span class="mpre">format</span></span></a><span class="mpre"> (</span><a name="loc_556_19_556_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_19_556_21&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">, </span><a name="loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) =
      let </span><a name="loc_557_11_557_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_11_557_13&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">intToDigit</span></span><span class="mpre"> </span><a href="#loc_556_19_556_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_19_556_21&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> in
      case </span><a href="#loc_556_11_556_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_11_556_17&#39;)"><span class="hl_varref"><span class="mpre">format</span></span></a><span class="mpre"> of
       </span><a href="Data.Text.Lazy.Builder.RealFloat.html#loc_33_17_33_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.RealFloat.html#loc_33_17_33_24&#39;)"><span class="hl_conref"><span class="mpre">Generic</span></span></a><span class="mpre"> -&gt;
        </span><a href="#loc_556_5_556_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_5_556_10&#39;)"><span class="hl_varref"><span class="mpre">doFmt</span></span></a><span class="mpre"> (if </span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> then </span><a href="Data.Text.Lazy.Builder.RealFloat.html#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.RealFloat.html#loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Exponent</span></span></a><span class="mpre"> else </span><a href="Data.Text.Lazy.Builder.RealFloat.html#loc_31_17_31_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.RealFloat.html#loc_31_17_31_22&#39;)"><span class="hl_conref"><span class="mpre">Fixed</span></span></a><span class="mpre">)
              (</span><a href="#loc_556_19_556_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_19_556_21&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">, </span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
       </span><a href="Data.Text.Lazy.Builder.RealFloat.html#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.RealFloat.html#loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Exponent</span></span></a><span class="mpre"> -&gt;
        case </span><a href="#loc_551_22_551_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_22_551_26&#39;)"><span class="hl_varref"><span class="mpre">decs</span></span></a><span class="mpre"> of
         </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt;
          let </span><a name="loc_565_15_565_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_22&#39;)"><span class="hl_vardecl"><span class="mpre">show_e&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) in
          case </span><a href="#loc_557_11_557_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_11_557_13&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre"> of
            </span><span class="hl_string"><span class="mpre">&quot;0&quot;</span></span><span class="mpre">     -&gt; </span><span class="hl_string"><span class="mpre">&quot;0.0e0&quot;</span></span><span class="mpre">
            [</span><a name="loc_568_14_568_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_14_568_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">]     -&gt; </span><a href="#loc_568_14_568_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_14_568_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.0e&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_565_15_565_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_22&#39;)"><span class="hl_varref"><span class="mpre">show_e&#39;</span></span></a><span class="mpre">
            (</span><a name="loc_569_14_569_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_14_569_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_569_16_569_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_16_569_19&#39;)"><span class="hl_vardecl"><span class="mpre">ds&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_569_14_569_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_14_569_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_569_16_569_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_16_569_19&#39;)"><span class="hl_varref"><span class="mpre">ds&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;e&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_565_15_565_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_15_565_22&#39;)"><span class="hl_varref"><span class="mpre">show_e&#39;</span></span></a><span class="mpre">
            []      -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;formatScientific/doFmt/FFExponent: []&quot;</span></span><span class="mpre">
         </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_571_15_571_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_571_15_571_18&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> -&gt;
          let </span><a name="loc_572_15_572_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_15_572_19&#39;)"><span class="hl_vardecl"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_571_15_571_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_571_15_571_18&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> in
          case </span><a href="#loc_556_19_556_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_19_556_21&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> of
           [</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">] -&gt; </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_572_15_572_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_15_572_19&#39;)"><span class="hl_varref"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;e0&quot;</span></span><span class="mpre">
           _ -&gt;
            let
             (</span><a name="loc_577_15_577_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_15_577_17&#39;)"><span class="hl_vardecl"><span class="mpre">ei</span></span></a><span class="mpre">,</span><a name="loc_577_18_577_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_18_577_21&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_613_1_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_1_613_8&#39;)"><span class="hl_varref"><span class="mpre">roundTo</span></span></a><span class="mpre"> (</span><a href="#loc_572_15_572_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_15_572_19&#39;)"><span class="hl_varref"><span class="mpre">dec&#39;</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_556_19_556_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_19_556_21&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
             (</span><a name="loc_578_15_578_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_15_578_16&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_578_17_578_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_17_578_20&#39;)"><span class="hl_vardecl"><span class="mpre">ds&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">intToDigit</span></span><span class="mpre"> (if </span><a href="#loc_577_15_577_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_15_577_17&#39;)"><span class="hl_varref"><span class="mpre">ei</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><a href="#loc_577_18_577_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_18_577_21&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre"> else </span><a href="#loc_577_18_577_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_18_577_21&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">)
            in
            </span><a href="#loc_578_15_578_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_15_578_16&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_578_17_578_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_17_578_20&#39;)"><span class="hl_varref"><span class="mpre">ds&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;e&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_577_15_577_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_15_577_17&#39;)"><span class="hl_varref"><span class="mpre">ei</span></span></a><span class="mpre">)
       </span><a href="Data.Text.Lazy.Builder.RealFloat.html#loc_31_17_31_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.RealFloat.html#loc_31_17_31_22&#39;)"><span class="hl_conref"><span class="mpre">Fixed</span></span></a><span class="mpre"> -&gt;
        let
         </span><a name="loc_583_10_583_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_10_583_13&#39;)"><span class="hl_fundecl"><span class="mpre">mk0</span></span></a><span class="mpre"> </span><a name="loc_583_14_583_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_14_583_16&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> = case </span><a href="#loc_583_14_583_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_14_583_16&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> of { </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> -&gt; </span><span class="hl_string"><span class="mpre">&quot;0&quot;</span></span><span class="mpre"> ; _ -&gt; </span><a href="#loc_583_14_583_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_14_583_16&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">}
        in
        case </span><a href="#loc_551_22_551_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_22_551_26&#39;)"><span class="hl_varref"><span class="mpre">decs</span></span></a><span class="mpre"> of
         </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
            | </span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    -&gt; </span><span class="hl_string"><span class="mpre">&quot;0.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> (-</span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_557_11_557_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_11_557_13&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
               let
                  </span><a name="loc_590_19_590_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_19_590_20&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_590_23_590_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_23_590_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">    </span><a name="loc_590_28_590_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_28_590_30&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">  = </span><a href="#loc_583_10_583_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_10_583_13&#39;)"><span class="hl_varref"><span class="mpre">mk0</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_590_23_590_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_23_590_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_583_10_583_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_10_583_13&#39;)"><span class="hl_varref"><span class="mpre">mk0</span></span></a><span class="mpre"> </span><a href="#loc_590_28_590_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_28_590_30&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
                  </span><a href="#loc_590_19_590_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_19_590_20&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_591_21_591_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_21_591_22&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_591_23_591_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_23_591_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">    </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">  = </span><a href="#loc_590_19_590_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_19_590_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_591_21_591_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_21_591_22&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_591_23_591_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_23_591_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                  </span><a href="#loc_590_19_590_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_19_590_20&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_592_21_592_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_21_592_22&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_592_23_592_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_23_592_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a name="loc_592_26_592_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_26_592_27&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_592_28_592_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_28_592_30&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) = </span><a href="#loc_590_19_590_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_19_590_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_592_21_592_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_21_592_22&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_592_26_592_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_26_592_27&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_592_23_592_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_23_592_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_592_28_592_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_28_592_30&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
               in
                  </span><a href="#loc_590_19_590_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_19_590_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_557_11_557_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_11_557_13&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
         </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_595_15_595_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_15_595_18&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> -&gt;
          let </span><a name="loc_596_15_596_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_15_596_19&#39;)"><span class="hl_vardecl"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_595_15_595_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_15_595_18&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> in
          if </span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then
           let
            (</span><a name="loc_599_14_599_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_14_599_16&#39;)"><span class="hl_vardecl"><span class="mpre">ei</span></span></a><span class="mpre">,</span><a name="loc_599_17_599_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_17_599_20&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_613_1_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_1_613_8&#39;)"><span class="hl_varref"><span class="mpre">roundTo</span></span></a><span class="mpre"> (</span><a href="#loc_596_15_596_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_15_596_19&#39;)"><span class="hl_varref"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><a href="#loc_556_19_556_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_19_556_21&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
            (</span><a name="loc_600_14_600_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_14_600_16&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre">,</span><a name="loc_600_17_600_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_17_600_19&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">)  = </span><span class="hl_varref"><span class="mpre">splitAt</span></span><span class="mpre"> (</span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_599_14_599_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_14_599_16&#39;)"><span class="hl_varref"><span class="mpre">ei</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">intToDigit</span></span><span class="mpre"> </span><a href="#loc_599_17_599_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_17_599_20&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">)
           in
           </span><a href="#loc_583_10_583_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_10_583_13&#39;)"><span class="hl_varref"><span class="mpre">mk0</span></span></a><span class="mpre"> </span><a href="#loc_600_14_600_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_14_600_16&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_600_17_600_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_17_600_19&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> else </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_600_17_600_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_17_600_19&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
          else
           let
            (</span><a name="loc_605_14_605_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_14_605_16&#39;)"><span class="hl_vardecl"><span class="mpre">ei</span></span></a><span class="mpre">,</span><a name="loc_605_17_605_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_17_605_20&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_613_1_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_1_613_8&#39;)"><span class="hl_varref"><span class="mpre">roundTo</span></span></a><span class="mpre"> </span><a href="#loc_596_15_596_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_15_596_19&#39;)"><span class="hl_varref"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> (-</span><a href="#loc_556_23_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_23_556_24&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_556_19_556_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_19_556_21&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">)
            </span><a name="loc_606_13_606_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_13_606_14&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_606_15_606_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_15_606_18&#39;)"><span class="hl_vardecl"><span class="mpre">ds&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">intToDigit</span></span><span class="mpre"> (if </span><a href="#loc_605_14_605_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_14_605_16&#39;)"><span class="hl_varref"><span class="mpre">ei</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><a href="#loc_605_17_605_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_17_605_20&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_605_17_605_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_17_605_20&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">)
           in
           </span><a href="#loc_606_13_606_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_13_606_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_606_15_606_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_15_606_18&#39;)"><span class="hl_varref"><span class="mpre">ds&#39;</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> else </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_606_15_606_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_15_606_18&#39;)"><span class="hl_varref"><span class="mpre">ds&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_613_1_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_1_613_8&#39;)"><span class="mpre">roundTo</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">])
</span><a name="loc_613_1_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_1_613_8&#39;)"><span class="hl_fundecl"><span class="mpre">roundTo</span></span></a><span class="mpre"> </span><a name="loc_613_9_613_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_9_613_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_613_11_613_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_11_613_13&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> =
  case </span><a href="#loc_623_3_623_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_3_623_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_613_9_613_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_9_613_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_613_11_613_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_11_613_13&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> of
    </span><a name="loc_615_5_615_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_5_615_6&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@(</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,_) -&gt; </span><a href="#loc_615_5_615_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_5_615_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><a name="loc_616_8_616_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_616_8_616_10&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)  -&gt; (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_616_8_616_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_616_8_616_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    _       -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;roundTo: bad Value&quot;</span></span><span class="mpre">
 where
  </span><a name="loc_619_3_619_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_3_619_7&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">

  </span><a name="loc_621_3_621_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_3_621_5&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre"> = </span><a href="#loc_619_3_619_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_3_619_7&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">

  </span><a name="loc_623_3_623_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_3_623_4&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_623_5_623_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_5_623_6&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ []     = (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><a href="#loc_623_5_623_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_5_623_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
  </span><a href="#loc_623_3_623_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_3_623_4&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_624_7_624_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_7_624_8&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> (</span><a name="loc_624_10_624_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_10_624_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_624_12_624_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_12_624_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><a href="#loc_624_10_624_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_10_624_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_621_3_621_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_3_621_5&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_624_7_624_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_7_624_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><a href="#loc_624_12_624_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_12_624_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> = (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, [])   </span><span class="hl_comment"><span class="mpre">-- Round to even when at exactly half the base</span></span><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (if </span><a href="#loc_624_10_624_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_10_624_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_621_3_621_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_3_621_5&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, [])
  </span><a href="#loc_623_3_623_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_3_623_4&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_626_5_626_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_626_5_626_6&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ (</span><a name="loc_626_10_626_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_626_10_626_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_626_12_626_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_626_12_626_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
     | </span><a href="#loc_631_8_631_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_8_631_10&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_619_3_619_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_3_619_7&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> = (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_630_11_630_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_11_630_13&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
     | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_631_8_631_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_8_631_10&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_630_11_630_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_11_630_13&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
      where
       (</span><a name="loc_630_9_630_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_9_630_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_630_11_630_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_11_630_13&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">) = </span><a href="#loc_623_3_623_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_3_623_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_626_5_626_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_626_5_626_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">even</span></span><span class="mpre"> </span><a href="#loc_626_10_626_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_626_10_626_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="#loc_626_12_626_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_626_12_626_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
       </span><a name="loc_631_8_631_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_8_631_10&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre">     = </span><a href="#loc_630_9_630_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_9_630_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_626_10_626_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_626_10_626_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Similar to &#39;Numeric.floatToDigits&#39;, @toDecimalDigits@ takes a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- non-negative &#39;Scientific&#39; number, and returns a list of digits and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a base-10 exponent. In particular, if @x&gt;=0@, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; toDecimalDigits x = ([d1,d2,...,dn], e)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      (1) @n &gt;= 1@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      (2) @x = 0.d1d2...dn * (10^^e)@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      (3) @0 &lt;= di &lt;= 9@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      (4) @null $ takeWhile (==0) $ reverse [d1,d2,...,dn]@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The last property means that the coefficient will be normalized, i.e. doesn&#39;t</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- contain trailing zeros.</span></span><span class="mpre">
</span><a href="#loc_654_1_654_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_654_1_654_16&#39;)"><span class="mpre">toDecimalDigits</span></a><span class="mpre"> :: </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_654_1_654_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_654_1_654_16&#39;)"><span class="hl_fundecl"><span class="mpre">toDecimalDigits</span></span></a><span class="mpre"> (</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  _)  = ([</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">], </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
</span><a href="#loc_654_1_654_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_654_1_654_16&#39;)"><span class="hl_fundecl"><span class="mpre">toDecimalDigits</span></span></a><span class="mpre"> (</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_655_29_655_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_29_655_31&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre"> </span><a name="loc_655_32_655_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_32_655_34&#39;)"><span class="hl_vardecl"><span class="mpre">e&#39;</span></span></a><span class="mpre">) = (</span><a href="#loc_659_6_659_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_6_659_8&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">,  </span><a href="#loc_659_10_659_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_10_659_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_657_18_657_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_657_18_657_19&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
  where
    </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_657_16_657_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_657_16_657_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_657_18_657_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_657_18_657_19&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="#loc_690_1_690_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_1_690_18&#39;)"><span class="hl_varref"><span class="mpre">normalizePositive</span></span></a><span class="mpre"> </span><a href="#loc_655_29_655_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_29_655_31&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre"> </span><a href="#loc_655_32_655_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_32_655_34&#39;)"><span class="hl_varref"><span class="mpre">e&#39;</span></span></a><span class="mpre">

    (</span><a name="loc_659_6_659_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_6_659_8&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">, </span><a name="loc_659_10_659_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_10_659_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) = </span><a href="#loc_668_5_668_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_5_668_21&#39;)"><span class="hl_varref"><span class="mpre">reverseAndLength</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_662_5_662_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_5_662_11&#39;)"><span class="hl_varref"><span class="mpre">digits</span></span></a><span class="mpre"> </span><a href="#loc_657_16_657_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_657_16_657_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

    </span><a href="#loc_662_5_662_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_5_662_11&#39;)"><span class="mpre">digits</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]
    </span><a name="loc_662_5_662_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_5_662_11&#39;)"><span class="hl_fundecl"><span class="mpre">digits</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = []
    </span><a href="#loc_662_5_662_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_5_662_11&#39;)"><span class="hl_fundecl"><span class="mpre">digits</span></span></a><span class="mpre"> </span><a name="loc_663_12_663_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_663_12_663_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_665_13_665_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_13_665_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_662_5_662_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_5_662_11&#39;)"><span class="hl_varref"><span class="mpre">digits</span></span></a><span class="mpre"> </span><a href="#loc_665_10_665_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_10_665_11&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
      where
        (</span><a name="loc_665_10_665_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_10_665_11&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">, </span><a name="loc_665_13_665_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_13_665_14&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_663_12_663_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_663_12_663_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">

    </span><a href="#loc_668_5_668_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_5_668_21&#39;)"><span class="mpre">reverseAndLength</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
    </span><a name="loc_668_5_668_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_5_668_21&#39;)"><span class="hl_fundecl"><span class="mpre">reverseAndLength</span></span></a><span class="mpre"> </span><a name="loc_668_22_668_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_22_668_23&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_670_9_670_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_9_670_12&#39;)"><span class="hl_varref"><span class="mpre">rev</span></span></a><span class="mpre"> </span><a href="#loc_668_22_668_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_22_668_23&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> [] </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      where
        </span><a name="loc_670_9_670_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_9_670_12&#39;)"><span class="hl_fundecl"><span class="mpre">rev</span></span></a><span class="mpre"> []     </span><a name="loc_670_20_670_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_20_670_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> !</span><a name="loc_670_23_670_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_23_670_24&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = (</span><a href="#loc_670_20_670_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_20_670_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_670_23_670_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_23_670_24&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)
        </span><a href="#loc_670_9_670_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_9_670_12&#39;)"><span class="hl_fundecl"><span class="mpre">rev</span></span></a><span class="mpre"> (</span><a name="loc_671_14_671_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_14_671_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_671_16_671_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_16_671_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_671_20_671_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_20_671_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> !</span><a name="loc_671_23_671_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_23_671_24&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_670_9_670_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_9_670_12&#39;)"><span class="hl_varref"><span class="mpre">rev</span></span></a><span class="mpre"> </span><a href="#loc_671_16_671_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_16_671_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> (</span><a href="#loc_671_14_671_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_14_671_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_671_20_671_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_20_671_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) (</span><a href="#loc_671_23_671_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_23_671_24&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Normalization</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Normalize a scientific number by dividing out powers of 10 from the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;coefficient&#39; and incrementing the &#39;base10Exponent&#39; each time.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- You should rarely have a need for this function since scientific numbers are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- automatically normalized when pretty-printed and in &#39;toDecimalDigits&#39;.</span></span><span class="mpre">
</span><a href="#loc_684_1_684_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_10&#39;)"><span class="mpre">normalize</span></a><span class="mpre"> :: </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre">
</span><a name="loc_684_1_684_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_10&#39;)"><span class="hl_fundecl"><span class="mpre">normalize</span></span></a><span class="mpre"> (</span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a name="loc_684_23_684_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_23_684_24&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_684_25_684_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_25_684_26&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)
    | </span><a href="#loc_684_23_684_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_23_684_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = -(</span><a href="#loc_690_1_690_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_1_690_18&#39;)"><span class="hl_varref"><span class="mpre">normalizePositive</span></span></a><span class="mpre"> (-</span><a href="#loc_684_23_684_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_23_684_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_684_25_684_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_25_684_26&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
    | </span><a href="#loc_684_23_684_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_23_684_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> =   </span><a href="#loc_690_1_690_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_1_690_18&#39;)"><span class="hl_varref"><span class="mpre">normalizePositive</span></span></a><span class="mpre">   </span><a href="#loc_684_23_684_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_23_684_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">  </span><a href="#loc_684_25_684_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_25_684_26&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">{- c == 0 -}</span></span><span class="mpre"> = </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><a href="#loc_690_1_690_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_1_690_18&#39;)"><span class="mpre">normalizePositive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_111_6_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_16&#39;)"><span class="hl_tyconref"><span class="mpre">Scientific</span></span></a><span class="mpre">
</span><a name="loc_690_1_690_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_1_690_18&#39;)"><span class="hl_fundecl"><span class="mpre">normalizePositive</span></span></a><span class="mpre"> </span><a name="loc_690_19_690_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_19_690_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> !</span><a name="loc_690_22_690_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_22_690_23&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">quotRem</span></span><span class="mpre"> </span><a href="#loc_690_19_690_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_19_690_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> of
                           (</span><a name="loc_691_29_691_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_29_691_30&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) -&gt; </span><a href="#loc_690_1_690_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_1_690_18&#39;)"><span class="hl_varref"><span class="mpre">normalizePositive</span></span></a><span class="mpre"> </span><a href="#loc_691_29_691_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_29_691_30&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> (</span><a href="#loc_690_22_690_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_22_690_23&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                           _      -&gt; </span><a href="#loc_111_19_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_29&#39;)"><span class="hl_conref"><span class="mpre">Scientific</span></span></a><span class="mpre"> </span><a href="#loc_690_19_690_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_19_690_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_690_22_690_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_22_690_23&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
</span></div></body></html>