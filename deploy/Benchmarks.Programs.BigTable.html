<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | Create a large HTML table and dump it to a handle</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Tested in this benchmark:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Creating a large HTML document using a builder</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Writing to a handle</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE OverloadedStrings #-}
module Benchmarks.Programs.BigTable
    ( benchmark
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/Programs/BigTable.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 8, srcSpanEndLine = 14, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Criterion&quot;"><span class="mpre">Criterion</span></span><span class="mpre"> (Benchmark, bench)
import Data.Monoid (</span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="mpre">mconcat</span></a><span class="mpre">)
import Data.Text.Lazy.Builder (</span><a href="Data.Text.Internal.Builder.html#loc_86_9_86_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_86_9_86_16&#39;)"><span class="mpre">Builder</span></a><span class="mpre">, </span><a href="Data.Text.Internal.Builder.html#loc_166_1_166_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_166_1_166_9&#39;)"><span class="mpre">fromText</span></a><span class="mpre">, </span><a href="Data.Text.Internal.Builder.html#loc_221_1_221_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_221_1_221_11&#39;)"><span class="mpre">toLazyText</span></a><span class="mpre">)
import Data.Text.Lazy.IO (</span><a href="Data.Text.Lazy.IO.html#loc_139_1_139_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.IO.html#loc_139_1_139_8&#39;)"><span class="mpre">hPutStr</span></a><span class="mpre">)
import System.IO (</span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="mpre">Handle</span></a><span class="mpre">)
import qualified Data.Text as T

</span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="mpre">benchmark</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Benchmark</span></span><span class="mpre">
</span><a name="loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_fundecl"><span class="mpre">benchmark</span></span></a><span class="mpre"> </span><a name="loc_22_11_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_15&#39;)"><span class="hl_vardecl"><span class="mpre">sink</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;BigTable&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="Data.Text.Lazy.IO.html#loc_139_1_139_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.IO.html#loc_139_1_139_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="#loc_22_11_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_15&#39;)"><span class="hl_varref"><span class="mpre">sink</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Type: text/html\n\n&lt;table&gt;&quot;</span></span><span class="mpre">
    </span><a href="Data.Text.Lazy.IO.html#loc_139_1_139_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.IO.html#loc_139_1_139_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="#loc_22_11_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_15&#39;)"><span class="hl_varref"><span class="mpre">sink</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_221_1_221_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_221_1_221_11&#39;)"><span class="hl_varref"><span class="mpre">toLazyText</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_34_1_34_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_10&#39;)"><span class="hl_varref"><span class="mpre">makeTable</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="#loc_30_5_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_9&#39;)"><span class="hl_varref"><span class="mpre">rows</span></span></a><span class="mpre">
    </span><a href="Data.Text.Lazy.IO.html#loc_139_1_139_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.IO.html#loc_139_1_139_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="#loc_22_11_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_15&#39;)"><span class="hl_varref"><span class="mpre">sink</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;/table&gt;&quot;</span></span><span class="mpre">
  where
    </span><span class="hl_comment"><span class="mpre">-- We provide the number of rows in IO so the builder value isn&#39;t shared</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- between the benchmark samples.</span></span><span class="mpre">
    </span><a href="#loc_30_5_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_9&#39;)"><span class="mpre">rows</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a name="loc_30_5_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_9&#39;)"><span class="hl_vardecl"><span class="mpre">rows</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">20000</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_30_5_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_9&#39;)"><span class="mpre">rows</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_34_1_34_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_10&#39;)"><span class="mpre">makeTable</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Builder.html#loc_86_9_86_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_86_9_86_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_34_1_34_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_10&#39;)"><span class="hl_fundecl"><span class="mpre">makeTable</span></span></a><span class="mpre"> </span><a name="loc_34_11_34_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_11_34_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><a href="#loc_34_11_34_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_11_34_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_37_1_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_8&#39;)"><span class="hl_varref"><span class="mpre">makeCol</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/Programs/BigTable.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 61, srcSpanEndLine = 34, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/Programs/BigTable.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 61, srcSpanEndLine = 34, srcSpanEndColumn = 62},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">[1 .. 50]</span></span><span class="mpre">

</span><a href="#loc_37_1_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_8&#39;)"><span class="mpre">makeCol</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Builder.html#loc_86_9_86_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_86_9_86_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_37_1_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_8&#39;)"><span class="hl_fundecl"><span class="mpre">makeCol</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><a href="Data.Text.Internal.Builder.html#loc_166_1_166_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_166_1_166_9&#39;)"><span class="hl_varref"><span class="mpre">fromText</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&quot;</span></span><span class="mpre">
</span><a href="#loc_37_1_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_8&#39;)"><span class="hl_fundecl"><span class="mpre">makeCol</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">50</span></span><span class="mpre"> = </span><a href="Data.Text.Internal.Builder.html#loc_166_1_166_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_166_1_166_9&#39;)"><span class="hl_varref"><span class="mpre">fromText</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;td&gt;50&lt;/td&gt;&lt;/tr&gt;&quot;</span></span><span class="mpre">
</span><a href="#loc_37_1_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_8&#39;)"><span class="hl_fundecl"><span class="mpre">makeCol</span></span></a><span class="mpre"> </span><a name="loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Builder.html#loc_166_1_166_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_166_1_166_9&#39;)"><span class="hl_varref"><span class="mpre">fromText</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;td&gt;&quot;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> (</span><a href="#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="hl_varref"><span class="mpre">fromInt</span></span></a><span class="mpre"> </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_166_1_166_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_166_1_166_9&#39;)"><span class="hl_varref"><span class="mpre">fromText</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;/td&gt;&quot;</span></span><span class="mpre">)

</span><a href="#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="mpre">fromInt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Builder.html#loc_86_9_86_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_86_9_86_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="hl_vardecl"><span class="mpre">fromInt</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Builder.html#loc_166_1_166_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_166_1_166_9&#39;)"><span class="hl_varref"><span class="mpre">fromText</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_387_1_387_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_387_1_387_5&#39;)"><span class="hl_varref"><span class="mpre">T.pack</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">
</span></div></body></html>