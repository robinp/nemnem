<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | Elliptic Curve Arithmetic.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /WARNING:/ These functions are vulnerable to timing attacks.</span></span><span class="mpre">
module Crypto.PubKey.ECC.Prim
    ( pointAdd
    , pointDouble
    , pointMul
    ) where

import Data.Maybe
import Crypto.Number.ModArithmetic
import Crypto.Number.F2m
import Crypto.Types.PubKey.ECC

</span><span class="hl_comment"><span class="mpre">-- | Elliptic Curve point addition.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /WARNING:/ Vulnerable to timing attacks.</span></span><span class="mpre">
</span><a href="#loc_19_1_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_9&#39;)"><span class="mpre">pointAdd</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.ECC.html#loc_33_6_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_33_6_33_11&#39;)"><span class="hl_tyconref"><span class="mpre">Curve</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_6_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_6_44_11&#39;)"><span class="hl_tyconref"><span class="mpre">Point</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_6_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_6_44_11&#39;)"><span class="hl_tyconref"><span class="mpre">Point</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_6_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_6_44_11&#39;)"><span class="hl_tyconref"><span class="mpre">Point</span></span></a><span class="mpre">
</span><a name="loc_19_1_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_9&#39;)"><span class="hl_fundecl"><span class="mpre">pointAdd</span></span></a><span class="mpre"> _ </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre">
</span><a href="#loc_19_1_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_9&#39;)"><span class="hl_fundecl"><span class="mpre">pointAdd</span></span></a><span class="mpre"> _ </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre"> </span><a name="loc_20_19_20_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_19_20_20&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="#loc_20_19_20_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_19_20_20&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
</span><a href="#loc_19_1_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_9&#39;)"><span class="hl_fundecl"><span class="mpre">pointAdd</span></span></a><span class="mpre"> _ </span><a name="loc_21_12_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_12_21_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre"> = </span><a href="#loc_21_12_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_12_21_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><a href="#loc_19_1_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_9&#39;)"><span class="hl_fundecl"><span class="mpre">pointAdd</span></span></a><span class="mpre"> </span><a name="loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_specname"><span class="mpre">c</span></span></a><span class="mpre">@(</span><a href="Crypto.Types.PubKey.ECC.html#loc_34_14_34_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_34_14_34_21&#39;)"><span class="hl_conref"><span class="mpre">CurveFP</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.ECC.html#loc_55_19_55_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_55_19_55_29&#39;)"><span class="hl_conref"><span class="mpre">CurvePrime</span></span></a><span class="mpre"> </span><a name="loc_22_33_22_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_33_22_35&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre"> _)) </span><a name="loc_22_40_22_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_40_22_41&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a name="loc_22_49_22_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_49_22_51&#39;)"><span class="hl_vardecl"><span class="mpre">xp</span></span></a><span class="mpre"> </span><a name="loc_22_52_22_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_52_22_54&#39;)"><span class="hl_vardecl"><span class="mpre">yp</span></span></a><span class="mpre">) </span><a name="loc_22_56_22_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_56_22_57&#39;)"><span class="hl_specname"><span class="mpre">q</span></span></a><span class="mpre">@(</span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a name="loc_22_65_22_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_65_22_67&#39;)"><span class="hl_vardecl"><span class="mpre">xq</span></span></a><span class="mpre"> </span><a name="loc_22_68_22_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_68_22_70&#39;)"><span class="hl_vardecl"><span class="mpre">yq</span></span></a><span class="mpre">)
    | </span><a href="#loc_22_40_22_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_40_22_41&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a href="#loc_22_65_22_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_65_22_67&#39;)"><span class="hl_varref"><span class="mpre">xq</span></span></a><span class="mpre"> (-</span><a href="#loc_22_68_22_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_68_22_70&#39;)"><span class="hl_varref"><span class="mpre">yq</span></span></a><span class="mpre">) = </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre">
    | </span><a href="#loc_22_40_22_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_40_22_41&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_22_56_22_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_56_22_57&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">pointDouble</span></span></a><span class="mpre"> </span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_22_40_22_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_40_22_41&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = let </span><a name="loc_25_23_25_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_23_25_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  = </span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_varref"><span class="mpre">divmod</span></span></a><span class="mpre"> (</span><a href="#loc_22_52_22_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_52_22_54&#39;)"><span class="hl_varref"><span class="mpre">yp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_22_68_22_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_68_22_70&#39;)"><span class="hl_varref"><span class="mpre">yq</span></span></a><span class="mpre">) (</span><a href="#loc_22_49_22_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_49_22_51&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_22_65_22_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_65_22_67&#39;)"><span class="hl_varref"><span class="mpre">xq</span></span></a><span class="mpre">) </span><a href="#loc_22_33_22_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_33_22_35&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
                      </span><a name="loc_26_23_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_23_26_25&#39;)"><span class="hl_vardecl"><span class="mpre">xr</span></span></a><span class="mpre"> = (</span><a href="#loc_25_23_25_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_23_25_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_22_49_22_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_49_22_51&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_22_65_22_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_65_22_67&#39;)"><span class="hl_varref"><span class="mpre">xq</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_22_33_22_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_33_22_35&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
                      </span><a name="loc_27_23_27_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_23_27_25&#39;)"><span class="hl_vardecl"><span class="mpre">yr</span></span></a><span class="mpre"> = (</span><a href="#loc_25_23_25_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_23_25_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_22_49_22_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_49_22_51&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_26_23_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_23_26_25&#39;)"><span class="hl_varref"><span class="mpre">xr</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_22_52_22_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_52_22_54&#39;)"><span class="hl_varref"><span class="mpre">yp</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_22_33_22_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_33_22_35&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
                  in </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a href="#loc_26_23_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_23_26_25&#39;)"><span class="hl_varref"><span class="mpre">xr</span></span></a><span class="mpre"> </span><a href="#loc_27_23_27_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_23_27_25&#39;)"><span class="hl_varref"><span class="mpre">yr</span></span></a><span class="mpre">
</span><a href="#loc_19_1_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_9&#39;)"><span class="hl_fundecl"><span class="mpre">pointAdd</span></span></a><span class="mpre"> </span><a name="loc_29_10_29_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_10_29_11&#39;)"><span class="hl_specname"><span class="mpre">c</span></span></a><span class="mpre">@(</span><a href="Crypto.Types.PubKey.ECC.html#loc_33_14_33_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_33_14_33_22&#39;)"><span class="hl_conref"><span class="mpre">CurveF2m</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.ECC.html#loc_50_20_50_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_50_20_50_31&#39;)"><span class="hl_conref"><span class="mpre">CurveBinary</span></span></a><span class="mpre"> </span><a name="loc_29_35_29_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_35_29_37&#39;)"><span class="hl_vardecl"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a name="loc_29_38_29_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_38_29_40&#39;)"><span class="hl_vardecl"><span class="mpre">cc</span></span></a><span class="mpre">)) </span><a name="loc_29_43_29_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_43_29_44&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a name="loc_29_52_29_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_52_29_54&#39;)"><span class="hl_vardecl"><span class="mpre">xp</span></span></a><span class="mpre"> </span><a name="loc_29_55_29_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_55_29_57&#39;)"><span class="hl_vardecl"><span class="mpre">yp</span></span></a><span class="mpre">) </span><a name="loc_29_59_29_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_59_29_60&#39;)"><span class="hl_specname"><span class="mpre">q</span></span></a><span class="mpre">@(</span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a name="loc_29_68_29_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_68_29_70&#39;)"><span class="hl_vardecl"><span class="mpre">xq</span></span></a><span class="mpre"> </span><a name="loc_29_71_29_73" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_71_29_73&#39;)"><span class="hl_vardecl"><span class="mpre">yq</span></span></a><span class="mpre">)
    | </span><a href="#loc_29_43_29_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_43_29_44&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a href="#loc_29_68_29_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_68_29_70&#39;)"><span class="hl_varref"><span class="mpre">xq</span></span></a><span class="mpre"> (</span><a href="#loc_29_68_29_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_68_29_70&#39;)"><span class="hl_varref"><span class="mpre">xq</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_29_71_29_73" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_71_29_73&#39;)"><span class="hl_varref"><span class="mpre">yq</span></span></a><span class="mpre">) = </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre">
    | </span><a href="#loc_29_43_29_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_43_29_44&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_29_59_29_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_59_29_60&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">pointDouble</span></span></a><span class="mpre"> </span><a href="#loc_29_10_29_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_10_29_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_29_43_29_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_43_29_44&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                     </span><a name="loc_33_22_33_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="Crypto.Number.F2m.html#loc_109_1_109_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_109_1_109_7&#39;)"><span class="hl_varref"><span class="mpre">divF2m</span></span></a><span class="mpre"> </span><a href="#loc_29_35_29_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_35_29_37&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> (</span><a href="#loc_29_55_29_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_55_29_57&#39;)"><span class="hl_varref"><span class="mpre">yp</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_29_71_29_73" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_71_29_73&#39;)"><span class="hl_varref"><span class="mpre">yq</span></span></a><span class="mpre">) (</span><a href="#loc_29_52_29_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_52_29_54&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_29_68_29_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_68_29_70&#39;)"><span class="hl_varref"><span class="mpre">xq</span></span></a><span class="mpre">)
                     let </span><a name="loc_34_26_34_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_26_34_28&#39;)"><span class="hl_vardecl"><span class="mpre">xr</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.F2m.html#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_57_1_57_7&#39;)"><span class="hl_varref"><span class="mpre">mulF2m</span></span></a><span class="mpre"> </span><a href="#loc_29_35_29_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_35_29_37&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_33_22_33_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_33_22_33_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_33_22_33_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_29_52_29_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_52_29_54&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_29_68_29_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_68_29_70&#39;)"><span class="hl_varref"><span class="mpre">xq</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_37_9_37_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                         </span><a name="loc_35_26_35_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_26_35_28&#39;)"><span class="hl_vardecl"><span class="mpre">yr</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.F2m.html#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_57_1_57_7&#39;)"><span class="hl_varref"><span class="mpre">mulF2m</span></span></a><span class="mpre"> </span><a href="#loc_29_35_29_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_35_29_37&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_33_22_33_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_29_52_29_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_52_29_54&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_34_26_34_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_26_34_28&#39;)"><span class="hl_varref"><span class="mpre">xr</span></span></a><span class="mpre">) </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_34_26_34_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_26_34_28&#39;)"><span class="hl_varref"><span class="mpre">xr</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_29_55_29_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_55_29_57&#39;)"><span class="hl_varref"><span class="mpre">yp</span></span></a><span class="mpre">
                     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a href="#loc_34_26_34_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_26_34_28&#39;)"><span class="hl_varref"><span class="mpre">xr</span></span></a><span class="mpre"> </span><a href="#loc_35_26_35_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_26_35_28&#39;)"><span class="hl_varref"><span class="mpre">yr</span></span></a><span class="mpre">
  where </span><a name="loc_37_9_37_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_74_7_74_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_74_7_74_12&#39;)"><span class="hl_varref"><span class="mpre">ecc_a</span></span></a><span class="mpre"> </span><a href="#loc_29_38_29_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_38_29_40&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Elliptic Curve point doubling.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /WARNING:/ Vulnerable to timing attacks.</span></span><span class="mpre">
</span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="mpre">pointDouble</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.ECC.html#loc_33_6_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_33_6_33_11&#39;)"><span class="hl_tyconref"><span class="mpre">Curve</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_6_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_6_44_11&#39;)"><span class="hl_tyconref"><span class="mpre">Point</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_6_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_6_44_11&#39;)"><span class="hl_tyconref"><span class="mpre">Point</span></span></a><span class="mpre">
</span><a name="loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_fundecl"><span class="mpre">pointDouble</span></span></a><span class="mpre"> _ </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre">
</span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_fundecl"><span class="mpre">pointDouble</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.ECC.html#loc_34_14_34_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_34_14_34_21&#39;)"><span class="hl_conref"><span class="mpre">CurveFP</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.ECC.html#loc_55_19_55_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_55_19_55_29&#39;)"><span class="hl_conref"><span class="mpre">CurvePrime</span></span></a><span class="mpre"> </span><a name="loc_44_34_44_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_34_44_36&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre"> </span><a name="loc_44_37_44_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_37_44_39&#39;)"><span class="hl_vardecl"><span class="mpre">cc</span></span></a><span class="mpre">)) (</span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a name="loc_44_49_44_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_49_44_51&#39;)"><span class="hl_vardecl"><span class="mpre">xp</span></span></a><span class="mpre"> </span><a name="loc_44_52_44_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_52_44_54&#39;)"><span class="hl_vardecl"><span class="mpre">yp</span></span></a><span class="mpre">) =
    let </span><a name="loc_45_9_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_varref"><span class="mpre">divmod</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_44_49_44_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_49_44_51&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_49_9_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_44_52_44_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_52_44_54&#39;)"><span class="hl_varref"><span class="mpre">yp</span></span></a><span class="mpre">) </span><a href="#loc_44_34_44_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_34_44_36&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
        </span><a name="loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_vardecl"><span class="mpre">xr</span></span></a><span class="mpre"> = (</span><a href="#loc_45_9_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_44_49_44_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_49_44_51&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_44_34_44_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_34_44_36&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
        </span><a name="loc_47_9_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_11&#39;)"><span class="hl_vardecl"><span class="mpre">yr</span></span></a><span class="mpre"> = (</span><a href="#loc_45_9_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_44_49_44_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_49_44_51&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_varref"><span class="mpre">xr</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_44_52_44_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_52_44_54&#39;)"><span class="hl_varref"><span class="mpre">yp</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_44_34_44_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_34_44_36&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
    in </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a href="#loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_varref"><span class="mpre">xr</span></span></a><span class="mpre"> </span><a href="#loc_47_9_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_11&#39;)"><span class="hl_varref"><span class="mpre">yr</span></span></a><span class="mpre">
  where </span><a name="loc_49_9_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_74_7_74_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_74_7_74_12&#39;)"><span class="hl_varref"><span class="mpre">ecc_a</span></span></a><span class="mpre"> </span><a href="#loc_44_37_44_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_37_44_39&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre">
</span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_fundecl"><span class="mpre">pointDouble</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.ECC.html#loc_33_14_33_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_33_14_33_22&#39;)"><span class="hl_conref"><span class="mpre">CurveF2m</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.ECC.html#loc_50_20_50_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_50_20_50_31&#39;)"><span class="hl_conref"><span class="mpre">CurveBinary</span></span></a><span class="mpre"> </span><a name="loc_50_36_50_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_38&#39;)"><span class="hl_vardecl"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a name="loc_50_39_50_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_41&#39;)"><span class="hl_vardecl"><span class="mpre">cc</span></span></a><span class="mpre">)) (</span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a name="loc_50_51_50_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_51_50_53&#39;)"><span class="hl_vardecl"><span class="mpre">xp</span></span></a><span class="mpre"> </span><a name="loc_50_54_50_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_54_50_56&#39;)"><span class="hl_vardecl"><span class="mpre">yp</span></span></a><span class="mpre">) = </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_45_14_45_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_45_14_45_20&#39;)"><span class="hl_conref"><span class="mpre">PointO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_51_5_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_varref"><span class="mpre">addF2m</span></span></a><span class="mpre"> </span><a href="#loc_50_51_50_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_51_50_53&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_109_1_109_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_109_1_109_7&#39;)"><span class="hl_varref"><span class="mpre">divF2m</span></span></a><span class="mpre"> </span><a href="#loc_50_36_50_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_38&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_50_54_50_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_54_50_56&#39;)"><span class="hl_varref"><span class="mpre">yp</span></span></a><span class="mpre"> </span><a href="#loc_50_51_50_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_51_50_53&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre">
    let </span><a name="loc_52_9_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_11&#39;)"><span class="hl_vardecl"><span class="mpre">xr</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.F2m.html#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_57_1_57_7&#39;)"><span class="hl_varref"><span class="mpre">mulF2m</span></span></a><span class="mpre"> </span><a href="#loc_50_36_50_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_38&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_51_5_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_51_5_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_51_5_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="#loc_55_9_55_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
        </span><a name="loc_53_9_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_11&#39;)"><span class="hl_vardecl"><span class="mpre">yr</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.F2m.html#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_57_1_57_7&#39;)"><span class="hl_varref"><span class="mpre">mulF2m</span></span></a><span class="mpre"> </span><a href="#loc_50_36_50_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_38&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_50_51_50_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_51_50_53&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><a href="#loc_50_51_50_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_51_50_53&#39;)"><span class="hl_varref"><span class="mpre">xp</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_57_1_57_7&#39;)"><span class="hl_varref"><span class="mpre">mulF2m</span></span></a><span class="mpre"> </span><a href="#loc_50_36_50_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_38&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_11&#39;)"><span class="hl_varref"><span class="mpre">xr</span></span></a><span class="mpre"> (</span><a href="#loc_51_5_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Crypto.Number.F2m.html#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.F2m.html#loc_38_1_38_7&#39;)"><span class="hl_infix"><span class="mpre">`addF2m`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_14_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_14_44_19&#39;)"><span class="hl_conref"><span class="mpre">Point</span></span></a><span class="mpre"> </span><a href="#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_11&#39;)"><span class="hl_varref"><span class="mpre">xr</span></span></a><span class="mpre"> </span><a href="#loc_53_9_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_11&#39;)"><span class="hl_varref"><span class="mpre">yr</span></span></a><span class="mpre">
  where </span><a name="loc_55_9_55_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.ECC.html#loc_74_7_74_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_74_7_74_12&#39;)"><span class="hl_varref"><span class="mpre">ecc_a</span></span></a><span class="mpre"> </span><a href="#loc_50_39_50_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_41&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Elliptic curve point multiplication (double and add algorithm).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /WARNING:/ Vulnerable to timing attacks.</span></span><span class="mpre">
</span><a href="#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_9&#39;)"><span class="mpre">pointMul</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.ECC.html#loc_33_6_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_33_6_33_11&#39;)"><span class="hl_tyconref"><span class="mpre">Curve</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_6_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_6_44_11&#39;)"><span class="hl_tyconref"><span class="mpre">Point</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.ECC.html#loc_44_6_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_44_6_44_11&#39;)"><span class="hl_tyconref"><span class="mpre">Point</span></span></a><span class="mpre">
</span><a name="loc_61_1_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_9&#39;)"><span class="hl_fundecl"><span class="mpre">pointMul</span></span></a><span class="mpre"> </span><a name="loc_61_10_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_61_12_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_12_61_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_61_14_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_14_61_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">
    | </span><a href="#loc_61_12_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_12_61_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><a href="#loc_61_14_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_14_61_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">odd</span></span><span class="mpre"> </span><a href="#loc_61_12_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_12_61_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_19_1_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_9&#39;)"><span class="hl_varref"><span class="mpre">pointAdd</span></span></a><span class="mpre"> </span><a href="#loc_61_10_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_61_14_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_14_61_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">pointMul</span></span></a><span class="mpre"> </span><a href="#loc_61_10_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_61_12_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_12_61_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_61_14_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_14_61_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_61_1_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_9&#39;)"><span class="hl_varref"><span class="mpre">pointMul</span></span></a><span class="mpre"> </span><a href="#loc_61_10_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_61_12_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_12_61_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">pointDouble</span></span></a><span class="mpre"> </span><a href="#loc_61_10_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_61_14_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_14_61_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | div and mod</span></span><span class="mpre">
</span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="mpre">divmod</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_fundecl"><span class="mpre">divmod</span></span></a><span class="mpre"> </span><a name="loc_68_8_68_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_8_68_9&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_68_10_68_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_10_68_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_68_12_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_12_68_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_68_8_68_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_8_68_9&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> (</span><a href="Crypto.Number.ModArithmetic.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_126_1_126_8&#39;)"><span class="hl_varref"><span class="mpre">inverse</span></span></a><span class="mpre"> (</span><a href="#loc_68_10_68_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_10_68_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_68_12_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_12_68_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><a href="#loc_68_12_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_12_68_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_68_12_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_12_68_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
</span></div></body></html>