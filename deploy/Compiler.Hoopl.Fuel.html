<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, TypeFamilies #-}
#if __GLASGOW_HASKELL__ &gt;= 701
{-# LANGUAGE Safe #-}
#endif

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                The fuel monad</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Compiler.Hoopl.Fuel
  ( Fuel, infiniteFuel, fuelRemaining
  , withFuel
  , FuelMonad(..)
  , FuelMonadT(..)
  , CheckingFuelMonad
  , InfiniteFuelMonad
  , SimpleFuelMonad
  )
where

import Compiler.Hoopl.Checkpoint
import Compiler.Hoopl.Unique

import Control.Applicative (</span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="mpre">Applicative</span></a><span class="mpre">(..))
import Control.Monad (</span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="mpre">ap</span></a><span class="mpre">,</span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="mpre">liftM</span></a><span class="mpre">)

class </span><span class="warning" data-warning="ClassDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 7, srcSpanEndLine = 27, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 15, srcSpanEndLine = 27, srcSpanEndColumn = 17}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoo"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a name="loc_27_18_27_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_18_27_27&#39;)"><span class="hl_classdecl"><span class="mpre">FuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> where
  </span><a name="loc_28_3_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_3_28_10&#39;)"><span class="mpre">getFuel</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Fuel</span></span><span class="mpre">
  </span><a name="loc_29_3_29_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_3_29_10&#39;)"><span class="mpre">setFuel</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Fuel</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Find out how much fuel remains after a computation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Can be subtracted from initial fuel to get total consumption.</span></span><span class="mpre">
</span><a href="#loc_34_1_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_14&#39;)"><span class="mpre">fuelRemaining</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 18, srcSpanEndLine = 33, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 30, srcSpanEndLine = 33, srcSpanEndColumn = 32}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">FuelMonad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Fuel</span></span><span class="mpre">
</span><a name="loc_34_1_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_14&#39;)"><span class="hl_vardecl"><span class="mpre">fuelRemaining</span></span></a><span class="mpre"> = </span><a href="#loc_28_3_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_3_28_10&#39;)"><span class="hl_varref"><span class="mpre">getFuel</span></span></a><span class="mpre">

class </span><a name="loc_36_7_36_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_17&#39;)"><span class="hl_classdecl"><span class="mpre">FuelMonadT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">fm</span></span><span class="mpre"> where
  </span><a name="loc_37_3_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_14&#39;)"><span class="mpre">runWithFuel</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 18, srcSpanEndLine = 37, srcSpanEndColumn = 48}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 18, srcSpanEndLine = 37, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;"><span class="mpre">(Monad m, FuelMonad (fm m)) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Fuel</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">fm</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  </span><a name="loc_38_3_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_3_38_11&#39;)"><span class="mpre">liftFuel</span></a><span class="mpre">    :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 18, srcSpanEndLine = 38, srcSpanEndColumn = 48}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 18, srcSpanEndLine = 38, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;"><span class="mpre">(Monad m, FuelMonad (fm m)) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">fm</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">



</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 1, srcSpanEndLine = 42, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 1, srcSpanEndLine = 42, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, "><span class="mpre">type Fuel = Int</span></span><span class="mpre">

</span><a href="#loc_45_1_45_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_9&#39;)"><span class="mpre">withFuel</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 13, srcSpanEndLine = 44, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 25, srcSpanEndLine = 44, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">FuelMonad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_45_1_45_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_9&#39;)"><span class="hl_fundecl"><span class="mpre">withFuel</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_45_1_45_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_9&#39;)"><span class="hl_fundecl"><span class="mpre">withFuel</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_46_16_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = do </span><a name="loc_46_24_46_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_24_46_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_28_3_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_3_28_10&#39;)"><span class="hl_varref"><span class="mpre">getFuel</span></span></a><span class="mpre">
                       if </span><a href="#loc_46_24_46_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_24_46_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                         then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                         else </span><a href="#loc_29_3_29_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_3_29_10&#39;)"><span class="hl_varref"><span class="mpre">setFuel</span></span></a><span class="mpre"> (</span><a href="#loc_46_24_46_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_24_46_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_46_16_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

newtype </span><a name="loc_54_9_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_26&#39;)"><span class="hl_tycondecl"><span class="mpre">CheckingFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_54_33_54_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_33_54_35&#39;)"><span class="hl_condecl"><span class="mpre">FM</span></span></a><span class="mpre"> { </span><a name="loc_54_38_54_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_38_54_42&#39;)"><span class="hl_fielddecl"><span class="mpre">unFM</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Fuel</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Fuel</span></span><span class="mpre">) }

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 10, srcSpanEndLine = 56, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 18, srcSpanEndLine = 56, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_54_9_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_26&#39;)"><span class="hl_tyconref"><span class="mpre">CheckingFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><span class="hl_vardecl"><span class="mpre">fmap</span></span><span class="mpre">  = </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 10, srcSpanEndLine = 59, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 18, srcSpanEndLine = 59, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_54_9_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_26&#39;)"><span class="hl_tyconref"><span class="mpre">CheckingFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
  </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 10, srcSpanEndLine = 63, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 18, srcSpanEndLine = 63, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_54_9_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_26&#39;)"><span class="hl_tyconref"><span class="mpre">CheckingFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_64_10_64_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_54_33_54_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_33_54_35&#39;)"><span class="hl_conref"><span class="mpre">FM</span></span></a><span class="mpre"> (\</span><a name="loc_64_19_64_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_19_64_20&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_64_10_64_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_64_19_64_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_19_64_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">))
  </span><a name="loc_65_3_65_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_3_65_5&#39;)"><span class="hl_vardecl"><span class="mpre">fm</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_54_33_54_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_33_54_35&#39;)"><span class="hl_conref"><span class="mpre">FM</span></span></a><span class="mpre"> (\</span><a name="loc_65_19_65_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_19_65_20&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; do { (</span><a name="loc_65_30_65_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_30_65_31&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_65_33_65_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_33_65_35&#39;)"><span class="hl_vardecl"><span class="mpre">f&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_54_38_54_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_38_54_42&#39;)"><span class="hl_varref"><span class="mpre">unFM</span></span></a><span class="mpre"> </span><a href="#loc_65_3_65_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_3_65_5&#39;)"><span class="hl_varref"><span class="mpre">fm</span></span></a><span class="mpre"> </span><a href="#loc_65_19_65_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_19_65_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">; </span><a href="#loc_54_38_54_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_38_54_42&#39;)"><span class="hl_varref"><span class="mpre">unFM</span></span></a><span class="mpre"> (</span><a href="#loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_65_30_65_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_30_65_31&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_65_33_65_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_33_65_35&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre"> })

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 10, srcSpanEndLine = 67, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 28, srcSpanEndLine = 67, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">CheckpointMonad m =&gt;</span></span><span class="mpre"> </span><a href="Compiler.Hoopl.Checkpoint.html#loc_16_18_16_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_16_18_16_33&#39;)"><span class="hl_classref"><span class="mpre">CheckpointMonad</span></span></a><span class="mpre"> (</span><a href="#loc_54_9_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_26&#39;)"><span class="hl_tyconref"><span class="mpre">CheckingFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><span class="warning" data-warning="InstDeclInsType (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 3, srcSpanEndLine = 68, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 3, srcSpanEndLine = 68, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, s"><span class="mpre">type Checkpoint (CheckingFuelMonad m) = (Fuel, Checkpoint m)</span></span><span class="mpre">
  </span><a href="Compiler.Hoopl.Checkpoint.html#loc_18_3_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_18_3_18_13&#39;)"><span class="hl_vardecl"><span class="mpre">checkpoint</span></span></a><span class="mpre"> = </span><a href="#loc_54_33_54_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_33_54_35&#39;)"><span class="hl_conref"><span class="mpre">FM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_69_22_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_26&#39;)"><span class="hl_vardecl"><span class="mpre">fuel</span></span></a><span class="mpre"> -&gt; do { </span><a name="loc_69_35_69_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_35_69_36&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="Compiler.Hoopl.Checkpoint.html#loc_18_3_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_18_3_18_13&#39;)"><span class="hl_varref"><span class="mpre">checkpoint</span></span></a><span class="mpre">
                                ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ((</span><a href="#loc_69_22_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_26&#39;)"><span class="hl_varref"><span class="mpre">fuel</span></span></a><span class="mpre">, </span><a href="#loc_69_35_69_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_35_69_36&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">), </span><a href="#loc_69_22_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_26&#39;)"><span class="hl_varref"><span class="mpre">fuel</span></span></a><span class="mpre">) }
  </span><a href="Compiler.Hoopl.Checkpoint.html#loc_19_3_19_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_19_3_19_10&#39;)"><span class="hl_fundecl"><span class="mpre">restart</span></span></a><span class="mpre"> (</span><a name="loc_71_12_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_12_71_16&#39;)"><span class="hl_vardecl"><span class="mpre">fuel</span></span></a><span class="mpre">, </span><a name="loc_71_18_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_54_33_54_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_33_54_35&#39;)"><span class="hl_conref"><span class="mpre">FM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ -&gt; do { </span><a href="Compiler.Hoopl.Checkpoint.html#loc_19_3_19_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_19_3_19_10&#39;)"><span class="hl_varref"><span class="mpre">restart</span></span></a><span class="mpre"> </span><a href="#loc_71_18_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><a href="#loc_71_12_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_12_71_16&#39;)"><span class="hl_varref"><span class="mpre">fuel</span></span></a><span class="mpre">) }

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 73, srcSpanStartColumn = 10, srcSpanEndLine = 73, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 73, srcSpanStartColumn = 24, srcSpanEndLine = 73, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">UniqueMonad m =&gt;</span></span><span class="mpre"> </span><a href="Compiler.Hoopl.Unique.html#loc_107_18_107_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Unique.html#loc_107_18_107_29&#39;)"><span class="hl_classref"><span class="mpre">UniqueMonad</span></span></a><span class="mpre"> (</span><a href="#loc_54_9_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_26&#39;)"><span class="hl_tyconref"><span class="mpre">CheckingFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><a href="Compiler.Hoopl.Unique.html#loc_108_3_108_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Unique.html#loc_108_3_108_14&#39;)"><span class="hl_vardecl"><span class="mpre">freshUnique</span></span></a><span class="mpre"> = </span><a href="#loc_54_33_54_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_33_54_35&#39;)"><span class="hl_conref"><span class="mpre">FM</span></span></a><span class="mpre"> (\</span><a name="loc_74_22_74_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_22_74_23&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; do { </span><a name="loc_74_32_74_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_32_74_33&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><a href="Compiler.Hoopl.Unique.html#loc_108_3_108_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Unique.html#loc_108_3_108_14&#39;)"><span class="hl_varref"><span class="mpre">freshUnique</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_74_32_74_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_32_74_33&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="#loc_74_22_74_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_22_74_23&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) })

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 10, srcSpanEndLine = 76, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 18, srcSpanEndLine = 76, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a href="#loc_27_18_27_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_18_27_27&#39;)"><span class="hl_classref"><span class="mpre">FuelMonad</span></span></a><span class="mpre"> (</span><a href="#loc_54_9_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_26&#39;)"><span class="hl_tyconref"><span class="mpre">CheckingFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><a href="#loc_28_3_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_3_28_10&#39;)"><span class="hl_vardecl"><span class="mpre">getFuel</span></span></a><span class="mpre">   = </span><a href="#loc_54_33_54_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_33_54_35&#39;)"><span class="hl_conref"><span class="mpre">FM</span></span></a><span class="mpre"> (\</span><a name="loc_77_20_77_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_20_77_21&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_77_20_77_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_20_77_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><a href="#loc_77_20_77_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_20_77_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">))
  </span><a href="#loc_29_3_29_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_3_29_10&#39;)"><span class="hl_fundecl"><span class="mpre">setFuel</span></span></a><span class="mpre"> </span><a name="loc_78_11_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_54_33_54_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_33_54_35&#39;)"><span class="hl_conref"><span class="mpre">FM</span></span></a><span class="mpre"> (\_ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">,</span><a href="#loc_78_11_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">))

instance </span><a href="#loc_36_7_36_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_17&#39;)"><span class="hl_classref"><span class="mpre">FuelMonadT</span></span></a><span class="mpre"> </span><a href="#loc_54_9_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_26&#39;)"><span class="hl_tyconref"><span class="mpre">CheckingFuelMonad</span></span></a><span class="mpre"> where
  </span><a href="#loc_37_3_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_14&#39;)"><span class="hl_fundecl"><span class="mpre">runWithFuel</span></span></a><span class="mpre"> </span><a name="loc_81_15_81_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_19&#39;)"><span class="hl_vardecl"><span class="mpre">fuel</span></span></a><span class="mpre"> </span><a name="loc_81_20_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_20_81_21&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = do { (</span><a name="loc_81_30_81_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_30_81_31&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, _) &lt;- </span><a href="#loc_54_38_54_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_38_54_42&#39;)"><span class="hl_varref"><span class="mpre">unFM</span></span></a><span class="mpre"> </span><a href="#loc_81_20_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_20_81_21&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_81_15_81_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_19&#39;)"><span class="hl_varref"><span class="mpre">fuel</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_81_30_81_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_30_81_31&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> }
  </span><a href="#loc_38_3_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_3_38_11&#39;)"><span class="hl_fundecl"><span class="mpre">liftFuel</span></span></a><span class="mpre"> </span><a name="loc_82_12_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_54_33_54_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_33_54_35&#39;)"><span class="hl_conref"><span class="mpre">FM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_82_22_82_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_22_82_23&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; do { </span><a name="loc_82_32_82_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_32_82_33&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_82_12_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_82_32_82_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_32_82_33&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_82_22_82_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_22_82_23&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) }

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

newtype </span><a name="loc_86_9_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_26&#39;)"><span class="hl_tycondecl"><span class="mpre">InfiniteFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_86_33_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_33_86_36&#39;)"><span class="hl_condecl"><span class="mpre">IFM</span></span></a><span class="mpre"> { </span><a name="loc_86_39_86_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_39_86_44&#39;)"><span class="hl_fielddecl"><span class="mpre">unIFM</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> }

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 10, srcSpanEndLine = 88, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 18, srcSpanEndLine = 88, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_86_9_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_26&#39;)"><span class="hl_tyconref"><span class="mpre">InfiniteFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><span class="hl_vardecl"><span class="mpre">fmap</span></span><span class="mpre">  = </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 10, srcSpanEndLine = 91, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 18, srcSpanEndLine = 91, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_86_9_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_26&#39;)"><span class="hl_tyconref"><span class="mpre">InfiniteFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
  </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 10, srcSpanEndLine = 95, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 18, srcSpanEndLine = 95, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_86_9_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_26&#39;)"><span class="hl_tyconref"><span class="mpre">InfiniteFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_86_33_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_33_86_36&#39;)"><span class="hl_conref"><span class="mpre">IFM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
  </span><a name="loc_97_3_97_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_4&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_97_9_97_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">  = </span><a href="#loc_86_33_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_33_86_36&#39;)"><span class="hl_conref"><span class="mpre">IFM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do { </span><a name="loc_97_25_97_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_25_97_26&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_86_39_86_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_39_86_44&#39;)"><span class="hl_varref"><span class="mpre">unIFM</span></span></a><span class="mpre"> </span><a href="#loc_97_3_97_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">; </span><a href="#loc_86_39_86_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_39_86_44&#39;)"><span class="hl_varref"><span class="mpre">unIFM</span></span></a><span class="mpre"> (</span><a href="#loc_97_9_97_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_97_25_97_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_25_97_26&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) }

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 10, srcSpanEndLine = 99, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 24, srcSpanEndLine = 99, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ho"><span class="mpre">UniqueMonad m =&gt;</span></span><span class="mpre"> </span><a href="Compiler.Hoopl.Unique.html#loc_107_18_107_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Unique.html#loc_107_18_107_29&#39;)"><span class="hl_classref"><span class="mpre">UniqueMonad</span></span></a><span class="mpre"> (</span><a href="#loc_86_9_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_26&#39;)"><span class="hl_tyconref"><span class="mpre">InfiniteFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><a href="Compiler.Hoopl.Unique.html#loc_108_3_108_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Unique.html#loc_108_3_108_14&#39;)"><span class="hl_vardecl"><span class="mpre">freshUnique</span></span></a><span class="mpre"> = </span><a href="#loc_86_33_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_33_86_36&#39;)"><span class="hl_conref"><span class="mpre">IFM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Compiler.Hoopl.Unique.html#loc_108_3_108_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Unique.html#loc_108_3_108_14&#39;)"><span class="hl_varref"><span class="mpre">freshUnique</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 10, srcSpanEndLine = 102, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 18, srcSpanEndLine = 102, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a href="#loc_27_18_27_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_18_27_27&#39;)"><span class="hl_classref"><span class="mpre">FuelMonad</span></span></a><span class="mpre"> (</span><a href="#loc_86_9_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_26&#39;)"><span class="hl_tyconref"><span class="mpre">InfiniteFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><a href="#loc_28_3_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_3_28_10&#39;)"><span class="hl_vardecl"><span class="mpre">getFuel</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_118_1_118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_13&#39;)"><span class="hl_varref"><span class="mpre">infiniteFuel</span></span></a><span class="mpre">
  </span><a href="#loc_29_3_29_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_3_29_10&#39;)"><span class="hl_fundecl"><span class="mpre">setFuel</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 10, srcSpanEndLine = 106, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 28, srcSpanEndLine = 106, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">CheckpointMonad m =&gt;</span></span><span class="mpre"> </span><a href="Compiler.Hoopl.Checkpoint.html#loc_16_18_16_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_16_18_16_33&#39;)"><span class="hl_classref"><span class="mpre">CheckpointMonad</span></span></a><span class="mpre"> (</span><a href="#loc_86_9_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_26&#39;)"><span class="hl_tyconref"><span class="mpre">InfiniteFuelMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
  </span><span class="warning" data-warning="InstDeclInsType (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 3, srcSpanEndLine = 107, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 3, srcSpanEndLine = 107, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs"><span class="mpre">type Checkpoint (InfiniteFuelMonad m) = Checkpoint m</span></span><span class="mpre">
  </span><a href="Compiler.Hoopl.Checkpoint.html#loc_18_3_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_18_3_18_13&#39;)"><span class="hl_vardecl"><span class="mpre">checkpoint</span></span></a><span class="mpre"> = </span><a href="#loc_86_33_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_33_86_36&#39;)"><span class="hl_conref"><span class="mpre">IFM</span></span></a><span class="mpre"> </span><a href="Compiler.Hoopl.Checkpoint.html#loc_18_3_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_18_3_18_13&#39;)"><span class="hl_varref"><span class="mpre">checkpoint</span></span></a><span class="mpre">
  </span><a href="Compiler.Hoopl.Checkpoint.html#loc_19_3_19_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_19_3_19_10&#39;)"><span class="hl_fundecl"><span class="mpre">restart</span></span></a><span class="mpre"> </span><a name="loc_109_11_109_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  = </span><a href="#loc_86_33_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_33_86_36&#39;)"><span class="hl_conref"><span class="mpre">IFM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Compiler.Hoopl.Checkpoint.html#loc_19_3_19_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Checkpoint.html#loc_19_3_19_10&#39;)"><span class="hl_varref"><span class="mpre">restart</span></span></a><span class="mpre"> </span><a href="#loc_109_11_109_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">



instance </span><a href="#loc_36_7_36_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_17&#39;)"><span class="hl_classref"><span class="mpre">FuelMonadT</span></span></a><span class="mpre"> </span><a href="#loc_86_9_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_26&#39;)"><span class="hl_tyconref"><span class="mpre">InfiniteFuelMonad</span></span></a><span class="mpre"> where
  </span><a href="#loc_37_3_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_14&#39;)"><span class="hl_fundecl"><span class="mpre">runWithFuel</span></span></a><span class="mpre"> _ = </span><a href="#loc_86_39_86_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_39_86_44&#39;)"><span class="hl_varref"><span class="mpre">unIFM</span></span></a><span class="mpre">
  </span><a href="#loc_38_3_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_3_38_11&#39;)"><span class="hl_vardecl"><span class="mpre">liftFuel</span></span></a><span class="mpre"> = </span><a href="#loc_86_33_86_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_33_86_36&#39;)"><span class="hl_conref"><span class="mpre">IFM</span></span></a><span class="mpre">

</span><a href="#loc_118_1_118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_13&#39;)"><span class="mpre">infiniteFuel</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Fuel</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- effectively infinite, any, but subtractable</span></span><span class="mpre">
</span><a name="loc_118_1_118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_13&#39;)"><span class="hl_vardecl"><span class="mpre">infiniteFuel</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maxBound</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 1, srcSpanEndLine = 120, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 1, srcSpanEndLine = 120, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Fuel.h"><span class="mpre">type SimpleFuelMonad = CheckingFuelMonad SimpleUniqueMonad</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
runWithFuelAndUniques :: Fuel -&gt; [Unique] -&gt; FuelMonad a -&gt; a
runWithFuelAndUniques fuel uniques m = a
  where (a, _, _) = unFM m fuel uniques

freshUnique :: FuelMonad Unique
freshUnique = FM (\f (l:ls) -&gt; (l, f, ls))
-}</span></span><span class="mpre">

</span></div></body></html>