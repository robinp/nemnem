<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
module Tests.SlowFunctions
    (
      indices
    , splitOn
    ) where

import qualified Data.Text as T
import Data.Text.Internal (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">(..))
import Data.Text.Unsafe (</span><a href="Data.Text.Unsafe.html#loc_80_1_80_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_80_1_80_6&#39;)"><span class="mpre">iter_</span></a><span class="mpre">, </span><a href="Data.Text.Unsafe.html#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_43_1_43_11&#39;)"><span class="mpre">unsafeHead</span></a><span class="mpre">, </span><a href="Data.Text.Unsafe.html#loc_54_1_54_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_54_1_54_11&#39;)"><span class="mpre">unsafeTail</span></a><span class="mpre">)

</span><a href="#loc_15_1_15_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_8&#39;)"><span class="mpre">indices</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- ^ Substring to search for (@needle@)</span></span><span class="mpre">
        -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- ^ Text to search in (@haystack@)</span></span><span class="mpre">
        -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]
</span><a name="loc_15_1_15_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_8&#39;)"><span class="hl_fundecl"><span class="mpre">indices</span></span></a><span class="mpre"> </span><a name="loc_15_9_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_15&#39;)"><span class="hl_specname"><span class="mpre">needle</span></span></a><span class="mpre">@(</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_narr</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_noff</span></span><span class="mpre"> </span><a name="loc_15_34_15_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_34_15_38&#39;)"><span class="hl_vardecl"><span class="mpre">nlen</span></span></a><span class="mpre">) </span><a name="loc_15_40_15_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_40_15_48&#39;)"><span class="hl_specname"><span class="mpre">haystack</span></span></a><span class="mpre">@(</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_15_55_15_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_55_15_59&#39;)"><span class="hl_vardecl"><span class="mpre">harr</span></span></a><span class="mpre"> </span><a name="loc_15_60_15_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_60_15_64&#39;)"><span class="hl_vardecl"><span class="mpre">hoff</span></span></a><span class="mpre"> </span><a name="loc_15_65_15_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_65_15_69&#39;)"><span class="hl_vardecl"><span class="mpre">hlen</span></span></a><span class="mpre">)
    | </span><a href="Data.Text.html#loc_531_1_531_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_531_1_531_5&#39;)"><span class="hl_varref"><span class="mpre">T.null</span></span></a><span class="mpre"> </span><a href="#loc_15_9_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_15&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre"> = []
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_19_5_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_5_19_9&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where
    </span><a name="loc_19_5_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_5_19_9&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a name="loc_19_10_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> | </span><a href="#loc_19_10_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_15_65_15_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_65_15_69&#39;)"><span class="hl_varref"><span class="mpre">hlen</span></span></a><span class="mpre"> = []
           | </span><a href="#loc_15_9_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_15&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre"> </span><a href="Data.Text.html#loc_1538_1_1538_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1538_1_1538_11&#39;)"><span class="hl_infix"><span class="mpre">`T.isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_22_18_22_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_18_22_19&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_19_10_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_19_5_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_5_19_9&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> (</span><a href="#loc_19_10_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_15_34_15_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_34_15_38&#39;)"><span class="hl_varref"><span class="mpre">nlen</span></span></a><span class="mpre">)
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_19_5_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_5_19_9&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> (</span><a href="#loc_19_10_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_23_18_23_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_18_23_19&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
           where </span><a name="loc_22_18_22_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_18_22_19&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a href="#loc_15_55_15_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_55_15_59&#39;)"><span class="hl_varref"><span class="mpre">harr</span></span></a><span class="mpre"> (</span><a href="#loc_15_60_15_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_60_15_64&#39;)"><span class="hl_varref"><span class="mpre">hoff</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_19_10_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) (</span><a href="#loc_15_65_15_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_65_15_69&#39;)"><span class="hl_varref"><span class="mpre">hlen</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_19_10_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
                 </span><a name="loc_23_18_23_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_18_23_19&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="Data.Text.Unsafe.html#loc_80_1_80_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_80_1_80_6&#39;)"><span class="hl_varref"><span class="mpre">iter_</span></span></a><span class="mpre"> </span><a href="#loc_15_40_15_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_40_15_48&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre"> </span><a href="#loc_19_10_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_10_19_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><a href="#loc_28_1_28_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_8&#39;)"><span class="mpre">splitOn</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- ^ Text to split on</span></span><span class="mpre">
        -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- ^ Input text</span></span><span class="mpre">
        -&gt; [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">]
</span><a name="loc_28_1_28_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_8&#39;)"><span class="hl_fundecl"><span class="mpre">splitOn</span></span></a><span class="mpre"> </span><a name="loc_28_9_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> </span><a name="loc_28_13_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_17&#39;)"><span class="hl_vardecl"><span class="mpre">src0</span></span></a><span class="mpre">
    | </span><a href="Data.Text.html#loc_531_1_531_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_531_1_531_5&#39;)"><span class="hl_varref"><span class="mpre">T.null</span></span></a><span class="mpre"> </span><a href="#loc_28_9_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;splitOn: empty&quot;</span></span><span class="mpre">
    | </span><a href="#loc_33_5_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">      = </span><a href="Data.Text.html#loc_1280_1_1280_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1280_1_1280_6&#39;)"><span class="hl_varref"><span class="mpre">T.split</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> (</span><a href="Data.Text.Unsafe.html#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_43_1_43_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeHead</span></span></a><span class="mpre"> </span><a href="#loc_28_9_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">)) </span><a href="#loc_28_13_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_17&#39;)"><span class="hl_varref"><span class="mpre">src0</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   = </span><a href="#loc_34_5_34_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_28_13_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_17&#39;)"><span class="hl_varref"><span class="mpre">src0</span></span></a><span class="mpre">
  where
    </span><a name="loc_33_5_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_6&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">      = </span><a href="Data.Text.html#loc_554_1_554_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_554_1_554_7&#39;)"><span class="hl_varref"><span class="mpre">T.length</span></span></a><span class="mpre"> </span><a href="#loc_28_9_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_34_5_34_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_34_8_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_8_34_11&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = </span><a href="#loc_36_9_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_15&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_34_8_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_8_34_11&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
      where
        </span><a name="loc_36_9_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_15&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> !</span><a name="loc_36_17_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> !</span><a name="loc_36_20_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_20_36_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">
            | </span><a href="Data.Text.html#loc_531_1_531_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_531_1_531_5&#39;)"><span class="hl_varref"><span class="mpre">T.null</span></span></a><span class="mpre"> </span><a href="#loc_36_20_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_20_36_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">             = [</span><a href="#loc_34_8_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_8_34_11&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">]      </span><span class="hl_comment"><span class="mpre">-- not found</span></span><span class="mpre">
            | </span><a href="#loc_28_9_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><a href="Data.Text.html#loc_1538_1_1538_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1538_1_1538_11&#39;)"><span class="hl_infix"><span class="mpre">`T.isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_36_20_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_20_36_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="Data.Text.html#loc_1017_1_1017_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1017_1_1017_5&#39;)"><span class="hl_varref"><span class="mpre">T.take</span></span></a><span class="mpre"> </span><a href="#loc_36_17_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_34_8_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_8_34_11&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_34_5_34_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="Data.Text.html#loc_1062_1_1062_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1062_1_1062_5&#39;)"><span class="hl_varref"><span class="mpre">T.drop</span></span></a><span class="mpre"> </span><a href="#loc_33_5_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_36_20_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_20_36_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">            = </span><a href="#loc_36_9_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_15&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> (</span><a href="#loc_36_17_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="Data.Text.Unsafe.html#loc_54_1_54_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_54_1_54_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeTail</span></span></a><span class="mpre"> </span><a href="#loc_36_20_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_20_36_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
</span></div></body></html>