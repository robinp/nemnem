<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
module Network.HTTP.ClientSpec where

import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 4, srcSpanStartColumn = 18, srcSpanEndLine = 4, srcSpanEndColumn = 36}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre">        (forkIO, threadDelay)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 5, srcSpanStartColumn = 18, srcSpanEndLine = 5, srcSpanEndColumn = 42}, srcInfoPoints = []}) &quot;Control.Concurrent.Async&quot;"><span class="mpre">Control.Concurrent.Async</span></span><span class="mpre">  (withAsync)
import           Control.Exception         (</span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="mpre">bracket</span></a><span class="mpre">)
import           Control.Monad             (</span><a href="Control.Monad.html#loc_189_1_189_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_189_1_189_8&#39;)"><span class="mpre">forever</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_254_1_254_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_254_1_254_12&#39;)"><span class="mpre">replicateM_</span></a><span class="mpre">)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 18, srcSpanEndLine = 8, srcSpanEndColumn = 25}, srcInfoPoints = []}) &quot;Network&quot;"><span class="mpre">Network</span></span><span class="mpre">                   (PortID (PortNumber), listenOn, withSocketsDo)
import           Network.HTTP.Client
import           Network.HTTP.Types        (</span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="mpre">status200</span></a><span class="mpre">)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 18, srcSpanEndLine = 11, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre">            (accept, sClose)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 43}, srcInfoPoints = []}) &quot;Network.Socket.ByteString&quot;"><span class="mpre">Network.Socket.ByteString</span></span><span class="mpre"> (recv, sendAll)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 40}, srcInfoPoints = []}) &quot;Data.Streaming.Network&quot;"><span class="mpre">Data.Streaming.Network</span></span><span class="mpre">    as N
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 18, srcSpanEndLine = 15, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">           as S
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 18, srcSpanEndLine = 16, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre"> () </span><span class="hl_comment"><span class="mpre">-- orphan instance</span></span><span class="mpre">

</span><a href="#loc_19_1_19_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_19_1_19_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hspec</span></span><span class="mpre"> </span><a href="#loc_57_1_57_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_5&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">

</span><a href="#loc_22_1_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_15&#39;)"><span class="mpre">redirectServer</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_22_1_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_15&#39;)"><span class="hl_fundecl"><span class="mpre">redirectServer</span></span></a><span class="mpre"> </span><a name="loc_22_16_22_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_16_22_21&#39;)"><span class="hl_vardecl"><span class="mpre">inner</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre">
    (</span><span class="hl_varref"><span class="mpre">N.bindRandomPortTCP</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;*4&quot;</span></span><span class="mpre">)
    (</span><span class="hl_varref"><span class="mpre">sClose</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a name="loc_25_9_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_13&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre">, </span><a name="loc_25_15_25_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_22&#39;)"><span class="hl_vardecl"><span class="mpre">lsocket</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">withAsync</span></span><span class="mpre">
        (</span><span class="hl_varref"><span class="mpre">N.runTCPServer</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">N.serverSettingsTCPSocket</span></span><span class="mpre"> </span><a href="#loc_25_15_25_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_22&#39;)"><span class="hl_varref"><span class="mpre">lsocket</span></span></a><span class="mpre">) </span><a href="#loc_29_5_29_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_5_29_8&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre">)
        (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_22_16_22_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_16_22_21&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_13&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">)
  where
    </span><a name="loc_29_5_29_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_5_29_8&#39;)"><span class="hl_fundecl"><span class="mpre">app</span></span></a><span class="mpre"> </span><a name="loc_29_9_29_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_11&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre"> = do
        </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_189_1_189_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_189_1_189_8&#39;)"><span class="hl_varref"><span class="mpre">forever</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">N.appRead</span></span><span class="mpre"> </span><a href="#loc_29_9_29_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_11&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_189_1_189_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_189_1_189_8&#39;)"><span class="hl_varref"><span class="mpre">forever</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><span class="hl_varref"><span class="mpre">N.appWrite</span></span><span class="mpre"> </span><a href="#loc_29_9_29_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_11&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1 301 Redirect\r\nLocation: /\r\ncontent-length: 5\r\n\r\n&quot;</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10000</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">N.appWrite</span></span><span class="mpre"> </span><a href="#loc_29_9_29_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_11&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hello\r\n&quot;</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10000</span></span><span class="mpre">

</span><a href="#loc_39_1_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_13&#39;)"><span class="mpre">bad100Server</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ include extra headers?</span></span><span class="mpre">
             -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_39_1_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_13&#39;)"><span class="hl_fundecl"><span class="mpre">bad100Server</span></span></a><span class="mpre"> </span><a name="loc_39_14_39_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_14_39_26&#39;)"><span class="hl_vardecl"><span class="mpre">extraHeaders</span></span></a><span class="mpre"> </span><a name="loc_39_27_39_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_27_39_32&#39;)"><span class="hl_vardecl"><span class="mpre">inner</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre">
    (</span><span class="hl_varref"><span class="mpre">N.bindRandomPortTCP</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;*4&quot;</span></span><span class="mpre">)
    (</span><span class="hl_varref"><span class="mpre">sClose</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a name="loc_42_9_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_13&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre">, </span><a name="loc_42_15_42_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_15_42_22&#39;)"><span class="hl_vardecl"><span class="mpre">lsocket</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">withAsync</span></span><span class="mpre">
        (</span><span class="hl_varref"><span class="mpre">N.runTCPServer</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">N.serverSettingsTCPSocket</span></span><span class="mpre"> </span><a href="#loc_42_15_42_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_15_42_22&#39;)"><span class="hl_varref"><span class="mpre">lsocket</span></span></a><span class="mpre">) </span><a href="#loc_46_5_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_8&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre">)
        (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_39_27_39_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_27_39_32&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_42_9_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_13&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">)
  where
    </span><a name="loc_46_5_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_8&#39;)"><span class="hl_fundecl"><span class="mpre">app</span></span></a><span class="mpre"> </span><a name="loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre"> = do
        </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_189_1_189_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_189_1_189_8&#39;)"><span class="hl_varref"><span class="mpre">forever</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">N.appRead</span></span><span class="mpre"> </span><a href="#loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_189_1_189_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_189_1_189_8&#39;)"><span class="hl_varref"><span class="mpre">forever</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><span class="hl_varref"><span class="mpre">N.appWrite</span></span><span class="mpre"> </span><a href="#loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre">
                [ </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1 100 Continue\r\n&quot;</span></span><span class="mpre">
                , if </span><a href="#loc_39_14_39_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_14_39_26&#39;)"><span class="hl_varref"><span class="mpre">extraHeaders</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;foo:bar\r\nbaz: bin\r\n&quot;</span></span><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                , </span><span class="hl_string"><span class="mpre">&quot;\r\nHTTP/1.1 200 OK\r\ncontent-length: 5\r\n\r\nhello\r\n&quot;</span></span><span class="mpre">
                ]
            </span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10000</span></span><span class="mpre">

</span><a href="#loc_57_1_57_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_5&#39;)"><span class="mpre">spec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_57_1_57_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_5&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Client&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;works&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">withSocketsDo</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_59_9_59_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_12&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;http://www.yesodweb.com/&quot;</span></span><span class="mpre">
        </span><a name="loc_60_9_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_12&#39;)"><span class="hl_vardecl"><span class="mpre">man</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Manager.html#loc_127_1_127_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_127_1_127_11&#39;)"><span class="hl_varref"><span class="mpre">newManager</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Manager.html#loc_54_1_54_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_54_1_54_23&#39;)"><span class="hl_varref"><span class="mpre">defaultManagerSettings</span></span></a><span class="mpre">
        </span><a name="loc_61_9_61_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_12&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Core.html#loc_58_1_58_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Core.html#loc_58_1_58_8&#39;)"><span class="hl_varref"><span class="mpre">httpLbs</span></span></a><span class="mpre"> </span><a href="#loc_59_9_59_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_60_9_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_12&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_405_7_405_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_405_7_405_21&#39;)"><span class="hl_varref"><span class="mpre">responseStatus</span></span></a><span class="mpre"> </span><a href="#loc_61_9_61_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_12&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;fails on empty hostnames #40&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        let </span><a name="loc_64_13_64_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_13_64_17&#39;)"><span class="hl_fundecl"><span class="mpre">test</span></span></a><span class="mpre"> </span><a name="loc_64_18_64_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_18_64_21&#39;)"><span class="hl_vardecl"><span class="mpre">url</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><a href="#loc_64_18_64_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_18_64_21&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                </span><a name="loc_65_17_65_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_17_65_20&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><a href="#loc_64_18_64_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_18_64_21&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre">
                </span><a name="loc_66_17_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_20&#39;)"><span class="hl_vardecl"><span class="mpre">man</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Manager.html#loc_127_1_127_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_127_1_127_11&#39;)"><span class="hl_varref"><span class="mpre">newManager</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Manager.html#loc_54_1_54_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_54_1_54_23&#39;)"><span class="hl_varref"><span class="mpre">defaultManagerSettings</span></span></a><span class="mpre">
                _ &lt;- </span><a href="Network.HTTP.Client.Core.html#loc_58_1_58_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Core.html#loc_58_1_58_8&#39;)"><span class="hl_varref"><span class="mpre">httpLbs</span></span></a><span class="mpre"> </span><a href="#loc_65_17_65_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_17_65_20&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_66_17_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_20&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldThrow`</span></span><span class="mpre"> \</span><a name="loc_67_53_67_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_53_67_54&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
                    case </span><a href="#loc_67_53_67_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_53_67_54&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
                        </span><span class="hl_conref"><span class="mpre">InvalidDestinationHost</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                        _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> </span><a href="#loc_64_13_64_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_13_64_17&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;http://&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;https://&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;http://:8000&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;https://:8001&quot;</span></span><span class="mpre">]
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;redirecting #41&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_22_1_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_15&#39;)"><span class="hl_varref"><span class="mpre">redirectServer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_73_46_73_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_46_73_50&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre"> -&gt; do
        </span><span class="hl_vardecl"><span class="mpre">req&#39;</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;http://127.0.0.1:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_73_46_73_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_46_73_50&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">
        let </span><a name="loc_75_13_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_16&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 19, srcSpanEndLine = 75, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 24, srcSpanEndLine = 75, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/N"><span class="mpre">req&#39; { redirectCount = 1 }</span></span><span class="mpre">
        </span><a href="Network.HTTP.Client.Manager.html#loc_257_1_257_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_257_1_257_12&#39;)"><span class="hl_varref"><span class="mpre">withManager</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Manager.html#loc_54_1_54_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_54_1_54_23&#39;)"><span class="hl_varref"><span class="mpre">defaultManagerSettings</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_76_47_76_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_47_76_50&#39;)"><span class="hl_vardecl"><span class="mpre">man</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.html#loc_254_1_254_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_254_1_254_12&#39;)"><span class="hl_varref"><span class="mpre">replicateM_</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a href="Network.HTTP.Client.Core.html#loc_58_1_58_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Core.html#loc_58_1_58_8&#39;)"><span class="hl_varref"><span class="mpre">httpLbs</span></span></a><span class="mpre"> </span><a href="#loc_75_13_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_16&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_76_47_76_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_47_76_50&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldThrow`</span></span><span class="mpre"> \</span><a name="loc_77_44_77_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_44_77_45&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
                case </span><a href="#loc_77_44_77_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_44_77_45&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">TooManyRedirects</span></span><span class="mpre"> _ -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                    _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;redirectCount=0&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_22_1_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_15&#39;)"><span class="hl_varref"><span class="mpre">redirectServer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_81_46_81_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_46_81_50&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre"> -&gt; do
        </span><span class="hl_vardecl"><span class="mpre">req&#39;</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;http://127.0.0.1:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_81_46_81_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_46_81_50&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">
        let </span><a name="loc_83_13_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_16&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 19, srcSpanEndLine = 83, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 24, srcSpanEndLine = 83, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/N"><span class="mpre">req&#39; { redirectCount = 0 }</span></span><span class="mpre">
        </span><a href="Network.HTTP.Client.Manager.html#loc_257_1_257_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_257_1_257_12&#39;)"><span class="hl_varref"><span class="mpre">withManager</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Manager.html#loc_54_1_54_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_54_1_54_23&#39;)"><span class="hl_varref"><span class="mpre">defaultManagerSettings</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_84_47_84_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_47_84_50&#39;)"><span class="hl_vardecl"><span class="mpre">man</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.html#loc_254_1_254_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_254_1_254_12&#39;)"><span class="hl_varref"><span class="mpre">replicateM_</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a href="Network.HTTP.Client.Core.html#loc_58_1_58_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Core.html#loc_58_1_58_8&#39;)"><span class="hl_varref"><span class="mpre">httpLbs</span></span></a><span class="mpre"> </span><a href="#loc_83_13_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_16&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_84_47_84_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_47_84_50&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldThrow`</span></span><span class="mpre"> \</span><a name="loc_85_44_85_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_44_85_45&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
                case </span><a href="#loc_85_44_85_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_44_85_45&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
                    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 21, srcSpanEndLine = 87, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/ClientSpec.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 40, srcSpanEndLine = 87, srcSpanEndColumn = 41},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Networ"><span class="mpre">StatusCodeException{}</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                    _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;connecting to missing server gives nice error message&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_90_10_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_14&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre">, </span><a name="loc_90_16_90_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_22&#39;)"><span class="hl_vardecl"><span class="mpre">socket</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">N.bindRandomPortTCP</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;*4&quot;</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">sClose</span></span><span class="mpre"> </span><a href="#loc_90_16_90_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_22&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre">
        </span><a name="loc_92_9_92_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_12&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;http://127.0.0.1:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_90_10_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_14&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Manager.html#loc_257_1_257_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_257_1_257_12&#39;)"><span class="hl_varref"><span class="mpre">withManager</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Manager.html#loc_54_1_54_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_54_1_54_23&#39;)"><span class="hl_varref"><span class="mpre">defaultManagerSettings</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_93_47_93_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_47_93_50&#39;)"><span class="hl_vardecl"><span class="mpre">man</span></span></a><span class="mpre"> -&gt;
            </span><a href="Network.HTTP.Client.Core.html#loc_58_1_58_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Core.html#loc_58_1_58_8&#39;)"><span class="hl_varref"><span class="mpre">httpLbs</span></span></a><span class="mpre"> </span><a href="#loc_92_9_92_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_93_47_93_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_47_93_50&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldThrow`</span></span><span class="mpre"> \</span><a name="loc_94_44_94_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_44_94_45&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
                case </span><a href="#loc_94_44_94_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_44_94_45&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">FailedConnectionException2</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;127.0.0.1&quot;</span></span><span class="mpre"> </span><a name="loc_96_60_96_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_60_96_65&#39;)"><span class="hl_vardecl"><span class="mpre">port&#39;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> _ -&gt; </span><a href="#loc_90_10_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_14&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_96_60_96_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_60_96_65&#39;)"><span class="hl_varref"><span class="mpre">port&#39;</span></span></a><span class="mpre">
                    _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;extra headers after 100 #49&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        let </span><a name="loc_100_13_100_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_17&#39;)"><span class="hl_fundecl"><span class="mpre">test</span></span></a><span class="mpre"> </span><a name="loc_100_18_100_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_18_100_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_100_18_100_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_18_100_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_39_1_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_13&#39;)"><span class="hl_varref"><span class="mpre">bad100Server</span></span></a><span class="mpre"> </span><a href="#loc_100_18_100_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_18_100_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_100_54_100_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_54_100_58&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre"> -&gt; do
                </span><a name="loc_101_17_101_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_20&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;http://127.0.0.1:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_100_54_100_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_54_100_58&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">
                </span><a href="Network.HTTP.Client.Manager.html#loc_257_1_257_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_257_1_257_12&#39;)"><span class="hl_varref"><span class="mpre">withManager</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Manager.html#loc_54_1_54_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Manager.html#loc_54_1_54_23&#39;)"><span class="hl_varref"><span class="mpre">defaultManagerSettings</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_102_55_102_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_55_102_58&#39;)"><span class="hl_vardecl"><span class="mpre">man</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.html#loc_254_1_254_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_254_1_254_12&#39;)"><span class="hl_varref"><span class="mpre">replicateM_</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                    </span><a name="loc_103_21_103_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_21_103_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Core.html#loc_58_1_58_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Core.html#loc_58_1_58_8&#39;)"><span class="hl_varref"><span class="mpre">httpLbs</span></span></a><span class="mpre"> </span><a href="#loc_101_17_101_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_20&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_102_55_102_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_55_102_58&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre">
                    </span><a href="Network.HTTP.Client.Types.html#loc_417_7_417_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_417_7_417_19&#39;)"><span class="hl_varref"><span class="mpre">responseBody</span></span></a><span class="mpre"> </span><a href="#loc_103_21_103_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_21_103_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hello&quot;</span></span><span class="mpre">
        </span><a href="#loc_100_13_100_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_17&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        </span><a href="#loc_100_13_100_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_13_100_17&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span></div></body></html>