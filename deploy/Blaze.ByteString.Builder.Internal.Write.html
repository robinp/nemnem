<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, BangPatterns #-}

#ifdef USE_MONO_PAT_BINDS
{-# LANGUAGE MonoPatBinds #-}
#endif
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Blaze.ByteString.Builder.Internal.Poke</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2010 Simon Meier</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) 2010 Jasper van der Jeugt</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Simon Meier &lt;iridcode@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : tested on GHC only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A general and efficient write type that allows for the easy construction of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- builders for (smallish) bounded size writes to a buffer.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- FIXME: Improve documentation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Blaze.ByteString.Builder.Internal.Write (
  </span><span class="hl_comment"><span class="mpre">-- * Poking a buffer</span></span><span class="mpre">
    Poke
  , runPoke
  , pokeN

  </span><span class="hl_comment"><span class="mpre">-- * Writing to abuffer</span></span><span class="mpre">
  , Write
  , runWrite
  , getBound
  , getBound&#39;
  , getPoke

  , exactWrite
  , boundedWrite
  , writeLiftIO
  , writeIf
  , writeEq
  , writeOrdering
  , writeOrd

  </span><span class="hl_comment"><span class="mpre">-- * Constructing builders from writes</span></span><span class="mpre">
  , fromWrite
  , fromWriteSingleton
  , fromWriteList

  </span><span class="hl_comment"><span class="mpre">-- * Writing &#39;Storable&#39;s</span></span><span class="mpre">
  , writeStorable
  , fromStorable
  , fromStorables

  ) where

import Foreign

import Data.Monoid

import Control.Monad

import Blaze.ByteString.Builder.Internal.Types


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Poking a buffer and writing to a buffer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Sadly GHC is not smart enough: code where we branch and each branch should</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- execute a few IO actions and then return a value cannot be taught to GHC. At</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- least not such that it returns the value of the branches unpacked.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Hmm.. at least he behaves much better for the Monoid instance of Write</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- than the one for Poke. Serializing UTF-8 chars gets a slowdown of a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- factor 2 when 2 chars are composed. Perhaps I should try out the writeList</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instances also, as they may be more sensitive to to much work per Char.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Changing a sequence of bytes starting from the given pointer. &#39;Poke&#39;s are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the most primitive buffer manipulation. In most cases, you don&#39;t use the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- explicitely but as part of a &#39;Write&#39;, which also tells how many bytes will</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- be changed at most.</span></span><span class="mpre">
newtype </span><a name="loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_tycondecl"><span class="mpre">Poke</span></span></a><span class="mpre"> =
    </span><a name="loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_condecl"><span class="mpre">Poke</span></span></a><span class="mpre"> { </span><a name="loc_82_12_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_19&#39;)"><span class="hl_fielddecl"><span class="mpre">runPoke</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) }

</span><span class="hl_comment"><span class="mpre">-- | A write of a bounded number of bytes.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When defining a function @write :: a -&gt; Write@ for some @a@, then it is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- important to ensure that the bound on the number of bytes written is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data-independent. Formally,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  @ forall x y. getBound (write x) = getBound (write y) @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The idea is that this data-independent bound is specified such that the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- compiler can optimize the check, if there are enough free bytes in the buffer,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to a single subtraction between the pointer to the next free byte and the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- pointer to the end of the buffer with this constant bound of the maximal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- number of bytes to be written.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Write</span></span></a><span class="mpre"> = </span><a name="loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_condecl"><span class="mpre">Write</span></span></a><span class="mpre"> {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><a href="#loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_tyconref"><span class="mpre">Poke</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Extract the &#39;Poke&#39; action of a write.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="mpre">getPoke</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="mpre">getPoke</span></a><span class="mpre"> :: </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_tyconref"><span class="mpre">Poke</span></span></a><span class="mpre">
</span><a name="loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="hl_fundecl"><span class="mpre">getPoke</span></span></a><span class="mpre"> (</span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> _ </span><a name="loc_103_18_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_18_103_21&#39;)"><span class="hl_vardecl"><span class="mpre">wio</span></span></a><span class="mpre">) = </span><a href="#loc_103_18_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_18_103_21&#39;)"><span class="hl_varref"><span class="mpre">wio</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Run the &#39;Poke&#39; action of a write.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_9&#39;)"><span class="mpre">runWrite</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_9&#39;)"><span class="mpre">runWrite</span></a><span class="mpre"> :: </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
</span><a name="loc_108_1_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_9&#39;)"><span class="hl_vardecl"><span class="mpre">runWrite</span></span></a><span class="mpre"> = </span><a href="#loc_82_12_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_19&#39;)"><span class="hl_varref"><span class="mpre">runPoke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">getPoke</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Extract the maximal number of bytes that this write could write.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="mpre">getBound</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="mpre">getBound</span></a><span class="mpre"> :: </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="hl_fundecl"><span class="mpre">getBound</span></span></a><span class="mpre"> (</span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> </span><a name="loc_113_17_113_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_22&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre"> _) = </span><a href="#loc_113_17_113_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_22&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Extract the maximal number of bytes that this write could write in any</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- case. Assumes that the bound of the write is data-independent.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="mpre">getBound&#39;</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="mpre">getBound&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ Name of caller: for debugging purposes.</span></span><span class="mpre">
          -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">)
          -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_fundecl"><span class="mpre">getBound&#39;</span></span></a><span class="mpre"> </span><a name="loc_121_11_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_14&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a name="loc_121_15_121_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_15_121_20&#39;)"><span class="hl_vardecl"><span class="mpre">write</span></span></a><span class="mpre"> =
    </span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="hl_varref"><span class="mpre">getBound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_121_15_121_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_15_121_20&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_string"><span class="mpre">&quot;getBound&#39; called from &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_121_11_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_14&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: write bound is not data-independent.&quot;</span></span><span class="mpre">

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_tyconref"><span class="mpre">Poke</span></span></a><span class="mpre"> where
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_conref"><span class="mpre">Poke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  (</span><a href="#loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_conref"><span class="mpre">Poke</span></span></a><span class="mpre"> </span><a name="loc_130_9_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_12&#39;)"><span class="hl_vardecl"><span class="mpre">po1</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">`mappend`</span></span></a><span class="mpre"> (</span><a href="#loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_conref"><span class="mpre">Poke</span></span></a><span class="mpre"> </span><a name="loc_130_30_130_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_30_130_33&#39;)"><span class="hl_vardecl"><span class="mpre">po2</span></span></a><span class="mpre">) = </span><a href="#loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_conref"><span class="mpre">Poke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_130_9_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_12&#39;)"><span class="hl_varref"><span class="mpre">po1</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_180_3_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_180_3_180_6&#39;)"><span class="hl_infix"><span class="mpre">&gt;=&gt;</span></span></a><span class="mpre"> </span><a href="#loc_130_30_130_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_30_130_33&#39;)"><span class="hl_varref"><span class="mpre">po2</span></span></a><span class="mpre">

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="mpre">mconcat</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_vardecl"><span class="mpre">mconcat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_varref"><span class="mpre">mappend</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre"> where
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  (</span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> </span><a name="loc_140_10_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_10_140_16&#39;)"><span class="hl_vardecl"><span class="mpre">bound1</span></span></a><span class="mpre"> </span><a name="loc_140_17_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_19&#39;)"><span class="hl_vardecl"><span class="mpre">w1</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">`mappend`</span></span></a><span class="mpre"> (</span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> </span><a name="loc_140_38_140_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_38_140_44&#39;)"><span class="hl_vardecl"><span class="mpre">bound2</span></span></a><span class="mpre"> </span><a name="loc_140_45_140_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_45_140_47&#39;)"><span class="hl_vardecl"><span class="mpre">w2</span></span></a><span class="mpre">) =
    </span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> (</span><a href="#loc_140_10_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_10_140_16&#39;)"><span class="hl_varref"><span class="mpre">bound1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_140_38_140_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_38_140_44&#39;)"><span class="hl_varref"><span class="mpre">bound2</span></span></a><span class="mpre">) (</span><a href="#loc_140_17_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_19&#39;)"><span class="hl_varref"><span class="mpre">w1</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_140_45_140_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_45_140_47&#39;)"><span class="hl_varref"><span class="mpre">w2</span></span></a><span class="mpre">)

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="mpre">mconcat</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_vardecl"><span class="mpre">mconcat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_varref"><span class="mpre">mappend</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @pokeN size io@ creates a write that denotes the writing of @size@ bytes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to a buffer using the IO action @io@. Note that @io@ MUST write EXACTLY @size@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bytes to the buffer!</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_153_1_153_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_6&#39;)"><span class="mpre">pokeN</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_153_1_153_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_6&#39;)"><span class="mpre">pokeN</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
       -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><a href="#loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_tyconref"><span class="mpre">Poke</span></span></a><span class="mpre">
</span><a name="loc_153_1_153_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_6&#39;)"><span class="hl_fundecl"><span class="mpre">pokeN</span></span></a><span class="mpre"> </span><a name="loc_153_7_153_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_7_153_11&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_153_12_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_12_153_14&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> = </span><a href="#loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_conref"><span class="mpre">Poke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_153_25_153_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_25_153_27&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_153_12_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_12_153_14&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre"> </span><a href="#loc_153_25_153_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_25_153_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_153_25_153_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_25_153_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_153_7_153_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_7_153_11&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | @exactWrite size io@ creates a bounded write that can later be converted to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a builder that writes exactly @size@ bytes. Note that @io@ MUST write</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- EXACTLY @size@ bytes to the buffer!</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_163_1_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_11&#39;)"><span class="mpre">exactWrite</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_163_1_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_11&#39;)"><span class="mpre">exactWrite</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
           -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
           -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">
</span><a name="loc_163_1_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_11&#39;)"><span class="hl_fundecl"><span class="mpre">exactWrite</span></span></a><span class="mpre"> </span><a name="loc_163_12_163_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_12_163_16&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_163_17_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_17_163_19&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> = </span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> </span><a href="#loc_163_12_163_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_12_163_16&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> (</span><a href="#loc_153_1_153_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_6&#39;)"><span class="hl_varref"><span class="mpre">pokeN</span></span></a><span class="mpre"> </span><a href="#loc_163_12_163_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_12_163_16&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_163_17_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_17_163_19&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @boundedWrite size write@ creates a bounded write from a @write@ that does</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- not write more than @size@ bytes.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_169_1_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_13&#39;)"><span class="mpre">boundedWrite</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_169_1_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_13&#39;)"><span class="mpre">boundedWrite</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_tyconref"><span class="mpre">Poke</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">
</span><a name="loc_169_1_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_13&#39;)"><span class="hl_vardecl"><span class="mpre">boundedWrite</span></span></a><span class="mpre"> = </span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @writeLiftIO io write@ creates a write executes the @io@ action to compute</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the value that is then written.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="mpre">writeLiftIO</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="mpre">writeLiftIO</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">
</span><a name="loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="hl_fundecl"><span class="mpre">writeLiftIO</span></span></a><span class="mpre"> </span><a name="loc_175_13_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_18&#39;)"><span class="hl_vardecl"><span class="mpre">write</span></span></a><span class="mpre"> </span><a name="loc_175_19_175_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_19_175_21&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> =
    </span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> (</span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">getBound&#39;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;writeLiftIO&quot;</span></span><span class="mpre"> </span><a href="#loc_175_13_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_18&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre">)
          (</span><a href="#loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_conref"><span class="mpre">Poke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_177_20_177_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_20_177_22&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre"> -&gt; do </span><a name="loc_177_29_177_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_29_177_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_175_19_175_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_19_175_21&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre">; </span><a href="#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_9&#39;)"><span class="hl_varref"><span class="mpre">runWrite</span></span></a><span class="mpre"> (</span><a href="#loc_175_13_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_18&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_177_29_177_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_29_177_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_177_20_177_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_20_177_22&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @writeIf p wTrue wFalse x@ creates a &#39;Write&#39; with a &#39;Poke&#39; equal to @wTrue</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- x@, if @p x@ and equal to @wFalse x@ otherwise. The bound of this new</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Write&#39; is the maximum of the bounds for either &#39;Write&#39;. This yields a data</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- independent bound, if the bound for @wTrue@ and @wFalse@ is already data</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- independent.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_186_1_186_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_8&#39;)"><span class="mpre">writeIf</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_186_1_186_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_8&#39;)"><span class="mpre">writeIf</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">)
</span><a name="loc_186_1_186_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_8&#39;)"><span class="hl_fundecl"><span class="mpre">writeIf</span></span></a><span class="mpre"> </span><a name="loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_186_11_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_11_186_16&#39;)"><span class="hl_vardecl"><span class="mpre">wTrue</span></span></a><span class="mpre"> </span><a name="loc_186_17_186_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_17_186_23&#39;)"><span class="hl_vardecl"><span class="mpre">wFalse</span></span></a><span class="mpre"> </span><a name="loc_186_24_186_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_24_186_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
    </span><a href="#loc_169_1_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_13&#39;)"><span class="hl_varref"><span class="mpre">boundedWrite</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="hl_varref"><span class="mpre">getBound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_186_11_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_11_186_16&#39;)"><span class="hl_varref"><span class="mpre">wTrue</span></span></a><span class="mpre"> </span><a href="#loc_186_24_186_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_24_186_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="hl_varref"><span class="mpre">getBound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_186_17_186_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_17_186_23&#39;)"><span class="hl_varref"><span class="mpre">wFalse</span></span></a><span class="mpre"> </span><a href="#loc_186_24_186_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_24_186_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))
                 (if </span><a href="#loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_186_24_186_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_24_186_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><a href="#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">getPoke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_186_11_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_11_186_16&#39;)"><span class="hl_varref"><span class="mpre">wTrue</span></span></a><span class="mpre"> </span><a href="#loc_186_24_186_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_24_186_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> else </span><a href="#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">getPoke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_186_17_186_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_17_186_23&#39;)"><span class="hl_varref"><span class="mpre">wFalse</span></span></a><span class="mpre"> </span><a href="#loc_186_24_186_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_24_186_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Compare the value to a test value and use the first write action for the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- equal case and the second write action for the non-equal case.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="mpre">writeEq</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="mpre">writeEq</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 193, srcSpanStartColumn = 12, srcSpanEndLine = 193, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 193, srcSpanStartColumn = 17, srcSpanEndLine = 193, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpa"><span class="mpre">Eq a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">)
</span><a name="loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_fundecl"><span class="mpre">writeEq</span></span></a><span class="mpre"> </span><a name="loc_194_9_194_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_13&#39;)"><span class="hl_vardecl"><span class="mpre">test</span></span></a><span class="mpre"> = </span><a href="#loc_186_1_186_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_8&#39;)"><span class="hl_varref"><span class="mpre">writeIf</span></span></a><span class="mpre"> (</span><a href="#loc_194_9_194_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_13&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | TODO: Test this. It might well be too difficult to use.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   FIXME: Better name required!</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_202_1_202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_14&#39;)"><span class="mpre">writeOrdering</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_202_1_202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_14&#39;)"><span class="mpre">writeOrdering</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ordering</span></span><span class="mpre">)
              -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">)
              -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">)
</span><a name="loc_202_1_202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_14&#39;)"><span class="hl_fundecl"><span class="mpre">writeOrdering</span></span></a><span class="mpre"> </span><a name="loc_202_15_202_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_15_202_18&#39;)"><span class="hl_vardecl"><span class="mpre">ord</span></span></a><span class="mpre"> </span><a name="loc_202_19_202_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_19_202_22&#39;)"><span class="hl_vardecl"><span class="mpre">wLT</span></span></a><span class="mpre"> </span><a name="loc_202_23_202_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_23_202_26&#39;)"><span class="hl_vardecl"><span class="mpre">wEQ</span></span></a><span class="mpre"> </span><a name="loc_202_27_202_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_27_202_30&#39;)"><span class="hl_vardecl"><span class="mpre">wGT</span></span></a><span class="mpre"> </span><a name="loc_202_31_202_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_31_202_32&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
    </span><a href="#loc_169_1_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_13&#39;)"><span class="hl_varref"><span class="mpre">boundedWrite</span></span></a><span class="mpre"> </span><a href="#loc_207_5_207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_10&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> (case </span><a href="#loc_202_15_202_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_15_202_18&#39;)"><span class="hl_varref"><span class="mpre">ord</span></span></a><span class="mpre"> </span><a href="#loc_202_31_202_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_31_202_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><a href="#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">getPoke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_202_19_202_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_19_202_22&#39;)"><span class="hl_varref"><span class="mpre">wLT</span></span></a><span class="mpre"> </span><a href="#loc_202_31_202_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_31_202_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">;
                                      </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><a href="#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">getPoke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_202_23_202_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_23_202_26&#39;)"><span class="hl_varref"><span class="mpre">wEQ</span></span></a><span class="mpre"> </span><a href="#loc_202_31_202_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_31_202_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">;
                                      </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">getPoke</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_202_27_202_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_27_202_30&#39;)"><span class="hl_varref"><span class="mpre">wGT</span></span></a><span class="mpre"> </span><a href="#loc_202_31_202_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_31_202_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
  where
    </span><a name="loc_207_5_207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_10&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="hl_varref"><span class="mpre">getBound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_202_19_202_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_19_202_22&#39;)"><span class="hl_varref"><span class="mpre">wLT</span></span></a><span class="mpre"> </span><a href="#loc_202_31_202_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_31_202_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="hl_varref"><span class="mpre">getBound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_202_23_202_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_23_202_26&#39;)"><span class="hl_varref"><span class="mpre">wEQ</span></span></a><span class="mpre"> </span><a href="#loc_202_31_202_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_31_202_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="hl_varref"><span class="mpre">getBound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_202_27_202_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_27_202_30&#39;)"><span class="hl_varref"><span class="mpre">wGT</span></span></a><span class="mpre"> </span><a href="#loc_202_31_202_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_31_202_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | A write combinator useful to build decision trees for deciding what value</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to write with a constant bound on the maximal number of bytes written.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="mpre">writeOrd</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="mpre">writeOrd</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 212, srcSpanStartColumn = 13, srcSpanEndLine = 213, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 213, srcSpanStartColumn = 8, srcSpanEndLine = 213, srcSpanEndColumn = 10}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan"><span class="mpre">Ord a
       =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
       -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">)
       -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">)
</span><a name="loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="hl_fundecl"><span class="mpre">writeOrd</span></span></a><span class="mpre"> </span><a name="loc_216_10_216_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_14&#39;)"><span class="hl_vardecl"><span class="mpre">test</span></span></a><span class="mpre"> = </span><a href="#loc_202_1_202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_14&#39;)"><span class="hl_varref"><span class="mpre">writeOrdering</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`compare`</span></span><span class="mpre"> </span><a href="#loc_216_10_216_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_14&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Create a builder that execute a single &#39;Write&#39;.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_221_1_221_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_10&#39;)"><span class="mpre">fromWrite</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_221_1_221_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_10&#39;)"><span class="mpre">fromWrite</span></a><span class="mpre"> :: </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_221_1_221_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_10&#39;)"><span class="hl_fundecl"><span class="mpre">fromWrite</span></span></a><span class="mpre"> (</span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> </span><a name="loc_221_18_221_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_18_221_25&#39;)"><span class="hl_vardecl"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><a name="loc_221_26_221_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_26_221_29&#39;)"><span class="hl_vardecl"><span class="mpre">wio</span></span></a><span class="mpre">) =
    </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18&#39;)"><span class="hl_varref"><span class="mpre">fromBuildStepCont</span></span></a><span class="mpre"> </span><a href="#loc_224_5_224_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre">
  where
    </span><a name="loc_224_5_224_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_9&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_224_10_224_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_10_224_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25&#39;)"><span class="hl_conref"><span class="mpre">BufRange</span></span></a><span class="mpre"> </span><a name="loc_224_22_224_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_22_224_24&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_224_25_224_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_25_224_28&#39;)"><span class="hl_vardecl"><span class="mpre">ope</span></span></a><span class="mpre">)
      | </span><a href="#loc_224_22_224_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_22_224_24&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_221_18_221_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_18_221_25&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_224_25_224_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_25_224_28&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre"> = do
          </span><a name="loc_226_11_226_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_11_226_14&#39;)"><span class="hl_vardecl"><span class="mpre">op&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_82_12_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_19&#39;)"><span class="hl_varref"><span class="mpre">runPoke</span></span></a><span class="mpre"> </span><a href="#loc_221_26_221_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_26_221_29&#39;)"><span class="hl_varref"><span class="mpre">wio</span></span></a><span class="mpre"> </span><a href="#loc_224_22_224_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_22_224_24&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
          let !</span><a name="loc_227_16_227_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_16_227_19&#39;)"><span class="hl_vardecl"><span class="mpre">br&#39;</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25&#39;)"><span class="hl_conref"><span class="mpre">BufRange</span></span></a><span class="mpre"> </span><a href="#loc_226_11_226_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_11_226_14&#39;)"><span class="hl_varref"><span class="mpre">op&#39;</span></span></a><span class="mpre"> </span><a href="#loc_224_25_224_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_25_224_28&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre">
          </span><a href="#loc_224_10_224_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_10_224_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_227_16_227_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_16_227_19&#39;)"><span class="hl_varref"><span class="mpre">br&#39;</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11&#39;)"><span class="hl_varref"><span class="mpre">bufferFull</span></span></a><span class="mpre"> </span><a href="#loc_221_18_221_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_18_221_25&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><a href="#loc_224_22_224_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_22_224_24&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> (</span><a href="#loc_224_5_224_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_224_10_224_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_10_224_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_233_1_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_19&#39;)"><span class="mpre">fromWriteSingleton</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_233_1_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_19&#39;)"><span class="mpre">fromWriteSingleton</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">)
</span><a name="loc_233_1_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_19&#39;)"><span class="hl_fundecl"><span class="mpre">fromWriteSingleton</span></span></a><span class="mpre"> </span><a name="loc_233_20_233_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_20_233_25&#39;)"><span class="hl_vardecl"><span class="mpre">write</span></span></a><span class="mpre"> =
    </span><a href="#loc_236_5_236_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_5_236_14&#39;)"><span class="hl_varref"><span class="mpre">mkBuilder</span></span></a><span class="mpre">
  where
    </span><a name="loc_236_5_236_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_5_236_14&#39;)"><span class="hl_fundecl"><span class="mpre">mkBuilder</span></span></a><span class="mpre"> </span><a name="loc_236_15_236_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_15_236_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18&#39;)"><span class="hl_varref"><span class="mpre">fromBuildStepCont</span></span></a><span class="mpre"> </span><a href="#loc_238_9_238_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_13&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre">
      where
        </span><a name="loc_238_9_238_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_13&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_238_14_238_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_14_238_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25&#39;)"><span class="hl_conref"><span class="mpre">BufRange</span></span></a><span class="mpre"> </span><a name="loc_238_26_238_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_28&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_238_29_238_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_29_238_32&#39;)"><span class="hl_vardecl"><span class="mpre">ope</span></span></a><span class="mpre">)
          | </span><a href="#loc_238_26_238_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_28&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_245_19_245_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_19_245_26&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_238_29_238_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_29_238_32&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre"> = do
              </span><a name="loc_240_15_240_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_15_240_18&#39;)"><span class="hl_vardecl"><span class="mpre">op&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_82_12_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_19&#39;)"><span class="hl_varref"><span class="mpre">runPoke</span></span></a><span class="mpre"> </span><a href="#loc_245_27_245_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_27_245_30&#39;)"><span class="hl_varref"><span class="mpre">wio</span></span></a><span class="mpre"> </span><a href="#loc_238_26_238_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_28&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
              let !</span><a name="loc_241_20_241_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_20_241_23&#39;)"><span class="hl_vardecl"><span class="mpre">br&#39;</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25&#39;)"><span class="hl_conref"><span class="mpre">BufRange</span></span></a><span class="mpre"> </span><a href="#loc_240_15_240_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_15_240_18&#39;)"><span class="hl_varref"><span class="mpre">op&#39;</span></span></a><span class="mpre"> </span><a href="#loc_238_29_238_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_29_238_32&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre">
              </span><a href="#loc_238_14_238_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_14_238_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_241_20_241_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_20_241_23&#39;)"><span class="hl_varref"><span class="mpre">br&#39;</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11&#39;)"><span class="hl_varref"><span class="mpre">bufferFull</span></span></a><span class="mpre"> </span><a href="#loc_245_19_245_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_19_245_26&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><a href="#loc_238_26_238_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_28&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> (</span><a href="#loc_238_9_238_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_13&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_238_14_238_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_14_238_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
          where
            </span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> </span><a name="loc_245_19_245_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_19_245_26&#39;)"><span class="hl_vardecl"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><a name="loc_245_27_245_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_27_245_30&#39;)"><span class="hl_vardecl"><span class="mpre">wio</span></span></a><span class="mpre"> = </span><a href="#loc_233_20_233_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_20_233_25&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_236_15_236_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_15_236_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Construct a &#39;Builder&#39; writing a list of data one element at a time.</span></span><span class="mpre">
</span><a href="#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="mpre">fromWriteList</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="hl_fundecl"><span class="mpre">fromWriteList</span></span></a><span class="mpre"> </span><a name="loc_249_15_249_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_20&#39;)"><span class="hl_vardecl"><span class="mpre">write</span></span></a><span class="mpre"> =
    </span><a href="#loc_252_5_252_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_5_252_16&#39;)"><span class="hl_varref"><span class="mpre">makeBuilder</span></span></a><span class="mpre">
  where
    </span><a name="loc_252_5_252_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_5_252_16&#39;)"><span class="hl_fundecl"><span class="mpre">makeBuilder</span></span></a><span class="mpre"> </span><a name="loc_252_17_252_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_17_252_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs0</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18&#39;)"><span class="hl_varref"><span class="mpre">fromBuildStepCont</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_254_9_254_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_13&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_252_17_252_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_17_252_20&#39;)"><span class="hl_varref"><span class="mpre">xs0</span></span></a><span class="mpre">
      where
        </span><a name="loc_254_9_254_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_13&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_254_14_254_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_14_254_17&#39;)"><span class="hl_vardecl"><span class="mpre">xs1</span></span></a><span class="mpre"> </span><a name="loc_254_18_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_18_254_19&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> !(</span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25&#39;)"><span class="hl_conref"><span class="mpre">BufRange</span></span></a><span class="mpre"> </span><a name="loc_254_31_254_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_31_254_34&#39;)"><span class="hl_vardecl"><span class="mpre">op0</span></span></a><span class="mpre"> </span><a name="loc_254_35_254_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_35_254_39&#39;)"><span class="hl_vardecl"><span class="mpre">ope0</span></span></a><span class="mpre">) = </span><a href="#loc_256_13_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_13_256_15&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_254_14_254_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_14_254_17&#39;)"><span class="hl_varref"><span class="mpre">xs1</span></span></a><span class="mpre"> </span><a href="#loc_254_31_254_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_31_254_34&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre">
          where
            </span><a name="loc_256_13_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_13_256_15&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] !</span><a name="loc_256_20_256_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_20_256_22&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> = do
               let !</span><a name="loc_257_21_257_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_21_257_24&#39;)"><span class="hl_vardecl"><span class="mpre">br&#39;</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_35_17_35_25&#39;)"><span class="hl_conref"><span class="mpre">BufRange</span></span></a><span class="mpre"> </span><a href="#loc_256_20_256_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_20_256_22&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_254_35_254_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_35_254_39&#39;)"><span class="hl_varref"><span class="mpre">ope0</span></span></a><span class="mpre">
               </span><a href="#loc_254_18_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_18_254_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_257_21_257_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_21_257_24&#39;)"><span class="hl_varref"><span class="mpre">br&#39;</span></span></a><span class="mpre">

            </span><a href="#loc_256_13_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_13_256_15&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_260_16_260_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_16_260_18&#39;)"><span class="hl_specname"><span class="mpre">xs</span></span></a><span class="mpre">@(</span><a name="loc_260_20_260_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_20_260_22&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_260_23_260_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_23_260_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs&#39;</span></span></a><span class="mpre">) !</span><a name="loc_260_29_260_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_29_260_31&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre">
              | </span><a href="#loc_260_29_260_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_29_260_31&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_266_23_266_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_23_266_30&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_254_35_254_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_35_254_39&#39;)"><span class="hl_varref"><span class="mpre">ope0</span></span></a><span class="mpre"> = do
                  !</span><a name="loc_262_20_262_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_20_262_23&#39;)"><span class="hl_vardecl"><span class="mpre">op&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_82_12_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_19&#39;)"><span class="hl_varref"><span class="mpre">runPoke</span></span></a><span class="mpre"> </span><a href="#loc_266_31_266_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_31_266_34&#39;)"><span class="hl_varref"><span class="mpre">wio</span></span></a><span class="mpre"> </span><a href="#loc_260_29_260_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_29_260_31&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                  </span><a href="#loc_256_13_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_13_256_15&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_260_23_260_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_23_260_26&#39;)"><span class="hl_varref"><span class="mpre">xs&#39;</span></span></a><span class="mpre"> </span><a href="#loc_262_20_262_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_20_262_23&#39;)"><span class="hl_varref"><span class="mpre">op&#39;</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11&#39;)"><span class="hl_varref"><span class="mpre">bufferFull</span></span></a><span class="mpre"> </span><a href="#loc_266_23_266_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_23_266_30&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><a href="#loc_260_29_260_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_29_260_31&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> (</span><a href="#loc_254_9_254_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_13&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_260_16_260_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_16_260_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_254_18_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_18_254_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
              where
                </span><a href="#loc_98_14_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_19&#39;)"><span class="hl_conref"><span class="mpre">Write</span></span></a><span class="mpre"> </span><a name="loc_266_23_266_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_23_266_30&#39;)"><span class="hl_vardecl"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><a name="loc_266_31_266_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_31_266_34&#39;)"><span class="hl_vardecl"><span class="mpre">wio</span></span></a><span class="mpre"> = </span><a href="#loc_249_15_249_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_20&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_260_20_260_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_20_260_22&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="mpre">fromWriteList</span></a><span class="mpre"> #-}</span></span><span class="mpre">



</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Writing storables</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Write a storable value.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_279_1_279_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_14&#39;)"><span class="mpre">writeStorable</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_279_1_279_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_14&#39;)"><span class="mpre">writeStorable</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 278, srcSpanStartColumn = 18, srcSpanEndLine = 278, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 278, srcSpanStartColumn = 29, srcSpanEndLine = 278, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpa"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">
</span><a name="loc_279_1_279_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_14&#39;)"><span class="hl_fundecl"><span class="mpre">writeStorable</span></span></a><span class="mpre"> </span><a name="loc_279_15_279_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_15_279_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_163_1_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_11&#39;)"><span class="hl_varref"><span class="mpre">exactWrite</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> </span><a href="#loc_279_15_279_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_15_279_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (\</span><a name="loc_279_43_279_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_43_279_45&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_279_43_279_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_43_279_45&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">) </span><a href="#loc_279_15_279_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_15_279_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | A builder that serializes a storable value. No alignment is done.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_284_1_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_1_284_13&#39;)"><span class="mpre">fromStorable</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_284_1_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_1_284_13&#39;)"><span class="mpre">fromStorable</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 283, srcSpanStartColumn = 17, srcSpanEndLine = 283, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 283, srcSpanStartColumn = 28, srcSpanEndLine = 283, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpa"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_284_1_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_1_284_13&#39;)"><span class="hl_vardecl"><span class="mpre">fromStorable</span></span></a><span class="mpre"> = </span><a href="#loc_233_1_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_19&#39;)"><span class="hl_varref"><span class="mpre">fromWriteSingleton</span></span></a><span class="mpre"> </span><a href="#loc_279_1_279_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_14&#39;)"><span class="hl_varref"><span class="mpre">writeStorable</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A builder that serializes a list of storable values by writing them</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- consecutively. No alignment is done. Parsing information needs to be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provided externally.</span></span><span class="mpre">
</span><a href="#loc_290_1_290_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_14&#39;)"><span class="mpre">fromStorables</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 289, srcSpanStartColumn = 18, srcSpanEndLine = 289, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Write.hs&quot;, srcSpanStartLine = 289, srcSpanStartColumn = 29, srcSpanEndLine = 289, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpa"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_290_1_290_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_14&#39;)"><span class="hl_vardecl"><span class="mpre">fromStorables</span></span></a><span class="mpre"> = </span><a href="#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="hl_varref"><span class="mpre">fromWriteList</span></span></a><span class="mpre"> </span><a href="#loc_279_1_279_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_14&#39;)"><span class="hl_varref"><span class="mpre">writeStorable</span></span></a><span class="mpre">
</span></div></body></html>