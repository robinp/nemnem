<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Network.Wai.Handler.Warp.MultiMap (
    MMap
  , Some(..)
  , empty
  , singleton
  , insert
  , search
  , searchWith
  , isEmpty
  , valid
  , pruneWith
  , fromList
  , toList
  , fromSortedList
  , toSortedList
  , merge
  ) where

import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)
import Data.List (</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | One ore more list to implement multimap.</span></span><span class="mpre">
data </span><a name="loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_condecl"><span class="mpre">One</span></span></a><span class="mpre"> !</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
            | </span><a name="loc_26_15_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_18&#39;)"><span class="hl_condecl"><span class="mpre">Tom</span></span></a><span class="mpre"> !</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> !(</span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- Two or more</span></span><span class="mpre">
            </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 13, srcSpanEndLine = 27, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 13, srcSpanEndLine = 27, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/"><span class="mpre">deriving (Eq,Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- This is slow but assuming rarely used.</span></span><span class="mpre">
</span><a href="#loc_31_1_31_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_5&#39;)"><span class="mpre">snoc</span></a><span class="mpre"> :: </span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_31_1_31_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_5&#39;)"><span class="hl_fundecl"><span class="mpre">snoc</span></span></a><span class="mpre"> (</span><a href="#loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a name="loc_31_11_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_11_31_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) </span><a name="loc_31_14_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_14_31_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">    = </span><a href="#loc_26_15_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_18&#39;)"><span class="hl_conref"><span class="mpre">Tom</span></span></a><span class="mpre"> </span><a href="#loc_31_11_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_11_31_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a href="#loc_31_14_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_14_31_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span><a href="#loc_31_1_31_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_5&#39;)"><span class="hl_fundecl"><span class="mpre">snoc</span></span></a><span class="mpre"> (</span><a href="#loc_26_15_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_18&#39;)"><span class="hl_conref"><span class="mpre">Tom</span></span></a><span class="mpre"> </span><a name="loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_32_13_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_13_32_15&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_32_17_32_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_17_32_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_26_15_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_18&#39;)"><span class="hl_conref"><span class="mpre">Tom</span></span></a><span class="mpre"> </span><a href="#loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_31_1_31_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_5&#39;)"><span class="hl_varref"><span class="mpre">snoc</span></span></a><span class="mpre"> </span><a href="#loc_32_13_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_13_32_15&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_32_17_32_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_17_32_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><a href="#loc_35_1_35_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_4&#39;)"><span class="mpre">top</span></a><span class="mpre"> :: </span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_35_1_35_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_4&#39;)"><span class="hl_fundecl"><span class="mpre">top</span></span></a><span class="mpre"> (</span><a href="#loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a name="loc_35_10_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_10_35_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)   = </span><a href="#loc_35_10_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_10_35_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_35_1_35_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_4&#39;)"><span class="hl_fundecl"><span class="mpre">top</span></span></a><span class="mpre"> (</span><a href="#loc_26_15_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_18&#39;)"><span class="hl_conref"><span class="mpre">Tom</span></span></a><span class="mpre"> </span><a name="loc_36_10_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> _) = </span><a href="#loc_36_10_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Red black tree as multimap.</span></span><span class="mpre">
data </span><a name="loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tycondecl"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> = </span><a name="loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_condecl"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- color is Black</span></span><span class="mpre">
              | </span><a name="loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_condecl"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_6_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_11&#39;)"><span class="hl_tyconref"><span class="mpre">Color</span></span></a><span class="mpre"> !(</span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) !</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> !(</span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) !(</span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)
              </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 15, srcSpanEndLine = 43, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 15, srcSpanEndLine = 43, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/"><span class="mpre">deriving (Show)</span></span><span class="mpre">

data </span><a name="loc_45_6_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Color</span></span></a><span class="mpre"> = </span><a name="loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_condecl"><span class="mpre">B</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Black</span></span><span class="mpre">
           | </span><a name="loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_condecl"><span class="mpre">R</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Red</span></span><span class="mpre">
           </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 12, srcSpanEndLine = 47, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 12, srcSpanEndLine = 47, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/"><span class="mpre">deriving (Eq, Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 10, srcSpanEndLine = 51, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 10, srcSpanEndLine = 51, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/H"><span class="mpre">(Eq k, Eq v) =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre"> (</span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) where
    </span><a name="loc_52_5_52_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_5_52_7&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">==</span></span><span class="mpre"> </span><a name="loc_52_11_52_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_13&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre"> = </span><a href="#loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="hl_varref"><span class="mpre">toSortedList</span></span></a><span class="mpre"> </span><a href="#loc_52_5_52_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_5_52_7&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="hl_varref"><span class="mpre">toSortedList</span></span></a><span class="mpre"> </span><a href="#loc_52_11_52_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_13&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(log N)</span></span><span class="mpre">
</span><a href="#loc_58_1_58_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_7&#39;)"><span class="mpre">search</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 11, srcSpanEndLine = 57, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 17, srcSpanEndLine = 57, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_58_1_58_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_7&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> _ </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_58_1_58_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_7&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> </span><a name="loc_59_8_59_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_8_59_10&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> _ </span><a name="loc_59_19_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_20&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_59_23_59_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_23_59_24&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_59_25_59_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_25_59_26&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_59_8_59_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_8_59_10&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><a href="#loc_58_1_58_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><a href="#loc_59_8_59_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_8_59_10&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_59_19_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_20&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_58_1_58_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><a href="#loc_59_8_59_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_8_59_10&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_59_25_59_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_25_59_26&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_35_1_35_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_4&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre"> </span><a href="#loc_59_23_59_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_23_59_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(log N)</span></span><span class="mpre">
</span><a href="#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="mpre">searchWith</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 15, srcSpanEndLine = 65, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 21, srcSpanEndLine = 65, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; (</span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">searchWith</span></span></a><span class="mpre"> _ _ </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">searchWith</span></span></a><span class="mpre"> </span><a name="loc_67_12_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_12_67_14&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a name="loc_67_15_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> _ </span><a name="loc_67_25_67_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_25_67_26&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_67_27_67_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_27_67_28&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_67_29_67_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_29_67_30&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_67_31_67_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_31_67_32&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_67_12_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_12_67_14&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_67_27_67_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_27_67_28&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><a href="#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">searchWith</span></span></a><span class="mpre"> </span><a href="#loc_67_12_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_12_67_14&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_67_15_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_67_25_67_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_25_67_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">searchWith</span></span></a><span class="mpre"> </span><a href="#loc_67_12_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_12_67_14&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_67_15_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_67_31_67_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_31_67_32&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><a href="#loc_67_15_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_67_29_67_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_29_67_30&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(1)</span></span><span class="mpre">
</span><a href="#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_8&#39;)"><span class="mpre">isEmpty</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 12, srcSpanEndLine = 75, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 12, srcSpanEndLine = 75, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/H"><span class="mpre">(Eq k, Eq v) =&gt;</span></span><span class="mpre"> </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_76_1_76_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_8&#39;)"><span class="hl_fundecl"><span class="mpre">isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_8&#39;)"><span class="hl_fundecl"><span class="mpre">isEmpty</span></span></a><span class="mpre"> _    = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(1)</span></span><span class="mpre">
</span><a href="#loc_81_1_81_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_6&#39;)"><span class="mpre">empty</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_81_1_81_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_6&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(1)</span></span><span class="mpre">
</span><a href="#loc_87_1_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_10&#39;)"><span class="mpre">singleton</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 14, srcSpanEndLine = 86, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 20, srcSpanEndLine = 86, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_87_1_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_10&#39;)"><span class="hl_fundecl"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><a name="loc_87_11_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_87_13_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a href="#loc_87_11_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a href="#loc_87_13_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(log N)</span></span><span class="mpre">
</span><a href="#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="mpre">insert</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 11, srcSpanEndLine = 92, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 17, srcSpanEndLine = 92, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="hl_fundecl"><span class="mpre">insert</span></span></a><span class="mpre"> </span><a name="loc_93_8_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_8_93_10&#39;)"><span class="hl_vardecl"><span class="mpre">kx</span></span></a><span class="mpre"> </span><a name="loc_93_11_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_11_93_13&#39;)"><span class="hl_vardecl"><span class="mpre">kv</span></span></a><span class="mpre"> </span><a name="loc_93_14_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_14_93_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_121_1_121_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_6&#39;)"><span class="hl_varref"><span class="mpre">turnB</span></span></a><span class="mpre"> (</span><a href="#loc_96_1_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_8&#39;)"><span class="hl_varref"><span class="mpre">insert&#39;</span></span></a><span class="mpre"> </span><a href="#loc_93_8_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_8_93_10&#39;)"><span class="hl_varref"><span class="mpre">kx</span></span></a><span class="mpre"> </span><a href="#loc_93_11_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_11_93_13&#39;)"><span class="hl_varref"><span class="mpre">kv</span></span></a><span class="mpre"> </span><a href="#loc_93_14_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_14_93_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)

</span><a href="#loc_96_1_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_8&#39;)"><span class="mpre">insert&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 12, srcSpanEndLine = 95, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 18, srcSpanEndLine = 95, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_96_1_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_8&#39;)"><span class="hl_fundecl"><span class="mpre">insert&#39;</span></span></a><span class="mpre"> </span><a name="loc_96_9_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_11&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a name="loc_96_12_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_12_96_14&#39;)"><span class="hl_vardecl"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> = </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a href="#loc_96_9_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_11&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> (</span><a href="#loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a href="#loc_96_12_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_12_96_14&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre">) </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre">
</span><a href="#loc_96_1_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_8&#39;)"><span class="hl_fundecl"><span class="mpre">insert&#39;</span></span></a><span class="mpre"> </span><a name="loc_97_9_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_11&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a name="loc_97_12_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_14&#39;)"><span class="hl_vardecl"><span class="mpre">xv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a name="loc_97_23_97_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_97_25_97_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_25_97_26&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_97_27_97_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_27_97_28&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_97_29_97_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_29_97_30&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_97_9_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_11&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_97_25_97_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_25_97_26&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><a href="#loc_107_1_107_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_10&#39;)"><span class="hl_varref"><span class="mpre">balanceL&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_96_1_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_8&#39;)"><span class="hl_varref"><span class="mpre">insert&#39;</span></span></a><span class="mpre"> </span><a href="#loc_97_9_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_11&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_97_12_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_14&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_97_23_97_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_97_25_97_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_25_97_26&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_97_27_97_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_27_97_28&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_97_29_97_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_29_97_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_114_1_114_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_10&#39;)"><span class="hl_varref"><span class="mpre">balanceR&#39;</span></span></a><span class="mpre"> </span><a href="#loc_97_23_97_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_97_25_97_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_25_97_26&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_97_27_97_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_27_97_28&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><a href="#loc_96_1_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_8&#39;)"><span class="hl_varref"><span class="mpre">insert&#39;</span></span></a><span class="mpre"> </span><a href="#loc_97_9_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_11&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_97_12_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_14&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_97_29_97_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_29_97_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
    </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_97_23_97_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_97_25_97_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_25_97_26&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_31_1_31_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_5&#39;)"><span class="hl_varref"><span class="mpre">snoc</span></span></a><span class="mpre"> </span><a href="#loc_97_27_97_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_27_97_28&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_97_12_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_14&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre">) </span><a href="#loc_97_29_97_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_29_97_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_96_1_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_8&#39;)"><span class="hl_fundecl"><span class="mpre">insert&#39;</span></span></a><span class="mpre"> </span><a name="loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a name="loc_101_12_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_14&#39;)"><span class="hl_vardecl"><span class="mpre">xv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_101_23_101_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_23_101_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_101_25_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_25_101_26&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_101_27_101_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_28&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_101_29_101_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_29_101_30&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_101_25_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_25_101_26&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_96_1_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_8&#39;)"><span class="hl_varref"><span class="mpre">insert&#39;</span></span></a><span class="mpre"> </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_101_12_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_14&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_101_23_101_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_23_101_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_101_25_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_25_101_26&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_101_27_101_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_28&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_101_29_101_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_29_101_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a href="#loc_101_23_101_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_23_101_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_101_25_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_25_101_26&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_101_27_101_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_28&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><a href="#loc_96_1_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_8&#39;)"><span class="hl_varref"><span class="mpre">insert&#39;</span></span></a><span class="mpre"> </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_101_12_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_14&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_101_29_101_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_29_101_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
    </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a href="#loc_101_23_101_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_23_101_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_101_25_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_25_101_26&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_31_1_31_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_5&#39;)"><span class="hl_varref"><span class="mpre">snoc</span></span></a><span class="mpre"> </span><a href="#loc_101_27_101_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_28&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_101_12_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_14&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre">) </span><a href="#loc_101_29_101_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_29_101_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_107_1_107_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_10&#39;)"><span class="mpre">balanceL&#39;</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_107_1_107_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_10&#39;)"><span class="hl_fundecl"><span class="mpre">balanceL&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_107_27_107_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_27_107_28&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_107_29_107_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_29_107_31&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a name="loc_107_32_107_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_32_107_34&#39;)"><span class="hl_vardecl"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a name="loc_107_35_107_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_35_107_36&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) </span><a name="loc_107_38_107_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_38_107_40&#39;)"><span class="hl_vardecl"><span class="mpre">yk</span></span></a><span class="mpre"> </span><a name="loc_107_41_107_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_41_107_43&#39;)"><span class="hl_vardecl"><span class="mpre">yv</span></span></a><span class="mpre"> </span><a name="loc_107_44_107_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_44_107_45&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><a name="loc_107_47_107_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_47_107_49&#39;)"><span class="hl_vardecl"><span class="mpre">zk</span></span></a><span class="mpre"> </span><a name="loc_107_50_107_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_50_107_52&#39;)"><span class="hl_vardecl"><span class="mpre">zv</span></span></a><span class="mpre"> </span><a name="loc_107_53_107_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_53_107_54&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> =
    </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_107_27_107_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_27_107_28&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_107_29_107_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_29_107_31&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_107_32_107_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_32_107_34&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_107_35_107_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_35_107_36&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="#loc_107_38_107_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_38_107_40&#39;)"><span class="hl_varref"><span class="mpre">yk</span></span></a><span class="mpre"> </span><a href="#loc_107_41_107_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_41_107_43&#39;)"><span class="hl_varref"><span class="mpre">yv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_107_44_107_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_44_107_45&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_107_47_107_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_47_107_49&#39;)"><span class="hl_varref"><span class="mpre">zk</span></span></a><span class="mpre"> </span><a href="#loc_107_50_107_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_50_107_52&#39;)"><span class="hl_varref"><span class="mpre">zv</span></span></a><span class="mpre"> </span><a href="#loc_107_53_107_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_53_107_54&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
</span><a href="#loc_107_1_107_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_10&#39;)"><span class="hl_fundecl"><span class="mpre">balanceL&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_109_19_109_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_19_109_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_109_21_109_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_21_109_23&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a name="loc_109_24_109_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_24_109_26&#39;)"><span class="hl_vardecl"><span class="mpre">xv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_109_35_109_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_35_109_36&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_109_37_109_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_37_109_39&#39;)"><span class="hl_vardecl"><span class="mpre">yk</span></span></a><span class="mpre"> </span><a name="loc_109_40_109_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_40_109_42&#39;)"><span class="hl_vardecl"><span class="mpre">yv</span></span></a><span class="mpre"> </span><a name="loc_109_43_109_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_43_109_44&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">)) </span><a name="loc_109_47_109_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_47_109_49&#39;)"><span class="hl_vardecl"><span class="mpre">zk</span></span></a><span class="mpre"> </span><a name="loc_109_50_109_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_50_109_52&#39;)"><span class="hl_vardecl"><span class="mpre">zv</span></span></a><span class="mpre"> </span><a name="loc_109_53_109_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_53_109_54&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> =
    </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_109_19_109_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_19_109_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_109_21_109_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_21_109_23&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_109_24_109_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_24_109_26&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_109_35_109_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_35_109_36&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="#loc_109_37_109_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_37_109_39&#39;)"><span class="hl_varref"><span class="mpre">yk</span></span></a><span class="mpre"> </span><a href="#loc_109_40_109_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_40_109_42&#39;)"><span class="hl_varref"><span class="mpre">yv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_109_43_109_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_43_109_44&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_109_47_109_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_47_109_49&#39;)"><span class="hl_varref"><span class="mpre">zk</span></span></a><span class="mpre"> </span><a href="#loc_109_50_109_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_50_109_52&#39;)"><span class="hl_varref"><span class="mpre">zv</span></span></a><span class="mpre"> </span><a href="#loc_109_53_109_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_53_109_54&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
</span><a href="#loc_107_1_107_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_10&#39;)"><span class="hl_fundecl"><span class="mpre">balanceL&#39;</span></span></a><span class="mpre"> </span><a name="loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_111_13_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_13_111_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_111_15_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_111_17_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_17_111_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_111_13_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_13_111_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_111_15_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_111_17_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_17_111_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_114_1_114_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_10&#39;)"><span class="mpre">balanceR&#39;</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_114_1_114_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_10&#39;)"><span class="hl_fundecl"><span class="mpre">balanceR&#39;</span></span></a><span class="mpre"> </span><a name="loc_114_11_114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_11_114_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_114_13_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_13_114_15&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a name="loc_114_16_114_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_16_114_18&#39;)"><span class="hl_vardecl"><span class="mpre">xv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_114_27_114_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_27_114_28&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_114_29_114_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_29_114_31&#39;)"><span class="hl_vardecl"><span class="mpre">yk</span></span></a><span class="mpre"> </span><a name="loc_114_32_114_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_32_114_34&#39;)"><span class="hl_vardecl"><span class="mpre">yv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_114_43_114_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_43_114_44&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_114_45_114_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_45_114_47&#39;)"><span class="hl_vardecl"><span class="mpre">zk</span></span></a><span class="mpre"> </span><a name="loc_114_48_114_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_48_114_50&#39;)"><span class="hl_vardecl"><span class="mpre">zv</span></span></a><span class="mpre"> </span><a name="loc_114_51_114_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_51_114_52&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">)) =
    </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_114_11_114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_11_114_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_114_13_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_13_114_15&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_114_16_114_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_16_114_18&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_114_27_114_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_27_114_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="#loc_114_29_114_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_29_114_31&#39;)"><span class="hl_varref"><span class="mpre">yk</span></span></a><span class="mpre"> </span><a href="#loc_114_32_114_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_32_114_34&#39;)"><span class="hl_varref"><span class="mpre">yv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_114_43_114_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_43_114_44&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_114_45_114_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_45_114_47&#39;)"><span class="hl_varref"><span class="mpre">zk</span></span></a><span class="mpre"> </span><a href="#loc_114_48_114_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_48_114_50&#39;)"><span class="hl_varref"><span class="mpre">zv</span></span></a><span class="mpre"> </span><a href="#loc_114_51_114_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_51_114_52&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
</span><a href="#loc_114_1_114_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_10&#39;)"><span class="hl_fundecl"><span class="mpre">balanceR&#39;</span></span></a><span class="mpre"> </span><a name="loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_116_13_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_15&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a name="loc_116_16_116_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_18&#39;)"><span class="hl_vardecl"><span class="mpre">xv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_116_35_116_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_35_116_36&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_116_37_116_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_37_116_39&#39;)"><span class="hl_vardecl"><span class="mpre">yk</span></span></a><span class="mpre"> </span><a name="loc_116_40_116_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_40_116_42&#39;)"><span class="hl_vardecl"><span class="mpre">yv</span></span></a><span class="mpre"> </span><a name="loc_116_43_116_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_44&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><a name="loc_116_46_116_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_46_116_48&#39;)"><span class="hl_vardecl"><span class="mpre">zk</span></span></a><span class="mpre"> </span><a name="loc_116_49_116_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_49_116_51&#39;)"><span class="hl_vardecl"><span class="mpre">zv</span></span></a><span class="mpre"> </span><a name="loc_116_52_116_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_52_116_53&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) =
    </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_116_13_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_15&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_116_16_116_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_18&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_116_35_116_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_35_116_36&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="#loc_116_37_116_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_37_116_39&#39;)"><span class="hl_varref"><span class="mpre">yk</span></span></a><span class="mpre"> </span><a href="#loc_116_40_116_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_40_116_42&#39;)"><span class="hl_varref"><span class="mpre">yv</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_116_43_116_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_44&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_116_46_116_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_46_116_48&#39;)"><span class="hl_varref"><span class="mpre">zk</span></span></a><span class="mpre"> </span><a href="#loc_116_49_116_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_49_116_51&#39;)"><span class="hl_varref"><span class="mpre">zv</span></span></a><span class="mpre"> </span><a href="#loc_116_52_116_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_52_116_53&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
</span><a href="#loc_114_1_114_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_10&#39;)"><span class="hl_fundecl"><span class="mpre">balanceR&#39;</span></span></a><span class="mpre"> </span><a name="loc_118_11_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_11_118_12&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_118_13_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_13_118_15&#39;)"><span class="hl_vardecl"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a name="loc_118_16_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_16_118_18&#39;)"><span class="hl_vardecl"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a name="loc_118_19_118_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_19_118_20&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_118_11_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_11_118_12&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_118_13_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_13_118_15&#39;)"><span class="hl_varref"><span class="mpre">xk</span></span></a><span class="mpre"> </span><a href="#loc_118_16_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_16_118_18&#39;)"><span class="hl_varref"><span class="mpre">xv</span></span></a><span class="mpre"> </span><a href="#loc_118_19_118_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_19_118_20&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_121_1_121_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_6&#39;)"><span class="mpre">turnB</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_121_1_121_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_6&#39;)"><span class="hl_fundecl"><span class="mpre">turnB</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre">             = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;turnB&quot;</span></span><span class="mpre">
</span><a href="#loc_121_1_121_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_6&#39;)"><span class="hl_fundecl"><span class="mpre">turnB</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> _ </span><a name="loc_122_15_122_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_15_122_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_122_17_122_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_17_122_18&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_122_19_122_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_19_122_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_122_21_122_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_21_122_22&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_122_15_122_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_15_122_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_122_17_122_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_17_122_18&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_122_19_122_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_19_122_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_122_21_122_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_21_122_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(N log N)</span></span><span class="mpre">
</span><a href="#loc_128_1_128_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_9&#39;)"><span class="mpre">fromList</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 127, srcSpanStartColumn = 13, srcSpanEndLine = 127, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 127, srcSpanStartColumn = 19, srcSpanEndLine = 127, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/va"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)] -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_128_1_128_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">fromList</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> (\</span><a name="loc_128_21_128_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_21_128_22&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a name="loc_128_24_128_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_24_128_25&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">,</span><a name="loc_128_26_128_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_26_128_27&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">insert</span></span></a><span class="mpre"> </span><a href="#loc_128_24_128_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_24_128_25&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_128_26_128_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_26_128_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_128_21_128_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_21_128_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="#loc_81_1_81_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(N)</span></span><span class="mpre">
</span><a href="#loc_132_1_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_7&#39;)"><span class="mpre">toList</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)]
</span><a name="loc_132_1_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_7&#39;)"><span class="hl_fundecl"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a name="loc_132_8_132_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_8_132_9&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_134_5_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_5_134_12&#39;)"><span class="hl_varref"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_132_8_132_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_8_132_9&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> []
  where
    </span><a name="loc_134_5_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_5_134_12&#39;)"><span class="hl_fundecl"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a name="loc_134_18_134_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_18_134_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_134_18_134_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_18_134_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_134_5_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_5_134_12&#39;)"><span class="hl_fundecl"><span class="mpre">inorder</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> _ </span><a name="loc_135_21_135_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_21_135_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_135_23_135_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_23_135_24&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_135_25_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_25_135_26&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_135_27_135_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_27_135_28&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) </span><a name="loc_135_30_135_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_30_135_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_134_5_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_5_134_12&#39;)"><span class="hl_varref"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_135_21_135_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_21_135_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_136_5_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_5_136_10&#39;)"><span class="hl_varref"><span class="mpre">pairs</span></span></a><span class="mpre"> </span><a href="#loc_135_23_135_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_23_135_24&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_135_25_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_25_135_26&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_134_5_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_5_134_12&#39;)"><span class="hl_varref"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_135_27_135_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_27_135_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_135_30_135_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_30_135_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    </span><a name="loc_136_5_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_5_136_10&#39;)"><span class="hl_fundecl"><span class="mpre">pairs</span></span></a><span class="mpre"> </span><a name="loc_136_11_136_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_11_136_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a name="loc_136_18_136_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = [(</span><a href="#loc_136_11_136_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_11_136_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">,</span><a href="#loc_136_18_136_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)]
    </span><a href="#loc_136_5_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_5_136_10&#39;)"><span class="hl_fundecl"><span class="mpre">pairs</span></span></a><span class="mpre"> </span><a name="loc_137_11_137_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_11_137_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_26_15_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_18&#39;)"><span class="hl_conref"><span class="mpre">Tom</span></span></a><span class="mpre"> </span><a name="loc_137_18_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_18_137_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_137_20_137_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_22&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">) = (</span><a href="#loc_137_11_137_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_11_137_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">,</span><a href="#loc_137_18_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_18_137_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_136_5_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_5_136_10&#39;)"><span class="hl_varref"><span class="mpre">pairs</span></span></a><span class="mpre"> </span><a href="#loc_137_11_137_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_11_137_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_137_20_137_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_22&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(N)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Constructing Red-Black Trees&quot; by Ralf Hinze</span></span><span class="mpre">
</span><a href="#loc_144_1_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_15&#39;)"><span class="mpre">fromSortedList</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 19, srcSpanEndLine = 143, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 25, srcSpanEndLine = 143, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/va"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">,</span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)] -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_144_1_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_15&#39;)"><span class="hl_vardecl"><span class="mpre">fromSortedList</span></span></a><span class="mpre"> = </span><a href="#loc_160_1_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_8&#39;)"><span class="hl_varref"><span class="mpre">linkAll</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_157_1_157_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_4&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> []

data </span><a name="loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Digit</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> = </span><a name="loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_condecl"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> (</span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) (</span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)
               | </span><a name="loc_147_18_147_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_18_147_21&#39;)"><span class="hl_condecl"><span class="mpre">Due</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> (</span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) (</span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> (</span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) (</span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)
               </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 148, srcSpanStartColumn = 16, srcSpanEndLine = 148, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 148, srcSpanStartColumn = 16, srcSpanEndLine = 148, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/"><span class="mpre">deriving (Eq,Show)</span></span><span class="mpre">

</span><a href="#loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="mpre">incr</span></a><span class="mpre"> :: </span><a href="#loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_tyconref"><span class="mpre">Digit</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; [</span><a href="#loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_tyconref"><span class="mpre">Digit</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">] -&gt; [</span><a href="#loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_tyconref"><span class="mpre">Digit</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">]
</span><a name="loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="hl_fundecl"><span class="mpre">incr</span></span></a><span class="mpre"> (</span><a href="#loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_conref"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><a name="loc_151_11_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_11_151_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) [] = [</span><a href="#loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_conref"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><a href="#loc_151_11_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_11_151_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">]
</span><a href="#loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="hl_fundecl"><span class="mpre">incr</span></span></a><span class="mpre"> (</span><a href="#loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_conref"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><a name="loc_152_11_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_11_152_13&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a name="loc_152_14_152_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_14_152_16&#39;)"><span class="hl_vardecl"><span class="mpre">v1</span></span></a><span class="mpre"> </span><a name="loc_152_17_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_17_152_19&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre">) (</span><a href="#loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_conref"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><a name="loc_152_26_152_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_26_152_28&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a name="loc_152_29_152_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_29_152_31&#39;)"><span class="hl_vardecl"><span class="mpre">v2</span></span></a><span class="mpre"> </span><a name="loc_152_32_152_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_32_152_34&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_152_37_152_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_37_152_39&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) = </span><a href="#loc_147_18_147_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_18_147_21&#39;)"><span class="hl_conref"><span class="mpre">Due</span></span></a><span class="mpre"> </span><a href="#loc_152_11_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_11_152_13&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a href="#loc_152_14_152_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_14_152_16&#39;)"><span class="hl_varref"><span class="mpre">v1</span></span></a><span class="mpre"> </span><a href="#loc_152_17_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_17_152_19&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><a href="#loc_152_26_152_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_26_152_28&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a href="#loc_152_29_152_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_29_152_31&#39;)"><span class="hl_varref"><span class="mpre">v2</span></span></a><span class="mpre"> </span><a href="#loc_152_32_152_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_32_152_34&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_152_37_152_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_37_152_39&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
</span><a href="#loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="hl_fundecl"><span class="mpre">incr</span></span></a><span class="mpre"> (</span><a href="#loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_conref"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><a name="loc_153_11_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_11_153_13&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a name="loc_153_14_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_16&#39;)"><span class="hl_vardecl"><span class="mpre">v1</span></span></a><span class="mpre"> </span><a name="loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre">) (</span><a href="#loc_147_18_147_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_18_147_21&#39;)"><span class="hl_conref"><span class="mpre">Due</span></span></a><span class="mpre"> </span><a name="loc_153_26_153_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_26_153_28&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a name="loc_153_29_153_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_29_153_31&#39;)"><span class="hl_vardecl"><span class="mpre">v2</span></span></a><span class="mpre"> </span><a name="loc_153_32_153_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_32_153_34&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre"> </span><a name="loc_153_35_153_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_35_153_37&#39;)"><span class="hl_vardecl"><span class="mpre">k3</span></span></a><span class="mpre"> </span><a name="loc_153_38_153_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_38_153_40&#39;)"><span class="hl_vardecl"><span class="mpre">v3</span></span></a><span class="mpre"> </span><a name="loc_153_41_153_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_41_153_43&#39;)"><span class="hl_vardecl"><span class="mpre">t3</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_153_46_153_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_46_153_48&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) = </span><a href="#loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_conref"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><a href="#loc_153_11_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_11_153_13&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a href="#loc_153_14_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_16&#39;)"><span class="hl_varref"><span class="mpre">v1</span></span></a><span class="mpre"> </span><a href="#loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="hl_varref"><span class="mpre">incr</span></span></a><span class="mpre"> (</span><a href="#loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_conref"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><a href="#loc_153_26_153_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_26_153_28&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a href="#loc_153_29_153_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_29_153_31&#39;)"><span class="hl_varref"><span class="mpre">v2</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_153_32_153_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_32_153_34&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre"> </span><a href="#loc_153_35_153_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_35_153_37&#39;)"><span class="hl_varref"><span class="mpre">k3</span></span></a><span class="mpre"> </span><a href="#loc_153_38_153_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_38_153_40&#39;)"><span class="hl_varref"><span class="mpre">v3</span></span></a><span class="mpre"> </span><a href="#loc_153_41_153_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_41_153_43&#39;)"><span class="hl_varref"><span class="mpre">t3</span></span></a><span class="mpre">)) </span><a href="#loc_153_46_153_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_46_153_48&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
</span><a href="#loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="hl_fundecl"><span class="mpre">incr</span></span></a><span class="mpre"> _ _ = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;incr&quot;</span></span><span class="mpre">

</span><a href="#loc_157_1_157_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_4&#39;)"><span class="mpre">add</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">,</span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) -&gt; [</span><a href="#loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_tyconref"><span class="mpre">Digit</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">] -&gt; [</span><a href="#loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_tyconref"><span class="mpre">Digit</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">]
</span><a name="loc_157_1_157_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_4&#39;)"><span class="hl_fundecl"><span class="mpre">add</span></span></a><span class="mpre"> (</span><a name="loc_157_6_157_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_6_157_7&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">,</span><a name="loc_157_8_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_8_157_9&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_157_11_157_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_11_157_13&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> = </span><a href="#loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="hl_varref"><span class="mpre">incr</span></span></a><span class="mpre"> (</span><a href="#loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_conref"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><a href="#loc_157_6_157_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_6_157_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_157_8_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_8_157_9&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre">) </span><a href="#loc_157_11_157_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_11_157_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">

</span><a href="#loc_160_1_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_8&#39;)"><span class="mpre">linkAll</span></a><span class="mpre"> :: [</span><a href="#loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_tyconref"><span class="mpre">Digit</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">] -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_160_1_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_8&#39;)"><span class="hl_vardecl"><span class="mpre">linkAll</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_163_1_163_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_5&#39;)"><span class="hl_varref"><span class="mpre">link</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre">

</span><a href="#loc_163_1_163_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_5&#39;)"><span class="mpre">link</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_tyconref"><span class="mpre">Digit</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_163_1_163_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_5&#39;)"><span class="hl_fundecl"><span class="mpre">link</span></span></a><span class="mpre"> </span><a name="loc_163_6_163_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_6_163_7&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_146_18_146_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_21&#39;)"><span class="hl_conref"><span class="mpre">Uno</span></span></a><span class="mpre"> </span><a name="loc_163_13_163_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_13_163_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_163_15_163_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_15_163_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_163_17_163_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_17_163_18&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_163_6_163_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_6_163_7&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_163_13_163_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_13_163_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_163_15_163_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_15_163_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_163_17_163_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_17_163_18&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--link l (Due k1 v1 t1 k2 v2 t2) = Node B (Node R l k1 v1 t1) k2 v2 t2</span></span><span class="mpre">
</span><a href="#loc_163_1_163_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_5&#39;)"><span class="hl_fundecl"><span class="mpre">link</span></span></a><span class="mpre"> </span><a name="loc_165_6_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_6_165_7&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_147_18_147_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_18_147_21&#39;)"><span class="hl_conref"><span class="mpre">Due</span></span></a><span class="mpre"> </span><a name="loc_165_13_165_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_15&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a name="loc_165_16_165_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_16_165_18&#39;)"><span class="hl_vardecl"><span class="mpre">v1</span></span></a><span class="mpre"> </span><a name="loc_165_19_165_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_19_165_21&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre"> </span><a name="loc_165_22_165_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_22_165_24&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a name="loc_165_25_165_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_25_165_27&#39;)"><span class="hl_vardecl"><span class="mpre">v2</span></span></a><span class="mpre"> </span><a name="loc_165_28_165_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_28_165_30&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre">) = </span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_165_6_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_6_165_7&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_165_13_165_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_15&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a href="#loc_165_16_165_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_16_165_18&#39;)"><span class="hl_varref"><span class="mpre">v1</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a href="#loc_165_19_165_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_19_165_21&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><a href="#loc_165_22_165_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_22_165_24&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a href="#loc_165_25_165_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_25_165_27&#39;)"><span class="hl_varref"><span class="mpre">v2</span></span></a><span class="mpre"> </span><a href="#loc_165_28_165_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_28_165_30&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(N)</span></span><span class="mpre">
</span><a href="#loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="mpre">toSortedList</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">,</span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)]
</span><a name="loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="hl_fundecl"><span class="mpre">toSortedList</span></span></a><span class="mpre"> </span><a name="loc_171_14_171_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_14_171_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_173_5_173_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_12&#39;)"><span class="hl_varref"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_171_14_171_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_14_171_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> []
  where
    </span><a name="loc_173_5_173_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_12&#39;)"><span class="hl_fundecl"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a name="loc_173_18_173_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_18_173_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_173_18_173_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_18_173_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_173_5_173_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_12&#39;)"><span class="hl_fundecl"><span class="mpre">inorder</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> _ </span><a name="loc_174_21_174_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_21_174_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_174_23_174_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_23_174_24&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_174_25_174_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_25_174_26&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_174_27_174_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_27_174_28&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) </span><a name="loc_174_30_174_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_30_174_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_173_5_173_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_12&#39;)"><span class="hl_varref"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_174_21_174_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_21_174_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> ((</span><a href="#loc_174_23_174_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_23_174_24&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">,</span><a href="#loc_174_25_174_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_25_174_26&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_173_5_173_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_12&#39;)"><span class="hl_varref"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_174_27_174_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_27_174_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_174_30_174_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_30_174_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | O(N)</span></span><span class="mpre">
</span><a href="#loc_183_1_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_10&#39;)"><span class="mpre">pruneWith</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 179, srcSpanStartColumn = 14, srcSpanEndLine = 179, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 179, srcSpanStartColumn = 20, srcSpanEndLine = 179, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/va"><span class="mpre">Ord k =&gt;</span></span><span class="mpre">
             </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
          -&gt; (</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><a href="#loc_25_6_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_10&#39;)"><span class="hl_tyconref"><span class="mpre">Some</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)])
          -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)
</span><a name="loc_183_1_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_10&#39;)"><span class="hl_fundecl"><span class="mpre">pruneWith</span></span></a><span class="mpre"> </span><a name="loc_183_11_183_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_12&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_183_13_183_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_13_183_16&#39;)"><span class="hl_vardecl"><span class="mpre">run</span></span></a><span class="mpre"> = </span><a href="#loc_144_1_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_15&#39;)"><span class="hl_varref"><span class="mpre">fromSortedList</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_185_5_185_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_12&#39;)"><span class="hl_varref"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_183_11_183_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> []
  where
    </span><a name="loc_185_5_185_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_12&#39;)"><span class="hl_fundecl"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a name="loc_185_18_185_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_18_185_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_185_18_185_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_18_185_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_185_5_185_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_12&#39;)"><span class="hl_fundecl"><span class="mpre">inorder</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> _ </span><a name="loc_186_21_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_21_186_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_186_23_186_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_23_186_24&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_186_25_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_25_186_26&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_186_27_186_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_27_186_28&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) </span><a name="loc_186_30_186_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_30_186_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = do
        </span><a name="loc_187_9_187_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_11&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_183_13_183_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_13_183_16&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_186_23_186_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_23_186_24&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_186_25_186_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_25_186_26&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
        </span><a name="loc_188_9_188_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_11&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_185_5_185_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_12&#39;)"><span class="hl_varref"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_186_27_186_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_27_186_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_186_30_186_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_30_186_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_185_5_185_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_12&#39;)"><span class="hl_varref"><span class="mpre">inorder</span></span></a><span class="mpre"> </span><a href="#loc_186_21_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_21_186_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_187_9_187_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_11&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_188_9_188_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_11&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- O(N log N) where N is the size of the second argument</span></span><span class="mpre">
</span><a href="#loc_195_1_195_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_6&#39;)"><span class="mpre">merge</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 194, srcSpanStartColumn = 10, srcSpanEndLine = 194, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 194, srcSpanStartColumn = 16, srcSpanEndLine = 194, srcSpanEndColumn = 18}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/va"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_195_1_195_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_6&#39;)"><span class="hl_fundecl"><span class="mpre">merge</span></span></a><span class="mpre"> </span><a name="loc_195_7_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_7_195_11&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> </span><a name="loc_195_12_195_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_12_195_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_197_5_197_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_5_197_8&#39;)"><span class="hl_varref"><span class="mpre">ins</span></span></a><span class="mpre"> </span><a href="#loc_195_7_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_7_195_11&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> </span><a href="#loc_198_5_198_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_7&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
  where
    </span><a name="loc_197_5_197_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_5_197_8&#39;)"><span class="hl_fundecl"><span class="mpre">ins</span></span></a><span class="mpre"> </span><a name="loc_197_9_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_10&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a name="loc_197_12_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_12_197_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">,</span><a name="loc_197_14_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_14_197_15&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">insert</span></span></a><span class="mpre"> </span><a href="#loc_197_12_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_12_197_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_197_14_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_14_197_15&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_197_9_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
    </span><a name="loc_198_5_198_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_7&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_132_1_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_195_12_195_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_12_195_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for testing</span></span><span class="mpre">

</span><a href="#loc_204_1_204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_6&#39;)"><span class="mpre">valid</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 203, srcSpanStartColumn = 10, srcSpanEndLine = 203, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 203, srcSpanStartColumn = 16, srcSpanEndLine = 203, srcSpanEndColumn = 18}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/va"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_204_1_204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_6&#39;)"><span class="hl_fundecl"><span class="mpre">valid</span></span></a><span class="mpre"> </span><a name="loc_204_7_204_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_7_204_8&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_207_1_207_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_11&#39;)"><span class="hl_varref"><span class="mpre">isBalanced</span></span></a><span class="mpre"> </span><a href="#loc_204_7_204_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_7_204_8&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_232_1_232_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_10&#39;)"><span class="hl_varref"><span class="mpre">isOrdered</span></span></a><span class="mpre"> </span><a href="#loc_204_7_204_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_7_204_8&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><a href="#loc_207_1_207_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_11&#39;)"><span class="mpre">isBalanced</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_207_1_207_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_11&#39;)"><span class="hl_fundecl"><span class="mpre">isBalanced</span></span></a><span class="mpre"> </span><a name="loc_207_12_207_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_12_207_13&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_210_1_210_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_12&#39;)"><span class="hl_varref"><span class="mpre">isBlackSame</span></span></a><span class="mpre"> </span><a href="#loc_207_12_207_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_12_207_13&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_224_1_224_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_14&#39;)"><span class="hl_varref"><span class="mpre">isRedSeparate</span></span></a><span class="mpre"> </span><a href="#loc_207_12_207_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_12_207_13&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><a href="#loc_210_1_210_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_12&#39;)"><span class="mpre">isBlackSame</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_210_1_210_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_12&#39;)"><span class="hl_fundecl"><span class="mpre">isBlackSame</span></span></a><span class="mpre"> </span><a name="loc_210_13_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_13_210_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><a href="#loc_212_5_212_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_5_212_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre">) </span><a href="#loc_212_7_212_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_7_212_9&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">
  where
    </span><a name="loc_212_5_212_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_5_212_6&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_212_7_212_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_7_212_9&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre"> = </span><a href="#loc_215_1_215_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_7&#39;)"><span class="hl_varref"><span class="mpre">blacks</span></span></a><span class="mpre"> </span><a href="#loc_210_13_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_13_210_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><a href="#loc_215_1_215_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_7&#39;)"><span class="mpre">blacks</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]
</span><a name="loc_215_1_215_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_7&#39;)"><span class="hl_vardecl"><span class="mpre">blacks</span></span></a><span class="mpre"> = </span><a href="#loc_217_5_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_12&#39;)"><span class="hl_varref"><span class="mpre">blacks&#39;</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where
    </span><a name="loc_217_5_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_12&#39;)"><span class="hl_fundecl"><span class="mpre">blacks&#39;</span></span></a><span class="mpre"> </span><a name="loc_217_13_217_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_13_217_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> = [</span><a href="#loc_217_13_217_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_13_217_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">]
    </span><a href="#loc_217_5_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_12&#39;)"><span class="hl_fundecl"><span class="mpre">blacks&#39;</span></span></a><span class="mpre"> </span><a name="loc_218_13_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_13_218_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_218_23_218_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_23_218_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> _ _ </span><a name="loc_218_29_218_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_29_218_30&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_217_5_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_12&#39;)"><span class="hl_varref"><span class="mpre">blacks&#39;</span></span></a><span class="mpre"> </span><a href="#loc_218_13_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_13_218_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">  </span><a href="#loc_218_23_218_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_23_218_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_217_5_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_12&#39;)"><span class="hl_varref"><span class="mpre">blacks&#39;</span></span></a><span class="mpre"> </span><a href="#loc_218_13_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_13_218_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">  </span><a href="#loc_218_29_218_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_29_218_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    </span><a href="#loc_217_5_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_12&#39;)"><span class="hl_fundecl"><span class="mpre">blacks&#39;</span></span></a><span class="mpre"> </span><a name="loc_219_13_219_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_13_219_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a name="loc_219_23_219_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_23_219_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> _ _ </span><a name="loc_219_29_219_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_29_219_30&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_217_5_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_12&#39;)"><span class="hl_varref"><span class="mpre">blacks&#39;</span></span></a><span class="mpre"> </span><a href="#loc_221_9_221_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_9_221_11&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><a href="#loc_219_23_219_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_23_219_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_217_5_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_12&#39;)"><span class="hl_varref"><span class="mpre">blacks&#39;</span></span></a><span class="mpre"> </span><a href="#loc_221_9_221_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_9_221_11&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><a href="#loc_219_29_219_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_29_219_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
      where
        </span><a name="loc_221_9_221_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_9_221_11&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_219_13_219_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_13_219_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

</span><a href="#loc_224_1_224_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_14&#39;)"><span class="mpre">isRedSeparate</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_224_1_224_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_14&#39;)"><span class="hl_vardecl"><span class="mpre">isRedSeparate</span></span></a><span class="mpre"> = </span><a href="#loc_227_1_227_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_5&#39;)"><span class="hl_varref"><span class="mpre">reds</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_15&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre">

</span><a href="#loc_227_1_227_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_5&#39;)"><span class="mpre">reds</span></a><span class="mpre"> :: </span><a href="#loc_45_6_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_11&#39;)"><span class="hl_tyconref"><span class="mpre">Color</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_227_1_227_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_5&#39;)"><span class="hl_fundecl"><span class="mpre">reds</span></span></a><span class="mpre"> _ </span><a href="#loc_41_17_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_21&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_227_1_227_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_5&#39;)"><span class="hl_fundecl"><span class="mpre">reds</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> _ _ _ _) = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_227_1_227_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_5&#39;)"><span class="hl_fundecl"><span class="mpre">reds</span></span></a><span class="mpre"> _ (</span><a href="#loc_42_17_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_21&#39;)"><span class="hl_conref"><span class="mpre">Node</span></span></a><span class="mpre"> </span><a name="loc_229_14_229_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_14_229_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_229_16_229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_16_229_17&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> _ _ </span><a name="loc_229_22_229_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_22_229_23&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_227_1_227_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_5&#39;)"><span class="hl_varref"><span class="mpre">reds</span></span></a><span class="mpre"> </span><a href="#loc_229_14_229_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_14_229_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_229_16_229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_16_229_17&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_227_1_227_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_5&#39;)"><span class="hl_varref"><span class="mpre">reds</span></span></a><span class="mpre"> </span><a href="#loc_229_14_229_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_14_229_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_229_22_229_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_22_229_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_232_1_232_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_10&#39;)"><span class="mpre">isOrdered</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 231, srcSpanStartColumn = 14, srcSpanEndLine = 231, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/MultiMap.hs&quot;, srcSpanStartLine = 231, srcSpanStartColumn = 20, srcSpanEndLine = 231, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/va"><span class="mpre">Ord k =&gt;</span></span><span class="mpre"> </span><a href="#loc_41_6_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_10&#39;)"><span class="hl_tyconref"><span class="mpre">MMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_232_1_232_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_10&#39;)"><span class="hl_fundecl"><span class="mpre">isOrdered</span></span></a><span class="mpre"> </span><a name="loc_232_11_232_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_11_232_12&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_234_5_234_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_12&#39;)"><span class="hl_varref"><span class="mpre">ordered</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="hl_varref"><span class="mpre">toSortedList</span></span></a><span class="mpre"> </span><a href="#loc_232_11_232_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_11_232_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
  where
    </span><a name="loc_234_5_234_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_12&#39;)"><span class="hl_fundecl"><span class="mpre">ordered</span></span></a><span class="mpre"> [] = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_234_5_234_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_12&#39;)"><span class="hl_fundecl"><span class="mpre">ordered</span></span></a><span class="mpre"> [_] = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_234_5_234_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_12&#39;)"><span class="hl_fundecl"><span class="mpre">ordered</span></span></a><span class="mpre"> (</span><a name="loc_236_14_236_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_14_236_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_236_16_236_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_16_236_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_236_18_236_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_18_236_21&#39;)"><span class="hl_vardecl"><span class="mpre">xys</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_236_14_236_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_14_236_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_236_16_236_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_16_236_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_234_5_234_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_12&#39;)"><span class="hl_varref"><span class="mpre">ordered</span></span></a><span class="mpre"> (</span><a href="#loc_236_16_236_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_16_236_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_236_18_236_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_18_236_21&#39;)"><span class="hl_varref"><span class="mpre">xys</span></span></a><span class="mpre">)
</span></div></body></html>