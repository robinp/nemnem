<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Network.HTTP.Auth</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  See LICENSE file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Ganesh Sittampalam &lt;ganesh@earth.li&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (not tested)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Representing HTTP Auth values in Haskell.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Right now, it contains mostly functionality needed by &#39;Network.Browser&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
module Network.HTTP.Auth
       ( Authority(..)
       , Algorithm(..)
       , Challenge(..)
       , Qop(..)

       , headerToChallenge </span><span class="hl_comment"><span class="mpre">-- :: URI -&gt; Header -&gt; Maybe Challenge</span></span><span class="mpre">
       , withAuthority     </span><span class="hl_comment"><span class="mpre">-- :: Authority -&gt; Request ty -&gt; String</span></span><span class="mpre">
       ) where

import Network.URI
import Network.HTTP.Base
import Network.HTTP.Utils
import Network.HTTP.Headers ( </span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="mpre">Header</span></a><span class="mpre">(..) )
import qualified Network.HTTP.MD5Aux as MD5 (</span><a href="Network.HTTP.MD5Aux.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.MD5Aux.html#loc_111_1_111_5&#39;)"><span class="mpre">md5s</span></a><span class="mpre">, </span><a href="Network.HTTP.MD5Aux.html#loc_21_9_21_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.MD5Aux.html#loc_21_9_21_12&#39;)"><span class="mpre">Str</span></a><span class="mpre">(</span><a href="Network.HTTP.MD5Aux.html#loc_21_15_21_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.MD5Aux.html#loc_21_15_21_18&#39;)"><span class="mpre">Str</span></a><span class="mpre">))
import qualified Network.HTTP.Base64 as Base64 (</span><a href="Network.HTTP.Base64.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base64.html#loc_270_1_270_7&#39;)"><span class="mpre">encode</span></a><span class="mpre">)
import Text.ParserCombinators.Parsec
   ( Parser, char, </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="mpre">many</span></a><span class="mpre">, </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="mpre">many1</span></a><span class="mpre">, satisfy, </span><a href="Text.Parsec.Prim.html#loc_642_1_642_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_642_1_642_6&#39;)"><span class="mpre">parse</span></a><span class="mpre">, spaces, </span><a href="Text.Parsec.Combinator.html#loc_117_1_117_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_117_1_117_7&#39;)"><span class="mpre">sepBy1</span></a><span class="mpre"> )

import Data.Char
import Data.Maybe
import Data.Word ( Word8 )

</span><span class="hl_comment"><span class="mpre">-- | @Authority@ specifies the HTTP Authentication method to use for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a given domain/realm; @Basic@ or @Digest@.</span></span><span class="mpre">
data </span><a name="loc_41_6_41_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Authority</span></span></a><span class="mpre"> 
 = </span><span class="hl_condecl"><span class="mpre">AuthBasic</span></span><span class="mpre"> { </span><a name="loc_42_16_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_23&#39;)"><span class="hl_fielddecl"><span class="mpre">auRealm</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             , </span><a name="loc_43_16_43_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_26&#39;)"><span class="hl_fielddecl"><span class="mpre">auUsername</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             , </span><a name="loc_44_16_44_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_16_44_26&#39;)"><span class="hl_fielddecl"><span class="mpre">auPassword</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             , </span><a name="loc_45_16_45_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_16_45_22&#39;)"><span class="hl_fielddecl"><span class="mpre">auSite</span></span></a><span class="mpre">     :: </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">
             }
 | </span><span class="hl_condecl"><span class="mpre">AuthDigest</span></span><span class="mpre">{ </span><span class="hl_fielddecl"><span class="mpre">auRealm</span></span><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             , </span><span class="hl_fielddecl"><span class="mpre">auUsername</span></span><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             , </span><span class="hl_fielddecl"><span class="mpre">auPassword</span></span><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             , </span><a name="loc_50_16_50_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_23&#39;)"><span class="hl_fielddecl"><span class="mpre">auNonce</span></span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             , </span><a name="loc_51_16_51_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_16_51_27&#39;)"><span class="hl_fielddecl"><span class="mpre">auAlgorithm</span></span></a><span class="mpre"> :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="#loc_70_6_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_15&#39;)"><span class="hl_tyconref"><span class="mpre">Algorithm</span></span></a><span class="mpre">
             , </span><a name="loc_52_16_52_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_24&#39;)"><span class="hl_fielddecl"><span class="mpre">auDomain</span></span></a><span class="mpre">    :: [</span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">]
             , </span><a name="loc_53_16_53_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_16_53_24&#39;)"><span class="hl_fielddecl"><span class="mpre">auOpaque</span></span></a><span class="mpre">    :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             , </span><a name="loc_54_16_54_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_16_54_21&#39;)"><span class="hl_fielddecl"><span class="mpre">auQop</span></span></a><span class="mpre">       :: [</span><a href="#loc_78_6_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_6_78_9&#39;)"><span class="hl_tyconref"><span class="mpre">Qop</span></span></a><span class="mpre">]
             }


data </span><a name="loc_58_6_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Challenge</span></span></a><span class="mpre"> 
 = </span><a name="loc_59_4_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_4_59_13&#39;)"><span class="hl_condecl"><span class="mpre">ChalBasic</span></span></a><span class="mpre">  { </span><a name="loc_59_17_59_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_24&#39;)"><span class="hl_fielddecl"><span class="mpre">chRealm</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> }
 | </span><span class="hl_condecl"><span class="mpre">ChalDigest</span></span><span class="mpre"> { </span><span class="hl_fielddecl"><span class="mpre">chRealm</span></span><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
              , </span><a name="loc_61_17_61_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_17_61_25&#39;)"><span class="hl_fielddecl"><span class="mpre">chDomain</span></span></a><span class="mpre">  :: [</span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">]
              , </span><a name="loc_62_17_62_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_17_62_24&#39;)"><span class="hl_fielddecl"><span class="mpre">chNonce</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
              , </span><a name="loc_63_17_63_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_17_63_25&#39;)"><span class="hl_fielddecl"><span class="mpre">chOpaque</span></span></a><span class="mpre">  :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
              , </span><a name="loc_64_17_64_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_24&#39;)"><span class="hl_fielddecl"><span class="mpre">chStale</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
              , </span><a name="loc_65_17_65_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_17_65_28&#39;)"><span class="hl_fielddecl"><span class="mpre">chAlgorithm</span></span></a><span class="mpre"> ::</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="#loc_70_6_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_15&#39;)"><span class="hl_tyconref"><span class="mpre">Algorithm</span></span></a><span class="mpre">
              , </span><a name="loc_66_17_66_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_22&#39;)"><span class="hl_fielddecl"><span class="mpre">chQop</span></span></a><span class="mpre">     :: [</span><a href="#loc_78_6_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_6_78_9&#39;)"><span class="hl_tyconref"><span class="mpre">Qop</span></span></a><span class="mpre">]
              }

</span><span class="hl_comment"><span class="mpre">-- | @Algorithm@ controls the digest algorithm to, @MD5@ or @MD5Session@.</span></span><span class="mpre">
data </span><a name="loc_70_6_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Algorithm</span></span></a><span class="mpre"> = </span><a name="loc_70_18_70_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_24&#39;)"><span class="hl_condecl"><span class="mpre">AlgMD5</span></span></a><span class="mpre"> | </span><a name="loc_70_27_70_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_27_70_37&#39;)"><span class="hl_condecl"><span class="mpre">AlgMD5sess</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 5, srcSpanEndLine = 71, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 5, srcSpanEndLine = 71, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine "><span class="mpre">deriving(Eq)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_70_6_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_6_70_15&#39;)"><span class="hl_tyconref"><span class="mpre">Algorithm</span></span></a><span class="mpre"> where
    </span><a name="loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> </span><a href="#loc_70_18_70_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_24&#39;)"><span class="hl_conref"><span class="mpre">AlgMD5</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;md5&quot;</span></span><span class="mpre">
    </span><a href="#loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> </span><a href="#loc_70_27_70_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_27_70_37&#39;)"><span class="hl_conref"><span class="mpre">AlgMD5sess</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;md5-sess&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | </span></span><span class="mpre">
data </span><a name="loc_78_6_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_6_78_9&#39;)"><span class="hl_tycondecl"><span class="mpre">Qop</span></span></a><span class="mpre"> = </span><a name="loc_78_12_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_12_78_19&#39;)"><span class="hl_condecl"><span class="mpre">QopAuth</span></span></a><span class="mpre"> | </span><a name="loc_78_22_78_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_22_78_32&#39;)"><span class="hl_condecl"><span class="mpre">QopAuthInt</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 5, srcSpanEndLine = 79, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 5, srcSpanEndLine = 79, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine "><span class="mpre">deriving(Eq,Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @withAuthority auth req@ generates a credentials value from the @auth@ &#39;Authority&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in the context of the given request.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If a client nonce was to be used then this function might need to be of type ... -&gt; BrowserAction String</span></span><span class="mpre">
</span><a href="#loc_86_1_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_14&#39;)"><span class="mpre">withAuthority</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_15&#39;)"><span class="hl_tyconref"><span class="mpre">Authority</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Base.html#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base.html#loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_86_1_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_14&#39;)"><span class="hl_fundecl"><span class="mpre">withAuthority</span></span></a><span class="mpre"> </span><a name="loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_86_17_86_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_19&#39;)"><span class="hl_vardecl"><span class="mpre">rq</span></span></a><span class="mpre"> = case </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> of
        </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 9, srcSpanEndLine = 87, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 18, srcSpanEndLine = 87, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 8"><span class="mpre">AuthBasic{}</span></span><span class="mpre">  -&gt; </span><span class="hl_string"><span class="mpre">&quot;Basic &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_127_1_127_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_13&#39;)"><span class="hl_varref"><span class="mpre">base64encode</span></span></a><span class="mpre"> (</span><a href="#loc_43_16_43_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_26&#39;)"><span class="hl_varref"><span class="mpre">auUsername</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_44_16_44_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_16_44_26&#39;)"><span class="hl_varref"><span class="mpre">auPassword</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
        </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 9, srcSpanEndLine = 88, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 19, srcSpanEndLine = 88, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 8"><span class="mpre">AuthDigest{}</span></span><span class="mpre"> -&gt;
            </span><span class="hl_string"><span class="mpre">&quot;Digest &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
             </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;username=&quot;</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_101_9_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_12&#39;)"><span class="hl_varref"><span class="mpre">quo</span></span></a><span class="mpre"> (</span><a href="#loc_43_16_43_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_26&#39;)"><span class="hl_varref"><span class="mpre">auUsername</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
                    , </span><span class="hl_string"><span class="mpre">&quot;,realm=&quot;</span></span><span class="mpre">    </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_101_9_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_12&#39;)"><span class="hl_varref"><span class="mpre">quo</span></span></a><span class="mpre"> (</span><a href="#loc_42_16_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_23&#39;)"><span class="hl_varref"><span class="mpre">auRealm</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
                    , </span><span class="hl_string"><span class="mpre">&quot;,nonce=&quot;</span></span><span class="mpre">    </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_101_9_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_12&#39;)"><span class="hl_varref"><span class="mpre">quo</span></span></a><span class="mpre"> (</span><a href="#loc_50_16_50_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_23&#39;)"><span class="hl_varref"><span class="mpre">auNonce</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
                    , </span><span class="hl_string"><span class="mpre">&quot;,uri=&quot;</span></span><span class="mpre">      </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_101_9_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_12&#39;)"><span class="hl_varref"><span class="mpre">quo</span></span></a><span class="mpre"> </span><a href="#loc_117_9_117_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_18&#39;)"><span class="hl_varref"><span class="mpre">digesturi</span></span></a><span class="mpre">
                    , </span><span class="hl_string"><span class="mpre">&quot;,response=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_101_9_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_12&#39;)"><span class="hl_varref"><span class="mpre">quo</span></span></a><span class="mpre"> </span><a href="#loc_103_9_103_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_18&#39;)"><span class="hl_varref"><span class="mpre">rspdigest</span></span></a><span class="mpre">
                       </span><span class="hl_comment"><span class="mpre">-- plus optional stuff:</span></span><span class="mpre">
                    , </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\ </span><a name="loc_96_45_96_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_45_96_48&#39;)"><span class="hl_vardecl"><span class="mpre">alg</span></span></a><span class="mpre"> -&gt; </span><span class="hl_string"><span class="mpre">&quot;,algorithm=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_101_9_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_12&#39;)"><span class="hl_varref"><span class="mpre">quo</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_96_45_96_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_45_96_48&#39;)"><span class="hl_varref"><span class="mpre">alg</span></span></a><span class="mpre">)) (</span><a href="#loc_51_16_51_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_16_51_27&#39;)"><span class="hl_varref"><span class="mpre">auAlgorithm</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">))
                    , </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\ </span><a name="loc_97_45_97_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_45_97_46&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">   -&gt; </span><span class="hl_string"><span class="mpre">&quot;,opaque=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_101_9_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_12&#39;)"><span class="hl_varref"><span class="mpre">quo</span></span></a><span class="mpre"> </span><a href="#loc_97_45_97_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_45_97_46&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">) (</span><a href="#loc_53_16_53_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_16_53_24&#39;)"><span class="hl_varref"><span class="mpre">auOpaque</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">))
                    , if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> (</span><a href="#loc_54_16_54_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_16_54_21&#39;)"><span class="hl_varref"><span class="mpre">auQop</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot;,qop=auth&quot;</span></span><span class="mpre">
                    ]
    where
        </span><a name="loc_101_9_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_12&#39;)"><span class="hl_fundecl"><span class="mpre">quo</span></span></a><span class="mpre"> </span><a name="loc_101_13_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_13_101_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_101_13_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_13_101_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\&quot;&quot;</span></span><span class="mpre">

        </span><a name="loc_103_9_103_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_18&#39;)"><span class="hl_vardecl"><span class="mpre">rspdigest</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> (</span><a href="#loc_133_1_133_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_3&#39;)"><span class="hl_varref"><span class="mpre">kd</span></span></a><span class="mpre"> (</span><a href="#loc_130_1_130_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_4&#39;)"><span class="hl_varref"><span class="mpre">md5</span></span></a><span class="mpre"> </span><a href="#loc_106_9_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_11&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre">) (</span><a href="#loc_118_9_118_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_19&#39;)"><span class="hl_varref"><span class="mpre">noncevalue</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_130_1_130_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_4&#39;)"><span class="hl_varref"><span class="mpre">md5</span></span></a><span class="mpre"> </span><a href="#loc_115_9_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_11&#39;)"><span class="hl_varref"><span class="mpre">a2</span></span></a><span class="mpre">))

        </span><a href="#loc_106_9_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_11&#39;)"><span class="mpre">a1</span></a><span class="mpre">, </span><a href="#loc_115_9_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_11&#39;)"><span class="mpre">a2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
        </span><a name="loc_106_9_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_11&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre"> = </span><a href="#loc_43_16_43_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_26&#39;)"><span class="hl_varref"><span class="mpre">auUsername</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_42_16_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_23&#39;)"><span class="hl_varref"><span class="mpre">auRealm</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_44_16_44_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_16_44_26&#39;)"><span class="hl_varref"><span class="mpre">auPassword</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
        
        </span><span class="hl_comment"><span class="mpre">{-
        If the &quot;qop&quot; directive&#39;s value is &quot;auth&quot; or is unspecified, then A2
        is:
           A2  = Method &quot;:&quot; digest-uri-value
        If the &quot;qop&quot; value is &quot;auth-int&quot;, then A2 is:
           A2  = Method &quot;:&quot; digest-uri-value &quot;:&quot; H(entity-body)
        -}</span></span><span class="mpre">
        </span><a name="loc_115_9_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_11&#39;)"><span class="hl_vardecl"><span class="mpre">a2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="Network.HTTP.Base.html#loc_298_16_298_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base.html#loc_298_16_298_24&#39;)"><span class="hl_varref"><span class="mpre">rqMethod</span></span></a><span class="mpre"> </span><a href="#loc_86_17_86_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_19&#39;)"><span class="hl_varref"><span class="mpre">rq</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_117_9_117_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_18&#39;)"><span class="hl_varref"><span class="mpre">digesturi</span></span></a><span class="mpre">

        </span><a name="loc_117_9_117_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_18&#39;)"><span class="hl_vardecl"><span class="mpre">digesturi</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="Network.HTTP.Base.html#loc_293_16_293_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base.html#loc_293_16_293_21&#39;)"><span class="hl_varref"><span class="mpre">rqURI</span></span></a><span class="mpre"> </span><a href="#loc_86_17_86_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_19&#39;)"><span class="hl_varref"><span class="mpre">rq</span></span></a><span class="mpre">)
        </span><a name="loc_118_9_118_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_19&#39;)"><span class="hl_vardecl"><span class="mpre">noncevalue</span></span></a><span class="mpre"> = </span><a href="#loc_50_16_50_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_23&#39;)"><span class="hl_varref"><span class="mpre">auNonce</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 1, srcSpanEndLine = 120, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 1, srcSpanEndLine = 120, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLi"><span class="mpre">type Octet = Word8</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- FIXME: these probably only work right for latin-1 strings</span></span><span class="mpre">
</span><a href="#loc_124_1_124_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_15&#39;)"><span class="mpre">stringToOctets</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Octet</span></span><span class="mpre">]
</span><a name="loc_124_1_124_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_15&#39;)"><span class="hl_vardecl"><span class="mpre">stringToOctets</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre">)

</span><a href="#loc_127_1_127_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_13&#39;)"><span class="mpre">base64encode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_127_1_127_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_13&#39;)"><span class="hl_vardecl"><span class="mpre">base64encode</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Base64.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base64.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">Base64.encode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_124_1_124_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_15&#39;)"><span class="hl_varref"><span class="mpre">stringToOctets</span></span></a><span class="mpre">

</span><a href="#loc_130_1_130_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_4&#39;)"><span class="mpre">md5</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_130_1_130_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_4&#39;)"><span class="hl_vardecl"><span class="mpre">md5</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.MD5Aux.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.MD5Aux.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">MD5.md5s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.HTTP.MD5Aux.html#loc_21_15_21_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.MD5Aux.html#loc_21_15_21_18&#39;)"><span class="hl_conref"><span class="mpre">MD5.Str</span></span></a><span class="mpre">

</span><a href="#loc_133_1_133_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_3&#39;)"><span class="mpre">kd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_133_1_133_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_3&#39;)"><span class="hl_fundecl"><span class="mpre">kd</span></span></a><span class="mpre"> </span><a name="loc_133_4_133_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_4_133_5&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_133_6_133_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_6_133_7&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_130_1_130_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_4&#39;)"><span class="hl_varref"><span class="mpre">md5</span></span></a><span class="mpre"> (</span><a href="#loc_133_4_133_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_4_133_5&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_133_6_133_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_6_133_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)




</span><span class="hl_comment"><span class="mpre">-- | @headerToChallenge base www_auth@ tries to convert the @WWW-Authenticate@ header </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @www_auth@  into a &#39;Challenge&#39; value.</span></span><span class="mpre">
</span><a href="#loc_141_1_141_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_18&#39;)"><span class="mpre">headerToChallenge</span></a><span class="mpre"> :: </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Challenge</span></span></a><span class="mpre">
</span><a name="loc_141_1_141_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_18&#39;)"><span class="hl_fundecl"><span class="mpre">headerToChallenge</span></span></a><span class="mpre"> </span><a name="loc_141_19_141_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_19_141_26&#39;)"><span class="hl_vardecl"><span class="mpre">baseURI</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Headers.html#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> _ </span><a name="loc_141_37_141_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_37_141_40&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">) =
    case </span><a href="Text.Parsec.Prim.html#loc_642_1_642_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_642_1_642_6&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="#loc_150_9_150_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_18&#39;)"><span class="hl_varref"><span class="mpre">challenge</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_141_37_141_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_37_141_40&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
        </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 9, srcSpanEndLine = 143, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 13, srcSpanEndLine = 143, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine"><span class="mpre">Left{}</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_144_16_144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_16_144_20&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">,</span><a name="loc_144_21_144_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_21_144_26&#39;)"><span class="hl_vardecl"><span class="mpre">props</span></span></a><span class="mpre">) -&gt; case </span><a href="#loc_144_16_144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_16_144_20&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> of
            </span><span class="hl_string"><span class="mpre">&quot;basic&quot;</span></span><span class="mpre">  -&gt; </span><a href="#loc_170_9_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_16&#39;)"><span class="hl_varref"><span class="mpre">mkBasic</span></span></a><span class="mpre"> </span><a href="#loc_144_21_144_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_21_144_26&#39;)"><span class="hl_varref"><span class="mpre">props</span></span></a><span class="mpre">
            </span><span class="hl_string"><span class="mpre">&quot;digest&quot;</span></span><span class="mpre"> -&gt; </span><a href="#loc_172_9_172_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_9_172_17&#39;)"><span class="hl_varref"><span class="mpre">mkDigest</span></span></a><span class="mpre"> </span><a href="#loc_144_21_144_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_21_144_26&#39;)"><span class="hl_varref"><span class="mpre">props</span></span></a><span class="mpre">
            _        -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    where
        </span><a href="#loc_150_9_150_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_18&#39;)"><span class="mpre">challenge</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,[(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)])
        </span><a name="loc_150_9_150_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_18&#39;)"><span class="hl_vardecl"><span class="mpre">challenge</span></span></a><span class="mpre"> =
            do { </span><a name="loc_151_18_151_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_18_151_21&#39;)"><span class="hl_vardecl"><span class="mpre">nme</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_221_1_221_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_5&#39;)"><span class="hl_varref"><span class="mpre">word</span></span></a><span class="mpre">
               ; </span><span class="hl_varref"><span class="mpre">spaces</span></span><span class="mpre">
               ; </span><a name="loc_153_18_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_18_153_21&#39;)"><span class="hl_vardecl"><span class="mpre">pps</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_157_9_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_15&#39;)"><span class="hl_varref"><span class="mpre">cprops</span></span></a><span class="mpre">
               ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_151_18_151_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_18_151_21&#39;)"><span class="hl_varref"><span class="mpre">nme</span></span></a><span class="mpre">,</span><a href="#loc_153_18_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_18_153_21&#39;)"><span class="hl_varref"><span class="mpre">pps</span></span></a><span class="mpre">)
               }

        </span><a name="loc_157_9_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_15&#39;)"><span class="hl_vardecl"><span class="mpre">cprops</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Combinator.html#loc_117_1_117_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_117_1_117_7&#39;)"><span class="hl_varref"><span class="mpre">sepBy1</span></span></a><span class="mpre"> </span><a href="#loc_161_9_161_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_14&#39;)"><span class="hl_varref"><span class="mpre">cprop</span></span></a><span class="mpre"> </span><a href="#loc_159_9_159_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_14&#39;)"><span class="hl_varref"><span class="mpre">comma</span></span></a><span class="mpre">

        </span><a name="loc_159_9_159_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_14&#39;)"><span class="hl_vardecl"><span class="mpre">comma</span></span></a><span class="mpre"> = do { </span><span class="hl_varref"><span class="mpre">spaces</span></span><span class="mpre"> ; _ &lt;- </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">spaces</span></span><span class="mpre"> }

        </span><a name="loc_161_9_161_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_14&#39;)"><span class="hl_vardecl"><span class="mpre">cprop</span></span></a><span class="mpre"> =
            do { </span><a name="loc_162_18_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_18_162_20&#39;)"><span class="hl_vardecl"><span class="mpre">nm</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_221_1_221_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_5&#39;)"><span class="hl_varref"><span class="mpre">word</span></span></a><span class="mpre">
               ; _ &lt;- </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre">
               ; </span><a name="loc_164_18_164_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_18_164_21&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_214_1_214_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_13&#39;)"><span class="hl_varref"><span class="mpre">quotedstring</span></span></a><span class="mpre">
               ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_162_18_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_18_162_20&#39;)"><span class="hl_varref"><span class="mpre">nm</span></span></a><span class="mpre">,</span><a href="#loc_164_18_164_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_18_164_21&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">)
               }

        </span><a href="#loc_170_9_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_16&#39;)"><span class="mpre">mkBasic</span></a><span class="mpre">, </span><a href="#loc_172_9_172_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_9_172_17&#39;)"><span class="mpre">mkDigest</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Challenge</span></span></a><span class="mpre">

        </span><a name="loc_170_9_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_16&#39;)"><span class="hl_fundecl"><span class="mpre">mkBasic</span></span></a><span class="mpre"> </span><a name="loc_170_17_170_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_17_170_23&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_59_4_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_4_59_13&#39;)"><span class="hl_conref"><span class="mpre">ChalBasic</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;realm&quot;</span></span><span class="mpre"> </span><a href="#loc_170_17_170_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_17_170_23&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">)

        </span><a name="loc_172_9_172_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_9_172_17&#39;)"><span class="hl_fundecl"><span class="mpre">mkDigest</span></span></a><span class="mpre"> </span><a name="loc_172_18_172_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_18_172_24&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre"> =
            </span><span class="hl_comment"><span class="mpre">-- with Maybe monad</span></span><span class="mpre">
            do { </span><span class="hl_vardecl"><span class="mpre">r</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;realm&quot;</span></span><span class="mpre"> </span><a href="#loc_172_18_172_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_18_172_24&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">
               ; </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;nonce&quot;</span></span><span class="mpre"> </span><a href="#loc_172_18_172_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_18_172_24&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">
               ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
                    </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 177, srcSpanStartColumn = 21, srcSpanEndLine = 189, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanStartLine = 177, srcSpanStartColumn = 32, srcSpanEndLine = 177, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Auth.hs&quot;, srcSpanSta"><span class="mpre">ChalDigest { chRealm  = r
                               , chDomain = (annotateURIs 
                                            $ map parseURI
                                            $ words 
                                            $ fromMaybe [] 
                                            $ lookup &quot;domain&quot; params)
                               , chNonce  = n
                               , chOpaque = lookup &quot;opaque&quot; params
                               , chStale  = &quot;true&quot; == (map toLower
                                           $ fromMaybe &quot;&quot; (lookup &quot;stale&quot; params))
                               , chAlgorithm= readAlgorithm (fromMaybe &quot;MD5&quot; $ lookup &quot;algorithm&quot; params)
                               , chQop    = readQop (fromMaybe &quot;&quot; $ lookup &quot;qop&quot; params)
                               }</span></span><span class="mpre">
               }

        </span><a href="#loc_194_9_194_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_21&#39;)"><span class="mpre">annotateURIs</span></a><span class="mpre"> :: [</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">] -&gt; [</span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">]
#if MIN_VERSION_network(2,4,0)
        </span><a name="loc_194_9_194_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_21&#39;)"><span class="hl_vardecl"><span class="mpre">annotateURIs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Network.URI.html#loc_1019_1_1019_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_1019_1_1019_11&#39;)"><span class="hl_infix"><span class="mpre">`relativeTo`</span></span></a><span class="mpre"> </span><a href="#loc_141_19_141_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_19_141_26&#39;)"><span class="hl_varref"><span class="mpre">baseURI</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre">
#else
        </span><span class="hl_vardecl"><span class="mpre">annotateURIs</span></span><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_196_31_196_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_31_196_32&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><a href="#loc_196_31_196_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_31_196_32&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> (</span><a href="#loc_196_31_196_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_31_196_32&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><a href="Network.URI.html#loc_1019_1_1019_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_1019_1_1019_11&#39;)"><span class="hl_infix"><span class="mpre">`relativeTo`</span></span></a><span class="mpre"> </span><a href="#loc_141_19_141_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_19_141_26&#39;)"><span class="hl_varref"><span class="mpre">baseURI</span></span></a><span class="mpre">))) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre">
#endif

        </span><span class="hl_comment"><span class="mpre">-- Change These:</span></span><span class="mpre">
        </span><a href="#loc_201_9_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_16&#39;)"><span class="mpre">readQop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><a href="#loc_78_6_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_6_78_9&#39;)"><span class="hl_tyconref"><span class="mpre">Qop</span></span></a><span class="mpre">]
        </span><a name="loc_201_9_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_16&#39;)"><span class="hl_vardecl"><span class="mpre">readQop</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_203_9_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_17&#39;)"><span class="hl_varref"><span class="mpre">strToQop</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="Network.HTTP.Utils.html#loc_77_1_77_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_77_1_77_8&#39;)"><span class="hl_varref"><span class="mpre">splitBy</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre">)

        </span><a name="loc_203_9_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_17&#39;)"><span class="hl_fundecl"><span class="mpre">strToQop</span></span></a><span class="mpre"> </span><a name="loc_203_18_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_20&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Utils.html#loc_58_1_58_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_58_1_58_5&#39;)"><span class="hl_varref"><span class="mpre">trim</span></span></a><span class="mpre"> </span><a href="#loc_203_18_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_20&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">) of
            </span><span class="hl_string"><span class="mpre">&quot;auth&quot;</span></span><span class="mpre">     -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_78_12_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_12_78_19&#39;)"><span class="hl_conref"><span class="mpre">QopAuth</span></span></a><span class="mpre">
            </span><span class="hl_string"><span class="mpre">&quot;auth-int&quot;</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_78_22_78_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_22_78_32&#39;)"><span class="hl_conref"><span class="mpre">QopAuthInt</span></span></a><span class="mpre">
            _          -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

        </span><span class="hl_fundecl"><span class="mpre">readAlgorithm</span></span><span class="mpre"> </span><a name="loc_208_23_208_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_23_208_27&#39;)"><span class="hl_vardecl"><span class="mpre">astr</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Utils.html#loc_58_1_58_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_58_1_58_5&#39;)"><span class="hl_varref"><span class="mpre">trim</span></span></a><span class="mpre"> </span><a href="#loc_208_23_208_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_23_208_27&#39;)"><span class="hl_varref"><span class="mpre">astr</span></span></a><span class="mpre">) of
            </span><span class="hl_string"><span class="mpre">&quot;md5&quot;</span></span><span class="mpre">      -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_70_18_70_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_24&#39;)"><span class="hl_conref"><span class="mpre">AlgMD5</span></span></a><span class="mpre">
            </span><span class="hl_string"><span class="mpre">&quot;md5-sess&quot;</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_70_27_70_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_27_70_37&#39;)"><span class="hl_conref"><span class="mpre">AlgMD5sess</span></span></a><span class="mpre">
            _          -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

</span><a href="#loc_221_1_221_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_5&#39;)"><span class="mpre">word</span></a><span class="mpre">, </span><a href="#loc_214_1_214_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_13&#39;)"><span class="mpre">quotedstring</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_214_1_214_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_13&#39;)"><span class="hl_vardecl"><span class="mpre">quotedstring</span></span></a><span class="mpre"> =
    do { _ &lt;- </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- &quot;</span></span><span class="mpre">
       ; </span><a name="loc_216_10_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_13&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">))
       ; _ &lt;- </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">
       ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_216_10_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_13&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
       }

</span><a name="loc_221_1_221_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_5&#39;)"><span class="hl_vardecl"><span class="mpre">word</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> (\</span><a name="loc_221_25_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_25_221_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Unicode.html#loc_136_1_136_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_136_1_136_11&#39;)"><span class="hl_varref"><span class="mpre">isAlphaNum</span></span></a><span class="mpre"> </span><a href="#loc_221_25_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_25_221_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_221_25_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_25_221_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_221_25_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_25_221_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_221_25_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_25_221_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_221_25_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_25_221_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">))
</span></div></body></html>