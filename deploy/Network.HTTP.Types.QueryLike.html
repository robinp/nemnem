<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE FlexibleInstances #-}
module Network.HTTP.Types.QueryLike
(
  QueryLike(..)
, QueryKeyLike(..)
, QueryValueLike(..)
)
where

import           Network.HTTP.Types.URI
import           Data.Maybe
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/QueryLike.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">        as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/QueryLike.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre">   as L
import qualified Data.Text              as T
import qualified Data.Text.Encoding     as T
import           Control.Arrow

</span><span class="hl_comment"><span class="mpre">-- | Types which can, and commonly are, converted to &#39;Query&#39; are in this class.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- You can use lists of simple key value pairs, with &#39;B.ByteString&#39; (strict, or lazy: </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;L.ByteString&#39;), &#39;T.Text&#39;, or &#39;String&#39; as the key/value types. You can also have the value</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- type lifted into a Maybe to support keys without values; and finally it is possible to put</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- each pair into a Maybe for key-value pairs that aren&#39;t always present.</span></span><span class="mpre">
class </span><a name="loc_24_7_24_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_7_24_16&#39;)"><span class="hl_classdecl"><span class="mpre">QueryLike</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
  </span><span class="hl_comment"><span class="mpre">-- | Convert to &#39;Query&#39;.</span></span><span class="mpre">
  </span><a name="loc_26_3_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_3_26_10&#39;)"><span class="mpre">toQuery</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Query</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Types which, in a Query-like key-value list, are used in the Key position.</span></span><span class="mpre">
class </span><a name="loc_29_7_29_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_7_29_19&#39;)"><span class="hl_classdecl"><span class="mpre">QueryKeyLike</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
  </span><a name="loc_30_3_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_3_30_13&#39;)"><span class="mpre">toQueryKey</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Types which, in a Query-like key-value list, are used in the Value position.</span></span><span class="mpre">
class </span><a name="loc_33_7_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_21&#39;)"><span class="hl_classdecl"><span class="mpre">QueryValueLike</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
  </span><a name="loc_34_3_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_15&#39;)"><span class="mpre">toQueryValue</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/QueryLike.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 10, srcSpanEndLine = 36, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/QueryLike.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 10, srcSpanEndLine = 36, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTT"><span class="mpre">(QueryKeyLike k, QueryValueLike v) =&gt;</span></span><span class="mpre"> </span><a href="#loc_24_7_24_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_7_24_16&#39;)"><span class="hl_classref"><span class="mpre">QueryLike</span></span></a><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)] where
  </span><a href="#loc_26_3_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_3_26_10&#39;)"><span class="hl_vardecl"><span class="mpre">toQuery</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_30_3_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_3_30_13&#39;)"><span class="hl_varref"><span class="mpre">toQueryKey</span></span></a><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><a href="#loc_34_3_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_15&#39;)"><span class="hl_varref"><span class="mpre">toQueryValue</span></span></a><span class="mpre">)

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/QueryLike.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 10, srcSpanEndLine = 39, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/QueryLike.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 10, srcSpanEndLine = 39, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTT"><span class="mpre">(QueryKeyLike k, QueryValueLike v) =&gt;</span></span><span class="mpre"> </span><a href="#loc_24_7_24_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_7_24_16&#39;)"><span class="hl_classref"><span class="mpre">QueryLike</span></span></a><span class="mpre"> [</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">)] where
  </span><a href="#loc_26_3_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_3_26_10&#39;)"><span class="hl_vardecl"><span class="mpre">toQuery</span></span></a><span class="mpre"> = </span><a href="#loc_26_3_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_3_26_10&#39;)"><span class="hl_varref"><span class="mpre">toQuery</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre">

instance </span><a href="#loc_29_7_29_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_7_29_19&#39;)"><span class="hl_classref"><span class="mpre">QueryKeyLike</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> where </span><a href="#loc_30_3_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_3_30_13&#39;)"><span class="hl_vardecl"><span class="mpre">toQueryKey</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
instance </span><a href="#loc_29_7_29_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_7_29_19&#39;)"><span class="hl_classref"><span class="mpre">QueryKeyLike</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> where </span><a href="#loc_30_3_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_3_30_13&#39;)"><span class="hl_vardecl"><span class="mpre">toQueryKey</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
instance </span><a href="#loc_29_7_29_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_7_29_19&#39;)"><span class="hl_classref"><span class="mpre">QueryKeyLike</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> where </span><a href="#loc_30_3_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_3_30_13&#39;)"><span class="hl_vardecl"><span class="mpre">toQueryKey</span></span></a><span class="mpre"> = </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre">
instance </span><a href="#loc_29_7_29_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_7_29_19&#39;)"><span class="hl_classref"><span class="mpre">QueryKeyLike</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] where </span><a href="#loc_30_3_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_3_30_13&#39;)"><span class="hl_vardecl"><span class="mpre">toQueryKey</span></span></a><span class="mpre"> = </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_387_1_387_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_387_1_387_5&#39;)"><span class="hl_varref"><span class="mpre">T.pack</span></span></a><span class="mpre">

instance </span><a href="#loc_33_7_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_21&#39;)"><span class="hl_classref"><span class="mpre">QueryValueLike</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> where </span><a href="#loc_34_3_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_15&#39;)"><span class="hl_vardecl"><span class="mpre">toQueryValue</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre">
instance </span><a href="#loc_33_7_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_21&#39;)"><span class="hl_classref"><span class="mpre">QueryValueLike</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> where </span><a href="#loc_34_3_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_15&#39;)"><span class="hl_vardecl"><span class="mpre">toQueryValue</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
instance </span><a href="#loc_33_7_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_21&#39;)"><span class="hl_classref"><span class="mpre">QueryValueLike</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> where </span><a href="#loc_34_3_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_15&#39;)"><span class="hl_vardecl"><span class="mpre">toQueryValue</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre">
instance </span><a href="#loc_33_7_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_21&#39;)"><span class="hl_classref"><span class="mpre">QueryValueLike</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] where </span><a href="#loc_34_3_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_15&#39;)"><span class="hl_vardecl"><span class="mpre">toQueryValue</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_387_1_387_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_387_1_387_5&#39;)"><span class="hl_varref"><span class="mpre">T.pack</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/QueryLike.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 10, srcSpanEndLine = 52, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/QueryLike.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 27, srcSpanEndLine = 52, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/"><span class="mpre">QueryValueLike a =&gt;</span></span><span class="mpre"> </span><a href="#loc_33_7_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_21&#39;)"><span class="hl_classref"><span class="mpre">QueryValueLike</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
  </span><a href="#loc_34_3_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_15&#39;)"><span class="hl_vardecl"><span class="mpre">toQueryValue</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_34_3_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_15&#39;)"><span class="hl_varref"><span class="mpre">toQueryValue</span></span></a></div></body></html>