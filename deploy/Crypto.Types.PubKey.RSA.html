<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE DeriveDataTypeable #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Types.PubKey.RSA</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : Stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Excellent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Types.PubKey.RSA
    ( PublicKey(..)
    , PrivateKey(..)
    , KeyPair(..)
    , private_size
    , private_n
    , toPublicKey
    , toPrivateKey
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 8, srcSpanEndLine = 19, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
import Data.ASN1.Types
import Data.Bits (</span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_90_5_90_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_90_5_90_15&#39;)"><span class="mpre">complement</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="mpre">testBit</span></a><span class="mpre">, (.&amp;.))
import Data.Word (Word8)

</span><span class="hl_comment"><span class="mpre">-- | Represent a RSA public key</span></span><span class="mpre">
data </span><a name="loc_25_6_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_15&#39;)"><span class="hl_tycondecl"><span class="mpre">PublicKey</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">PublicKey</span></span><span class="mpre">
    { </span><a name="loc_26_7_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_18&#39;)"><span class="hl_fielddecl"><span class="mpre">public_size</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ size of key in bytes</span></span><span class="mpre">
    , </span><a name="loc_27_7_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_15&#39;)"><span class="hl_fielddecl"><span class="mpre">public_n</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ public p*q</span></span><span class="mpre">
    , </span><a name="loc_28_7_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_7_28_15&#39;)"><span class="hl_fielddecl"><span class="mpre">public_e</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ public exponant e</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 7, srcSpanEndLine = 29, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 7, srcSpanEndLine = 29, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-typ"><span class="mpre">deriving (Show,Read,Eq,Data,Typeable)</span></span><span class="mpre">

instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a name="loc_32_12_32_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_18&#39;)"><span class="hl_vardecl"><span class="mpre">pubKey</span></span></a><span class="mpre"> = \</span><a name="loc_32_22_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_22_32_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
                         </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_27_7_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_15&#39;)"><span class="hl_varref"><span class="mpre">public_n</span></span></a><span class="mpre"> </span><a href="#loc_32_12_32_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_18&#39;)"><span class="hl_varref"><span class="mpre">pubKey</span></span></a><span class="mpre">)
                         </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_28_7_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_7_28_15&#39;)"><span class="hl_varref"><span class="mpre">public_e</span></span></a><span class="mpre"> </span><a href="#loc_32_12_32_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_18&#39;)"><span class="hl_varref"><span class="mpre">pubKey</span></span></a><span class="mpre">)
                         </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
                         </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_32_22_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_22_32_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><a name="loc_37_37_37_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_37_37_45&#39;)"><span class="hl_vardecl"><span class="mpre">smodulus</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">pubexp</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_37_73_37_75" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_73_37_75&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) =
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 16, srcSpanEndLine = 41, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 26, srcSpanEndLine = 38, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-"><span class="mpre">PublicKey { public_size = calculate_modulus modulus 1
                         , public_n    = modulus
                         , public_e    = pubexp
                         }</span></span><span class="mpre">
              , </span><a href="#loc_37_73_37_75" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_73_37_75&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        where </span><a name="loc_43_15_43_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_15_43_32&#39;)"><span class="hl_fundecl"><span class="mpre">calculate_modulus</span></span></a><span class="mpre"> </span><a name="loc_43_33_43_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_33_43_34&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_43_35_43_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_35_43_36&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = if (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre"> (</span><a href="#loc_43_35_43_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_35_43_36&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_43_33_43_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_33_43_34&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> then </span><a href="#loc_43_35_43_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_35_43_36&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> else </span><a href="#loc_43_15_43_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_15_43_32&#39;)"><span class="hl_varref"><span class="mpre">calculate_modulus</span></span></a><span class="mpre"> </span><a href="#loc_43_33_43_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_33_43_34&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_43_35_43_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_35_43_36&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
              </span><span class="hl_comment"><span class="mpre">-- some bad implementation will not serialize ASN.1 integer properly, leading</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- to negative modulus. if that&#39;s the case, we correct it.</span></span><span class="mpre">
              </span><span class="hl_vardecl"><span class="mpre">modulus</span></span><span class="mpre"> = </span><a href="#loc_140_1_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_11&#39;)"><span class="hl_varref"><span class="mpre">toPositive</span></span></a><span class="mpre"> </span><a href="#loc_37_37_37_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_37_37_45&#39;)"><span class="hl_varref"><span class="mpre">smodulus</span></span></a><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> _ =
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;fromASN1: RSA.PublicKey: unexpected format&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Represent a RSA private key.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Only the pub, d fields are mandatory to fill.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- p, q, dP, dQ, qinv are by-product during RSA generation,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- but are useful to record here to speed up massively</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the decrypt and sign operation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- implementations can leave optional fields to 0.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_60_6_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_6_60_16&#39;)"><span class="hl_tycondecl"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">PrivateKey</span></span><span class="mpre">
    { </span><a name="loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_fielddecl"><span class="mpre">private_pub</span></span></a><span class="mpre">  :: </span><a href="#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ public part of a private key (size, n and e)</span></span><span class="mpre">
    , </span><a name="loc_62_7_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_16&#39;)"><span class="hl_fielddecl"><span class="mpre">private_d</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ private exponant d</span></span><span class="mpre">
    , </span><a name="loc_63_7_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_16&#39;)"><span class="hl_fielddecl"><span class="mpre">private_p</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ p prime number</span></span><span class="mpre">
    , </span><a name="loc_64_7_64_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_16&#39;)"><span class="hl_fielddecl"><span class="mpre">private_q</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ q prime number</span></span><span class="mpre">
    , </span><a name="loc_65_7_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_17&#39;)"><span class="hl_fielddecl"><span class="mpre">private_dP</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ d mod (p-1)</span></span><span class="mpre">
    , </span><a name="loc_66_7_66_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_17&#39;)"><span class="hl_fielddecl"><span class="mpre">private_dQ</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ d mod (q-1)</span></span><span class="mpre">
    , </span><a name="loc_67_7_67_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_7_67_19&#39;)"><span class="hl_fielddecl"><span class="mpre">private_qinv</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ q^(-1) mod p</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 7, srcSpanEndLine = 68, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 7, srcSpanEndLine = 68, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-typ"><span class="mpre">deriving (Show,Read,Eq,Data,Typeable)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | get the size in bytes from a private key</span></span><span class="mpre">
</span><a name="loc_71_1_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_13&#39;)"><span class="hl_vardecl"><span class="mpre">private_size</span></span></a><span class="mpre"> = </span><a href="#loc_26_7_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_18&#39;)"><span class="hl_varref"><span class="mpre">public_size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">private_pub</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | get n from a private key</span></span><span class="mpre">
</span><a name="loc_74_1_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_10&#39;)"><span class="hl_vardecl"><span class="mpre">private_n</span></span></a><span class="mpre">    = </span><a href="#loc_27_7_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_15&#39;)"><span class="hl_varref"><span class="mpre">public_n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">private_pub</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | get e from a private key</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">private_e</span></span><span class="mpre">    = </span><a href="#loc_28_7_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_7_28_15&#39;)"><span class="hl_varref"><span class="mpre">public_e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">private_pub</span></span></a><span class="mpre">

instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a name="loc_80_12_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_12_80_19&#39;)"><span class="hl_vardecl"><span class="mpre">privKey</span></span></a><span class="mpre"> = \</span><a name="loc_80_23_80_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_23_80_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_27_7_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_15&#39;)"><span class="hl_varref"><span class="mpre">public_n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">private_pub</span></span></a><span class="mpre"> </span><a href="#loc_80_12_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_12_80_19&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">)
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_28_7_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_7_28_15&#39;)"><span class="hl_varref"><span class="mpre">public_e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">private_pub</span></span></a><span class="mpre"> </span><a href="#loc_80_12_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_12_80_19&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">)
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_62_7_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_16&#39;)"><span class="hl_varref"><span class="mpre">private_d</span></span></a><span class="mpre"> </span><a href="#loc_80_12_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_12_80_19&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">)
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_63_7_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_16&#39;)"><span class="hl_varref"><span class="mpre">private_p</span></span></a><span class="mpre"> </span><a href="#loc_80_12_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_12_80_19&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">)
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_64_7_64_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_16&#39;)"><span class="hl_varref"><span class="mpre">private_q</span></span></a><span class="mpre"> </span><a href="#loc_80_12_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_12_80_19&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">)
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_65_7_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_17&#39;)"><span class="hl_varref"><span class="mpre">private_dP</span></span></a><span class="mpre"> </span><a href="#loc_80_12_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_12_80_19&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">)
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_66_7_66_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_17&#39;)"><span class="hl_varref"><span class="mpre">private_dQ</span></span></a><span class="mpre"> </span><a href="#loc_80_12_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_12_80_19&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">)
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_67_7_67_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_7_67_19&#39;)"><span class="hl_varref"><span class="mpre">private_qinv</span></span></a><span class="mpre"> </span><a href="#loc_80_12_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_12_80_19&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">)
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
                          </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_80_23_80_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_23_80_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">e</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">d</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p1</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p2</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">pexp1</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">pexp2</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">pcoef</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_103_16_103_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_16_103_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_105_15_105_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_15_105_22&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">, </span><a href="#loc_103_16_103_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_16_103_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        where </span><a name="loc_104_15_104_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_15_104_32&#39;)"><span class="hl_fundecl"><span class="mpre">calculate_modulus</span></span></a><span class="mpre"> </span><a name="loc_104_33_104_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_33_104_34&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_104_35_104_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_35_104_36&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = if (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre"> (</span><a href="#loc_104_35_104_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_35_104_36&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_104_33_104_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_33_104_34&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> then </span><a href="#loc_104_35_104_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_35_104_36&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> else </span><a href="#loc_104_15_104_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_15_104_32&#39;)"><span class="hl_varref"><span class="mpre">calculate_modulus</span></span></a><span class="mpre"> </span><a href="#loc_104_33_104_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_33_104_34&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_104_35_104_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_35_104_36&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
              </span><a name="loc_105_15_105_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_15_105_22&#39;)"><span class="hl_vardecl"><span class="mpre">privKey</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 25, srcSpanEndLine = 116, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 25, srcSpanEndLine = 106, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pub"><span class="mpre">PrivateKey
                        { private_pub  = PublicKey { public_size = calculate_modulus n 1
                                                   , public_n    = n
                                                   , public_e    = e
                                                   }
                        , private_d    = d
                        , private_p    = p1
                        , private_q    = p2
                        , private_dP   = pexp1
                        , private_dQ   = pexp2
                        , private_qinv = pcoef
                        }</span></span><span class="mpre">

    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> _ =
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;fromASN1: RSA.PrivateKey: unexpected format&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Represent RSA KeyPair</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- note the RSA private key contains already an instance of public key for efficiency</span></span><span class="mpre">
newtype </span><a name="loc_124_9_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_9_124_16&#39;)"><span class="hl_tycondecl"><span class="mpre">KeyPair</span></span></a><span class="mpre"> = </span><a name="loc_124_19_124_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_26&#39;)"><span class="hl_condecl"><span class="mpre">KeyPair</span></span></a><span class="mpre"> </span><a href="#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 125, srcSpanStartColumn = 5, srcSpanEndLine = 125, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/RSA.hs&quot;, srcSpanStartLine = 125, srcSpanStartColumn = 5, srcSpanEndLine = 125, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey"><span class="mpre">deriving (Show,Read,Eq,Data,Typeable)</span></span><span class="mpre">

instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_124_9_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_9_124_16&#39;)"><span class="hl_tyconref"><span class="mpre">KeyPair</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_124_19_124_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_26&#39;)"><span class="hl_conref"><span class="mpre">KeyPair</span></span></a><span class="mpre"> </span><a name="loc_128_21_128_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_21_128_25&#39;)"><span class="hl_vardecl"><span class="mpre">pkey</span></span></a><span class="mpre">) = </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a href="#loc_128_21_128_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_21_128_25&#39;)"><span class="hl_varref"><span class="mpre">pkey</span></span></a><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_vardecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (\(</span><a name="loc_129_31_129_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_31_129_32&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">,</span><a name="loc_129_33_129_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_33_129_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_124_19_124_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_26&#39;)"><span class="hl_conref"><span class="mpre">KeyPair</span></span></a><span class="mpre"> </span><a href="#loc_129_31_129_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_31_129_32&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">, </span><a href="#loc_129_33_129_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_33_129_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_varref"><span class="mpre">fromASN1</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Public key of a RSA KeyPair</span></span><span class="mpre">
</span><a href="#loc_133_1_133_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_12&#39;)"><span class="mpre">toPublicKey</span></a><span class="mpre"> :: </span><a href="#loc_124_9_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_9_124_16&#39;)"><span class="hl_tyconref"><span class="mpre">KeyPair</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre">
</span><a name="loc_133_1_133_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_12&#39;)"><span class="hl_fundecl"><span class="mpre">toPublicKey</span></span></a><span class="mpre"> (</span><a href="#loc_124_19_124_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_26&#39;)"><span class="hl_conref"><span class="mpre">KeyPair</span></span></a><span class="mpre"> </span><a name="loc_133_22_133_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_22_133_26&#39;)"><span class="hl_vardecl"><span class="mpre">priv</span></span></a><span class="mpre">) = </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">private_pub</span></span></a><span class="mpre"> </span><a href="#loc_133_22_133_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_22_133_26&#39;)"><span class="hl_varref"><span class="mpre">priv</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Private key of a RSA KeyPair</span></span><span class="mpre">
</span><a href="#loc_137_1_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_13&#39;)"><span class="mpre">toPrivateKey</span></a><span class="mpre"> :: </span><a href="#loc_124_9_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_9_124_16&#39;)"><span class="hl_tyconref"><span class="mpre">KeyPair</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre">
</span><a name="loc_137_1_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_13&#39;)"><span class="hl_fundecl"><span class="mpre">toPrivateKey</span></span></a><span class="mpre"> (</span><a href="#loc_124_19_124_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_26&#39;)"><span class="hl_conref"><span class="mpre">KeyPair</span></span></a><span class="mpre"> </span><a name="loc_137_23_137_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_23_137_27&#39;)"><span class="hl_vardecl"><span class="mpre">priv</span></span></a><span class="mpre">) = </span><a href="#loc_137_23_137_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_23_137_27&#39;)"><span class="hl_varref"><span class="mpre">priv</span></span></a><span class="mpre">

</span><a href="#loc_140_1_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_11&#39;)"><span class="mpre">toPositive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_140_1_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_11&#39;)"><span class="hl_fundecl"><span class="mpre">toPositive</span></span></a><span class="mpre"> </span><a name="loc_140_12_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_15&#39;)"><span class="hl_vardecl"><span class="mpre">int</span></span></a><span class="mpre">
    | </span><a href="#loc_140_12_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_15&#39;)"><span class="hl_varref"><span class="mpre">int</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">   = </span><a href="#loc_143_9_143_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_20&#39;)"><span class="hl_varref"><span class="mpre">uintOfBytes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_145_9_145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_19&#39;)"><span class="hl_varref"><span class="mpre">bytesOfInt</span></span></a><span class="mpre"> </span><a href="#loc_140_12_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_15&#39;)"><span class="hl_varref"><span class="mpre">int</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_140_12_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_12_140_15&#39;)"><span class="hl_varref"><span class="mpre">int</span></span></a><span class="mpre">
  where </span><a name="loc_143_9_143_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_20&#39;)"><span class="hl_vardecl"><span class="mpre">uintOfBytes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> (\</span><a name="loc_143_31_143_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_31_143_34&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_143_35_143_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_35_143_36&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_143_31_143_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_31_143_34&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_143_35_143_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_35_143_36&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        </span><a href="#loc_145_9_145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_19&#39;)"><span class="mpre">bytesOfInt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
        </span><a name="loc_145_9_145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_19&#39;)"><span class="hl_fundecl"><span class="mpre">bytesOfInt</span></span></a><span class="mpre"> </span><a name="loc_145_20_145_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_20_145_21&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = if </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">testBit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_146_17_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_17_146_22&#39;)"><span class="hl_varref"><span class="mpre">nints</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> then </span><a href="#loc_146_17_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_17_146_22&#39;)"><span class="hl_varref"><span class="mpre">nints</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_146_17_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_17_146_22&#39;)"><span class="hl_varref"><span class="mpre">nints</span></span></a><span class="mpre">
          where </span><a name="loc_146_17_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_17_146_22&#39;)"><span class="hl_vardecl"><span class="mpre">nints</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_147_17_147_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_17_147_24&#39;)"><span class="hl_varref"><span class="mpre">plusOne</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.Bits.html#loc_90_5_90_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_90_5_90_15&#39;)"><span class="hl_varref"><span class="mpre">complement</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_149_17_149_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_17_149_28&#39;)"><span class="hl_varref"><span class="mpre">bytesOfUInt</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_145_20_145_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_20_145_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
                </span><a name="loc_147_17_147_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_17_147_24&#39;)"><span class="hl_fundecl"><span class="mpre">plusOne</span></span></a><span class="mpre"> []     = [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">]
                </span><a href="#loc_147_17_147_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_17_147_24&#39;)"><span class="hl_fundecl"><span class="mpre">plusOne</span></span></a><span class="mpre"> (</span><a name="loc_148_26_148_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_26_148_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_148_28_148_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_28_148_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = if </span><a href="#loc_148_26_148_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_26_148_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_147_17_147_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_17_147_24&#39;)"><span class="hl_varref"><span class="mpre">plusOne</span></span></a><span class="mpre"> </span><a href="#loc_148_28_148_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_28_148_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> else (</span><a href="#loc_148_26_148_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_26_148_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_148_28_148_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_28_148_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
                </span><a name="loc_149_17_149_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_17_149_28&#39;)"><span class="hl_fundecl"><span class="mpre">bytesOfUInt</span></span></a><span class="mpre"> </span><a name="loc_149_29_149_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_29_149_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> (</span><a href="#loc_150_25_150_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_25_150_29&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> </span><a href="#loc_149_29_149_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_29_149_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                  where </span><a name="loc_150_25_150_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_25_150_29&#39;)"><span class="hl_fundecl"><span class="mpre">list</span></span></a><span class="mpre"> </span><a name="loc_150_30_150_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_30_150_31&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = if </span><a href="#loc_150_30_150_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_30_150_31&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre"> then [</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_150_30_150_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_30_150_31&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">] else (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_150_30_150_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_30_150_31&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_150_25_150_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_25_150_29&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> (</span><a href="#loc_150_30_150_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_30_150_31&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)
</span></div></body></html>