<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ScopedTypeVariables #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Network.HTTP.Base</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  See LICENSE file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Ganesh Sittampalam &lt;ganesh@earth.li&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (not tested)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Definitions of @Request@ and @Response@ types along with functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for normalizing them. It is assumed to be an internal module; user</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- code should, if possible, import @Network.HTTP@ to access the functionality</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that this module provides.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Additionally, the module exports internal functions for working with URLs,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and for handling the processing of requests and responses coming back.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
module Network.HTTP.Base
       (
          </span><span class="hl_comment"><span class="mpre">-- ** Constants</span></span><span class="mpre">
         httpVersion                 </span><span class="hl_comment"><span class="mpre">-- :: String</span></span><span class="mpre">

          </span><span class="hl_comment"><span class="mpre">-- ** HTTP</span></span><span class="mpre">
       , Request(..)
       , Response(..)
       , RequestMethod(..)
       
       , Request_String
       , Response_String
       , HTTPRequest
       , HTTPResponse
       
          </span><span class="hl_comment"><span class="mpre">-- ** URL Encoding</span></span><span class="mpre">
       , urlEncode
       , urlDecode
       , urlEncodeVars

          </span><span class="hl_comment"><span class="mpre">-- ** URI authority parsing</span></span><span class="mpre">
       , URIAuthority(..)
       , parseURIAuthority
       
          </span><span class="hl_comment"><span class="mpre">-- internal</span></span><span class="mpre">
       , uriToAuthorityString   </span><span class="hl_comment"><span class="mpre">-- :: URI     -&gt; String</span></span><span class="mpre">
       , uriAuthToString        </span><span class="hl_comment"><span class="mpre">-- :: URIAuth -&gt; String</span></span><span class="mpre">
       , uriAuthPort            </span><span class="hl_comment"><span class="mpre">-- :: Maybe URI -&gt; URIAuth -&gt; Int</span></span><span class="mpre">
       , reqURIAuth             </span><span class="hl_comment"><span class="mpre">-- :: Request ty -&gt; URIAuth</span></span><span class="mpre">

       , parseResponseHead      </span><span class="hl_comment"><span class="mpre">-- :: [String] -&gt; Result ResponseData</span></span><span class="mpre">
       , parseRequestHead       </span><span class="hl_comment"><span class="mpre">-- :: [String] -&gt; Result RequestData</span></span><span class="mpre">

       , ResponseNextStep(..)
       , matchResponse
       , ResponseData
       , ResponseCode
       , RequestData
       
       , NormalizeRequestOptions(..) 
       , defaultNormalizeRequestOptions </span><span class="hl_comment"><span class="mpre">-- :: NormalizeRequestOptions ty</span></span><span class="mpre">
       , RequestNormalizer

       , normalizeRequest   </span><span class="hl_comment"><span class="mpre">-- :: NormalizeRequestOptions ty -&gt; Request ty -&gt; Request ty</span></span><span class="mpre">

       , splitRequestURI

       , getAuth
       , normalizeRequestURI
       , normalizeHostHeader
       , findConnClose

         </span><span class="hl_comment"><span class="mpre">-- internal export (for the use by Network.HTTP.{Stream,ByteStream} )</span></span><span class="mpre">
       , linearTransfer
       , hopefulTransfer
       , chunkedTransfer
       , uglyDeathTransfer
       , readTillEmpty1
       , readTillEmpty2
       
       , defaultGETRequest
       , defaultGETRequest_
       , mkRequest
       , setRequestBody

       , defaultUserAgent
       , httpPackageVersion
       , libUA  </span><span class="hl_comment"><span class="mpre">{- backwards compatibility, will disappear..soon -}</span></span><span class="mpre">
       
       , catchIO
       , catchIO_
       , responseParseError
       
       , getRequestVersion
       , getResponseVersion
       , setRequestVersion
       , setResponseVersion

       , failHTTPS
       
       ) where

import Network.URI
   ( </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="mpre">URI</span></a><span class="mpre">(</span><a href="Network.URI.html#loc_155_7_155_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_155_7_155_19&#39;)"><span class="mpre">uriAuthority</span></a><span class="mpre">, </span><a href="Network.URI.html#loc_156_7_156_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_156_7_156_14&#39;)"><span class="mpre">uriPath</span></a><span class="mpre">, </span><a href="Network.URI.html#loc_154_7_154_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_154_7_154_16&#39;)"><span class="mpre">uriScheme</span></a><span class="mpre">)
   , </span><a href="Network.URI.html#loc_162_6_162_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_162_6_162_13&#39;)"><span class="mpre">URIAuth</span></a><span class="mpre">(URIAuth, </span><a href="Network.URI.html#loc_163_7_163_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_163_7_163_18&#39;)"><span class="mpre">uriUserInfo</span></a><span class="mpre">, </span><a href="Network.URI.html#loc_164_7_164_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_164_7_164_17&#39;)"><span class="mpre">uriRegName</span></a><span class="mpre">, </span><a href="Network.URI.html#loc_165_7_165_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_165_7_165_14&#39;)"><span class="mpre">uriPort</span></a><span class="mpre">)
   , </span><a href="Network.URI.html#loc_232_1_232_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_232_1_232_18&#39;)"><span class="mpre">parseURIReference</span></a><span class="mpre">
   )

import Control.Monad ( </span><a href="Control.Monad.html#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_148_1_148_6&#39;)"><span class="mpre">guard</span></a><span class="mpre"> )
import Control.Monad.Error ()
import Data.Bits     ( (.&amp;.), (.|.), </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre"> )
import Data.Word     ( Word8 )
import Data.Char     ( </span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="mpre">digitToInt</span></a><span class="mpre">, intToDigit, </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="mpre">isDigit</span></a><span class="mpre">,
                       </span><a href="GHC.Unicode.html#loc_41_1_41_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_41_1_41_8&#39;)"><span class="mpre">isAscii</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_136_1_136_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_136_1_136_11&#39;)"><span class="mpre">isAlphaNum</span></a><span class="mpre">, ord, </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="mpre">chr</span></a><span class="mpre"> )
import Data.List     ( </span><a href="Data.List.html#loc_464_1_464_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_464_1_464_10&#39;)"><span class="mpre">partition</span></a><span class="mpre">, </span><a href="Data.List.html#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_261_1_261_5&#39;)"><span class="mpre">find</span></a><span class="mpre"> )
import Data.Maybe    ( </span><a href="Data.Maybe.html#loc_109_1_109_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_109_1_109_12&#39;)"><span class="mpre">listToMaybe</span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="mpre">fromMaybe</span></a><span class="mpre"> )
import Numeric       ( </span><a href="Numeric.html#loc_94_1_94_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Numeric.html#loc_94_1_94_8&#39;)"><span class="mpre">readHex</span></a><span class="mpre"> )

import Network.Stream
import Network.BufferType ( </span><a href="Network.BufferType.html#loc_71_6_71_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_71_6_71_14&#39;)"><span class="mpre">BufferOp</span></a><span class="mpre">(..), </span><a href="Network.BufferType.html#loc_48_7_48_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_48_7_48_17&#39;)"><span class="mpre">BufferType</span></a><span class="mpre">(..) )
import Network.HTTP.Headers
import Network.HTTP.Utils ( </span><a href="Network.HTTP.Utils.html#loc_58_1_58_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_58_1_58_5&#39;)"><span class="mpre">trim</span></a><span class="mpre">, </span><a href="Network.HTTP.Utils.html#loc_38_1_38_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_38_1_38_5&#39;)"><span class="mpre">crlf</span></a><span class="mpre">, </span><a href="Network.HTTP.Utils.html#loc_46_1_46_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_46_1_46_3&#39;)"><span class="mpre">sp</span></a><span class="mpre">, </span><a href="Network.HTTP.Utils.html#loc_87_1_87_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_87_1_87_9&#39;)"><span class="mpre">readsOne</span></a><span class="mpre"> )
import qualified Network.HTTP.Base64 as Base64 (</span><a href="Network.HTTP.Base64.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base64.html#loc_270_1_270_7&#39;)"><span class="mpre">encode</span></a><span class="mpre">)

import Text.Read.Lex (</span><a href="Text.Read.Lex.html#loc_509_1_509_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.Lex.html#loc_509_1_509_9&#39;)"><span class="mpre">readDecP</span></a><span class="mpre">)
import Text.ParserCombinators.ReadP
   ( </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="mpre">ReadP</span></a><span class="mpre">, </span><a href="Text.ParserCombinators.ReadP.html#loc_396_1_396_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_396_1_396_11&#39;)"><span class="mpre">readP_to_S</span></a><span class="mpre">, </span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="mpre">char</span></a><span class="mpre">, </span><a href="Text.ParserCombinators.ReadP.html#loc_204_6_204_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_204_6_204_9&#39;)"><span class="mpre">(&lt;++)</span></a><span class="mpre">, </span><a href="Text.ParserCombinators.ReadP.html#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_190_1_190_5&#39;)"><span class="mpre">look</span></a><span class="mpre">, </span><a href="Text.ParserCombinators.ReadP.html#loc_262_1_262_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_262_1_262_6&#39;)"><span class="mpre">munch</span></a><span class="mpre">, </span><a href="Text.ParserCombinators.ReadP.html#loc_273_1_273_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_273_1_273_7&#39;)"><span class="mpre">munch1</span></a><span class="mpre"> )

import Control.Exception as Exception (</span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="mpre">catch</span></a><span class="mpre">, </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="mpre">IOException</span></a><span class="mpre">)

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 131, srcSpanStartColumn = 18, srcSpanEndLine = 131, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Paths_HTTP&quot;"><span class="mpre">Paths_HTTP</span></span><span class="mpre"> as Self (version)
import Data.Version (</span><a href="Data.Version.html#loc_106_1_106_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_106_1_106_12&#39;)"><span class="mpre">showVersion</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------ URI Authority parsing ------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_138_6_138_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_18&#39;)"><span class="hl_tycondecl"><span class="mpre">URIAuthority</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">URIAuthority</span></span><span class="mpre"> { </span><a name="loc_138_36_138_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_36_138_40&#39;)"><span class="hl_fielddecl"><span class="mpre">user</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, 
                                   </span><a name="loc_139_36_139_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_36_139_44&#39;)"><span class="hl_fielddecl"><span class="mpre">password</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,
                                   </span><a name="loc_140_36_140_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_36_140_40&#39;)"><span class="hl_fielddecl"><span class="mpre">host</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,
                                   </span><a name="loc_141_36_141_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_36_141_40&#39;)"><span class="hl_fielddecl"><span class="mpre">port</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
                                 } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 142, srcSpanStartColumn = 36, srcSpanEndLine = 142, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 142, srcSpanStartColumn = 36, srcSpanEndLine = 142, srcSpanEndColumn = 44},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStar"><span class="mpre">deriving (Eq,Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Parse the authority part of a URL.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; RFC 1732, section 3.1:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;       //&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;url-path&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;  Some or all of the parts &quot;&lt;user&gt;:&lt;password&gt;@&quot;, &quot;:&lt;password&gt;&quot;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;  &quot;:&lt;port&gt;&quot;, and &quot;/&lt;url-path&gt;&quot; may be excluded.</span></span><span class="mpre">
</span><a href="#loc_152_1_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_18&#39;)"><span class="mpre">parseURIAuthority</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_138_6_138_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_18&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuthority</span></span></a><span class="mpre">
</span><a name="loc_152_1_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_18&#39;)"><span class="hl_fundecl"><span class="mpre">parseURIAuthority</span></span></a><span class="mpre"> </span><a name="loc_152_19_152_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_19_152_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_109_1_109_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_109_1_109_12&#39;)"><span class="hl_varref"><span class="mpre">listToMaybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> (</span><a href="Text.ParserCombinators.ReadP.html#loc_396_1_396_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_396_1_396_11&#39;)"><span class="hl_varref"><span class="mpre">readP_to_S</span></span></a><span class="mpre"> </span><a href="#loc_156_1_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_14&#39;)"><span class="hl_varref"><span class="mpre">pURIAuthority</span></span></a><span class="mpre"> </span><a href="#loc_152_19_152_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_19_152_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))


</span><a href="#loc_156_1_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_14&#39;)"><span class="mpre">pURIAuthority</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><a href="#loc_138_6_138_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_18&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuthority</span></span></a><span class="mpre">
</span><a name="loc_156_1_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_14&#39;)"><span class="hl_vardecl"><span class="mpre">pURIAuthority</span></span></a><span class="mpre"> = do
                (</span><span class="hl_vardecl"><span class="mpre">u</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">pw</span></span><span class="mpre">) &lt;- (</span><a href="#loc_173_1_173_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_10&#39;)"><span class="hl_varref"><span class="mpre">pUserInfo</span></span></a><span class="mpre"> </span><a href="#loc_179_1_179_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_7&#39;)"><span class="hl_infix"><span class="mpre">`before`</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;@&#39;</span></span><span class="mpre">) 
                          </span><a href="Text.ParserCombinators.ReadP.html#loc_204_6_204_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_204_6_204_9&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)
                </span><span class="hl_vardecl"><span class="mpre">h</span></span><span class="mpre"> &lt;- </span><a href="#loc_166_1_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_12&#39;)"><span class="hl_varref"><span class="mpre">rfc2732host</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.ReadP.html#loc_204_6_204_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_204_6_204_9&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.ReadP.html#loc_262_1_262_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_262_1_262_6&#39;)"><span class="hl_varref"><span class="mpre">munch</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">)
                </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> &lt;- </span><a href="#loc_182_1_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_10&#39;)"><span class="hl_varref"><span class="mpre">orNothing</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Text.Read.Lex.html#loc_509_1_509_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.Lex.html#loc_509_1_509_9&#39;)"><span class="hl_varref"><span class="mpre">readDecP</span></span></a><span class="mpre">)
                </span><a href="Text.ParserCombinators.ReadP.html#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_190_1_190_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_148_1_148_6&#39;)"><span class="hl_varref"><span class="mpre">guard</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> 
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 24, srcSpanEndLine = 162, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 36, srcSpanEndLine = 162, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">URIAuthority{ user=u, password=pw, host=h, port=p }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- RFC2732 adds support for &#39;[literal-ipv6-address]&#39; in the host part of a URL</span></span><span class="mpre">
</span><a href="#loc_166_1_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_12&#39;)"><span class="mpre">rfc2732host</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_166_1_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_12&#39;)"><span class="hl_vardecl"><span class="mpre">rfc2732host</span></span></a><span class="mpre"> = do
    _ &lt;- </span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="mpre">
    </span><a name="loc_168_5_168_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_8&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="Text.ParserCombinators.ReadP.html#loc_273_1_273_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_273_1_273_7&#39;)"><span class="hl_varref"><span class="mpre">munch1</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre">)
    _ &lt;- </span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_168_5_168_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

</span><a href="#loc_173_1_173_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_10&#39;)"><span class="mpre">pUserInfo</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_173_1_173_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_10&#39;)"><span class="hl_vardecl"><span class="mpre">pUserInfo</span></span></a><span class="mpre"> = do
            </span><a name="loc_174_13_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_13_174_14&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_182_1_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_10&#39;)"><span class="hl_varref"><span class="mpre">orNothing</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.ReadP.html#loc_262_1_262_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_262_1_262_6&#39;)"><span class="hl_varref"><span class="mpre">munch</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`notElem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:@&quot;</span></span><span class="mpre">))
            </span><a name="loc_175_13_175_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_182_1_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_10&#39;)"><span class="hl_varref"><span class="mpre">orNothing</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Text.ParserCombinators.ReadP.html#loc_262_1_262_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_262_1_262_6&#39;)"><span class="hl_varref"><span class="mpre">munch</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_char"><span class="mpre">&#39;@&#39;</span></span><span class="mpre">))
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_174_13_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_13_174_14&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">,</span><a href="#loc_175_13_175_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)

</span><a href="#loc_179_1_179_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_7&#39;)"><span class="mpre">before</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 178, srcSpanStartColumn = 11, srcSpanEndLine = 178, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 178, srcSpanStartColumn = 19, srcSpanEndLine = 178, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000."><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_179_1_179_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_7&#39;)"><span class="hl_fundecl"><span class="mpre">before</span></span></a><span class="mpre"> </span><a name="loc_179_8_179_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_8_179_9&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_179_10_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_179_8_179_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_8_179_9&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_179_21_179_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_21_179_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_179_10_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_179_21_179_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_21_179_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_182_1_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_10&#39;)"><span class="mpre">orNothing</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_182_1_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_10&#39;)"><span class="hl_fundecl"><span class="mpre">orNothing</span></span></a><span class="mpre"> </span><a name="loc_182_11_182_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_11_182_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_182_11_182_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_11_182_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.ReadP.html#loc_204_6_204_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_204_6_204_9&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- This function duplicates old Network.URI.authority behaviour.</span></span><span class="mpre">
</span><a href="#loc_186_1_186_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_21&#39;)"><span class="mpre">uriToAuthorityString</span></a><span class="mpre"> :: </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_186_1_186_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_21&#39;)"><span class="hl_fundecl"><span class="mpre">uriToAuthorityString</span></span></a><span class="mpre"> </span><a name="loc_186_22_186_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_22_186_23&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_189_1_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_16&#39;)"><span class="hl_varref"><span class="mpre">uriAuthToString</span></span></a><span class="mpre"> (</span><a href="Network.URI.html#loc_155_7_155_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_155_7_155_19&#39;)"><span class="hl_varref"><span class="mpre">uriAuthority</span></span></a><span class="mpre"> </span><a href="#loc_186_22_186_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_22_186_23&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)

</span><a href="#loc_189_1_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_16&#39;)"><span class="mpre">uriAuthToString</span></a><span class="mpre"> :: </span><a href="Network.URI.html#loc_162_6_162_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_162_6_162_13&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuth</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_189_1_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_16&#39;)"><span class="hl_fundecl"><span class="mpre">uriAuthToString</span></span></a><span class="mpre"> </span><a name="loc_189_17_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_17_189_19&#39;)"><span class="hl_vardecl"><span class="mpre">ua</span></span></a><span class="mpre"> = 
  </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [ </span><a href="Network.URI.html#loc_163_7_163_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_163_7_163_18&#39;)"><span class="hl_varref"><span class="mpre">uriUserInfo</span></span></a><span class="mpre"> </span><a href="#loc_189_17_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_17_189_19&#39;)"><span class="hl_varref"><span class="mpre">ua</span></span></a><span class="mpre"> 
         , </span><a href="Network.URI.html#loc_164_7_164_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_164_7_164_17&#39;)"><span class="hl_varref"><span class="mpre">uriRegName</span></span></a><span class="mpre"> </span><a href="#loc_189_17_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_17_189_19&#39;)"><span class="hl_varref"><span class="mpre">ua</span></span></a><span class="mpre">
         , </span><a href="Network.URI.html#loc_165_7_165_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_165_7_165_14&#39;)"><span class="hl_varref"><span class="mpre">uriPort</span></span></a><span class="mpre"> </span><a href="#loc_189_17_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_17_189_19&#39;)"><span class="hl_varref"><span class="mpre">ua</span></span></a><span class="mpre">
         ]

</span><a href="#loc_196_1_196_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_12&#39;)"><span class="mpre">uriAuthPort</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="Network.URI.html#loc_162_6_162_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_162_6_162_13&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuth</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_196_1_196_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_12&#39;)"><span class="hl_fundecl"><span class="mpre">uriAuthPort</span></span></a><span class="mpre"> </span><a name="loc_196_13_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_13_196_18&#39;)"><span class="hl_vardecl"><span class="mpre">mbURI</span></span></a><span class="mpre"> </span><a name="loc_196_19_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_19_196_20&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> = 
  case </span><a href="Network.URI.html#loc_165_7_165_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_165_7_165_14&#39;)"><span class="hl_varref"><span class="mpre">uriPort</span></span></a><span class="mpre"> </span><a href="#loc_196_19_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_19_196_20&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> of
    (</span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_198_10_198_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_10_198_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) -&gt; </span><a href="Network.HTTP.Utils.html#loc_87_1_87_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_87_1_87_9&#39;)"><span class="hl_varref"><span class="mpre">readsOne</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> (</span><a href="#loc_201_3_201_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_3_201_15&#39;)"><span class="hl_varref"><span class="mpre">default_port</span></span></a><span class="mpre"> </span><a href="#loc_196_13_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_13_196_18&#39;)"><span class="hl_varref"><span class="mpre">mbURI</span></span></a><span class="mpre">) </span><a href="#loc_198_10_198_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_10_198_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    _       -&gt; </span><a href="#loc_201_3_201_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_3_201_15&#39;)"><span class="hl_varref"><span class="mpre">default_port</span></span></a><span class="mpre"> </span><a href="#loc_196_13_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_13_196_18&#39;)"><span class="hl_varref"><span class="mpre">mbURI</span></span></a><span class="mpre">
 where
  </span><a name="loc_201_3_201_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_3_201_15&#39;)"><span class="hl_fundecl"><span class="mpre">default_port</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> = </span><a href="#loc_209_3_209_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_3_209_15&#39;)"><span class="hl_varref"><span class="mpre">default_http</span></span></a><span class="mpre">
  </span><a href="#loc_201_3_201_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_3_201_15&#39;)"><span class="hl_fundecl"><span class="mpre">default_port</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_202_22_202_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_22_202_25&#39;)"><span class="hl_vardecl"><span class="mpre">url</span></span></a><span class="mpre">) = 
    case </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.URI.html#loc_154_7_154_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_154_7_154_16&#39;)"><span class="hl_varref"><span class="mpre">uriScheme</span></span></a><span class="mpre"> </span><a href="#loc_202_22_202_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_22_202_25&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre"> of
      </span><span class="hl_string"><span class="mpre">&quot;http:&quot;</span></span><span class="mpre"> -&gt; </span><a href="#loc_209_3_209_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_3_209_15&#39;)"><span class="hl_varref"><span class="mpre">default_http</span></span></a><span class="mpre">
      </span><span class="hl_string"><span class="mpre">&quot;https:&quot;</span></span><span class="mpre"> -&gt; </span><a href="#loc_210_3_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_16&#39;)"><span class="hl_varref"><span class="mpre">default_https</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- todo: refine</span></span><span class="mpre">
      _ -&gt; </span><a href="#loc_209_3_209_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_3_209_15&#39;)"><span class="hl_varref"><span class="mpre">default_http</span></span></a><span class="mpre">

  </span><a name="loc_209_3_209_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_3_209_15&#39;)"><span class="hl_vardecl"><span class="mpre">default_http</span></span></a><span class="mpre">  = </span><span class="hl_num"><span class="mpre">80</span></span><span class="mpre">
  </span><a name="loc_210_3_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_16&#39;)"><span class="hl_vardecl"><span class="mpre">default_https</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">443</span></span><span class="mpre">

</span><a href="#loc_213_1_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_10&#39;)"><span class="mpre">failHTTPS</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 212, srcSpanStartColumn = 14, srcSpanEndLine = 212, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 212, srcSpanStartColumn = 22, srcSpanEndLine = 212, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000."><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_213_1_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_10&#39;)"><span class="hl_fundecl"><span class="mpre">failHTTPS</span></span></a><span class="mpre"> </span><a name="loc_213_11_213_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_14&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> (</span><a href="Network.URI.html#loc_154_7_154_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_154_7_154_16&#39;)"><span class="hl_varref"><span class="mpre">uriScheme</span></span></a><span class="mpre"> </span><a href="#loc_213_11_213_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_14&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;https:&quot;</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;https not supported&quot;</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Fish out the authority from a possibly normalized Request, i.e.,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the information may either be in the request&#39;s URI or inside</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the Host: header.</span></span><span class="mpre">
</span><a href="#loc_221_1_221_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_11&#39;)"><span class="mpre">reqURIAuth</span></a><span class="mpre"> :: </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre"> -&gt; </span><a href="Network.URI.html#loc_162_6_162_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_162_6_162_13&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuth</span></span></a><span class="mpre">
</span><a name="loc_221_1_221_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_11&#39;)"><span class="hl_fundecl"><span class="mpre">reqURIAuth</span></span></a><span class="mpre"> </span><a name="loc_221_12_221_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_12_221_15&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = 
  case </span><a href="Network.URI.html#loc_155_7_155_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_155_7_155_19&#39;)"><span class="hl_varref"><span class="mpre">uriAuthority</span></span></a><span class="mpre"> (</span><a href="#loc_293_16_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_16_293_21&#39;)"><span class="hl_varref"><span class="mpre">rqURI</span></span></a><span class="mpre"> </span><a href="#loc_221_12_221_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_12_221_15&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">) of
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_223_10_223_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_10_223_12&#39;)"><span class="hl_vardecl"><span class="mpre">ua</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_223_10_223_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_10_223_12&#39;)"><span class="hl_varref"><span class="mpre">ua</span></span></a><span class="mpre">
    _ -&gt; case </span><a href="Network.HTTP.Headers.html#loc_255_1_255_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_255_1_255_13&#39;)"><span class="hl_varref"><span class="mpre">lookupHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_92_4_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_92_4_92_11&#39;)"><span class="hl_conref"><span class="mpre">HdrHost</span></span></a><span class="mpre"> (</span><a href="#loc_299_16_299_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_16_299_25&#39;)"><span class="hl_varref"><span class="mpre">rqHeaders</span></span></a><span class="mpre"> </span><a href="#loc_221_12_221_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_12_221_15&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">) of
           </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;reqURIAuth: no URI authority for: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_221_12_221_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_12_221_15&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)
           </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_226_17_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_17_226_18&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">  -&gt; 
              case </span><a href="#loc_235_4_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_4_235_14&#39;)"><span class="hl_varref"><span class="mpre">toHostPort</span></span></a><span class="mpre"> </span><a href="#loc_226_17_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_17_226_18&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> of
                (</span><span class="hl_vardecl"><span class="mpre">ht</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre">) -&gt; </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 27, srcSpanEndLine = 231, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 35, srcSpanEndLine = 228, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">URIAuth { uriUserInfo = &quot;&quot;
                                  , uriRegName  = ht
                                  , uriPort     = p
                                  }</span></span><span class="mpre">
  where
    </span><span class="hl_comment"><span class="mpre">-- Note: just in case you&#39;re wondering..the convention is to include the &#39;:&#39;</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- in the port part..</span></span><span class="mpre">
   </span><a name="loc_235_4_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_4_235_14&#39;)"><span class="hl_fundecl"><span class="mpre">toHostPort</span></span></a><span class="mpre"> </span><a name="loc_235_15_235_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_15_235_16&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">) </span><a href="#loc_235_15_235_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_15_235_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------ HTTP Messages --------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Protocol version</span></span><span class="mpre">
</span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="mpre">httpVersion</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_vardecl"><span class="mpre">httpVersion</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1&quot;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The HTTP request method, to be used in the &#39;Request&#39; object.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We are missing a few of the stranger methods, but these are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- not really necessary until we add full TLS.</span></span><span class="mpre">
data </span><a name="loc_250_6_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_6_250_19&#39;)"><span class="hl_tycondecl"><span class="mpre">RequestMethod</span></span></a><span class="mpre"> = </span><a name="loc_250_22_250_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_22_250_26&#39;)"><span class="hl_condecl"><span class="mpre">HEAD</span></span></a><span class="mpre"> | </span><a name="loc_250_29_250_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_29_250_32&#39;)"><span class="hl_condecl"><span class="mpre">PUT</span></span></a><span class="mpre"> | </span><a name="loc_250_35_250_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_35_250_38&#39;)"><span class="hl_condecl"><span class="mpre">GET</span></span></a><span class="mpre"> | </span><a name="loc_250_41_250_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_41_250_45&#39;)"><span class="hl_condecl"><span class="mpre">POST</span></span></a><span class="mpre"> | </span><a name="loc_250_48_250_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_48_250_54&#39;)"><span class="hl_condecl"><span class="mpre">DELETE</span></span></a><span class="mpre"> | </span><a name="loc_250_57_250_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_57_250_64&#39;)"><span class="hl_condecl"><span class="mpre">OPTIONS</span></span></a><span class="mpre"> | </span><a name="loc_250_67_250_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_67_250_72&#39;)"><span class="hl_condecl"><span class="mpre">TRACE</span></span></a><span class="mpre"> | </span><a name="loc_250_75_250_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_75_250_82&#39;)"><span class="hl_condecl"><span class="mpre">CONNECT</span></span></a><span class="mpre"> | </span><a name="loc_250_85_250_91" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_85_250_91&#39;)"><span class="hl_condecl"><span class="mpre">Custom</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 251, srcSpanStartColumn = 5, srcSpanEndLine = 251, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 251, srcSpanStartColumn = 5, srcSpanEndLine = 251, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartL"><span class="mpre">deriving(Eq)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_250_6_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_6_250_19&#39;)"><span class="hl_tyconref"><span class="mpre">RequestMethod</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_254_8_254_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_8_254_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = 
    case </span><a href="#loc_254_8_254_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_8_254_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
      </span><a href="#loc_250_22_250_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_22_250_26&#39;)"><span class="hl_conref"><span class="mpre">HEAD</span></span></a><span class="mpre">     -&gt; </span><span class="hl_string"><span class="mpre">&quot;HEAD&quot;</span></span><span class="mpre">
      </span><a href="#loc_250_29_250_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_29_250_32&#39;)"><span class="hl_conref"><span class="mpre">PUT</span></span></a><span class="mpre">      -&gt; </span><span class="hl_string"><span class="mpre">&quot;PUT&quot;</span></span><span class="mpre">
      </span><a href="#loc_250_35_250_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_35_250_38&#39;)"><span class="hl_conref"><span class="mpre">GET</span></span></a><span class="mpre">      -&gt; </span><span class="hl_string"><span class="mpre">&quot;GET&quot;</span></span><span class="mpre">
      </span><a href="#loc_250_41_250_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_41_250_45&#39;)"><span class="hl_conref"><span class="mpre">POST</span></span></a><span class="mpre">     -&gt; </span><span class="hl_string"><span class="mpre">&quot;POST&quot;</span></span><span class="mpre">
      </span><a href="#loc_250_48_250_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_48_250_54&#39;)"><span class="hl_conref"><span class="mpre">DELETE</span></span></a><span class="mpre">   -&gt; </span><span class="hl_string"><span class="mpre">&quot;DELETE&quot;</span></span><span class="mpre">
      </span><a href="#loc_250_57_250_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_57_250_64&#39;)"><span class="hl_conref"><span class="mpre">OPTIONS</span></span></a><span class="mpre">  -&gt; </span><span class="hl_string"><span class="mpre">&quot;OPTIONS&quot;</span></span><span class="mpre">
      </span><a href="#loc_250_67_250_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_67_250_72&#39;)"><span class="hl_conref"><span class="mpre">TRACE</span></span></a><span class="mpre">    -&gt; </span><span class="hl_string"><span class="mpre">&quot;TRACE&quot;</span></span><span class="mpre">
      </span><a href="#loc_250_75_250_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_75_250_82&#39;)"><span class="hl_conref"><span class="mpre">CONNECT</span></span></a><span class="mpre">  -&gt; </span><span class="hl_string"><span class="mpre">&quot;CONNECT&quot;</span></span><span class="mpre">
      </span><a href="#loc_250_85_250_91" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_85_250_91&#39;)"><span class="hl_conref"><span class="mpre">Custom</span></span></a><span class="mpre"> </span><a name="loc_264_14_264_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_14_264_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_264_14_264_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_14_264_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><a href="#loc_267_1_267_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_12&#39;)"><span class="mpre">rqMethodMap</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><a href="#loc_250_6_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_6_250_19&#39;)"><span class="hl_tyconref"><span class="mpre">RequestMethod</span></span></a><span class="mpre">)]
</span><a name="loc_267_1_267_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_12&#39;)"><span class="hl_vardecl"><span class="mpre">rqMethodMap</span></span></a><span class="mpre"> = [(</span><span class="hl_string"><span class="mpre">&quot;HEAD&quot;</span></span><span class="mpre">,    </span><a href="#loc_250_22_250_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_22_250_26&#39;)"><span class="hl_conref"><span class="mpre">HEAD</span></span></a><span class="mpre">),
               (</span><span class="hl_string"><span class="mpre">&quot;PUT&quot;</span></span><span class="mpre">,     </span><a href="#loc_250_29_250_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_29_250_32&#39;)"><span class="hl_conref"><span class="mpre">PUT</span></span></a><span class="mpre">),
               (</span><span class="hl_string"><span class="mpre">&quot;GET&quot;</span></span><span class="mpre">,     </span><a href="#loc_250_35_250_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_35_250_38&#39;)"><span class="hl_conref"><span class="mpre">GET</span></span></a><span class="mpre">),
               (</span><span class="hl_string"><span class="mpre">&quot;POST&quot;</span></span><span class="mpre">,    </span><a href="#loc_250_41_250_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_41_250_45&#39;)"><span class="hl_conref"><span class="mpre">POST</span></span></a><span class="mpre">),
               (</span><span class="hl_string"><span class="mpre">&quot;DELETE&quot;</span></span><span class="mpre">,  </span><a href="#loc_250_48_250_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_48_250_54&#39;)"><span class="hl_conref"><span class="mpre">DELETE</span></span></a><span class="mpre">),
               (</span><span class="hl_string"><span class="mpre">&quot;OPTIONS&quot;</span></span><span class="mpre">, </span><a href="#loc_250_57_250_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_57_250_64&#39;)"><span class="hl_conref"><span class="mpre">OPTIONS</span></span></a><span class="mpre">),
               (</span><span class="hl_string"><span class="mpre">&quot;TRACE&quot;</span></span><span class="mpre">,   </span><a href="#loc_250_67_250_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_67_250_72&#39;)"><span class="hl_conref"><span class="mpre">TRACE</span></span></a><span class="mpre">),
               (</span><span class="hl_string"><span class="mpre">&quot;CONNECT&quot;</span></span><span class="mpre">, </span><a href="#loc_250_75_250_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_75_250_82&#39;)"><span class="hl_conref"><span class="mpre">CONNECT</span></span></a><span class="mpre">)]

</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for backwards-ish compatibility; suggest</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- migrating to new Req/Resp by adding type param.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 280, srcSpanStartColumn = 1, srcSpanEndLine = 280, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 280, srcSpanStartColumn = 1, srcSpanEndLine = 280, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLi"><span class="mpre">type Request_String  = Request String</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 281, srcSpanStartColumn = 1, srcSpanEndLine = 281, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 281, srcSpanStartColumn = 1, srcSpanEndLine = 281, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLi"><span class="mpre">type Response_String = Response String</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Hmm..I really want to use these for the record</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- type, but it will upset codebases wanting to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- migrate (and live with using pre-HTTPbis versions.)</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 286, srcSpanStartColumn = 1, srcSpanEndLine = 286, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 286, srcSpanStartColumn = 1, srcSpanEndLine = 286, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLi"><span class="mpre">type HTTPRequest a  = Request  a</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 287, srcSpanStartColumn = 1, srcSpanEndLine = 287, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 287, srcSpanStartColumn = 1, srcSpanEndLine = 287, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLi"><span class="mpre">type HTTPResponse a = Response a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | An HTTP Request.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Show&#39; instance of this type is used for message serialisation,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which means no body data is output.</span></span><span class="mpre">
data </span><a name="loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tycondecl"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> =
     </span><a name="loc_293_6_293_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_6_293_13&#39;)"><span class="hl_condecl"><span class="mpre">Request</span></span></a><span class="mpre"> { </span><a name="loc_293_16_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_16_293_21&#39;)"><span class="hl_fielddecl"><span class="mpre">rqURI</span></span></a><span class="mpre">       :: </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ might need changing in future</span></span><span class="mpre">
                                    </span><span class="hl_comment"><span class="mpre">--  1) to support &#39;*&#39; uri in OPTIONS request</span></span><span class="mpre">
                                    </span><span class="hl_comment"><span class="mpre">--  2) transparent support for both relative</span></span><span class="mpre">
                                    </span><span class="hl_comment"><span class="mpre">--     &amp; absolute uris, although this should</span></span><span class="mpre">
                                    </span><span class="hl_comment"><span class="mpre">--     already work (leave scheme &amp; host parts empty).</span></span><span class="mpre">
             , </span><a name="loc_298_16_298_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_16_298_24&#39;)"><span class="hl_fielddecl"><span class="mpre">rqMethod</span></span></a><span class="mpre">    :: </span><a href="#loc_250_6_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_6_250_19&#39;)"><span class="hl_tyconref"><span class="mpre">RequestMethod</span></span></a><span class="mpre">
             , </span><a name="loc_299_16_299_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_16_299_25&#39;)"><span class="hl_fielddecl"><span class="mpre">rqHeaders</span></span></a><span class="mpre">   :: [</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">]
             , </span><a name="loc_300_16_300_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_16_300_22&#39;)"><span class="hl_fielddecl"><span class="mpre">rqBody</span></span></a><span class="mpre">      :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
             }

</span><span class="hl_comment"><span class="mpre">-- Notice that request body is not included,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this show function is used to serialise</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a request for the transport link, we send</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the body separately where possible.</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> (</span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_308_10_308_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_10_308_13&#39;)"><span class="hl_specname"><span class="mpre">req</span></span></a><span class="mpre">@(</span><a href="#loc_293_6_293_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_6_293_13&#39;)"><span class="hl_conref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><a name="loc_308_23_308_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_23_308_24&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_308_25_308_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_25_308_26&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_308_27_308_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_27_308_28&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> _) =
        </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_308_25_308_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_25_308_26&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Network.HTTP.Utils.html#loc_46_1_46_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_46_1_46_3&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_313_13_313_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_13_313_20&#39;)"><span class="hl_varref"><span class="mpre">alt_uri</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Network.HTTP.Utils.html#loc_46_1_46_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_46_1_46_3&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_312_13_312_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_13_312_16&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Network.HTTP.Utils.html#loc_38_1_38_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_38_1_38_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(++)</span></span><span class="mpre"> [] (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_540_1_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_1_540_16&#39;)"><span class="hl_varref"><span class="mpre">dropHttpVersion</span></span></a><span class="mpre"> </span><a href="#loc_308_27_308_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_27_308_28&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Network.HTTP.Utils.html#loc_38_1_38_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_38_1_38_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">
        where
            </span><a name="loc_312_13_312_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_13_312_16&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_varref"><span class="mpre">httpVersion</span></span></a><span class="mpre"> (</span><a href="#loc_501_1_501_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_18&#39;)"><span class="hl_varref"><span class="mpre">getRequestVersion</span></span></a><span class="mpre"> </span><a href="#loc_308_10_308_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_10_308_13&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)
            </span><a name="loc_313_13_313_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_13_313_20&#39;)"><span class="hl_vardecl"><span class="mpre">alt_uri</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> (</span><a href="Network.URI.html#loc_156_7_156_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_156_7_156_14&#39;)"><span class="hl_varref"><span class="mpre">uriPath</span></span></a><span class="mpre"> </span><a href="#loc_308_23_308_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_23_308_24&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> (</span><a href="Network.URI.html#loc_156_7_156_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_156_7_156_14&#39;)"><span class="hl_varref"><span class="mpre">uriPath</span></span></a><span class="mpre"> </span><a href="#loc_308_23_308_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_23_308_24&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre"> 
                        then </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 314, srcSpanStartColumn = 30, srcSpanEndLine = 314, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 314, srcSpanStartColumn = 32, srcSpanEndLine = 314, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">u { uriPath = &#39;/&#39; : uriPath u }</span></span><span class="mpre"> 
                        else </span><a href="#loc_308_23_308_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_23_308_24&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">

instance </span><a href="Network.HTTP.Headers.html#loc_203_7_203_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_203_7_203_17&#39;)"><span class="hl_classref"><span class="mpre">HasHeaders</span></span></a><span class="mpre"> (</span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><a href="Network.HTTP.Headers.html#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_204_5_204_15&#39;)"><span class="hl_vardecl"><span class="mpre">getHeaders</span></span></a><span class="mpre"> = </span><a href="#loc_299_16_299_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_16_299_25&#39;)"><span class="hl_varref"><span class="mpre">rqHeaders</span></span></a><span class="mpre">
    </span><a href="Network.HTTP.Headers.html#loc_205_5_205_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_205_5_205_15&#39;)"><span class="hl_fundecl"><span class="mpre">setHeaders</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">rq</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">hdrs</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 319, srcSpanStartColumn = 26, srcSpanEndLine = 319, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 319, srcSpanStartColumn = 29, srcSpanEndLine = 319, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">rq { rqHeaders=hdrs }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | For easy pattern matching, HTTP response codes @xyz@ are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- represented as @(x,y,z)@.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 323, srcSpanStartColumn = 1, srcSpanEndLine = 323, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 323, srcSpanStartColumn = 1, srcSpanEndLine = 323, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLi"><span class="mpre">type ResponseCode  = (Int,Int,Int)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @ResponseData@ contains the head of a response payload;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- HTTP response code, accompanying text description + header</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fields.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 328, srcSpanStartColumn = 1, srcSpanEndLine = 328, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 328, srcSpanStartColumn = 1, srcSpanEndLine = 328, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLi"><span class="mpre">type ResponseData  = (ResponseCode,String,[Header])</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @RequestData@ contains the head of a HTTP request; method,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- its URL along with the auxillary/supporting header data.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 332, srcSpanStartColumn = 1, srcSpanEndLine = 332, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 332, srcSpanStartColumn = 1, srcSpanEndLine = 332, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLi"><span class="mpre">type RequestData   = (RequestMethod,URI,[Header])</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | An HTTP Response.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Show&#39; instance of this type is used for message serialisation,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which means no body data is output, additionally the output will</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- show an HTTP version of 1.1 instead of the actual version returned</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by a server.</span></span><span class="mpre">
data </span><a name="loc_339_6_339_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_14&#39;)"><span class="hl_tycondecl"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> =
    </span><a name="loc_340_5_340_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_5_340_13&#39;)"><span class="hl_condecl"><span class="mpre">Response</span></span></a><span class="mpre"> { </span><a name="loc_340_16_340_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_16_340_23&#39;)"><span class="hl_fielddecl"><span class="mpre">rspCode</span></span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">ResponseCode</span></span><span class="mpre">
             , </span><a name="loc_341_16_341_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_16_341_25&#39;)"><span class="hl_fielddecl"><span class="mpre">rspReason</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
             , </span><a name="loc_342_16_342_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_16_342_26&#39;)"><span class="hl_fielddecl"><span class="mpre">rspHeaders</span></span></a><span class="mpre">  :: [</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">]
             , </span><a name="loc_343_16_343_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_16_343_23&#39;)"><span class="hl_fielddecl"><span class="mpre">rspBody</span></span></a><span class="mpre">     :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
             }
                   
</span><span class="hl_comment"><span class="mpre">-- This is an invalid representation of a received response, </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- since we have made the assumption that all responses are HTTP/1.1</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> (</span><a href="#loc_339_6_339_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_349_10_349_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_10_349_13&#39;)"><span class="hl_specname"><span class="mpre">rsp</span></span></a><span class="mpre">@(</span><a href="#loc_340_5_340_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_5_340_13&#39;)"><span class="hl_conref"><span class="mpre">Response</span></span></a><span class="mpre"> (</span><a name="loc_349_25_349_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_25_349_26&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_349_27_349_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_27_349_28&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,</span><a name="loc_349_29_349_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_29_349_30&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><a name="loc_349_32_349_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_32_349_38&#39;)"><span class="hl_vardecl"><span class="mpre">reason</span></span></a><span class="mpre"> </span><a name="loc_349_39_349_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_39_349_46&#39;)"><span class="hl_vardecl"><span class="mpre">headers</span></span></a><span class="mpre"> _) =
        </span><a href="#loc_353_7_353_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_7_353_10&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">intToDigit</span></span><span class="mpre"> [</span><a href="#loc_349_25_349_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_25_349_26&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_349_27_349_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_27_349_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">,</span><a href="#loc_349_29_349_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_29_349_30&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_349_32_349_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_32_349_38&#39;)"><span class="hl_varref"><span class="mpre">reason</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Network.HTTP.Utils.html#loc_38_1_38_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_38_1_38_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(++)</span></span><span class="mpre"> [] (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_540_1_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_1_540_16&#39;)"><span class="hl_varref"><span class="mpre">dropHttpVersion</span></span></a><span class="mpre"> </span><a href="#loc_349_39_349_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_39_349_46&#39;)"><span class="hl_varref"><span class="mpre">headers</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Network.HTTP.Utils.html#loc_38_1_38_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_38_1_38_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">
     where
      </span><a name="loc_353_7_353_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_7_353_10&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_varref"><span class="mpre">httpVersion</span></span></a><span class="mpre"> (</span><a href="#loc_513_1_513_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_1_513_19&#39;)"><span class="hl_varref"><span class="mpre">getResponseVersion</span></span></a><span class="mpre"> </span><a href="#loc_349_10_349_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_10_349_13&#39;)"><span class="hl_varref"><span class="mpre">rsp</span></span></a><span class="mpre">)

instance </span><a href="Network.HTTP.Headers.html#loc_203_7_203_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_203_7_203_17&#39;)"><span class="hl_classref"><span class="mpre">HasHeaders</span></span></a><span class="mpre"> (</span><a href="#loc_339_6_339_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><a href="Network.HTTP.Headers.html#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_204_5_204_15&#39;)"><span class="hl_vardecl"><span class="mpre">getHeaders</span></span></a><span class="mpre"> = </span><a href="#loc_342_16_342_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_16_342_26&#39;)"><span class="hl_varref"><span class="mpre">rspHeaders</span></span></a><span class="mpre">
    </span><a href="Network.HTTP.Headers.html#loc_205_5_205_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_205_5_205_15&#39;)"><span class="hl_fundecl"><span class="mpre">setHeaders</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">rsp</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">hdrs</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 357, srcSpanStartColumn = 27, srcSpanEndLine = 357, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 357, srcSpanStartColumn = 31, srcSpanEndLine = 357, srcSpanEndColumn = 32},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">rsp { rspHeaders=hdrs }</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------ Request Building ------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Deprecated. Use &#39;defaultUserAgent&#39;</span></span><span class="mpre">
</span><a href="#loc_366_1_366_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_1_366_6&#39;)"><span class="mpre">libUA</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_366_1_366_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_1_366_6&#39;)"><span class="hl_vardecl"><span class="mpre">libUA</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;hs-HTTP-4000.0.9&quot;</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 367, srcSpanStartColumn = 1, srcSpanEndLine = 367, srcSpanEndColumn = 94}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 367, srcSpanStartColumn = 1, srcSpanEndLine = 367, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpan"><span class="mpre">{-# DEPRECATED libUA &quot;Use defaultUserAgent instead (but note the user agent name change)&quot; #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A default user agent string. The string is @\&quot;haskell-HTTP/$version\&quot;@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- where @$version@ is the version of this HTTP package.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_373_1_373_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_17&#39;)"><span class="mpre">defaultUserAgent</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_373_1_373_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_17&#39;)"><span class="hl_vardecl"><span class="mpre">defaultUserAgent</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;haskell-HTTP/&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_381_1_381_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_19&#39;)"><span class="hl_varref"><span class="mpre">httpPackageVersion</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The version of this HTTP package as a string, e.g. @\&quot;4000.1.2\&quot;@. This</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- may be useful to include in a user agent string so that you can determine</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- from server logs what version of this package HTTP clients are using.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This can be useful for tracking down HTTP compatibility quirks.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_381_1_381_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_19&#39;)"><span class="mpre">httpPackageVersion</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_381_1_381_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_19&#39;)"><span class="hl_vardecl"><span class="mpre">httpPackageVersion</span></span></a><span class="mpre"> = </span><a href="Data.Version.html#loc_106_1_106_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_106_1_106_12&#39;)"><span class="hl_varref"><span class="mpre">showVersion</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Self.version</span></span><span class="mpre">

</span><a href="#loc_384_1_384_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_18&#39;)"><span class="mpre">defaultGETRequest</span></a><span class="mpre"> :: </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Request_String</span></span><span class="mpre">
</span><a name="loc_384_1_384_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_18&#39;)"><span class="hl_fundecl"><span class="mpre">defaultGETRequest</span></span></a><span class="mpre"> </span><a name="loc_384_19_384_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_19_384_22&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="mpre"> = </span><a href="#loc_387_1_387_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_19&#39;)"><span class="hl_varref"><span class="mpre">defaultGETRequest_</span></span></a><span class="mpre"> </span><a href="#loc_384_19_384_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_19_384_22&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre">

</span><a href="#loc_387_1_387_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_19&#39;)"><span class="mpre">defaultGETRequest_</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 386, srcSpanStartColumn = 23, srcSpanEndLine = 386, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 386, srcSpanStartColumn = 36, srcSpanEndLine = 386, srcSpanEndColumn = 38}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000."><span class="mpre">BufferType a =&gt;</span></span><span class="mpre"> </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_387_1_387_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_19&#39;)"><span class="hl_fundecl"><span class="mpre">defaultGETRequest_</span></span></a><span class="mpre"> </span><a name="loc_387_20_387_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_20_387_23&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="mpre"> = </span><a href="#loc_395_1_395_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_10&#39;)"><span class="hl_varref"><span class="mpre">mkRequest</span></span></a><span class="mpre"> </span><a href="#loc_250_35_250_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_35_250_38&#39;)"><span class="hl_conref"><span class="mpre">GET</span></span></a><span class="mpre"> </span><a href="#loc_387_20_387_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_20_387_23&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre"> 

</span><span class="hl_comment"><span class="mpre">-- | &#39;mkRequest method uri&#39; constructs a well formed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- request for the given HTTP method and URI. It does not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- normalize the URI for the request _nor_ add the required </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Host: header. That is done either explicitly by the user</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or when requests are normalized prior to transmission.</span></span><span class="mpre">
</span><a href="#loc_395_1_395_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_10&#39;)"><span class="mpre">mkRequest</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 394, srcSpanStartColumn = 14, srcSpanEndLine = 394, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 394, srcSpanStartColumn = 28, srcSpanEndLine = 394, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000."><span class="mpre">BufferType ty =&gt;</span></span><span class="mpre"> </span><a href="#loc_250_6_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_6_250_19&#39;)"><span class="hl_tyconref"><span class="mpre">RequestMethod</span></span></a><span class="mpre"> -&gt; </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
</span><a name="loc_395_1_395_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_10&#39;)"><span class="hl_fundecl"><span class="mpre">mkRequest</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">meth</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">uri</span></span><span class="mpre"> = </span><a href="#loc_397_3_397_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_3_397_6&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
 where
  </span><a name="loc_397_3_397_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_3_397_6&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = 
    </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 398, srcSpanStartColumn = 5, srcSpanEndLine = 404, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 398, srcSpanStartColumn = 13, srcSpanEndLine = 398, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStar"><span class="mpre">Request { rqURI      = uri
            , rqBody     = empty
            , rqHeaders  = [ Header HdrContentLength &quot;0&quot;
                           , Header HdrUserAgent     defaultUserAgent
                           ]
            , rqMethod   = meth
            }</span></span><span class="mpre">

  </span><span class="hl_vardecl"><span class="mpre">empty</span></span><span class="mpre"> = </span><a href="Network.BufferType.html#loc_77_8_77_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_77_8_77_17&#39;)"><span class="hl_varref"><span class="mpre">buf_empty</span></span></a><span class="mpre"> (</span><a href="#loc_432_1_432_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_9&#39;)"><span class="hl_varref"><span class="mpre">toBufOps</span></span></a><span class="mpre"> </span><a href="#loc_397_3_397_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_3_397_6&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- set rqBody, Content-Type and Content-Length headers.</span></span><span class="mpre">
</span><a href="#loc_410_1_410_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_15&#39;)"><span class="mpre">setRequestBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Request_String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Request_String</span></span><span class="mpre">
</span><a name="loc_410_1_410_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_15&#39;)"><span class="hl_fundecl"><span class="mpre">setRequestBody</span></span></a><span class="mpre"> </span><a name="loc_410_16_410_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_16_410_19&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> (</span><a name="loc_410_21_410_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_21_410_24&#39;)"><span class="hl_vardecl"><span class="mpre">typ</span></span></a><span class="mpre">, </span><a name="loc_410_26_410_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_26_410_30&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre">) = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 410, srcSpanStartColumn = 34, srcSpanEndLine = 410, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 410, srcSpanStartColumn = 39, srcSpanEndLine = 410, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">req&#39; { rqBody=body }</span></span><span class="mpre">
  where
    </span><span class="hl_vardecl"><span class="mpre">req&#39;</span></span><span class="mpre"> = </span><a href="Network.HTTP.Headers.html#loc_232_1_232_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_232_1_232_14&#39;)"><span class="hl_varref"><span class="mpre">replaceHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_125_4_125_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_125_4_125_18&#39;)"><span class="hl_conref"><span class="mpre">HdrContentType</span></span></a><span class="mpre"> </span><a href="#loc_410_21_410_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_21_410_24&#39;)"><span class="hl_varref"><span class="mpre">typ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">
           </span><a href="Network.HTTP.Headers.html#loc_232_1_232_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_232_1_232_14&#39;)"><span class="hl_varref"><span class="mpre">replaceHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_121_4_121_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_121_4_121_20&#39;)"><span class="hl_conref"><span class="mpre">HdrContentLength</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_410_26_410_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_26_410_30&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
           </span><a href="#loc_410_16_410_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_16_410_19&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
    -- stub out the user info.
  updAuth = fmap (\ x -&gt; x{uriUserInfo=&quot;&quot;}) (uriAuthority uri)

  withHost = 
    case uriToAuthorityString uri{uriAuthority=updAuth} of
      &quot;&quot; -&gt; id
      h  -&gt; ((Header HdrHost h):)

  uri_req 
   | forProxy  = uri
   | otherwise = snd (splitRequestURI uri)
-}</span></span><span class="mpre">


</span><a href="#loc_432_1_432_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_9&#39;)"><span class="mpre">toBufOps</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 431, srcSpanStartColumn = 13, srcSpanEndLine = 431, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 431, srcSpanStartColumn = 26, srcSpanEndLine = 431, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000."><span class="mpre">BufferType a =&gt;</span></span><span class="mpre"> </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Network.BufferType.html#loc_71_6_71_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_71_6_71_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufferOp</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_432_1_432_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_9&#39;)"><span class="hl_fundecl"><span class="mpre">toBufOps</span></span></a><span class="mpre"> _ = </span><a href="Network.BufferType.html#loc_49_4_49_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_49_4_49_13&#39;)"><span class="hl_varref"><span class="mpre">bufferOps</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------ Parsing --------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Parsing a request</span></span><span class="mpre">
</span><a href="#loc_440_1_440_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_1_440_17&#39;)"><span class="mpre">parseRequestHead</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">RequestData</span></span><span class="mpre">
</span><a name="loc_440_1_440_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_1_440_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseRequestHead</span></span></a><span class="mpre">         [] = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Network.Stream.html#loc_39_4_39_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_39_4_39_15&#39;)"><span class="hl_conref"><span class="mpre">ErrorClosed</span></span></a><span class="mpre">
</span><a href="#loc_440_1_440_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_1_440_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseRequestHead</span></span></a><span class="mpre"> (</span><a name="loc_441_19_441_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_19_441_22&#39;)"><span class="hl_vardecl"><span class="mpre">com</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_441_23_441_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_23_441_27&#39;)"><span class="hl_vardecl"><span class="mpre">hdrs</span></span></a><span class="mpre">) = do
  (</span><a name="loc_442_4_442_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_4_442_11&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre">,</span><a name="loc_442_12_442_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_12_442_15&#39;)"><span class="hl_vardecl"><span class="mpre">rqm</span></span></a><span class="mpre">,</span><a name="loc_442_16_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_16_442_19&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_449_3_449_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_3_449_17&#39;)"><span class="hl_varref"><span class="mpre">requestCommand</span></span></a><span class="mpre"> </span><a href="#loc_441_19_441_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_19_441_22&#39;)"><span class="hl_varref"><span class="mpre">com</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">words</span></span><span class="mpre"> </span><a href="#loc_441_19_441_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_19_441_22&#39;)"><span class="hl_varref"><span class="mpre">com</span></span></a><span class="mpre">)
  </span><a name="loc_443_3_443_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_3_443_8&#39;)"><span class="hl_vardecl"><span class="mpre">hdrs&#39;</span></span></a><span class="mpre">              &lt;- </span><a href="Network.HTTP.Headers.html#loc_280_1_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_280_1_280_13&#39;)"><span class="hl_varref"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> </span><a href="#loc_441_23_441_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_23_441_27&#39;)"><span class="hl_varref"><span class="mpre">hdrs</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_442_12_442_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_12_442_15&#39;)"><span class="hl_varref"><span class="mpre">rqm</span></span></a><span class="mpre">,</span><a href="#loc_442_16_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_16_442_19&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre">,</span><a href="#loc_446_3_446_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_3_446_10&#39;)"><span class="hl_varref"><span class="mpre">withVer</span></span></a><span class="mpre"> </span><a href="#loc_442_4_442_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_4_442_11&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre"> </span><a href="#loc_443_3_443_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_3_443_8&#39;)"><span class="hl_varref"><span class="mpre">hdrs&#39;</span></span></a><span class="mpre">)
 where
  </span><a name="loc_446_3_446_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_3_446_10&#39;)"><span class="hl_fundecl"><span class="mpre">withVer</span></span></a><span class="mpre"> [] </span><a name="loc_446_14_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_14_446_16&#39;)"><span class="hl_vardecl"><span class="mpre">hs</span></span></a><span class="mpre"> = </span><a href="#loc_446_14_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_14_446_16&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre">
  </span><a href="#loc_446_3_446_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_3_446_10&#39;)"><span class="hl_fundecl"><span class="mpre">withVer</span></span></a><span class="mpre"> (</span><a name="loc_447_12_447_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_12_447_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) </span><a name="loc_447_17_447_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_17_447_19&#39;)"><span class="hl_vardecl"><span class="mpre">hs</span></span></a><span class="mpre"> = </span><a href="#loc_494_1_494_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_12&#39;)"><span class="hl_varref"><span class="mpre">withVersion</span></span></a><span class="mpre"> </span><a href="#loc_447_12_447_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_12_447_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_447_17_447_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_17_447_19&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre">

  </span><a name="loc_449_3_449_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_3_449_17&#39;)"><span class="hl_fundecl"><span class="mpre">requestCommand</span></span></a><span class="mpre"> </span><a name="loc_449_18_449_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_18_449_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">_yes</span></span><span class="mpre">@(</span><a name="loc_449_26_449_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_26_449_29&#39;)"><span class="hl_vardecl"><span class="mpre">rqm</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_449_30_449_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_30_449_33&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_449_34_449_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_34_449_41&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre">) =
    case (</span><a href="Network.URI.html#loc_232_1_232_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_232_1_232_18&#39;)"><span class="hl_varref"><span class="mpre">parseURIReference</span></span></a><span class="mpre"> </span><a href="#loc_449_30_449_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_30_449_33&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><a href="#loc_449_26_449_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_26_449_29&#39;)"><span class="hl_varref"><span class="mpre">rqm</span></span></a><span class="mpre"> </span><a href="#loc_267_1_267_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_12&#39;)"><span class="hl_varref"><span class="mpre">rqMethodMap</span></span></a><span class="mpre">) of
     (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_451_12_451_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_12_451_13&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_451_20_451_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_20_451_21&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_449_34_449_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_34_449_41&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">,</span><a href="#loc_451_20_451_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_20_451_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">,</span><a href="#loc_451_12_451_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_12_451_13&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)
     (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_452_12_452_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_12_452_13&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_449_34_449_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_34_449_41&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">,</span><a href="#loc_250_85_250_91" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_85_250_91&#39;)"><span class="hl_conref"><span class="mpre">Custom</span></span></a><span class="mpre"> </span><a href="#loc_449_26_449_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_26_449_29&#39;)"><span class="hl_varref"><span class="mpre">rqm</span></span></a><span class="mpre">,</span><a href="#loc_452_12_452_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_12_452_13&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)
     _                -&gt; </span><a href="#loc_458_3_458_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_3_458_12&#39;)"><span class="hl_varref"><span class="mpre">parse_err</span></span></a><span class="mpre"> </span><a href="#loc_449_18_449_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_18_449_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  </span><a href="#loc_449_3_449_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_3_449_17&#39;)"><span class="hl_fundecl"><span class="mpre">requestCommand</span></span></a><span class="mpre"> </span><a name="loc_454_18_454_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_18_454_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> _
   | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_454_18_454_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_18_454_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">    = </span><a href="Network.Stream.html#loc_58_1_58_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_58_1_58_9&#39;)"><span class="hl_varref"><span class="mpre">failWith</span></span></a><span class="mpre"> </span><a href="Network.Stream.html#loc_39_4_39_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_39_4_39_15&#39;)"><span class="hl_conref"><span class="mpre">ErrorClosed</span></span></a><span class="mpre">
   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_458_3_458_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_3_458_12&#39;)"><span class="hl_varref"><span class="mpre">parse_err</span></span></a><span class="mpre"> </span><a href="#loc_454_18_454_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_18_454_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

  </span><a name="loc_458_3_458_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_3_458_12&#39;)"><span class="hl_fundecl"><span class="mpre">parse_err</span></span></a><span class="mpre"> </span><a name="loc_458_13_458_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_13_458_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_994_1_994_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_994_1_994_19&#39;)"><span class="hl_varref"><span class="mpre">responseParseError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parseRequestHead&quot;</span></span><span class="mpre">
                   (</span><span class="hl_string"><span class="mpre">&quot;Request command line parse failure: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_458_13_458_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_13_458_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Parsing a response</span></span><span class="mpre">
</span><a href="#loc_463_1_463_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_1_463_18&#39;)"><span class="mpre">parseResponseHead</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ResponseData</span></span><span class="mpre">
</span><a name="loc_463_1_463_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_1_463_18&#39;)"><span class="hl_fundecl"><span class="mpre">parseResponseHead</span></span></a><span class="mpre"> []         = </span><a href="Network.Stream.html#loc_58_1_58_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_58_1_58_9&#39;)"><span class="hl_varref"><span class="mpre">failWith</span></span></a><span class="mpre"> </span><a href="Network.Stream.html#loc_39_4_39_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_39_4_39_15&#39;)"><span class="hl_conref"><span class="mpre">ErrorClosed</span></span></a><span class="mpre">
</span><a href="#loc_463_1_463_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_1_463_18&#39;)"><span class="hl_fundecl"><span class="mpre">parseResponseHead</span></span></a><span class="mpre"> (</span><a name="loc_464_20_464_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_20_464_23&#39;)"><span class="hl_vardecl"><span class="mpre">sts</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_464_24_464_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_24_464_28&#39;)"><span class="hl_vardecl"><span class="mpre">hdrs</span></span></a><span class="mpre">) = do
  (</span><a name="loc_465_4_465_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_4_465_11&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre">,</span><a name="loc_465_12_465_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_12_465_16&#39;)"><span class="hl_vardecl"><span class="mpre">code</span></span></a><span class="mpre">,</span><a name="loc_465_17_465_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_17_465_23&#39;)"><span class="hl_vardecl"><span class="mpre">reason</span></span></a><span class="mpre">)  &lt;- </span><a href="#loc_469_3_469_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_3_469_17&#39;)"><span class="hl_varref"><span class="mpre">responseStatus</span></span></a><span class="mpre"> </span><a href="#loc_464_20_464_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_20_464_23&#39;)"><span class="hl_varref"><span class="mpre">sts</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">words</span></span><span class="mpre"> </span><a href="#loc_464_20_464_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_20_464_23&#39;)"><span class="hl_varref"><span class="mpre">sts</span></span></a><span class="mpre">)
  </span><a name="loc_466_3_466_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_3_466_8&#39;)"><span class="hl_vardecl"><span class="mpre">hdrs&#39;</span></span></a><span class="mpre">                  &lt;- </span><a href="Network.HTTP.Headers.html#loc_280_1_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_280_1_280_13&#39;)"><span class="hl_varref"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> </span><a href="#loc_464_24_464_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_24_464_28&#39;)"><span class="hl_varref"><span class="mpre">hdrs</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_465_12_465_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_12_465_16&#39;)"><span class="hl_varref"><span class="mpre">code</span></span></a><span class="mpre">,</span><a href="#loc_465_17_465_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_17_465_23&#39;)"><span class="hl_varref"><span class="mpre">reason</span></span></a><span class="mpre">, </span><a href="#loc_494_1_494_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_12&#39;)"><span class="hl_varref"><span class="mpre">withVersion</span></span></a><span class="mpre"> </span><a href="#loc_465_4_465_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_4_465_11&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre"> </span><a href="#loc_466_3_466_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_3_466_8&#39;)"><span class="hl_varref"><span class="mpre">hdrs&#39;</span></span></a><span class="mpre">)
 where
  </span><a name="loc_469_3_469_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_3_469_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseStatus</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_l</span></span><span class="mpre"> </span><span class="hl_specname"><span class="mpre">_yes</span></span><span class="mpre">@(</span><a name="loc_469_27_469_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_27_469_34&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_469_35_469_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_35_469_39&#39;)"><span class="hl_vardecl"><span class="mpre">code</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_469_40_469_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_40_469_46&#39;)"><span class="hl_vardecl"><span class="mpre">reason</span></span></a><span class="mpre">) =
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_469_27_469_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_27_469_34&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">,</span><a href="#loc_480_3_480_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_3_480_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_469_35_469_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_35_469_39&#39;)"><span class="hl_varref"><span class="mpre">code</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre">) </span><a href="#loc_469_40_469_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_40_469_46&#39;)"><span class="hl_varref"><span class="mpre">reason</span></span></a><span class="mpre">)
  </span><a href="#loc_469_3_469_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_3_469_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseStatus</span></span></a><span class="mpre"> </span><a name="loc_471_18_471_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_18_471_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_no</span></span><span class="mpre"> 
    | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_471_18_471_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_18_471_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">    = </span><a href="Network.Stream.html#loc_58_1_58_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_58_1_58_9&#39;)"><span class="hl_varref"><span class="mpre">failWith</span></span></a><span class="mpre"> </span><a href="Network.Stream.html#loc_39_4_39_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_39_4_39_15&#39;)"><span class="hl_conref"><span class="mpre">ErrorClosed</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- an assumption</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_475_3_475_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_3_475_12&#39;)"><span class="hl_varref"><span class="mpre">parse_err</span></span></a><span class="mpre"> </span><a href="#loc_471_18_471_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_18_471_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

  </span><a name="loc_475_3_475_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_3_475_12&#39;)"><span class="hl_fundecl"><span class="mpre">parse_err</span></span></a><span class="mpre"> </span><a name="loc_475_13_475_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_13_475_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = 
    </span><a href="#loc_994_1_994_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_994_1_994_19&#39;)"><span class="hl_varref"><span class="mpre">responseParseError</span></span></a><span class="mpre"> 
        </span><span class="hl_string"><span class="mpre">&quot;parseResponseHead&quot;</span></span><span class="mpre">
        (</span><span class="hl_string"><span class="mpre">&quot;Response status line parse failure: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_475_13_475_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_13_475_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)

  </span><a name="loc_480_3_480_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_3_480_8&#39;)"><span class="hl_fundecl"><span class="mpre">match</span></span></a><span class="mpre"> [</span><a name="loc_480_10_480_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_10_480_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_480_12_480_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_12_480_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,</span><a name="loc_480_14_480_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_14_480_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">] = (</span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="hl_varref"><span class="mpre">digitToInt</span></span></a><span class="mpre"> </span><a href="#loc_480_10_480_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_10_480_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,
                   </span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="hl_varref"><span class="mpre">digitToInt</span></span></a><span class="mpre"> </span><a href="#loc_480_12_480_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_12_480_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">,
                   </span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="hl_varref"><span class="mpre">digitToInt</span></span></a><span class="mpre"> </span><a href="#loc_480_14_480_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_14_480_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
  </span><a href="#loc_480_3_480_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_3_480_8&#39;)"><span class="hl_fundecl"><span class="mpre">match</span></span></a><span class="mpre"> _ = (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)  </span><span class="hl_comment"><span class="mpre">-- will create appropriate behaviour</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- To avoid changing the @RequestData@ and @ResponseData@ types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- just for this (and the upstream backwards compat. woes that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will result in), encode version info as a custom header.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Used by &#39;parseResponseData&#39; and &#39;parseRequestData&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note: the Request and Response types do not currently represent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the version info explicitly in their record types. You have to use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- {get,set}{Request,Response}Version for that.</span></span><span class="mpre">
</span><a href="#loc_494_1_494_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_12&#39;)"><span class="mpre">withVersion</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">] -&gt; [</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">]
</span><a name="loc_494_1_494_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_12&#39;)"><span class="hl_fundecl"><span class="mpre">withVersion</span></span></a><span class="mpre"> </span><a name="loc_494_13_494_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_13_494_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_494_15_494_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_15_494_17&#39;)"><span class="hl_vardecl"><span class="mpre">hs</span></span></a><span class="mpre"> 
 | </span><a href="#loc_494_13_494_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_13_494_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_varref"><span class="mpre">httpVersion</span></span></a><span class="mpre"> = </span><a href="#loc_494_15_494_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_15_494_17&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- don&#39;t bother adding it if the default.</span></span><span class="mpre">
 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = (</span><a href="Network.HTTP.Headers.html#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Headers.html#loc_132_4_132_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_132_4_132_13&#39;)"><span class="hl_conref"><span class="mpre">HdrCustom</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-HTTP-Version&quot;</span></span><span class="mpre">) </span><a href="#loc_494_13_494_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_13_494_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_494_15_494_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_15_494_17&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @getRequestVersion req@ returns the HTTP protocol version of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the request @req@. If @Nothing@, the default &#39;httpVersion&#39; can be assumed.</span></span><span class="mpre">
</span><a href="#loc_501_1_501_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_18&#39;)"><span class="mpre">getRequestVersion</span></a><span class="mpre"> :: </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_501_1_501_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_18&#39;)"><span class="hl_fundecl"><span class="mpre">getRequestVersion</span></span></a><span class="mpre"> </span><a name="loc_501_19_501_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_19_501_20&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_525_1_525_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_1_525_15&#39;)"><span class="hl_varref"><span class="mpre">getHttpVersion</span></span></a><span class="mpre"> </span><a href="#loc_501_19_501_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_19_501_20&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @setRequestVersion v req@ returns a new request, identical to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @req@, but with its HTTP version set to @v@.</span></span><span class="mpre">
</span><a href="#loc_506_1_506_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_1_506_18&#39;)"><span class="mpre">setRequestVersion</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_506_1_506_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_1_506_18&#39;)"><span class="hl_fundecl"><span class="mpre">setRequestVersion</span></span></a><span class="mpre"> </span><a name="loc_506_19_506_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_19_506_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_506_21_506_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_21_506_22&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_533_1_533_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_1_533_15&#39;)"><span class="hl_varref"><span class="mpre">setHttpVersion</span></span></a><span class="mpre"> </span><a href="#loc_506_21_506_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_21_506_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_506_19_506_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_19_506_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @getResponseVersion rsp@ returns the HTTP protocol version of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the response @rsp@. If @Nothing@, the default &#39;httpVersion&#39; can be </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- assumed.</span></span><span class="mpre">
</span><a href="#loc_513_1_513_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_1_513_19&#39;)"><span class="mpre">getResponseVersion</span></a><span class="mpre"> :: </span><a href="#loc_339_6_339_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_513_1_513_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_1_513_19&#39;)"><span class="hl_fundecl"><span class="mpre">getResponseVersion</span></span></a><span class="mpre"> </span><a name="loc_513_20_513_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_20_513_21&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_525_1_525_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_1_525_15&#39;)"><span class="hl_varref"><span class="mpre">getHttpVersion</span></span></a><span class="mpre"> </span><a href="#loc_513_20_513_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_20_513_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @setResponseVersion v rsp@ returns a new response, identical to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @rsp@, but with its HTTP version set to @v@.</span></span><span class="mpre">
</span><a href="#loc_518_1_518_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_1_518_19&#39;)"><span class="mpre">setResponseVersion</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_339_6_339_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_339_6_339_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_518_1_518_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_1_518_19&#39;)"><span class="hl_fundecl"><span class="mpre">setResponseVersion</span></span></a><span class="mpre"> </span><a name="loc_518_20_518_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_20_518_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_518_22_518_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_22_518_23&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_533_1_533_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_1_533_15&#39;)"><span class="hl_varref"><span class="mpre">setHttpVersion</span></span></a><span class="mpre"> </span><a href="#loc_518_22_518_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_22_518_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_518_20_518_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_20_518_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- internal functions for accessing HTTP-version info in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- requests and responses. Not exported as it exposes ho</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- version info is represented internally.</span></span><span class="mpre">

</span><a href="#loc_525_1_525_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_1_525_15&#39;)"><span class="mpre">getHttpVersion</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 524, srcSpanStartColumn = 19, srcSpanEndLine = 524, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 524, srcSpanStartColumn = 32, srcSpanEndLine = 524, srcSpanEndColumn = 34}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000."><span class="mpre">HasHeaders a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_525_1_525_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_1_525_15&#39;)"><span class="hl_fundecl"><span class="mpre">getHttpVersion</span></span></a><span class="mpre"> </span><a name="loc_525_16_525_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_16_525_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = 
  </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_530_3_530_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_3_530_12&#39;)"><span class="hl_varref"><span class="mpre">toVersion</span></span></a><span class="mpre">      </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
   </span><a href="Data.List.html#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_261_1_261_5&#39;)"><span class="hl_varref"><span class="mpre">find</span></span></a><span class="mpre"> </span><a href="#loc_543_1_543_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_14&#39;)"><span class="hl_varref"><span class="mpre">isHttpVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="Network.HTTP.Headers.html#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_204_5_204_15&#39;)"><span class="hl_varref"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a href="#loc_525_16_525_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_16_525_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
 where
  </span><a name="loc_530_3_530_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_3_530_12&#39;)"><span class="hl_fundecl"><span class="mpre">toVersion</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Headers.html#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> _ </span><a name="loc_530_23_530_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_23_530_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_530_23_530_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_23_530_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_533_1_533_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_1_533_15&#39;)"><span class="mpre">setHttpVersion</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 532, srcSpanStartColumn = 19, srcSpanEndLine = 532, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 532, srcSpanStartColumn = 32, srcSpanEndLine = 532, srcSpanEndColumn = 34}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000."><span class="mpre">HasHeaders a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_533_1_533_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_1_533_15&#39;)"><span class="hl_fundecl"><span class="mpre">setHttpVersion</span></span></a><span class="mpre"> </span><a name="loc_533_16_533_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_16_533_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_533_18_533_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_18_533_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = 
  </span><a href="Network.HTTP.Headers.html#loc_205_5_205_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_205_5_205_15&#39;)"><span class="hl_varref"><span class="mpre">setHeaders</span></span></a><span class="mpre"> </span><a href="#loc_533_16_533_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_16_533_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
   </span><a href="#loc_494_1_494_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_12&#39;)"><span class="hl_varref"><span class="mpre">withVersion</span></span></a><span class="mpre"> </span><a href="#loc_533_18_533_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_18_533_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="#loc_540_1_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_1_540_16&#39;)"><span class="hl_varref"><span class="mpre">dropHttpVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
     </span><a href="Network.HTTP.Headers.html#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_204_5_204_15&#39;)"><span class="hl_varref"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a href="#loc_533_16_533_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_16_533_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_540_1_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_1_540_16&#39;)"><span class="mpre">dropHttpVersion</span></a><span class="mpre"> :: [</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">] -&gt; [</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">]
</span><a name="loc_540_1_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_1_540_16&#39;)"><span class="hl_fundecl"><span class="mpre">dropHttpVersion</span></span></a><span class="mpre"> </span><a name="loc_540_17_540_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_17_540_19&#39;)"><span class="hl_vardecl"><span class="mpre">hs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="#loc_543_1_543_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_14&#39;)"><span class="hl_varref"><span class="mpre">isHttpVersion</span></span></a><span class="mpre">) </span><a href="#loc_540_17_540_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_17_540_19&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre">

</span><a href="#loc_543_1_543_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_14&#39;)"><span class="mpre">isHttpVersion</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_543_1_543_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_14&#39;)"><span class="hl_fundecl"><span class="mpre">isHttpVersion</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Headers.html#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Headers.html#loc_132_4_132_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_132_4_132_13&#39;)"><span class="hl_conref"><span class="mpre">HdrCustom</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-HTTP-Version&quot;</span></span><span class="mpre">) _) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_543_1_543_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_1_543_14&#39;)"><span class="hl_fundecl"><span class="mpre">isHttpVersion</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">    



</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------ HTTP Send / Recv ----------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_552_6_552_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_6_552_22&#39;)"><span class="hl_tycondecl"><span class="mpre">ResponseNextStep</span></span></a><span class="mpre">
 = </span><a name="loc_553_4_553_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_4_553_12&#39;)"><span class="hl_condecl"><span class="mpre">Continue</span></span></a><span class="mpre">
 | </span><a name="loc_554_4_554_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_4_554_9&#39;)"><span class="hl_condecl"><span class="mpre">Retry</span></span></a><span class="mpre">
 | </span><a name="loc_555_4_555_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_4_555_8&#39;)"><span class="hl_condecl"><span class="mpre">Done</span></span></a><span class="mpre">
 | </span><a name="loc_556_4_556_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_4_556_16&#39;)"><span class="hl_condecl"><span class="mpre">ExpectEntity</span></span></a><span class="mpre">
 | </span><a name="loc_557_4_557_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_4_557_15&#39;)"><span class="hl_condecl"><span class="mpre">DieHorribly</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">

</span><a href="#loc_560_1_560_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_1_560_14&#39;)"><span class="mpre">matchResponse</span></a><span class="mpre"> :: </span><a href="#loc_250_6_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_6_250_19&#39;)"><span class="hl_tyconref"><span class="mpre">RequestMethod</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ResponseCode</span></span><span class="mpre"> -&gt; </span><a href="#loc_552_6_552_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_6_552_22&#39;)"><span class="hl_tyconref"><span class="mpre">ResponseNextStep</span></span></a><span class="mpre">
</span><a name="loc_560_1_560_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_1_560_14&#39;)"><span class="hl_fundecl"><span class="mpre">matchResponse</span></span></a><span class="mpre"> </span><a name="loc_560_15_560_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_15_560_19&#39;)"><span class="hl_vardecl"><span class="mpre">rqst</span></span></a><span class="mpre"> </span><a name="loc_560_20_560_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_20_560_23&#39;)"><span class="hl_vardecl"><span class="mpre">rsp</span></span></a><span class="mpre"> =
    case </span><a href="#loc_560_20_560_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_20_560_23&#39;)"><span class="hl_varref"><span class="mpre">rsp</span></span></a><span class="mpre"> of
        (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) -&gt; </span><a href="#loc_553_4_553_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_4_553_12&#39;)"><span class="hl_conref"><span class="mpre">Continue</span></span></a><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) -&gt; </span><a href="#loc_555_4_555_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_4_555_8&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- upgrade to TLS</span></span><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,_,_) -&gt; </span><a href="#loc_553_4_553_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_4_553_12&#39;)"><span class="hl_conref"><span class="mpre">Continue</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- default</span></span><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) -&gt; </span><a href="#loc_555_4_555_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_4_555_8&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">) -&gt; </span><a href="#loc_555_4_555_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_4_555_8&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,_,_) -&gt; </span><a href="#loc_576_9_576_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_9_576_12&#39;)"><span class="hl_varref"><span class="mpre">ans</span></span></a><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) -&gt; </span><a href="#loc_555_4_555_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_4_555_8&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">) -&gt; </span><a href="#loc_555_4_555_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_4_555_8&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,_,_) -&gt; </span><a href="#loc_576_9_576_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_9_576_12&#39;)"><span class="hl_varref"><span class="mpre">ans</span></span></a><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) -&gt; </span><a href="#loc_554_4_554_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_4_554_9&#39;)"><span class="hl_conref"><span class="mpre">Retry</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- Expectation failed</span></span><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,_,_) -&gt; </span><a href="#loc_576_9_576_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_9_576_12&#39;)"><span class="hl_varref"><span class="mpre">ans</span></span></a><span class="mpre">
        (</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,_,_) -&gt; </span><a href="#loc_576_9_576_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_9_576_12&#39;)"><span class="hl_varref"><span class="mpre">ans</span></span></a><span class="mpre">
        (</span><a name="loc_574_10_574_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_10_574_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_574_12_574_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_12_574_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,</span><a name="loc_574_14_574_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_14_574_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_557_4_557_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_4_557_15&#39;)"><span class="hl_conref"><span class="mpre">DieHorribly</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Response code &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">intToDigit</span></span><span class="mpre"> [</span><a href="#loc_574_10_574_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_10_574_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_574_12_574_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_12_574_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">,</span><a href="#loc_574_14_574_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_14_574_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; not recognised&quot;</span></span><span class="mpre">)
    where
        </span><a name="loc_576_9_576_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_9_576_12&#39;)"><span class="hl_vardecl"><span class="mpre">ans</span></span></a><span class="mpre"> | </span><a href="#loc_560_15_560_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_15_560_19&#39;)"><span class="hl_varref"><span class="mpre">rqst</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_250_22_250_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_22_250_26&#39;)"><span class="hl_conref"><span class="mpre">HEAD</span></span></a><span class="mpre"> = </span><a href="#loc_555_4_555_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_4_555_8&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    = </span><a href="#loc_556_4_556_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_4_556_16&#39;)"><span class="hl_conref"><span class="mpre">ExpectEntity</span></span></a><span class="mpre">
        

        
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------ A little friendly funtionality ---------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">{-
    I had a quick look around but couldn&#39;t find any RFC about
    the encoding of data on the query string.  I did find an
    IETF memo, however, so this is how I justify the urlEncode
    and urlDecode methods.

    Doc name: draft-tiwari-appl-wxxx-forms-01.txt  (look on www.ietf.org)

    Reserved chars:  &quot;;&quot;, &quot;/&quot;, &quot;?&quot;, &quot;:&quot;, &quot;@&quot;, &quot;&amp;&quot;, &quot;=&quot;, &quot;+&quot;, &quot;,&quot;, and &quot;$&quot; are reserved.
    Unwise: &quot;{&quot; | &quot;}&quot; | &quot;|&quot; | &quot;\&quot; | &quot;^&quot; | &quot;[&quot; | &quot;]&quot; | &quot;`&quot;
    URI delims: &quot;&lt;&quot; | &quot;&gt;&quot; | &quot;#&quot; | &quot;%&quot; | &lt;&quot;&gt;
    Unallowed ASCII: &lt;US-ASCII coded characters 00-1F and 7F hexadecimal&gt;
                     &lt;US-ASCII coded character 20 hexadecimal&gt;
    Also unallowed:  any non-us-ascii character

    Escape method: char -&gt; &#39;%&#39; a b  where a, b :: Hex digits
-}</span></span><span class="mpre">

</span><a href="#loc_605_1_605_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_22&#39;)"><span class="mpre">replacement_character</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_605_1_605_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_22&#39;)"><span class="hl_vardecl"><span class="mpre">replacement_character</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;\xfffd&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode a single Haskell Char to a list of Word8 values, in UTF8 format.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Shamelessly stolen from utf-8string-0.3.7</span></span><span class="mpre">
</span><a href="#loc_611_1_611_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_11&#39;)"><span class="mpre">encodeChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_611_1_611_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_11&#39;)"><span class="hl_vardecl"><span class="mpre">encodeChar</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_613_3_613_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_3_613_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">
 where
  </span><a name="loc_613_3_613_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_3_613_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_vardecl"><span class="mpre">oc</span></span></a><span class="mpre">
   | </span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7f</span></span><span class="mpre">       = [</span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre">]

   | </span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7ff</span></span><span class="mpre">      = [ </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                        ]

   | </span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xffff</span></span><span class="mpre">     = [ </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                        ]
   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = [ </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_613_6_613_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_6_613_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                        ]

</span><span class="hl_comment"><span class="mpre">-- | Decode a UTF8 string packed into a list of Word8 values, directly to String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Shamelessly stolen from utf-8string-0.3.7</span></span><span class="mpre">
</span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="mpre">decode</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_fundecl"><span class="mpre">decode</span></span></a><span class="mpre"> [    ] = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
</span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_fundecl"><span class="mpre">decode</span></span></a><span class="mpre"> (</span><a name="loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_635_11_635_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_11_635_13&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
  | </span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">  = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_635_11_635_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_11_635_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre">  = </span><a href="#loc_605_1_605_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_635_11_635_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_11_635_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre">  = </span><a href="#loc_645_5_645_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_5_645_11&#39;)"><span class="hl_varref"><span class="mpre">multi1</span></span></a><span class="mpre">
  | </span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre">  = </span><a href="#loc_653_5_653_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_5_653_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x800</span></span><span class="mpre">
  | </span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf8</span></span><span class="mpre">  = </span><a href="#loc_653_5_653_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_5_653_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">
  | </span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfc</span></span><span class="mpre">  = </span><a href="#loc_653_5_653_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_5_653_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x200000</span></span><span class="mpre">
  | </span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfe</span></span><span class="mpre">  = </span><a href="#loc_653_5_653_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_5_653_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x4000000</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_605_1_605_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_635_11_635_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_11_635_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  where
    </span><a name="loc_645_5_645_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_5_645_11&#39;)"><span class="hl_vardecl"><span class="mpre">multi1</span></span></a><span class="mpre"> = case </span><a href="#loc_635_11_635_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_11_635_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
      </span><a name="loc_646_7_646_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_7_646_9&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_646_12_646_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_12_646_14&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre"> | </span><a href="#loc_646_7_646_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_7_646_9&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> -&gt;
        let </span><a name="loc_647_13_647_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_13_647_14&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = ((</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1f</span></span><span class="mpre">) </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre">  </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_646_7_646_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_7_646_9&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
        in if </span><a href="#loc_647_13_647_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_13_647_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x000080</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_647_13_647_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_13_647_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_646_12_646_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_12_646_14&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
                            else </span><a href="#loc_605_1_605_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_646_12_646_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_12_646_14&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
      _ -&gt; </span><a href="#loc_605_1_605_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_635_11_635_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_11_635_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

    </span><a href="#loc_653_5_653_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_5_653_15&#39;)"><span class="mpre">multi_byte</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
    </span><a name="loc_653_5_653_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_5_653_15&#39;)"><span class="hl_fundecl"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><a name="loc_653_16_653_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_16_653_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_653_18_653_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_18_653_22&#39;)"><span class="hl_vardecl"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a name="loc_653_23_653_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_23_653_31&#39;)"><span class="hl_vardecl"><span class="mpre">overlong</span></span></a><span class="mpre"> = </span><a href="#loc_655_9_655_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_9_655_12&#39;)"><span class="hl_varref"><span class="mpre">aux</span></span></a><span class="mpre"> </span><a href="#loc_653_16_653_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_16_653_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_635_11_635_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_11_635_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_635_9_635_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_9_635_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><a href="#loc_653_18_653_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_18_653_22&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre">))
      where
        </span><a name="loc_655_9_655_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_9_655_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_655_15_655_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_15_655_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> </span><a name="loc_655_18_655_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_18_655_21&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
          | </span><a href="#loc_653_23_653_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_23_653_31&#39;)"><span class="hl_varref"><span class="mpre">overlong</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_655_18_655_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_18_655_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_655_18_655_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_18_655_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10ffff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
            (</span><a href="#loc_655_18_655_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_18_655_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xd800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xdfff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_655_18_655_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_18_655_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)     </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
            (</span><a href="#loc_655_18_655_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_18_655_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfffe</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xffff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_655_18_655_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_18_655_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)      = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><a href="#loc_655_18_655_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_18_655_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_655_15_655_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_15_655_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_605_1_605_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_655_15_655_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_15_655_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">

        </span><a href="#loc_655_9_655_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_9_655_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> </span><a name="loc_661_13_661_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_13_661_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a name="loc_661_16_661_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_16_661_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_661_18_661_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_18_661_20&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) </span><a name="loc_661_22_661_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_22_661_25&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
          | </span><a href="#loc_661_16_661_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_16_661_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> = </span><a href="#loc_655_9_655_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_9_655_12&#39;)"><span class="hl_varref"><span class="mpre">aux</span></span></a><span class="mpre"> (</span><a href="#loc_661_13_661_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_13_661_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_661_18_661_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_18_661_20&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
                               </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_661_22_661_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_22_661_25&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_661_16_661_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_16_661_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)

        </span><a href="#loc_655_9_655_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_655_9_655_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> _ </span><a name="loc_665_15_665_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_15_665_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">     _ = </span><a href="#loc_605_1_605_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_665_15_665_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_15_665_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- This function is a bit funny because potentially the input String could contain some actual Unicode</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- characters (though this shouldn&#39;t happen for most use cases), so we have to preserve those characters</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- while simultaneously decoding any UTF-8 data</span></span><span class="mpre">
</span><a href="#loc_672_1_672_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_1_672_10&#39;)"><span class="mpre">urlDecode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_672_1_672_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_1_672_10&#39;)"><span class="hl_vardecl"><span class="mpre">urlDecode</span></span></a><span class="mpre"> = </span><a href="#loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> []
  where
    </span><a name="loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_674_8_674_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_8_674_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_674_16_674_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_16_674_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_674_18_674_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_18_674_19&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_674_20_674_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_20_674_24&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)           = </span><a href="#loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="hl_varref"><span class="mpre">digitToInt</span></span></a><span class="mpre"> </span><a href="#loc_674_16_674_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_16_674_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Data.Char.html#loc_70_1_70_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_70_1_70_11&#39;)"><span class="hl_varref"><span class="mpre">digitToInt</span></span></a><span class="mpre"> </span><a href="#loc_674_18_674_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_18_674_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_674_8_674_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_8_674_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a href="#loc_674_20_674_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_20_674_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
    </span><a href="#loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_675_8_675_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_8_675_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> (</span><a name="loc_675_12_675_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_12_675_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_675_14_675_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_14_675_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_675_12_675_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_12_675_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">256</span></span><span class="mpre"> = </span><a href="#loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_675_12_675_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_12_675_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_675_8_675_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_8_675_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a href="#loc_675_14_675_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_14_675_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- Treat ASCII as just another byte of UTF-8</span></span><span class="mpre">
    </span><a href="#loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] []                       = []
    </span><a href="#loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] (</span><a name="loc_677_12_677_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_12_677_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_677_14_677_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_14_677_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">)                    = </span><a href="#loc_677_12_677_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_12_677_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><a href="#loc_677_14_677_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_14_677_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- h &gt;= 256, so can&#39;t be part of any UTF-8 byte sequence</span></span><span class="mpre">
    </span><a href="#loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_678_8_678_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_8_678_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a name="loc_678_11_678_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_11_678_15&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">                     = </span><a href="#loc_634_1_634_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_1_634_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_678_8_678_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_8_678_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_674_5_674_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_5_674_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><a href="#loc_678_11_678_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_11_678_15&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">


</span><a href="#loc_682_1_682_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_1_682_10&#39;)"><span class="mpre">urlEncode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_682_1_682_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_1_682_10&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncode</span></span></a><span class="mpre">     [] = []
</span><a href="#loc_682_1_682_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_1_682_10&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncode</span></span></a><span class="mpre"> (</span><a name="loc_683_12_683_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_12_683_14&#39;)"><span class="hl_vardecl"><span class="mpre">ch</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_683_15_683_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_15_683_16&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) 
  | (</span><a href="GHC.Unicode.html#loc_41_1_41_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_41_1_41_8&#39;)"><span class="hl_varref"><span class="mpre">isAscii</span></span></a><span class="mpre"> </span><a href="#loc_683_12_683_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_12_683_14&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_136_1_136_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_136_1_136_11&#39;)"><span class="hl_varref"><span class="mpre">isAlphaNum</span></span></a><span class="mpre"> </span><a href="#loc_683_12_683_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_12_683_14&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_683_12_683_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_12_683_14&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-_.~&quot;</span></span><span class="mpre"> = </span><a href="#loc_683_12_683_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_12_683_14&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_682_1_682_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_1_682_10&#39;)"><span class="hl_varref"><span class="mpre">urlEncode</span></span></a><span class="mpre"> </span><a href="#loc_683_15_683_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_15_683_16&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="GHC.Unicode.html#loc_41_1_41_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_41_1_41_8&#39;)"><span class="hl_varref"><span class="mpre">isAscii</span></span></a><span class="mpre"> </span><a href="#loc_683_12_683_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_12_683_14&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_688_6_688_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_6_688_12&#39;)"><span class="hl_varref"><span class="mpre">escape</span></span></a><span class="mpre"> (</span><a href="#loc_682_1_682_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_1_682_10&#39;)"><span class="hl_varref"><span class="mpre">urlEncode</span></span></a><span class="mpre"> </span><a href="#loc_683_15_683_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_15_683_16&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) (</span><a href="#loc_611_1_611_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_11&#39;)"><span class="hl_varref"><span class="mpre">encodeChar</span></span></a><span class="mpre"> </span><a href="#loc_683_12_683_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_12_683_14&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">)
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_688_6_688_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_6_688_12&#39;)"><span class="hl_varref"><span class="mpre">escape</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_683_12_683_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_12_683_14&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">)) (</span><a href="#loc_682_1_682_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_1_682_10&#39;)"><span class="hl_varref"><span class="mpre">urlEncode</span></span></a><span class="mpre"> </span><a href="#loc_683_15_683_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_15_683_16&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
    where
     </span><a name="loc_688_6_688_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_6_688_12&#39;)"><span class="hl_fundecl"><span class="mpre">escape</span></span></a><span class="mpre"> </span><a name="loc_688_13_688_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_13_688_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_688_15_688_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_15_688_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_691_6_691_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_6_691_11&#39;)"><span class="hl_varref"><span class="mpre">showH</span></span></a><span class="mpre"> (</span><a href="#loc_688_13_688_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_13_688_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) (</span><a href="#loc_691_6_691_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_6_691_11&#39;)"><span class="hl_varref"><span class="mpre">showH</span></span></a><span class="mpre"> (</span><a href="#loc_688_13_688_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_13_688_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) </span><a href="#loc_688_15_688_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_15_688_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)

     </span><a href="#loc_691_6_691_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_6_691_11&#39;)"><span class="mpre">showH</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
     </span><a name="loc_691_6_691_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_6_691_11&#39;)"><span class="hl_fundecl"><span class="mpre">showH</span></span></a><span class="mpre"> </span><a name="loc_691_12_691_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_12_691_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_691_14_691_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_14_691_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">
       | </span><a href="#loc_691_12_691_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_12_691_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">    = </span><a href="#loc_695_8_695_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_8_695_10&#39;)"><span class="hl_varref"><span class="mpre">to</span></span></a><span class="mpre"> (</span><a href="#loc_698_8_698_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_8_698_11&#39;)"><span class="hl_varref"><span class="mpre">o_0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_691_12_691_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_12_691_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_691_14_691_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_14_691_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_695_8_695_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_8_695_10&#39;)"><span class="hl_varref"><span class="mpre">to</span></span></a><span class="mpre"> (</span><a href="#loc_699_8_699_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_8_699_11&#39;)"><span class="hl_varref"><span class="mpre">o_A</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_691_12_691_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_12_691_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_691_14_691_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_14_691_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
      where
       </span><a name="loc_695_8_695_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_8_695_10&#39;)"><span class="hl_vardecl"><span class="mpre">to</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">  </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">
       </span><a name="loc_696_8_696_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_8_696_11&#39;)"><span class="hl_vardecl"><span class="mpre">fro</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre">

       </span><a name="loc_698_8_698_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_8_698_11&#39;)"><span class="hl_vardecl"><span class="mpre">o_0</span></span></a><span class="mpre"> = </span><a href="#loc_696_8_696_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_8_696_11&#39;)"><span class="hl_varref"><span class="mpre">fro</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">
       </span><a name="loc_699_8_699_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_8_699_11&#39;)"><span class="hl_vardecl"><span class="mpre">o_A</span></span></a><span class="mpre"> = </span><a href="#loc_696_8_696_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_8_696_11&#39;)"><span class="hl_varref"><span class="mpre">fro</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;A&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Encode form variables, useable in either the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- query part of a URI, or the body of a POST request.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- I have no source for this information except experience,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this sort of encoding worked fine in CGI programming.</span></span><span class="mpre">
</span><a href="#loc_706_1_706_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_1_706_14&#39;)"><span class="mpre">urlEncodeVars</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_706_1_706_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_1_706_14&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncodeVars</span></span></a><span class="mpre"> ((</span><a name="loc_706_17_706_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_17_706_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,</span><a name="loc_706_19_706_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_19_706_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_706_22_706_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_22_706_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) =
    let (</span><a name="loc_707_10_707_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_10_707_14&#39;)"><span class="hl_vardecl"><span class="mpre">same</span></span></a><span class="mpre">,</span><a name="loc_707_15_707_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_15_707_19&#39;)"><span class="hl_vardecl"><span class="mpre">diff</span></span></a><span class="mpre">) = </span><a href="Data.List.html#loc_464_1_464_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_464_1_464_10&#39;)"><span class="hl_varref"><span class="mpre">partition</span></span></a><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_706_17_706_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_17_706_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) </span><a href="#loc_706_22_706_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_22_706_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
    in </span><a href="#loc_682_1_682_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_1_682_10&#39;)"><span class="hl_varref"><span class="mpre">urlEncode</span></span></a><span class="mpre"> </span><a href="#loc_706_17_706_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_17_706_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> (\</span><a name="loc_708_37_708_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_37_708_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_708_39_708_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_39_708_40&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_708_37_708_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_37_708_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_682_1_682_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_1_682_10&#39;)"><span class="hl_varref"><span class="mpre">urlEncode</span></span></a><span class="mpre"> </span><a href="#loc_708_39_708_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_39_708_40&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a href="#loc_682_1_682_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_1_682_10&#39;)"><span class="hl_varref"><span class="mpre">urlEncode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_706_19_706_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_19_706_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_707_10_707_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_10_707_14&#39;)"><span class="hl_varref"><span class="mpre">same</span></span></a><span class="mpre">)
       </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_710_14_710_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_710_14_710_27&#39;)"><span class="hl_varref"><span class="mpre">urlEncodeRest</span></span></a><span class="mpre"> </span><a href="#loc_707_15_707_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_15_707_19&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre">
       where </span><a name="loc_710_14_710_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_710_14_710_27&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncodeRest</span></span></a><span class="mpre"> [] = []
             </span><a href="#loc_710_14_710_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_710_14_710_27&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncodeRest</span></span></a><span class="mpre"> </span><a name="loc_711_28_711_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_28_711_32&#39;)"><span class="hl_vardecl"><span class="mpre">diff</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;&amp;&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_706_1_706_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_1_706_14&#39;)"><span class="hl_varref"><span class="mpre">urlEncodeVars</span></span></a><span class="mpre"> </span><a href="#loc_711_28_711_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_28_711_32&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre">
</span><a href="#loc_706_1_706_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_706_1_706_14&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncodeVars</span></span></a><span class="mpre"> [] = []

</span><span class="hl_comment"><span class="mpre">-- | @getAuth req@ fishes out the authority portion of the URL in a request&#39;s @Host@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- header.</span></span><span class="mpre">
</span><a href="#loc_717_1_717_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_1_717_8&#39;)"><span class="mpre">getAuth</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 716, srcSpanStartColumn = 12, srcSpanEndLine = 716, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 716, srcSpanStartColumn = 20, srcSpanEndLine = 716, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000."><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><a href="#loc_138_6_138_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_18&#39;)"><span class="hl_tyconref"><span class="mpre">URIAuthority</span></span></a><span class="mpre">
</span><a name="loc_717_1_717_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_1_717_8&#39;)"><span class="hl_fundecl"><span class="mpre">getAuth</span></span></a><span class="mpre"> </span><a name="loc_717_9_717_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_9_717_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = 
   </span><span class="hl_comment"><span class="mpre">-- ToDo: verify that Network.URI functionality doesn&#39;t take care of this (now.)</span></span><span class="mpre">
  case </span><a href="#loc_152_1_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_18&#39;)"><span class="hl_varref"><span class="mpre">parseURIAuthority</span></span></a><span class="mpre"> </span><a href="#loc_723_3_723_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_3_723_7&#39;)"><span class="hl_varref"><span class="mpre">auth</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_720_10_720_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_720_10_720_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_720_10_720_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_720_10_720_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> 
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Network.HTTP.Base.getAuth: Error parsing URI authority &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_723_3_723_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_3_723_7&#39;)"><span class="hl_varref"><span class="mpre">auth</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;&quot;</span></span><span class="mpre">
 where 
  </span><a name="loc_723_3_723_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_3_723_7&#39;)"><span class="hl_vardecl"><span class="mpre">auth</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><a href="#loc_186_1_186_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_21&#39;)"><span class="hl_varref"><span class="mpre">uriToAuthorityString</span></span></a><span class="mpre"> </span><a href="#loc_724_3_724_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_3_724_6&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> (</span><a href="Network.HTTP.Headers.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">findHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_92_4_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_92_4_92_11&#39;)"><span class="hl_conref"><span class="mpre">HdrHost</span></span></a><span class="mpre"> </span><a href="#loc_717_9_717_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_9_717_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
  </span><a name="loc_724_3_724_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_3_724_6&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="mpre">  = </span><a href="#loc_293_16_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_16_293_21&#39;)"><span class="hl_varref"><span class="mpre">rqURI</span></span></a><span class="mpre"> </span><a href="#loc_717_9_717_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_9_717_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 726, srcSpanStartColumn = 1, srcSpanEndLine = 726, srcSpanEndColumn = 95}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 726, srcSpanStartColumn = 1, srcSpanEndLine = 726, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpan"><span class="mpre">{-# DEPRECATED normalizeRequestURI &quot;Please use Network.HTTP.Base.normalizeRequest instead&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_728_1_728_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_1_728_20&#39;)"><span class="mpre">normalizeRequestURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="hl_comment"><span class="mpre">{-do close-}</span></span><span class="mpre"> -&gt; </span><span class="hl_comment"><span class="mpre">{-URI-}</span></span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre"> -&gt; </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
</span><a name="loc_728_1_728_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_1_728_20&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeRequestURI</span></span></a><span class="mpre"> </span><a name="loc_728_21_728_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_21_728_28&#39;)"><span class="hl_vardecl"><span class="mpre">doClose</span></span></a><span class="mpre"> </span><a name="loc_728_29_728_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_29_728_30&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">r</span></span><span class="mpre"> = 
  (if </span><a href="#loc_728_21_728_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_21_728_28&#39;)"><span class="hl_varref"><span class="mpre">doClose</span></span></a><span class="mpre"> then </span><a href="Network.HTTP.Headers.html#loc_232_1_232_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_232_1_232_14&#39;)"><span class="hl_varref"><span class="mpre">replaceHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_77_4_77_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_77_4_77_17&#39;)"><span class="hl_conref"><span class="mpre">HdrConnection</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;close&quot;</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="Network.HTTP.Headers.html#loc_222_1_222_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_222_1_222_22&#39;)"><span class="hl_varref"><span class="mpre">insertHeaderIfMissing</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_92_4_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_92_4_92_11&#39;)"><span class="hl_conref"><span class="mpre">HdrHost</span></span></a><span class="mpre"> </span><a href="#loc_728_29_728_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_29_728_30&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 731, srcSpanStartColumn = 5, srcSpanEndLine = 733, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 731, srcSpanStartColumn = 7, srcSpanEndLine = 731, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartL"><span class="mpre">r { rqURI = (rqURI r){ uriScheme = &quot;&quot;
                         , uriAuthority = Nothing
                         }}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @NormalizeRequestOptions@ brings together the various defaulting\/normalization options</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- over &#39;Request&#39;s. Use &#39;defaultNormalizeRequestOptions&#39; for the standard selection of option</span></span><span class="mpre">
data </span><a name="loc_737_6_737_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_6_737_29&#39;)"><span class="hl_tycondecl"><span class="mpre">NormalizeRequestOptions</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
 = </span><span class="hl_condecl"><span class="mpre">NormalizeRequestOptions</span></span><span class="mpre">
     { </span><a name="loc_739_8_739_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_8_739_19&#39;)"><span class="hl_fielddecl"><span class="mpre">normDoClose</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
     , </span><a name="loc_740_8_740_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_8_740_20&#39;)"><span class="hl_fielddecl"><span class="mpre">normForProxy</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
     , </span><a name="loc_741_8_741_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_8_741_21&#39;)"><span class="hl_fielddecl"><span class="mpre">normUserAgent</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
     , </span><a name="loc_742_8_742_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_8_742_19&#39;)"><span class="hl_fielddecl"><span class="mpre">normCustoms</span></span></a><span class="mpre">   :: [</span><span class="hl_tyconref"><span class="mpre">RequestNormalizer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">]
     }

</span><span class="hl_comment"><span class="mpre">-- | @RequestNormalizer@ is the shape of a (pure) function that rewrites</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a request into some normalized form.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 747, srcSpanStartColumn = 1, srcSpanEndLine = 747, srcSpanEndColumn = 83}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 747, srcSpanStartColumn = 1, srcSpanEndLine = 747, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLi"><span class="mpre">type RequestNormalizer ty = NormalizeRequestOptions ty -&gt; Request ty -&gt; Request ty</span></span><span class="mpre">

</span><a href="#loc_750_1_750_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_1_750_31&#39;)"><span class="mpre">defaultNormalizeRequestOptions</span></a><span class="mpre"> :: </span><a href="#loc_737_6_737_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_6_737_29&#39;)"><span class="hl_tyconref"><span class="mpre">NormalizeRequestOptions</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
</span><a name="loc_750_1_750_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_1_750_31&#39;)"><span class="hl_vardecl"><span class="mpre">defaultNormalizeRequestOptions</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 750, srcSpanStartColumn = 34, srcSpanEndLine = 755, srcSpanEndColumn = 7}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 751, srcSpanStartColumn = 6, srcSpanEndLine = 751, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartL"><span class="mpre">NormalizeRequestOptions
     { normDoClose   = False
     , normForProxy  = False
     , normUserAgent = Just defaultUserAgent
     , normCustoms   = []
     }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @normalizeRequest opts req@ is the entry point to use to normalize your</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- request prior to transmission (or other use.) Normalization is controlled</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- via the @NormalizeRequestOptions@ record.</span></span><span class="mpre">
</span><a href="#loc_763_1_763_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_1_763_17&#39;)"><span class="mpre">normalizeRequest</span></a><span class="mpre"> :: </span><a href="#loc_737_6_737_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_6_737_29&#39;)"><span class="hl_tyconref"><span class="mpre">NormalizeRequestOptions</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
                 -&gt; </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
                 -&gt; </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
</span><a name="loc_763_1_763_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_1_763_17&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeRequest</span></span></a><span class="mpre"> </span><a name="loc_763_18_763_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_18_763_22&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a name="loc_763_23_763_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_23_763_26&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (\ </span><a name="loc_763_38_763_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_38_763_39&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_763_38_763_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_38_763_39&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_763_18_763_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_18_763_22&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre">) </span><a href="#loc_763_23_763_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_23_763_26&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_766_3_766_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_3_766_14&#39;)"><span class="hl_varref"><span class="mpre">normalizers</span></span></a><span class="mpre">
 where
  </span><span class="hl_comment"><span class="mpre">--normalizers :: [RequestNormalizer ty]</span></span><span class="mpre">
  </span><a name="loc_766_3_766_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_3_766_14&#39;)"><span class="hl_vardecl"><span class="mpre">normalizers</span></span></a><span class="mpre"> = 
     ( </span><a href="#loc_815_1_815_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_1_815_17&#39;)"><span class="hl_varref"><span class="mpre">normalizeHostURI</span></span></a><span class="mpre">
     </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_798_1_798_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_1_798_19&#39;)"><span class="hl_varref"><span class="mpre">normalizeBasicAuth</span></span></a><span class="mpre">
     </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_790_1_790_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_1_790_25&#39;)"><span class="hl_varref"><span class="mpre">normalizeConnectionClose</span></span></a><span class="mpre">
     </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_778_1_778_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_1_778_19&#39;)"><span class="hl_varref"><span class="mpre">normalizeUserAgent</span></span></a><span class="mpre"> 
     </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_742_8_742_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_8_742_19&#39;)"><span class="hl_varref"><span class="mpre">normCustoms</span></span></a><span class="mpre"> </span><a href="#loc_763_18_763_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_18_763_22&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre">
     )

</span><span class="hl_comment"><span class="mpre">-- | @normalizeUserAgent ua x req@ augments the request @req@ with </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a @User-Agent: ua@ header if @req@ doesn&#39;t already have a </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a @User-Agent:@ set.</span></span><span class="mpre">
</span><a href="#loc_778_1_778_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_1_778_19&#39;)"><span class="mpre">normalizeUserAgent</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">RequestNormalizer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
</span><a name="loc_778_1_778_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_1_778_19&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeUserAgent</span></span></a><span class="mpre"> </span><a name="loc_778_20_778_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_20_778_24&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a name="loc_778_25_778_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_25_778_28&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = 
  case </span><a href="#loc_741_8_741_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_8_741_21&#39;)"><span class="hl_varref"><span class="mpre">normUserAgent</span></span></a><span class="mpre"> </span><a href="#loc_778_20_778_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_20_778_24&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_778_25_778_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_25_778_28&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_781_10_781_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_781_10_781_12&#39;)"><span class="hl_vardecl"><span class="mpre">ua</span></span></a><span class="mpre"> -&gt; 
     case </span><a href="Network.HTTP.Headers.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">findHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_102_4_102_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_102_4_102_16&#39;)"><span class="hl_conref"><span class="mpre">HdrUserAgent</span></span></a><span class="mpre"> </span><a href="#loc_778_25_778_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_25_778_28&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> of
       </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_783_13_783_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_783_13_783_14&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">  | </span><a href="#loc_783_13_783_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_783_13_783_14&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_373_1_373_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_17&#39;)"><span class="hl_varref"><span class="mpre">defaultUserAgent</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_778_25_778_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_25_778_28&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
       _ -&gt; </span><a href="Network.HTTP.Headers.html#loc_232_1_232_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_232_1_232_14&#39;)"><span class="hl_varref"><span class="mpre">replaceHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_102_4_102_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_102_4_102_16&#39;)"><span class="hl_conref"><span class="mpre">HdrUserAgent</span></span></a><span class="mpre"> </span><a href="#loc_781_10_781_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_781_10_781_12&#39;)"><span class="hl_varref"><span class="mpre">ua</span></span></a><span class="mpre"> </span><a href="#loc_778_25_778_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_25_778_28&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @normalizeConnectionClose opts req@ sets the header @Connection: close@ </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to indicate one-shot behavior iff @normDoClose@ is @True@. i.e., it then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _replaces_ any an existing @Connection:@ header in @req@.</span></span><span class="mpre">
</span><a href="#loc_790_1_790_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_1_790_25&#39;)"><span class="mpre">normalizeConnectionClose</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">RequestNormalizer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
</span><a name="loc_790_1_790_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_1_790_25&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeConnectionClose</span></span></a><span class="mpre"> </span><a name="loc_790_26_790_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_26_790_30&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a name="loc_790_31_790_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_31_790_34&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> 
 | </span><a href="#loc_739_8_739_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_8_739_19&#39;)"><span class="hl_varref"><span class="mpre">normDoClose</span></span></a><span class="mpre"> </span><a href="#loc_790_26_790_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_26_790_30&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Headers.html#loc_232_1_232_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_232_1_232_14&#39;)"><span class="hl_varref"><span class="mpre">replaceHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_77_4_77_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_77_4_77_17&#39;)"><span class="hl_conref"><span class="mpre">HdrConnection</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;close&quot;</span></span><span class="mpre"> </span><a href="#loc_790_31_790_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_31_790_34&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = </span><a href="#loc_790_31_790_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_31_790_34&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @normalizeBasicAuth opts req@ sets the header @Authorization: Basic...@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- if the &quot;user:pass@&quot; part is present in the &quot;http://user:pass@host/path&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of the URI. If Authorization header was present already it is not replaced.</span></span><span class="mpre">
</span><a href="#loc_798_1_798_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_1_798_19&#39;)"><span class="mpre">normalizeBasicAuth</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">RequestNormalizer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
</span><a name="loc_798_1_798_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_1_798_19&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeBasicAuth</span></span></a><span class="mpre"> _ </span><a name="loc_798_22_798_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_22_798_25&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> =
  case </span><a href="#loc_717_1_717_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_1_717_8&#39;)"><span class="hl_varref"><span class="mpre">getAuth</span></span></a><span class="mpre"> </span><a href="#loc_798_22_798_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_22_798_25&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_800_10_800_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_800_10_800_17&#39;)"><span class="hl_vardecl"><span class="mpre">uriauth</span></span></a><span class="mpre"> -&gt;
      case (</span><a href="#loc_138_36_138_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_36_138_40&#39;)"><span class="hl_varref"><span class="mpre">user</span></span></a><span class="mpre"> </span><a href="#loc_800_10_800_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_800_10_800_17&#39;)"><span class="hl_varref"><span class="mpre">uriauth</span></span></a><span class="mpre">, </span><a href="#loc_139_36_139_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_36_139_44&#39;)"><span class="hl_varref"><span class="mpre">password</span></span></a><span class="mpre"> </span><a href="#loc_800_10_800_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_800_10_800_17&#39;)"><span class="hl_varref"><span class="mpre">uriauth</span></span></a><span class="mpre">) of
        (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_802_15_802_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_15_802_16&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_802_23_802_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_23_802_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) -&gt;
          </span><a href="Network.HTTP.Headers.html#loc_222_1_222_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_222_1_222_22&#39;)"><span class="hl_varref"><span class="mpre">insertHeaderIfMissing</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_88_4_88_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_88_4_88_20&#39;)"><span class="hl_conref"><span class="mpre">HdrAuthorization</span></span></a><span class="mpre"> </span><a href="#loc_805_15_805_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_15_805_19&#39;)"><span class="hl_varref"><span class="mpre">astr</span></span></a><span class="mpre"> </span><a href="#loc_798_22_798_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_22_798_25&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
            where
              </span><a name="loc_805_15_805_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_15_805_19&#39;)"><span class="hl_vardecl"><span class="mpre">astr</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Basic &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_806_15_806_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_15_806_27&#39;)"><span class="hl_varref"><span class="mpre">base64encode</span></span></a><span class="mpre"> (</span><a href="#loc_802_15_802_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_15_802_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_802_23_802_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_23_802_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
              </span><a name="loc_806_15_806_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_15_806_27&#39;)"><span class="hl_vardecl"><span class="mpre">base64encode</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Base64.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base64.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">Base64.encode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_807_15_807_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_807_15_807_29&#39;)"><span class="hl_varref"><span class="mpre">stringToOctets</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
              </span><a name="loc_807_15_807_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_807_15_807_29&#39;)"><span class="hl_vardecl"><span class="mpre">stringToOctets</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
        (_, _) -&gt; </span><a href="#loc_798_22_798_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_22_798_25&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt;</span><a href="#loc_798_22_798_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_798_22_798_25&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @normalizeHostURI forProxy req@ rewrites your request to have it</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- follow the expected formats by the receiving party (proxy or server.)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a href="#loc_815_1_815_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_1_815_17&#39;)"><span class="mpre">normalizeHostURI</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">RequestNormalizer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
</span><a name="loc_815_1_815_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_1_815_17&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeHostURI</span></span></a><span class="mpre"> </span><a name="loc_815_18_815_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_18_815_22&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a name="loc_815_23_815_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_23_815_26&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = 
  case </span><a href="#loc_864_1_864_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_864_1_864_16&#39;)"><span class="hl_varref"><span class="mpre">splitRequestURI</span></span></a><span class="mpre"> </span><a href="#loc_846_4_846_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_846_4_846_7&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre"> of
    (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">_uri_abs</span></span><span class="mpre">)
      | </span><a href="#loc_848_4_848_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_848_4_848_12&#39;)"><span class="hl_varref"><span class="mpre">forProxy</span></span></a><span class="mpre"> -&gt; 
         case </span><a href="Network.HTTP.Headers.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">findHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_92_4_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_92_4_92_11&#39;)"><span class="hl_conref"><span class="mpre">HdrHost</span></span></a><span class="mpre"> </span><a href="#loc_815_23_815_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_23_815_26&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> of
           </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_815_23_815_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_23_815_26&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- no host/authority in sight..not much we can do.</span></span><span class="mpre">
           </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_821_17_821_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_17_821_18&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">  -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 821, srcSpanStartColumn = 23, srcSpanEndLine = 823, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 821, srcSpanStartColumn = 26, srcSpanEndLine = 821, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">req{rqURI=uri{ uriAuthority=Just URIAuth{uriUserInfo=&quot;&quot;, uriRegName=hst, uriPort=pNum}
                                   , uriScheme=if (null (uriScheme uri)) then &quot;http&quot; else uriScheme uri
                                   }}</span></span><span class="mpre">
            where 
              </span><span class="hl_vardecl"><span class="mpre">hst</span></span><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_char"><span class="mpre">&#39;@&#39;</span></span><span class="mpre">) </span><a href="#loc_832_16_832_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_832_16_832_24&#39;)"><span class="hl_varref"><span class="mpre">user_hst</span></span></a><span class="mpre"> of
                       (</span><a name="loc_826_25_826_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_25_826_27&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">,</span><span class="hl_char"><span class="mpre">&#39;@&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_826_32_826_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_32_826_34&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) -&gt; 
                          case </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">) </span><a href="#loc_826_25_826_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_25_826_27&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre"> of
                            (_,_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><a href="#loc_826_32_826_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_32_826_34&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                            _ -&gt; </span><a href="#loc_832_16_832_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_832_16_832_24&#39;)"><span class="hl_varref"><span class="mpre">user_hst</span></span></a><span class="mpre">
                       _ -&gt; </span><a href="#loc_832_16_832_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_832_16_832_24&#39;)"><span class="hl_varref"><span class="mpre">user_hst</span></span></a><span class="mpre">

              (</span><a name="loc_832_16_832_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_832_16_832_24&#39;)"><span class="hl_vardecl"><span class="mpre">user_hst</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">pNum</span></span><span class="mpre">) = 
                 case </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">isDigit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_821_17_821_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_17_821_18&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) of
                   (</span><a name="loc_834_21_834_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_21_834_23&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">,</span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_834_28_834_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_28_834_30&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_834_28_834_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_28_834_30&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">, </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_834_21_834_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_21_834_23&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                   _ -&gt; (</span><a href="#loc_821_17_821_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_17_821_18&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; 
         case </span><a href="Network.HTTP.Headers.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">findHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_92_4_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_92_4_92_11&#39;)"><span class="hl_conref"><span class="mpre">HdrHost</span></span></a><span class="mpre"> </span><a href="#loc_815_23_815_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_23_815_26&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> of
           </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_815_23_815_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_23_815_26&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- no host/authority in sight..not much we can do...complain?</span></span><span class="mpre">
           </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 839, srcSpanStartColumn = 12, srcSpanEndLine = 839, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 839, srcSpanStartColumn = 16, srcSpanEndLine = 839, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLin"><span class="mpre">Just{}</span></span><span class="mpre">  -&gt; </span><a href="#loc_815_23_815_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_23_815_26&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
    (</span><a name="loc_840_6_840_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_6_840_7&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">uri_abs</span></span><span class="mpre">) 
      | </span><a href="#loc_848_4_848_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_848_4_848_12&#39;)"><span class="hl_varref"><span class="mpre">forProxy</span></span></a><span class="mpre">  -&gt; </span><a href="Network.HTTP.Headers.html#loc_222_1_222_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_222_1_222_22&#39;)"><span class="hl_varref"><span class="mpre">insertHeaderIfMissing</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_92_4_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_92_4_92_11&#39;)"><span class="hl_conref"><span class="mpre">HdrHost</span></span></a><span class="mpre"> </span><a href="#loc_840_6_840_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_6_840_7&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_815_23_815_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_23_815_26&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> 
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="Network.HTTP.Headers.html#loc_232_1_232_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_232_1_232_14&#39;)"><span class="hl_varref"><span class="mpre">replaceHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_92_4_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_92_4_92_11&#39;)"><span class="hl_conref"><span class="mpre">HdrHost</span></span></a><span class="mpre"> </span><a href="#loc_840_6_840_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_6_840_7&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 842, srcSpanStartColumn = 46, srcSpanEndLine = 842, srcSpanEndColumn = 64}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 842, srcSpanStartColumn = 49, srcSpanEndLine = 842, srcSpanEndColumn = 50},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">req{rqURI=uri_abs}</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- Note: _not_ stubbing out user:pass</span></span><span class="mpre">
 where
   </span><span class="hl_vardecl"><span class="mpre">uri0</span></span><span class="mpre">     = </span><a href="#loc_293_16_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_16_293_21&#39;)"><span class="hl_varref"><span class="mpre">rqURI</span></span></a><span class="mpre"> </span><a href="#loc_815_23_815_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_23_815_26&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> 
     </span><span class="hl_comment"><span class="mpre">-- stub out the user:pass </span></span><span class="mpre">
   </span><a name="loc_846_4_846_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_846_4_846_7&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="mpre">      = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 846, srcSpanStartColumn = 15, srcSpanEndLine = 846, srcSpanEndColumn = 85}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 846, srcSpanStartColumn = 19, srcSpanEndLine = 846, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">uri0{uriAuthority=fmap (\ x -&gt; x{uriUserInfo=&quot;&quot;}) (uriAuthority uri0)}</span></span><span class="mpre">

   </span><a name="loc_848_4_848_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_848_4_848_12&#39;)"><span class="hl_vardecl"><span class="mpre">forProxy</span></span></a><span class="mpre"> = </span><a href="#loc_740_8_740_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_8_740_20&#39;)"><span class="hl_varref"><span class="mpre">normForProxy</span></span></a><span class="mpre"> </span><a href="#loc_815_18_815_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_815_18_815_22&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- Comments re: above rewriting:
    RFC 2616, section 5.1.2:
     &quot;The most common form of Request-URI is that used to identify a
      resource on an origin server or gateway. In this case the absolute
      path of the URI MUST be transmitted (see section 3.2.1, abs_path) as
      the Request-URI, and the network location of the URI (authority) MUST
      be transmitted in a Host header field.&quot; 
   We assume that this is the case, so we take the host name from
   the Host header if there is one, otherwise from the request-URI.
   Then we make the request-URI an abs_path and make sure that there
   is a Host header.
-}</span></span><span class="mpre">

</span><a href="#loc_864_1_864_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_864_1_864_16&#39;)"><span class="mpre">splitRequestURI</span></a><span class="mpre"> :: </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_comment"><span class="mpre">{-authority-}</span></span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><a href="Network.URI.html#loc_153_6_153_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.URI.html#loc_153_6_153_9&#39;)"><span class="hl_tyconref"><span class="mpre">URI</span></span></a><span class="mpre">)
</span><a name="loc_864_1_864_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_864_1_864_16&#39;)"><span class="hl_fundecl"><span class="mpre">splitRequestURI</span></span></a><span class="mpre"> </span><a name="loc_864_17_864_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_864_17_864_20&#39;)"><span class="hl_vardecl"><span class="mpre">uri</span></span></a><span class="mpre"> = (</span><a href="#loc_186_1_186_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_21&#39;)"><span class="hl_varref"><span class="mpre">uriToAuthorityString</span></span></a><span class="mpre"> </span><a href="#loc_864_17_864_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_864_17_864_20&#39;)"><span class="hl_varref"><span class="mpre">uri</span></span></a><span class="mpre">, </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 864, srcSpanStartColumn = 50, srcSpanEndLine = 864, srcSpanEndColumn = 89}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 864, srcSpanStartColumn = 53, srcSpanEndLine = 864, srcSpanEndColumn = 54},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanSta"><span class="mpre">uri{uriScheme=&quot;&quot;, uriAuthority=Nothing}</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Adds a Host header if one is NOT ALREADY PRESENT..</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 867, srcSpanStartColumn = 1, srcSpanEndLine = 867, srcSpanEndColumn = 95}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpanStartLine = 867, srcSpanStartColumn = 1, srcSpanEndLine = 867, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Base.hs&quot;, srcSpan"><span class="mpre">{-# DEPRECATED normalizeHostHeader &quot;Please use Network.HTTP.Base.normalizeRequest instead&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_869_1_869_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_1_869_20&#39;)"><span class="mpre">normalizeHostHeader</span></a><span class="mpre"> :: </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre"> -&gt; </span><a href="#loc_292_6_292_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ty</span></span><span class="mpre">
</span><a name="loc_869_1_869_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_1_869_20&#39;)"><span class="hl_fundecl"><span class="mpre">normalizeHostHeader</span></span></a><span class="mpre"> </span><a name="loc_869_21_869_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_21_869_23&#39;)"><span class="hl_vardecl"><span class="mpre">rq</span></span></a><span class="mpre"> = 
  </span><a href="Network.HTTP.Headers.html#loc_222_1_222_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_222_1_222_22&#39;)"><span class="hl_varref"><span class="mpre">insertHeaderIfMissing</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_92_4_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_92_4_92_11&#39;)"><span class="hl_conref"><span class="mpre">HdrHost</span></span></a><span class="mpre">
                        (</span><a href="#loc_186_1_186_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_21&#39;)"><span class="hl_varref"><span class="mpre">uriToAuthorityString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_293_16_293_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_16_293_21&#39;)"><span class="hl_varref"><span class="mpre">rqURI</span></span></a><span class="mpre"> </span><a href="#loc_869_21_869_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_21_869_23&#39;)"><span class="hl_varref"><span class="mpre">rq</span></span></a><span class="mpre">)
                        </span><a href="#loc_869_21_869_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_21_869_23&#39;)"><span class="hl_varref"><span class="mpre">rq</span></span></a><span class="mpre">
                                     
</span><span class="hl_comment"><span class="mpre">-- Looks for a &quot;Connection&quot; header with the value &quot;close&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Returns True when this is found.</span></span><span class="mpre">
</span><a href="#loc_877_1_877_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_1_877_14&#39;)"><span class="mpre">findConnClose</span></a><span class="mpre"> :: [</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_877_1_877_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_1_877_14&#39;)"><span class="hl_fundecl"><span class="mpre">findConnClose</span></span></a><span class="mpre"> </span><a name="loc_877_15_877_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_15_877_19&#39;)"><span class="hl_vardecl"><span class="mpre">hdrs</span></span></a><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        (\ </span><a name="loc_879_12_879_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_879_12_879_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Utils.html#loc_58_1_58_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_58_1_58_5&#39;)"><span class="hl_varref"><span class="mpre">trim</span></span></a><span class="mpre"> </span><a href="#loc_879_12_879_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_879_12_879_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;close&quot;</span></span><span class="mpre">)
        (</span><a href="Network.HTTP.Headers.html#loc_255_1_255_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_255_1_255_13&#39;)"><span class="hl_varref"><span class="mpre">lookupHeader</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_77_4_77_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_77_4_77_17&#39;)"><span class="hl_conref"><span class="mpre">HdrConnection</span></span></a><span class="mpre"> </span><a href="#loc_877_15_877_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_15_877_19&#39;)"><span class="hl_varref"><span class="mpre">hdrs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Used when we know exactly how many bytes to expect.</span></span><span class="mpre">
</span><a href="#loc_884_1_884_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_884_1_884_15&#39;)"><span class="mpre">linearTransfer</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> ([</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">],</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
</span><a name="loc_884_1_884_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_884_1_884_15&#39;)"><span class="hl_fundecl"><span class="mpre">linearTransfer</span></span></a><span class="mpre"> </span><a name="loc_884_16_884_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_884_16_884_23&#39;)"><span class="hl_vardecl"><span class="mpre">readBlk</span></span></a><span class="mpre"> </span><a name="loc_884_24_884_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_884_24_884_25&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Network.Stream.html#loc_65_1_65_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_65_1_65_6&#39;)"><span class="hl_varref"><span class="mpre">fmapE</span></span></a><span class="mpre"> (\</span><a name="loc_884_36_884_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_884_36_884_39&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> ([],</span><a href="#loc_884_36_884_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_884_36_884_39&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)) (</span><a href="#loc_884_16_884_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_884_16_884_23&#39;)"><span class="hl_varref"><span class="mpre">readBlk</span></span></a><span class="mpre"> </span><a href="#loc_884_24_884_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_884_24_884_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Used when nothing about data is known,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Unfortunately waiting for a socket closure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   causes bad behaviour.  Here we just</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   take data once and give up the rest.</span></span><span class="mpre">
</span><a href="#loc_894_1_894_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_1_894_16&#39;)"><span class="mpre">hopefulTransfer</span></a><span class="mpre"> :: </span><a href="Network.BufferType.html#loc_71_6_71_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_71_6_71_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufferOp</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
                -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> ([</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">],</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
</span><a name="loc_894_1_894_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_1_894_16&#39;)"><span class="hl_fundecl"><span class="mpre">hopefulTransfer</span></span></a><span class="mpre"> </span><a name="loc_894_17_894_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_17_894_23&#39;)"><span class="hl_vardecl"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a name="loc_894_24_894_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_24_894_29&#39;)"><span class="hl_vardecl"><span class="mpre">readL</span></span></a><span class="mpre"> </span><a name="loc_894_30_894_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_30_894_34&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> 
    = </span><a href="#loc_894_24_894_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_24_894_29&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> 
      </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (\</span><a name="loc_896_16_896_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_896_16_896_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_896_16_896_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_896_16_896_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
             (\</span><a name="loc_897_16_897_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_897_16_897_20&#39;)"><span class="hl_vardecl"><span class="mpre">more</span></span></a><span class="mpre"> -&gt; if (</span><a href="Network.BufferType.html#loc_86_8_86_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_86_8_86_19&#39;)"><span class="hl_varref"><span class="mpre">buf_isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_894_17_894_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_17_894_23&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_897_16_897_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_897_16_897_20&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">)
                         then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> ([], </span><a href="Network.BufferType.html#loc_79_8_79_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_79_8_79_18&#39;)"><span class="hl_varref"><span class="mpre">buf_concat</span></span></a><span class="mpre"> </span><a href="#loc_894_17_894_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_17_894_23&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_894_30_894_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_30_894_34&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">))
                         else </span><a href="#loc_894_1_894_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_1_894_16&#39;)"><span class="hl_varref"><span class="mpre">hopefulTransfer</span></span></a><span class="mpre"> </span><a href="#loc_894_17_894_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_17_894_23&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_894_24_894_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_24_894_29&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> (</span><a href="#loc_897_16_897_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_897_16_897_20&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_894_30_894_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_30_894_34&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | A necessary feature of HTTP\/1.1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Also the only transfer variety likely to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   return any footers.</span></span><span class="mpre">
</span><a href="#loc_908_1_908_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_908_1_908_16&#39;)"><span class="mpre">chunkedTransfer</span></a><span class="mpre"> :: </span><a href="Network.BufferType.html#loc_71_6_71_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_71_6_71_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufferOp</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
                -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> ([</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">], </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
</span><a name="loc_908_1_908_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_908_1_908_16&#39;)"><span class="hl_fundecl"><span class="mpre">chunkedTransfer</span></span></a><span class="mpre"> </span><a name="loc_908_17_908_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_908_17_908_23&#39;)"><span class="hl_vardecl"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a name="loc_908_24_908_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_908_24_908_29&#39;)"><span class="hl_vardecl"><span class="mpre">readL</span></span></a><span class="mpre"> </span><a name="loc_908_30_908_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_908_30_908_37&#39;)"><span class="hl_vardecl"><span class="mpre">readBlk</span></span></a><span class="mpre"> = </span><a href="#loc_916_1_916_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_1_916_17&#39;)"><span class="hl_varref"><span class="mpre">chunkedTransferC</span></span></a><span class="mpre"> </span><a href="#loc_908_17_908_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_908_17_908_23&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_908_24_908_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_908_24_908_29&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> </span><a href="#loc_908_30_908_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_908_30_908_37&#39;)"><span class="hl_varref"><span class="mpre">readBlk</span></span></a><span class="mpre"> [] </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><a href="#loc_916_1_916_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_1_916_17&#39;)"><span class="mpre">chunkedTransferC</span></a><span class="mpre"> :: </span><a href="Network.BufferType.html#loc_71_6_71_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_71_6_71_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufferOp</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
                 -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
                 -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> ([</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">], </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
</span><a name="loc_916_1_916_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_1_916_17&#39;)"><span class="hl_fundecl"><span class="mpre">chunkedTransferC</span></span></a><span class="mpre"> </span><a name="loc_916_18_916_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_18_916_24&#39;)"><span class="hl_vardecl"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a name="loc_916_25_916_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_25_916_30&#39;)"><span class="hl_vardecl"><span class="mpre">readL</span></span></a><span class="mpre"> </span><a name="loc_916_31_916_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_31_916_38&#39;)"><span class="hl_vardecl"><span class="mpre">readBlk</span></span></a><span class="mpre"> </span><a name="loc_916_39_916_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_39_916_42&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_916_43_916_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_43_916_44&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = do
  </span><a name="loc_917_3_917_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_917_3_917_4&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_916_25_916_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_25_916_30&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre">
  case </span><a href="#loc_917_3_917_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_917_3_917_4&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_919_10_919_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_919_10_919_11&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_919_10_919_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_919_10_919_11&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_920_11_920_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_920_11_920_15&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> 
     | </span><a href="#loc_939_7_939_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_939_7_939_11&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; 
         </span><span class="hl_comment"><span class="mpre">-- last chunk read; look for trailing headers..</span></span><span class="mpre">
        </span><a href="Network.Stream.html#loc_65_1_65_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_65_1_65_6&#39;)"><span class="hl_varref"><span class="mpre">fmapE</span></span></a><span class="mpre"> (\ </span><a name="loc_923_18_923_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_923_18_923_22&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> -&gt; do
                 </span><a name="loc_924_18_924_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_924_18_924_22&#39;)"><span class="hl_vardecl"><span class="mpre">ftrs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Headers.html#loc_280_1_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_280_1_280_13&#39;)"><span class="hl_varref"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Network.BufferType.html#loc_81_8_81_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_81_8_81_17&#39;)"><span class="hl_varref"><span class="mpre">buf_toStr</span></span></a><span class="mpre"> </span><a href="#loc_916_18_916_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_18_916_24&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre">) </span><a href="#loc_923_18_923_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_923_18_923_22&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">)
                   </span><span class="hl_comment"><span class="mpre">-- insert (computed) Content-Length header.</span></span><span class="mpre">
                 let </span><a name="loc_926_22_926_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_926_22_926_27&#39;)"><span class="hl_vardecl"><span class="mpre">ftrs&#39;</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Headers.html#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_121_4_121_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_121_4_121_20&#39;)"><span class="hl_conref"><span class="mpre">HdrContentLength</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_916_43_916_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_43_916_44&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_924_18_924_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_924_18_924_22&#39;)"><span class="hl_varref"><span class="mpre">ftrs</span></span></a><span class="mpre">
                 </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_926_22_926_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_926_22_926_27&#39;)"><span class="hl_varref"><span class="mpre">ftrs&#39;</span></span></a><span class="mpre">,</span><a href="Network.BufferType.html#loc_79_8_79_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_79_8_79_18&#39;)"><span class="hl_varref"><span class="mpre">buf_concat</span></span></a><span class="mpre"> </span><a href="#loc_916_18_916_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_18_916_24&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_916_39_916_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_39_916_42&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)))

              (</span><a href="#loc_973_1_973_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_1_973_15&#39;)"><span class="hl_varref"><span class="mpre">readTillEmpty2</span></span></a><span class="mpre"> </span><a href="#loc_916_18_916_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_18_916_24&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_916_25_916_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_25_916_30&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> [])

     | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; do
         </span><a name="loc_932_10_932_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_10_932_14&#39;)"><span class="hl_vardecl"><span class="mpre">some</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_916_31_916_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_31_916_38&#39;)"><span class="hl_varref"><span class="mpre">readBlk</span></span></a><span class="mpre"> </span><a href="#loc_939_7_939_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_939_7_939_11&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">
         case </span><a href="#loc_932_10_932_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_10_932_14&#39;)"><span class="hl_varref"><span class="mpre">some</span></span></a><span class="mpre"> of
           </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_934_17_934_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_934_17_934_18&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_934_17_934_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_934_17_934_18&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
           </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_935_18_935_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_935_18_935_23&#39;)"><span class="hl_vardecl"><span class="mpre">cdata</span></span></a><span class="mpre"> -&gt; do
               _ &lt;- </span><a href="#loc_916_25_916_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_25_916_30&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- CRLF is mandated after the chunk block; ToDo: check that the line is empty.?</span></span><span class="mpre">
               </span><a href="#loc_916_1_916_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_1_916_17&#39;)"><span class="hl_varref"><span class="mpre">chunkedTransferC</span></span></a><span class="mpre"> </span><a href="#loc_916_18_916_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_18_916_24&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_916_25_916_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_25_916_30&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> </span><a href="#loc_916_31_916_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_31_916_38&#39;)"><span class="hl_varref"><span class="mpre">readBlk</span></span></a><span class="mpre"> (</span><a href="#loc_935_18_935_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_935_18_935_23&#39;)"><span class="hl_varref"><span class="mpre">cdata</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_916_39_916_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_39_916_42&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) (</span><a href="#loc_916_43_916_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_43_916_44&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_939_7_939_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_939_7_939_11&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">)
     where
      </span><a name="loc_939_7_939_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_939_7_939_11&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> 
       | </span><a href="Network.BufferType.html#loc_86_8_86_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_86_8_86_19&#39;)"><span class="hl_varref"><span class="mpre">buf_isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_916_18_916_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_18_916_24&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_920_11_920_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_920_11_920_15&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = 
         case </span><a href="Numeric.html#loc_94_1_94_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Numeric.html#loc_94_1_94_8&#39;)"><span class="hl_varref"><span class="mpre">readHex</span></span></a><span class="mpre"> (</span><a href="Network.BufferType.html#loc_81_8_81_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_81_8_81_17&#39;)"><span class="hl_varref"><span class="mpre">buf_toStr</span></span></a><span class="mpre"> </span><a href="#loc_916_18_916_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_18_916_24&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_920_11_920_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_920_11_920_15&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">) of
          (</span><a name="loc_943_12_943_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_943_12_943_14&#39;)"><span class="hl_vardecl"><span class="mpre">hx</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; </span><a href="#loc_943_12_943_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_943_12_943_14&#39;)"><span class="hl_varref"><span class="mpre">hx</span></span></a><span class="mpre">
          _        -&gt; </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Maybe in the future we will have a sensible thing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   to do here, at that time we might want to change</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the name.</span></span><span class="mpre">
</span><a href="#loc_950_1_950_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_1_950_18&#39;)"><span class="mpre">uglyDeathTransfer</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> ([</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">],</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
</span><a name="loc_950_1_950_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_1_950_18&#39;)"><span class="hl_fundecl"><span class="mpre">uglyDeathTransfer</span></span></a><span class="mpre"> </span><a name="loc_950_19_950_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_19_950_22&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_994_1_994_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_994_1_994_19&#39;)"><span class="hl_varref"><span class="mpre">responseParseError</span></span></a><span class="mpre"> </span><a href="#loc_950_19_950_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_19_950_22&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Unknown Transfer-Encoding&quot;</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Remove leading crlfs then call readTillEmpty2 (not required by RFC)</span></span><span class="mpre">
</span><a href="#loc_956_1_956_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_1_956_15&#39;)"><span class="mpre">readTillEmpty1</span></a><span class="mpre"> :: </span><a href="Network.BufferType.html#loc_71_6_71_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_71_6_71_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufferOp</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">])
</span><a name="loc_956_1_956_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_1_956_15&#39;)"><span class="hl_fundecl"><span class="mpre">readTillEmpty1</span></span></a><span class="mpre"> </span><a name="loc_956_16_956_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_16_956_22&#39;)"><span class="hl_vardecl"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a name="loc_956_23_956_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_23_956_28&#39;)"><span class="hl_vardecl"><span class="mpre">readL</span></span></a><span class="mpre"> =
  </span><a href="#loc_956_23_956_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_23_956_28&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">)
           (\ </span><a name="loc_959_15_959_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_959_15_959_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; 
               if </span><a href="Network.BufferType.html#loc_85_8_85_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_85_8_85_22&#39;)"><span class="hl_varref"><span class="mpre">buf_isLineTerm</span></span></a><span class="mpre"> </span><a href="#loc_956_16_956_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_16_956_22&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_959_15_959_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_959_15_959_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                then </span><a href="#loc_956_1_956_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_1_956_15&#39;)"><span class="hl_varref"><span class="mpre">readTillEmpty1</span></span></a><span class="mpre"> </span><a href="#loc_956_16_956_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_16_956_22&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_956_23_956_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_23_956_28&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre">
                else </span><a href="#loc_973_1_973_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_1_973_15&#39;)"><span class="hl_varref"><span class="mpre">readTillEmpty2</span></span></a><span class="mpre"> </span><a href="#loc_956_16_956_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_16_956_22&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_956_23_956_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_23_956_28&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> [</span><a href="#loc_959_15_959_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_959_15_959_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">])

</span><span class="hl_comment"><span class="mpre">-- | Read lines until an empty line (CRLF),</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   also accepts a connection close as end of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   input, which is not an HTTP\/1.1 compliant</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   thing to do - so probably indicates an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   error condition.</span></span><span class="mpre">
</span><a href="#loc_973_1_973_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_1_973_15&#39;)"><span class="mpre">readTillEmpty2</span></a><span class="mpre"> :: </span><a href="Network.BufferType.html#loc_71_6_71_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_71_6_71_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufferOp</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
               -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">])
</span><a name="loc_973_1_973_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_1_973_15&#39;)"><span class="hl_fundecl"><span class="mpre">readTillEmpty2</span></span></a><span class="mpre"> </span><a name="loc_973_16_973_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_16_973_22&#39;)"><span class="hl_vardecl"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a name="loc_973_23_973_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_23_973_28&#39;)"><span class="hl_vardecl"><span class="mpre">readL</span></span></a><span class="mpre"> </span><a name="loc_973_29_973_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_29_973_33&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> =
    </span><a href="#loc_973_23_973_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_23_973_28&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">)
             (\ </span><a name="loc_976_17_976_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_976_17_976_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
                if </span><a href="Network.BufferType.html#loc_85_8_85_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_85_8_85_22&#39;)"><span class="hl_varref"><span class="mpre">buf_isLineTerm</span></span></a><span class="mpre"> </span><a href="#loc_973_16_973_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_16_973_22&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_976_17_976_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_976_17_976_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="Network.BufferType.html#loc_86_8_86_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.BufferType.html#loc_86_8_86_19&#39;)"><span class="hl_varref"><span class="mpre">buf_isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_973_16_973_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_16_973_22&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_976_17_976_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_976_17_976_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                 then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> (</span><a href="#loc_976_17_976_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_976_17_976_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_973_29_973_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_29_973_33&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre">))
                 else </span><a href="#loc_973_1_973_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_1_973_15&#39;)"><span class="hl_varref"><span class="mpre">readTillEmpty2</span></span></a><span class="mpre"> </span><a href="#loc_973_16_973_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_16_973_22&#39;)"><span class="hl_varref"><span class="mpre">bufOps</span></span></a><span class="mpre"> </span><a href="#loc_973_23_973_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_23_973_28&#39;)"><span class="hl_varref"><span class="mpre">readL</span></span></a><span class="mpre"> (</span><a href="#loc_976_17_976_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_976_17_976_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_973_29_973_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_973_29_973_33&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Misc</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @catchIO a h@ handles IO action exceptions throughout codebase; version-specific</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- tweaks better go here.</span></span><span class="mpre">
</span><a href="#loc_988_1_988_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_988_1_988_8&#39;)"><span class="mpre">catchIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_988_1_988_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_988_1_988_8&#39;)"><span class="hl_fundecl"><span class="mpre">catchIO</span></span></a><span class="mpre"> </span><a name="loc_988_9_988_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_988_9_988_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_988_11_988_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_988_11_988_12&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="hl_varref"><span class="mpre">Exception.catch</span></span></a><span class="mpre"> </span><a href="#loc_988_9_988_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_988_9_988_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_988_11_988_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_988_11_988_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">

</span><a href="#loc_991_1_991_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_991_1_991_9&#39;)"><span class="mpre">catchIO_</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_991_1_991_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_991_1_991_9&#39;)"><span class="hl_fundecl"><span class="mpre">catchIO_</span></span></a><span class="mpre"> </span><a name="loc_991_10_991_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_991_10_991_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_991_12_991_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_991_12_991_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="hl_varref"><span class="mpre">Exception.catch</span></span></a><span class="mpre"> </span><a href="#loc_991_10_991_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_991_10_991_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> (\(_ :: </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_991_12_991_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_991_12_991_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)

</span><a href="#loc_994_1_994_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_994_1_994_19&#39;)"><span class="mpre">responseParseError</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_994_1_994_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_994_1_994_19&#39;)"><span class="hl_fundecl"><span class="mpre">responseParseError</span></span></a><span class="mpre"> </span><a name="loc_994_20_994_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_994_20_994_23&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_994_24_994_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_994_24_994_25&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="Network.Stream.html#loc_58_1_58_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_58_1_58_9&#39;)"><span class="hl_varref"><span class="mpre">failWith</span></span></a><span class="mpre"> (</span><a href="Network.Stream.html#loc_40_4_40_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_40_4_40_14&#39;)"><span class="hl_conref"><span class="mpre">ErrorParse</span></span></a><span class="mpre"> (</span><a href="#loc_994_20_994_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_994_20_994_23&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_994_24_994_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_994_24_994_25&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">))
</span></div></body></html>