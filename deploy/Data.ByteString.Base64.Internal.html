<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ByteString.Base64.Internal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2010 Bryan O&#39;Sullivan</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fast and efficient encoding and decoding of base64-encoded strings.</span></span><span class="mpre">

module Data.ByteString.Base64.Internal
    (
      encodeWith
    , decodeWithTable
    , decodeLenientWithTable
    , mkEncodeTable
    , joinWith
    , done
    , peek8, poke8, peek8_32
    , reChunkIn
    ) where

import Data.Bits ((.|.), (.&amp;.), </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 18, srcSpanEndLine = 27, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Data.ByteString.Internal (</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="mpre">ByteString</span></a><span class="mpre">(..), </span><a href="Data.ByteString.Internal.html#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_489_1_489_17&#39;)"><span class="mpre">mallocByteString</span></a><span class="mpre">, </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="mpre">memcpy</span></a><span class="mpre">,
                                 </span><a href="Data.ByteString.Internal.html#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_411_1_411_13&#39;)"><span class="mpre">unsafeCreate</span></a><span class="mpre">)
import Data.Word (Word8, Word16, Word32)
import Foreign.ForeignPtr (ForeignPtr, withForeignPtr, castForeignPtr)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 8, srcSpanEndLine = 32, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Foreign.Ptr&quot;"><span class="mpre">Foreign.Ptr</span></span><span class="mpre"> (Ptr, castPtr, minusPtr, plusPtr)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 8, srcSpanEndLine = 33, srcSpanEndColumn = 24}, srcInfoPoints = []}) &quot;Foreign.Storable&quot;"><span class="mpre">Foreign.Storable</span></span><span class="mpre"> (peek, peekElemOff, poke)
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)

</span><a href="#loc_37_1_37_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_6&#39;)"><span class="mpre">peek8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
</span><a name="loc_37_1_37_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_6&#39;)"><span class="hl_vardecl"><span class="mpre">peek8</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre">

</span><a href="#loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="mpre">poke8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="hl_vardecl"><span class="mpre">poke8</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre">

</span><a href="#loc_43_1_43_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_9&#39;)"><span class="mpre">peek8_32</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
</span><a name="loc_43_1_43_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_9&#39;)"><span class="hl_vardecl"><span class="mpre">peek8_32</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_37_1_37_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_6&#39;)"><span class="hl_varref"><span class="mpre">peek8</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode a string into base64 form.  The result will always be a multiple</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of 4 bytes in length.</span></span><span class="mpre">
</span><a href="#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_11&#39;)"><span class="mpre">encodeWith</span></a><span class="mpre"> :: </span><a href="#loc_93_6_93_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_17&#39;)"><span class="hl_tyconref"><span class="mpre">EncodeTable</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_48_1_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_11&#39;)"><span class="hl_fundecl"><span class="mpre">encodeWith</span></span></a><span class="mpre"> (</span><a href="#loc_93_20_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_22&#39;)"><span class="hl_conref"><span class="mpre">ET</span></span></a><span class="mpre"> </span><a name="loc_48_16_48_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_16_48_22&#39;)"><span class="hl_vardecl"><span class="mpre">alfaFP</span></span></a><span class="mpre"> </span><a name="loc_48_23_48_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_23_48_34&#39;)"><span class="hl_vardecl"><span class="mpre">encodeTable</span></span></a><span class="mpre">) (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_48_40_48_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_40_48_43&#39;)"><span class="hl_vardecl"><span class="mpre">sfp</span></span></a><span class="mpre"> </span><a name="loc_48_44_48_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_44_48_48&#39;)"><span class="hl_vardecl"><span class="mpre">soff</span></span></a><span class="mpre"> </span><a name="loc_48_49_48_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_49_48_53&#39;)"><span class="hl_vardecl"><span class="mpre">slen</span></span></a><span class="mpre">)
    | </span><a href="#loc_48_49_48_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_49_48_53&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">maxBound</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> =
        </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.ByteString.Base64.encode: input too long&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  let </span><a name="loc_52_7_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_11&#39;)"><span class="hl_vardecl"><span class="mpre">dlen</span></span></a><span class="mpre"> = ((</span><a href="#loc_48_49_48_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_49_48_53&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
  </span><a name="loc_53_3_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_3_53_6&#39;)"><span class="hl_vardecl"><span class="mpre">dfp</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_52_7_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_11&#39;)"><span class="hl_varref"><span class="mpre">dlen</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_48_16_48_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_16_48_22&#39;)"><span class="hl_varref"><span class="mpre">alfaFP</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_54_28_54_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_28_54_32&#39;)"><span class="hl_vardecl"><span class="mpre">aptr</span></span></a><span class="mpre"> -&gt;
    </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_48_23_48_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_23_48_34&#39;)"><span class="hl_varref"><span class="mpre">encodeTable</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">ep</span></span><span class="mpre"> -&gt;
      </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_48_40_48_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_40_48_43&#39;)"><span class="hl_varref"><span class="mpre">sfp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_56_29_56_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_29_56_33&#39;)"><span class="hl_vardecl"><span class="mpre">sptr</span></span></a><span class="mpre"> -&gt; do
        let </span><span class="hl_fundecl"><span class="mpre">aidx</span></span><span class="mpre"> </span><a name="loc_57_18_57_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_37_1_37_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_6&#39;)"><span class="hl_varref"><span class="mpre">peek8</span></span></a><span class="mpre"> (</span><a href="#loc_54_28_54_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_28_54_32&#39;)"><span class="hl_varref"><span class="mpre">aptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_57_18_57_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
            </span><a name="loc_58_13_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_17&#39;)"><span class="hl_vardecl"><span class="mpre">sEnd</span></span></a><span class="mpre"> = </span><a href="#loc_56_29_56_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_29_56_33&#39;)"><span class="hl_varref"><span class="mpre">sptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_48_49_48_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_49_48_53&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_48_44_48_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_44_48_48&#39;)"><span class="hl_varref"><span class="mpre">soff</span></span></a><span class="mpre">)
            </span><a name="loc_59_13_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_13_59_17&#39;)"><span class="hl_fundecl"><span class="mpre">fill</span></span></a><span class="mpre"> !</span><a name="loc_59_19_59_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_21&#39;)"><span class="hl_vardecl"><span class="mpre">dp</span></span></a><span class="mpre"> !</span><a name="loc_59_23_59_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_23_59_25&#39;)"><span class="hl_vardecl"><span class="mpre">sp</span></span></a><span class="mpre">
              | </span><a href="#loc_59_23_59_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_23_59_25&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_58_13_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_17&#39;)"><span class="hl_varref"><span class="mpre">sEnd</span></span></a><span class="mpre"> = </span><a href="#loc_70_13_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_13_70_21&#39;)"><span class="hl_varref"><span class="mpre">complete</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_59_19_59_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_21&#39;)"><span class="hl_varref"><span class="mpre">dp</span></span></a><span class="mpre">) </span><a href="#loc_59_23_59_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_23_59_25&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 29, srcSpanEndLine = 70, srcSpanEndColumn = 0}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 37, srcSpanEndLine = 61, srcSpanEndColumn = 50},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bas"><span class="mpre">{-# SCC &quot;encode/fill&quot; #-} do
              i &lt;- peek8_32 sp
              j &lt;- peek8_32 (sp `plusPtr` 1)
              k &lt;- peek8_32 (sp `plusPtr` 2)
              let w = (i `shiftL` 16) .|. (j `shiftL` 8) .|. k
                  enc = peekElemOff ep . fromIntegral
              poke dp =&lt;&lt; enc (w `shiftR` 12)
              poke (dp `plusPtr` 2) =&lt;&lt; enc (w .&amp;. 0xfff)
              fill (dp `plusPtr` 4) (sp `plusPtr` 3)</span></span><span class="mpre">
            </span><a name="loc_70_13_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_13_70_21&#39;)"><span class="hl_fundecl"><span class="mpre">complete</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">dp</span></span><span class="mpre"> </span><a name="loc_70_25_70_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_25_70_27&#39;)"><span class="hl_vardecl"><span class="mpre">sp</span></span></a><span class="mpre">
                | </span><a href="#loc_70_25_70_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_25_70_27&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_58_13_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_17&#39;)"><span class="hl_varref"><span class="mpre">sEnd</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 32, srcSpanEndLine = 89, srcSpanEndColumn = 0}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 40, srcSpanEndLine = 72, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bas"><span class="mpre">{-# SCC &quot;encode/complete&quot; #-} do
              let peekSP n f = (f . fromIntegral) `fmap` peek8 (sp `plusPtr` n)
                  twoMore    = sp `plusPtr` 2 == sEnd
                  equals     = 0x3d :: Word8
                  {-# INLINE equals #-}
              !a &lt;- peekSP 0 ((`shiftR` 2) . (.&amp;. 0xfc))
              !b &lt;- peekSP 0 ((`shiftL` 4) . (.&amp;. 0x03))
              !b&#39; &lt;- if twoMore
                     then peekSP 1 ((.|. b) . (`shiftR` 4) . (.&amp;. 0xf0))
                     else return b
              poke8 dp =&lt;&lt; aidx a
              poke8 (dp `plusPtr` 1) =&lt;&lt; aidx b&#39;
              !c &lt;- if twoMore
                    then aidx =&lt;&lt; peekSP 1 ((`shiftL` 2) . (.&amp;. 0x0f))
                    else return equals
              poke8 (dp `plusPtr` 2) c
              poke8 (dp `plusPtr` 3) equals</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_53_3_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_3_53_6&#39;)"><span class="hl_varref"><span class="mpre">dfp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_89_31_89_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_31_89_35&#39;)"><span class="hl_vardecl"><span class="mpre">dptr</span></span></a><span class="mpre"> -&gt;
          </span><a href="#loc_59_13_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_13_59_17&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_89_31_89_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_31_89_35&#39;)"><span class="hl_varref"><span class="mpre">dptr</span></span></a><span class="mpre">) (</span><a href="#loc_56_29_56_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_29_56_33&#39;)"><span class="hl_varref"><span class="mpre">sptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_48_44_48_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_44_48_48&#39;)"><span class="hl_varref"><span class="mpre">soff</span></span></a><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_53_3_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_3_53_6&#39;)"><span class="hl_varref"><span class="mpre">dfp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_52_7_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_11&#39;)"><span class="hl_varref"><span class="mpre">dlen</span></span></a><span class="mpre">

data </span><a name="loc_93_6_93_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_17&#39;)"><span class="hl_tycondecl"><span class="mpre">EncodeTable</span></span></a><span class="mpre"> = </span><a name="loc_93_20_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_22&#39;)"><span class="hl_condecl"><span class="mpre">ET</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- The encoding table is constructed such that the expansion of a 12-bit</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- block to a 16-bit block can be done by a single Word16 copy from the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- correspoding table entry to the target address. The 16-bit blocks are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- stored in big-endian order, as the indices into the table are built in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- big-endian order.</span></span><span class="mpre">
</span><a href="#loc_101_1_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_14&#39;)"><span class="mpre">mkEncodeTable</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_93_6_93_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_17&#39;)"><span class="hl_tyconref"><span class="mpre">EncodeTable</span></span></a><span class="mpre">
</span><a name="loc_101_1_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_14&#39;)"><span class="hl_fundecl"><span class="mpre">mkEncodeTable</span></span></a><span class="mpre"> </span><a name="loc_101_15_101_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_15_101_23&#39;)"><span class="hl_specname"><span class="mpre">alphabet</span></span></a><span class="mpre">@(</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_101_28_101_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_28_101_31&#39;)"><span class="hl_vardecl"><span class="mpre">afp</span></span></a><span class="mpre"> _ _) =
    case </span><a href="#loc_105_5_105_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_10&#39;)"><span class="hl_varref"><span class="mpre">table</span></span></a><span class="mpre"> of </span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_102_22_102_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_22_102_24&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> _ _ -&gt; </span><a href="#loc_93_20_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_22&#39;)"><span class="hl_conref"><span class="mpre">ET</span></span></a><span class="mpre"> </span><a href="#loc_101_28_101_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_28_101_31&#39;)"><span class="hl_varref"><span class="mpre">afp</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castForeignPtr</span></span><span class="mpre"> </span><a href="#loc_102_22_102_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_22_102_24&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">)
  where
    </span><a name="loc_104_5_104_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_7&#39;)"><span class="hl_vardecl"><span class="mpre">ix</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.index</span></span><span class="mpre"> </span><a href="#loc_101_15_101_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_15_101_23&#39;)"><span class="hl_varref"><span class="mpre">alphabet</span></span></a><span class="mpre">
    </span><a name="loc_105_5_105_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_10&#39;)"><span class="hl_vardecl"><span class="mpre">table</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> [ [</span><a href="#loc_104_5_104_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_7&#39;)"><span class="hl_varref"><span class="mpre">ix</span></span></a><span class="mpre"> </span><a href="#loc_105_48_105_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_48_105_49&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">, </span><a href="#loc_104_5_104_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_7&#39;)"><span class="hl_varref"><span class="mpre">ix</span></span></a><span class="mpre"> </span><a href="#loc_105_62_105_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_62_105_63&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">] | </span><a name="loc_105_48_105_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_48_105_49&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 53, srcSpanEndLine = 105, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 53, srcSpanEndLine = 105, srcSpanEndColumn = 54},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pu"><span class="mpre">[0..63]</span></span><span class="mpre">, </span><a name="loc_105_62_105_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_62_105_63&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 67, srcSpanEndLine = 105, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 67, srcSpanEndLine = 105, srcSpanEndColumn = 68},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pu"><span class="mpre">[0..63]</span></span><span class="mpre"> ]

</span><span class="hl_comment"><span class="mpre">-- | Efficiently intersperse a terminator string into another at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- regular intervals, and terminate the input with it.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Examples:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; joinWith &quot;|&quot; 2 &quot;----&quot; = &quot;--|--|&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; joinWith &quot;\r\n&quot; 3 &quot;foobarbaz&quot; = &quot;foo\r\nbar\r\nbaz\r\n&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; joinWith &quot;x&quot; 3 &quot;fo&quot; = &quot;fox&quot;</span></span><span class="mpre">
</span><a href="#loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="mpre">joinWith</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ String to intersperse and end with</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ Interval at which to intersperse, in bytes</span></span><span class="mpre">
         -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ String to transform</span></span><span class="mpre">
         -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="hl_fundecl"><span class="mpre">joinWith</span></span></a><span class="mpre"> </span><a name="loc_120_10_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_13&#39;)"><span class="hl_specname"><span class="mpre">brk</span></span></a><span class="mpre">@(</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_120_18_120_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_18_120_21&#39;)"><span class="hl_vardecl"><span class="mpre">bfp</span></span></a><span class="mpre"> </span><a name="loc_120_22_120_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_22_120_26&#39;)"><span class="hl_vardecl"><span class="mpre">boff</span></span></a><span class="mpre"> </span><a name="loc_120_27_120_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_31&#39;)"><span class="hl_vardecl"><span class="mpre">blen</span></span></a><span class="mpre">) </span><a name="loc_120_33_120_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_33_120_38&#39;)"><span class="hl_vardecl"><span class="mpre">every</span></span></a><span class="mpre"> </span><a name="loc_120_39_120_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_39_120_41&#39;)"><span class="hl_specname"><span class="mpre">bs</span></span></a><span class="mpre">@(</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_120_46_120_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_46_120_49&#39;)"><span class="hl_vardecl"><span class="mpre">sfp</span></span></a><span class="mpre"> </span><a name="loc_120_50_120_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_50_120_54&#39;)"><span class="hl_vardecl"><span class="mpre">soff</span></span></a><span class="mpre"> </span><a name="loc_120_55_120_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_55_120_59&#39;)"><span class="hl_vardecl"><span class="mpre">slen</span></span></a><span class="mpre">)
    | </span><a href="#loc_120_33_120_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_33_120_38&#39;)"><span class="hl_varref"><span class="mpre">every</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;invalid interval&quot;</span></span><span class="mpre">
    | </span><a href="#loc_120_27_120_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_31&#39;)"><span class="hl_varref"><span class="mpre">blen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = </span><a href="#loc_120_39_120_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_39_120_41&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_120_39_120_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_39_120_41&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_120_10_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_13&#39;)"><span class="hl_varref"><span class="mpre">brk</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
  </span><a href="Data.ByteString.Internal.html#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeCreate</span></span></a><span class="mpre"> </span><a href="#loc_143_9_143_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_13&#39;)"><span class="hl_varref"><span class="mpre">dlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_125_24_125_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_24_125_28&#39;)"><span class="hl_vardecl"><span class="mpre">dptr</span></span></a><span class="mpre"> -&gt;
    </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_120_18_120_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_18_120_21&#39;)"><span class="hl_varref"><span class="mpre">bfp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_126_27_126_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_27_126_31&#39;)"><span class="hl_vardecl"><span class="mpre">bptr</span></span></a><span class="mpre"> -&gt; do
      </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_120_46_120_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_46_120_49&#39;)"><span class="hl_varref"><span class="mpre">sfp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_127_29_127_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_29_127_33&#39;)"><span class="hl_vardecl"><span class="mpre">sptr</span></span></a><span class="mpre"> -&gt; do
          let </span><a name="loc_128_15_128_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_15_128_17&#39;)"><span class="hl_vardecl"><span class="mpre">bp</span></span></a><span class="mpre"> = </span><a href="#loc_126_27_126_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_27_126_31&#39;)"><span class="hl_varref"><span class="mpre">bptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_120_22_120_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_22_120_26&#39;)"><span class="hl_varref"><span class="mpre">boff</span></span></a><span class="mpre">
              </span><a name="loc_129_15_129_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_15_129_18&#39;)"><span class="hl_vardecl"><span class="mpre">sp0</span></span></a><span class="mpre"> = </span><a href="#loc_127_29_127_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_29_127_33&#39;)"><span class="hl_varref"><span class="mpre">sptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_120_50_120_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_50_120_54&#39;)"><span class="hl_varref"><span class="mpre">soff</span></span></a><span class="mpre">
              </span><a name="loc_130_15_130_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_20&#39;)"><span class="hl_vardecl"><span class="mpre">sLast</span></span></a><span class="mpre"> = </span><a href="#loc_129_15_129_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_15_129_18&#39;)"><span class="hl_varref"><span class="mpre">sp0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_120_33_120_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_33_120_38&#39;)"><span class="hl_varref"><span class="mpre">every</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_145_9_145_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_18&#39;)"><span class="hl_varref"><span class="mpre">numBreaks</span></span></a><span class="mpre">)
              </span><a name="loc_131_15_131_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_19&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_131_21_131_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_21_131_23&#39;)"><span class="hl_vardecl"><span class="mpre">dp</span></span></a><span class="mpre"> !</span><a name="loc_131_25_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_25_131_27&#39;)"><span class="hl_vardecl"><span class="mpre">sp</span></span></a><span class="mpre">
                  | </span><a href="#loc_131_25_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_25_131_27&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_130_15_130_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_20&#39;)"><span class="hl_varref"><span class="mpre">sLast</span></span></a><span class="mpre"> = do
                      let </span><a name="loc_133_27_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_27_133_28&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_129_15_129_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_15_129_18&#39;)"><span class="hl_varref"><span class="mpre">sp0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_120_55_120_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_55_120_59&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_131_25_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_25_131_27&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre">
                      </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a href="#loc_131_21_131_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_21_131_23&#39;)"><span class="hl_varref"><span class="mpre">dp</span></span></a><span class="mpre"> </span><a href="#loc_131_25_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_25_131_27&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_133_27_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_27_133_28&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
                      </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> (</span><a href="#loc_131_21_131_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_21_131_23&#39;)"><span class="hl_varref"><span class="mpre">dp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_133_27_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_27_133_28&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_128_15_128_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_15_128_17&#39;)"><span class="hl_varref"><span class="mpre">bp</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_120_27_120_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_31&#39;)"><span class="hl_varref"><span class="mpre">blen</span></span></a><span class="mpre">)
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
                </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a href="#loc_131_21_131_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_21_131_23&#39;)"><span class="hl_varref"><span class="mpre">dp</span></span></a><span class="mpre"> </span><a href="#loc_131_25_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_25_131_27&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_120_33_120_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_33_120_38&#39;)"><span class="hl_varref"><span class="mpre">every</span></span></a><span class="mpre">)
                let </span><a name="loc_138_21_138_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_21_138_24&#39;)"><span class="hl_vardecl"><span class="mpre">dp&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_131_21_131_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_21_131_23&#39;)"><span class="hl_varref"><span class="mpre">dp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_120_33_120_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_33_120_38&#39;)"><span class="hl_varref"><span class="mpre">every</span></span></a><span class="mpre">
                </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a href="#loc_138_21_138_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_21_138_24&#39;)"><span class="hl_varref"><span class="mpre">dp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_128_15_128_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_15_128_17&#39;)"><span class="hl_varref"><span class="mpre">bp</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_120_27_120_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_31&#39;)"><span class="hl_varref"><span class="mpre">blen</span></span></a><span class="mpre">)
                </span><a href="#loc_131_15_131_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_19&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_138_21_138_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_21_138_24&#39;)"><span class="hl_varref"><span class="mpre">dp&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_120_27_120_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_31&#39;)"><span class="hl_varref"><span class="mpre">blen</span></span></a><span class="mpre">) (</span><a href="#loc_131_25_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_25_131_27&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_120_33_120_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_33_120_38&#39;)"><span class="hl_varref"><span class="mpre">every</span></span></a><span class="mpre">)
          </span><a href="#loc_131_15_131_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_19&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_125_24_125_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_24_125_28&#39;)"><span class="hl_varref"><span class="mpre">dptr</span></span></a><span class="mpre"> </span><a href="#loc_129_15_129_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_15_129_18&#39;)"><span class="hl_varref"><span class="mpre">sp0</span></span></a><span class="mpre">
  where </span><a name="loc_142_9_142_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_14&#39;)"><span class="hl_vardecl"><span class="mpre">dlast</span></span></a><span class="mpre"> = </span><a href="#loc_120_55_120_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_55_120_59&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_120_27_120_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_31&#39;)"><span class="hl_varref"><span class="mpre">blen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_145_9_145_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_18&#39;)"><span class="hl_varref"><span class="mpre">numBreaks</span></span></a><span class="mpre">
        </span><a name="loc_143_9_143_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_13&#39;)"><span class="hl_vardecl"><span class="mpre">dlen</span></span></a><span class="mpre"> | </span><a href="#loc_120_55_120_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_55_120_59&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_120_33_120_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_33_120_38&#39;)"><span class="hl_varref"><span class="mpre">every</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_142_9_142_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_14&#39;)"><span class="hl_varref"><span class="mpre">dlast</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_120_27_120_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_31&#39;)"><span class="hl_varref"><span class="mpre">blen</span></span></a><span class="mpre">
             | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">            = </span><a href="#loc_142_9_142_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_14&#39;)"><span class="hl_varref"><span class="mpre">dlast</span></span></a><span class="mpre">
        </span><a name="loc_145_9_145_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_18&#39;)"><span class="hl_vardecl"><span class="mpre">numBreaks</span></span></a><span class="mpre"> = </span><a href="#loc_120_55_120_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_55_120_59&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_120_33_120_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_33_120_38&#39;)"><span class="hl_varref"><span class="mpre">every</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Decode a base64-encoded string.  This function strictly follows</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the specification in RFC 4648,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www.apps.ietf.org/rfc/rfc4648.html&gt;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function takes the decoding table (for @base64@ or @base64url@) as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the first paramert.</span></span><span class="mpre">
</span><a href="#loc_153_1_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_16&#39;)"><span class="mpre">decodeWithTable</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_153_1_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_16&#39;)"><span class="hl_fundecl"><span class="mpre">decodeWithTable</span></span></a><span class="mpre"> </span><a name="loc_153_17_153_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_25&#39;)"><span class="hl_vardecl"><span class="mpre">decodeFP</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_153_30_153_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_30_153_33&#39;)"><span class="hl_vardecl"><span class="mpre">sfp</span></span></a><span class="mpre"> </span><a name="loc_153_34_153_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_38&#39;)"><span class="hl_vardecl"><span class="mpre">soff</span></span></a><span class="mpre"> </span><a name="loc_153_39_153_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_39_153_43&#39;)"><span class="hl_vardecl"><span class="mpre">slen</span></span></a><span class="mpre">)
    | </span><a href="#loc_197_13_197_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_13_197_17&#39;)"><span class="hl_varref"><span class="mpre">drem</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;invalid padding&quot;</span></span><span class="mpre">
    | </span><a href="#loc_198_9_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_13&#39;)"><span class="hl_varref"><span class="mpre">dlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><a name="loc_157_3_157_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_3_157_6&#39;)"><span class="hl_vardecl"><span class="mpre">dfp</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_198_9_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_13&#39;)"><span class="hl_varref"><span class="mpre">dlen</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_153_17_153_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_25&#39;)"><span class="hl_varref"><span class="mpre">decodeFP</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ !</span><a name="loc_158_32_158_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_32_158_38&#39;)"><span class="hl_vardecl"><span class="mpre">decptr</span></span></a><span class="mpre"> -&gt; do
    let </span><a name="loc_159_9_159_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_15&#39;)"><span class="hl_fundecl"><span class="mpre">finish</span></span></a><span class="mpre"> </span><a name="loc_159_16_159_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_16_159_22&#39;)"><span class="hl_vardecl"><span class="mpre">dbytes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> if </span><a href="#loc_159_16_159_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_16_159_22&#39;)"><span class="hl_varref"><span class="mpre">dbytes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                                          then </span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_157_3_157_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_3_157_6&#39;)"><span class="hl_varref"><span class="mpre">dfp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_159_16_159_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_16_159_22&#39;)"><span class="hl_varref"><span class="mpre">dbytes</span></span></a><span class="mpre">
                                          else </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">bail</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_153_30_153_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_30_153_33&#39;)"><span class="hl_varref"><span class="mpre">sfp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ !</span><a name="loc_163_29_163_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_29_163_33&#39;)"><span class="hl_vardecl"><span class="mpre">sptr</span></span></a><span class="mpre"> -&gt; do
      let </span><a name="loc_164_11_164_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_11_164_15&#39;)"><span class="hl_vardecl"><span class="mpre">sEnd</span></span></a><span class="mpre"> = </span><a href="#loc_163_29_163_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_29_163_33&#39;)"><span class="hl_varref"><span class="mpre">sptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_153_39_153_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_39_153_43&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_153_34_153_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_38&#39;)"><span class="hl_varref"><span class="mpre">soff</span></span></a><span class="mpre">)
          </span><span class="hl_fundecl"><span class="mpre">look</span></span><span class="mpre"> </span><a name="loc_165_16_165_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_16_165_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do
            </span><a name="loc_166_13_166_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_13_166_15&#39;)"><span class="hl_vardecl"><span class="mpre">ix</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_37_1_37_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_6&#39;)"><span class="hl_varref"><span class="mpre">peek8</span></span></a><span class="mpre"> </span><a href="#loc_165_16_165_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_16_165_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
            </span><a name="loc_167_13_167_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_13_167_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_37_1_37_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_6&#39;)"><span class="hl_varref"><span class="mpre">peek8</span></span></a><span class="mpre"> (</span><a href="#loc_158_32_158_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_32_158_38&#39;)"><span class="hl_varref"><span class="mpre">decptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_166_13_166_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_13_166_15&#39;)"><span class="hl_varref"><span class="mpre">ix</span></span></a><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_167_13_167_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_13_167_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
          </span><a name="loc_169_11_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_11_169_15&#39;)"><span class="hl_fundecl"><span class="mpre">fill</span></span></a><span class="mpre"> !</span><span class="hl_vardecl"><span class="mpre">dp</span></span><span class="mpre"> !</span><a name="loc_169_21_169_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_21_169_23&#39;)"><span class="hl_vardecl"><span class="mpre">sp</span></span></a><span class="mpre"> !</span><a name="loc_169_25_169_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_25_169_26&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
            | </span><a href="#loc_169_21_169_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_21_169_23&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_164_11_164_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_11_164_15&#39;)"><span class="hl_varref"><span class="mpre">sEnd</span></span></a><span class="mpre"> = </span><a href="#loc_159_9_159_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_15&#39;)"><span class="hl_varref"><span class="mpre">finish</span></span></a><span class="mpre"> </span><a href="#loc_169_25_169_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_25_169_26&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 171, srcSpanStartColumn = 27, srcSpanEndLine = 195, srcSpanEndColumn = 0}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 171, srcSpanStartColumn = 35, srcSpanEndLine = 171, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull"><span class="mpre">{-# SCC &quot;decodeWithTable/fill&quot; #-} do
            a &lt;- look sp
            b &lt;- look (sp `plusPtr` 1)
            c &lt;- look (sp `plusPtr` 2)
            d &lt;- look (sp `plusPtr` 3)
            let w = (a `shiftL` 18) .|. (b `shiftL` 12) .|.
                    (c `shiftL` 6) .|. d
            if a == done || b == done
              then bail $ &quot;invalid padding near offset &quot; ++
                   show (sp `minusPtr` sptr)
              else if a .|. b .|. c .|. d == x
              then bail $ &quot;invalid base64 encoding near offset &quot; ++
                   show (sp `minusPtr` sptr)
              else do
                poke8 dp $ fromIntegral (w `shiftR` 16)
                if c == done
                  then finish $ n + 1
                  else do
                    poke8 (dp `plusPtr` 1) $ fromIntegral (w `shiftR` 8)
                    if d == done
                      then finish $! n + 2
                      else do
                        poke8 (dp `plusPtr` 2) $ fromIntegral w
                        fill (dp `plusPtr` 3) (sp `plusPtr` 4) (n+3)</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_157_3_157_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_3_157_6&#39;)"><span class="hl_varref"><span class="mpre">dfp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_195_29_195_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_29_195_33&#39;)"><span class="hl_vardecl"><span class="mpre">dptr</span></span></a><span class="mpre"> -&gt;
        </span><a href="#loc_169_11_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_11_169_15&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a href="#loc_195_29_195_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_29_195_33&#39;)"><span class="hl_varref"><span class="mpre">dptr</span></span></a><span class="mpre"> (</span><a href="#loc_163_29_163_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_29_163_33&#39;)"><span class="hl_varref"><span class="mpre">sptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_153_34_153_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_38&#39;)"><span class="hl_varref"><span class="mpre">soff</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where (</span><a name="loc_197_10_197_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_10_197_12&#39;)"><span class="hl_vardecl"><span class="mpre">di</span></span></a><span class="mpre">,</span><a name="loc_197_13_197_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_13_197_17&#39;)"><span class="hl_vardecl"><span class="mpre">drem</span></span></a><span class="mpre">) = </span><a href="#loc_153_39_153_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_39_153_43&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`divMod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
        </span><a name="loc_198_9_198_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_13&#39;)"><span class="hl_vardecl"><span class="mpre">dlen</span></span></a><span class="mpre"> = </span><a href="#loc_197_10_197_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_10_197_12&#39;)"><span class="hl_varref"><span class="mpre">di</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Decode a base64-encoded string.  This function is lenient in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- following the specification from RFC 4648,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www.apps.ietf.org/rfc/rfc4648.html&gt;, and will not generate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parse errors no matter how poor its input.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function takes the decoding table (for @base64@ or @base64url@) as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the first paramert.</span></span><span class="mpre">
</span><a href="#loc_207_1_207_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_23&#39;)"><span class="mpre">decodeLenientWithTable</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_207_1_207_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_23&#39;)"><span class="hl_fundecl"><span class="mpre">decodeLenientWithTable</span></span></a><span class="mpre"> </span><a name="loc_207_24_207_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_24_207_32&#39;)"><span class="hl_vardecl"><span class="mpre">decodeFP</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_207_37_207_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_37_207_40&#39;)"><span class="hl_vardecl"><span class="mpre">sfp</span></span></a><span class="mpre"> </span><a name="loc_207_41_207_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_41_207_45&#39;)"><span class="hl_vardecl"><span class="mpre">soff</span></span></a><span class="mpre"> </span><a name="loc_207_46_207_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_46_207_50&#39;)"><span class="hl_vardecl"><span class="mpre">slen</span></span></a><span class="mpre">)
    | </span><a href="#loc_254_9_254_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_13&#39;)"><span class="hl_varref"><span class="mpre">dlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><a name="loc_210_3_210_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_6&#39;)"><span class="hl_vardecl"><span class="mpre">dfp</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_254_9_254_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_13&#39;)"><span class="hl_varref"><span class="mpre">dlen</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_207_24_207_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_24_207_32&#39;)"><span class="hl_varref"><span class="mpre">decodeFP</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ !</span><span class="hl_vardecl"><span class="mpre">decptr</span></span><span class="mpre"> -&gt;
    </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_207_37_207_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_37_207_40&#39;)"><span class="hl_varref"><span class="mpre">sfp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ !</span><a name="loc_212_29_212_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_29_212_33&#39;)"><span class="hl_vardecl"><span class="mpre">sptr</span></span></a><span class="mpre"> -&gt; do
      let </span><a name="loc_213_11_213_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_17&#39;)"><span class="hl_fundecl"><span class="mpre">finish</span></span></a><span class="mpre"> </span><a name="loc_213_18_213_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_18_213_24&#39;)"><span class="hl_vardecl"><span class="mpre">dbytes</span></span></a><span class="mpre">
              | </span><a href="#loc_213_18_213_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_18_213_24&#39;)"><span class="hl_varref"><span class="mpre">dbytes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_210_3_210_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_6&#39;)"><span class="hl_varref"><span class="mpre">dfp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_213_18_213_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_18_213_24&#39;)"><span class="hl_varref"><span class="mpre">dbytes</span></span></a><span class="mpre">)
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">
          </span><a name="loc_216_11_216_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_11_216_15&#39;)"><span class="hl_vardecl"><span class="mpre">sEnd</span></span></a><span class="mpre"> = </span><a href="#loc_212_29_212_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_29_212_33&#39;)"><span class="hl_varref"><span class="mpre">sptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_207_46_207_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_46_207_50&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_207_41_207_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_41_207_45&#39;)"><span class="hl_varref"><span class="mpre">soff</span></span></a><span class="mpre">)
          </span><a name="loc_217_11_217_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_11_217_15&#39;)"><span class="hl_fundecl"><span class="mpre">fill</span></span></a><span class="mpre"> !</span><span class="hl_vardecl"><span class="mpre">dp</span></span><span class="mpre"> !</span><a name="loc_217_21_217_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_21_217_23&#39;)"><span class="hl_vardecl"><span class="mpre">sp</span></span></a><span class="mpre"> !</span><a name="loc_217_25_217_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_25_217_26&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
            | </span><a href="#loc_217_21_217_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_21_217_23&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_216_11_216_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_11_216_15&#39;)"><span class="hl_varref"><span class="mpre">sEnd</span></span></a><span class="mpre"> = </span><a href="#loc_213_11_213_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_17&#39;)"><span class="hl_varref"><span class="mpre">finish</span></span></a><span class="mpre"> </span><a href="#loc_217_25_217_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_25_217_26&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 27, srcSpanEndLine = 252, srcSpanEndColumn = 0}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 35, srcSpanEndLine = 219, srcSpanEndColumn = 64},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull"><span class="mpre">{-# SCC &quot;decodeLenientWithTable/fill&quot; #-}
            let look :: Bool -&gt; Ptr Word8
                     -&gt; (Ptr Word8 -&gt; Word32 -&gt; IO ByteString)
                     -&gt; IO ByteString
                {-# INLINE look #-}
                look skipPad p0 f = go p0
                  where
                    go p | p &gt;= sEnd = f (sEnd `plusPtr` (-1)) done
                         | otherwise = {-# SCC &quot;decodeLenient/look&quot; #-} do
                      ix &lt;- fromIntegral `fmap` peek8 p
                      v &lt;- peek8 (decptr `plusPtr` ix)
                      if v == x || (v == done &amp;&amp; skipPad)
                        then go (p `plusPtr` 1)
                        else f (p `plusPtr` 1) (fromIntegral v)
            in look True sp $ \ !aNext !aValue -&gt;
               look True aNext $ \ !bNext !bValue -&gt;
                 if aValue == done || bValue == done
                 then finish n
                 else
                    look False bNext $ \ !cNext !cValue -&gt;
                    look False cNext $ \ !dNext !dValue -&gt; do
                      let w = (aValue `shiftL` 18) .|. (bValue `shiftL` 12) .|.
                              (cValue `shiftL` 6) .|. dValue
                      poke8 dp $ fromIntegral (w `shiftR` 16)
                      if cValue == done
                        then finish (n + 1)
                        else do
                          poke8 (dp `plusPtr` 1) $ fromIntegral (w `shiftR` 8)
                          if dValue == done
                            then finish (n + 2)
                            else do
                              poke8 (dp `plusPtr` 2) $ fromIntegral w
                              fill (dp `plusPtr` 3) dNext (n+3)</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_210_3_210_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_3_210_6&#39;)"><span class="hl_varref"><span class="mpre">dfp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_252_29_252_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_29_252_33&#39;)"><span class="hl_vardecl"><span class="mpre">dptr</span></span></a><span class="mpre"> -&gt;
        </span><a href="#loc_217_11_217_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_11_217_15&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a href="#loc_252_29_252_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_29_252_33&#39;)"><span class="hl_varref"><span class="mpre">dptr</span></span></a><span class="mpre"> (</span><a href="#loc_212_29_212_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_29_212_33&#39;)"><span class="hl_varref"><span class="mpre">sptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_207_41_207_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_41_207_45&#39;)"><span class="hl_varref"><span class="mpre">soff</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where </span><a name="loc_254_9_254_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_13&#39;)"><span class="hl_vardecl"><span class="mpre">dlen</span></span></a><span class="mpre"> = ((</span><a href="#loc_207_46_207_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_46_207_50&#39;)"><span class="hl_varref"><span class="mpre">slen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">

</span><a href="#loc_257_1_257_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_2&#39;)"><span class="mpre">x</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 256, srcSpanStartColumn = 6, srcSpanEndLine = 256, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 256, srcSpanStartColumn = 17, srcSpanEndLine = 256, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpa"><span class="mpre">Integral a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_257_1_257_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_2&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">255</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_257_1_257_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_2&#39;)"><span class="mpre">x</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_5&#39;)"><span class="mpre">done</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 260, srcSpanStartColumn = 9, srcSpanEndLine = 260, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base64-bytestring-1.0.0.1/Data/ByteString/Base64/Internal.hs&quot;, srcSpanStartLine = 260, srcSpanStartColumn = 20, srcSpanEndLine = 260, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpa"><span class="mpre">Integral a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_261_1_261_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_5&#39;)"><span class="hl_vardecl"><span class="mpre">done</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">99</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_5&#39;)"><span class="mpre">done</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- This takes a list of ByteStrings, and returns a list in which each</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (apart from possibly the last) has length that is a multiple of n</span></span><span class="mpre">
</span><a href="#loc_267_1_267_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_10&#39;)"><span class="mpre">reChunkIn</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">] -&gt; [</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">]
</span><a name="loc_267_1_267_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_10&#39;)"><span class="hl_fundecl"><span class="mpre">reChunkIn</span></span></a><span class="mpre"> !</span><a name="loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_269_5_269_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_5_269_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_269_5_269_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_5_269_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] = []
    </span><a href="#loc_269_5_269_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_5_269_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_270_9_270_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_9_270_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_270_13_270_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_13_270_15&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = case </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_270_9_270_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_9_270_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`divMod`</span></span><span class="mpre"> </span><a href="#loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> of
                    (_, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) -&gt; </span><a href="#loc_270_9_270_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_9_270_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_269_5_269_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_5_269_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_270_13_270_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_13_270_15&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
                    (</span><a name="loc_272_22_272_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_22_272_23&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">, _) -&gt; case </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> (</span><a href="#loc_272_22_272_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_22_272_23&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_270_9_270_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_9_270_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> of
                                (</span><a name="loc_273_34_273_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_34_273_40&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre">, </span><a name="loc_273_42_273_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_42_273_48&#39;)"><span class="hl_vardecl"><span class="mpre">suffix</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_273_34_273_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_34_273_40&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_274_5_274_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_10&#39;)"><span class="hl_varref"><span class="mpre">fixup</span></span></a><span class="mpre"> </span><a href="#loc_273_42_273_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_42_273_48&#39;)"><span class="hl_varref"><span class="mpre">suffix</span></span></a><span class="mpre"> </span><a href="#loc_270_13_270_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_13_270_15&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
    </span><a name="loc_274_5_274_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_10&#39;)"><span class="hl_fundecl"><span class="mpre">fixup</span></span></a><span class="mpre"> </span><a name="loc_274_11_274_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_11_274_14&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> [] = [</span><a href="#loc_274_11_274_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_11_274_14&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">]
    </span><a href="#loc_274_5_274_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_10&#39;)"><span class="hl_fundecl"><span class="mpre">fixup</span></span></a><span class="mpre"> </span><a name="loc_275_11_275_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_11_275_14&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> (</span><a name="loc_275_16_275_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_16_275_17&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_275_20_275_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_20_275_22&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre">) = case </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> (</span><a href="#loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_275_11_275_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_11_275_14&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) </span><a href="#loc_275_16_275_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_16_275_17&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> of
                           (</span><a name="loc_276_29_276_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_29_276_35&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre">, </span><a name="loc_276_37_276_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_37_276_43&#39;)"><span class="hl_vardecl"><span class="mpre">suffix</span></span></a><span class="mpre">) -&gt;
                             let </span><a name="loc_277_34_277_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_34_277_38&#39;)"><span class="hl_vardecl"><span class="mpre">acc&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_275_11_275_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_11_275_14&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> </span><a href="#loc_276_29_276_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_29_276_35&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre">
                             in if </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_277_34_277_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_34_277_38&#39;)"><span class="hl_varref"><span class="mpre">acc&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
                                then let </span><a name="loc_279_42_279_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_42_279_45&#39;)"><span class="hl_vardecl"><span class="mpre">zs&#39;</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_276_37_276_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_37_276_43&#39;)"><span class="hl_varref"><span class="mpre">suffix</span></span></a><span class="mpre">
                                               then          </span><a href="#loc_275_20_275_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_20_275_22&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">
                                               else </span><a href="#loc_276_37_276_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_37_276_43&#39;)"><span class="hl_varref"><span class="mpre">suffix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_275_20_275_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_20_275_22&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">
                                     in </span><a href="#loc_277_34_277_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_34_277_38&#39;)"><span class="hl_varref"><span class="mpre">acc&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_269_5_269_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_5_269_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_279_42_279_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_42_279_45&#39;)"><span class="hl_varref"><span class="mpre">zs&#39;</span></span></a><span class="mpre">
                                else </span><span class="hl_comment"><span class="mpre">-- suffix must be null</span></span><span class="mpre">
                                    </span><a href="#loc_274_5_274_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_10&#39;)"><span class="hl_varref"><span class="mpre">fixup</span></span></a><span class="mpre"> </span><a href="#loc_277_34_277_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_34_277_38&#39;)"><span class="hl_varref"><span class="mpre">acc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_275_20_275_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_20_275_22&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">
</span></div></body></html>