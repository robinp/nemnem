<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Rank2Types #-}
{-# LANGUAGE CPP #-}
</span><span class="hl_comment"><span class="mpre">{-|

This module defines a generic web application interface. It is a common
protocol between web servers and web applications.

The overriding design principles here are performance and generality. To
address performance, this library is built on top of the conduit and
blaze-builder packages.  The advantages of conduits over lazy IO have been
debated elsewhere and so will not be addressed here.  However, helper functions
like &#39;responseLBS&#39; allow you to continue using lazy IO if you so desire.

Generality is achieved by removing many variables commonly found in similar
projects that are not universal to all servers. The goal is that the &#39;Request&#39;
object contains only data which is meaningful in all circumstances.

Please remember when using this package that, while your application may
compile without a hitch against many different servers, there are other
considerations to be taken when moving to a new backend. For example, if you
transfer from a CGI application to a FastCGI one, you might suddenly find you
have a memory leak. Conversely, a FastCGI application would be well served to
preload all templates from disk when first starting; this would kill the
performance of a CGI application.

This package purposely provides very little functionality. You can find various
middlewares, backends and utilities on Hackage. Some of the most commonly used
include:

[warp] &lt;http://hackage.haskell.org/package/warp&gt;

[wai-extra] &lt;http://hackage.haskell.org/package/wai-extra&gt;

[wai-test] &lt;http://hackage.haskell.org/package/wai-test&gt;

-}</span></span><span class="mpre">
module Network.Wai
    (
      </span><span class="hl_comment"><span class="mpre">-- * Types</span></span><span class="mpre">
      Application
    , Middleware
    , ResponseReceived
      </span><span class="hl_comment"><span class="mpre">-- * Request</span></span><span class="mpre">
    , Request
    , defaultRequest
    , RequestBodyLength (..)
      </span><span class="hl_comment"><span class="mpre">-- ** Request accessors</span></span><span class="mpre">
    , requestMethod
    , httpVersion
    , rawPathInfo
    , rawQueryString
    , requestHeaders
    , isSecure
    , remoteHost
    , pathInfo
    , queryString
    , requestBody
    , vault
    , requestBodyLength
    , requestHeaderHost
    , requestHeaderRange
    , lazyRequestBody
      </span><span class="hl_comment"><span class="mpre">-- * Response</span></span><span class="mpre">
    , Response
    , StreamingBody
    , FilePart (..)
      </span><span class="hl_comment"><span class="mpre">-- ** Response composers</span></span><span class="mpre">
    , responseFile
    , responseBuilder
    , responseLBS
    , responseStream
    , responseRaw
      </span><span class="hl_comment"><span class="mpre">-- * Response accessors</span></span><span class="mpre">
    , responseStatus
    , responseHeaders
    , responseToStream
    ) where

import           Blaze.ByteString.Builder     (</span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="mpre">Builder</span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19&#39;)"><span class="mpre">fromLazyByteString</span></a><span class="mpre">)
import           Blaze.ByteString.Builder     (</span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="mpre">fromByteString</span></a><span class="mpre">)
import           Control.Monad                (</span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="mpre">unless</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 18, srcSpanEndLine = 82, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">              as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 18, srcSpanEndLine = 83, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre">         as L
import qualified Data.ByteString.Lazy.Internal as LI
import           Data.ByteString.Lazy.Internal (</span><a href="Data.ByteString.Lazy.Internal.html#loc_208_1_208_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_208_1_208_17&#39;)"><span class="mpre">defaultChunkSize</span></a><span class="mpre">)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 18, srcSpanEndLine = 86, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre">   ()
import           Data.Function                (</span><a href="Data.Function.html#loc_32_1_32_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_32_1_32_4&#39;)"><span class="mpre">fix</span></a><span class="mpre">)
import           Data.Monoid                  (</span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre">)
import qualified Network.HTTP.Types           as H
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 18, srcSpanEndLine = 90, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre">               (SockAddr (SockAddrInet))
import           Network.Wai.Internal
import qualified System.IO                    as IO
import           System.IO.Unsafe             (</span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="mpre">unsafeInterleaveIO</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Creating &#39;Response&#39; from a file.</span></span><span class="mpre">
</span><a href="#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_13&#39;)"><span class="mpre">responseFile</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Types.Status.html#loc_114_6_114_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_114_6_114_12&#39;)"><span class="hl_tyconref"><span class="mpre">H.Status</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">H.ResponseHeaders</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_98_6_98_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_98_6_98_14&#39;)"><span class="hl_tyconref"><span class="mpre">FilePart</span></span></a><span class="mpre"> -&gt; </span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre">
</span><a name="loc_99_1_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_13&#39;)"><span class="hl_vardecl"><span class="mpre">responseFile</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Internal.html#loc_75_7_75_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_75_7_75_19&#39;)"><span class="hl_conref"><span class="mpre">ResponseFile</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Creating &#39;Response&#39; from &#39;Builder&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Some questions and answers about the usage of &#39;Builder&#39; here:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Q1. Shouldn&#39;t it be at the user&#39;s discretion to use Builders internally and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then create a stream of ByteStrings?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A1. That would be less efficient, as we wouldn&#39;t get cheap concatenation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with the response headers.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Q2. Isn&#39;t it really inefficient to convert from ByteString to Builder, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then right back to ByteString?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A2. No. If the ByteStrings are small, then they will be copied into a larger</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- buffer, which should be a performance gain overall (less system calls). If</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- they are already large, then blaze-builder uses an InsertByteString</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instruction to avoid copying.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Q3. Doesn&#39;t this prevent us from creating comet-style servers, since data</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will be cached?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A3. You can force blaze-builder to output a ByteString before it is an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- optimal size by sending a flush command.</span></span><span class="mpre">
</span><a href="#loc_125_1_125_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_16&#39;)"><span class="mpre">responseBuilder</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Types.Status.html#loc_114_6_114_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_114_6_114_12&#39;)"><span class="hl_tyconref"><span class="mpre">H.Status</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">H.ResponseHeaders</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> -&gt; </span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre">
</span><a name="loc_125_1_125_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_16&#39;)"><span class="hl_vardecl"><span class="mpre">responseBuilder</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Internal.html#loc_76_7_76_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_76_7_76_22&#39;)"><span class="hl_conref"><span class="mpre">ResponseBuilder</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Creating &#39;Response&#39; from &#39;L.ByteString&#39;. This is a wrapper for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;responseBuilder&#39;.</span></span><span class="mpre">
</span><a href="#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_12&#39;)"><span class="mpre">responseLBS</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Types.Status.html#loc_114_6_114_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_114_6_114_12&#39;)"><span class="hl_tyconref"><span class="mpre">H.Status</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">H.ResponseHeaders</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre">
</span><a name="loc_130_1_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_12&#39;)"><span class="hl_fundecl"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a name="loc_130_13_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_13_130_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_130_15_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_16&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Internal.html#loc_76_7_76_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_76_7_76_22&#39;)"><span class="hl_conref"><span class="mpre">ResponseBuilder</span></span></a><span class="mpre"> </span><a href="#loc_130_13_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_13_130_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_130_15_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19&#39;)"><span class="hl_varref"><span class="mpre">fromLazyByteString</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Creating &#39;Response&#39; from a stream of values.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In order to allocate resources in an exception-safe manner, you can use the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @bracket@ pattern outside of the call to @responseStream@. As a trivial</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- app :: Application</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- app req respond = bracket_</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     (putStrLn \&quot;Allocating scarce resource\&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     (putStrLn \&quot;Cleaning up\&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     $ respond $ responseStream status200 [] $ \\write flush -&gt; do</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         write $ fromByteString \&quot;Hello\\n\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         flush</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         write $ fromByteString \&quot;World\\n\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that in some cases you can use @bracket@ from inside @responseStream@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as well. However, placing the call on the outside allows your status value</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and response headers to depend on the scarce resource.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 3.0.0</span></span><span class="mpre">
</span><a href="#loc_158_1_158_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_15&#39;)"><span class="mpre">responseStream</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Types.Status.html#loc_114_6_114_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_114_6_114_12&#39;)"><span class="hl_tyconref"><span class="mpre">H.Status</span></span></a><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">H.ResponseHeaders</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">StreamingBody</span></span><span class="mpre">
               -&gt; </span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre">
</span><a name="loc_158_1_158_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_15&#39;)"><span class="hl_vardecl"><span class="mpre">responseStream</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Internal.html#loc_77_7_77_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_77_7_77_21&#39;)"><span class="hl_conref"><span class="mpre">ResponseStream</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a response for a raw application. This is useful for \&quot;upgrade\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- situations such as WebSockets, where an application requests for the server</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to grant it raw network access.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function requires a backup response to be provided, for the case where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the handler in question does not support such upgrading (e.g., CGI apps).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In the event that you read from the request body before returning a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @responseRaw@, behavior is undefined.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 2.1.0</span></span><span class="mpre">
</span><a href="#loc_174_1_174_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_12&#39;)"><span class="mpre">responseRaw</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
            -&gt; </span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre">
            -&gt; </span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre">
</span><a name="loc_174_1_174_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_12&#39;)"><span class="hl_vardecl"><span class="mpre">responseRaw</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Internal.html#loc_78_7_78_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_78_7_78_18&#39;)"><span class="hl_conref"><span class="mpre">ResponseRaw</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Accessing &#39;H.Status&#39; in &#39;Response&#39;.</span></span><span class="mpre">
</span><a href="#loc_180_1_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_15&#39;)"><span class="mpre">responseStatus</span></a><span class="mpre"> :: </span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Types.Status.html#loc_114_6_114_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_114_6_114_12&#39;)"><span class="hl_tyconref"><span class="mpre">H.Status</span></span></a><span class="mpre">
</span><a name="loc_180_1_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_15&#39;)"><span class="hl_fundecl"><span class="mpre">responseStatus</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_75_7_75_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_75_7_75_19&#39;)"><span class="hl_conref"><span class="mpre">ResponseFile</span></span></a><span class="mpre">    </span><a name="loc_180_33_180_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_33_180_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> _ _ _) = </span><a href="#loc_180_33_180_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_33_180_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_180_1_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_15&#39;)"><span class="hl_fundecl"><span class="mpre">responseStatus</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_76_7_76_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_76_7_76_22&#39;)"><span class="hl_conref"><span class="mpre">ResponseBuilder</span></span></a><span class="mpre"> </span><a name="loc_181_33_181_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_33_181_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> _ _  ) = </span><a href="#loc_181_33_181_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_33_181_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_180_1_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_15&#39;)"><span class="hl_fundecl"><span class="mpre">responseStatus</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_77_7_77_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_77_7_77_21&#39;)"><span class="hl_conref"><span class="mpre">ResponseStream</span></span></a><span class="mpre">  </span><a name="loc_182_33_182_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_33_182_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> _ _  ) = </span><a href="#loc_182_33_182_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_33_182_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_180_1_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_15&#39;)"><span class="hl_fundecl"><span class="mpre">responseStatus</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_78_7_78_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_78_7_78_18&#39;)"><span class="hl_conref"><span class="mpre">ResponseRaw</span></span></a><span class="mpre"> _ </span><a name="loc_183_31_183_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_31_183_34&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre">      ) = </span><a href="#loc_180_1_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_15&#39;)"><span class="hl_varref"><span class="mpre">responseStatus</span></span></a><span class="mpre"> </span><a href="#loc_183_31_183_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_31_183_34&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Accessing &#39;H.ResponseHeaders&#39; in &#39;Response&#39;.</span></span><span class="mpre">
</span><a href="#loc_187_1_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_16&#39;)"><span class="mpre">responseHeaders</span></a><span class="mpre"> :: </span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">H.ResponseHeaders</span></span><span class="mpre">
</span><a name="loc_187_1_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_16&#39;)"><span class="hl_fundecl"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_75_7_75_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_75_7_75_19&#39;)"><span class="hl_conref"><span class="mpre">ResponseFile</span></span></a><span class="mpre">    _ </span><a name="loc_187_36_187_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_36_187_38&#39;)"><span class="hl_vardecl"><span class="mpre">hs</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_187_36_187_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_36_187_38&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre">
</span><a href="#loc_187_1_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_16&#39;)"><span class="hl_fundecl"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_76_7_76_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_76_7_76_22&#39;)"><span class="hl_conref"><span class="mpre">ResponseBuilder</span></span></a><span class="mpre"> _ </span><a name="loc_188_36_188_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_36_188_38&#39;)"><span class="hl_vardecl"><span class="mpre">hs</span></span></a><span class="mpre"> _  ) = </span><a href="#loc_188_36_188_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_36_188_38&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre">
</span><a href="#loc_187_1_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_16&#39;)"><span class="hl_fundecl"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_77_7_77_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_77_7_77_21&#39;)"><span class="hl_conref"><span class="mpre">ResponseStream</span></span></a><span class="mpre">  _ </span><a name="loc_189_36_189_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_36_189_38&#39;)"><span class="hl_vardecl"><span class="mpre">hs</span></span></a><span class="mpre"> _  ) = </span><a href="#loc_189_36_189_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_36_189_38&#39;)"><span class="hl_varref"><span class="mpre">hs</span></span></a><span class="mpre">
</span><a href="#loc_187_1_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_16&#39;)"><span class="hl_fundecl"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_78_7_78_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_78_7_78_18&#39;)"><span class="hl_conref"><span class="mpre">ResponseRaw</span></span></a><span class="mpre"> _ </span><a name="loc_190_32_190_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_32_190_35&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre">)        = </span><a href="#loc_187_1_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_16&#39;)"><span class="hl_varref"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> </span><a href="#loc_190_32_190_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_32_190_35&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Converting the body information in &#39;Response&#39; to a @StreamingBody@.</span></span><span class="mpre">
</span><a href="#loc_198_1_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_17&#39;)"><span class="mpre">responseToStream</span></a><span class="mpre"> :: </span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre">
                 -&gt; ( </span><a href="Network.HTTP.Types.Status.html#loc_114_6_114_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_114_6_114_12&#39;)"><span class="hl_tyconref"><span class="mpre">H.Status</span></span></a><span class="mpre">
                    , </span><span class="hl_tyconref"><span class="mpre">H.ResponseHeaders</span></span><span class="mpre">
                    , (</span><span class="hl_tyconref"><span class="mpre">StreamingBody</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                    )
</span><a name="loc_198_1_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseToStream</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_77_7_77_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_77_7_77_21&#39;)"><span class="hl_conref"><span class="mpre">ResponseStream</span></span></a><span class="mpre"> </span><a name="loc_198_34_198_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_34_198_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_198_36_198_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_36_198_37&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_198_38_198_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_38_198_39&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = (</span><a href="#loc_198_34_198_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_34_198_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_198_36_198_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_36_198_37&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">, (</span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_198_38_198_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_38_198_39&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">))
</span><a href="#loc_198_1_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseToStream</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_75_7_75_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_75_7_75_19&#39;)"><span class="hl_conref"><span class="mpre">ResponseFile</span></span></a><span class="mpre"> </span><a name="loc_199_32_199_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_32_199_33&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_199_34_199_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_34_199_35&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_199_36_199_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_36_199_38&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_199_45_199_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_45_199_49&#39;)"><span class="hl_vardecl"><span class="mpre">part</span></span></a><span class="mpre">)) =
    ( </span><a href="#loc_199_32_199_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_32_199_33&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    , </span><a href="#loc_199_34_199_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_34_199_35&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
    , \</span><a name="loc_202_8_202_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_8_202_16&#39;)"><span class="hl_vardecl"><span class="mpre">withBody</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.html#loc_397_1_397_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_397_1_397_15&#39;)"><span class="hl_varref"><span class="mpre">IO.withBinaryFile</span></span></a><span class="mpre"> </span><a href="#loc_199_36_199_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_36_199_38&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="hl_conref"><span class="mpre">IO.ReadMode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_202_56_202_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_56_202_62&#39;)"><span class="hl_vardecl"><span class="mpre">handle</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_202_8_202_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_8_202_16&#39;)"><span class="hl_varref"><span class="mpre">withBody</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_202_78_202_87" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_78_202_87&#39;)"><span class="hl_vardecl"><span class="mpre">sendChunk</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_flush</span></span><span class="mpre"> -&gt; do
        </span><a href="GHC.IO.Handle.html#loc_386_1_386_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_386_1_386_6&#39;)"><span class="hl_varref"><span class="mpre">IO.hSeek</span></span></a><span class="mpre"> </span><a href="#loc_202_56_202_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_56_202_62&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">IO.AbsoluteSeek</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_99_7_99_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_99_7_99_21&#39;)"><span class="hl_varref"><span class="mpre">filePartOffset</span></span></a><span class="mpre"> </span><a href="#loc_199_45_199_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_45_199_49&#39;)"><span class="hl_varref"><span class="mpre">part</span></span></a><span class="mpre">
        let </span><a name="loc_204_13_204_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_13_204_17&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_204_18_204_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_18_204_27&#39;)"><span class="hl_vardecl"><span class="mpre">remaining</span></span></a><span class="mpre"> | </span><a href="#loc_204_18_204_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_18_204_27&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
            </span><a href="#loc_204_13_204_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_13_204_17&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_205_18_205_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_18_205_27&#39;)"><span class="hl_vardecl"><span class="mpre">remaining</span></span></a><span class="mpre"> = do
                </span><a name="loc_206_17_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_17_206_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">B.hGetSome</span></span><span class="mpre"> </span><a href="#loc_202_56_202_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_56_202_62&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_208_1_208_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_208_1_208_17&#39;)"><span class="hl_varref"><span class="mpre">defaultChunkSize</span></span></a><span class="mpre">
                </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_206_17_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_17_206_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                    let </span><a name="loc_208_25_208_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_25_208_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre"> </span><a href="#loc_205_18_205_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_18_205_27&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre"> </span><a href="#loc_206_17_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_17_206_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    </span><a href="#loc_202_78_202_87" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_78_202_87&#39;)"><span class="hl_varref"><span class="mpre">sendChunk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_208_25_208_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_25_208_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                    </span><a href="#loc_204_13_204_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_13_204_17&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_205_18_205_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_18_205_27&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_208_25_208_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_25_208_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="#loc_204_13_204_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_13_204_17&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_100_7_100_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_100_7_100_24&#39;)"><span class="hl_varref"><span class="mpre">filePartByteCount</span></span></a><span class="mpre"> </span><a href="#loc_199_45_199_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_45_199_49&#39;)"><span class="hl_varref"><span class="mpre">part</span></span></a><span class="mpre">
    )
</span><a href="#loc_198_1_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseToStream</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_75_7_75_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_75_7_75_19&#39;)"><span class="hl_conref"><span class="mpre">ResponseFile</span></span></a><span class="mpre"> </span><a name="loc_213_32_213_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_32_213_33&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_213_34_213_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_34_213_35&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_213_36_213_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_36_213_38&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) =
    ( </span><a href="#loc_213_32_213_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_32_213_33&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    , </span><a href="#loc_213_34_213_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_34_213_35&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
    , \</span><a name="loc_216_8_216_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_8_216_16&#39;)"><span class="hl_vardecl"><span class="mpre">withBody</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.html#loc_397_1_397_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_397_1_397_15&#39;)"><span class="hl_varref"><span class="mpre">IO.withBinaryFile</span></span></a><span class="mpre"> </span><a href="#loc_213_36_213_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_36_213_38&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="hl_conref"><span class="mpre">IO.ReadMode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_216_56_216_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_56_216_62&#39;)"><span class="hl_vardecl"><span class="mpre">handle</span></span></a><span class="mpre"> -&gt;
       </span><a href="#loc_216_8_216_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_8_216_16&#39;)"><span class="hl_varref"><span class="mpre">withBody</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_217_20_217_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_20_217_29&#39;)"><span class="hl_vardecl"><span class="mpre">sendChunk</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_flush</span></span><span class="mpre"> -&gt; </span><a href="Data.Function.html#loc_32_1_32_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_32_1_32_4&#39;)"><span class="hl_varref"><span class="mpre">fix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_217_47_217_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_47_217_51&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_218_13_218_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_13_218_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">B.hGetSome</span></span><span class="mpre"> </span><a href="#loc_216_56_216_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_56_216_62&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_208_1_208_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_208_1_208_17&#39;)"><span class="hl_varref"><span class="mpre">defaultChunkSize</span></span></a><span class="mpre">
            </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_218_13_218_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_13_218_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                </span><a href="#loc_217_20_217_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_20_217_29&#39;)"><span class="hl_varref"><span class="mpre">sendChunk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_218_13_218_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_13_218_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                </span><a href="#loc_217_47_217_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_47_217_51&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
    )
</span><a href="#loc_198_1_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseToStream</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_76_7_76_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_76_7_76_22&#39;)"><span class="hl_conref"><span class="mpre">ResponseBuilder</span></span></a><span class="mpre"> </span><a name="loc_223_35_223_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_35_223_36&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_223_37_223_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_37_223_38&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_223_39_223_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_39_223_40&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) =
    (</span><a href="#loc_223_35_223_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_35_223_36&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_223_37_223_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_37_223_38&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">, \</span><a name="loc_224_13_224_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_13_224_21&#39;)"><span class="hl_vardecl"><span class="mpre">withBody</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_224_13_224_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_13_224_21&#39;)"><span class="hl_varref"><span class="mpre">withBody</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_224_37_224_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_37_224_46&#39;)"><span class="hl_vardecl"><span class="mpre">sendChunk</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_flush</span></span><span class="mpre"> -&gt; </span><a href="#loc_224_37_224_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_37_224_46&#39;)"><span class="hl_varref"><span class="mpre">sendChunk</span></span></a><span class="mpre"> </span><a href="#loc_223_39_223_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_39_223_40&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
</span><a href="#loc_198_1_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_17&#39;)"><span class="hl_fundecl"><span class="mpre">responseToStream</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_78_7_78_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_78_7_78_18&#39;)"><span class="hl_conref"><span class="mpre">ResponseRaw</span></span></a><span class="mpre"> _ </span><a name="loc_225_33_225_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_33_225_36&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre">) = </span><a href="#loc_198_1_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_17&#39;)"><span class="hl_varref"><span class="mpre">responseToStream</span></span></a><span class="mpre"> </span><a href="#loc_225_33_225_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_33_225_36&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The WAI application.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that, since WAI 3.0, this type is structured in continuation passing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- style to allow for proper safe resource handling. This was handled in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- past via other means (e.g., @ResourceT@). As a demonstration:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- app :: Application</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- app req respond = bracket_</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     (putStrLn \&quot;Allocating scarce resource\&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     (putStrLn \&quot;Cleaning up\&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     (respond $ responseLBS status200 [] \&quot;Hello World\&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 1, srcSpanEndLine = 242, srcSpanEndColumn = 87}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 1, srcSpanEndLine = 242, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 242, srcSpanStartColum"><span class="mpre">type Application = Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Middleware is a component that sits between the server and application. It</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- can do such tasks as GZIP encoding or response caching. What follows is the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- general definition of middleware, though a middleware author should feel</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- free to modify this.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- As an example of an alternate type for middleware, suppose you write a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function to load up session information. The session information is simply a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- string map \[(String, String)\]. A logical type signature for this middleware</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- might be:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @ loadSession :: ([(String, String)] -&gt; Application) -&gt; Application @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Here, instead of taking a standard &#39;Application&#39; as its first argument, the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- middleware takes a function which consumes the session information as well.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 258, srcSpanStartColumn = 1, srcSpanEndLine = 258, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 258, srcSpanStartColumn = 1, srcSpanEndLine = 258, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 258, srcSpanStartColum"><span class="mpre">type Middleware = Application -&gt; Application</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A default, blank request.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 2.0.0</span></span><span class="mpre">
</span><a href="#loc_264_1_264_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_15&#39;)"><span class="mpre">defaultRequest</span></a><span class="mpre"> :: </span><a href="Network.Wai.Internal.html#loc_20_6_20_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_20_6_20_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre">
</span><a name="loc_264_1_264_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_15&#39;)"><span class="hl_vardecl"><span class="mpre">defaultRequest</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 264, srcSpanStartColumn = 18, srcSpanEndLine = 279, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 265, srcSpanStartColumn = 5, srcSpanEndLine = 265, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-3.0.0.2/Network/Wai.hs&quot;, srcSpanStartLine = 266, srcSpanStartColu"><span class="mpre">Request
    { requestMethod = H.methodGet
    , httpVersion = H.http10
    , rawPathInfo = B.empty
    , rawQueryString = B.empty
    , requestHeaders = []
    , isSecure = False
    , remoteHost = SockAddrInet 0 0
    , pathInfo = []
    , queryString = []
    , requestBody = return B.empty
    , vault = mempty
    , requestBodyLength = KnownLength 0
    , requestHeaderHost = Nothing
    , requestHeaderRange = Nothing
    }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the request body as a lazy ByteString. This uses lazy I\/O under the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- surface, and therefore all typical warnings regarding lazy I/O apply.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 1.4.1</span></span><span class="mpre">
</span><a href="#loc_286_1_286_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_1_286_16&#39;)"><span class="mpre">lazyRequestBody</span></a><span class="mpre"> :: </span><a href="Network.Wai.Internal.html#loc_20_6_20_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_20_6_20_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_286_1_286_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_1_286_16&#39;)"><span class="hl_fundecl"><span class="mpre">lazyRequestBody</span></span></a><span class="mpre"> </span><a name="loc_286_17_286_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_17_286_20&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> =
    </span><a href="#loc_289_5_289_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_5_289_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
  where
    </span><a name="loc_289_5_289_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_5_289_9&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeInterleaveIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_290_9_290_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Internal.html#loc_55_6_55_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_55_6_55_17&#39;)"><span class="hl_varref"><span class="mpre">requestBody</span></span></a><span class="mpre"> </span><a href="#loc_286_17_286_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_17_286_20&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_290_9_290_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_19_82_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_19_82_24&#39;)"><span class="hl_conref"><span class="mpre">LI.Empty</span></span></a><span class="mpre">
            else do
                </span><a name="loc_294_17_294_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_17_294_20&#39;)"><span class="hl_vardecl"><span class="mpre">bss</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_289_5_289_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_5_289_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_27_82_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_27_82_32&#39;)"><span class="hl_conref"><span class="mpre">LI.Chunk</span></span></a><span class="mpre"> </span><a href="#loc_290_9_290_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_294_17_294_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_17_294_20&#39;)"><span class="hl_varref"><span class="mpre">bss</span></span></a><span class="mpre">
</span></div></body></html>