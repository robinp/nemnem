<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE TemplateHaskell, Rank2Types, NoMonomorphismRestriction #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Main</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (C) 2012 Edward Kmett, Niklas Haas</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  TH, Rank2, NoMonomorphismRestriction</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A simple game of pong using gloss.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
module Main where

import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">, </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="mpre">(&lt;*&gt;)</span></a><span class="mpre">)
import Control.Lens
import Control.Monad.State (State, </span><a href="Control.Monad.Trans.State.Lazy.html#loc_116_1_116_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_116_1_116_10&#39;)"><span class="mpre">execState</span></a><span class="mpre">, get)
import Control.Monad (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/examples/Pong.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;Data.Set&quot;"><span class="mpre">Data.Set</span></span><span class="mpre"> (Set, member, empty, insert, delete)

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/examples/Pong.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 8, srcSpanEndLine = 22, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Graphics.Gloss&quot;"><span class="mpre">Graphics.Gloss</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/examples/Pong.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 8, srcSpanEndLine = 23, srcSpanEndColumn = 42}, srcInfoPoints = []}) &quot;Graphics.Gloss.Interface.Pure.Game&quot;"><span class="mpre">Graphics.Gloss.Interface.Pure.Game</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/examples/Pong.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 21}, srcInfoPoints = []}) &quot;System.Random&quot;"><span class="mpre">System.Random</span></span><span class="mpre"> (randomRs, newStdGen)

</span><span class="hl_comment"><span class="mpre">-- Some global constants</span></span><span class="mpre">

</span><a name="loc_29_1_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_9&#39;)"><span class="hl_vardecl"><span class="mpre">gameSize</span></span></a><span class="mpre">        = </span><span class="hl_num"><span class="mpre">300</span></span><span class="mpre">
</span><a name="loc_30_1_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_12&#39;)"><span class="hl_vardecl"><span class="mpre">windowWidth</span></span></a><span class="mpre">     = </span><span class="hl_num"><span class="mpre">800</span></span><span class="mpre">
</span><a name="loc_31_1_31_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_13&#39;)"><span class="hl_vardecl"><span class="mpre">windowHeight</span></span></a><span class="mpre">    = </span><span class="hl_num"><span class="mpre">600</span></span><span class="mpre">
</span><a name="loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="hl_vardecl"><span class="mpre">ballRadius</span></span></a><span class="mpre">      = </span><span class="hl_num"><span class="mpre">0.02</span></span><span class="mpre">
</span><a name="loc_33_1_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_14&#39;)"><span class="hl_vardecl"><span class="mpre">speedIncrease</span></span></a><span class="mpre">   = </span><span class="hl_num"><span class="mpre">1.2</span></span><span class="mpre">
</span><a name="loc_34_1_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_15&#39;)"><span class="hl_vardecl"><span class="mpre">losingAccuracy</span></span></a><span class="mpre">  = </span><span class="hl_num"><span class="mpre">0.9</span></span><span class="mpre">
</span><a name="loc_35_1_35_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_16&#39;)"><span class="hl_vardecl"><span class="mpre">winningAccuracy</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0.1</span></span><span class="mpre">
</span><a name="loc_36_1_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_13&#39;)"><span class="hl_vardecl"><span class="mpre">initialSpeed</span></span></a><span class="mpre">    = </span><span class="hl_num"><span class="mpre">0.6</span></span><span class="mpre">
</span><a name="loc_37_1_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_12&#39;)"><span class="hl_vardecl"><span class="mpre">paddleWidth</span></span></a><span class="mpre">     = </span><span class="hl_num"><span class="mpre">0.02</span></span><span class="mpre">
</span><a name="loc_38_1_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_13&#39;)"><span class="hl_vardecl"><span class="mpre">paddleHeight</span></span></a><span class="mpre">    = </span><span class="hl_num"><span class="mpre">0.3</span></span><span class="mpre">
</span><a name="loc_39_1_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_12&#39;)"><span class="hl_vardecl"><span class="mpre">paddleSpeed</span></span></a><span class="mpre">     = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
</span><a name="loc_40_1_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_9&#39;)"><span class="hl_vardecl"><span class="mpre">textSize</span></span></a><span class="mpre">        = </span><span class="hl_num"><span class="mpre">0.001</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Pure data type for representing the game state</span></span><span class="mpre">

data </span><a name="loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Pong</span></span></a><span class="mpre"> = </span><a name="loc_44_13_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_17&#39;)"><span class="hl_condecl"><span class="mpre">Pong</span></span></a><span class="mpre">
  { </span><a name="loc_45_5_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_13&#39;)"><span class="hl_fielddecl"><span class="mpre">_ballPos</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Point</span></span><span class="mpre">
  , </span><a name="loc_46_5_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_15&#39;)"><span class="hl_fielddecl"><span class="mpre">_ballSpeed</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre">
  , </span><a name="loc_47_5_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_13&#39;)"><span class="hl_fielddecl"><span class="mpre">_paddle1</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">
  , </span><a name="loc_48_5_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_5_48_13&#39;)"><span class="hl_fielddecl"><span class="mpre">_paddle2</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">
  , </span><a name="loc_49_5_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_11&#39;)"><span class="hl_fielddecl"><span class="mpre">_score</span></span></a><span class="mpre">     :: (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  , </span><a name="loc_50_5_50_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_13&#39;)"><span class="hl_fielddecl"><span class="mpre">_vectors</span></span></a><span class="mpre">   :: [</span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre">]

  </span><span class="hl_comment"><span class="mpre">-- Since gloss doesn&#39;t cover this, we store the set of pressed keys</span></span><span class="mpre">
  , </span><a name="loc_53_5_53_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_10&#39;)"><span class="hl_fielddecl"><span class="mpre">_keys</span></span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Set</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Key</span></span><span class="mpre">
  }

</span><span class="hl_comment"><span class="mpre">-- Some nice lenses to go with it</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclSpliceDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/examples/Pong.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 1, srcSpanEndLine = 57, srcSpanEndColumn = 18}, srcInfoPoints = []}) (App (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/examples/Pong.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 1, srcSpanEndLine = 57, srcSpanEndColumn = 18}, srcInfoPoints = []}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/v"><span class="mpre">makeLenses &#39;&#39;Pong</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Renamed tuple lenses for enhanced clarity with points/vectors</span></span><span class="mpre">
</span><a name="loc_60_1_60_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_3&#39;)"><span class="hl_vardecl"><span class="mpre">_x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">_1</span></span><span class="mpre">
</span><a name="loc_61_1_61_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_3&#39;)"><span class="hl_vardecl"><span class="mpre">_y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">_2</span></span><span class="mpre">

</span><a href="#loc_64_1_64_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_8&#39;)"><span class="mpre">initial</span></a><span class="mpre"> :: </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre">
</span><a name="loc_64_1_64_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_8&#39;)"><span class="hl_vardecl"><span class="mpre">initial</span></span></a><span class="mpre"> = </span><a href="#loc_44_13_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_17&#39;)"><span class="hl_conref"><span class="mpre">Pong</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) [] </span><span class="hl_varref"><span class="mpre">empty</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Calculate the y position at which the ball will next hit (on player2&#39;s side)</span></span><span class="mpre">
</span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="mpre">hitPos</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Point</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">
</span><a name="loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_fundecl"><span class="mpre">hitPos</span></span></a><span class="mpre"> (</span><a name="loc_68_9_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_68_11_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_12&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a name="loc_68_15_68_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_16&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">,</span><a name="loc_68_17_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_17_68_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="#loc_73_5_73_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_9&#39;)"><span class="hl_varref"><span class="mpre">ypos</span></span></a><span class="mpre">
  where
    </span><a name="loc_70_5_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_10&#39;)"><span class="hl_vardecl"><span class="mpre">xdist</span></span></a><span class="mpre"> = if </span><a href="#loc_68_15_68_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_68_9_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_68_9_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a name="loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_vardecl"><span class="mpre">time</span></span></a><span class="mpre">  = </span><a href="#loc_70_5_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_10&#39;)"><span class="hl_varref"><span class="mpre">xdist</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_68_15_68_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">
    </span><a name="loc_72_5_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_10&#39;)"><span class="hl_vardecl"><span class="mpre">ydist</span></span></a><span class="mpre"> = </span><a href="#loc_68_17_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_17_68_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_71_5_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_9&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre">
    </span><a name="loc_73_5_73_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_9&#39;)"><span class="hl_vardecl"><span class="mpre">ypos</span></span></a><span class="mpre">  = </span><a href="#loc_77_5_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_11&#39;)"><span class="hl_varref"><span class="mpre">bounce</span></span></a><span class="mpre"> (</span><a href="#loc_68_11_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_72_5_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_10&#39;)"><span class="hl_varref"><span class="mpre">ydist</span></span></a><span class="mpre">)
    </span><a name="loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">     = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="hl_varref"><span class="mpre">ballRadius</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Calculate bounces iteratively</span></span><span class="mpre">
    </span><a name="loc_77_5_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_11&#39;)"><span class="hl_fundecl"><span class="mpre">bounce</span></span></a><span class="mpre"> </span><a name="loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
      | </span><a href="#loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre">  </span><a href="#loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">    = </span><a href="#loc_77_5_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_11&#39;)"><span class="hl_varref"><span class="mpre">bounce</span></span></a><span class="mpre"> (  </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
      | </span><a href="#loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> -</span><a href="#loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">    = </span><a href="#loc_77_5_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_11&#39;)"><span class="hl_varref"><span class="mpre">bounce</span></span></a><span class="mpre"> ((-</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_74_5_74_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_6&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Difficulty function</span></span><span class="mpre">
</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="mpre">accuracy</span></a><span class="mpre"> :: </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">
</span><a name="loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_fundecl"><span class="mpre">accuracy</span></span></a><span class="mpre"> </span><a name="loc_84_10_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_10_84_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_89_5_89_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_87_5_87_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_84_10_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_10_84_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">score</span></span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">_1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_84_10_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_10_84_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">score</span></span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">_2</span></span><span class="mpre">
  where
    </span><span class="hl_comment"><span class="mpre">-- Scaling function</span></span><span class="mpre">
    </span><a name="loc_87_5_87_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_87_7_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_7_87_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0.04</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_87_7_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_7_87_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.5</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Clamping function</span></span><span class="mpre">
    </span><a name="loc_89_5_89_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_6&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_34_1_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_15&#39;)"><span class="hl_varref"><span class="mpre">losingAccuracy</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_35_1_35_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_16&#39;)"><span class="hl_varref"><span class="mpre">winningAccuracy</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Game update logic</span></span><span class="mpre">

</span><a href="#loc_94_1_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_7&#39;)"><span class="mpre">update</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre">
</span><a name="loc_94_1_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_7&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> </span><a name="loc_94_8_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_8_94_12&#39;)"><span class="hl_vardecl"><span class="mpre">time</span></span></a><span class="mpre"> = </span><a href="Control.Monad.Trans.State.Lazy.html#loc_116_1_116_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_116_1_116_10&#39;)"><span class="hl_varref"><span class="mpre">execState</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><a href="#loc_110_1_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_14&#39;)"><span class="hl_varref"><span class="mpre">updatePaddles</span></span></a><span class="mpre"> </span><a href="#loc_94_8_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_8_94_12&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre">
  </span><a href="#loc_101_1_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_11&#39;)"><span class="hl_varref"><span class="mpre">updateBall</span></span></a><span class="mpre"> </span><a href="#loc_94_8_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_8_94_12&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre">
  </span><a href="#loc_143_1_143_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_12&#39;)"><span class="hl_varref"><span class="mpre">checkBounds</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Move the ball by adding its current speed</span></span><span class="mpre">
</span><a href="#loc_101_1_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_11&#39;)"><span class="mpre">updateBall</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_101_1_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_11&#39;)"><span class="hl_fundecl"><span class="mpre">updateBall</span></span></a><span class="mpre"> </span><a name="loc_101_12_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_16&#39;)"><span class="hl_vardecl"><span class="mpre">time</span></span></a><span class="mpre"> = do
  (</span><a name="loc_102_4_102_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_4_102_5&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">, </span><a name="loc_102_7_102_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_7_102_8&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) &lt;- </span><a href="Control.Lens.Getter.html#loc_299_1_299_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_299_1_299_4&#39;)"><span class="hl_varref"><span class="mpre">use</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ballSpeed</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">ballPos</span></span><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_837_3_837_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_837_3_837_5&#39;)"><span class="hl_infix"><span class="mpre">+=</span></span></a><span class="mpre"> (</span><a href="#loc_101_12_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_16&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_102_4_102_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_4_102_5&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">, </span><a href="#loc_101_12_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_16&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_102_7_102_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_7_102_8&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- Make sure it doesn&#39;t leave the playing area</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">ballPos</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="Control.Lens.Traversal.html#loc_728_1_728_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Traversal.html#loc_728_1_728_5&#39;)"><span class="hl_varref"><span class="mpre">both</span></span></a><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_791_3_791_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_791_3_791_5&#39;)"><span class="hl_infix"><span class="mpre">%=</span></span></a><span class="mpre"> </span><a href="#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">clamp</span></span></a><span class="mpre"> </span><a href="#loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="hl_varref"><span class="mpre">ballRadius</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Update the paddles</span></span><span class="mpre">
</span><a href="#loc_110_1_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_14&#39;)"><span class="mpre">updatePaddles</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_110_1_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_14&#39;)"><span class="hl_fundecl"><span class="mpre">updatePaddles</span></span></a><span class="mpre"> </span><a name="loc_110_15_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_15_110_19&#39;)"><span class="hl_vardecl"><span class="mpre">time</span></span></a><span class="mpre"> = do
  </span><a name="loc_111_3_111_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">

  let </span><a name="loc_113_7_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_7_113_21&#39;)"><span class="hl_vardecl"><span class="mpre">paddleMovement</span></span></a><span class="mpre"> = </span><a href="#loc_110_15_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_15_110_19&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_39_1_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_12&#39;)"><span class="hl_varref"><span class="mpre">paddleSpeed</span></span></a><span class="mpre">
      </span><a name="loc_114_7_114_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_7_114_17&#39;)"><span class="hl_fundecl"><span class="mpre">keyPressed</span></span></a><span class="mpre"> </span><a name="loc_114_18_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_21&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre"> = </span><a href="#loc_111_3_111_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">keys</span></span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">SpecialKey</span></span><span class="mpre"> </span><a href="#loc_114_18_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_21&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- Update the player&#39;s paddle based on keys</span></span><span class="mpre">
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_114_7_114_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_7_114_17&#39;)"><span class="hl_varref"><span class="mpre">keyPressed</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">KeyUp</span></span><span class="mpre">)   </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">paddle1</span></span><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_837_3_837_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_837_3_837_5&#39;)"><span class="hl_infix"><span class="mpre">+=</span></span></a><span class="mpre"> </span><a href="#loc_113_7_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_7_113_21&#39;)"><span class="hl_varref"><span class="mpre">paddleMovement</span></span></a><span class="mpre">
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_114_7_114_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_7_114_17&#39;)"><span class="hl_varref"><span class="mpre">keyPressed</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">KeyDown</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">paddle1</span></span><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_852_3_852_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_852_3_852_5&#39;)"><span class="hl_infix"><span class="mpre">-=</span></span></a><span class="mpre"> </span><a href="#loc_113_7_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_7_113_21&#39;)"><span class="hl_varref"><span class="mpre">paddleMovement</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Calculate the optimal position</span></span><span class="mpre">
  let </span><a name="loc_121_7_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_14&#39;)"><span class="hl_vardecl"><span class="mpre">optimal</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_varref"><span class="mpre">hitPos</span></span></a><span class="mpre"> (</span><a href="#loc_111_3_111_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">ballPos</span></span><span class="mpre">) (</span><a href="#loc_111_3_111_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">ballSpeed</span></span><span class="mpre">)
      </span><a name="loc_122_7_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_10&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">     = </span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">accuracy</span></span></a><span class="mpre"> </span><a href="#loc_111_3_111_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
      </span><a name="loc_123_7_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_13&#39;)"><span class="hl_vardecl"><span class="mpre">target</span></span></a><span class="mpre">  = </span><a href="#loc_121_7_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_14&#39;)"><span class="hl_varref"><span class="mpre">optimal</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_122_7_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_10&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_111_3_111_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">ballPos</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="#loc_61_1_61_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_3&#39;)"><span class="hl_varref"><span class="mpre">_y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_122_7_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_10&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)
      </span><a name="loc_124_7_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_11&#39;)"><span class="hl_vardecl"><span class="mpre">dist</span></span></a><span class="mpre">    = </span><a href="#loc_123_7_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_13&#39;)"><span class="hl_varref"><span class="mpre">target</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_111_3_111_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">paddle2</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Move the CPU&#39;s paddle towards this optimal position as needed</span></span><span class="mpre">
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_124_7_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_11&#39;)"><span class="hl_varref"><span class="mpre">dist</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_38_1_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_13&#39;)"><span class="hl_varref"><span class="mpre">paddleHeight</span></span></a><span class="hl_infix"><span class="mpre">/</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_124_7_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_11&#39;)"><span class="hl_varref"><span class="mpre">dist</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">paddle2</span></span><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_837_3_837_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_837_3_837_5&#39;)"><span class="hl_infix"><span class="mpre">+=</span></span></a><span class="mpre"> </span><a href="#loc_113_7_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_7_113_21&#39;)"><span class="hl_varref"><span class="mpre">paddleMovement</span></span></a><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">paddle2</span></span><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_852_3_852_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_852_3_852_5&#39;)"><span class="hl_infix"><span class="mpre">-=</span></span></a><span class="mpre"> </span><a href="#loc_113_7_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_7_113_21&#39;)"><span class="hl_varref"><span class="mpre">paddleMovement</span></span></a><span class="mpre">
      _  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Make sure both paddles don&#39;t leave the playing area</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">paddle1</span></span><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_791_3_791_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_791_3_791_5&#39;)"><span class="hl_infix"><span class="mpre">%=</span></span></a><span class="mpre"> </span><a href="#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">clamp</span></span></a><span class="mpre"> (</span><a href="#loc_38_1_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_13&#39;)"><span class="hl_varref"><span class="mpre">paddleHeight</span></span></a><span class="hl_infix"><span class="mpre">/</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">paddle2</span></span><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_791_3_791_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_791_3_791_5&#39;)"><span class="hl_infix"><span class="mpre">%=</span></span></a><span class="mpre"> </span><a href="#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">clamp</span></span></a><span class="mpre"> (</span><a href="#loc_38_1_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_13&#39;)"><span class="hl_varref"><span class="mpre">paddleHeight</span></span></a><span class="hl_infix"><span class="mpre">/</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Clamp to the region (-1, 1) but with padding</span></span><span class="mpre">
</span><a href="#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_6&#39;)"><span class="mpre">clamp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">
</span><a name="loc_139_1_139_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_6&#39;)"><span class="hl_fundecl"><span class="mpre">clamp</span></span></a><span class="mpre"> </span><a name="loc_139_7_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_7_139_10&#39;)"><span class="hl_vardecl"><span class="mpre">pad</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_139_7_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_7_139_10&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_139_7_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_7_139_10&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Check for collisions and/or scores</span></span><span class="mpre">
</span><a href="#loc_143_1_143_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_12&#39;)"><span class="mpre">checkBounds</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_143_1_143_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_12&#39;)"><span class="hl_vardecl"><span class="mpre">checkBounds</span></span></a><span class="mpre"> = do
  </span><a name="loc_144_3_144_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_3_144_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
  let (</span><a name="loc_145_8_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_8_145_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_145_10_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><a href="#loc_144_3_144_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_3_144_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">ballPos</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Check for collisions with the top or bottom</span></span><span class="mpre">
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_145_10_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_165_5_165_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_9&#39;)"><span class="hl_varref"><span class="mpre">edge</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">ballSpeed</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="#loc_61_1_61_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_3&#39;)"><span class="hl_varref"><span class="mpre">_y</span></span></a><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_791_3_791_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_791_3_791_5&#39;)"><span class="hl_infix"><span class="mpre">%=</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">negate</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Check for collisions with paddles</span></span><span class="mpre">
  let </span><a name="loc_152_7_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_7_152_12&#39;)"><span class="hl_fundecl"><span class="mpre">check</span></span></a><span class="mpre"> </span><a name="loc_152_13_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_19&#39;)"><span class="hl_vardecl"><span class="mpre">paddle</span></span></a><span class="mpre"> </span><a name="loc_152_20_152_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_25&#39;)"><span class="hl_vardecl"><span class="mpre">other</span></span></a><span class="mpre">
        | </span><a href="#loc_145_10_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_144_3_144_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_3_144_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_152_13_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_19&#39;)"><span class="hl_varref"><span class="mpre">paddle</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_38_1_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_13&#39;)"><span class="hl_varref"><span class="mpre">paddleHeight</span></span></a><span class="hl_infix"><span class="mpre">/</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_145_10_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_144_3_144_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_3_144_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_152_13_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_19&#39;)"><span class="hl_varref"><span class="mpre">paddle</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_38_1_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_13&#39;)"><span class="hl_varref"><span class="mpre">paddleHeight</span></span></a><span class="hl_infix"><span class="mpre">/</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> = do
            </span><span class="hl_varref"><span class="mpre">ballSpeed</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="#loc_60_1_60_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_3&#39;)"><span class="hl_varref"><span class="mpre">_x</span></span></a><span class="mpre">   </span><a href="Control.Lens.Setter.html#loc_791_3_791_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_791_3_791_5&#39;)"><span class="hl_infix"><span class="mpre">%=</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">negate</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">ballSpeed</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="#loc_61_1_61_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_3&#39;)"><span class="hl_varref"><span class="mpre">_y</span></span></a><span class="mpre">   </span><a href="Control.Lens.Setter.html#loc_837_3_837_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_837_3_837_5&#39;)"><span class="hl_infix"><span class="mpre">+=</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre">(</span><a href="#loc_145_10_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_144_3_144_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_3_144_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_152_13_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_19&#39;)"><span class="hl_varref"><span class="mpre">paddle</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- add english</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">ballSpeed</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="Control.Lens.Traversal.html#loc_728_1_728_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Traversal.html#loc_728_1_728_5&#39;)"><span class="hl_varref"><span class="mpre">both</span></span></a><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_867_3_867_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_867_3_867_5&#39;)"><span class="hl_infix"><span class="mpre">*=</span></span></a><span class="mpre"> </span><a href="#loc_33_1_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_14&#39;)"><span class="hl_varref"><span class="mpre">speedIncrease</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
          </span><span class="hl_varref"><span class="mpre">score</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="#loc_152_20_152_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_25&#39;)"><span class="hl_varref"><span class="mpre">other</span></span></a><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_837_3_837_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_837_3_837_5&#39;)"><span class="hl_infix"><span class="mpre">+=</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
          </span><a href="#loc_169_1_169_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_6&#39;)"><span class="hl_varref"><span class="mpre">reset</span></span></a><span class="mpre">

  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_145_8_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_8_145_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre">  </span><a href="#loc_165_5_165_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_9&#39;)"><span class="hl_varref"><span class="mpre">edge</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_152_7_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_7_152_12&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">paddle2</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">_1</span></span><span class="mpre">
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_145_8_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_8_145_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> -</span><a href="#loc_165_5_165_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_9&#39;)"><span class="hl_varref"><span class="mpre">edge</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_152_7_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_7_152_12&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">paddle1</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">_2</span></span><span class="mpre">

  where
    </span><a name="loc_165_5_165_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_9&#39;)"><span class="hl_vardecl"><span class="mpre">edge</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="hl_varref"><span class="mpre">ballRadius</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Reset the game</span></span><span class="mpre">
</span><a href="#loc_169_1_169_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_6&#39;)"><span class="mpre">reset</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_169_1_169_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_6&#39;)"><span class="hl_vardecl"><span class="mpre">reset</span></span></a><span class="mpre"> = do
  </span><span class="hl_varref"><span class="mpre">ballPos</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.=</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">ballSpeed</span></span><span class="mpre"> </span><a href="Control.Lens.Setter.html#loc_980_3_980_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Setter.html#loc_980_3_980_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;~</span></span></a><span class="mpre"> </span><a href="#loc_175_1_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_10&#39;)"><span class="hl_varref"><span class="mpre">nextSpeed</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Retrieve a speed from the list, dropping it in the process</span></span><span class="mpre">
</span><a href="#loc_175_1_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_10&#39;)"><span class="mpre">nextSpeed</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre">
</span><a name="loc_175_1_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_10&#39;)"><span class="hl_vardecl"><span class="mpre">nextSpeed</span></span></a><span class="mpre"> = do
  </span><a name="loc_176_3_176_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_3_176_4&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_176_5_176_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_5_176_7&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Lens.Getter.html#loc_299_1_299_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_299_1_299_4&#39;)"><span class="hl_varref"><span class="mpre">use</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">vectors</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">vectors</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.=</span></span><span class="mpre"> </span><a href="#loc_176_5_176_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_5_176_7&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_176_3_176_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_3_176_4&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Drawing a pong state to the screen</span></span><span class="mpre">

</span><a href="#loc_183_1_183_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_5&#39;)"><span class="mpre">draw</span></a><span class="mpre"> :: </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Picture</span></span><span class="mpre">
</span><a name="loc_183_1_183_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_5&#39;)"><span class="hl_fundecl"><span class="mpre">draw</span></span></a><span class="mpre"> </span><a name="loc_183_6_183_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_6_183_7&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">scale</span></span><span class="mpre"> </span><a href="#loc_29_1_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_9&#39;)"><span class="hl_varref"><span class="mpre">gameSize</span></span></a><span class="mpre"> </span><a href="#loc_29_1_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_9&#39;)"><span class="hl_varref"><span class="mpre">gameSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Pictures</span></span><span class="mpre">
  [ </span><a href="#loc_200_1_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_9&#39;)"><span class="hl_varref"><span class="mpre">drawBall</span></span></a><span class="mpre">   </span><a href="#loc_194_7_194_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_7_194_11&#39;)"><span class="hl_infix"><span class="mpre">`at`</span></span></a><span class="mpre"> </span><a href="#loc_183_6_183_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_6_183_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">ballPos</span></span><span class="mpre">
  , </span><a href="#loc_197_1_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_11&#39;)"><span class="hl_varref"><span class="mpre">drawPaddle</span></span></a><span class="mpre"> </span><a href="#loc_194_7_194_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_7_194_11&#39;)"><span class="hl_infix"><span class="mpre">`at`</span></span></a><span class="mpre"> (-</span><a href="#loc_193_5_193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_5_193_12&#39;)"><span class="hl_varref"><span class="mpre">paddleX</span></span></a><span class="mpre">, </span><a href="#loc_183_6_183_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_6_183_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">paddle1</span></span><span class="mpre">)
  , </span><a href="#loc_197_1_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_11&#39;)"><span class="hl_varref"><span class="mpre">drawPaddle</span></span></a><span class="mpre"> </span><a href="#loc_194_7_194_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_7_194_11&#39;)"><span class="hl_infix"><span class="mpre">`at`</span></span></a><span class="mpre"> ( </span><a href="#loc_193_5_193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_5_193_12&#39;)"><span class="hl_varref"><span class="mpre">paddleX</span></span></a><span class="mpre">, </span><a href="#loc_183_6_183_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_6_183_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">paddle2</span></span><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- Score and playing field</span></span><span class="mpre">
  , </span><a href="#loc_203_1_203_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_10&#39;)"><span class="hl_varref"><span class="mpre">drawScore</span></span></a><span class="mpre"> (</span><a href="#loc_183_6_183_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_6_183_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">score</span></span><span class="mpre">) </span><a href="#loc_194_7_194_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_7_194_11&#39;)"><span class="hl_infix"><span class="mpre">`at`</span></span></a><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">0.1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0.85</span></span><span class="mpre">)
  , </span><span class="hl_varref"><span class="mpre">rectangleWire</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
  ]
  where
    </span><a name="loc_193_5_193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_5_193_12&#39;)"><span class="hl_vardecl"><span class="mpre">paddleX</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_37_1_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_12&#39;)"><span class="hl_varref"><span class="mpre">paddleWidth</span></span></a><span class="hl_infix"><span class="mpre">/</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
    </span><a name="loc_194_5_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_5_194_6&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_194_7_194_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_7_194_11&#39;)"><span class="hl_fundecl"><span class="mpre">`at`</span></span></a><span class="mpre"> (</span><a name="loc_194_13_194_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_13_194_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_194_15_194_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_15_194_16&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">translate</span></span><span class="mpre"> </span><a href="#loc_194_13_194_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_13_194_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_194_15_194_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_15_194_16&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_194_5_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_5_194_6&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/examples/Pong.hs&quot;, srcSpanStartLine = 194, srcSpanStartColumn = 37, srcSpanEndLine = 194, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/examples/Pong.hs&quot;, srcSpanStartLine = 194, srcSpanStartColumn = 44, srcSpanEndLine = 194, srcSpanEndColumn = 45}]}) (AssocRight (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/examples/Pong.hs"><span class="mpre">infixr 1 `at`</span></span><span class="mpre">

</span><a href="#loc_197_1_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_11&#39;)"><span class="mpre">drawPaddle</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Picture</span></span><span class="mpre">
</span><a name="loc_197_1_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_11&#39;)"><span class="hl_vardecl"><span class="mpre">drawPaddle</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">rectangleSolid</span></span><span class="mpre"> </span><a href="#loc_37_1_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_12&#39;)"><span class="hl_varref"><span class="mpre">paddleWidth</span></span></a><span class="mpre"> </span><a href="#loc_38_1_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_13&#39;)"><span class="hl_varref"><span class="mpre">paddleHeight</span></span></a><span class="mpre">

</span><a href="#loc_200_1_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_9&#39;)"><span class="mpre">drawBall</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Picture</span></span><span class="mpre">
</span><a name="loc_200_1_200_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_9&#39;)"><span class="hl_vardecl"><span class="mpre">drawBall</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">circleSolid</span></span><span class="mpre"> </span><a href="#loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="hl_varref"><span class="mpre">ballRadius</span></span></a><span class="mpre">

</span><a href="#loc_203_1_203_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_10&#39;)"><span class="mpre">drawScore</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Picture</span></span><span class="mpre">
</span><a name="loc_203_1_203_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_10&#39;)"><span class="hl_fundecl"><span class="mpre">drawScore</span></span></a><span class="mpre"> (</span><a name="loc_203_12_203_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_12_203_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_203_15_203_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_15_203_16&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">scale</span></span><span class="mpre"> </span><a href="#loc_40_1_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_9&#39;)"><span class="hl_varref"><span class="mpre">textSize</span></span></a><span class="mpre"> </span><a href="#loc_40_1_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_9&#39;)"><span class="hl_varref"><span class="mpre">textSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">text</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_203_12_203_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_12_203_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_203_15_203_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_15_203_16&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Handle input by simply updating the keys set</span></span><span class="mpre">

</span><a href="#loc_208_1_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_7&#39;)"><span class="mpre">handle</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Event</span></span><span class="mpre"> -&gt; </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Pong</span></span></a><span class="mpre">
</span><a name="loc_208_1_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_7&#39;)"><span class="hl_fundecl"><span class="mpre">handle</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">EventKey</span></span><span class="mpre"> </span><a name="loc_208_18_208_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_18_208_19&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_208_20_208_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_20_208_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> _ _) = </span><span class="hl_varref"><span class="mpre">keys</span></span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_208_18_208_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_18_208_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> (</span><a href="#loc_208_20_208_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_20_208_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Down</span></span><span class="mpre">)
</span><a href="#loc_208_1_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_7&#39;)"><span class="hl_fundecl"><span class="mpre">handle</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- The main program action</span></span><span class="mpre">

</span><a name="loc_213_1_213_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = do
  </span><a name="loc_214_3_214_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_3_214_4&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_214_5_214_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_7&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_226_1_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_15&#39;)"><span class="hl_varref"><span class="mpre">startingSpeeds</span></span></a><span class="mpre">
  let </span><a name="loc_215_7_215_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_7_215_12&#39;)"><span class="hl_vardecl"><span class="mpre">world</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">ballSpeed</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><a href="#loc_214_3_214_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_3_214_4&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">vectors</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><a href="#loc_214_5_214_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_7&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_64_1_64_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_8&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">play</span></span><span class="mpre"> </span><a href="#loc_219_5_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_5_219_12&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_220_5_220_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_5_220_14&#39;)"><span class="hl_varref"><span class="mpre">backColor</span></span></a><span class="mpre"> </span><a href="#loc_221_5_221_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_5_221_8&#39;)"><span class="hl_varref"><span class="mpre">fps</span></span></a><span class="mpre"> </span><a href="#loc_215_7_215_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_7_215_12&#39;)"><span class="hl_varref"><span class="mpre">world</span></span></a><span class="mpre"> </span><a href="#loc_183_1_183_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_5&#39;)"><span class="hl_varref"><span class="mpre">draw</span></span></a><span class="mpre"> </span><a href="#loc_208_1_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_7&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a href="#loc_94_1_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_7&#39;)"><span class="hl_varref"><span class="mpre">update</span></span></a><span class="mpre">

  where
    </span><a name="loc_219_5_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_5_219_12&#39;)"><span class="hl_vardecl"><span class="mpre">display</span></span></a><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">InWindow</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Pong!&quot;</span></span><span class="mpre"> (</span><a href="#loc_30_1_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_12&#39;)"><span class="hl_varref"><span class="mpre">windowWidth</span></span></a><span class="mpre">, </span><a href="#loc_31_1_31_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_13&#39;)"><span class="hl_varref"><span class="mpre">windowHeight</span></span></a><span class="mpre">) (</span><span class="hl_num"><span class="mpre">200</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">200</span></span><span class="mpre">)
    </span><a name="loc_220_5_220_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_5_220_14&#39;)"><span class="hl_vardecl"><span class="mpre">backColor</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">white</span></span><span class="mpre">
    </span><a name="loc_221_5_221_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_5_221_8&#39;)"><span class="hl_vardecl"><span class="mpre">fps</span></span></a><span class="mpre">       = </span><span class="hl_num"><span class="mpre">120</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Generate the random list of starting speeds</span></span><span class="mpre">

</span><a href="#loc_226_1_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_15&#39;)"><span class="mpre">startingSpeeds</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre">]
</span><a name="loc_226_1_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_15&#39;)"><span class="hl_vardecl"><span class="mpre">startingSpeeds</span></span></a><span class="mpre"> = do
  </span><a name="loc_227_3_227_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_5&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">randomRs</span></span><span class="mpre"> (-</span><a href="#loc_36_1_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_13&#39;)"><span class="hl_varref"><span class="mpre">initialSpeed</span></span></a><span class="mpre">, </span><a href="#loc_36_1_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_13&#39;)"><span class="hl_varref"><span class="mpre">initialSpeed</span></span></a><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newStdGen</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_232_5_232_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_15&#39;)"><span class="hl_varref"><span class="mpre">interleave</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.2</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre">) </span><a href="#loc_227_3_227_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_5&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">

  where
    </span><a href="#loc_232_5_232_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_15&#39;)"><span class="mpre">interleave</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)]
    </span><a name="loc_232_5_232_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_15&#39;)"><span class="hl_fundecl"><span class="mpre">interleave</span></span></a><span class="mpre"> (</span><a name="loc_232_17_232_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_17_232_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_232_19_232_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_19_232_20&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_232_21_232_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_21_232_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = (</span><a href="#loc_232_17_232_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_17_232_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_232_19_232_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_19_232_20&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_232_5_232_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_15&#39;)"><span class="hl_varref"><span class="mpre">interleave</span></span></a><span class="mpre"> </span><a href="#loc_232_21_232_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_21_232_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_232_5_232_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_15&#39;)"><span class="hl_fundecl"><span class="mpre">interleave</span></span></a><span class="mpre"> _        = []
</span></div></body></html>