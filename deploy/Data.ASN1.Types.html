<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ASN1.Types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.ASN1.Types
    ( ASN1(..)
    , ASN1S
    , ASN1Class(..)
    , ASN1Tag
    , ASN1ConstructionType(..)
    , ASN1StringEncoding(..)
    , ASN1TimeType(..)
    , ASN1Object(..)
    , ASN1CharacterString(..)
    , asn1CharacterString
    , asn1CharacterToString
    , module Data.ASN1.OID
    ) where

import Data.Time.Clock (</span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="mpre">UTCTime</span></a><span class="mpre">)
import Data.Time.LocalTime (</span><a href="Data.Time.LocalTime.TimeZone.html#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.LocalTime.TimeZone.html#loc_29_6_29_14&#39;)"><span class="mpre">TimeZone</span></a><span class="mpre">)
import Data.ASN1.BitArray
import Data.ASN1.OID
import Data.ASN1.Types.Lowlevel
import Data.ASN1.Types.String
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 8, srcSpanEndLine = 29, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)

</span><span class="hl_comment"><span class="mpre">-- | Define the type of container</span></span><span class="mpre">
data </span><a name="loc_32_6_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_26&#39;)"><span class="hl_tycondecl"><span class="mpre">ASN1ConstructionType</span></span></a><span class="mpre"> = </span><a name="loc_32_29_32_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_29_32_37&#39;)"><span class="hl_condecl"><span class="mpre">Sequence</span></span></a><span class="mpre">
                          | </span><a name="loc_33_29_33_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_29_33_32&#39;)"><span class="hl_condecl"><span class="mpre">Set</span></span></a><span class="mpre">
                          | </span><a name="loc_34_29_34_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_29_34_38&#39;)"><span class="hl_condecl"><span class="mpre">Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.Lowlevel.html#loc_23_6_23_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_23_6_23_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Class</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ASN1Tag</span></span><span class="mpre">
                          </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 27, srcSpanEndLine = 35, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 27, srcSpanEndLine = 35, srcSpanEndColumn = 35},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLin"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Different ASN1 time representation</span></span><span class="mpre">
data </span><a name="loc_38_6_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_18&#39;)"><span class="hl_tycondecl"><span class="mpre">ASN1TimeType</span></span></a><span class="mpre"> = </span><a name="loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_condecl"><span class="mpre">TimeUTC</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ ASN1 UTCTime Type: limited between 1950-2050</span></span><span class="mpre">
                  | </span><a name="loc_39_21_39_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_21_39_36&#39;)"><span class="hl_condecl"><span class="mpre">TimeGeneralized</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ ASN1 GeneralizedTime Type</span></span><span class="mpre">
                  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 19, srcSpanEndLine = 40, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 19, srcSpanEndLine = 40, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLin"><span class="mpre">deriving (Show,Eq,Ord)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Define high level ASN1 object.</span></span><span class="mpre">
data </span><a name="loc_43_6_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_6_43_10&#39;)"><span class="hl_tycondecl"><span class="mpre">ASN1</span></span></a><span class="mpre"> =
      </span><a name="loc_44_7_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_14&#39;)"><span class="hl_condecl"><span class="mpre">Boolean</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    | </span><a name="loc_45_7_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_13&#39;)"><span class="hl_condecl"><span class="mpre">IntVal</span></span></a><span class="mpre">  </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    | </span><a name="loc_46_7_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_16&#39;)"><span class="hl_condecl"><span class="mpre">BitString</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BitArray.html#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BitArray.html#loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre">
    | </span><a name="loc_47_7_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_7_47_18&#39;)"><span class="hl_condecl"><span class="mpre">OctetString</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    | </span><a name="loc_48_7_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_11&#39;)"><span class="hl_condecl"><span class="mpre">Null</span></span></a><span class="mpre">
    | </span><a name="loc_49_7_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_10&#39;)"><span class="hl_condecl"><span class="mpre">OID</span></span></a><span class="mpre">  </span><span class="hl_tyconref"><span class="mpre">OID</span></span><span class="mpre">
    | </span><a name="loc_50_7_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_11&#39;)"><span class="hl_condecl"><span class="mpre">Real</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
    | </span><a name="loc_51_7_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_7_51_17&#39;)"><span class="hl_condecl"><span class="mpre">Enumerated</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    | </span><a name="loc_52_7_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_17&#39;)"><span class="hl_condecl"><span class="mpre">ASN1String</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.String.html#loc_73_6_73_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.String.html#loc_73_6_73_25&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre">
    | </span><a name="loc_53_7_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_7_53_15&#39;)"><span class="hl_condecl"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> </span><a href="#loc_38_6_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_18&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1TimeType</span></span></a><span class="mpre"> </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.LocalTime.TimeZone.html#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.LocalTime.TimeZone.html#loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre">)
    | </span><a name="loc_54_7_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_7_54_12&#39;)"><span class="hl_condecl"><span class="mpre">Other</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.Lowlevel.html#loc_23_6_23_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_23_6_23_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Class</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ASN1Tag</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    | </span><a name="loc_55_7_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_12&#39;)"><span class="hl_condecl"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="#loc_32_6_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_26&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1ConstructionType</span></span></a><span class="mpre">
    | </span><a name="loc_56_7_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_10&#39;)"><span class="hl_condecl"><span class="mpre">End</span></span></a><span class="mpre">   </span><a href="#loc_32_6_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_26&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1ConstructionType</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 5, srcSpanEndLine = 57, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 5, srcSpanEndLine = 57, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine "><span class="mpre">deriving (Show, Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | represent a chunk of ASN1 Stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this is equivalent to ShowS but for an ASN1 Stream.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 1, srcSpanEndLine = 61, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 1, srcSpanEndLine = 61, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/Types.hs&quot;, srcSpanStartLine ="><span class="mpre">type ASN1S = [ASN1] -&gt; [ASN1]</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Define an object that can be converted to and from ASN.1</span></span><span class="mpre">
class </span><a name="loc_64_7_64_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_17&#39;)"><span class="hl_classdecl"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
    </span><span class="hl_comment"><span class="mpre">-- | transform an object into a chunk of ASN1 stream.</span></span><span class="mpre">
    </span><a name="loc_66_5_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_11&#39;)"><span class="mpre">toASN1</span></a><span class="mpre">   :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">      -&gt; </span><span class="hl_tyconref"><span class="mpre">ASN1S</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | returns either an object along the remaining ASN1 stream,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- or an error.</span></span><span class="mpre">
    </span><a name="loc_70_5_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_13&#39;)"><span class="mpre">fromASN1</span></a><span class="mpre"> :: [</span><a href="#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, [</span><a href="#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">])
</span></div></body></html>