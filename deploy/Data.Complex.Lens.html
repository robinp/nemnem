<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE FlexibleContexts #-}
#ifndef MIN_VERSION_base
#define MIN_VERSION_base(x,y,z) 1
#endif
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.Complex.Lens</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (C) 2012-14 Edward Kmett</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Lenses and traversals for complex numbers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------------</span></span><span class="mpre">
module Data.Complex.Lens
  ( _realPart
  , _imagPart
  , _polar
  , _magnitude
  , _phase
  , _conjugate
  ) where

import Control.Applicative
import Control.Lens
import Data.Complex

</span><span class="hl_comment"><span class="mpre">-- $setup</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; import Debug.SimpleReflect</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; let { a ≈ b = abs (a - b) &lt; 1e-6; infix 4 ≈ }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Access the &#39;realPart&#39; of a &#39;Complex&#39; number.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; (a :+ b)^._realPart</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; a :+ b &amp; _realPart *~ 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a * 2 :+ b</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @&#39;_realPart&#39; :: &#39;Functor&#39; f =&gt; (a -&gt; f a) -&gt; &#39;Complex&#39; a -&gt; f (&#39;Complex&#39; a)@</span></span><span class="mpre">
#if MIN_VERSION_base(4,4,0)
</span><a href="#loc_49_1_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_10&#39;)"><span class="mpre">_realPart</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><a href="Data.Complex.html#loc_52_6_52_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_52_6_52_13&#39;)"><span class="hl_tyconref"><span class="mpre">Complex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
#else
</span><a href="#loc_49_1_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_10&#39;)"><span class="mpre">_realPart</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 14, srcSpanEndLine = 47, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 26, srcSpanEndLine = 47, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/"><span class="mpre">RealFloat a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><a href="Data.Complex.html#loc_52_6_52_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_52_6_52_13&#39;)"><span class="hl_tyconref"><span class="mpre">Complex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
#endif
</span><a name="loc_49_1_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_10&#39;)"><span class="hl_fundecl"><span class="mpre">_realPart</span></span></a><span class="mpre"> </span><a name="loc_49_11_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_11_49_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_49_14_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_14_49_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="Data.Complex.html#loc_53_8_53_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_53_8_53_10&#39;)"><span class="hl_infix"><span class="mpre">:+</span></span></a><span class="mpre"> </span><a name="loc_49_19_49_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_19_49_20&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = (</span><a href="Data.Complex.html#loc_53_8_53_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_53_8_53_10&#39;)"><span class="hl_infix"><span class="mpre">:+</span></span></a><span class="mpre"> </span><a href="#loc_49_19_49_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_19_49_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_49_11_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_11_49_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_49_14_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_14_49_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_49_1_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_10&#39;)"><span class="mpre">_realPart</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Access the &#39;imagPart&#39; of a &#39;Complex&#39; number.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; (a :+ b)^._imagPart</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- b</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; a :+ b &amp; _imagPart *~ 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a :+ b * 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @&#39;_imagPart&#39; :: &#39;Functor&#39; f =&gt; (a -&gt; f a) -&gt; &#39;Complex&#39; a -&gt; f (&#39;Complex&#39; a)@</span></span><span class="mpre">
#if MIN_VERSION_base(4,4,0)
</span><a href="#loc_66_1_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_10&#39;)"><span class="mpre">_imagPart</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><a href="Data.Complex.html#loc_52_6_52_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_52_6_52_13&#39;)"><span class="hl_tyconref"><span class="mpre">Complex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
#else
</span><a href="#loc_66_1_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_10&#39;)"><span class="mpre">_imagPart</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 14, srcSpanEndLine = 64, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 26, srcSpanEndLine = 64, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/"><span class="mpre">RealFloat a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><a href="Data.Complex.html#loc_52_6_52_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_52_6_52_13&#39;)"><span class="hl_tyconref"><span class="mpre">Complex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
#endif
</span><a name="loc_66_1_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_10&#39;)"><span class="hl_fundecl"><span class="mpre">_imagPart</span></span></a><span class="mpre"> </span><a name="loc_66_11_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_11_66_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_66_14_66_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_14_66_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="Data.Complex.html#loc_53_8_53_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_53_8_53_10&#39;)"><span class="hl_infix"><span class="mpre">:+</span></span></a><span class="mpre"> </span><a name="loc_66_19_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_19_66_20&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = (</span><a href="#loc_66_14_66_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_14_66_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="Data.Complex.html#loc_53_8_53_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_53_8_53_10&#39;)"><span class="hl_infix"><span class="mpre">:+</span></span></a><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_66_11_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_11_66_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_66_19_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_19_66_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_66_1_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_10&#39;)"><span class="mpre">_imagPart</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This isn&#39;t /quite/ a legal &#39;Lens&#39;. Notably the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @&#39;view&#39; l (&#39;set&#39; l b a) = b@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- law is violated when you set a &#39;polar&#39; value with 0 &#39;magnitude&#39; and non-zero</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;phase&#39; as the &#39;phase&#39; information is lost, or with a negative &#39;magnitude&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which flips the &#39;phase&#39; and retains a positive &#39;magnitude&#39;. So don&#39;t do</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Otherwise, this is a perfectly cromulent &#39;Lens&#39;.</span></span><span class="mpre">
</span><a href="#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="mpre">_polar</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 11, srcSpanEndLine = 79, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 23, srcSpanEndLine = 79, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/"><span class="mpre">RealFloat a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Iso&#39;</span></span><span class="mpre"> (</span><a href="Data.Complex.html#loc_52_6_52_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_52_6_52_13&#39;)"><span class="hl_tyconref"><span class="mpre">Complex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="hl_vardecl"><span class="mpre">_polar</span></span></a><span class="mpre"> = </span><a href="Control.Lens.Iso.html#loc_122_1_122_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Iso.html#loc_122_1_122_4&#39;)"><span class="hl_varref"><span class="mpre">iso</span></span></a><span class="mpre"> </span><a href="Data.Complex.html#loc_90_1_90_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_90_1_90_6&#39;)"><span class="hl_varref"><span class="mpre">polar</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> </span><a href="Data.Complex.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_76_1_76_8&#39;)"><span class="hl_varref"><span class="mpre">mkPolar</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="mpre">_polar</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Access the &#39;magnitude&#39; of a &#39;Complex&#39; number.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; (10.0 :+ 20.0) &amp; _magnitude *~ 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 20.0 :+ 40.0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This isn&#39;t /quite/ a legal &#39;Lens&#39;. Notably the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @&#39;view&#39; l (&#39;set&#39; l b a) = b@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- law is violated when you set a negative &#39;magnitude&#39;. This flips the &#39;phase&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and retains a positive &#39;magnitude&#39;. So don&#39;t do that!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Otherwise, this is a perfectly cromulent &#39;Lens&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Setting the &#39;magnitude&#39; of a zero &#39;Complex&#39; number assumes the &#39;phase&#39; is 0.</span></span><span class="mpre">
</span><a href="#loc_99_1_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_11&#39;)"><span class="mpre">_magnitude</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 15, srcSpanEndLine = 98, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 27, srcSpanEndLine = 98, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/"><span class="mpre">RealFloat a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><a href="Data.Complex.html#loc_52_6_52_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_52_6_52_13&#39;)"><span class="hl_tyconref"><span class="mpre">Complex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_99_1_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_11&#39;)"><span class="hl_fundecl"><span class="mpre">_magnitude</span></span></a><span class="mpre"> </span><a name="loc_99_12_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_12_99_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_99_14_99_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_14_99_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_100_9_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_15&#39;)"><span class="hl_varref"><span class="mpre">setMag</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_99_12_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_12_99_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_102_9_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
  where </span><a name="loc_100_9_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_15&#39;)"><span class="hl_fundecl"><span class="mpre">setMag</span></span></a><span class="mpre"> </span><a name="loc_100_16_100_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_16_100_18&#39;)"><span class="hl_vardecl"><span class="mpre">r&#39;</span></span></a><span class="mpre"> | </span><a href="#loc_102_9_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    = </span><a href="#loc_99_14_99_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_14_99_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_100_16_100_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_16_100_18&#39;)"><span class="hl_varref"><span class="mpre">r&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_102_9_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="Data.Complex.html#loc_53_8_53_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_53_8_53_10&#39;)"><span class="hl_infix"><span class="mpre">:+</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_100_16_100_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_16_100_18&#39;)"><span class="hl_varref"><span class="mpre">r&#39;</span></span></a><span class="mpre"> </span><a href="Data.Complex.html#loc_53_8_53_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_53_8_53_10&#39;)"><span class="hl_infix"><span class="mpre">:+</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        </span><a name="loc_102_9_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="Data.Complex.html#loc_95_1_95_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_95_1_95_10&#39;)"><span class="hl_varref"><span class="mpre">magnitude</span></span></a><span class="mpre"> </span><a href="#loc_99_14_99_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_14_99_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_99_1_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_11&#39;)"><span class="mpre">_magnitude</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Access the &#39;phase&#39; of a &#39;Complex&#39; number.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; (mkPolar 10 (2-pi) &amp; _phase +~ pi &amp; view _phase) ≈ 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This isn&#39;t /quite/ a legal &#39;Lens&#39;. Notably the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @&#39;view&#39; l (&#39;set&#39; l b a) = b@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- law is violated when you set a &#39;phase&#39; outside the range @(-&#39;pi&#39;, &#39;pi&#39;]@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The phase is always in that range when queried. So don&#39;t do that!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Otherwise, this is a perfectly cromulent &#39;Lens&#39;.</span></span><span class="mpre">
</span><a href="#loc_119_1_119_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_7&#39;)"><span class="mpre">_phase</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 11, srcSpanEndLine = 118, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 23, srcSpanEndLine = 118, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/D"><span class="mpre">RealFloat a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> (</span><a href="Data.Complex.html#loc_52_6_52_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_52_6_52_13&#39;)"><span class="hl_tyconref"><span class="mpre">Complex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_119_1_119_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_7&#39;)"><span class="hl_fundecl"><span class="mpre">_phase</span></span></a><span class="mpre"> </span><a name="loc_119_8_119_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_8_119_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_119_10_119_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_10_119_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_120_9_120_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_17&#39;)"><span class="hl_varref"><span class="mpre">setPhase</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_119_8_119_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_8_119_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_121_9_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_14&#39;)"><span class="hl_varref"><span class="mpre">theta</span></span></a><span class="mpre">
  where </span><a name="loc_120_9_120_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_17&#39;)"><span class="hl_fundecl"><span class="mpre">setPhase</span></span></a><span class="mpre"> </span><a name="loc_120_18_120_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_18_120_24&#39;)"><span class="hl_vardecl"><span class="mpre">theta&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_119_10_119_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_10_119_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="Data.Complex.html#loc_82_1_82_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_82_1_82_4&#39;)"><span class="hl_varref"><span class="mpre">cis</span></span></a><span class="mpre"> (</span><a href="#loc_120_18_120_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_18_120_24&#39;)"><span class="hl_varref"><span class="mpre">theta&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_121_9_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_14&#39;)"><span class="hl_varref"><span class="mpre">theta</span></span></a><span class="mpre">)
        </span><a name="loc_121_9_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_14&#39;)"><span class="hl_vardecl"><span class="mpre">theta</span></span></a><span class="mpre"> = </span><a href="Data.Complex.html#loc_105_1_105_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_105_1_105_6&#39;)"><span class="hl_varref"><span class="mpre">phase</span></span></a><span class="mpre"> </span><a href="#loc_119_10_119_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_10_119_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_119_1_119_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_7&#39;)"><span class="mpre">_phase</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Access the &#39;conjugate&#39; of a &#39;Complex&#39; number.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; (2.0 :+ 3.0) &amp; _conjugate . _imagPart -~ 1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 2.0 :+ 4.0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; (mkPolar 10.0 2.0 ^. _conjugate . _phase) ≈ (-2.0)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- True</span></span><span class="mpre">
</span><a href="#loc_132_1_132_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_11&#39;)"><span class="mpre">_conjugate</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 131, srcSpanStartColumn = 15, srcSpanEndLine = 131, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Data/Complex/Lens.hs&quot;, srcSpanStartLine = 131, srcSpanStartColumn = 27, srcSpanEndLine = 131, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/D"><span class="mpre">RealFloat a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Iso&#39;</span></span><span class="mpre"> (</span><a href="Data.Complex.html#loc_52_6_52_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_52_6_52_13&#39;)"><span class="hl_tyconref"><span class="mpre">Complex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) (</span><a href="Data.Complex.html#loc_52_6_52_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_52_6_52_13&#39;)"><span class="hl_tyconref"><span class="mpre">Complex</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_132_1_132_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_11&#39;)"><span class="hl_vardecl"><span class="mpre">_conjugate</span></span></a><span class="mpre"> = </span><a href="Control.Lens.Iso.html#loc_423_1_423_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Iso.html#loc_423_1_423_10&#39;)"><span class="hl_varref"><span class="mpre">involuted</span></span></a><span class="mpre"> </span><a href="Data.Complex.html#loc_71_1_71_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Complex.html#loc_71_1_71_10&#39;)"><span class="hl_varref"><span class="mpre">conjugate</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_132_1_132_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_11&#39;)"><span class="mpre">_conjugate</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>