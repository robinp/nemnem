<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RankNTypes, ScopedTypeVariables, CPP #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.Generics.Twins</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow, CWI 2001--2004</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the LICENSE file)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  generics@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (local universal quantification)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;Scrap your boilerplate\&quot; --- Generic programming in Haskell </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See &lt;http://www.cs.uu.nl/wiki/GenericProgramming/SYB&gt;. The present module </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provides support for multi-parameter traversal, which is also </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- demonstrated with generic operations like equality.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Data.Generics.Twins (

        </span><span class="hl_comment"><span class="mpre">-- * Generic folds and maps that also accumulate</span></span><span class="mpre">
        gfoldlAccum,
        gmapAccumT,
        gmapAccumM,
        gmapAccumQl,
        gmapAccumQr,
        gmapAccumQ,
        gmapAccumA,

        </span><span class="hl_comment"><span class="mpre">-- * Mapping combinators for twin traversal</span></span><span class="mpre">
        gzipWithT,
        gzipWithM,
        gzipWithQ,

        </span><span class="hl_comment"><span class="mpre">-- * Typical twin traversals</span></span><span class="mpre">
        geq,
        gzip

  ) where


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

#ifdef __HADDOCK__
import Prelude
#endif
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 8, srcSpanEndLine = 47, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
import Data.Generics.Aliases

#ifdef __GLASGOW_HASKELL__
import Prelude hiding ( GT )
#endif

import Control.Applicative (</span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="mpre">Applicative</span></a><span class="mpre">(..))

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Generic folds and maps that also accumulate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{--------------------------------------------------------------

A list map can be elaborated to perform accumulation.
In the same sense, we can elaborate generic maps over terms.

We recall the type of map:
map :: (a -&gt; b) -&gt; [a] -&gt; [b]

We recall the type of an accumulating map (see Data.List):
mapAccumL :: (a -&gt; b -&gt; (a,c)) -&gt; a -&gt; [b] -&gt; (a,[c])

Applying the same scheme we obtain an accumulating gfoldl.

--------------------------------------------------------------}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | gfoldl with accumulation</span></span><span class="mpre">

</span><a href="#loc_87_1_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_12&#39;)"><span class="mpre">gfoldlAccum</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 16, srcSpanEndLine = 83, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 13, srcSpanEndLine = 83, srcSpanEndColumn = 15}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/sr"><span class="mpre">Data d
            =&gt;</span></span><span class="mpre"> (forall </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 29, srcSpanEndLine = 83, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 36, srcSpanEndLine = 83, srcSpanEndColumn = 38}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/sr"><span class="mpre">Data e =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">))
            -&gt; (forall </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">. </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">))
            -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">)

</span><a name="loc_87_1_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_12&#39;)"><span class="hl_fundecl"><span class="mpre">gfoldlAccum</span></span></a><span class="mpre"> </span><a name="loc_87_13_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_87_15_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_87_17_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_19&#39;)"><span class="hl_vardecl"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a name="loc_87_20_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_20_87_21&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="#loc_94_23_94_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_23_94_26&#39;)"><span class="hl_varref"><span class="mpre">unA</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gfoldl</span></span><span class="mpre"> </span><a href="#loc_89_3_89_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_3_89_5&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a href="#loc_90_3_90_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_5&#39;)"><span class="hl_varref"><span class="mpre">z&#39;</span></span></a><span class="mpre"> </span><a href="#loc_87_20_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_20_87_21&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">) </span><a href="#loc_87_17_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_19&#39;)"><span class="hl_varref"><span class="mpre">a0</span></span></a><span class="mpre">
 where
  </span><a name="loc_89_3_89_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_3_89_5&#39;)"><span class="hl_fundecl"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a name="loc_89_6_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_89_8_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_8_89_9&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_94_19_94_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_19_94_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> (\</span><a name="loc_89_16_89_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_16_89_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; let (</span><a name="loc_89_26_89_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_26_89_28&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre">, </span><a name="loc_89_30_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_30_89_32&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_94_23_94_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_23_94_26&#39;)"><span class="hl_varref"><span class="mpre">unA</span></span></a><span class="mpre"> </span><a href="#loc_89_6_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_89_16_89_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_16_89_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> in </span><a href="#loc_87_13_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_89_26_89_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_26_89_28&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre"> </span><a href="#loc_89_30_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_30_89_32&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre"> </span><a href="#loc_89_8_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_8_89_9&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
  </span><a name="loc_90_3_90_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_5&#39;)"><span class="hl_fundecl"><span class="mpre">z&#39;</span></span></a><span class="mpre"> </span><a name="loc_90_6_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">   = </span><a href="#loc_94_19_94_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_19_94_20&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> (\</span><a name="loc_90_16_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_87_15_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_90_16_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_90_6_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | A type constructor for accumulation</span></span><span class="mpre">
newtype </span><span class="hl_tycondecl"><span class="mpre">A</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> = </span><a name="loc_94_19_94_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_19_94_20&#39;)"><span class="hl_condecl"><span class="mpre">A</span></span></a><span class="mpre"> { </span><a name="loc_94_23_94_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_23_94_26&#39;)"><span class="hl_fielddecl"><span class="mpre">unA</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">) }


</span><span class="hl_comment"><span class="mpre">-- | gmapT with accumulation</span></span><span class="mpre">
</span><a href="#loc_101_1_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_11&#39;)"><span class="mpre">gmapAccumT</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 15, srcSpanEndLine = 99, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 12, srcSpanEndLine = 99, srcSpanEndColumn = 14}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/sr"><span class="mpre">Data d
           =&gt;</span></span><span class="mpre"> (forall </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 26, srcSpanEndLine = 99, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 33, srcSpanEndLine = 99, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/sr"><span class="mpre">Data e =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">))
           -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">)
</span><a name="loc_101_1_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_11&#39;)"><span class="hl_fundecl"><span class="mpre">gmapAccumT</span></span></a><span class="mpre"> </span><a name="loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_101_14_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_16&#39;)"><span class="hl_vardecl"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a name="loc_101_17_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_19&#39;)"><span class="hl_vardecl"><span class="mpre">d0</span></span></a><span class="mpre"> = let (</span><a name="loc_101_27_101_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_29&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre">, </span><a name="loc_101_31_101_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_31_101_33&#39;)"><span class="hl_vardecl"><span class="mpre">d1</span></span></a><span class="mpre">) = </span><a href="#loc_87_1_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_12&#39;)"><span class="hl_varref"><span class="mpre">gfoldlAccum</span></span></a><span class="mpre"> </span><a href="#loc_104_3_104_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_4&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_106_3_106_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_3_106_4&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_101_14_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_16&#39;)"><span class="hl_varref"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a href="#loc_101_17_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_19&#39;)"><span class="hl_varref"><span class="mpre">d0</span></span></a><span class="mpre">
                     in (</span><a href="#loc_101_27_101_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_27_101_29&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre">, </span><a href="#loc_180_21_180_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_21_180_25&#39;)"><span class="hl_varref"><span class="mpre">unID</span></span></a><span class="mpre"> </span><a href="#loc_101_31_101_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_31_101_33&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre">)
 where
  </span><a name="loc_104_3_104_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_4&#39;)"><span class="hl_fundecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_104_5_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_180_16_180_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_16_180_18&#39;)"><span class="hl_conref"><span class="mpre">ID</span></span></a><span class="mpre"> </span><a name="loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><a name="loc_104_14_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_14_104_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = let (</span><a name="loc_104_23_104_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_23_104_25&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre">,</span><a name="loc_104_26_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_26_104_28&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_104_5_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_104_14_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_14_104_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
                  in (</span><a href="#loc_104_23_104_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_23_104_25&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">, </span><a href="#loc_180_16_180_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_16_180_18&#39;)"><span class="hl_conref"><span class="mpre">ID</span></span></a><span class="mpre"> (</span><a href="#loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_104_26_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_26_104_28&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">))
  </span><a name="loc_106_3_106_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_3_106_4&#39;)"><span class="hl_fundecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_106_5_106_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_5_106_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_106_7_106_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_7_106_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_106_5_106_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_5_106_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_180_16_180_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_16_180_18&#39;)"><span class="hl_conref"><span class="mpre">ID</span></span></a><span class="mpre"> </span><a href="#loc_106_7_106_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_7_106_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Applicative version</span></span><span class="mpre">
</span><a href="#loc_113_1_113_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_11&#39;)"><span class="mpre">gmapAccumA</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 29, srcSpanEndLine = 111, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 29, srcSpanEndLine = 110, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanSt"><span class="mpre">(Data d, Applicative a)
           =&gt;</span></span><span class="mpre"> (forall </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 26, srcSpanEndLine = 111, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 33, srcSpanEndLine = 111, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data e =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">))
           -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">)
</span><a name="loc_113_1_113_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_11&#39;)"><span class="hl_fundecl"><span class="mpre">gmapAccumA</span></span></a><span class="mpre"> </span><a name="loc_113_12_113_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_12_113_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_113_14_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_14_113_16&#39;)"><span class="hl_vardecl"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a name="loc_113_17_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_19&#39;)"><span class="hl_vardecl"><span class="mpre">d0</span></span></a><span class="mpre"> = </span><a href="#loc_87_1_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_12&#39;)"><span class="hl_varref"><span class="mpre">gfoldlAccum</span></span></a><span class="mpre"> </span><a href="#loc_117_7_117_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_122_7_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_8&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_113_14_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_14_113_16&#39;)"><span class="hl_varref"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a href="#loc_113_17_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_19&#39;)"><span class="hl_varref"><span class="mpre">d0</span></span></a><span class="mpre">
    where
      </span><a href="#loc_117_7_117_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_8&#39;)"><span class="mpre">k</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">d&#39;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 25, srcSpanEndLine = 115, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 25, srcSpanEndLine = 115, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanSt"><span class="mpre">(Data d&#39;) =&gt;</span></span><span class="mpre">
           </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">d&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">d&#39;</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">)
      </span><a name="loc_117_7_117_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_8&#39;)"><span class="hl_fundecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_117_9_117_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_117_11_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_11_117_12&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_117_13_117_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_14&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = let (</span><a name="loc_117_22_117_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_22_117_24&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre">,</span><a name="loc_117_25_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_25_117_27&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_113_12_113_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_12_113_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_117_9_117_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_117_13_117_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
                    </span><a name="loc_118_21_118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_21_118_23&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_117_11_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_11_117_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_117_25_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_25_117_27&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">
                in (</span><a href="#loc_117_22_117_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_22_117_24&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">, </span><a href="#loc_118_21_118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_21_118_23&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre">)
      </span><a href="#loc_122_7_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_8&#39;)"><span class="mpre">z</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 27, srcSpanEndLine = 120, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 27, srcSpanEndLine = 120, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanSt"><span class="mpre">(Applicative a&#39;) =&gt;</span></span><span class="mpre">
           </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
      </span><a name="loc_122_7_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_8&#39;)"><span class="hl_fundecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_122_9_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_122_11_122_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_11_122_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_122_9_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_varref"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a href="#loc_122_11_122_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_11_122_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | gmapM with accumulation</span></span><span class="mpre">
</span><a href="#loc_129_1_129_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_11&#39;)"><span class="mpre">gmapAccumM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 126, srcSpanStartColumn = 15, srcSpanEndLine = 127, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 126, srcSpanStartColumn = 15, srcSpanEndLine = 126, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanSt"><span class="mpre">(Data d, Monad m)
           =&gt;</span></span><span class="mpre"> (forall </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 127, srcSpanStartColumn = 26, srcSpanEndLine = 127, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 127, srcSpanStartColumn = 33, srcSpanEndLine = 127, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data e =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">))
           -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">)
</span><a name="loc_129_1_129_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_11&#39;)"><span class="hl_fundecl"><span class="mpre">gmapAccumM</span></span></a><span class="mpre"> </span><a name="loc_129_12_129_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_12_129_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_87_1_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_12&#39;)"><span class="hl_varref"><span class="mpre">gfoldlAccum</span></span></a><span class="mpre"> </span><a href="#loc_131_3_131_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_3_131_4&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_133_3_133_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_3_133_4&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
 where
  </span><a name="loc_131_3_131_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_3_131_4&#39;)"><span class="hl_fundecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_131_5_131_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_131_7_131_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_7_131_8&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_131_9_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = let (</span><a name="loc_131_18_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_18_131_20&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre">,</span><a name="loc_131_21_131_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_21_131_23&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_129_12_129_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_12_129_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_131_5_131_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_131_9_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
             in (</span><a href="#loc_131_18_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_18_131_20&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">, </span><a href="#loc_131_21_131_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_21_131_23&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_132_30_132_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_30_132_33&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_131_7_131_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_7_131_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_132_44_132_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_44_132_46&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_132_44_132_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_44_132_46&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre"> </span><a href="#loc_132_30_132_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_30_132_33&#39;)"><span class="hl_varref"><span class="mpre">d&#39;&#39;</span></span></a><span class="mpre">))
  </span><a name="loc_133_3_133_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_3_133_4&#39;)"><span class="hl_fundecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_133_5_133_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_5_133_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_133_7_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_7_133_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_133_5_133_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_5_133_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_133_7_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_7_133_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | gmapQl with accumulation</span></span><span class="mpre">
</span><a href="#loc_142_1_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_12&#39;)"><span class="mpre">gmapAccumQl</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 137, srcSpanStartColumn = 16, srcSpanEndLine = 138, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 138, srcSpanStartColumn = 13, srcSpanEndLine = 138, srcSpanEndColumn = 15}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data d
            =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
            -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
            -&gt; (forall </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 140, srcSpanStartColumn = 27, srcSpanEndLine = 140, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 140, srcSpanStartColumn = 34, srcSpanEndLine = 140, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data e =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre">))
            -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
</span><a name="loc_142_1_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_12&#39;)"><span class="hl_fundecl"><span class="mpre">gmapAccumQl</span></span></a><span class="mpre"> </span><a name="loc_142_13_142_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_13_142_14&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_142_15_142_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_15_142_17&#39;)"><span class="hl_vardecl"><span class="mpre">r0</span></span></a><span class="mpre"> </span><a name="loc_142_18_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_18_142_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_142_20_142_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_22&#39;)"><span class="hl_vardecl"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a name="loc_142_23_142_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_23_142_25&#39;)"><span class="hl_vardecl"><span class="mpre">d0</span></span></a><span class="mpre"> = let (</span><a name="loc_142_33_142_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_33_142_35&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre">, </span><a name="loc_142_37_142_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_37_142_39&#39;)"><span class="hl_vardecl"><span class="mpre">r1</span></span></a><span class="mpre">) = </span><a href="#loc_87_1_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_12&#39;)"><span class="hl_varref"><span class="mpre">gfoldlAccum</span></span></a><span class="mpre"> </span><a href="#loc_145_3_145_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_3_145_4&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_147_3_147_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_3_147_4&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_142_20_142_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_22&#39;)"><span class="hl_varref"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a href="#loc_142_23_142_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_23_142_25&#39;)"><span class="hl_varref"><span class="mpre">d0</span></span></a><span class="mpre">
                           in (</span><a href="#loc_142_33_142_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_33_142_35&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre">, </span><a href="#loc_184_29_184_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_29_184_36&#39;)"><span class="hl_varref"><span class="mpre">unCONST</span></span></a><span class="mpre"> </span><a href="#loc_142_37_142_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_37_142_39&#39;)"><span class="hl_varref"><span class="mpre">r1</span></span></a><span class="mpre">)
 where
  </span><a name="loc_145_3_145_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_3_145_4&#39;)"><span class="hl_fundecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_145_5_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_5_145_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_184_21_184_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_21_184_26&#39;)"><span class="hl_conref"><span class="mpre">CONST</span></span></a><span class="mpre"> </span><a name="loc_145_14_145_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_14_145_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><a name="loc_145_17_145_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_17_145_18&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = let (</span><a name="loc_145_26_145_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_26_145_28&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre">, </span><a name="loc_145_30_145_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_30_145_31&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_142_18_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_18_142_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_145_5_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_5_145_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_145_17_145_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_17_145_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
                     in (</span><a href="#loc_145_26_145_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_26_145_28&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">, </span><a href="#loc_184_21_184_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_21_184_26&#39;)"><span class="hl_conref"><span class="mpre">CONST</span></span></a><span class="mpre"> (</span><a href="#loc_145_14_145_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_14_145_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_142_13_142_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_13_142_14&#39;)"><span class="hl_infix"><span class="mpre">`o`</span></span></a><span class="mpre"> </span><a href="#loc_145_30_145_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_30_145_31&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">))
  </span><a name="loc_147_3_147_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_3_147_4&#39;)"><span class="hl_fundecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_147_5_147_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> _ = (</span><a href="#loc_147_5_147_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_184_21_184_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_21_184_26&#39;)"><span class="hl_conref"><span class="mpre">CONST</span></span></a><span class="mpre"> </span><a href="#loc_142_15_142_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_15_142_17&#39;)"><span class="hl_varref"><span class="mpre">r0</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | gmapQr with accumulation</span></span><span class="mpre">
</span><a href="#loc_156_1_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_12&#39;)"><span class="mpre">gmapAccumQr</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 16, srcSpanEndLine = 152, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 13, srcSpanEndLine = 152, srcSpanEndColumn = 15}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data d
            =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
            -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
            -&gt; (forall </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 27, srcSpanEndLine = 154, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 34, srcSpanEndLine = 154, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data e =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre">))
            -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
</span><a name="loc_156_1_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_12&#39;)"><span class="hl_fundecl"><span class="mpre">gmapAccumQr</span></span></a><span class="mpre"> </span><a name="loc_156_13_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_13_156_14&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_156_15_156_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_15_156_17&#39;)"><span class="hl_vardecl"><span class="mpre">r0</span></span></a><span class="mpre"> </span><a name="loc_156_18_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_18_156_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_156_20_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_20_156_22&#39;)"><span class="hl_vardecl"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a name="loc_156_23_156_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_23_156_25&#39;)"><span class="hl_vardecl"><span class="mpre">d0</span></span></a><span class="mpre"> = let (</span><a name="loc_156_33_156_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_33_156_35&#39;)"><span class="hl_vardecl"><span class="mpre">a1</span></span></a><span class="mpre">, </span><a name="loc_156_37_156_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_37_156_38&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><a href="#loc_87_1_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_12&#39;)"><span class="hl_varref"><span class="mpre">gfoldlAccum</span></span></a><span class="mpre"> </span><a href="#loc_159_3_159_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_3_159_4&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_161_3_161_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_3_161_4&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_156_20_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_20_156_22&#39;)"><span class="hl_varref"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a href="#loc_156_23_156_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_23_156_25&#39;)"><span class="hl_varref"><span class="mpre">d0</span></span></a><span class="mpre">
                           in (</span><a href="#loc_156_33_156_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_33_156_35&#39;)"><span class="hl_varref"><span class="mpre">a1</span></span></a><span class="mpre">, </span><a href="#loc_188_23_188_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_23_188_27&#39;)"><span class="hl_varref"><span class="mpre">unQr</span></span></a><span class="mpre"> </span><a href="#loc_156_37_156_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_37_156_38&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_156_15_156_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_15_156_17&#39;)"><span class="hl_varref"><span class="mpre">r0</span></span></a><span class="mpre">)
 where
  </span><a name="loc_159_3_159_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_3_159_4&#39;)"><span class="hl_fundecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_159_5_159_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_188_18_188_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_18_188_20&#39;)"><span class="hl_conref"><span class="mpre">Qr</span></span></a><span class="mpre"> </span><a name="loc_159_11_159_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_11_159_12&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) </span><a name="loc_159_14_159_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = let (</span><a name="loc_159_23_159_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_23_159_25&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre">,</span><a name="loc_159_26_159_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_26_159_28&#39;)"><span class="hl_vardecl"><span class="mpre">r&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_156_18_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_18_156_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_159_5_159_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_159_14_159_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
                  in (</span><a href="#loc_159_23_159_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_23_159_25&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">, </span><a href="#loc_188_18_188_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_18_188_20&#39;)"><span class="hl_conref"><span class="mpre">Qr</span></span></a><span class="mpre"> (\</span><a name="loc_160_32_160_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_32_160_33&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_159_11_159_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_11_159_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_159_26_159_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_26_159_28&#39;)"><span class="hl_varref"><span class="mpre">r&#39;</span></span></a><span class="mpre"> </span><a href="#loc_156_13_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_13_156_14&#39;)"><span class="hl_infix"><span class="mpre">`o`</span></span></a><span class="mpre"> </span><a href="#loc_160_32_160_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_32_160_33&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)))
  </span><a name="loc_161_3_161_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_3_161_4&#39;)"><span class="hl_fundecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_161_5_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> _ = (</span><a href="#loc_161_5_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_188_18_188_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_18_188_20&#39;)"><span class="hl_conref"><span class="mpre">Qr</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | gmapQ with accumulation</span></span><span class="mpre">
</span><a href="#loc_168_1_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_11&#39;)"><span class="mpre">gmapAccumQ</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 165, srcSpanStartColumn = 15, srcSpanEndLine = 166, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 12, srcSpanEndLine = 166, srcSpanEndColumn = 14}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data d
           =&gt;</span></span><span class="mpre"> (forall </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 26, srcSpanEndLine = 166, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 33, srcSpanEndLine = 166, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Data e =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">q</span></span><span class="mpre">))
           -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">q</span></span><span class="mpre">])
</span><a name="loc_168_1_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_11&#39;)"><span class="hl_fundecl"><span class="mpre">gmapAccumQ</span></span></a><span class="mpre"> </span><a name="loc_168_12_168_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_12_168_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_156_1_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_12&#39;)"><span class="hl_varref"><span class="mpre">gmapAccumQr</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> [] </span><a href="#loc_168_12_168_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_12_168_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Helper type constructors</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The identity type constructor needed for the definition of gmapAccumT</span></span><span class="mpre">
newtype </span><span class="hl_tycondecl"><span class="mpre">ID</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> = </span><a name="loc_180_16_180_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_16_180_18&#39;)"><span class="hl_condecl"><span class="mpre">ID</span></span></a><span class="mpre"> { </span><a name="loc_180_21_180_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_21_180_25&#39;)"><span class="hl_fielddecl"><span class="mpre">unID</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> }


</span><span class="hl_comment"><span class="mpre">-- | The constant type constructor needed for the definition of gmapAccumQl</span></span><span class="mpre">
newtype </span><span class="hl_tycondecl"><span class="mpre">CONST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_184_21_184_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_21_184_26&#39;)"><span class="hl_condecl"><span class="mpre">CONST</span></span></a><span class="mpre"> { </span><a name="loc_184_29_184_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_29_184_36&#39;)"><span class="hl_fielddecl"><span class="mpre">unCONST</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> }


</span><span class="hl_comment"><span class="mpre">-- | The type constructor needed for the definition of gmapAccumQr</span></span><span class="mpre">
newtype </span><span class="hl_tycondecl"><span class="mpre">Qr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_188_18_188_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_18_188_20&#39;)"><span class="hl_condecl"><span class="mpre">Qr</span></span></a><span class="mpre"> { </span><a name="loc_188_23_188_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_23_188_27&#39;)"><span class="hl_fielddecl"><span class="mpre">unQr</span></span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> }



</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Mapping combinators for twin traversal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Twin map for transformation </span></span><span class="mpre">
</span><a href="#loc_201_1_201_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_10&#39;)"><span class="mpre">gzipWithT</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericT</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericT</span></span><span class="mpre">)
</span><a name="loc_201_1_201_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_10&#39;)"><span class="hl_fundecl"><span class="mpre">gzipWithT</span></span></a><span class="mpre"> </span><a name="loc_201_11_201_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_11_201_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_201_13_201_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_13_201_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_201_15_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_15_201_16&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = case </span><a href="#loc_101_1_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_11&#39;)"><span class="hl_varref"><span class="mpre">gmapAccumT</span></span></a><span class="mpre"> </span><a href="#loc_205_3_205_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_3_205_9&#39;)"><span class="hl_varref"><span class="mpre">perkid</span></span></a><span class="mpre"> </span><a href="#loc_206_3_206_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_3_206_7&#39;)"><span class="hl_varref"><span class="mpre">funs</span></span></a><span class="mpre"> </span><a href="#loc_201_15_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_15_201_16&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> of
                    ([], </span><a name="loc_202_26_202_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_26_202_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_202_26_202_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_26_202_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                    _       -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzipWithT&quot;</span></span><span class="mpre">
 where
  </span><a name="loc_205_3_205_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_3_205_9&#39;)"><span class="hl_fundecl"><span class="mpre">perkid</span></span></a><span class="mpre"> </span><a name="loc_205_10_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_205_12_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_12_205_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_205_10_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="Data.Generics.Aliases.html#loc_267_28_267_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_267_28_267_32&#39;)"><span class="hl_varref"><span class="mpre">unGT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_205_10_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_205_12_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_12_205_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
  </span><a name="loc_206_3_206_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_3_206_7&#39;)"><span class="hl_vardecl"><span class="mpre">funs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (\</span><a name="loc_206_18_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_19&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> (</span><a href="#loc_201_11_201_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_11_201_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_206_18_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)) </span><a href="#loc_201_13_201_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_13_201_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- | Twin map for monadic transformation </span></span><span class="mpre">
</span><a href="#loc_212_1_212_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_10&#39;)"><span class="mpre">gzipWithM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 211, srcSpanStartColumn = 14, srcSpanEndLine = 211, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 211, srcSpanStartColumn = 22, srcSpanEndLine = 211, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4."><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericM</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericM</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">)
</span><a name="loc_212_1_212_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_10&#39;)"><span class="hl_fundecl"><span class="mpre">gzipWithM</span></span></a><span class="mpre"> </span><a name="loc_212_11_212_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_11_212_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_212_13_212_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_13_212_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_212_15_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_15_212_16&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = case </span><a href="#loc_129_1_129_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_11&#39;)"><span class="hl_varref"><span class="mpre">gmapAccumM</span></span></a><span class="mpre"> </span><a href="#loc_216_3_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_3_216_9&#39;)"><span class="hl_varref"><span class="mpre">perkid</span></span></a><span class="mpre"> </span><a href="#loc_217_3_217_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_3_217_7&#39;)"><span class="hl_varref"><span class="mpre">funs</span></span></a><span class="mpre"> </span><a href="#loc_212_15_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_15_212_16&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> of
                    ([], </span><a name="loc_213_26_213_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_26_213_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_213_26_213_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_26_213_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                    _       -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzipWithM&quot;</span></span><span class="mpre">
 where
  </span><a name="loc_216_3_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_3_216_9&#39;)"><span class="hl_fundecl"><span class="mpre">perkid</span></span></a><span class="mpre"> </span><a name="loc_216_10_216_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_216_12_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_12_216_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_216_10_216_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="Data.Generics.Aliases.html#loc_269_28_269_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_269_28_269_32&#39;)"><span class="hl_varref"><span class="mpre">unGM</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_216_10_216_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_216_12_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_12_216_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
  </span><a name="loc_217_3_217_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_3_217_7&#39;)"><span class="hl_vardecl"><span class="mpre">funs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (\</span><a name="loc_217_18_217_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_18_217_19&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">GM</span></span><span class="mpre"> (</span><a href="#loc_212_11_212_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_11_212_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_217_18_217_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_18_217_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)) </span><a href="#loc_212_13_212_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_13_212_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Twin map for queries</span></span><span class="mpre">
</span><a href="#loc_222_1_222_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_10&#39;)"><span class="mpre">gzipWithQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">])
</span><a name="loc_222_1_222_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_10&#39;)"><span class="hl_fundecl"><span class="mpre">gzipWithQ</span></span></a><span class="mpre"> </span><a name="loc_222_11_222_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_11_222_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_222_13_222_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_13_222_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_222_15_222_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_15_222_16&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = case </span><a href="#loc_168_1_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_11&#39;)"><span class="hl_varref"><span class="mpre">gmapAccumQ</span></span></a><span class="mpre"> </span><a href="#loc_226_3_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_9&#39;)"><span class="hl_varref"><span class="mpre">perkid</span></span></a><span class="mpre"> </span><a href="#loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_varref"><span class="mpre">funs</span></span></a><span class="mpre"> </span><a href="#loc_222_15_222_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_15_222_16&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> of
                   ([], </span><a name="loc_223_25_223_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_25_223_26&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_223_25_223_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_25_223_26&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                   _       -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzipWithQ&quot;</span></span><span class="mpre">
 where
  </span><a name="loc_226_3_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_9&#39;)"><span class="hl_fundecl"><span class="mpre">perkid</span></span></a><span class="mpre"> </span><a name="loc_226_10_226_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_226_12_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_12_226_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_226_10_226_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="Data.Generics.Aliases.html#loc_268_28_268_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_268_28_268_32&#39;)"><span class="hl_varref"><span class="mpre">unGQ</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_226_10_226_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_226_12_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_12_226_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
  </span><a name="loc_227_3_227_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_7&#39;)"><span class="hl_vardecl"><span class="mpre">funs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (\</span><a name="loc_227_18_227_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_18_227_19&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">GQ</span></span><span class="mpre"> (</span><a href="#loc_222_11_222_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_11_222_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_227_18_227_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_18_227_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)) </span><a href="#loc_222_13_222_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_13_222_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Typical twin traversals</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Generic equality: an alternative to \&quot;deriving Eq\&quot;</span></span><span class="mpre">
</span><a href="#loc_255_1_255_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_4&#39;)"><span class="mpre">geq</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 238, srcSpanStartColumn = 8, srcSpanEndLine = 238, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Twins.hs&quot;, srcSpanStartLine = 238, srcSpanStartColumn = 15, srcSpanEndLine = 238, srcSpanEndColumn = 17}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-

Testing for equality of two terms goes like this. Firstly, we
establish the equality of the two top-level datatype
constructors. Secondly, we use a twin gmap combinator, namely tgmapQ,
to compare the two lists of immediate subterms.

(Note for the experts: the type of the worker geq&#39; is rather general
but precision is recovered via the restrictive type of the top-level
operation geq. The imprecision of geq&#39; is caused by the type system&#39;s
unability to express the type equivalence for the corresponding
couples of immediate subterms from the two given input terms.)

-}</span></span><span class="mpre">

</span><a name="loc_255_1_255_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_4&#39;)"><span class="hl_fundecl"><span class="mpre">geq</span></span></a><span class="mpre"> </span><a name="loc_255_5_255_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_5_255_7&#39;)"><span class="hl_vardecl"><span class="mpre">x0</span></span></a><span class="mpre"> </span><a name="loc_255_8_255_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_8_255_10&#39;)"><span class="hl_vardecl"><span class="mpre">y0</span></span></a><span class="mpre"> = </span><a href="#loc_258_5_258_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_5_258_9&#39;)"><span class="hl_varref"><span class="mpre">geq&#39;</span></span></a><span class="mpre"> </span><a href="#loc_255_5_255_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_5_255_7&#39;)"><span class="hl_varref"><span class="mpre">x0</span></span></a><span class="mpre"> </span><a href="#loc_255_8_255_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_8_255_10&#39;)"><span class="hl_varref"><span class="mpre">y0</span></span></a><span class="mpre">
  where
    </span><a href="#loc_258_5_258_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_5_258_9&#39;)"><span class="mpre">geq&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
    </span><a name="loc_258_5_258_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_5_258_9&#39;)"><span class="hl_fundecl"><span class="mpre">geq&#39;</span></span></a><span class="mpre"> </span><a name="loc_258_10_258_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_10_258_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_258_12_258_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_12_258_13&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> =     (</span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_258_10_258_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_10_258_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_258_12_258_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_12_258_13&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">and</span></span><span class="mpre"> (</span><a href="#loc_222_1_222_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_10&#39;)"><span class="hl_varref"><span class="mpre">gzipWithQ</span></span></a><span class="mpre"> </span><a href="#loc_258_5_258_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_5_258_9&#39;)"><span class="hl_varref"><span class="mpre">geq&#39;</span></span></a><span class="mpre"> </span><a href="#loc_258_10_258_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_10_258_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_258_12_258_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_12_258_13&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Generic zip controlled by a function with type-specific branches</span></span><span class="mpre">
</span><a href="#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_1_265_5&#39;)"><span class="mpre">gzip</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericM</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericM</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">-- See testsuite/.../Generics/gzip.hs for an illustration</span></span><span class="mpre">
</span><a name="loc_265_1_265_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_1_265_5&#39;)"><span class="hl_fundecl"><span class="mpre">gzip</span></span></a><span class="mpre"> </span><a name="loc_265_6_265_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_6_265_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_265_8_265_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_8_265_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_265_10_265_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_10_265_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> =
  </span><a href="#loc_265_6_265_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_6_265_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_265_8_265_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_8_265_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_265_10_265_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_10_265_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
  </span><a href="Data.Generics.Aliases.html#loc_274_3_274_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_274_3_274_11&#39;)"><span class="hl_infix"><span class="mpre">`orElse`</span></span></a><span class="mpre">
  if </span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_265_8_265_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_8_265_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_265_10_265_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_10_265_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
    then </span><a href="#loc_212_1_212_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_10&#39;)"><span class="hl_varref"><span class="mpre">gzipWithM</span></span></a><span class="mpre"> (</span><a href="#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">gzip</span></span></a><span class="mpre"> </span><a href="#loc_265_6_265_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_6_265_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_265_8_265_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_8_265_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_265_10_265_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_10_265_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
    else </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
</span></div></body></html>