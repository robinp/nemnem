<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ScopedTypeVariables #-}
module Network.TLS.Util
        ( sub
        , takelast
        , partition3
        , partition6
        , fromJust
        , and&#39;
        , (&amp;&amp;!)
        , bytesEq
        , fmapEither
        , catchException
        ) where

import Data.List (</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">)
import Network.TLS.Struct (Bytes)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Util.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 18, srcSpanEndLine = 17, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B

import Control.Exception (fromException)
import qualified Control.Exception as E

</span><a href="#loc_23_1_23_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_4&#39;)"><span class="mpre">sub</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_23_1_23_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_4&#39;)"><span class="hl_fundecl"><span class="mpre">sub</span></span></a><span class="mpre"> </span><a name="loc_23_5_23_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_6&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_23_7_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_7_23_13&#39;)"><span class="hl_vardecl"><span class="mpre">offset</span></span></a><span class="mpre"> </span><a name="loc_23_14_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_14_23_17&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_23_5_23_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_6&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_23_7_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_7_23_13&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_23_14_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_14_23_17&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                 = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre"> </span><a href="#loc_23_14_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_14_23_17&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_23_7_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_7_23_13&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><a href="#loc_23_5_23_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_6&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><a href="#loc_28_1_28_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_9&#39;)"><span class="mpre">takelast</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_28_1_28_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_9&#39;)"><span class="hl_fundecl"><span class="mpre">takelast</span></span></a><span class="mpre"> </span><a name="loc_28_10_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_10_28_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_28_12_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_12_28_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_28_12_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_12_28_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_28_10_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_10_28_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="#loc_23_1_23_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_4&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre"> </span><a href="#loc_28_12_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_12_28_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_28_12_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_12_28_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_28_10_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_10_28_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="#loc_28_10_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_10_28_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><a href="#loc_33_1_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_11&#39;)"><span class="mpre">partition3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">)
</span><a name="loc_33_1_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_11&#39;)"><span class="hl_fundecl"><span class="mpre">partition3</span></span></a><span class="mpre"> </span><a name="loc_33_12_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_17&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> (</span><a name="loc_33_19_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_19_33_21&#39;)"><span class="hl_vardecl"><span class="mpre">d1</span></span></a><span class="mpre">,</span><a name="loc_33_22_33_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_24&#39;)"><span class="hl_vardecl"><span class="mpre">d2</span></span></a><span class="mpre">,</span><a name="loc_33_25_33_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_25_33_27&#39;)"><span class="hl_vardecl"><span class="mpre">d3</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><a href="#loc_37_15_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_15_37_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">             = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">sum</span></span><span class="mpre"> </span><a href="#loc_37_15_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_15_37_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_33_12_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_17&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">               = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_38_16_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_18&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre">,</span><a href="#loc_39_16_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_18&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre">,</span><a href="#loc_40_16_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_16_40_18&#39;)"><span class="hl_varref"><span class="mpre">p3</span></span></a><span class="mpre">)
        where </span><a name="loc_37_15_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_15_37_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">        = [</span><a href="#loc_33_19_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_19_33_21&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre">,</span><a href="#loc_33_22_33_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_24&#39;)"><span class="hl_varref"><span class="mpre">d2</span></span></a><span class="mpre">,</span><a href="#loc_33_25_33_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_25_33_27&#39;)"><span class="hl_varref"><span class="mpre">d3</span></span></a><span class="mpre">]
              (</span><a name="loc_38_16_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_18&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre">, </span><a name="loc_38_20_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_20_38_22&#39;)"><span class="hl_vardecl"><span class="mpre">r1</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_33_19_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_19_33_21&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a href="#loc_33_12_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_17&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">
              (</span><a name="loc_39_16_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_18&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="mpre">, </span><a name="loc_39_20_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_20_39_22&#39;)"><span class="hl_vardecl"><span class="mpre">r2</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_33_22_33_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_24&#39;)"><span class="hl_varref"><span class="mpre">d2</span></span></a><span class="mpre"> </span><a href="#loc_38_20_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_20_38_22&#39;)"><span class="hl_varref"><span class="mpre">r1</span></span></a><span class="mpre">
              (</span><a name="loc_40_16_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_16_40_18&#39;)"><span class="hl_vardecl"><span class="mpre">p3</span></span></a><span class="mpre">, _)  = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_33_25_33_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_25_33_27&#39;)"><span class="hl_varref"><span class="mpre">d3</span></span></a><span class="mpre"> </span><a href="#loc_39_20_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_20_39_22&#39;)"><span class="hl_varref"><span class="mpre">r2</span></span></a><span class="mpre">

</span><a href="#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="mpre">partition6</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">)
</span><a name="loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="hl_fundecl"><span class="mpre">partition6</span></span></a><span class="mpre"> </span><a name="loc_43_12_43_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_17&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> (</span><a name="loc_43_19_43_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_21&#39;)"><span class="hl_vardecl"><span class="mpre">d1</span></span></a><span class="mpre">,</span><a name="loc_43_22_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_22_43_24&#39;)"><span class="hl_vardecl"><span class="mpre">d2</span></span></a><span class="mpre">,</span><a name="loc_43_25_43_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_25_43_27&#39;)"><span class="hl_vardecl"><span class="mpre">d3</span></span></a><span class="mpre">,</span><a name="loc_43_28_43_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_28_43_30&#39;)"><span class="hl_vardecl"><span class="mpre">d4</span></span></a><span class="mpre">,</span><a name="loc_43_31_43_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_31_43_33&#39;)"><span class="hl_vardecl"><span class="mpre">d5</span></span></a><span class="mpre">,</span><a name="loc_43_34_43_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_34_43_36&#39;)"><span class="hl_vardecl"><span class="mpre">d6</span></span></a><span class="mpre">) = if </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_43_12_43_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_17&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_44_9_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_9_44_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> else </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_45_10_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_10_45_12&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre">,</span><a href="#loc_46_10_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_12&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre">,</span><a href="#loc_47_10_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_10_47_12&#39;)"><span class="hl_varref"><span class="mpre">p3</span></span></a><span class="mpre">,</span><a href="#loc_48_10_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_12&#39;)"><span class="hl_varref"><span class="mpre">p4</span></span></a><span class="mpre">,</span><a href="#loc_49_10_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_10_49_12&#39;)"><span class="hl_varref"><span class="mpre">p5</span></span></a><span class="mpre">,</span><a href="#loc_50_10_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_10_50_12&#39;)"><span class="hl_varref"><span class="mpre">p6</span></span></a><span class="mpre">)
  where </span><a name="loc_44_9_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_9_44_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">        = </span><span class="hl_varref"><span class="mpre">sum</span></span><span class="mpre"> [</span><a href="#loc_43_19_43_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_21&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre">,</span><a href="#loc_43_22_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_22_43_24&#39;)"><span class="hl_varref"><span class="mpre">d2</span></span></a><span class="mpre">,</span><a href="#loc_43_25_43_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_25_43_27&#39;)"><span class="hl_varref"><span class="mpre">d3</span></span></a><span class="mpre">,</span><a href="#loc_43_28_43_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_28_43_30&#39;)"><span class="hl_varref"><span class="mpre">d4</span></span></a><span class="mpre">,</span><a href="#loc_43_31_43_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_31_43_33&#39;)"><span class="hl_varref"><span class="mpre">d5</span></span></a><span class="mpre">,</span><a href="#loc_43_34_43_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_34_43_36&#39;)"><span class="hl_varref"><span class="mpre">d6</span></span></a><span class="mpre">]
        (</span><a name="loc_45_10_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_10_45_12&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre">, </span><a name="loc_45_14_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_16&#39;)"><span class="hl_vardecl"><span class="mpre">r1</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_43_19_43_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_21&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a href="#loc_43_12_43_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_17&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">
        (</span><a name="loc_46_10_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_10_46_12&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="mpre">, </span><a name="loc_46_14_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_16&#39;)"><span class="hl_vardecl"><span class="mpre">r2</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_43_22_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_22_43_24&#39;)"><span class="hl_varref"><span class="mpre">d2</span></span></a><span class="mpre"> </span><a href="#loc_45_14_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_16&#39;)"><span class="hl_varref"><span class="mpre">r1</span></span></a><span class="mpre">
        (</span><a name="loc_47_10_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_10_47_12&#39;)"><span class="hl_vardecl"><span class="mpre">p3</span></span></a><span class="mpre">, </span><a name="loc_47_14_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_14_47_16&#39;)"><span class="hl_vardecl"><span class="mpre">r3</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_43_25_43_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_25_43_27&#39;)"><span class="hl_varref"><span class="mpre">d3</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_16&#39;)"><span class="hl_varref"><span class="mpre">r2</span></span></a><span class="mpre">
        (</span><a name="loc_48_10_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_12&#39;)"><span class="hl_vardecl"><span class="mpre">p4</span></span></a><span class="mpre">, </span><a name="loc_48_14_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_16&#39;)"><span class="hl_vardecl"><span class="mpre">r4</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_43_28_43_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_28_43_30&#39;)"><span class="hl_varref"><span class="mpre">d4</span></span></a><span class="mpre"> </span><a href="#loc_47_14_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_14_47_16&#39;)"><span class="hl_varref"><span class="mpre">r3</span></span></a><span class="mpre">
        (</span><a name="loc_49_10_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_10_49_12&#39;)"><span class="hl_vardecl"><span class="mpre">p5</span></span></a><span class="mpre">, </span><a name="loc_49_14_49_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_14_49_16&#39;)"><span class="hl_vardecl"><span class="mpre">r5</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_43_31_43_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_31_43_33&#39;)"><span class="hl_varref"><span class="mpre">d5</span></span></a><span class="mpre"> </span><a href="#loc_48_14_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_16&#39;)"><span class="hl_varref"><span class="mpre">r4</span></span></a><span class="mpre">
        (</span><a name="loc_50_10_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_10_50_12&#39;)"><span class="hl_vardecl"><span class="mpre">p6</span></span></a><span class="mpre">, _)  = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_43_34_43_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_34_43_36&#39;)"><span class="hl_varref"><span class="mpre">d6</span></span></a><span class="mpre"> </span><a href="#loc_49_14_49_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_14_49_16&#39;)"><span class="hl_varref"><span class="mpre">r5</span></span></a><span class="mpre">

</span><a href="#loc_53_1_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_9&#39;)"><span class="mpre">fromJust</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_53_1_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_9&#39;)"><span class="hl_fundecl"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><a name="loc_53_10_53_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_14&#39;)"><span class="hl_vardecl"><span class="mpre">what</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;fromJust &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_53_10_53_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_14&#39;)"><span class="hl_varref"><span class="mpre">what</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: Nothing&quot;</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- yuck</span></span><span class="mpre">
</span><a href="#loc_53_1_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_9&#39;)"><span class="hl_fundecl"><span class="mpre">fromJust</span></span></a><span class="mpre"> _    (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_54_21_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_21_54_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_54_21_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_21_54_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is a strict version of and</span></span><span class="mpre">
</span><a href="#loc_58_1_58_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_5&#39;)"><span class="mpre">and&#39;</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_58_1_58_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_5&#39;)"><span class="hl_fundecl"><span class="mpre">and&#39;</span></span></a><span class="mpre"> </span><a name="loc_58_6_58_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_7&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_62_7_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_10&#39;)"><span class="hl_varref"><span class="mpre">(&amp;&amp;!)</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_58_6_58_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_7&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is a strict version of &amp;&amp;.</span></span><span class="mpre">
</span><a href="#loc_62_7_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_10&#39;)"><span class="mpre">(&amp;&amp;!)</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">  </span><a name="loc_62_7_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_10&#39;)"><span class="hl_fundecl"><span class="mpre">&amp;&amp;!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">  </span><a href="#loc_62_7_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_10&#39;)"><span class="hl_fundecl"><span class="mpre">&amp;&amp;!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_62_7_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_10&#39;)"><span class="hl_fundecl"><span class="mpre">&amp;&amp;!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_62_7_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_10&#39;)"><span class="hl_fundecl"><span class="mpre">&amp;&amp;!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | verify that 2 bytestrings are equals.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it&#39;s a non lazy version, that will compare every bytes.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- arguments with different length will bail out early</span></span><span class="mpre">
</span><a href="#loc_71_1_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_8&#39;)"><span class="mpre">bytesEq</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_71_1_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_8&#39;)"><span class="hl_fundecl"><span class="mpre">bytesEq</span></span></a><span class="mpre"> </span><a name="loc_71_9_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_11&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a name="loc_71_12_71_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_12_71_14&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_71_9_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_11&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_71_12_71_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_12_71_14&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                  = </span><a href="#loc_58_1_58_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_5&#39;)"><span class="hl_varref"><span class="mpre">and&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.zipWith</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre"> </span><a href="#loc_71_9_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_11&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a href="#loc_71_12_71_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_12_71_14&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">

</span><a href="#loc_76_1_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_11&#39;)"><span class="mpre">fmapEither</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">l</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">l</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_76_1_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_11&#39;)"><span class="hl_fundecl"><span class="mpre">fmapEither</span></span></a><span class="mpre"> </span><a name="loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = case </span><a href="#loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_77_10_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_77_10_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_78_11_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_78_11_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)

</span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="mpre">catchException</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">E.SomeException</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_fundecl"><span class="mpre">catchException</span></span></a><span class="mpre"> </span><a name="loc_81_16_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_16_81_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_81_18_81_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_18_81_25&#39;)"><span class="hl_vardecl"><span class="mpre">handler</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_170_1_170_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_170_1_170_10&#39;)"><span class="hl_varref"><span class="mpre">E.catchJust</span></span></a><span class="mpre"> </span><a href="#loc_83_9_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_18&#39;)"><span class="hl_varref"><span class="mpre">filterExn</span></span></a><span class="mpre"> </span><a href="#loc_81_16_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_16_81_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_81_18_81_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_18_81_25&#39;)"><span class="hl_varref"><span class="mpre">handler</span></span></a><span class="mpre">
  where </span><a href="#loc_83_9_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_18&#39;)"><span class="mpre">filterExn</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">E.SomeException</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">E.SomeException</span></span><span class="mpre">
        </span><a name="loc_83_9_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_18&#39;)"><span class="hl_fundecl"><span class="mpre">filterExn</span></span></a><span class="mpre"> </span><a name="loc_83_19_83_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_19_83_20&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">fromException</span></span><span class="mpre"> </span><a href="#loc_83_19_83_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_19_83_20&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
                            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (_ :: </span><a href="GHC.IO.Exception.html#loc_136_6_136_20" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_136_6_136_20&#39;)"><span class="hl_tyconref"><span class="mpre">E.AsyncException</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">                      -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_83_19_83_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_19_83_20&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
</span></div></body></html>