<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Algo.Quickhull (quickhull) where

import Data.Vector.Unboxed as V

</span><a href="#loc_7_1_7_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_1_7_10&#39;)"><span class="mpre">quickhull</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_7_1_7_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_1_7_10&#39;)"><span class="mpre">quickhull</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_7_1_7_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_1_7_10&#39;)"><span class="hl_fundecl"><span class="mpre">quickhull</span></span></a><span class="mpre"> (</span><a name="loc_7_12_7_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_12_7_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">, </span><a name="loc_7_16_7_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_16_7_18&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_9_8_9_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_8_9_11&#39;)"><span class="hl_varref"><span class="mpre">xs&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="#loc_9_12_9_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_12_9_15&#39;)"><span class="hl_varref"><span class="mpre">ys&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> (</span><a href="#loc_9_8_9_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_8_9_11&#39;)"><span class="hl_varref"><span class="mpre">xs&#39;</span></span></a><span class="mpre">,</span><a href="#loc_9_12_9_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_12_9_15&#39;)"><span class="hl_varref"><span class="mpre">ys&#39;</span></span></a><span class="mpre">)
    where
      (</span><a name="loc_9_8_9_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_8_9_11&#39;)"><span class="hl_vardecl"><span class="mpre">xs&#39;</span></span></a><span class="mpre">,</span><a name="loc_9_12_9_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_12_9_15&#39;)"><span class="hl_vardecl"><span class="mpre">ys&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">V.unzip</span></span><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_20_7_20_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_7_20_13&#39;)"><span class="hl_varref"><span class="mpre">hsplit</span></span></a><span class="mpre"> </span><a href="#loc_15_7_15_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_13&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre"> </span><a href="#loc_16_7_16_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_7_16_11&#39;)"><span class="hl_varref"><span class="mpre">pmin</span></span></a><span class="mpre"> </span><a href="#loc_17_7_17_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_7_17_11&#39;)"><span class="hl_varref"><span class="mpre">pmax</span></span></a><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_555_1_555_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_555_1_555_5&#39;)"><span class="hl_infix"><span class="mpre">V.++</span></span></a><span class="mpre"> </span><a href="#loc_20_7_20_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_7_20_13&#39;)"><span class="hl_varref"><span class="mpre">hsplit</span></span></a><span class="mpre"> </span><a href="#loc_15_7_15_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_13&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre"> </span><a href="#loc_17_7_17_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_7_17_11&#39;)"><span class="hl_varref"><span class="mpre">pmax</span></span></a><span class="mpre"> </span><a href="#loc_16_7_16_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_7_16_11&#39;)"><span class="hl_varref"><span class="mpre">pmin</span></span></a><span class="mpre">

      </span><a name="loc_12_7_12_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_7_12_11&#39;)"><span class="hl_vardecl"><span class="mpre">imin</span></span></a><span class="mpre"> = </span><a href="Data.Vector.Unboxed.html#loc_1152_1_1152_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_1152_1_1152_9&#39;)"><span class="hl_varref"><span class="mpre">V.minIndex</span></span></a><span class="mpre"> </span><a href="#loc_7_12_7_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_12_7_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
      </span><a name="loc_13_7_13_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_7_13_11&#39;)"><span class="hl_vardecl"><span class="mpre">imax</span></span></a><span class="mpre"> = </span><a href="Data.Vector.Unboxed.html#loc_1140_1_1140_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_1140_1_1140_9&#39;)"><span class="hl_varref"><span class="mpre">V.maxIndex</span></span></a><span class="mpre"> </span><a href="#loc_7_12_7_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_12_7_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

      </span><a name="loc_15_7_15_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_13&#39;)"><span class="hl_vardecl"><span class="mpre">points</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">V.zip</span></span><span class="mpre"> </span><a href="#loc_7_12_7_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_12_7_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_7_16_7_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_7_16_7_18&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
      </span><a name="loc_16_7_16_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_7_16_11&#39;)"><span class="hl_vardecl"><span class="mpre">pmin</span></span></a><span class="mpre">   = </span><a href="#loc_15_7_15_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_13&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_268_1_268_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_268_1_268_4&#39;)"><span class="hl_infix"><span class="mpre">V.!</span></span></a><span class="mpre"> </span><a href="#loc_12_7_12_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_7_12_11&#39;)"><span class="hl_varref"><span class="mpre">imin</span></span></a><span class="mpre">
      </span><a name="loc_17_7_17_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_7_17_11&#39;)"><span class="hl_vardecl"><span class="mpre">pmax</span></span></a><span class="mpre">   = </span><a href="#loc_15_7_15_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_13&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_268_1_268_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_268_1_268_4&#39;)"><span class="hl_infix"><span class="mpre">V.!</span></span></a><span class="mpre"> </span><a href="#loc_13_7_13_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_7_13_11&#39;)"><span class="hl_varref"><span class="mpre">imax</span></span></a><span class="mpre">


      </span><a name="loc_20_7_20_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_7_20_13&#39;)"><span class="hl_fundecl"><span class="mpre">hsplit</span></span></a><span class="mpre"> </span><a name="loc_20_14_20_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_14_20_20&#39;)"><span class="hl_vardecl"><span class="mpre">points</span></span></a><span class="mpre"> </span><a name="loc_20_21_20_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_21_20_23&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a name="loc_20_24_20_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_24_20_26&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="mpre">
        | </span><a href="Data.Vector.Unboxed.html#loc_255_1_255_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_255_1_255_7&#39;)"><span class="hl_varref"><span class="mpre">V.length</span></span></a><span class="mpre"> </span><a href="#loc_25_11_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_17&#39;)"><span class="hl_varref"><span class="mpre">packed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> = </span><a href="#loc_20_21_20_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_21_20_23&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_544_1_544_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_544_1_544_5&#39;)"><span class="hl_infix"><span class="mpre">`V.cons`</span></span></a><span class="mpre"> </span><a href="#loc_25_11_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_17&#39;)"><span class="hl_varref"><span class="mpre">packed</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_20_7_20_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_7_20_13&#39;)"><span class="hl_varref"><span class="mpre">hsplit</span></span></a><span class="mpre"> </span><a href="#loc_25_11_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_17&#39;)"><span class="hl_varref"><span class="mpre">packed</span></span></a><span class="mpre"> </span><a href="#loc_20_21_20_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_21_20_23&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a href="#loc_29_11_29_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_11_29_13&#39;)"><span class="hl_varref"><span class="mpre">pm</span></span></a><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_555_1_555_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_555_1_555_5&#39;)"><span class="hl_infix"><span class="mpre">V.++</span></span></a><span class="mpre"> </span><a href="#loc_20_7_20_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_7_20_13&#39;)"><span class="hl_varref"><span class="mpre">hsplit</span></span></a><span class="mpre"> </span><a href="#loc_25_11_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_17&#39;)"><span class="hl_varref"><span class="mpre">packed</span></span></a><span class="mpre"> </span><a href="#loc_29_11_29_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_11_29_13&#39;)"><span class="hl_varref"><span class="mpre">pm</span></span></a><span class="mpre"> </span><a href="#loc_20_24_20_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_24_20_26&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre">
        where
          </span><a name="loc_24_11_24_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_11_24_13&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">     = </span><a href="Data.Vector.Unboxed.html#loc_781_1_781_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_781_1_781_4&#39;)"><span class="hl_varref"><span class="mpre">V.map</span></span></a><span class="mpre"> (\</span><a name="loc_24_28_24_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_28_24_29&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_31_7_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_12&#39;)"><span class="hl_varref"><span class="mpre">cross</span></span></a><span class="mpre"> </span><a href="#loc_24_28_24_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_28_24_29&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_20_21_20_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_21_20_23&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a href="#loc_20_24_20_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_24_20_26&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre">) </span><a href="#loc_20_14_20_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_14_20_20&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre">
          </span><a name="loc_25_11_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_17&#39;)"><span class="hl_vardecl"><span class="mpre">packed</span></span></a><span class="mpre"> = </span><a href="Data.Vector.Unboxed.html#loc_781_1_781_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_781_1_781_4&#39;)"><span class="hl_varref"><span class="mpre">V.map</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">
                 </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_912_1_912_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_912_1_912_7&#39;)"><span class="hl_varref"><span class="mpre">V.filter</span></span></a><span class="mpre"> (\</span><a name="loc_26_31_26_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_31_26_32&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_26_31_26_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_31_26_32&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
                 </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">V.zip</span></span><span class="mpre"> </span><a href="#loc_20_14_20_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_14_20_20&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre"> </span><a href="#loc_24_11_24_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_11_24_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

          </span><a name="loc_29_11_29_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_11_29_13&#39;)"><span class="hl_vardecl"><span class="mpre">pm</span></span></a><span class="mpre">     = </span><a href="#loc_20_14_20_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_14_20_20&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_268_1_268_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_268_1_268_4&#39;)"><span class="hl_infix"><span class="mpre">V.!</span></span></a><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_1140_1_1140_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_1140_1_1140_9&#39;)"><span class="hl_varref"><span class="mpre">V.maxIndex</span></span></a><span class="mpre"> </span><a href="#loc_24_11_24_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_11_24_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

      </span><a name="loc_31_7_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_12&#39;)"><span class="hl_fundecl"><span class="mpre">cross</span></span></a><span class="mpre"> (</span><a name="loc_31_14_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_14_31_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_31_16_31_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_16_31_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a name="loc_31_20_31_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_20_31_22&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre">,</span><a name="loc_31_23_31_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_23_31_25&#39;)"><span class="hl_vardecl"><span class="mpre">y1</span></span></a><span class="mpre">) (</span><a name="loc_31_28_31_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_28_31_30&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre">,</span><a name="loc_31_31_31_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_31_31_33&#39;)"><span class="hl_vardecl"><span class="mpre">y2</span></span></a><span class="mpre">) = (</span><a href="#loc_31_20_31_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_20_31_22&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_31_14_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_14_31_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre">(</span><a href="#loc_31_31_31_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_31_31_33&#39;)"><span class="hl_varref"><span class="mpre">y2</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_31_16_31_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_16_31_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><a href="#loc_31_23_31_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_23_31_25&#39;)"><span class="hl_varref"><span class="mpre">y1</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_31_16_31_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_16_31_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre">(</span><a href="#loc_31_28_31_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_28_31_30&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_31_14_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_14_31_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span></div></body></html>