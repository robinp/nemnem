<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.PubKey.RSA.OAEP</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- RSA OAEP mode</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE OverloadedStrings #-}
module Crypto.PubKey.RSA.OAEP
    (
      OAEPParams(..)
    , defaultOAEPParams
    </span><span class="hl_comment"><span class="mpre">-- * OAEP encryption</span></span><span class="mpre">
    , encryptWithSeed
    , encrypt
    </span><span class="hl_comment"><span class="mpre">-- * OAEP decryption</span></span><span class="mpre">
    , decrypt
    , decryptSafer
    ) where

import Crypto.Random
import Crypto.Types.PubKey.RSA
import Crypto.PubKey.HashDescr
import Crypto.PubKey.MaskGenFunction
import Crypto.PubKey.RSA.Prim
import Crypto.PubKey.RSA.Types
import Crypto.PubKey.RSA (</span><a href="Crypto.PubKey.RSA.html#loc_91_1_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.html#loc_91_1_91_16&#39;)"><span class="mpre">generateBlinder</span></a><span class="mpre">)
import Crypto.PubKey.Internal (</span><a href="Crypto.PubKey.Internal.html#loc_17_1_17_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.Internal.html#loc_17_1_17_5&#39;)"><span class="mpre">and&#39;</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/OAEP.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 8, srcSpanEndLine = 32, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/OAEP.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 18, srcSpanEndLine = 33, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Data.Bits (</span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="mpre">xor</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Parameters for OAEP encryption/decryption</span></span><span class="mpre">
data </span><a name="loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tycondecl"><span class="mpre">OAEPParams</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">OAEPParams</span></span><span class="mpre">
    { </span><a name="loc_38_7_38_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_15&#39;)"><span class="hl_fielddecl"><span class="mpre">oaepHash</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Hash function to use.</span></span><span class="mpre">
    , </span><a name="loc_39_7_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_21&#39;)"><span class="hl_fielddecl"><span class="mpre">oaepMaskGenAlg</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">MaskGenAlgorithm</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Mask Gen algorithm to use.</span></span><span class="mpre">
    , </span><a name="loc_40_7_40_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_16&#39;)"><span class="hl_fielddecl"><span class="mpre">oaepLabel</span></span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Optional label prepended to message.</span></span><span class="mpre">
    }

</span><span class="hl_comment"><span class="mpre">-- | Default Params with a specified hash function</span></span><span class="mpre">
</span><a href="#loc_45_1_45_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_18&#39;)"><span class="mpre">defaultOAEPParams</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre"> -&gt; </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">OAEPParams</span></span></a><span class="mpre">
</span><a name="loc_45_1_45_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_18&#39;)"><span class="hl_fundecl"><span class="mpre">defaultOAEPParams</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">hashF</span></span><span class="mpre"> =
    </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/OAEP.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 5, srcSpanEndLine = 49, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/OAEP.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 16, srcSpanEndLine = 46, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey"><span class="mpre">OAEPParams { oaepHash         = hashF
               , oaepMaskGenAlg   = mgf1
               , oaepLabel        = Nothing
               }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encrypt a message using OAEP with a predefined seed.</span></span><span class="mpre">
</span><a href="#loc_57_1_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_16&#39;)"><span class="mpre">encryptWithSeed</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Seed</span></span><span class="mpre">
                -&gt; </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">OAEPParams</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ OAEP params to use for encryption</span></span><span class="mpre">
                -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Public key.</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Message to encrypt</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_57_1_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_16&#39;)"><span class="hl_fundecl"><span class="mpre">encryptWithSeed</span></span></a><span class="mpre"> </span><a name="loc_57_17_57_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_21&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a name="loc_57_22_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_22_57_26&#39;)"><span class="hl_vardecl"><span class="mpre">oaep</span></span></a><span class="mpre"> </span><a name="loc_57_27_57_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_27_57_29&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_57_30_57_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_30_57_33&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre">
    | </span><a href="#loc_63_11_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_68_11_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">          = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_24_7_24_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_24_7_24_24&#39;)"><span class="hl_conref"><span class="mpre">InvalidParameters</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_57_17_57_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_21&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_68_11_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_24_7_24_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_24_7_24_24&#39;)"><span class="hl_conref"><span class="mpre">InvalidParameters</span></span></a><span class="mpre">
    | </span><a href="#loc_64_11_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_15&#39;)"><span class="hl_varref"><span class="mpre">mLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_63_11_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_68_11_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_21_7_21_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_21_7_21_21&#39;)"><span class="hl_conref"><span class="mpre">MessageTooLong</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Prim.html#loc_57_1_57_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Prim.html#loc_57_1_57_3&#39;)"><span class="hl_varref"><span class="mpre">ep</span></span></a><span class="mpre"> </span><a href="#loc_57_27_57_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_27_57_29&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_77_11_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_13&#39;)"><span class="hl_varref"><span class="mpre">em</span></span></a><span class="mpre">
    where </span><span class="hl_comment"><span class="mpre">-- parameters</span></span><span class="mpre">
          </span><a name="loc_63_11_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">          = </span><a href="Crypto.Types.PubKey.RSA.html#loc_26_7_26_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_26_7_26_18&#39;)"><span class="hl_varref"><span class="mpre">public_size</span></span></a><span class="mpre"> </span><a href="#loc_57_27_57_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_27_57_29&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">
          </span><a name="loc_64_11_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_15&#39;)"><span class="hl_vardecl"><span class="mpre">mLen</span></span></a><span class="mpre">       = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_57_30_57_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_30_57_33&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
          </span><a name="loc_65_11_65_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_11_65_16&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre">      = </span><a href="#loc_38_7_38_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_15&#39;)"><span class="hl_varref"><span class="mpre">oaepHash</span></span></a><span class="mpre"> </span><a href="#loc_57_22_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_22_57_26&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre">
          </span><a name="loc_66_11_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_11_66_14&#39;)"><span class="hl_vardecl"><span class="mpre">mgf</span></span></a><span class="mpre">        = (</span><a href="#loc_39_7_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_21&#39;)"><span class="hl_varref"><span class="mpre">oaepMaskGenAlg</span></span></a><span class="mpre"> </span><a href="#loc_57_22_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_22_57_26&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre">) </span><a href="#loc_65_11_65_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_11_65_16&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre">
          </span><a name="loc_67_11_67_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_20&#39;)"><span class="hl_vardecl"><span class="mpre">labelHash</span></span></a><span class="mpre">  = </span><a href="#loc_65_11_65_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_11_65_16&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_40_7_40_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_16&#39;)"><span class="hl_varref"><span class="mpre">oaepLabel</span></span></a><span class="mpre"> </span><a href="#loc_57_22_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_22_57_26&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre">
          </span><a name="loc_68_11_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_18&#39;)"><span class="hl_vardecl"><span class="mpre">hashLen</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_67_11_67_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_20&#39;)"><span class="hl_varref"><span class="mpre">labelHash</span></span></a><span class="mpre">

          </span><span class="hl_comment"><span class="mpre">-- put fields</span></span><span class="mpre">
          </span><a name="loc_71_11_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_11_71_13&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> (</span><a href="#loc_63_11_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_64_11_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_15&#39;)"><span class="hl_varref"><span class="mpre">mLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_68_11_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
          </span><a name="loc_72_11_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_13&#39;)"><span class="hl_vardecl"><span class="mpre">db</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [</span><a href="#loc_67_11_67_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_20&#39;)"><span class="hl_varref"><span class="mpre">labelHash</span></span></a><span class="mpre">, </span><a href="#loc_71_11_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_11_71_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.singleton</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1</span></span><span class="mpre">, </span><a href="#loc_57_30_57_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_30_57_33&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">]
          </span><a name="loc_73_11_73_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_17&#39;)"><span class="hl_vardecl"><span class="mpre">dbmask</span></span></a><span class="mpre">     = </span><a href="#loc_66_11_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_11_66_14&#39;)"><span class="hl_varref"><span class="mpre">mgf</span></span></a><span class="mpre"> </span><a href="#loc_57_17_57_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_21&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> (</span><a href="#loc_63_11_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_68_11_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          </span><a name="loc_74_11_74_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_19&#39;)"><span class="hl_vardecl"><span class="mpre">maskedDB</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.zipWith</span></span><span class="mpre"> </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">xor</span></span></a><span class="mpre"> </span><a href="#loc_72_11_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_13&#39;)"><span class="hl_varref"><span class="mpre">db</span></span></a><span class="mpre"> </span><a href="#loc_73_11_73_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_17&#39;)"><span class="hl_varref"><span class="mpre">dbmask</span></span></a><span class="mpre">
          </span><a name="loc_75_11_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_19&#39;)"><span class="hl_vardecl"><span class="mpre">seedMask</span></span></a><span class="mpre">   = </span><a href="#loc_66_11_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_11_66_14&#39;)"><span class="hl_varref"><span class="mpre">mgf</span></span></a><span class="mpre"> </span><a href="#loc_74_11_74_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_19&#39;)"><span class="hl_varref"><span class="mpre">maskedDB</span></span></a><span class="mpre"> </span><a href="#loc_68_11_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="mpre">
          </span><a name="loc_76_11_76_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_11_76_21&#39;)"><span class="hl_vardecl"><span class="mpre">maskedSeed</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.zipWith</span></span><span class="mpre"> </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">xor</span></span></a><span class="mpre"> </span><a href="#loc_57_17_57_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_21&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a href="#loc_75_11_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_11_75_19&#39;)"><span class="hl_varref"><span class="mpre">seedMask</span></span></a><span class="mpre">
          </span><a name="loc_77_11_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_13&#39;)"><span class="hl_vardecl"><span class="mpre">em</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">B.singleton</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x0</span></span><span class="mpre">,</span><a href="#loc_76_11_76_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_11_76_21&#39;)"><span class="hl_varref"><span class="mpre">maskedSeed</span></span></a><span class="mpre">,</span><a href="#loc_74_11_74_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_19&#39;)"><span class="hl_varref"><span class="mpre">maskedDB</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | Encrypt a message using OAEP</span></span><span class="mpre">
</span><a href="#loc_86_1_86_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_8&#39;)"><span class="mpre">encrypt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/OAEP.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 12, srcSpanEndLine = 81, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/OAEP.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 9, srcSpanEndLine = 81, srcSpanEndColumn = 11}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">CPRG g
        =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^ random number generator.</span></span><span class="mpre">
        -&gt; </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">OAEPParams</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ OAEP params to use for encryption.</span></span><span class="mpre">
        -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Public key.</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Message to encrypt</span></span><span class="mpre">
        -&gt; (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_86_1_86_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_8&#39;)"><span class="hl_fundecl"><span class="mpre">encrypt</span></span></a><span class="mpre"> </span><a name="loc_86_9_86_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_86_11_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_11_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">oaep</span></span></a><span class="mpre"> </span><a name="loc_86_16_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_86_19_86_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_19_86_22&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = (</span><a href="#loc_57_1_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_16&#39;)"><span class="hl_varref"><span class="mpre">encryptWithSeed</span></span></a><span class="mpre"> </span><a href="#loc_89_12_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_12_89_16&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a href="#loc_86_11_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_11_86_15&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre"> </span><a href="#loc_86_16_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_18&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_86_19_86_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_19_86_22&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">, </span><a href="#loc_89_18_89_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_18_89_20&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">)
    where </span><a name="loc_87_11_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre">      = </span><a href="#loc_38_7_38_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_15&#39;)"><span class="hl_varref"><span class="mpre">oaepHash</span></span></a><span class="mpre"> </span><a href="#loc_86_11_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_11_86_15&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre">
          </span><a name="loc_88_11_88_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_11_88_18&#39;)"><span class="hl_vardecl"><span class="mpre">hashLen</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> (</span><a href="#loc_87_11_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_16&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">)
          (</span><a name="loc_89_12_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_12_89_16&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre">, </span><a name="loc_89_18_89_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_18_89_20&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">cprgGenerate</span></span><span class="mpre"> </span><a href="#loc_88_11_88_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_11_88_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="mpre"> </span><a href="#loc_86_9_86_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | un-pad a OAEP encoded message.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It doesn&#39;t apply the RSA decryption primitive</span></span><span class="mpre">
</span><a href="#loc_98_1_98_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_6&#39;)"><span class="mpre">unpad</span></a><span class="mpre"> :: </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">OAEPParams</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ OAEP params to use</span></span><span class="mpre">
      -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ size of the key in bytes</span></span><span class="mpre">
      -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ encoded message (not encrypted)</span></span><span class="mpre">
      -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_98_1_98_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_6&#39;)"><span class="hl_fundecl"><span class="mpre">unpad</span></span></a><span class="mpre"> </span><a name="loc_98_7_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_11&#39;)"><span class="hl_vardecl"><span class="mpre">oaep</span></span></a><span class="mpre"> </span><a name="loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_98_14_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_16&#39;)"><span class="hl_vardecl"><span class="mpre">em</span></span></a><span class="mpre">
    | </span><a href="#loc_118_11_118_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_11_118_25&#39;)"><span class="hl_varref"><span class="mpre">paddingSuccess</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_116_16_116_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_19&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">      = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_22_7_22_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_22_7_22_27&#39;)"><span class="hl_conref"><span class="mpre">MessageNotRecognized</span></span></a><span class="mpre">
    where </span><span class="hl_comment"><span class="mpre">-- parameters</span></span><span class="mpre">
          </span><a name="loc_102_11_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_16&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre">      = </span><a href="#loc_38_7_38_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_15&#39;)"><span class="hl_varref"><span class="mpre">oaepHash</span></span></a><span class="mpre"> </span><a href="#loc_98_7_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_11&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre">
          </span><a name="loc_103_11_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_14&#39;)"><span class="hl_vardecl"><span class="mpre">mgf</span></span></a><span class="mpre">        = (</span><a href="#loc_39_7_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_21&#39;)"><span class="hl_varref"><span class="mpre">oaepMaskGenAlg</span></span></a><span class="mpre"> </span><a href="#loc_98_7_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_11&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre">) </span><a href="#loc_102_11_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_16&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre">
          </span><a name="loc_104_11_104_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_20&#39;)"><span class="hl_vardecl"><span class="mpre">labelHash</span></span></a><span class="mpre">  = </span><a href="#loc_102_11_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_16&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_40_7_40_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_16&#39;)"><span class="hl_varref"><span class="mpre">oaepLabel</span></span></a><span class="mpre"> </span><a href="#loc_98_7_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_11&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre">
          </span><a name="loc_105_11_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_11_105_18&#39;)"><span class="hl_vardecl"><span class="mpre">hashLen</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_104_11_104_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_20&#39;)"><span class="hl_varref"><span class="mpre">labelHash</span></span></a><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- getting em&#39;s fields</span></span><span class="mpre">
          (</span><a name="loc_107_12_107_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_12_107_14&#39;)"><span class="hl_vardecl"><span class="mpre">pb</span></span></a><span class="mpre">, </span><a name="loc_107_16_107_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_16_107_19&#39;)"><span class="hl_vardecl"><span class="mpre">em0</span></span></a><span class="mpre">)  = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_98_14_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_16&#39;)"><span class="hl_varref"><span class="mpre">em</span></span></a><span class="mpre">
          (</span><a name="loc_108_12_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_12_108_22&#39;)"><span class="hl_vardecl"><span class="mpre">maskedSeed</span></span></a><span class="mpre">,</span><a name="loc_108_23_108_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_31&#39;)"><span class="hl_vardecl"><span class="mpre">maskedDB</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_105_11_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_11_105_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="mpre"> </span><a href="#loc_107_16_107_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_16_107_19&#39;)"><span class="hl_varref"><span class="mpre">em0</span></span></a><span class="mpre">
          </span><a name="loc_109_11_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_19&#39;)"><span class="hl_vardecl"><span class="mpre">seedMask</span></span></a><span class="mpre">   = </span><a href="#loc_103_11_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_14&#39;)"><span class="hl_varref"><span class="mpre">mgf</span></span></a><span class="mpre"> </span><a href="#loc_108_23_108_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_31&#39;)"><span class="hl_varref"><span class="mpre">maskedDB</span></span></a><span class="mpre"> </span><a href="#loc_105_11_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_11_105_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="mpre">
          </span><a name="loc_110_11_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_11_110_15&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre">       = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.zipWith</span></span><span class="mpre"> </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">xor</span></span></a><span class="mpre"> </span><a href="#loc_108_12_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_12_108_22&#39;)"><span class="hl_varref"><span class="mpre">maskedSeed</span></span></a><span class="mpre"> </span><a href="#loc_109_11_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_19&#39;)"><span class="hl_varref"><span class="mpre">seedMask</span></span></a><span class="mpre">
          </span><a name="loc_111_11_111_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_17&#39;)"><span class="hl_vardecl"><span class="mpre">dbmask</span></span></a><span class="mpre">     = </span><a href="#loc_103_11_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_14&#39;)"><span class="hl_varref"><span class="mpre">mgf</span></span></a><span class="mpre"> </span><a href="#loc_110_11_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_11_110_15&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> (</span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_105_11_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_11_105_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          </span><a name="loc_112_11_112_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_11_112_13&#39;)"><span class="hl_vardecl"><span class="mpre">db</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.zipWith</span></span><span class="mpre"> </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">xor</span></span></a><span class="mpre"> </span><a href="#loc_108_23_108_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_31&#39;)"><span class="hl_varref"><span class="mpre">maskedDB</span></span></a><span class="mpre"> </span><a href="#loc_111_11_111_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_17&#39;)"><span class="hl_varref"><span class="mpre">dbmask</span></span></a><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- getting db&#39;s fields</span></span><span class="mpre">
          (</span><a name="loc_114_12_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_22&#39;)"><span class="hl_vardecl"><span class="mpre">labelHash&#39;</span></span></a><span class="mpre">,</span><a name="loc_114_23_114_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_23_114_26&#39;)"><span class="hl_vardecl"><span class="mpre">db1</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_105_11_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_11_105_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="mpre"> </span><a href="#loc_112_11_112_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_11_112_13&#39;)"><span class="hl_varref"><span class="mpre">db</span></span></a><span class="mpre">
          (_,</span><a name="loc_115_14_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_14_115_17&#39;)"><span class="hl_vardecl"><span class="mpre">db2</span></span></a><span class="mpre">)    = </span><span class="hl_varref"><span class="mpre">B.break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><a href="#loc_114_23_114_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_23_114_26&#39;)"><span class="hl_varref"><span class="mpre">db1</span></span></a><span class="mpre">
          (</span><a name="loc_116_12_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_15&#39;)"><span class="hl_vardecl"><span class="mpre">ps1</span></span></a><span class="mpre">,</span><a name="loc_116_16_116_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_19&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre">)  = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_115_14_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_14_115_17&#39;)"><span class="hl_varref"><span class="mpre">db2</span></span></a><span class="mpre">

          </span><a name="loc_118_11_118_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_11_118_25&#39;)"><span class="hl_vardecl"><span class="mpre">paddingSuccess</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.Internal.html#loc_17_1_17_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.Internal.html#loc_17_1_17_5&#39;)"><span class="hl_varref"><span class="mpre">and&#39;</span></span></a><span class="mpre"> [ </span><a href="#loc_114_12_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_22&#39;)"><span class="hl_varref"><span class="mpre">labelHash&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_104_11_104_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_20&#39;)"><span class="hl_varref"><span class="mpre">labelHash</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- no need for constant eq</span></span><span class="mpre">
                                , </span><a href="#loc_116_12_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_15&#39;)"><span class="hl_varref"><span class="mpre">ps1</span></span></a><span class="mpre">        </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\x01&quot;</span></span><span class="mpre">
                                , </span><a href="#loc_107_12_107_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_12_107_14&#39;)"><span class="hl_varref"><span class="mpre">pb</span></span></a><span class="mpre">         </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\x00&quot;</span></span><span class="mpre">
                                ]

</span><span class="hl_comment"><span class="mpre">-- | Decrypt a ciphertext using OAEP</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When the signature is not in a context where an attacker could gain</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- information from the timing of the operation, the blinder can be set to None.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If unsure always set a blinder or use decryptSafer</span></span><span class="mpre">
</span><a href="#loc_134_1_134_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_8&#39;)"><span class="mpre">decrypt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_15_6_15_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_15_6_15_13&#39;)"><span class="hl_tyconref"><span class="mpre">Blinder</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Optional blinder</span></span><span class="mpre">
        -&gt; </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">OAEPParams</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ OAEP params to use for decryption</span></span><span class="mpre">
        -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Private key</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Cipher text</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_134_1_134_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_8&#39;)"><span class="hl_fundecl"><span class="mpre">decrypt</span></span></a><span class="mpre"> </span><a name="loc_134_9_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_16&#39;)"><span class="hl_vardecl"><span class="mpre">blinder</span></span></a><span class="mpre"> </span><a name="loc_134_17_134_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_21&#39;)"><span class="hl_vardecl"><span class="mpre">oaep</span></span></a><span class="mpre"> </span><a name="loc_134_22_134_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_22_134_24&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_134_25_134_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_25_134_31&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_134_25_134_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_25_134_31&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_139_11_139_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_20_7_20_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_20_7_20_27&#39;)"><span class="hl_conref"><span class="mpre">MessageSizeIncorrect</span></span></a><span class="mpre">
    | </span><a href="#loc_139_11_139_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_141_11_141_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_18&#39;)"><span class="hl_varref"><span class="mpre">hashLen</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">      = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_24_7_24_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_24_7_24_24&#39;)"><span class="hl_conref"><span class="mpre">InvalidParameters</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">            = </span><a href="#loc_98_1_98_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_6&#39;)"><span class="hl_varref"><span class="mpre">unpad</span></span></a><span class="mpre"> </span><a href="#loc_134_17_134_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_21&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_71_1_71_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_71_1_71_13&#39;)"><span class="hl_varref"><span class="mpre">private_size</span></span></a><span class="mpre"> </span><a href="#loc_134_22_134_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_22_134_24&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Prim.html#loc_51_1_51_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Prim.html#loc_51_1_51_3&#39;)"><span class="hl_varref"><span class="mpre">dp</span></span></a><span class="mpre"> </span><a href="#loc_134_9_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_16&#39;)"><span class="hl_varref"><span class="mpre">blinder</span></span></a><span class="mpre"> </span><a href="#loc_134_22_134_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_22_134_24&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_134_25_134_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_25_134_31&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">
    where </span><span class="hl_comment"><span class="mpre">-- parameters</span></span><span class="mpre">
          </span><a name="loc_139_11_139_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">          = </span><a href="Crypto.Types.PubKey.RSA.html#loc_71_1_71_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_71_1_71_13&#39;)"><span class="hl_varref"><span class="mpre">private_size</span></span></a><span class="mpre"> </span><a href="#loc_134_22_134_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_22_134_24&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">
          </span><a name="loc_140_11_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_11_140_16&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre">      = </span><a href="#loc_38_7_38_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_15&#39;)"><span class="hl_varref"><span class="mpre">oaepHash</span></span></a><span class="mpre"> </span><a href="#loc_134_17_134_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_21&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre">
          </span><a name="loc_141_11_141_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_18&#39;)"><span class="hl_vardecl"><span class="mpre">hashLen</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> (</span><a href="#loc_140_11_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_11_140_16&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Decrypt a ciphertext using OAEP and by automatically generating a blinder.</span></span><span class="mpre">
</span><a href="#loc_150_1_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_13&#39;)"><span class="mpre">decryptSafer</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/OAEP.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 17, srcSpanEndLine = 145, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/OAEP.hs&quot;, srcSpanStartLine = 145, srcSpanStartColumn = 14, srcSpanEndLine = 145, srcSpanEndColumn = 16}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">CPRG g
             =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^ random number generator</span></span><span class="mpre">
             -&gt; </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">OAEPParams</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ OAEP params to use for decryption</span></span><span class="mpre">
             -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Private key</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Cipher text</span></span><span class="mpre">
             -&gt; (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_150_1_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_13&#39;)"><span class="hl_fundecl"><span class="mpre">decryptSafer</span></span></a><span class="mpre"> </span><a name="loc_150_14_150_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_14_150_17&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_150_18_150_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_18_150_22&#39;)"><span class="hl_vardecl"><span class="mpre">oaep</span></span></a><span class="mpre"> </span><a name="loc_150_23_150_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_23_150_25&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_150_26_150_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_26_150_32&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> = (</span><a href="#loc_134_1_134_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_8&#39;)"><span class="hl_varref"><span class="mpre">decrypt</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_151_12_151_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_12_151_19&#39;)"><span class="hl_varref"><span class="mpre">blinder</span></span></a><span class="mpre">) </span><a href="#loc_150_18_150_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_18_150_22&#39;)"><span class="hl_varref"><span class="mpre">oaep</span></span></a><span class="mpre"> </span><a href="#loc_150_23_150_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_23_150_25&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_150_26_150_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_26_150_32&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">, </span><a href="#loc_151_21_151_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_21_151_25&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)
    where (</span><a name="loc_151_12_151_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_12_151_19&#39;)"><span class="hl_vardecl"><span class="mpre">blinder</span></span></a><span class="mpre">, </span><a name="loc_151_21_151_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_21_151_25&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.PubKey.RSA.html#loc_91_1_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.html#loc_91_1_91_16&#39;)"><span class="hl_varref"><span class="mpre">generateBlinder</span></span></a><span class="mpre"> </span><a href="#loc_150_14_150_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_14_150_17&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_74_1_74_10&#39;)"><span class="hl_varref"><span class="mpre">private_n</span></span></a><span class="mpre"> </span><a href="#loc_150_23_150_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_23_150_25&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)
</span></div></body></html>