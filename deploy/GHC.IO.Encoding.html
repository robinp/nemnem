<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Trustworthy #-}
{-# LANGUAGE CPP, NoImplicitPrelude #-}
{-# OPTIONS_GHC -funbox-strict-fields #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  GHC.IO.Encoding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow, 2008-2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  see libraries/base/LICENSE</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  internal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Text codecs for I/O</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module GHC.IO.Encoding (
        BufferCodec(..), TextEncoding(..), TextEncoder, TextDecoder, CodingProgress(..),
        latin1, latin1_encode, latin1_decode,
        utf8, utf8_bom,
        utf16, utf16le, utf16be,
        utf32, utf32le, utf32be, 
        initLocaleEncoding,
        getLocaleEncoding, getFileSystemEncoding, getForeignEncoding,
        setLocaleEncoding, setFileSystemEncoding, setForeignEncoding,
        char8,
        mkTextEncoding,
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 8, srcSpanEndLine = 32, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 8, srcSpanEndLine = 33, srcSpanEndColumn = 24}, srcInfoPoints = []}) &quot;GHC.IO.Exception&quot;"><span class="mpre">GHC.IO.Exception</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 8, srcSpanEndLine = 34, srcSpanEndColumn = 21}, srcInfoPoints = []}) &quot;GHC.IO.Buffer&quot;"><span class="mpre">GHC.IO.Buffer</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 8, srcSpanEndLine = 35, srcSpanEndColumn = 31}, srcInfoPoints = []}) &quot;GHC.IO.Encoding.Failure&quot;"><span class="mpre">GHC.IO.Encoding.Failure</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 8, srcSpanEndLine = 36, srcSpanEndColumn = 29}, srcInfoPoints = []}) &quot;GHC.IO.Encoding.Types&quot;"><span class="mpre">GHC.IO.Encoding.Types</span></span><span class="mpre">
#if !defined(mingw32_HOST_OS)
import qualified GHC.IO.Encoding.Iconv as Iconv
#else
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 18, srcSpanEndLine = 40, srcSpanEndColumn = 42}, srcInfoPoints = []}) &quot;GHC.IO.Encoding.CodePage&quot;"><span class="mpre">GHC.IO.Encoding.CodePage</span></span><span class="mpre"> as CodePage
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 8, srcSpanEndLine = 41, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Text.Read&quot;"><span class="mpre">Text.Read</span></span><span class="mpre"> (reads)
#endif
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 18, srcSpanEndLine = 43, srcSpanEndColumn = 40}, srcInfoPoints = []}) &quot;GHC.IO.Encoding.Latin1&quot;"><span class="mpre">GHC.IO.Encoding.Latin1</span></span><span class="mpre"> as Latin1
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 18, srcSpanEndLine = 44, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;GHC.IO.Encoding.UTF8&quot;"><span class="mpre">GHC.IO.Encoding.UTF8</span></span><span class="mpre">   as UTF8
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 18, srcSpanEndLine = 45, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;GHC.IO.Encoding.UTF16&quot;"><span class="mpre">GHC.IO.Encoding.UTF16</span></span><span class="mpre">  as UTF16
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 18, srcSpanEndLine = 46, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;GHC.IO.Encoding.UTF32&quot;"><span class="mpre">GHC.IO.Encoding.UTF32</span></span><span class="mpre">  as UTF32
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 8, srcSpanEndLine = 47, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Word&quot;"><span class="mpre">GHC.Word</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 8, srcSpanEndLine = 49, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Data.IORef&quot;"><span class="mpre">Data.IORef</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 8, srcSpanEndLine = 50, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Char&quot;"><span class="mpre">Data.Char</span></span><span class="mpre"> (toUpper)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 8, srcSpanEndLine = 51, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.List&quot;"><span class="mpre">Data.List</span></span><span class="mpre">
import Data.Maybe
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 8, srcSpanEndLine = 53, srcSpanEndColumn = 24}, srcInfoPoints = []}) &quot;System.IO.Unsafe&quot;"><span class="mpre">System.IO.Unsafe</span></span><span class="mpre"> (unsafePerformIO)

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The Latin1 (ISO8859-1) encoding.  This encoding maps bytes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- directly to the first 256 Unicode code points, and is thus not a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- complete Unicode encoding.  An attempt to write a character greater than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;\255&#39; to a &#39;Handle&#39; using the &#39;latin1&#39; encoding will result in an error.</span></span><span class="mpre">
</span><a href="#loc_62_1_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_7&#39;)"><span class="mpre">latin1</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_62_1_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_7&#39;)"><span class="hl_vardecl"><span class="mpre">latin1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Latin1.latin1_checked</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The UTF-8 Unicode encoding</span></span><span class="mpre">
</span><a href="#loc_66_1_66_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_5&#39;)"><span class="mpre">utf8</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_66_1_66_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_5&#39;)"><span class="hl_vardecl"><span class="mpre">utf8</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">UTF8.utf8</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The UTF-8 Unicode encoding, with a byte-order-mark (BOM; the byte</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sequence 0xEF 0xBB 0xBF).  This encoding behaves like &#39;utf8&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- except that on input, the BOM sequence is ignored at the beginning</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of the stream, and on output, the BOM sequence is prepended.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The byte-order-mark is strictly unnecessary in UTF-8, but is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sometimes used to identify the encoding of a file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="mpre">utf8_bom</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="hl_vardecl"><span class="mpre">utf8_bom</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">UTF8.utf8_bom</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The UTF-16 Unicode encoding (a byte-order-mark should be used to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- indicate endianness).</span></span><span class="mpre">
</span><a href="#loc_82_1_82_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_6&#39;)"><span class="mpre">utf16</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_82_1_82_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_6&#39;)"><span class="hl_vardecl"><span class="mpre">utf16</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">UTF16.utf16</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The UTF-16 Unicode encoding (litte-endian)</span></span><span class="mpre">
</span><a href="#loc_86_1_86_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_8&#39;)"><span class="mpre">utf16le</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_86_1_86_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_8&#39;)"><span class="hl_vardecl"><span class="mpre">utf16le</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">UTF16.utf16le</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The UTF-16 Unicode encoding (big-endian)</span></span><span class="mpre">
</span><a href="#loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="mpre">utf16be</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="hl_vardecl"><span class="mpre">utf16be</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">UTF16.utf16be</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The UTF-32 Unicode encoding (a byte-order-mark should be used to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- indicate endianness).</span></span><span class="mpre">
</span><a href="#loc_95_1_95_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_6&#39;)"><span class="mpre">utf32</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_95_1_95_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_6&#39;)"><span class="hl_vardecl"><span class="mpre">utf32</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">UTF32.utf32</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The UTF-32 Unicode encoding (litte-endian)</span></span><span class="mpre">
</span><a href="#loc_99_1_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_8&#39;)"><span class="mpre">utf32le</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_99_1_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_8&#39;)"><span class="hl_vardecl"><span class="mpre">utf32le</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">UTF32.utf32le</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The UTF-32 Unicode encoding (big-endian)</span></span><span class="mpre">
</span><a href="#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="mpre">utf32be</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_103_1_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_8&#39;)"><span class="hl_vardecl"><span class="mpre">utf32be</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">UTF32.utf32be</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The Unicode encoding of the current locale</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Since: 4.5.0.0/</span></span><span class="mpre">
</span><a href="#loc_133_2_133_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_2_133_19&#39;)"><span class="mpre">getLocaleEncoding</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The Unicode encoding of the current locale, but allowing arbitrary</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- undecodable bytes to be round-tripped through it.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This &#39;TextEncoding&#39; is used to decode and encode command line arguments</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and environment variables on non-Windows platforms.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On Windows, this encoding *should not* be used if possible because</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the use of code pages is deprecated: Strings should be retrieved</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- via the &quot;wide&quot; W-family of UTF-16 APIs instead</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Since: 4.5.0.0/</span></span><span class="mpre">
</span><a href="#loc_134_2_134_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_2_134_23&#39;)"><span class="mpre">getFileSystemEncoding</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The Unicode encoding of the current locale, but where undecodable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bytes are replaced with their closest visual match. Used for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the &#39;CString&#39; marshalling functions in &quot;Foreign.C.String&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Since: 4.5.0.0/</span></span><span class="mpre">
</span><a href="#loc_135_2_135_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_2_135_20&#39;)"><span class="mpre">getForeignEncoding</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /Since: 4.5.0.0/</span></span><span class="mpre">
</span><a href="#loc_133_21_133_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_21_133_38&#39;)"><span class="mpre">setLocaleEncoding</span></a><span class="mpre">, </span><a href="#loc_134_25_134_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_25_134_46&#39;)"><span class="mpre">setFileSystemEncoding</span></a><span class="mpre">, </span><a href="#loc_135_22_135_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_22_135_40&#39;)"><span class="mpre">setForeignEncoding</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">

(</span><a name="loc_133_2_133_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_2_133_19&#39;)"><span class="hl_vardecl"><span class="mpre">getLocaleEncoding</span></span></a><span class="mpre">, </span><a name="loc_133_21_133_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_21_133_38&#39;)"><span class="hl_vardecl"><span class="mpre">setLocaleEncoding</span></span></a><span class="mpre">)         = </span><a href="#loc_138_1_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_9&#39;)"><span class="hl_varref"><span class="mpre">mkGlobal</span></span></a><span class="mpre"> </span><a href="#loc_156_1_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_19&#39;)"><span class="hl_varref"><span class="mpre">initLocaleEncoding</span></span></a><span class="mpre">
(</span><a name="loc_134_2_134_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_2_134_23&#39;)"><span class="hl_vardecl"><span class="mpre">getFileSystemEncoding</span></span></a><span class="mpre">, </span><a name="loc_134_25_134_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_25_134_46&#39;)"><span class="hl_vardecl"><span class="mpre">setFileSystemEncoding</span></span></a><span class="mpre">) = </span><a href="#loc_138_1_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_9&#39;)"><span class="hl_varref"><span class="mpre">mkGlobal</span></span></a><span class="mpre"> </span><a href="#loc_157_1_157_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_23&#39;)"><span class="hl_varref"><span class="mpre">initFileSystemEncoding</span></span></a><span class="mpre">
(</span><a name="loc_135_2_135_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_2_135_20&#39;)"><span class="hl_vardecl"><span class="mpre">getForeignEncoding</span></span></a><span class="mpre">, </span><a name="loc_135_22_135_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_22_135_40&#39;)"><span class="hl_vardecl"><span class="mpre">setForeignEncoding</span></span></a><span class="mpre">)       = </span><a href="#loc_138_1_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_9&#39;)"><span class="hl_varref"><span class="mpre">mkGlobal</span></span></a><span class="mpre"> </span><a href="#loc_158_1_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_20&#39;)"><span class="hl_varref"><span class="mpre">initForeignEncoding</span></span></a><span class="mpre">

</span><a href="#loc_138_1_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_9&#39;)"><span class="mpre">mkGlobal</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
</span><a name="loc_138_1_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_9&#39;)"><span class="hl_fundecl"><span class="mpre">mkGlobal</span></span></a><span class="mpre"> </span><a name="loc_138_10_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_10_138_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_139_5_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_10&#39;)"><span class="hl_vardecl"><span class="mpre">x_ref</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newIORef</span></span><span class="mpre"> </span><a href="#loc_138_10_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_10_138_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">readIORef</span></span><span class="mpre"> </span><a href="#loc_139_5_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_10&#39;)"><span class="hl_varref"><span class="mpre">x_ref</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">writeIORef</span></span><span class="mpre"> </span><a href="#loc_139_5_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_10&#39;)"><span class="hl_varref"><span class="mpre">x_ref</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | /Since: 4.5.0.0/</span></span><span class="mpre">
</span><a href="#loc_156_1_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_19&#39;)"><span class="mpre">initLocaleEncoding</span></a><span class="mpre">, </span><a href="#loc_157_1_157_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_23&#39;)"><span class="mpre">initFileSystemEncoding</span></a><span class="mpre">, </span><a href="#loc_158_1_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_20&#39;)"><span class="mpre">initForeignEncoding</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">

#if !defined(mingw32_HOST_OS)
</span><span class="hl_comment"><span class="mpre">-- It is rather important that we don&#39;t just call Iconv.mkIconvEncoding here</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- because some iconvs (in particular GNU iconv) will brokenly UTF-8 encode</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lone surrogates without complaint.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- By going through our Haskell implementations of those encodings, we are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- guaranteed to catch such errors.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- FIXME: this is not a complete solution because if the locale encoding is one</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which we don&#39;t have a Haskell-side decoder for, iconv might still ignore the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lone surrogate in the input.</span></span><span class="mpre">
</span><a name="loc_156_1_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_19&#39;)"><span class="hl_vardecl"><span class="mpre">initLocaleEncoding</span></span></a><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_239_1_239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_16&#39;)"><span class="hl_varref"><span class="mpre">mkTextEncoding&#39;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ErrorOnCodingFailure</span></span><span class="mpre"> </span><a href="GHC.IO.Encoding.Iconv.html#loc_63_1_63_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Iconv.html#loc_63_1_63_19&#39;)"><span class="hl_varref"><span class="mpre">Iconv.localeEncodingName</span></span></a><span class="mpre">
</span><a name="loc_157_1_157_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_23&#39;)"><span class="hl_vardecl"><span class="mpre">initFileSystemEncoding</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_239_1_239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_16&#39;)"><span class="hl_varref"><span class="mpre">mkTextEncoding&#39;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RoundtripFailure</span></span><span class="mpre">     </span><a href="GHC.IO.Encoding.Iconv.html#loc_63_1_63_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Iconv.html#loc_63_1_63_19&#39;)"><span class="hl_varref"><span class="mpre">Iconv.localeEncodingName</span></span></a><span class="mpre">
</span><a name="loc_158_1_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_20&#39;)"><span class="hl_vardecl"><span class="mpre">initForeignEncoding</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_239_1_239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_16&#39;)"><span class="hl_varref"><span class="mpre">mkTextEncoding&#39;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">IgnoreCodingFailure</span></span><span class="mpre">  </span><a href="GHC.IO.Encoding.Iconv.html#loc_63_1_63_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Iconv.html#loc_63_1_63_19&#39;)"><span class="hl_varref"><span class="mpre">Iconv.localeEncodingName</span></span></a><span class="mpre">
#else
</span><span class="hl_vardecl"><span class="mpre">initLocaleEncoding</span></span><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">CodePage.localeEncoding</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">initFileSystemEncoding</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">CodePage.mkLocaleEncoding</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RoundtripFailure</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">initForeignEncoding</span></span><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">CodePage.mkLocaleEncoding</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">IgnoreCodingFailure</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | An encoding in which Unicode code points are translated to bytes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by taking the code point modulo 256.  When decoding, bytes are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- translated directly into the equivalent code point.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This encoding never fails in either direction.  However, encoding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- discards information, so encode followed by decode is not the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- identity.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Since: 4.4.0.0/</span></span><span class="mpre">
</span><a href="#loc_175_1_175_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_6&#39;)"><span class="mpre">char8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_175_1_175_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_6&#39;)"><span class="hl_vardecl"><span class="mpre">char8</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Latin1.latin1</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Look up the named Unicode encoding.  May fail with </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * &#39;isDoesNotExistError&#39; if the encoding is unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The set of known encodings is system-dependent, but includes at least:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * @UTF-8@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * @UTF-16@, @UTF-16BE@, @UTF-16LE@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * @UTF-32@, @UTF-32BE@, @UTF-32LE@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- There is additional notation (borrowed from GNU iconv) for specifying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- how illegal characters are handled:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * a suffix of @\/\/IGNORE@, e.g. @UTF-8\/\/IGNORE@, will cause </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    all illegal sequences on input to be ignored, and on output</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    will drop all code points that have no representation in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    target encoding.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * a suffix of @\/\/TRANSLIT@ will choose a replacement character</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    for illegal sequences or code points.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * a suffix of @\/\/ROUNDTRIP@ will use a PEP383-style escape mechanism</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    to represent any invalid bytes in the input as Unicode codepoints (specifically,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    as lone surrogates, which are normally invalid in UTF-32).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    Upon output, these special codepoints are detected and turned back into the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    corresponding original byte.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    In theory, this mechanism allows arbitrary data to be roundtripped via</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    a &#39;String&#39; with no loss of data. In practice, there are two limitations</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    to be aware of:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      1. This only stands a chance of working for an encoding which is an ASCII</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         superset, as for security reasons we refuse to escape any bytes smaller</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         than 128. Many encodings of interest are ASCII supersets (in particular,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         you can assume that the locale encoding is an ASCII superset) but many</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         (such as UTF-16) are not.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      2. If the underlying encoding is not itself roundtrippable, this mechanism</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         can fail. Roundtrippable encodings are those which have an injective mapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         into Unicode. Almost all encodings meet this criteria, but some do not. Notably,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         Shift-JIS (CP932) and Big5 contain several different encodings of the same</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         Unicode codepoint.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On Windows, you can access supported code pages with the prefix</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @CP@; for example, @\&quot;CP1250\&quot;@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_226_1_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_15&#39;)"><span class="mpre">mkTextEncoding</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_226_1_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_15&#39;)"><span class="hl_fundecl"><span class="mpre">mkTextEncoding</span></span></a><span class="mpre"> </span><a name="loc_226_16_226_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_16_226_17&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = case </span><a href="#loc_231_5_231_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_5_231_27&#39;)"><span class="hl_varref"><span class="mpre">mb_coding_failure_mode</span></span></a><span class="mpre"> of
    </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_263_1_263_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_19&#39;)"><span class="hl_varref"><span class="mpre">unknownEncodingErr</span></span></a><span class="mpre"> </span><a href="#loc_226_16_226_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_16_226_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
    </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_228_10_228_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_10_228_13&#39;)"><span class="hl_vardecl"><span class="mpre">cfm</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_239_1_239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_16&#39;)"><span class="hl_varref"><span class="mpre">mkTextEncoding&#39;</span></span></a><span class="mpre"> </span><a href="#loc_228_10_228_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_10_228_13&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre"> </span><a href="#loc_230_6_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_6_230_9&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">
  where
    (</span><a name="loc_230_6_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_6_230_9&#39;)"><span class="hl_vardecl"><span class="mpre">enc</span></span></a><span class="mpre">, </span><a name="loc_230_11_230_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_11_230_17&#39;)"><span class="hl_vardecl"><span class="mpre">suffix</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">) </span><a href="#loc_226_16_226_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_16_226_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
    </span><a name="loc_231_5_231_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_5_231_27&#39;)"><span class="hl_vardecl"><span class="mpre">mb_coding_failure_mode</span></span></a><span class="mpre"> = case </span><a href="#loc_230_11_230_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_11_230_17&#39;)"><span class="hl_varref"><span class="mpre">suffix</span></span></a><span class="mpre"> of
        </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">            -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ErrorOnCodingFailure</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;//IGNORE&quot;</span></span><span class="mpre">    -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">IgnoreCodingFailure</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;//TRANSLIT&quot;</span></span><span class="mpre">  -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TransliterateCodingFailure</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;//ROUNDTRIP&quot;</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">RoundtripFailure</span></span><span class="mpre">
        _             -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

</span><a href="#loc_239_1_239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_16&#39;)"><span class="mpre">mkTextEncoding&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span><span class="mpre">
</span><a name="loc_239_1_239_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_16&#39;)"><span class="hl_fundecl"><span class="mpre">mkTextEncoding&#39;</span></span></a><span class="mpre"> </span><a name="loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_vardecl"><span class="mpre">cfm</span></span></a><span class="mpre"> </span><a name="loc_239_21_239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_21_239_24&#39;)"><span class="hl_vardecl"><span class="mpre">enc</span></span></a><span class="mpre"> = case [</span><span class="hl_varref"><span class="mpre">toUpper</span></span><span class="mpre"> </span><a href="#loc_239_45_239_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_45_239_46&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> | </span><a name="loc_239_45_239_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_45_239_46&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_239_21_239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_21_239_24&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">, </span><a href="#loc_239_45_239_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_45_239_46&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre">] of
    </span><span class="hl_string"><span class="mpre">&quot;UTF8&quot;</span></span><span class="mpre">    -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">UTF8.mkUTF8</span></span><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre">
    </span><span class="hl_string"><span class="mpre">&quot;UTF16&quot;</span></span><span class="mpre">   -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">UTF16.mkUTF16</span></span><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre">
    </span><span class="hl_string"><span class="mpre">&quot;UTF16LE&quot;</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">UTF16.mkUTF16le</span></span><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre">
    </span><span class="hl_string"><span class="mpre">&quot;UTF16BE&quot;</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">UTF16.mkUTF16be</span></span><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre">
    </span><span class="hl_string"><span class="mpre">&quot;UTF32&quot;</span></span><span class="mpre">   -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">UTF32.mkUTF32</span></span><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre">
    </span><span class="hl_string"><span class="mpre">&quot;UTF32LE&quot;</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">UTF32.mkUTF32le</span></span><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre">
    </span><span class="hl_string"><span class="mpre">&quot;UTF32BE&quot;</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">UTF32.mkUTF32be</span></span><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre">
#if defined(mingw32_HOST_OS)
    </span><span class="hl_char"><span class="mpre">&#39;C&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;P&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_248_13_248_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_13_248_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> | [(</span><a name="loc_248_19_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_19_248_21&#39;)"><span class="hl_vardecl"><span class="mpre">cp</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] &lt;- </span><span class="hl_varref"><span class="mpre">reads</span></span><span class="mpre"> </span><a href="#loc_248_13_248_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_13_248_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">CodePage.mkCodePageEncoding</span></span><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre"> </span><a href="#loc_248_19_248_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_19_248_21&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre">
    _ -&gt; </span><a href="#loc_263_1_263_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_19&#39;)"><span class="hl_varref"><span class="mpre">unknownEncodingErr</span></span></a><span class="mpre"> (</span><a href="#loc_239_21_239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_21_239_24&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">codingFailureModeSuffix</span></span><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre">)
#else
    _ -&gt; </span><a href="GHC.IO.Encoding.Iconv.html#loc_103_1_103_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Iconv.html#loc_103_1_103_16&#39;)"><span class="hl_varref"><span class="mpre">Iconv.mkIconvEncoding</span></span></a><span class="mpre"> </span><a href="#loc_239_17_239_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_17_239_20&#39;)"><span class="hl_varref"><span class="mpre">cfm</span></span></a><span class="mpre"> </span><a href="#loc_239_21_239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_21_239_24&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">
#endif

</span><a href="#loc_255_1_255_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_14&#39;)"><span class="mpre">latin1_encode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CharBuffer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">CharBuffer</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
</span><a name="loc_255_1_255_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_14&#39;)"><span class="hl_fundecl"><span class="mpre">latin1_encode</span></span></a><span class="mpre"> </span><a name="loc_255_15_255_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_15_255_20&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> </span><a name="loc_255_21_255_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_21_255_27&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\(</span><span class="hl_vardecl"><span class="mpre">_why</span></span><span class="mpre">,</span><a name="loc_255_43_255_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_43_255_49&#39;)"><span class="hl_vardecl"><span class="mpre">input&#39;</span></span></a><span class="mpre">,</span><a name="loc_255_50_255_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_50_255_57&#39;)"><span class="hl_vardecl"><span class="mpre">output&#39;</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_255_43_255_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_43_255_49&#39;)"><span class="hl_varref"><span class="mpre">input&#39;</span></span></a><span class="mpre">,</span><a href="#loc_255_50_255_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_50_255_57&#39;)"><span class="hl_varref"><span class="mpre">output&#39;</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Latin1.latin1_encode</span></span><span class="mpre"> </span><a href="#loc_255_15_255_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_15_255_20&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><a href="#loc_255_21_255_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_21_255_27&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- unchecked, used for char8</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--latin1_encode = unsafePerformIO $ do mkTextEncoder Iconv.latin1 &gt;&gt;= return.encode</span></span><span class="mpre">

</span><a href="#loc_259_1_259_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_1_259_14&#39;)"><span class="mpre">latin1_decode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CharBuffer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">CharBuffer</span></span><span class="mpre">)
</span><a name="loc_259_1_259_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_1_259_14&#39;)"><span class="hl_fundecl"><span class="mpre">latin1_decode</span></span></a><span class="mpre"> </span><a name="loc_259_15_259_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_15_259_20&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> </span><a name="loc_259_21_259_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_21_259_27&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\(</span><span class="hl_vardecl"><span class="mpre">_why</span></span><span class="mpre">,</span><a name="loc_259_43_259_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_43_259_49&#39;)"><span class="hl_vardecl"><span class="mpre">input&#39;</span></span></a><span class="mpre">,</span><a name="loc_259_50_259_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_50_259_57&#39;)"><span class="hl_vardecl"><span class="mpre">output&#39;</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_259_43_259_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_43_259_49&#39;)"><span class="hl_varref"><span class="mpre">input&#39;</span></span></a><span class="mpre">,</span><a href="#loc_259_50_259_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_50_259_57&#39;)"><span class="hl_varref"><span class="mpre">output&#39;</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Latin1.latin1_decode</span></span><span class="mpre"> </span><a href="#loc_259_15_259_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_15_259_20&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><a href="#loc_259_21_259_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_21_259_27&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--latin1_decode = unsafePerformIO $ do mkTextDecoder Iconv.latin1 &gt;&gt;= return.encode</span></span><span class="mpre">

</span><a href="#loc_263_1_263_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_19&#39;)"><span class="mpre">unknownEncodingErr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">    
</span><a name="loc_263_1_263_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_19&#39;)"><span class="hl_fundecl"><span class="mpre">unknownEncodingErr</span></span></a><span class="mpre"> </span><a name="loc_263_20_263_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_20_263_21&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">ioException</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">IOError</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">NoSuchThing</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mkTextEncoding&quot;</span></span><span class="mpre">
                                            (</span><span class="hl_string"><span class="mpre">&quot;unknown encoding:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_263_20_263_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_20_263_21&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)  </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
</span></div></body></html>