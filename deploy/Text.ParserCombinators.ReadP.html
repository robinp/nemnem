<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Trustworthy #-}
{-# LANGUAGE NoImplicitPrelude #-}
{-# LANGUAGE RankNTypes #-}
{-# LANGUAGE MagicHash #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Text.ParserCombinators.ReadP</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow 2002</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (local universal quantification)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a library of parser combinators, originally written by Koen Claessen.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It parses all alternatives in parallel, so it never keeps hold of </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the beginning of the input string, a common source of space leaks with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- other parsers.  The &#39;(+++)&#39; choice combinator is genuinely commutative;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it makes no difference which branch is \&quot;shorter\&quot;.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Text.ParserCombinators.ReadP
  ( 
  </span><span class="hl_comment"><span class="mpre">-- * The &#39;ReadP&#39; type</span></span><span class="mpre">
  ReadP,
  
  </span><span class="hl_comment"><span class="mpre">-- * Primitive operations</span></span><span class="mpre">
  get,
  look,
  (+++),
  (&lt;++),
  gather,
  
  </span><span class="hl_comment"><span class="mpre">-- * Other operations</span></span><span class="mpre">
  pfail,
  eof,
  satisfy,
  char,
  string,
  munch,
  munch1,
  skipSpaces,
  choice,
  count,
  between,
  option,
  optional,
  many,
  many1,
  skipMany,
  skipMany1,
  sepBy,
  sepBy1,
  endBy,
  endBy1,
  chainr,
  chainl,
  chainl1,
  chainr1,
  manyTill,
  
  </span><span class="hl_comment"><span class="mpre">-- * Running a parser</span></span><span class="mpre">
  ReadS,
  readP_to_S,
  readS_to_P,
  
  </span><span class="hl_comment"><span class="mpre">-- * Properties</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- $properties</span></span><span class="mpre">
  )
 where

import Control.Monad( </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="mpre">MonadPlus</span></a><span class="mpre">(..), </span><a href="Control.Monad.html#loc_98_1_98_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_98_1_98_9&#39;)"><span class="mpre">sequence</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="mpre">liftM2</span></a><span class="mpre"> )

import {-# SOURCE #-} GHC.Unicode ( </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="mpre">isSpace</span></a><span class="mpre">  )
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Text/ParserCombinators/ReadP.hs&quot;, srcSpanStartLine = 77, srcSpanStartColumn = 8, srcSpanEndLine = 77, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.List&quot;"><span class="mpre">GHC.List</span></span><span class="mpre"> ( replicate, null )
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Text/ParserCombinators/ReadP.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 8, srcSpanEndLine = 78, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Text/ParserCombinators/ReadP.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 1, srcSpanEndLine = 80, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Text/ParserCombinators/ReadP.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 8, srcSpanEndLine = 80, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Text/ParserCombinators/R"><span class="mpre">infixr 5 +++, &lt;++</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ReadS</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A parser for a type @a@, represented as a function that takes a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;String&#39; and returns a list of possible parses as @(a,&#39;String&#39;)@ pairs.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that this kind of backtracking parser is very inefficient;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- reading a large structure may be quite slow (cf &#39;ReadP&#39;).</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Text/ParserCombinators/ReadP.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 1, srcSpanEndLine = 90, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Text/ParserCombinators/ReadP.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 1, srcSpanEndLine = 90, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Text/ParserCombinators/Re"><span class="mpre">type ReadS a = String -&gt; [(a,String)]</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The P type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is representation type -- should be kept abstract</span></span><span class="mpre">

data </span><a name="loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tycondecl"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  = </span><a name="loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_condecl"><span class="mpre">Get</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  | </span><a name="loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_condecl"><span class="mpre">Look</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  | </span><a name="loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_condecl"><span class="mpre">Fail</span></span></a><span class="mpre">
  | </span><a name="loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_condecl"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  | </span><a name="loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_condecl"><span class="mpre">Final</span></span></a><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] </span><span class="hl_comment"><span class="mpre">-- invariant: list is non-empty!</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Monad, MonadPlus</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_106_10_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_10_106_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="#loc_106_10_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_10_106_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">

  (</span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_108_8_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_8_108_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)      </span><a name="loc_108_16_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_16_108_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_108_20_108_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> (\</span><a name="loc_108_30_108_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_30_108_31&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_108_8_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_8_108_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_108_30_108_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_30_108_31&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_108_20_108_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
  (</span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_109_9_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)     </span><a href="#loc_108_16_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_16_108_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_109_31_109_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_31_109_32&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_109_9_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_109_31_109_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_31_109_32&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
  </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">         </span><a href="#loc_108_16_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_16_108_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> _ = </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">
  (</span><a href="#loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_111_13_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_13_111_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="#loc_108_16_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_16_108_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_111_20_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_20_111_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_111_20_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_20_111_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> (</span><a href="#loc_111_13_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_13_111_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_111_20_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_20_111_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
  (</span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_112_10_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_10_112_11&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)    </span><a href="#loc_108_16_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_16_108_19&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_112_20_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_169_1_169_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_6&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre"> [</span><a href="#loc_112_49_112_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_49_112_52&#39;)"><span class="hl_varref"><span class="mpre">ys&#39;</span></span></a><span class="mpre"> | (</span><a name="loc_112_38_112_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_38_112_39&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_112_40_112_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_40_112_41&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_112_10_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_10_112_11&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">, </span><a name="loc_112_49_112_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_49_112_52&#39;)"><span class="hl_vardecl"><span class="mpre">ys&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_112_20_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_112_38_112_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_38_112_39&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_112_40_112_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_40_112_41&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">]

  </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> _ = </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">

instance </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="hl_classref"><span class="mpre">MonadPlus</span></span></a><span class="mpre"> </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> where
  </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">mzero</span></span></a><span class="mpre"> = </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- most common case: two gets are combined</span></span><span class="mpre">
  </span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_120_7_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_7_120_9&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre">     </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_120_26_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_26_120_28&#39;)"><span class="hl_vardecl"><span class="mpre">f2</span></span></a><span class="mpre">     = </span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> (\</span><a name="loc_120_41_120_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_41_120_42&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_120_7_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_7_120_9&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a href="#loc_120_41_120_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_41_120_42&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_120_26_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_26_120_28&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a href="#loc_120_41_120_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_41_120_42&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
  
  </span><span class="hl_comment"><span class="mpre">-- results are delivered as soon as possible</span></span><span class="mpre">
  </span><a href="#loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_123_10_123_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_10_123_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_123_12_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_12_123_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_123_22_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_22_123_23&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">          = </span><a href="#loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="#loc_123_10_123_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_10_123_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_123_12_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_12_123_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_123_22_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_22_123_23&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">)
  </span><a name="loc_124_3_124_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_3_124_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_124_29_124_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_29_124_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_124_31_124_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_31_124_32&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="#loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="#loc_124_29_124_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_29_124_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_124_3_124_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_3_124_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_124_31_124_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_31_124_32&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- fail disappears</span></span><span class="mpre">
  </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">       </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_127_22_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_22_127_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          = </span><a href="#loc_127_22_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_22_127_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
  </span><a name="loc_128_3_128_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_3_128_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">       = </span><a href="#loc_128_3_128_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_3_128_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- two finals are combined</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- final + look becomes one look and one final (=optimization)</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- final + sthg else becomes one look and one final</span></span><span class="mpre">
  </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_133_9_133_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_133_28_133_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_28_133_29&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">    = </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_133_9_133_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_133_28_133_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_28_133_29&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
  </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_134_9_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_134_27_134_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_27_134_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     = </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_134_42_134_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_42_134_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_134_9_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_134_27_134_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_27_134_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_134_42_134_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_42_134_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_134_42_134_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_42_134_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))
  </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_135_9_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_135_22_135_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_22_135_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          = </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_135_42_135_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_42_135_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_135_9_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_135_22_135_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_22_135_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_135_42_135_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_42_135_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))
  </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_136_8_136_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_8_136_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_136_28_136_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_28_136_29&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    = </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_136_42_136_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_42_136_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_136_8_136_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_8_136_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_136_42_136_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_42_136_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_136_42_136_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_42_136_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_136_28_136_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_28_136_29&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">))
  </span><a name="loc_137_3_137_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_3_137_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_137_28_137_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_28_137_29&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">    = </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_137_42_137_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_42_137_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> (</span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_137_3_137_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_3_137_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_137_42_137_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_42_137_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_137_28_137_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_28_137_29&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">))

  </span><span class="hl_comment"><span class="mpre">-- two looks are combined (=optimization)</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- look + sthg else floats upwards</span></span><span class="mpre">
  </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_141_8_141_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_141_27_141_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_27_141_28&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">     = </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_141_42_141_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_42_141_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_141_8_141_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_141_42_141_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_42_141_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_141_27_141_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_27_141_28&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_141_42_141_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_42_141_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
  </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_142_8_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_8_142_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_142_22_142_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_22_142_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          = </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_142_42_142_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_42_142_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_142_8_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_8_142_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_142_42_142_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_42_142_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_142_22_142_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_22_142_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
  </span><a name="loc_143_3_143_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_3_143_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">          </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_143_27_143_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_27_143_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     = </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_143_42_143_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_42_143_43&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_143_3_143_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_3_143_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_143_27_143_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_27_143_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_143_42_143_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_42_143_43&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The ReadP type</span></span><span class="mpre">

newtype </span><a name="loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tycondecl"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_condecl"><span class="mpre">R</span></span></a><span class="mpre"> (forall </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> . (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Functor, Monad, MonadPlus</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_153_8_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_8_153_9&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_153_13_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_13_153_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_153_22_153_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_22_153_23&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_153_13_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_13_153_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_153_22_153_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_22_153_23&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_153_8_153_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_8_153_9&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">))

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_156_10_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_10_156_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_156_19_156_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_19_156_20&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_156_19_156_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_19_156_20&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_156_10_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_10_156_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
  </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> _    = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\_ -&gt; </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">)
  </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_158_5_158_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_5_158_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_158_11_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_11_158_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_158_19_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_19_158_20&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_158_5_158_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_5_158_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (\</span><a name="loc_158_28_158_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_28_158_29&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; let </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_158_39_158_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_39_158_41&#39;)"><span class="hl_vardecl"><span class="mpre">m&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_158_11_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_11_158_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_158_28_158_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_28_158_29&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> in </span><a href="#loc_158_39_158_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_39_158_41&#39;)"><span class="hl_varref"><span class="mpre">m&#39;</span></span></a><span class="mpre"> </span><a href="#loc_158_19_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_19_158_20&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">))

instance </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="hl_classref"><span class="mpre">MonadPlus</span></span></a><span class="mpre"> </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> where
  </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">mzero</span></span></a><span class="mpre"> = </span><a href="#loc_194_1_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre">
  </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_vardecl"><span class="mpre">mplus</span></span></a><span class="mpre"> = </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_varref"><span class="mpre">(+++)</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Operations over P</span></span><span class="mpre">

</span><a href="#loc_169_1_169_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_6&#39;)"><span class="mpre">final</span></a><span class="mpre"> :: [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintains invariant for Final constructor</span></span><span class="mpre">
</span><a name="loc_169_1_169_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_6&#39;)"><span class="hl_fundecl"><span class="mpre">final</span></span></a><span class="mpre"> [] = </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">
</span><a href="#loc_169_1_169_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_6&#39;)"><span class="hl_fundecl"><span class="mpre">final</span></span></a><span class="mpre"> </span><a name="loc_170_7_170_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_7_170_8&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">  = </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a href="#loc_170_7_170_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_7_170_8&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="mpre">run</span></a><span class="mpre"> :: </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_173_10_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_10_173_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)      (</span><a name="loc_173_19_173_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_19_173_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_173_21_173_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_21_173_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_173_10_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_10_173_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_173_19_173_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_19_173_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_173_21_173_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_21_173_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_174_11_174_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_11_174_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)     </span><a name="loc_174_18_174_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_18_174_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">     = </span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_174_11_174_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_11_174_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_174_18_174_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_18_174_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_174_18_174_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_18_174_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_175_13_175_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_175_15_175_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_15_175_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a name="loc_175_18_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_18_175_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">     = (</span><a href="#loc_175_13_175_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_175_18_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_18_175_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_175_15_175_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_15_175_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_175_18_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_18_175_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_176_12_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_12_176_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)    _     = </span><a href="#loc_176_12_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_12_176_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> _            _     = []

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Operations over ReadP</span></span><span class="mpre">

</span><a href="#loc_185_1_185_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_4&#39;)"><span class="mpre">get</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Consumes and returns the next character.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Fails if there is no input left.</span></span><span class="mpre">
</span><a name="loc_185_1_185_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_4&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre">

</span><a href="#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="mpre">look</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Look-ahead: returns the part of the input that is left, without</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   consuming it.</span></span><span class="mpre">
</span><a name="loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="hl_vardecl"><span class="mpre">look</span></span></a><span class="mpre"> = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre">

</span><a href="#loc_194_1_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_6&#39;)"><span class="mpre">pfail</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Always fails.</span></span><span class="mpre">
</span><a name="loc_194_1_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_6&#39;)"><span class="hl_vardecl"><span class="mpre">pfail</span></span></a><span class="mpre"> = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\_ -&gt; </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">)

</span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="mpre">(+++)</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Symmetric choice.</span></span><span class="mpre">
</span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_198_3_198_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_3_198_5&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a name="loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_fundecl"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_198_12_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_12_198_14&#39;)"><span class="hl_vardecl"><span class="mpre">f2</span></span></a><span class="mpre"> = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_198_21_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_22&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_198_3_198_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_3_198_5&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a href="#loc_198_21_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_198_12_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_12_198_14&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a href="#loc_198_21_198_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)

</span><a href="#loc_204_6_204_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_6_204_9&#39;)"><span class="mpre">(&lt;++)</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Local, exclusive, left-biased choice: If left parser</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   locally produces any result at all, then right parser is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   not used.</span></span><span class="mpre">
</span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_204_3_204_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_3_204_5&#39;)"><span class="hl_vardecl"><span class="mpre">f0</span></span></a><span class="mpre"> </span><a name="loc_204_6_204_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_6_204_9&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a name="loc_204_10_204_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_10_204_11&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> =
  do </span><a name="loc_205_6_205_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_6_205_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre">
     </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_varref"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_204_3_204_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_3_204_5&#39;)"><span class="hl_varref"><span class="mpre">f0</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">) </span><a href="#loc_205_6_205_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_6_205_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> 0#
 where
  </span><a name="loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_208_14_208_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_14_208_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)        (</span><a name="loc_208_25_208_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_25_208_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_208_27_208_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_27_208_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_208_30_208_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_30_208_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_varref"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_208_14_208_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_14_208_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_208_25_208_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_25_208_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_208_27_208_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_27_208_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_208_30_208_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_30_208_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+#</span></span><span class="mpre">1#)
  </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_209_15_209_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_15_209_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)       </span><a name="loc_209_24_209_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_24_209_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">     </span><a name="loc_209_30_209_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_30_209_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_varref"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_209_15_209_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_15_209_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_209_24_209_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_24_209_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_209_24_209_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_24_209_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_209_30_209_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_30_209_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
  </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> </span><a name="loc_210_9_210_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_9_210_10&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a href="#loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> _ _) _     </span><a name="loc_210_30_210_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_30_210_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_214_3_214_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_3_214_10&#39;)"><span class="hl_varref"><span class="mpre">discard</span></span></a><span class="mpre"> </span><a href="#loc_210_30_210_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_30_210_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_210_9_210_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_9_210_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">)
  </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> (</span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a name="loc_211_16_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_16_211_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)      _     _ = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> </span><a href="#loc_211_16_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_16_211_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">)
  </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_fundecl"><span class="mpre">probe</span></span></a><span class="mpre"> _              _     _ = </span><a href="#loc_204_10_204_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_10_204_11&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

  </span><a name="loc_214_3_214_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_3_214_10&#39;)"><span class="hl_fundecl"><span class="mpre">discard</span></span></a><span class="mpre"> 0# = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
  </span><a href="#loc_214_3_214_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_3_214_10&#39;)"><span class="hl_fundecl"><span class="mpre">discard</span></span></a><span class="mpre"> </span><a name="loc_215_11_215_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_11_215_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">  = </span><a href="#loc_185_1_185_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_214_3_214_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_3_214_10&#39;)"><span class="hl_varref"><span class="mpre">discard</span></span></a><span class="mpre"> (</span><a href="#loc_215_11_215_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_11_215_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre">1#)

</span><a href="#loc_222_1_222_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_7&#39;)"><span class="mpre">gather</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">-- ^ Transforms a parser into one that does the same, but</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   in addition returns the exact characters read.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   IMPORTANT NOTE: &#39;gather&#39; gives a runtime error if its first argument</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   is built using any occurrences of readS_to_P. </span></span><span class="mpre">
</span><a name="loc_222_1_222_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_7&#39;)"><span class="hl_fundecl"><span class="mpre">gather</span></span></a><span class="mpre"> (</span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_222_11_222_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_11_222_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">)
  = </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_223_9_223_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_9_223_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="hl_varref"><span class="mpre">gath</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> (</span><a href="#loc_222_11_222_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_11_222_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (\</span><a name="loc_223_27_223_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_27_223_28&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (\</span><a name="loc_223_41_223_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_41_223_42&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_223_9_223_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_9_223_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_223_41_223_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_41_223_42&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_223_27_223_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_27_223_28&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)))))  
 where
  </span><a href="#loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="mpre">gath</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_96_6_96_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_7&#39;)"><span class="hl_tyconref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
  </span><a name="loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a name="loc_226_8_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_8_226_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a name="loc_226_15_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_15_226_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)      = </span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_conref"><span class="mpre">Get</span></span></a><span class="mpre"> (\</span><a name="loc_226_31_226_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_31_226_32&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="hl_varref"><span class="mpre">gath</span></span></a><span class="mpre"> (</span><a href="#loc_226_8_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_8_226_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">(</span><a href="#loc_226_31_226_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_31_226_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) (</span><a href="#loc_226_15_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_15_226_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_226_31_226_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_31_226_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">))
  </span><a href="#loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> _ </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">         = </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">
  </span><a href="#loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a name="loc_228_8_228_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> </span><a name="loc_228_16_228_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_16_228_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)     = </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_228_32_228_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_32_228_33&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="hl_varref"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a href="#loc_228_8_228_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_228_16_228_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_16_228_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_228_32_228_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_32_228_33&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))
  </span><a href="#loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a name="loc_229_8_229_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_8_229_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_100_5_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_11&#39;)"><span class="hl_conref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a name="loc_229_18_229_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_18_229_19&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_229_20_229_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_20_229_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_229_18_229_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_18_229_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_229_8_229_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_8_229_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> []) </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="hl_varref"><span class="mpre">gath</span></span></a><span class="mpre"> </span><a href="#loc_229_8_229_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_8_229_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_229_20_229_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_20_229_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
  </span><a href="#loc_226_3_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_7&#39;)"><span class="hl_fundecl"><span class="mpre">gath</span></span></a><span class="mpre"> _ (</span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_conref"><span class="mpre">Final</span></span></a><span class="mpre"> _)    = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;do not use readS_to_P in gather!&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Derived operations</span></span><span class="mpre">

</span><a href="#loc_238_1_238_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_8&#39;)"><span class="mpre">satisfy</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Consumes and returns the next character, if it satisfies the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   specified predicate.</span></span><span class="mpre">
</span><a name="loc_238_1_238_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_8&#39;)"><span class="hl_fundecl"><span class="mpre">satisfy</span></span></a><span class="mpre"> </span><a name="loc_238_9_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do </span><a name="loc_238_16_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_185_1_185_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">; if </span><a href="#loc_238_9_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_9_238_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_238_16_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_238_16_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> else </span><a href="#loc_194_1_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre">

</span><a href="#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_5&#39;)"><span class="mpre">char</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Parses and returns the specified character.</span></span><span class="mpre">
</span><a name="loc_242_1_242_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_5&#39;)"><span class="hl_fundecl"><span class="mpre">char</span></span></a><span class="mpre"> </span><a name="loc_242_6_242_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_6_242_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_238_1_238_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_8&#39;)"><span class="hl_varref"><span class="mpre">satisfy</span></span></a><span class="mpre"> (</span><a href="#loc_242_6_242_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_6_242_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre">)

</span><a href="#loc_246_1_246_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_4&#39;)"><span class="mpre">eof</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Succeeds iff we are at the end of input</span></span><span class="mpre">
</span><a name="loc_246_1_246_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_4&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre"> = do { </span><a name="loc_246_12_246_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_12_246_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre"> 
         ; if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_246_12_246_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_12_246_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> 
                     else </span><a href="#loc_194_1_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre"> }

</span><a href="#loc_252_1_252_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_1_252_7&#39;)"><span class="mpre">string</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Parses and returns the specified string.</span></span><span class="mpre">
</span><a name="loc_252_1_252_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_1_252_7&#39;)"><span class="hl_fundecl"><span class="mpre">string</span></span></a><span class="mpre"> </span><a name="loc_252_8_252_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_8_252_12&#39;)"><span class="hl_vardecl"><span class="mpre">this</span></span></a><span class="mpre"> = do </span><a name="loc_252_18_252_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_18_252_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre">; </span><a href="#loc_254_3_254_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_3_254_7&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_252_8_252_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_8_252_12&#39;)"><span class="hl_varref"><span class="mpre">this</span></span></a><span class="mpre"> </span><a href="#loc_252_18_252_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_18_252_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
 where
  </span><a name="loc_254_3_254_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_3_254_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> []     _               = do </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_252_8_252_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_8_252_12&#39;)"><span class="hl_varref"><span class="mpre">this</span></span></a><span class="mpre">
  </span><a href="#loc_254_3_254_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_3_254_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> (</span><a name="loc_255_9_255_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_9_255_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_255_11_255_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_11_255_13&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) (</span><a name="loc_255_16_255_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_16_255_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_255_18_255_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_18_255_20&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) | </span><a href="#loc_255_9_255_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_9_255_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_255_16_255_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_16_255_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> = do _ &lt;- </span><a href="#loc_185_1_185_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">; </span><a href="#loc_254_3_254_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_3_254_7&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_255_11_255_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_11_255_13&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_255_18_255_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_18_255_20&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
  </span><a href="#loc_254_3_254_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_3_254_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> _      _               = do </span><a href="#loc_194_1_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre">

</span><a href="#loc_262_1_262_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_6&#39;)"><span class="mpre">munch</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Parses the first zero or more characters satisfying the predicate.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Always succeds, exactly once having consumed all the characters</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Hence NOT the same as (many (satisfy p))</span></span><span class="mpre">
</span><a name="loc_262_1_262_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_6&#39;)"><span class="hl_fundecl"><span class="mpre">munch</span></span></a><span class="mpre"> </span><a name="loc_262_7_262_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_7_262_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> =
  do </span><a name="loc_263_6_263_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_6_263_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre">
     </span><a href="#loc_266_3_266_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_3_266_7&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_263_6_263_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_6_263_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
 where
  </span><a name="loc_266_3_266_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_3_266_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> (</span><a name="loc_266_9_266_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_9_266_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_266_11_266_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_11_266_13&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) | </span><a href="#loc_262_7_262_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_7_262_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_266_9_266_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_9_266_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = do _ &lt;- </span><a href="#loc_185_1_185_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">; </span><a name="loc_266_36_266_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_36_266_37&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_266_3_266_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_3_266_7&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_266_11_266_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_11_266_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_266_9_266_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_9_266_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_266_36_266_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_36_266_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
  </span><a href="#loc_266_3_266_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_3_266_7&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> _            = do </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><a href="#loc_273_1_273_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_7&#39;)"><span class="mpre">munch1</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Parses the first one or more characters satisfying the predicate.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Fails if none, else succeeds exactly once having consumed all the characters</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Hence NOT the same as (many1 (satisfy p))</span></span><span class="mpre">
</span><a name="loc_273_1_273_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_7&#39;)"><span class="hl_fundecl"><span class="mpre">munch1</span></span></a><span class="mpre"> </span><a name="loc_273_8_273_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_8_273_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> =
  do </span><a name="loc_274_6_274_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_6_274_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_185_1_185_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">
     if </span><a href="#loc_273_8_273_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_8_273_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_274_6_274_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_6_274_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> then do </span><a name="loc_275_21_275_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_21_275_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_262_1_262_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_6&#39;)"><span class="hl_varref"><span class="mpre">munch</span></span></a><span class="mpre"> </span><a href="#loc_273_8_273_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_8_273_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_274_6_274_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_6_274_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_275_21_275_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_21_275_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
            else </span><a href="#loc_194_1_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre">

</span><a href="#loc_280_1_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_7&#39;)"><span class="mpre">choice</span></a><span class="mpre"> :: [</span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Combines all parsers in the specified list.</span></span><span class="mpre">
</span><a name="loc_280_1_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_7&#39;)"><span class="hl_fundecl"><span class="mpre">choice</span></span></a><span class="mpre"> []     = </span><a href="#loc_194_1_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre">
</span><a href="#loc_280_1_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_7&#39;)"><span class="hl_fundecl"><span class="mpre">choice</span></span></a><span class="mpre"> [</span><a name="loc_281_9_281_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_9_281_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">]    = </span><a href="#loc_281_9_281_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_9_281_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><a href="#loc_280_1_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_7&#39;)"><span class="hl_fundecl"><span class="mpre">choice</span></span></a><span class="mpre"> (</span><a name="loc_282_9_282_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_282_11_282_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_11_282_13&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) = </span><a href="#loc_282_9_282_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_280_1_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_7&#39;)"><span class="hl_varref"><span class="mpre">choice</span></span></a><span class="mpre"> </span><a href="#loc_282_11_282_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_11_282_13&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">

</span><a href="#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_1_286_11&#39;)"><span class="mpre">skipSpaces</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Skips all whitespace.</span></span><span class="mpre">
</span><a name="loc_286_1_286_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_1_286_11&#39;)"><span class="hl_vardecl"><span class="mpre">skipSpaces</span></span></a><span class="mpre"> =
  do </span><a name="loc_287_6_287_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_6_287_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_190_1_190_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_5&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre">
     </span><a href="#loc_290_3_290_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_3_290_7&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_287_6_287_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_6_287_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
 where
  </span><a name="loc_290_3_290_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_3_290_7&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> (</span><a name="loc_290_9_290_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_290_11_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_11_290_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) | </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_290_9_290_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = do _ &lt;- </span><a href="#loc_185_1_185_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">; </span><a href="#loc_290_3_290_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_3_290_7&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_290_11_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_11_290_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  </span><a href="#loc_290_3_290_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_3_290_7&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> _                 = do </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_296_1_296_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_6&#39;)"><span class="mpre">count</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @count n p@ parses @n@ occurrences of @p@ in sequence. A list of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   results is returned.</span></span><span class="mpre">
</span><a name="loc_296_1_296_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_6&#39;)"><span class="hl_fundecl"><span class="mpre">count</span></span></a><span class="mpre"> </span><a name="loc_296_7_296_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_7_296_8&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_296_9_296_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_9_296_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_98_1_98_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_98_1_98_9&#39;)"><span class="hl_varref"><span class="mpre">sequence</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><a href="#loc_296_7_296_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_7_296_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_296_9_296_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_9_296_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)

</span><a href="#loc_301_1_301_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_8&#39;)"><span class="mpre">between</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">open</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">close</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @between open close p@ parses @open@, followed by @p@ and finally</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   @close@. Only the value of @p@ is returned.</span></span><span class="mpre">
</span><a name="loc_301_1_301_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_8&#39;)"><span class="hl_fundecl"><span class="mpre">between</span></span></a><span class="mpre"> </span><a name="loc_301_9_301_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_9_301_13&#39;)"><span class="hl_vardecl"><span class="mpre">open</span></span></a><span class="mpre"> </span><a name="loc_301_14_301_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_14_301_19&#39;)"><span class="hl_vardecl"><span class="mpre">close</span></span></a><span class="mpre"> </span><a name="loc_301_20_301_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_20_301_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do _ &lt;- </span><a href="#loc_301_9_301_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_9_301_13&#39;)"><span class="hl_varref"><span class="mpre">open</span></span></a><span class="mpre">
                          </span><a name="loc_302_27_302_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_27_302_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_301_20_301_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_20_301_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                          _ &lt;- </span><a href="#loc_301_14_301_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_14_301_19&#39;)"><span class="hl_varref"><span class="mpre">close</span></span></a><span class="mpre">
                          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_302_27_302_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_27_302_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_309_1_309_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_7&#39;)"><span class="mpre">option</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @option x p@ will either parse @p@ or return @x@ without consuming</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   any input.</span></span><span class="mpre">
</span><a name="loc_309_1_309_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_7&#39;)"><span class="hl_fundecl"><span class="mpre">option</span></span></a><span class="mpre"> </span><a name="loc_309_8_309_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_8_309_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_309_10_309_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_10_309_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_309_10_309_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_10_309_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_309_8_309_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_8_309_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_313_1_313_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_1_313_9&#39;)"><span class="mpre">optional</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @optional p@ optionally parses @p@ and always returns @()@.</span></span><span class="mpre">
</span><a name="loc_313_1_313_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_1_313_9&#39;)"><span class="hl_fundecl"><span class="mpre">optional</span></span></a><span class="mpre"> </span><a name="loc_313_10_313_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_10_313_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = (</span><a href="#loc_313_10_313_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_10_313_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_317_1_317_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_1_317_5&#39;)"><span class="mpre">many</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ Parses zero or more occurrences of the given parser.</span></span><span class="mpre">
</span><a name="loc_317_1_317_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_1_317_5&#39;)"><span class="hl_fundecl"><span class="mpre">many</span></span></a><span class="mpre"> </span><a name="loc_317_6_317_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_6_317_7&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [] </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_321_1_321_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_1_321_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> </span><a href="#loc_317_6_317_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_6_317_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_321_1_321_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_1_321_6&#39;)"><span class="mpre">many1</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ Parses one or more occurrences of the given parser.</span></span><span class="mpre">
</span><a name="loc_321_1_321_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_1_321_6&#39;)"><span class="hl_fundecl"><span class="mpre">many1</span></span></a><span class="mpre"> </span><a name="loc_321_7_321_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_7_321_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="#loc_321_7_321_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_7_321_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_317_1_317_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_1_317_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_321_7_321_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_7_321_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)

</span><a href="#loc_325_1_325_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_1_325_9&#39;)"><span class="mpre">skipMany</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Like &#39;many&#39;, but discards the result.</span></span><span class="mpre">
</span><a name="loc_325_1_325_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_1_325_9&#39;)"><span class="hl_fundecl"><span class="mpre">skipMany</span></span></a><span class="mpre"> </span><a name="loc_325_10_325_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_10_325_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_317_1_317_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_1_317_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_325_10_325_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_10_325_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_329_1_329_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_1_329_10&#39;)"><span class="mpre">skipMany1</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Like &#39;many1&#39;, but discards the result.</span></span><span class="mpre">
</span><a name="loc_329_1_329_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_1_329_10&#39;)"><span class="hl_fundecl"><span class="mpre">skipMany1</span></span></a><span class="mpre"> </span><a name="loc_329_11_329_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_11_329_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_329_11_329_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_11_329_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_325_1_325_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_1_325_9&#39;)"><span class="hl_varref"><span class="mpre">skipMany</span></span></a><span class="mpre"> </span><a href="#loc_329_11_329_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_11_329_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_334_1_334_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_6&#39;)"><span class="mpre">sepBy</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">sep</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @sepBy p sep@ parses zero or more occurrences of @p@, separated by @sep@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Returns a list of values returned by @p@.</span></span><span class="mpre">
</span><a name="loc_334_1_334_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_6&#39;)"><span class="hl_fundecl"><span class="mpre">sepBy</span></span></a><span class="mpre"> </span><a name="loc_334_7_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_7_334_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_334_9_334_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_9_334_12&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> = </span><a href="#loc_339_1_339_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_7&#39;)"><span class="hl_varref"><span class="mpre">sepBy1</span></span></a><span class="mpre"> </span><a href="#loc_334_7_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_7_334_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_334_9_334_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_9_334_12&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []

</span><a href="#loc_339_1_339_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_7&#39;)"><span class="mpre">sepBy1</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">sep</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @sepBy1 p sep@ parses one or more occurrences of @p@, separated by @sep@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Returns a list of values returned by @p@.</span></span><span class="mpre">
</span><a name="loc_339_1_339_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_7&#39;)"><span class="hl_fundecl"><span class="mpre">sepBy1</span></span></a><span class="mpre"> </span><a name="loc_339_8_339_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_8_339_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_339_10_339_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_10_339_13&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="#loc_339_8_339_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_8_339_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_317_1_317_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_1_317_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (</span><a href="#loc_339_10_339_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_10_339_13&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_339_8_339_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_8_339_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">))

</span><a href="#loc_344_1_344_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_6&#39;)"><span class="mpre">endBy</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">sep</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @endBy p sep@ parses zero or more occurrences of @p@, separated and ended</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   by @sep@.</span></span><span class="mpre">
</span><a name="loc_344_1_344_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_6&#39;)"><span class="hl_fundecl"><span class="mpre">endBy</span></span></a><span class="mpre"> </span><a name="loc_344_7_344_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_7_344_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_344_9_344_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_9_344_12&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> = </span><a href="#loc_317_1_317_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_1_317_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (do </span><a name="loc_344_24_344_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_24_344_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_344_7_344_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_7_344_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> ; _ &lt;- </span><a href="#loc_344_9_344_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_9_344_12&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_344_24_344_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_24_344_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><a href="#loc_349_1_349_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_7&#39;)"><span class="mpre">endBy1</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">sep</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @endBy p sep@ parses one or more occurrences of @p@, separated and ended</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   by @sep@.</span></span><span class="mpre">
</span><a name="loc_349_1_349_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_7&#39;)"><span class="hl_fundecl"><span class="mpre">endBy1</span></span></a><span class="mpre"> </span><a name="loc_349_8_349_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_8_349_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_349_10_349_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_10_349_13&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> = </span><a href="#loc_321_1_321_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_1_321_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> (do </span><a name="loc_349_26_349_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_26_349_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_349_8_349_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_8_349_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> ; _ &lt;- </span><a href="#loc_349_10_349_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_10_349_13&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_349_26_349_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_26_349_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><a href="#loc_356_1_356_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_7&#39;)"><span class="mpre">chainr</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @chainr p op x@ parses zero or more occurrences of @p@, separated by @op@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Returns a value produced by a /right/ associative application of all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   functions returned by @op@. If there are no occurrences of @p@, @x@ is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   returned.</span></span><span class="mpre">
</span><a name="loc_356_1_356_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_7&#39;)"><span class="hl_fundecl"><span class="mpre">chainr</span></span></a><span class="mpre"> </span><a name="loc_356_8_356_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_8_356_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_356_10_356_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_10_356_12&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_356_13_356_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_13_356_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="hl_varref"><span class="mpre">chainr1</span></span></a><span class="mpre"> </span><a href="#loc_356_8_356_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_8_356_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_356_10_356_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_10_356_12&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_356_13_356_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_13_356_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_363_1_363_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_1_363_7&#39;)"><span class="mpre">chainl</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ @chainl p op x@ parses zero or more occurrences of @p@, separated by @op@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Returns a value produced by a /left/ associative application of all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   functions returned by @op@. If there are no occurrences of @p@, @x@ is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   returned.</span></span><span class="mpre">
</span><a name="loc_363_1_363_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_1_363_7&#39;)"><span class="hl_fundecl"><span class="mpre">chainl</span></span></a><span class="mpre"> </span><a name="loc_363_8_363_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_8_363_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_363_10_363_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_10_363_12&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_363_13_363_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_13_363_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_376_1_376_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_8&#39;)"><span class="hl_varref"><span class="mpre">chainl1</span></span></a><span class="mpre"> </span><a href="#loc_363_8_363_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_8_363_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_363_10_363_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_10_363_12&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_363_13_363_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_13_363_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="mpre">chainr1</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Like &#39;chainr&#39;, but parses one or more occurrences of @p@.</span></span><span class="mpre">
</span><a name="loc_367_1_367_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_8&#39;)"><span class="hl_fundecl"><span class="mpre">chainr1</span></span></a><span class="mpre"> </span><a name="loc_367_9_367_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_9_367_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_367_11_367_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_11_367_13&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> = </span><a href="#loc_368_9_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_9_368_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">
  where </span><a name="loc_368_9_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_9_368_13&#39;)"><span class="hl_vardecl"><span class="mpre">scan</span></span></a><span class="mpre">   = </span><a href="#loc_367_9_367_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_9_367_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_369_9_369_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_9_369_13&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a name="loc_369_9_369_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_9_369_13&#39;)"><span class="hl_fundecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_369_14_369_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_14_369_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do </span><a name="loc_369_21_369_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_21_369_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_367_11_367_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_11_367_13&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                    </span><a name="loc_370_21_370_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_21_370_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_368_9_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_9_368_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_369_21_369_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_21_369_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_369_14_369_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_14_369_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_370_21_370_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_21_370_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                 </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_369_14_369_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_14_369_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_376_1_376_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_8&#39;)"><span class="mpre">chainl1</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Like &#39;chainl&#39;, but parses one or more occurrences of @p@.</span></span><span class="mpre">
</span><a name="loc_376_1_376_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_8&#39;)"><span class="hl_fundecl"><span class="mpre">chainl1</span></span></a><span class="mpre"> </span><a name="loc_376_9_376_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_9_376_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_376_11_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_11_376_13&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> = </span><a href="#loc_376_9_376_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_9_376_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
  where </span><a name="loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_fundecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_377_14_377_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_14_377_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do </span><a name="loc_377_21_377_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_21_377_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_376_11_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_11_376_13&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                    </span><a name="loc_378_21_378_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_21_378_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_376_9_376_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_9_376_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                    </span><a href="#loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> (</span><a href="#loc_377_21_377_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_21_377_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_377_14_377_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_14_377_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_378_21_378_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_21_378_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                 </span><a href="#loc_198_6_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_6_198_9&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_377_14_377_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_14_377_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_385_1_385_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_1_385_9&#39;)"><span class="mpre">manyTill</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">end</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ @manyTill p end@ parses zero or more occurrences of @p@, until @end@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   succeeds. Returns a list of values returned by @p@.</span></span><span class="mpre">
</span><a name="loc_385_1_385_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_1_385_9&#39;)"><span class="hl_fundecl"><span class="mpre">manyTill</span></span></a><span class="mpre"> </span><a name="loc_385_10_385_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_10_385_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_385_12_385_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_12_385_15&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre"> = </span><a href="#loc_386_9_386_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_9_386_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">
  where </span><a name="loc_386_9_386_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_9_386_13&#39;)"><span class="hl_vardecl"><span class="mpre">scan</span></span></a><span class="mpre"> = (</span><a href="#loc_385_12_385_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_12_385_15&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []) </span><a href="#loc_204_6_204_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_6_204_9&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> (</span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="#loc_385_10_385_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_10_385_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_386_9_386_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_9_386_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Converting between ReadP and Read</span></span><span class="mpre">

</span><a href="#loc_396_1_396_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_1_396_11&#39;)"><span class="mpre">readP_to_S</span></a><span class="mpre"> :: </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Converts a parser into a Haskell ReadS-style function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This is the main way in which you can \&quot;run\&quot; a &#39;ReadP&#39; parser:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the expanded type is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @ readP_to_S :: ReadP a -&gt; String -&gt; [(a,String)] @</span></span><span class="mpre">
</span><a name="loc_396_1_396_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_1_396_11&#39;)"><span class="hl_fundecl"><span class="mpre">readP_to_S</span></span></a><span class="mpre"> (</span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_396_15_396_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_15_396_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = </span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_396_15_396_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_15_396_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">)

</span><a href="#loc_402_1_402_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_1_402_11&#39;)"><span class="mpre">readS_to_P</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ Converts a Haskell ReadS-style function into a parser.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Warning: This introduces local backtracking in the resulting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   parser, and therefore a possible inefficiency.</span></span><span class="mpre">
</span><a name="loc_402_1_402_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_1_402_11&#39;)"><span class="hl_fundecl"><span class="mpre">readS_to_P</span></span></a><span class="mpre"> </span><a name="loc_402_12_402_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_12_402_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> =
  </span><a href="#loc_148_19_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_19_148_20&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (\</span><a name="loc_403_7_403_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_7_403_8&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_conref"><span class="mpre">Look</span></span></a><span class="mpre"> (\</span><a name="loc_403_19_403_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_19_403_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_1_169_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_6&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre"> [</span><a href="#loc_403_53_403_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_53_403_57&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;&#39;</span></span></a><span class="mpre"> | (</span><a name="loc_403_39_403_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_39_403_40&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_403_41_403_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_41_403_43&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_402_12_402_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_12_402_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_403_19_403_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_19_403_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_403_53_403_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_53_403_57&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_173_1_173_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> (</span><a href="#loc_403_7_403_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_7_403_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_403_39_403_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_39_403_40&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_403_41_403_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_41_403_43&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">]))

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- QuickCheck properties that hold for the combinators</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- $properties
The following are QuickCheck specifications of what the combinators do.
These can be seen as formal specifications of the behavior of the
combinators.

We use bags to give semantics to the combinators.

&gt;  type Bag a = [a]

Equality on bags does not care about the order of elements.

&gt;  (=~) :: Ord a =&gt; Bag a -&gt; Bag a -&gt; Bool
&gt;  xs =~ ys = sort xs == sort ys

A special equality operator to avoid unresolved overloading
when testing the properties.

&gt;  (=~.) :: Bag (Int,String) -&gt; Bag (Int,String) -&gt; Bool
&gt;  (=~.) = (=~)

Here follow the properties:

&gt;  prop_Get_Nil =
&gt;    readP_to_S get [] =~ []
&gt;
&gt;  prop_Get_Cons c s =
&gt;    readP_to_S get (c:s) =~ [(c,s)]
&gt;
&gt;  prop_Look s =
&gt;    readP_to_S look s =~ [(s,s)]
&gt;
&gt;  prop_Fail s =
&gt;    readP_to_S pfail s =~. []
&gt;
&gt;  prop_Return x s =
&gt;    readP_to_S (return x) s =~. [(x,s)]
&gt;
&gt;  prop_Bind p k s =
&gt;    readP_to_S (p &gt;&gt;= k) s =~.
&gt;      [ ys&#39;&#39;
&gt;      | (x,s&#39;) &lt;- readP_to_S p s
&gt;      , ys&#39;&#39;   &lt;- readP_to_S (k (x::Int)) s&#39;
&gt;      ]
&gt;
&gt;  prop_Plus p q s =
&gt;    readP_to_S (p +++ q) s =~.
&gt;      (readP_to_S p s ++ readP_to_S q s)
&gt;
&gt;  prop_LeftPlus p q s =
&gt;    readP_to_S (p &lt;++ q) s =~.
&gt;      (readP_to_S p s +&lt;+ readP_to_S q s)
&gt;   where
&gt;    [] +&lt;+ ys = ys
&gt;    xs +&lt;+ _  = xs
&gt;
&gt;  prop_Gather s =
&gt;    forAll readPWithoutReadS $ \p -&gt; 
&gt;      readP_to_S (gather p) s =~
&gt;         [ ((pre,x::Int),s&#39;)
&gt;         | (x,s&#39;) &lt;- readP_to_S p s
&gt;         , let pre = take (length s - length s&#39;) s
&gt;         ]
&gt;
&gt;  prop_String_Yes this s =
&gt;    readP_to_S (string this) (this ++ s) =~
&gt;      [(this,s)]
&gt;
&gt;  prop_String_Maybe this s =
&gt;    readP_to_S (string this) s =~
&gt;      [(this, drop (length this) s) | this `isPrefixOf` s]
&gt;
&gt;  prop_Munch p s =
&gt;    readP_to_S (munch p) s =~
&gt;      [(takeWhile p s, dropWhile p s)]
&gt;
&gt;  prop_Munch1 p s =
&gt;    readP_to_S (munch1 p) s =~
&gt;      [(res,s&#39;) | let (res,s&#39;) = (takeWhile p s, dropWhile p s), not (null res)]
&gt;
&gt;  prop_Choice ps s =
&gt;    readP_to_S (choice ps) s =~.
&gt;      readP_to_S (foldr (+++) pfail ps) s
&gt;
&gt;  prop_ReadS r s =
&gt;    readP_to_S (readS_to_P r) s =~. r s
-}</span></span><span class="mpre">

</span></div></body></html>