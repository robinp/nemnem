<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE DeriveDataTypeable #-}

</span><span class="hl_comment"><span class="mpre">-- |  A module to deal with verbosity, how \&#39;chatty\&#39; a program should be.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    This module defines the &#39;Verbosity&#39; data type, along with functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    for manipulating a global verbosity value.</span></span><span class="mpre">
module System.Console.CmdArgs.Verbosity(
    Verbosity(..), setVerbosity, getVerbosity,
    isNormal, isLoud,
    whenNormal, whenLoud
    ) where

import Control.Monad
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Verbosity.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 8, srcSpanEndLine = 13, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
import Data.IORef
import System.IO.Unsafe


</span><span class="hl_comment"><span class="mpre">-- | The verbosity data type</span></span><span class="mpre">
data </span><a name="loc_19_6_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Verbosity</span></span></a><span class="mpre">
    = </span><a name="loc_20_7_20_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_7_20_12&#39;)"><span class="hl_condecl"><span class="mpre">Quiet</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Only output essential messages (typically errors)</span></span><span class="mpre">
    | </span><a name="loc_21_7_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_7_21_13&#39;)"><span class="hl_condecl"><span class="mpre">Normal</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Output normal messages (typically errors and warnings)</span></span><span class="mpre">
    | </span><a name="loc_22_7_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_7_22_11&#39;)"><span class="hl_condecl"><span class="mpre">Loud</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Output lots of messages (typically errors, warnings and status updates)</span></span><span class="mpre">
      </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Verbosity.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 7, srcSpanEndLine = 23, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Verbosity.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 7, srcSpanEndLine = 23, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Con"><span class="mpre">deriving (Eq,Ord,Bounded,Enum,Show,Read,Data,Typeable)</span></span><span class="mpre">


</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_28_1_28_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_4&#39;)"><span class="mpre">ref</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_28_1_28_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_4&#39;)"><span class="mpre">ref</span></a><span class="mpre"> :: </span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><a href="#loc_19_6_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
</span><a name="loc_28_1_28_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_4&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_21_7_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_7_21_13&#39;)"><span class="hl_conref"><span class="mpre">Normal</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Set the global verbosity.</span></span><span class="mpre">
</span><a href="#loc_33_1_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_13&#39;)"><span class="mpre">setVerbosity</span></a><span class="mpre"> :: </span><a href="#loc_19_6_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_33_1_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_13&#39;)"><span class="hl_vardecl"><span class="mpre">setVerbosity</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_28_1_28_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_4&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the global verbosity. Initially @Normal@ before any calls to &#39;setVerbosity&#39;.</span></span><span class="mpre">
</span><a href="#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="mpre">getVerbosity</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_19_6_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
</span><a name="loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="hl_vardecl"><span class="mpre">getVerbosity</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_28_1_28_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_4&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Used to test if warnings should be output to the user.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   @True@ if the verbosity is set to &#39;Normal&#39; or &#39;Loud&#39; (when @--quiet@ is /not/ specified).</span></span><span class="mpre">
</span><a href="#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_9&#39;)"><span class="mpre">isNormal</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_42_1_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_9&#39;)"><span class="hl_vardecl"><span class="mpre">isNormal</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">&gt;=</span></span><a href="#loc_21_7_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_7_21_13&#39;)"><span class="hl_conref"><span class="mpre">Normal</span></span></a><span class="mpre">) </span><a href="#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="hl_varref"><span class="mpre">getVerbosity</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Used to test if status updates should be output to the user.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   @True@ if the verbosity is set to &#39;Loud&#39; (when @--verbose@ is specified).</span></span><span class="mpre">
</span><a href="#loc_47_1_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_7&#39;)"><span class="mpre">isLoud</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_47_1_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_7&#39;)"><span class="hl_vardecl"><span class="mpre">isLoud</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">&gt;=</span></span><a href="#loc_22_7_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_7_22_11&#39;)"><span class="hl_conref"><span class="mpre">Loud</span></span></a><span class="mpre">) </span><a href="#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="hl_varref"><span class="mpre">getVerbosity</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | An action to perform if the verbosity is normal or higher, based on &#39;isNormal&#39;.</span></span><span class="mpre">
</span><a href="#loc_52_1_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_11&#39;)"><span class="mpre">whenNormal</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_52_1_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_11&#39;)"><span class="hl_fundecl"><span class="mpre">whenNormal</span></span></a><span class="mpre"> </span><a name="loc_52_12_52_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_12_52_15&#39;)"><span class="hl_vardecl"><span class="mpre">act</span></span></a><span class="mpre"> = do
    </span><a name="loc_53_5_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_6&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">isNormal</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_53_5_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_6&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_52_12_52_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_12_52_15&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | An action to perform if the verbosity is loud, based on &#39;isLoud&#39;.</span></span><span class="mpre">
</span><a href="#loc_58_1_58_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_9&#39;)"><span class="mpre">whenLoud</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_58_1_58_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_9&#39;)"><span class="hl_fundecl"><span class="mpre">whenLoud</span></span></a><span class="mpre"> </span><a name="loc_58_10_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_13&#39;)"><span class="hl_vardecl"><span class="mpre">act</span></span></a><span class="mpre"> = do
    </span><a name="loc_59_5_59_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_6&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_47_1_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_7&#39;)"><span class="hl_varref"><span class="mpre">isLoud</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_59_5_59_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_6&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_58_10_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_13&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre">
</span></div></body></html>