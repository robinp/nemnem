<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- #hide</span></span><span class="mpre">
module Data.Time.Calendar.JulianYearDay
        (
        </span><span class="hl_comment"><span class="mpre">-- * Year and day format</span></span><span class="mpre">
        module Data.Time.Calendar.JulianYearDay
        ) where

import Data.Time.Calendar.Days
import Data.Time.Calendar.Private

</span><span class="hl_comment"><span class="mpre">-- | convert to proleptic Julian year and day format. First element of result is year (proleptic Julian calendar),</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- second is the day of the year, with 1 for Jan 1, and 365 (or 366 in leap years) for Dec 31.</span></span><span class="mpre">
</span><a href="#loc_14_1_14_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_1_14_19&#39;)"><span class="mpre">toJulianYearAndDay</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_14_1_14_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_1_14_19&#39;)"><span class="hl_fundecl"><span class="mpre">toJulianYearAndDay</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><a name="loc_14_39_14_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_39_14_42&#39;)"><span class="hl_vardecl"><span class="mpre">mjd</span></span></a><span class="mpre">) = (</span><a href="#loc_20_9_20_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_9_20_13&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre">,</span><a href="#loc_19_9_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_11&#39;)"><span class="hl_varref"><span class="mpre">yd</span></span></a><span class="mpre">) where
        </span><a name="loc_15_9_15_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_14_39_14_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_39_14_42&#39;)"><span class="hl_varref"><span class="mpre">mjd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">678577</span></span><span class="mpre">
        </span><a name="loc_16_9_16_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_13&#39;)"><span class="hl_vardecl"><span class="mpre">quad</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_15_9_15_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1461</span></span><span class="mpre">
        </span><a name="loc_17_9_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_15_9_15_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_9_15_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1461</span></span><span class="mpre">
        </span><a name="loc_18_9_18_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_17_9_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
        </span><a name="loc_19_9_19_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_11&#39;)"><span class="hl_vardecl"><span class="mpre">yd</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><a href="#loc_17_9_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><a href="#loc_18_9_18_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a name="loc_20_9_20_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_9_20_13&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> = </span><a href="#loc_16_9_16_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_13&#39;)"><span class="hl_varref"><span class="mpre">quad</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_18_9_18_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | convert from proleptic Julian year and day format.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid day numbers will be clipped to the correct range (1 to 365 or 366).</span></span><span class="mpre">
</span><a href="#loc_25_1_25_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_21&#39;)"><span class="mpre">fromJulianYearAndDay</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_25_1_25_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_21&#39;)"><span class="hl_fundecl"><span class="mpre">fromJulianYearAndDay</span></span></a><span class="mpre"> </span><a name="loc_25_22_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_22_25_26&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> </span><a name="loc_25_27_25_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_27_25_30&#39;)"><span class="hl_vardecl"><span class="mpre">day</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><a href="#loc_27_9_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_9_27_12&#39;)"><span class="hl_varref"><span class="mpre">mjd</span></span></a><span class="mpre"> where
        </span><a name="loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_25_22_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_22_25_26&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_27_9_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_9_27_12&#39;)"><span class="hl_vardecl"><span class="mpre">mjd</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Private.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_43_1_43_5&#39;)"><span class="hl_varref"><span class="mpre">clip</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (if </span><a href="#loc_46_1_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_17&#39;)"><span class="hl_varref"><span class="mpre">isJulianLeapYear</span></span></a><span class="mpre"> </span><a href="#loc_25_22_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_22_25_26&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">366</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><a href="#loc_25_27_25_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_27_25_30&#39;)"><span class="hl_varref"><span class="mpre">day</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">678578</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | convert from proleptic Julian year and day format.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid day numbers will return Nothing</span></span><span class="mpre">
</span><a href="#loc_32_1_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_26&#39;)"><span class="mpre">fromJulianYearAndDayValid</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_32_1_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_26&#39;)"><span class="hl_fundecl"><span class="mpre">fromJulianYearAndDayValid</span></span></a><span class="mpre"> </span><a name="loc_32_27_32_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_31&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> </span><a name="loc_32_32_32_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_32_32_35&#39;)"><span class="hl_vardecl"><span class="mpre">day</span></span></a><span class="mpre"> = do
        </span><a name="loc_33_9_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_13&#39;)"><span class="hl_vardecl"><span class="mpre">day&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Calendar.Private.html#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">clipValid</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (if </span><a href="#loc_46_1_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_17&#39;)"><span class="hl_varref"><span class="mpre">isJulianLeapYear</span></span></a><span class="mpre"> </span><a href="#loc_32_27_32_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_31&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">366</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><a href="#loc_32_32_32_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_32_32_35&#39;)"><span class="hl_varref"><span class="mpre">day</span></span></a><span class="mpre">
        let
                </span><a name="loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_32_27_32_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_31&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                </span><a name="loc_36_17_36_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_20&#39;)"><span class="hl_vardecl"><span class="mpre">mjd</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_33_9_33_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_13&#39;)"><span class="hl_varref"><span class="mpre">day&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">678578</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><a href="#loc_36_17_36_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_20&#39;)"><span class="hl_varref"><span class="mpre">mjd</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | show in proleptic Julian year and day format (yyyy-ddd)</span></span><span class="mpre">
</span><a href="#loc_41_1_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_21&#39;)"><span class="mpre">showJulianYearAndDay</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_41_1_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_21&#39;)"><span class="hl_fundecl"><span class="mpre">showJulianYearAndDay</span></span></a><span class="mpre"> </span><a name="loc_41_22_41_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_22_41_26&#39;)"><span class="hl_vardecl"><span class="mpre">date</span></span></a><span class="mpre"> = (</span><a href="Data.Time.Calendar.Private.html#loc_34_1_34_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_34_1_34_6&#39;)"><span class="hl_varref"><span class="mpre">show4</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">) </span><a href="#loc_42_10_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_10_42_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Private.html#loc_31_1_31_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_31_1_31_6&#39;)"><span class="hl_varref"><span class="mpre">show3</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">) </span><a href="#loc_42_12_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_12_42_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">) where
        (</span><a name="loc_42_10_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_10_42_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_42_12_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_12_42_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><a href="#loc_14_1_14_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_1_14_19&#39;)"><span class="hl_varref"><span class="mpre">toJulianYearAndDay</span></span></a><span class="mpre"> </span><a href="#loc_41_22_41_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_22_41_26&#39;)"><span class="hl_varref"><span class="mpre">date</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Is this year a leap year according to the proleptic Julian calendar?</span></span><span class="mpre">
</span><a href="#loc_46_1_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_17&#39;)"><span class="mpre">isJulianLeapYear</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_46_1_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_17&#39;)"><span class="hl_fundecl"><span class="mpre">isJulianLeapYear</span></span></a><span class="mpre"> </span><a name="loc_46_18_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_18_46_22&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_46_18_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_18_46_22&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
</span></div></body></html>