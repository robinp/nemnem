<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
#ifndef MIN_VERSION_integer_gmp
#define MIN_VERSION_integer_gmp(a,b,c) 0
#endif
#ifdef VERSION_integer_gmp
{-# LANGUAGE MagicHash #-}
#endif
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Number.F2m</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Danny Navarro &lt;j@dannynavarro.net&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module provides basic arithmetic operations over F₂m. Performance is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- not optimal and it doesn&#39;t provide protection against timing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- attacks. The &#39;m&#39; parameter is implicitly derived from the irreducible</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- polynomial where applicable.</span></span><span class="mpre">
module Crypto.Number.F2m
    ( addF2m
    , mulF2m
    , squareF2m
    , modF2m
    , invF2m
    , divF2m
    ) where

import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)
import Data.Bits ((.&amp;.),(.|.),</span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="mpre">xor</span></a><span class="mpre">,</span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="mpre">shift</span></a><span class="mpre">,</span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="mpre">testBit</span></a><span class="mpre">)

#ifdef VERSION_integer_gmp
import GHC.Exts
import GHC.Integer.Logarithms (</span><a href="GHC.Integer.Logarithms.html#loc_39_1_39_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Integer.Logarithms.html#loc_39_1_39_13&#39;)"><span class="mpre">integerLog2#</span></a><span class="mpre">)
#endif

</span><span class="hl_comment"><span class="mpre">-- | Addition over F₂m. This is just a synonym of  &#39;xor&#39;.</span></span><span class="mpre">
</span><a href="#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_7&#39;)"><span class="mpre">addF2m</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_38_1_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_7&#39;)"><span class="hl_vardecl"><span class="mpre">addF2m</span></span></a><span class="mpre"> = </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">xor</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_7&#39;)"><span class="mpre">addF2m</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Binary polynomial reduction modulo using long division algorithm.</span></span><span class="mpre">
</span><a href="#loc_44_1_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_7&#39;)"><span class="mpre">modF2m</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Irreducible binary polynomial</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_44_1_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_7&#39;)"><span class="hl_fundecl"><span class="mpre">modF2m</span></span></a><span class="mpre"> </span><a name="loc_44_8_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_8_44_10&#39;)"><span class="hl_vardecl"><span class="mpre">fx</span></span></a><span class="mpre"> = </span><a href="#loc_47_5_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_46_5_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_8&#39;)"><span class="hl_vardecl"><span class="mpre">lfx</span></span></a><span class="mpre"> = </span><a href="#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="hl_varref"><span class="mpre">log2</span></span></a><span class="mpre"> </span><a href="#loc_44_8_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_8_44_10&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre">
    </span><a name="loc_47_5_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_47_8_47_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_8_47_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> | </span><a href="#loc_51_9_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = </span><a href="#loc_47_8_47_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_8_47_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_infix"><span class="mpre">`xor`</span></span></a><span class="mpre"> </span><a href="#loc_44_8_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_8_44_10&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre">
         | </span><a href="#loc_51_9_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_47_8_47_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_8_47_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_47_5_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_47_8_47_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_8_47_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_infix"><span class="mpre">`xor`</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_44_8_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_8_44_10&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_51_9_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
      where
        </span><a name="loc_51_9_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="hl_varref"><span class="mpre">log2</span></span></a><span class="mpre"> </span><a href="#loc_47_8_47_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_8_47_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_46_5_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_8&#39;)"><span class="hl_varref"><span class="mpre">lfx</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_44_1_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_7&#39;)"><span class="mpre">modF2m</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Multiplication over F₂m.</span></span><span class="mpre">
</span><a href="#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_7&#39;)"><span class="mpre">mulF2m</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Irreducible binary polynomial</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_57_1_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_7&#39;)"><span class="hl_fundecl"><span class="mpre">mulF2m</span></span></a><span class="mpre"> </span><a name="loc_57_8_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_8_57_10&#39;)"><span class="hl_vardecl"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a name="loc_57_11_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_13&#39;)"><span class="hl_vardecl"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a name="loc_57_14_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_14_57_16&#39;)"><span class="hl_vardecl"><span class="mpre">n2</span></span></a><span class="mpre"> = </span><a href="#loc_44_1_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_7&#39;)"><span class="hl_varref"><span class="mpre">modF2m</span></span></a><span class="mpre"> </span><a href="#loc_57_8_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_8_57_10&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_60_5_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (if </span><a href="#loc_57_14_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_14_57_16&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> then </span><a href="#loc_57_11_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_13&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) (</span><a href="#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="hl_varref"><span class="mpre">log2</span></span></a><span class="mpre"> </span><a href="#loc_57_14_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_14_57_16&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre">)
  where
    </span><a name="loc_60_5_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_60_8_60_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_8_60_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_60_10_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> | </span><a href="#loc_60_10_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = </span><a href="#loc_60_8_60_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_8_60_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = if </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">testBit</span></span></a><span class="mpre"> </span><a href="#loc_57_14_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_14_57_16&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre"> </span><a href="#loc_60_10_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                            then </span><a href="#loc_60_5_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_60_8_60_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_8_60_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_infix"><span class="mpre">`xor`</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_57_11_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_13&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a href="#loc_60_10_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><a href="#loc_60_10_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                            else </span><a href="#loc_60_5_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_60_8_60_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_8_60_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_60_10_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_10_60_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE mulF2m #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Squaring over F₂m.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TODO: This is still slower than @mulF2m@.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Multiplication table? C?</span></span><span class="mpre">
</span><a href="#loc_72_1_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_10&#39;)"><span class="mpre">squareF2m</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Irreducible binary polynomial</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_72_1_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_10&#39;)"><span class="hl_fundecl"><span class="mpre">squareF2m</span></span></a><span class="mpre"> </span><a name="loc_72_11_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_13&#39;)"><span class="hl_vardecl"><span class="mpre">fx</span></span></a><span class="mpre"> = </span><a href="#loc_44_1_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_7&#39;)"><span class="hl_varref"><span class="mpre">modF2m</span></span></a><span class="mpre"> </span><a href="#loc_72_11_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_11_72_13&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="hl_varref"><span class="mpre">square</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_72_1_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_10&#39;)"><span class="mpre">squareF2m</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="mpre">square</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="hl_fundecl"><span class="mpre">square</span></span></a><span class="mpre"> </span><a name="loc_76_8_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_8_76_10&#39;)"><span class="hl_vardecl"><span class="mpre">n1</span></span></a><span class="mpre"> = </span><a href="#loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_76_8_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_8_76_10&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a href="#loc_78_5_78_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_8&#39;)"><span class="hl_varref"><span class="mpre">ln1</span></span></a><span class="mpre">
  where
    </span><a name="loc_78_5_78_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_8&#39;)"><span class="hl_vardecl"><span class="mpre">ln1</span></span></a><span class="mpre"> = </span><a href="#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="hl_varref"><span class="mpre">log2</span></span></a><span class="mpre"> </span><a href="#loc_76_8_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_8_76_10&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre">
    </span><a name="loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_79_8_79_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_79_10_79_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_10_79_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> | </span><a href="#loc_79_10_79_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_10_79_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_79_8_79_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_82_9_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_9_82_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_83_9_83_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a href="#loc_79_10_79_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_10_79_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
      where
        </span><a name="loc_82_9_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_9_82_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> (</span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_79_8_79_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_79_10_79_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_10_79_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_78_5_78_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_8&#39;)"><span class="hl_varref"><span class="mpre">ln1</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_78_5_78_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_8&#39;)"><span class="hl_varref"><span class="mpre">ln1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_79_10_79_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_10_79_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
        </span><a name="loc_83_9_83_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_79_8_79_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> (</span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_78_5_78_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_8&#39;)"><span class="hl_varref"><span class="mpre">ln1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_79_10_79_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_10_79_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="mpre">square</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Inversion over  F₂m using extended Euclidean algorithm.</span></span><span class="mpre">
</span><a href="#loc_89_1_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_7&#39;)"><span class="mpre">invF2m</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Irreducible binary polynomial</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_89_1_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_7&#39;)"><span class="hl_fundecl"><span class="mpre">invF2m</span></span></a><span class="mpre"> _  </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_89_1_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_7&#39;)"><span class="hl_fundecl"><span class="mpre">invF2m</span></span></a><span class="mpre"> </span><a name="loc_90_8_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_8_90_10&#39;)"><span class="hl_vardecl"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a name="loc_90_11_90_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_92_7_92_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_90_11_90_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_90_8_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_8_90_10&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    where
      </span><a name="loc_92_7_92_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_92_10_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_10_92_11&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_92_12_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_12_92_13&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_92_14_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_14_92_16&#39;)"><span class="hl_vardecl"><span class="mpre">g1</span></span></a><span class="mpre"> </span><a name="loc_92_17_92_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_17_92_19&#39;)"><span class="hl_vardecl"><span class="mpre">g2</span></span></a><span class="mpre">
          | </span><a href="#loc_92_10_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_10_92_11&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_44_1_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_7&#39;)"><span class="hl_varref"><span class="mpre">modF2m</span></span></a><span class="mpre"> </span><a href="#loc_90_8_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_8_90_10&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_92_14_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_14_92_16&#39;)"><span class="hl_varref"><span class="mpre">g1</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = if </span><a href="#loc_100_11_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_11_100_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                           then </span><a href="#loc_92_7_92_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_92_10_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_10_92_11&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">  (</span><a href="#loc_92_12_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_12_92_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">  </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_infix"><span class="mpre">`xor`</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre">  </span><a href="#loc_92_10_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_10_92_11&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> (-</span><a href="#loc_100_11_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_11_100_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">))
                                   </span><a href="#loc_92_14_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_14_92_16&#39;)"><span class="hl_varref"><span class="mpre">g1</span></span></a><span class="mpre"> (</span><a href="#loc_92_17_92_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_17_92_19&#39;)"><span class="hl_varref"><span class="mpre">g2</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_infix"><span class="mpre">`xor`</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_92_14_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_14_92_16&#39;)"><span class="hl_varref"><span class="mpre">g1</span></span></a><span class="mpre"> (-</span><a href="#loc_100_11_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_11_100_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">))
                           else </span><a href="#loc_92_7_92_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_92_10_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_10_92_11&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">  </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_infix"><span class="mpre">`xor`</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_92_12_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_12_92_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">  </span><a href="#loc_100_11_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_11_100_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">) </span><a href="#loc_92_12_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_12_92_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
                                   (</span><a href="#loc_92_14_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_14_92_16&#39;)"><span class="hl_varref"><span class="mpre">g1</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_infix"><span class="mpre">`xor`</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_92_17_92_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_17_92_19&#39;)"><span class="hl_varref"><span class="mpre">g2</span></span></a><span class="mpre"> </span><a href="#loc_100_11_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_11_100_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">) </span><a href="#loc_92_17_92_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_17_92_19&#39;)"><span class="hl_varref"><span class="mpre">g2</span></span></a><span class="mpre">
        where
          </span><a name="loc_100_11_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_11_100_12&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> = </span><a href="#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="hl_varref"><span class="mpre">log2</span></span></a><span class="mpre"> </span><a href="#loc_92_10_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_10_92_11&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="hl_varref"><span class="mpre">log2</span></span></a><span class="mpre"> </span><a href="#loc_92_12_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_12_92_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE invF2m #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Division over F₂m. If the dividend doesn&#39;t have an inverse it returns</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Nothing&#39;.</span></span><span class="mpre">
</span><a href="#loc_109_1_109_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_7&#39;)"><span class="mpre">divF2m</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Irreducible binary polynomial</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Dividend</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Quotient</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_109_1_109_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_7&#39;)"><span class="hl_fundecl"><span class="mpre">divF2m</span></span></a><span class="mpre"> </span><a name="loc_109_8_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_8_109_10&#39;)"><span class="hl_vardecl"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a name="loc_109_11_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_13&#39;)"><span class="hl_vardecl"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a name="loc_109_14_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_14_109_16&#39;)"><span class="hl_vardecl"><span class="mpre">n2</span></span></a><span class="mpre"> = </span><a href="#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_7&#39;)"><span class="hl_varref"><span class="mpre">mulF2m</span></span></a><span class="mpre"> </span><a href="#loc_109_8_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_8_109_10&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_109_11_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_13&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_89_1_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_7&#39;)"><span class="hl_varref"><span class="mpre">invF2m</span></span></a><span class="mpre"> </span><a href="#loc_109_8_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_8_109_10&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre"> </span><a href="#loc_109_14_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_14_109_16&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_109_1_109_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_7&#39;)"><span class="mpre">divF2m</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="mpre">log2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
#if defined(VERSION_integer_gmp)
</span><a name="loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="hl_fundecl"><span class="mpre">log2</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><a href="#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="hl_fundecl"><span class="mpre">log2</span></span></a><span class="mpre"> </span><a name="loc_115_6_115_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> (</span><a href="GHC.Integer.Logarithms.html#loc_39_1_39_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Integer.Logarithms.html#loc_39_1_39_13&#39;)"><span class="hl_varref"><span class="mpre">integerLog2#</span></span></a><span class="mpre"> </span><a href="#loc_115_6_115_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
#else
</span><span class="hl_comment"><span class="mpre">-- http://www.haskell.org/pipermail/haskell-cafe/2008-February/039465.html</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">log2</span></span><span class="mpre"> = </span><a href="#loc_120_5_120_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_10&#39;)"><span class="hl_varref"><span class="mpre">imLog</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
  where
    </span><a name="loc_120_5_120_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_10&#39;)"><span class="hl_fundecl"><span class="mpre">imLog</span></span></a><span class="mpre"> </span><a name="loc_120_11_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_11_120_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_120_13_120_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_13_120_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><a href="#loc_120_13_120_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_13_120_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_120_11_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_11_120_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else (</span><a href="#loc_120_13_120_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_13_120_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_120_11_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_11_120_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">^</span></span><a href="#loc_122_9_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_123_9_123_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_9_123_14&#39;)"><span class="hl_infix"><span class="mpre">`doDiv`</span></span></a><span class="mpre"> </span><a href="#loc_122_9_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
      where
        </span><a name="loc_122_9_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_120_5_120_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_10&#39;)"><span class="hl_varref"><span class="mpre">imLog</span></span></a><span class="mpre"> (</span><a href="#loc_120_11_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_11_120_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_120_11_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_11_120_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="#loc_120_13_120_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_13_120_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_123_9_123_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_9_123_14&#39;)"><span class="hl_fundecl"><span class="mpre">doDiv</span></span></a><span class="mpre"> </span><a name="loc_123_15_123_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_15_123_17&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> </span><a name="loc_123_18_123_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_18_123_20&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre"> = if </span><a href="#loc_123_15_123_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_15_123_17&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_120_11_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_11_120_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><a href="#loc_123_18_123_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_18_123_20&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> else (</span><a href="#loc_123_15_123_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_15_123_17&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_120_11_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_11_120_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="#loc_123_9_123_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_9_123_14&#39;)"><span class="hl_infix"><span class="mpre">`doDiv`</span></span></a><span class="mpre"> (</span><a href="#loc_123_18_123_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_18_123_20&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
#endif
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_5&#39;)"><span class="mpre">log2</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>