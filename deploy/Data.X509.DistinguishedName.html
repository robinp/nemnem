<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.DistinguishedName</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- X.509 Distinguished names types and functions</span></span><span class="mpre">
module Data.X509.DistinguishedName
    ( DistinguishedName(..)
    , DistinguishedNameInner(..)
    , ASN1CharacterString(..)
    </span><span class="hl_comment"><span class="mpre">-- Distinguished Name Elements</span></span><span class="mpre">
    , DnElement(..)
    , getDnElement
    ) where

import Control.Applicative
import Data.Monoid
import Data.ASN1.Types
import Data.X509.Internal
import Control.Monad.Error

</span><span class="hl_comment"><span class="mpre">-- | A list of OID and strings.</span></span><span class="mpre">
newtype </span><a name="loc_25_9_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_26&#39;)"><span class="hl_tycondecl"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> = </span><a name="loc_25_29_25_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_29_25_46&#39;)"><span class="hl_condecl"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> { </span><a name="loc_25_49_25_73" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_49_25_73&#39;)"><span class="hl_fielddecl"><span class="mpre">getDistinguishedElements</span></span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">OID</span></span><span class="mpre">, </span><a href="Data.ASN1.Types.String.html#loc_73_6_73_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.String.html#loc_73_6_73_25&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre">)] }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/DistinguishedName.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 5, srcSpanEndLine = 26, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/DistinguishedName.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 5, srcSpanEndLine = 26, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/DistinguishedName.h"><span class="mpre">deriving (Show,Eq,Ord)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Elements commonly available in a &#39;DistinguishedName&#39; structure</span></span><span class="mpre">
data </span><a name="loc_29_6_29_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_15&#39;)"><span class="hl_tycondecl"><span class="mpre">DnElement</span></span></a><span class="mpre"> =
      </span><a name="loc_30_7_30_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_7_30_19&#39;)"><span class="hl_condecl"><span class="mpre">DnCommonName</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ CN</span></span><span class="mpre">
    | </span><a name="loc_31_7_31_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_16&#39;)"><span class="hl_condecl"><span class="mpre">DnCountry</span></span></a><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^ Country</span></span><span class="mpre">
    | </span><a name="loc_32_7_32_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_21&#39;)"><span class="hl_condecl"><span class="mpre">DnOrganization</span></span></a><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ O</span></span><span class="mpre">
    | </span><a name="loc_33_7_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_25&#39;)"><span class="hl_condecl"><span class="mpre">DnOrganizationUnit</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ OU</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/DistinguishedName.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 5, srcSpanEndLine = 34, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/DistinguishedName.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 5, srcSpanEndLine = 34, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/DistinguishedName.h"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

instance </span><a href="Data.ASN1.OID.html#loc_20_7_20_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_20_7_20_14&#39;)"><span class="hl_classref"><span class="mpre">OIDable</span></span></a><span class="mpre"> </span><a href="#loc_29_6_29_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_15&#39;)"><span class="hl_tyconref"><span class="mpre">DnElement</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.OID.html#loc_22_5_22_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_22_5_22_16&#39;)"><span class="hl_fundecl"><span class="mpre">getObjectID</span></span></a><span class="mpre"> </span><a href="#loc_30_7_30_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_7_30_19&#39;)"><span class="hl_conref"><span class="mpre">DnCommonName</span></span></a><span class="mpre">       = [</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">]
    </span><a href="Data.ASN1.OID.html#loc_22_5_22_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_22_5_22_16&#39;)"><span class="hl_fundecl"><span class="mpre">getObjectID</span></span></a><span class="mpre"> </span><a href="#loc_31_7_31_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_16&#39;)"><span class="hl_conref"><span class="mpre">DnCountry</span></span></a><span class="mpre">          = [</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">]
    </span><a href="Data.ASN1.OID.html#loc_22_5_22_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_22_5_22_16&#39;)"><span class="hl_fundecl"><span class="mpre">getObjectID</span></span></a><span class="mpre"> </span><a href="#loc_32_7_32_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_21&#39;)"><span class="hl_conref"><span class="mpre">DnOrganization</span></span></a><span class="mpre">     = [</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">]
    </span><a href="Data.ASN1.OID.html#loc_22_5_22_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_22_5_22_16&#39;)"><span class="hl_fundecl"><span class="mpre">getObjectID</span></span></a><span class="mpre"> </span><a href="#loc_33_7_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_25&#39;)"><span class="hl_conref"><span class="mpre">DnOrganizationUnit</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | Try to get a specific element in a &#39;DistinguishedName&#39; structure</span></span><span class="mpre">
</span><a href="#loc_44_1_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_13&#39;)"><span class="mpre">getDnElement</span></a><span class="mpre"> :: </span><a href="#loc_29_6_29_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_15&#39;)"><span class="hl_tyconref"><span class="mpre">DnElement</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.String.html#loc_73_6_73_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.String.html#loc_73_6_73_25&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre">
</span><a name="loc_44_1_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_13&#39;)"><span class="hl_fundecl"><span class="mpre">getDnElement</span></span></a><span class="mpre"> </span><a name="loc_44_14_44_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_14_44_21&#39;)"><span class="hl_vardecl"><span class="mpre">element</span></span></a><span class="mpre"> (</span><a href="#loc_25_29_25_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_29_25_46&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> </span><a name="loc_44_41_44_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_41_44_44&#39;)"><span class="hl_vardecl"><span class="mpre">els</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> (</span><a href="Data.ASN1.OID.html#loc_22_5_22_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_22_5_22_16&#39;)"><span class="hl_varref"><span class="mpre">getObjectID</span></span></a><span class="mpre"> </span><a href="#loc_44_14_44_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_14_44_21&#39;)"><span class="hl_varref"><span class="mpre">element</span></span></a><span class="mpre">) </span><a href="#loc_44_41_44_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_41_44_44&#39;)"><span class="hl_varref"><span class="mpre">els</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Only use to encode a DistinguishedName without including it in a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Sequence</span></span><span class="mpre">
newtype </span><a name="loc_48_9_48_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_31&#39;)"><span class="hl_tycondecl"><span class="mpre">DistinguishedNameInner</span></span></a><span class="mpre"> = </span><a name="loc_48_34_48_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_34_48_56&#39;)"><span class="hl_condecl"><span class="mpre">DistinguishedNameInner</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/DistinguishedName.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 5, srcSpanEndLine = 49, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/DistinguishedName.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 5, srcSpanEndLine = 49, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/DistinguishedName.h"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> where
    </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre">  = </span><a href="#loc_25_29_25_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_29_25_46&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> []
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">mappend</span></span></a><span class="mpre"> (</span><a href="#loc_25_29_25_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_29_25_46&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> </span><a name="loc_53_32_53_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_32_53_34&#39;)"><span class="hl_vardecl"><span class="mpre">l1</span></span></a><span class="mpre">) (</span><a href="#loc_25_29_25_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_29_25_46&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> </span><a name="loc_53_55_53_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_55_53_57&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre">) = </span><a href="#loc_25_29_25_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_29_25_46&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> (</span><a href="#loc_53_32_53_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_32_53_34&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_53_55_53_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_55_53_57&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre">)

instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a name="loc_56_12_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_12_56_14&#39;)"><span class="hl_vardecl"><span class="mpre">dn</span></span></a><span class="mpre"> = \</span><a name="loc_56_18_56_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_83_1_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_9&#39;)"><span class="hl_varref"><span class="mpre">encodeDN</span></span></a><span class="mpre"> </span><a href="#loc_56_12_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_12_56_14&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_56_18_56_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_vardecl"><span class="mpre">fromASN1</span></span></a><span class="mpre">  = </span><a href="Data.ASN1.Parse.html#loc_39_1_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_39_1_39_18&#39;)"><span class="hl_varref"><span class="mpre">runParseASN1State</span></span></a><span class="mpre"> </span><a href="#loc_66_1_66_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_8&#39;)"><span class="hl_varref"><span class="mpre">parseDN</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- FIXME parseDNInner in fromASN1 is probably wrong as we don&#39;t have a container</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and thus hasNext should be replaced by a isFinished clause.</span></span><span class="mpre">
instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_48_9_48_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_31&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedNameInner</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_48_34_48_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_34_48_56&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedNameInner</span></span></a><span class="mpre"> </span><a name="loc_62_36_62_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_36_62_38&#39;)"><span class="hl_vardecl"><span class="mpre">dn</span></span></a><span class="mpre">) = \</span><a name="loc_62_43_62_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_43_62_45&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_79_1_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_14&#39;)"><span class="hl_varref"><span class="mpre">encodeDNinner</span></span></a><span class="mpre"> </span><a href="#loc_62_36_62_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_36_62_38&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_62_43_62_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_43_62_45&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_vardecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Parse.html#loc_39_1_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_39_1_39_18&#39;)"><span class="hl_varref"><span class="mpre">runParseASN1State</span></span></a><span class="mpre"> (</span><a href="#loc_48_34_48_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_34_48_56&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedNameInner</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_25_29_25_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_29_25_46&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_69_1_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_13&#39;)"><span class="hl_varref"><span class="mpre">parseDNInner</span></span></a><span class="mpre">)

</span><a href="#loc_66_1_66_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_8&#39;)"><span class="mpre">parseDN</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Parse.html#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre">
</span><a name="loc_66_1_66_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_8&#39;)"><span class="hl_vardecl"><span class="mpre">parseDN</span></span></a><span class="mpre"> = </span><a href="#loc_25_29_25_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_29_25_46&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_104_1_104_16&#39;)"><span class="hl_varref"><span class="mpre">onNextContainer</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><a href="#loc_69_1_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_13&#39;)"><span class="hl_varref"><span class="mpre">parseDNInner</span></span></a><span class="mpre">

</span><a href="#loc_69_1_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_13&#39;)"><span class="mpre">parseDNInner</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Parse.html#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">OID</span></span><span class="mpre">, </span><a href="Data.ASN1.Types.String.html#loc_73_6_73_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.String.html#loc_73_6_73_25&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre">)]
</span><a name="loc_69_1_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_13&#39;)"><span class="hl_vardecl"><span class="mpre">parseDNInner</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_73_1_73_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_73_1_73_8&#39;)"><span class="hl_varref"><span class="mpre">getMany</span></span></a><span class="mpre"> </span><a href="#loc_72_1_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_11&#39;)"><span class="hl_varref"><span class="mpre">parseOneDN</span></span></a><span class="mpre">

</span><a href="#loc_72_1_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_11&#39;)"><span class="mpre">parseOneDN</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Parse.html#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">OID</span></span><span class="mpre">, </span><a href="Data.ASN1.Types.String.html#loc_73_6_73_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.String.html#loc_73_6_73_25&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1CharacterString</span></span></a><span class="mpre">)]
</span><a name="loc_72_1_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_11&#39;)"><span class="hl_vardecl"><span class="mpre">parseOneDN</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Parse.html#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_104_1_104_16&#39;)"><span class="hl_varref"><span class="mpre">onNextContainer</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_33_29_33_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_33_29_33_32&#39;)"><span class="hl_conref"><span class="mpre">Set</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_73_1_73_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_73_1_73_8&#39;)"><span class="hl_varref"><span class="mpre">getMany</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_73_5_73_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ASN1.Parse.html#loc_93_1_93_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_93_1_93_17&#39;)"><span class="hl_varref"><span class="mpre">getNextContainer</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
    case </span><a href="#loc_73_5_73_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
        [</span><a href="Data.ASN1.Types.html#loc_49_7_49_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_49_7_49_10&#39;)"><span class="hl_conref"><span class="mpre">OID</span></span></a><span class="mpre"> </span><a name="loc_75_14_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_14_75_17&#39;)"><span class="hl_vardecl"><span class="mpre">oid</span></span></a><span class="mpre">, </span><a href="Data.ASN1.Types.html#loc_52_7_52_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_52_7_52_17&#39;)"><span class="hl_conref"><span class="mpre">ASN1String</span></span></a><span class="mpre"> </span><a name="loc_75_30_75_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_30_75_32&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">] -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_75_14_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_14_75_17&#39;)"><span class="hl_varref"><span class="mpre">oid</span></span></a><span class="mpre">, </span><a href="#loc_75_30_75_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_30_75_32&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
        _                        -&gt; </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;expecting [OID,String] got &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_73_5_73_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><a href="#loc_79_1_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_14&#39;)"><span class="mpre">encodeDNinner</span></a><span class="mpre"> :: </span><a href="#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">]
</span><a name="loc_79_1_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_14&#39;)"><span class="hl_fundecl"><span class="mpre">encodeDNinner</span></span></a><span class="mpre"> (</span><a href="#loc_25_29_25_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_29_25_46&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> </span><a name="loc_79_34_79_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_34_79_36&#39;)"><span class="hl_vardecl"><span class="mpre">dn</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_80_9_80_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_14&#39;)"><span class="hl_varref"><span class="mpre">dnSet</span></span></a><span class="mpre"> </span><a href="#loc_79_34_79_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_34_79_36&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="mpre">
  where </span><a name="loc_80_9_80_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_14&#39;)"><span class="hl_fundecl"><span class="mpre">dnSet</span></span></a><span class="mpre"> (</span><a name="loc_80_16_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_19&#39;)"><span class="hl_vardecl"><span class="mpre">oid</span></span></a><span class="mpre">, </span><a name="loc_80_21_80_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_21_80_23&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_33_29_33_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_33_29_33_32&#39;)"><span class="hl_conref"><span class="mpre">Set</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_49_7_49_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_49_7_49_10&#39;)"><span class="hl_conref"><span class="mpre">OID</span></span></a><span class="mpre"> </span><a href="#loc_80_16_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_19&#39;)"><span class="hl_varref"><span class="mpre">oid</span></span></a><span class="mpre">, </span><a href="Data.ASN1.Types.html#loc_52_7_52_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_52_7_52_17&#39;)"><span class="hl_conref"><span class="mpre">ASN1String</span></span></a><span class="mpre"> </span><a href="#loc_80_21_80_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_21_80_23&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">]

</span><a href="#loc_83_1_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_9&#39;)"><span class="mpre">encodeDN</span></a><span class="mpre"> :: </span><a href="#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">]
</span><a name="loc_83_1_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_9&#39;)"><span class="hl_fundecl"><span class="mpre">encodeDN</span></span></a><span class="mpre"> </span><a name="loc_83_10_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_12&#39;)"><span class="hl_vardecl"><span class="mpre">dn</span></span></a><span class="mpre"> = </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_79_1_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_14&#39;)"><span class="hl_varref"><span class="mpre">encodeDNinner</span></span></a><span class="mpre"> </span><a href="#loc_83_10_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_12&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="mpre">
</span></div></body></html>