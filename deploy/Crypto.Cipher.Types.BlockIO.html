<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Cipher.Types.Block</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : Stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Excellent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- block cipher basic types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE ExistentialQuantification #-}
{-# LANGUAGE ViewPatterns #-}
module Crypto.Cipher.Types.BlockIO
    ( BlockCipherIO(..)
    , PtrDest
    , PtrSource
    , PtrIV
    , BufferLength
    , onBlock
    ) where

import Control.Applicative
import Data.Word
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 8, srcSpanEndLine = 24, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified Data.ByteString.Internal as B (</span><a href="Data.ByteString.Internal.html#loc_400_1_400_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_400_1_400_15&#39;)"><span class="mpre">fromForeignPtr</span></a><span class="mpre">, </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="mpre">memcpy</span></a><span class="mpre">)
import Data.Byteable
import Data.Bits (</span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="mpre">xor</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_79_15_79_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_79_15_79_19&#39;)"><span class="mpre">Bits</span></a><span class="mpre">)
import Foreign.Storable (poke, peek, Storable)
</span><span class="hl_comment"><span class="mpre">--import Foreign.Ptr (plusPtr, Ptr, castPtr, nullPtr)</span></span><span class="mpre">
import Crypto.Cipher.Types.Block
import Foreign.Ptr
import Foreign.ForeignPtr (newForeignPtr_)

</span><span class="hl_comment"><span class="mpre">-- | pointer to the destination data</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 1, srcSpanEndLine = 35, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 1, srcSpanEndLine = 35, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-"><span class="mpre">type PtrDest   = Ptr Word8</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | pointer to the source data</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 1, srcSpanEndLine = 38, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 1, srcSpanEndLine = 38, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-"><span class="mpre">type PtrSource = Ptr Word8</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | pointer to the IV data</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 1, srcSpanEndLine = 41, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 1, srcSpanEndLine = 41, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-"><span class="mpre">type PtrIV     = Ptr Word8</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Length of the pointed data</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 1, srcSpanEndLine = 44, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 1, srcSpanEndLine = 44, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-"><span class="mpre">type BufferLength = Word32</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Symmetric block cipher class, mutable API</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 7, srcSpanEndLine = 47, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 26, srcSpanEndLine = 47, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = "><span class="mpre">BlockCipher cipher =&gt;</span></span><span class="mpre"> </span><a name="loc_47_29_47_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_29_47_42&#39;)"><span class="hl_classdecl"><span class="mpre">BlockCipherIO</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> where
    </span><span class="hl_comment"><span class="mpre">-- | Encrypt using the ECB mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize</span></span><span class="mpre">
    </span><a name="loc_51_5_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_22&#39;)"><span class="mpre">ecbEncryptMutable</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BufferLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | Decrypt using the ECB mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize</span></span><span class="mpre">
    </span><a name="loc_56_5_56_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_5_56_22&#39;)"><span class="mpre">ecbDecryptMutable</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BufferLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | encrypt using the CBC mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize</span></span><span class="mpre">
    </span><a name="loc_61_5_61_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_22&#39;)"><span class="mpre">cbcEncryptMutable</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrIV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BufferLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_61_5_61_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_22&#39;)"><span class="hl_vardecl"><span class="mpre">cbcEncryptMutable</span></span></a><span class="mpre"> = </span><a href="#loc_107_1_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_18&#39;)"><span class="hl_varref"><span class="mpre">cbcEncryptGeneric</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | decrypt using the CBC mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize</span></span><span class="mpre">
    </span><a name="loc_67_5_67_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_22&#39;)"><span class="mpre">cbcDecryptMutable</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrIV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BufferLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_67_5_67_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_22&#39;)"><span class="hl_vardecl"><span class="mpre">cbcDecryptMutable</span></span></a><span class="mpre"> = </span><a href="#loc_114_1_114_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_18&#39;)"><span class="hl_varref"><span class="mpre">cbcDecryptGeneric</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
    -- | encrypt using the CFB mode.
    --
    -- input need to be a multiple of the blocksize
    cfbEncryptMutable :: cipher -&gt; PtrIV -&gt; PtrDest -&gt; PtrSource -&gt; BufferLength -&gt; IO ()
    cfbEncryptMutable = cfbEncryptGeneric

    -- | decrypt using the CFB mode.
    --
    -- input need to be a multiple of the blocksize
    cfbDecryptMutable :: cipher -&gt; PtrIV -&gt; PtrDest -&gt; PtrSource -&gt; BufferLength -&gt; IO ()
    cfbDecryptMutable = cfbDecryptGeneric

    -- | combine using the CTR mode.
    --
    -- CTR mode produce a stream of randomized data that is combined
    -- (by XOR operation) with the input stream.
    --
    -- encryption and decryption are the same operation.
    --
    -- input can be of any size
    ctrCombineMutable :: cipher -&gt; PtrIV -&gt; PtrDest -&gt; PtrSource -&gt; BufferLength -&gt; IO ()
    ctrCombineMutable = ctrCombineGeneric

    -- | encrypt using the XTS mode.
    --
    -- input need to be a multiple of the blocksize
    xtsEncryptMutable :: (cipher, cipher) -&gt; PtrIV -&gt; DataUnitOffset -&gt; PtrDest -&gt; PtrSource -&gt; BufferLength -&gt; IO ()
    xtsEncryptMutable = xtsEncryptGeneric
    -- | decrypt using the XTS mode.
    --
    -- input need to be a multiple of the blocksize
    xtsDecryptMutable :: (cipher, cipher) -&gt; PtrIV -&gt; DataUnitOffset -&gt; PtrDest -&gt; PtrSource -&gt; BufferLength -&gt; IO ()
    xtsDecryptMutable = xtsDecryptGeneric
-}</span></span><span class="mpre">

</span><a href="#loc_107_1_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_18&#39;)"><span class="mpre">cbcEncryptGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 22, srcSpanEndLine = 106, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 43, srcSpanEndLine = 106, srcSpanEndColumn = 45}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilena"><span class="mpre">BlockCipherIO cipher =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrIV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BufferLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_107_1_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_18&#39;)"><span class="hl_fundecl"><span class="mpre">cbcEncryptGeneric</span></span></a><span class="mpre"> </span><a name="loc_107_19_107_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_25&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> = </span><a href="#loc_165_1_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_7&#39;)"><span class="hl_varref"><span class="mpre">loopBS</span></span></a><span class="mpre"> </span><a href="#loc_107_19_107_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_108_9_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_16&#39;)"><span class="hl_varref"><span class="mpre">encrypt</span></span></a><span class="mpre">
  where </span><a name="loc_108_9_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_16&#39;)"><span class="hl_fundecl"><span class="mpre">encrypt</span></span></a><span class="mpre"> </span><a name="loc_108_17_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a name="loc_108_20_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_22&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a name="loc_108_23_108_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_24&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_108_25_108_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_25_108_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
            </span><a href="#loc_173_1_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_11&#39;)"><span class="hl_varref"><span class="mpre">mutableXor</span></span></a><span class="mpre"> </span><a href="#loc_108_23_108_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_24&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_108_20_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_22&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_108_25_108_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_25_108_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_108_17_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            </span><a href="#loc_51_5_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_22&#39;)"><span class="hl_varref"><span class="mpre">ecbEncryptMutable</span></span></a><span class="mpre"> </span><a href="#loc_107_19_107_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_108_23_108_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_24&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_108_23_108_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_24&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_108_17_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_108_25_108_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_25_108_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_114_1_114_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_18&#39;)"><span class="mpre">cbcDecryptGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 22, srcSpanEndLine = 113, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 43, srcSpanEndLine = 113, srcSpanEndColumn = 45}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilena"><span class="mpre">BlockCipherIO cipher =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrIV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BufferLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_114_1_114_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_18&#39;)"><span class="hl_fundecl"><span class="mpre">cbcDecryptGeneric</span></span></a><span class="mpre"> </span><a name="loc_114_19_114_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_19_114_25&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> = </span><a href="#loc_165_1_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_7&#39;)"><span class="hl_varref"><span class="mpre">loopBS</span></span></a><span class="mpre"> </span><a href="#loc_114_19_114_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_19_114_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_115_9_115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_16&#39;)"><span class="hl_varref"><span class="mpre">decrypt</span></span></a><span class="mpre">
  where </span><a name="loc_115_9_115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_16&#39;)"><span class="hl_fundecl"><span class="mpre">decrypt</span></span></a><span class="mpre"> </span><a name="loc_115_17_115_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_17_115_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a name="loc_115_20_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_20_115_22&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a name="loc_115_23_115_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_23_115_24&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_115_25_115_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_25_115_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
            </span><a href="#loc_51_5_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_22&#39;)"><span class="hl_varref"><span class="mpre">ecbEncryptMutable</span></span></a><span class="mpre"> </span><a href="#loc_114_19_114_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_19_114_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_115_23_115_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_23_115_24&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_115_25_115_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_25_115_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_115_17_115_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_17_115_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
            </span><span class="hl_comment"><span class="mpre">-- FIXME only work if s != d</span></span><span class="mpre">
            </span><a href="#loc_173_1_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_11&#39;)"><span class="hl_varref"><span class="mpre">mutableXor</span></span></a><span class="mpre"> </span><a href="#loc_115_23_115_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_23_115_24&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_115_20_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_20_115_22&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_115_23_115_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_23_115_24&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_115_17_115_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_17_115_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_115_23_115_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_23_115_24&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
cfbEncryptGeneric :: BlockCipherIO cipher =&gt; cipher -&gt; PtrIV -&gt; PtrDest -&gt; PtrSource -&gt; BufferLength -&gt; IO ()
cfbEncryptGeneric cipher = loopBS cipher encrypt
  where encrypt bs iv d s = do
            ecbEncryptMutable cipher d iv (fromIntegral bs)
            mutableXor d d s bs
            return d


cfbDecryptGeneric :: BlockCipherIO cipher =&gt; cipher -&gt; PtrIV -&gt; PtrDest -&gt; PtrSource -&gt; BufferLength -&gt; IO ()
cfbDecryptGeneric cipher = loopBS cipher decrypt
  where decrypt bs iv d s = do
            ecbEncryptMutable cipher d iv (fromIntegral bs)
            mutableXor d d s bs
            return s

ctrCombineGeneric :: BlockCipherIO cipher =&gt; cipher -&gt; PtrIV -&gt; PtrDest -&gt; PtrSource -&gt; BufferLength -&gt; IO ()
ctrCombineGeneric cipher ivini dst src len = return () {-B.concat $ doCnt ivini $ chunk (blockSize cipher) input
  where doCnt _  [] = []
        doCnt iv (i:is) =
            let ivEnc = ecbEncrypt cipher (toBytes iv)
             in bxor i ivEnc : doCnt (ivAdd iv 1) is-}
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Helper to use a purer interface</span></span><span class="mpre">
</span><a href="#loc_153_1_153_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_8&#39;)"><span class="mpre">onBlock</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 12, srcSpanEndLine = 147, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 9, srcSpanEndLine = 147, srcSpanEndColumn = 11}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilenam"><span class="mpre">BlockCipherIO cipher
        =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">
        -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
        -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">BufferLength</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_153_1_153_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_8&#39;)"><span class="hl_fundecl"><span class="mpre">onBlock</span></span></a><span class="mpre"> </span><a name="loc_153_9_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_15&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a name="loc_153_16_153_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_16_153_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_153_18_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_18_153_21&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a name="loc_153_22_153_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_22_153_25&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_153_26_153_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_26_153_29&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="#loc_165_1_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_7&#39;)"><span class="hl_varref"><span class="mpre">loopBS</span></span></a><span class="mpre"> </span><a href="#loc_153_9_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_15&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_154_9_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_13&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> </span><a href="#loc_153_18_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_18_153_21&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a href="#loc_153_22_153_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_22_153_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_153_26_153_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_26_153_29&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
  where </span><a name="loc_154_9_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a name="loc_154_14_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_14_154_16&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a name="loc_154_17_154_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_17_154_23&#39;)"><span class="hl_vardecl"><span class="mpre">fakeIv</span></span></a><span class="mpre"> </span><a name="loc_154_24_154_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_24_154_25&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_154_26_154_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_26_154_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
            </span><a name="loc_155_13_155_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_13_155_17&#39;)"><span class="hl_vardecl"><span class="mpre">fSrc</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newForeignPtr_</span></span><span class="mpre"> </span><a href="#loc_154_26_154_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_26_154_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
            let </span><a name="loc_156_17_156_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_17_156_20&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = </span><a href="#loc_153_16_153_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_16_153_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_400_1_400_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_400_1_400_15&#39;)"><span class="hl_varref"><span class="mpre">B.fromForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_155_13_155_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_13_155_17&#39;)"><span class="hl_varref"><span class="mpre">fSrc</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_154_14_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_14_154_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
            </span><a href="Data.Byteable.html#loc_31_5_31_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_31_5_31_16&#39;)"><span class="hl_varref"><span class="mpre">withBytePtr</span></span></a><span class="mpre"> </span><a href="#loc_156_17_156_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_17_156_20&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_157_32_157_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_32_157_33&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">B.memcpy</span></span></a><span class="mpre"> </span><a href="#loc_154_24_154_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_24_154_25&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_157_32_157_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_32_157_33&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_154_14_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_14_154_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_154_17_154_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_17_154_23&#39;)"><span class="hl_varref"><span class="mpre">fakeIv</span></span></a><span class="mpre">

</span><a href="#loc_165_1_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_7&#39;)"><span class="mpre">loopBS</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 160, srcSpanStartColumn = 11, srcSpanEndLine = 161, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 8, srcSpanEndLine = 161, srcSpanEndColumn = 10}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilenam"><span class="mpre">BlockCipherIO cipher
       =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">
       -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrIV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">PtrIV</span></span><span class="mpre">)
       -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrIV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BufferLength</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_165_1_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_7&#39;)"><span class="hl_fundecl"><span class="mpre">loopBS</span></span></a><span class="mpre"> </span><a name="loc_165_8_165_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_14&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a name="loc_165_15_165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_15_165_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_165_17_165_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_17_165_19&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a name="loc_165_20_165_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_20_165_23&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a name="loc_165_24_165_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_24_165_27&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_165_28_165_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_28_165_31&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="#loc_167_9_167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_165_17_165_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_17_165_19&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_165_20_165_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_20_165_23&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a href="#loc_165_24_165_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_24_165_27&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_165_28_165_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_28_165_31&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
  where </span><a name="loc_166_9_166_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="Crypto.Cipher.Types.Block.html#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_165_8_165_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_14&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">
        </span><a name="loc_167_9_167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> _ _ _ </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="#loc_167_9_167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_168_14_168_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_14_168_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_168_16_168_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_16_168_17&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_168_18_168_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_18_168_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_168_20_168_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_20_168_21&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = do
            </span><a name="loc_169_13_169_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_13_169_18&#39;)"><span class="hl_vardecl"><span class="mpre">newIV</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_165_15_165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_15_165_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_166_9_166_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_168_14_168_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_14_168_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_168_16_168_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_16_168_17&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_168_18_168_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_18_168_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
            </span><a href="#loc_167_9_167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_169_13_169_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_13_169_18&#39;)"><span class="hl_varref"><span class="mpre">newIV</span></span></a><span class="mpre"> (</span><a href="#loc_168_16_168_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_16_168_17&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_166_9_166_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) (</span><a href="#loc_168_18_168_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_18_168_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_166_9_166_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) (</span><a href="#loc_168_20_168_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_20_168_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_166_9_166_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)

</span><a href="#loc_173_1_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_11&#39;)"><span class="mpre">mutableXor</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">PtrDest</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrSource</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PtrIV</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_173_1_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_11&#39;)"><span class="hl_fundecl"><span class="mpre">mutableXor</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 13, srcSpanEndLine = 173, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 18, srcSpanEndLine = 173, srcSpanEndColumn = 20}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">to64 -&gt; dst</span></span><span class="mpre">) (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 27, srcSpanEndLine = 173, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 32, srcSpanEndLine = 173, srcSpanEndColumn = 34}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">to64 -&gt; src</span></span><span class="mpre">) (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 41, srcSpanEndLine = 173, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 46, srcSpanEndLine = 173, srcSpanEndColumn = 48}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">to64 -&gt; iv</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> = do
    </span><a href="#loc_186_1_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_13&#39;)"><span class="hl_varref"><span class="mpre">peeksAndPoke</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dst</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">src</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iv</span></span><span class="mpre">
    </span><a href="#loc_186_1_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_13&#39;)"><span class="hl_varref"><span class="mpre">peeksAndPoke</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">dst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">src</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) ((</span><span class="hl_varref"><span class="mpre">iv</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">)
</span><a href="#loc_173_1_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_11&#39;)"><span class="hl_fundecl"><span class="mpre">mutableXor</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 13, srcSpanEndLine = 176, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 18, srcSpanEndLine = 176, srcSpanEndColumn = 20}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">to64 -&gt; dst</span></span><span class="mpre">) (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 27, srcSpanEndLine = 176, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 32, srcSpanEndLine = 176, srcSpanEndColumn = 34}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">to64 -&gt; src</span></span><span class="mpre">) (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 41, srcSpanEndLine = 176, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 46, srcSpanEndLine = 176, srcSpanEndColumn = 48}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">to64 -&gt; iv</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> = do
    </span><a href="#loc_186_1_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_13&#39;)"><span class="hl_varref"><span class="mpre">peeksAndPoke</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dst</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">src</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iv</span></span><span class="mpre">
</span><a href="#loc_173_1_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_11&#39;)"><span class="hl_fundecl"><span class="mpre">mutableXor</span></span></a><span class="mpre"> </span><a name="loc_178_12_178_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_15&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a name="loc_178_16_178_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_16_178_19&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_178_20_178_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_20_178_22&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a name="loc_178_23_178_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_23_178_26&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="#loc_179_9_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_9_179_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_178_12_178_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_15&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a href="#loc_178_16_178_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_16_178_19&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_178_20_178_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_20_178_22&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_178_23_178_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_23_178_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
  where </span><a name="loc_179_9_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_9_179_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> _ _ _ </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="#loc_179_9_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_9_179_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_180_14_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_14_180_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_180_16_180_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_16_180_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_180_18_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_180_20_180_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_20_180_21&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_186_1_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_13&#39;)"><span class="hl_varref"><span class="mpre">peeksAndPoke</span></span></a><span class="mpre"> </span><a href="#loc_180_14_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_14_180_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_180_16_180_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_16_180_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_180_18_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_179_9_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_9_179_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_180_14_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_14_180_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_180_16_180_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_16_180_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_180_18_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_180_20_180_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_20_180_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><a href="#loc_183_1_183_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_5&#39;)"><span class="mpre">to64</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
</span><a name="loc_183_1_183_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_5&#39;)"><span class="hl_vardecl"><span class="mpre">to64</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre">

</span><a href="#loc_186_1_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_13&#39;)"><span class="mpre">peeksAndPoke</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 185, srcSpanStartColumn = 17, srcSpanEndLine = 185, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/BlockIO.hs&quot;, srcSpanStartLine = 185, srcSpanStartColumn = 17, srcSpanEndLine = 185, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-c"><span class="mpre">(Bits a, Storable a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_186_1_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_13&#39;)"><span class="hl_fundecl"><span class="mpre">peeksAndPoke</span></span></a><span class="mpre"> </span><a name="loc_186_14_186_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_14_186_17&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a name="loc_186_18_186_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_18_186_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_186_20_186_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_20_186_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = (</span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">xor</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_186_18_186_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_18_186_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_186_20_186_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_20_186_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_186_14_186_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_14_186_17&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre">
</span></div></body></html>