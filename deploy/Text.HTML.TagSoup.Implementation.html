<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RecordWildCards, PatternGuards, ScopedTypeVariables #-}

module Text.HTML.TagSoup.Implementation where

import Text.HTML.TagSoup.Type
import Text.HTML.TagSoup.Options
import Text.StringLike as Str
import Numeric
import Data.Char
import Data.Ix
import Control.Exception(assert)
import Control.Arrow

</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- BOTTOM LAYER</span></span><span class="mpre">

data </span><a name="loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tycondecl"><span class="mpre">Out</span></span></a><span class="mpre">
    = </span><a name="loc_18_7_18_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_7_18_11&#39;)"><span class="hl_condecl"><span class="mpre">Char</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
    | </span><a name="loc_19_7_19_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_7_19_10&#39;)"><span class="hl_condecl"><span class="mpre">Tag</span></span></a><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- &lt;</span></span><span class="mpre">
    | </span><a name="loc_20_7_20_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_7_20_14&#39;)"><span class="hl_condecl"><span class="mpre">TagShut</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- &lt;/</span></span><span class="mpre">
    | </span><a name="loc_21_7_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_7_21_14&#39;)"><span class="hl_condecl"><span class="mpre">AttName</span></span></a><span class="mpre">
    | </span><a name="loc_22_7_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_7_22_13&#39;)"><span class="hl_condecl"><span class="mpre">AttVal</span></span></a><span class="mpre">
    | </span><a name="loc_23_7_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_7_23_13&#39;)"><span class="hl_condecl"><span class="mpre">TagEnd</span></span></a><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
    | </span><a name="loc_24_7_24_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_7_24_18&#39;)"><span class="hl_condecl"><span class="mpre">TagEndClose</span></span></a><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- /&gt;</span></span><span class="mpre">
    | </span><a name="loc_25_7_25_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_7_25_14&#39;)"><span class="hl_condecl"><span class="mpre">Comment</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- &lt;!--</span></span><span class="mpre">
    | </span><a name="loc_26_7_26_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_17&#39;)"><span class="hl_condecl"><span class="mpre">CommentEnd</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- --&gt;</span></span><span class="mpre">
    | </span><a name="loc_27_7_27_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_17&#39;)"><span class="hl_condecl"><span class="mpre">EntityName</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- &amp;</span></span><span class="mpre">
    | </span><a name="loc_28_7_28_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_7_28_16&#39;)"><span class="hl_condecl"><span class="mpre">EntityNum</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- &amp;#</span></span><span class="mpre">
    | </span><a name="loc_29_7_29_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_7_29_16&#39;)"><span class="hl_condecl"><span class="mpre">EntityHex</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- &amp;#x</span></span><span class="mpre">
    | </span><a name="loc_30_7_30_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_7_30_16&#39;)"><span class="hl_condecl"><span class="mpre">EntityEnd</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- Attributed followed by ; for True, missing ; for False</span></span><span class="mpre">
    | </span><a name="loc_31_7_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_11&#39;)"><span class="hl_condecl"><span class="mpre">Warn</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    | </span><a name="loc_32_7_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_10&#39;)"><span class="hl_condecl"><span class="mpre">Pos</span></span></a><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_39_6_39_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_39_6_39_14&#39;)"><span class="hl_tyconref"><span class="mpre">Position</span></span></a><span class="mpre">
      </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 7, srcSpanEndLine = 33, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 7, srcSpanEndLine = 33, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><a name="loc_35_1_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_8&#39;)"><span class="hl_fundecl"><span class="mpre">errSeen</span></span></a><span class="mpre"> </span><a name="loc_35_9_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_31_7_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_11&#39;)"><span class="hl_conref"><span class="mpre">Warn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Unexpected &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_35_9_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a name="loc_36_1_36_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_8&#39;)"><span class="hl_fundecl"><span class="mpre">errWant</span></span></a><span class="mpre"> </span><a name="loc_36_9_36_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_31_7_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_11&#39;)"><span class="hl_conref"><span class="mpre">Warn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expected &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_36_9_36_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

data </span><a name="loc_38_6_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_7&#39;)"><span class="hl_tycondecl"><span class="mpre">S</span></span></a><span class="mpre"> = </span><a name="loc_38_10_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_10_38_11&#39;)"><span class="hl_condecl"><span class="mpre">S</span></span></a><span class="mpre">
    {</span><a name="loc_39_6_39_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_6_39_7&#39;)"><span class="hl_fielddecl"><span class="mpre">s</span></span></a><span class="mpre"> :: </span><a href="#loc_38_6_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_7&#39;)"><span class="hl_tyconref"><span class="mpre">S</span></span></a><span class="mpre">
    ,</span><a name="loc_40_6_40_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_8&#39;)"><span class="hl_fielddecl"><span class="mpre">tl</span></span></a><span class="mpre"> :: </span><a href="#loc_38_6_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_7&#39;)"><span class="hl_tyconref"><span class="mpre">S</span></span></a><span class="mpre">
    ,</span><a name="loc_41_6_41_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_8&#39;)"><span class="hl_fielddecl"><span class="mpre">hd</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
    ,</span><a name="loc_42_6_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_6_42_9&#39;)"><span class="hl_fielddecl"><span class="mpre">eof</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    ,</span><a name="loc_43_6_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_6_43_10&#39;)"><span class="hl_fielddecl"><span class="mpre">next</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_38_6_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_7&#39;)"><span class="hl_tyconref"><span class="mpre">S</span></span></a><span class="mpre">
    ,</span><a name="loc_44_6_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_9&#39;)"><span class="hl_fielddecl"><span class="mpre">pos</span></span></a><span class="mpre"> :: [</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">] -&gt; [</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">]
    }


</span><a href="#loc_49_1_49_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_7&#39;)"><span class="mpre">expand</span></a><span class="mpre"> :: </span><a href="Text.HTML.TagSoup.Type.html#loc_39_6_39_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_39_6_39_14&#39;)"><span class="hl_tyconref"><span class="mpre">Position</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_38_6_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_7&#39;)"><span class="hl_tyconref"><span class="mpre">S</span></span></a><span class="mpre">
</span><a name="loc_49_1_49_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_7&#39;)"><span class="hl_fundecl"><span class="mpre">expand</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">text</span></span><span class="mpre"> = </span><a href="#loc_50_11_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_14&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
    where </span><a name="loc_50_11_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_14&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 17, srcSpanEndLine = 56, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 18, srcSpanEndLine = 50, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HT"><span class="mpre">S{s = res
                 ,tl = expand (positionChar p (head text)) (tail text)
                 ,hd = if null text then &#39;\0&#39; else head text
                 ,eof = null text
                 ,next = next p text
                 ,pos = (Pos p:)
                 }</span></span><span class="mpre">

          </span><a name="loc_58_11_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_11_58_15&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_58_16_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_16_58_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a name="loc_58_19_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_19_58_20&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_58_21_58_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_21_58_24&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre">) (</span><a name="loc_58_27_58_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_27_58_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_58_29_58_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_29_58_31&#39;)"><span class="hl_vardecl"><span class="mpre">tr</span></span></a><span class="mpre">) | </span><a href="#loc_58_19_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_19_58_20&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_58_27_58_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_27_58_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_58_11_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_11_58_15&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_48_1_48_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_48_1_48_13&#39;)"><span class="hl_varref"><span class="mpre">positionChar</span></span></a><span class="mpre"> </span><a href="#loc_58_16_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_16_58_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_58_19_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_19_58_20&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="#loc_58_21_58_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_21_58_24&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre"> </span><a href="#loc_58_29_58_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_29_58_31&#39;)"><span class="hl_varref"><span class="mpre">tr</span></span></a><span class="mpre">
          </span><a href="#loc_58_11_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_11_58_15&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_59_16_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_16_59_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_59_18_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_18_59_22&#39;)"><span class="hl_vardecl"><span class="mpre">text</span></span></a><span class="mpre"> [] = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_49_1_49_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_7&#39;)"><span class="hl_varref"><span class="mpre">expand</span></span></a><span class="mpre"> </span><a href="#loc_59_16_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_16_59_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_59_18_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_18_59_22&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre">
          </span><a href="#loc_58_11_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_11_58_15&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> _ _ _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">


</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 1, srcSpanEndLine = 63, srcSpanEndColumn = 9}, srcInfoPoints = []}) (AssocRight (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 1, srcSpanEndLine = 63, srcSpanEndColumn = 7}, srcInfoPoints = []})) Nothing [VarO"><span class="mpre">infixr &amp;</span></span><span class="mpre">

class </span><a name="loc_65_7_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_14&#39;)"><span class="hl_classdecl"><span class="mpre">Outable</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where </span><a name="loc_65_23_65_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_26&#39;)"><span class="mpre">(&amp;)</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">] -&gt; [</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">]
instance </span><a href="#loc_65_7_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_14&#39;)"><span class="hl_classref"><span class="mpre">Outable</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> where </span><a href="#loc_65_23_65_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_26&#39;)"><span class="hl_vardecl"><span class="mpre">(&amp;)</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_8&#39;)"><span class="hl_varref"><span class="mpre">ampChar</span></span></a><span class="mpre">
instance </span><a href="#loc_65_7_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_14&#39;)"><span class="hl_classref"><span class="mpre">Outable</span></span></a><span class="mpre"> </span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre"> where </span><a href="#loc_65_23_65_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_26&#39;)"><span class="hl_vardecl"><span class="mpre">(&amp;)</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_varref"><span class="mpre">ampOut</span></span></a><span class="mpre">
</span><a name="loc_68_1_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_8&#39;)"><span class="hl_fundecl"><span class="mpre">ampChar</span></span></a><span class="mpre"> </span><a name="loc_68_9_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_68_11_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_12&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_18_7_18_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_7_18_11&#39;)"><span class="hl_conref"><span class="mpre">Char</span></span></a><span class="mpre"> </span><a href="#loc_68_9_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_68_11_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
</span><a name="loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_fundecl"><span class="mpre">ampOut</span></span></a><span class="mpre"> </span><a name="loc_69_8_69_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_8_69_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_69_10_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_69_8_69_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_8_69_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_69_10_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">


</span><a href="#loc_73_1_73_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_6&#39;)"><span class="mpre">state</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_38_6_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_7&#39;)"><span class="hl_tyconref"><span class="mpre">S</span></span></a><span class="mpre">
</span><a name="loc_73_1_73_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_6&#39;)"><span class="hl_fundecl"><span class="mpre">state</span></span></a><span class="mpre"> </span><a name="loc_73_7_73_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_7_73_8&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_49_1_49_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_7&#39;)"><span class="hl_varref"><span class="mpre">expand</span></span></a><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_42_1_42_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_42_1_42_13&#39;)"><span class="hl_varref"><span class="mpre">nullPosition</span></span></a><span class="mpre"> </span><a href="#loc_73_7_73_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_7_73_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TOP LAYER</span></span><span class="mpre">


</span><a href="#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="mpre">output</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre"> . </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 24, srcSpanEndLine = 79, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 39, srcSpanEndLine = 79, srcSpanEndColumn = 41}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagr"><span class="mpre">StringLike str =&gt;</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Options.html#loc_34_6_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_34_6_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseOptions</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre"> -&gt; [</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">] -&gt; [</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]
</span><a name="loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="hl_fundecl"><span class="mpre">output</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 8, srcSpanEndLine = 80, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 20, srcSpanEndLine = 80, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/Tag"><span class="mpre">ParseOptions{..}</span></span><span class="mpre"> </span><a name="loc_80_25_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_25_80_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (if </span><a href="Text.HTML.TagSoup.Options.html#loc_39_6_39_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_39_6_39_21&#39;)"><span class="hl_varref"><span class="mpre">optTagTextMerge</span></span></a><span class="mpre"> then </span><a href="#loc_176_1_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_13&#39;)"><span class="hl_varref"><span class="mpre">tagTextMerge</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> ((</span><a href="Text.HTML.TagSoup.Type.html#loc_42_1_42_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_42_1_42_13&#39;)"><span class="hl_varref"><span class="mpre">nullPosition</span></span></a><span class="mpre">,[]),</span><a href="#loc_80_25_80_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_25_80_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    where
        </span><span class="hl_comment"><span class="mpre">-- main choice loop</span></span><span class="mpre">
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="mpre">go</span></a><span class="mpre"> :: ((</span><a href="Text.HTML.TagSoup.Type.html#loc_39_6_39_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_39_6_39_14&#39;)"><span class="hl_tyconref"><span class="mpre">Position</span></span></a><span class="mpre">,[</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]),[</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">]) -&gt; [</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]
        </span><a name="loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> ((</span><a name="loc_84_14_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_14_84_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">ws</span></span><span class="mpre">),</span><span class="hl_vardecl"><span class="mpre">xs</span></span><span class="mpre">) | </span><a href="#loc_84_14_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_14_84_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> = [] </span><span class="hl_comment"><span class="mpre">-- otherwise p is a space leak when optTagPosition == False</span></span><span class="mpre">
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> ((</span><a name="loc_85_14_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_85_16_85_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_16_85_18&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">),</span><a name="loc_85_20_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_20_85_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_85_16_85_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_16_85_18&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre"> = (if </span><a href="Text.HTML.TagSoup.Options.html#loc_36_6_36_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_36_6_36_19&#39;)"><span class="hl_varref"><span class="mpre">optTagWarning</span></span></a><span class="mpre"> then (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_85_16_85_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_16_85_18&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) else </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> ((</span><a href="#loc_85_14_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,[]),</span><a href="#loc_85_20_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_20_85_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> ((</span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre">,</span><a name="loc_86_16_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">),</span><a href="#loc_32_7_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_10&#39;)"><span class="hl_conref"><span class="mpre">Pos</span></span></a><span class="mpre"> </span><a name="loc_86_24_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_24_86_26&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_86_27_86_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_27_86_29&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> ((</span><a href="#loc_86_24_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_24_86_26&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre">,</span><a href="#loc_86_16_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_18&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">),</span><a href="#loc_86_27_86_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_27_86_29&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_88_12_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_12_88_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_152_1_152_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_7&#39;)"><span class="hl_varref"><span class="mpre">isChar</span></span></a><span class="mpre"> </span><a href="#loc_88_12_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_12_88_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_88_12_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_12_88_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_62_6_62_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_62_6_62_13&#39;)"><span class="hl_conref"><span class="mpre">TagText</span></span></a><span class="mpre"> </span><a href="#loc_89_22_89_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_22_89_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_89_20_89_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_20_89_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
            where (</span><a name="loc_89_20_89_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_20_89_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_89_22_89_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_22_89_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">charsStr</span></span></a><span class="mpre"> </span><a href="#loc_88_12_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_12_88_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_90_12_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_153_1_153_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_6&#39;)"><span class="hl_varref"><span class="mpre">isTag</span></span></a><span class="mpre"> </span><a href="#loc_90_12_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_90_12_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_60_6_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_60_6_60_13&#39;)"><span class="hl_conref"><span class="mpre">TagOpen</span></span></a><span class="mpre"> </span><a href="#loc_91_22_91_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_22_91_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_92_22_92_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_22_92_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (if </span><a href="#loc_158_1_158_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_14&#39;)"><span class="hl_varref"><span class="mpre">isTagEndClose</span></span></a><span class="mpre"> </span><a href="#loc_92_20_92_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_21&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> then </span><a href="#loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_90_12_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_61_6_61_14&#39;)"><span class="hl_conref"><span class="mpre">TagClose</span></span></a><span class="mpre"> </span><a href="#loc_91_22_91_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_22_91_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_92_20_92_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_21&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">) else </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_138_9_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_13&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="hl_varref"><span class="mpre">isTagEnd</span></span></a><span class="mpre"> </span><a href="#loc_92_20_92_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_21&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">))
            where (</span><a name="loc_91_20_91_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_20_91_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_91_22_91_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_22_91_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">charsStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_90_12_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                  (</span><a name="loc_92_20_92_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_21&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">,</span><a name="loc_92_22_92_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_22_92_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_108_9_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_13&#39;)"><span class="hl_varref"><span class="mpre">atts</span></span></a><span class="mpre"> </span><a href="#loc_91_20_91_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_20_91_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_93_12_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_154_1_154_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_10&#39;)"><span class="hl_varref"><span class="mpre">isTagShut</span></span></a><span class="mpre"> </span><a href="#loc_93_12_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_93_12_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_61_6_61_14&#39;)"><span class="hl_conref"><span class="mpre">TagClose</span></span></a><span class="mpre"> </span><a href="#loc_96_22_96_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_22_96_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                (if </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_97_22_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_22_97_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) then </span><a href="#loc_141_9_141_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_13&#39;)"><span class="hl_varref"><span class="mpre">warn</span></span></a><span class="mpre"> </span><a href="#loc_93_12_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Unexpected attributes in close tag&quot;</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                if </span><a href="#loc_158_1_158_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_14&#39;)"><span class="hl_varref"><span class="mpre">isTagEndClose</span></span></a><span class="mpre"> </span><a href="#loc_97_20_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_21&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> then </span><a href="#loc_141_9_141_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_13&#39;)"><span class="hl_varref"><span class="mpre">warn</span></span></a><span class="mpre"> </span><a href="#loc_93_12_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Unexpected self-closing in close tag&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_97_20_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_21&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">) else </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_138_9_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_13&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="hl_varref"><span class="mpre">isTagEnd</span></span></a><span class="mpre"> </span><a href="#loc_97_20_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_21&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)
            where (</span><a name="loc_96_20_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_20_96_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_96_22_96_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_22_96_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">charsStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_93_12_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                  (</span><a name="loc_97_20_97_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_21&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">,</span><a name="loc_97_22_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_22_97_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_108_9_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_13&#39;)"><span class="hl_varref"><span class="mpre">atts</span></span></a><span class="mpre"> </span><a href="#loc_96_20_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_20_96_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_159_1_159_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_10&#39;)"><span class="hl_varref"><span class="mpre">isComment</span></span></a><span class="mpre"> </span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_63_6_63_16&#39;)"><span class="hl_conref"><span class="mpre">TagComment</span></span></a><span class="mpre"> </span><a href="#loc_99_22_99_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_22_99_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_138_9_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_13&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_160_1_160_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_13&#39;)"><span class="hl_varref"><span class="mpre">isCommentEnd</span></span></a><span class="mpre"> </span><a href="#loc_99_20_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_20_99_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
            where (</span><a name="loc_99_20_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_20_99_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_99_22_99_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_22_99_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">charsStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_100_12_100_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_12_100_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_161_1_161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_13&#39;)"><span class="hl_varref"><span class="mpre">isEntityName</span></span></a><span class="mpre"> </span><a href="#loc_100_12_100_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_12_100_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_142_9_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_13&#39;)"><span class="hl_varref"><span class="mpre">poss</span></span></a><span class="mpre"> </span><a href="#loc_100_12_100_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_12_100_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> ((if </span><a href="Text.HTML.TagSoup.Options.html#loc_36_6_36_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_36_6_36_19&#39;)"><span class="hl_varref"><span class="mpre">optTagWarning</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_105_1_105_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_105_1_105_13&#39;)"><span class="hl_varref"><span class="mpre">isTagWarning</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Options.html#loc_37_6_37_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_37_6_37_19&#39;)"><span class="hl_varref"><span class="mpre">optEntityData</span></span></a><span class="mpre"> (</span><a href="#loc_101_22_101_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_22_101_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="hl_varref"><span class="mpre">getEntityEnd</span></span></a><span class="mpre"> </span><a href="#loc_101_20_101_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_138_9_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_13&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_165_1_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_12&#39;)"><span class="hl_varref"><span class="mpre">isEntityEnd</span></span></a><span class="mpre"> </span><a href="#loc_101_20_101_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) 
            where (</span><a name="loc_101_20_101_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_101_22_101_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_22_101_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">charsStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_100_12_100_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_12_100_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_102_12_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_12_102_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_162_1_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_15&#39;)"><span class="hl_varref"><span class="mpre">isEntityNumHex</span></span></a><span class="mpre"> </span><a href="#loc_102_12_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_12_102_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_102_12_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_12_102_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_62_6_62_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_62_6_62_13&#39;)"><span class="hl_conref"><span class="mpre">TagText</span></span></a><span class="mpre"> (</span><a href="Text.StringLike.html#loc_34_5_34_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_34_5_34_13&#39;)"><span class="hl_varref"><span class="mpre">fromChar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_145_1_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_10&#39;)"><span class="hl_varref"><span class="mpre">entityChr</span></span></a><span class="mpre"> </span><a href="#loc_102_12_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_12_102_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_103_22_103_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_22_103_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_138_9_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_13&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_165_1_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_12&#39;)"><span class="hl_varref"><span class="mpre">isEntityEnd</span></span></a><span class="mpre"> </span><a href="#loc_103_20_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_20_103_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
            where (</span><a name="loc_103_20_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_20_103_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_103_22_103_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_22_103_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_116_9_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_14&#39;)"><span class="hl_varref"><span class="mpre">chars</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_102_12_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_12_102_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">a</span></span><span class="mpre"> &lt;- </span><a href="#loc_169_1_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_9&#39;)"><span class="hl_varref"><span class="mpre">fromWarn</span></span></a><span class="mpre"> </span><a href="#loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><a href="Text.HTML.TagSoup.Options.html#loc_36_6_36_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_36_6_36_19&#39;)"><span class="hl_varref"><span class="mpre">optTagWarning</span></span></a><span class="mpre"> then </span><a href="#loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_64_6_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_64_6_64_16&#39;)"><span class="hl_conref"><span class="mpre">TagWarning</span></span></a><span class="mpre"> (</span><a href="Text.StringLike.html#loc_32_5_32_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_32_5_32_15&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) else </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
        </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_105_12_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_12_105_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_151_1_151_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_6&#39;)"><span class="hl_varref"><span class="mpre">isEof</span></span></a><span class="mpre"> </span><a href="#loc_105_12_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_12_105_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = []

        </span><a href="#loc_108_9_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_13&#39;)"><span class="mpre">atts</span></a><span class="mpre"> :: ((</span><a href="Text.HTML.TagSoup.Type.html#loc_39_6_39_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_39_6_39_14&#39;)"><span class="hl_tyconref"><span class="mpre">Position</span></span></a><span class="mpre">,[</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]),[</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">]) -&gt; ( ((</span><a href="Text.HTML.TagSoup.Type.html#loc_39_6_39_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_39_6_39_14&#39;)"><span class="hl_tyconref"><span class="mpre">Position</span></span></a><span class="mpre">,[</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]),[</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">]) , [(</span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">)] )
        </span><a name="loc_108_9_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_13&#39;)"><span class="hl_fundecl"><span class="mpre">atts</span></span></a><span class="mpre"> </span><a name="loc_108_14_108_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_14_108_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_155_1_155_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_10&#39;)"><span class="hl_varref"><span class="mpre">isAttName</span></span></a><span class="mpre"> </span><a href="#loc_108_14_108_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_14_108_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre"> ((</span><a href="#loc_109_22_109_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_22_109_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_110_22_110_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_22_110_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_108_9_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_13&#39;)"><span class="hl_varref"><span class="mpre">atts</span></span></a><span class="mpre"> </span><a href="#loc_110_20_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_20_110_21&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
            where (</span><a name="loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_109_22_109_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_22_109_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">charsStr</span></span></a><span class="mpre"> (</span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_108_14_108_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_14_108_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                  (</span><a name="loc_110_20_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_20_110_21&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">,</span><a name="loc_110_22_110_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_22_110_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = if </span><a href="#loc_156_1_156_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_9&#39;)"><span class="hl_varref"><span class="mpre">isAttVal</span></span></a><span class="mpre"> </span><a href="#loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> then </span><a href="#loc_118_9_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_21&#39;)"><span class="hl_varref"><span class="mpre">charsEntsStr</span></span></a><span class="mpre"> (</span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) else (</span><a href="#loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><a href="Text.StringLike.html#loc_22_5_22_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_22_5_22_10&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">)
        </span><a href="#loc_108_9_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_13&#39;)"><span class="hl_fundecl"><span class="mpre">atts</span></span></a><span class="mpre"> </span><a name="loc_111_14_111_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_14_111_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_156_1_156_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_9&#39;)"><span class="hl_varref"><span class="mpre">isAttVal</span></span></a><span class="mpre"> </span><a href="#loc_111_14_111_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_14_111_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre"> ((</span><a href="Text.StringLike.html#loc_22_5_22_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_22_5_22_10&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">,</span><a href="#loc_112_22_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_22_112_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_108_9_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_13&#39;)"><span class="hl_varref"><span class="mpre">atts</span></span></a><span class="mpre"> </span><a href="#loc_112_20_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
            where (</span><a name="loc_112_20_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_112_22_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_22_112_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_118_9_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_21&#39;)"><span class="hl_varref"><span class="mpre">charsEntsStr</span></span></a><span class="mpre"> (</span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_111_14_111_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_14_111_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
        </span><a href="#loc_108_9_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_13&#39;)"><span class="hl_fundecl"><span class="mpre">atts</span></span></a><span class="mpre"> </span><a name="loc_113_14_113_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_14_113_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_113_14_113_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_14_113_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, [])

        </span><span class="hl_comment"><span class="mpre">-- chars</span></span><span class="mpre">
        </span><a name="loc_116_9_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_14&#39;)"><span class="hl_fundecl"><span class="mpre">chars</span></span></a><span class="mpre"> </span><a name="loc_116_15_116_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_15_116_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_varref"><span class="mpre">charss</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_116_15_116_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_15_116_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_117_9_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_17&#39;)"><span class="hl_fundecl"><span class="mpre">charsStr</span></span></a><span class="mpre"> </span><a name="loc_117_18_117_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_18_117_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><a href="Text.StringLike.html#loc_32_5_32_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_32_5_32_15&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_116_9_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_14&#39;)"><span class="hl_varref"><span class="mpre">chars</span></span></a><span class="mpre"> </span><a href="#loc_117_18_117_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_18_117_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_118_9_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_21&#39;)"><span class="hl_fundecl"><span class="mpre">charsEntsStr</span></span></a><span class="mpre"> </span><a name="loc_118_22_118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_22_118_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><a href="Text.StringLike.html#loc_32_5_32_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_32_5_32_15&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_varref"><span class="mpre">charss</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_118_22_118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_22_118_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- loop round collecting characters, if the b is set including entity</span></span><span class="mpre">
        </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="mpre">charss</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; ((</span><a href="Text.HTML.TagSoup.Type.html#loc_39_6_39_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_39_6_39_14&#39;)"><span class="hl_tyconref"><span class="mpre">Position</span></span></a><span class="mpre">,[</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]),[</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">]) -&gt; ( ((</span><a href="Text.HTML.TagSoup.Type.html#loc_39_6_39_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_39_6_39_14&#39;)"><span class="hl_tyconref"><span class="mpre">Position</span></span></a><span class="mpre">,[</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]),[</span><a href="#loc_17_6_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_6_17_9&#39;)"><span class="hl_tyconref"><span class="mpre">Out</span></span></a><span class="mpre">]) , </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
        </span><a name="loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_fundecl"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a name="loc_122_16_122_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_16_122_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_122_18_122_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_18_122_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">a</span></span><span class="mpre"> &lt;- </span><a href="#loc_168_1_168_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_8&#39;)"><span class="hl_varref"><span class="mpre">fromChr</span></span></a><span class="mpre"> </span><a href="#loc_122_18_122_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_18_122_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_123_20_123_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_20_123_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">a</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_123_22_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_22_123_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
            where (</span><a name="loc_123_20_123_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_20_123_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_123_22_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_22_123_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_varref"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a href="#loc_122_16_122_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_16_122_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_122_18_122_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_18_122_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
        </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_fundecl"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a name="loc_124_16_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_16_124_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_124_18_124_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_18_124_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_124_16_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_16_124_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">, </span><a href="#loc_161_1_161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_13&#39;)"><span class="hl_varref"><span class="mpre">isEntityName</span></span></a><span class="mpre"> </span><a href="#loc_124_18_124_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_18_124_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre"> (</span><a href="Text.StringLike.html#loc_30_5_30_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_30_5_30_13&#39;)"><span class="hl_varref"><span class="mpre">toString</span></span></a><span class="mpre"> </span><a href="#loc_128_20_128_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_20_128_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_varref"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a href="#loc_124_16_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_16_124_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_139_9_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_17&#39;)"><span class="hl_varref"><span class="mpre">addWarns</span></span></a><span class="mpre"> </span><a href="#loc_128_22_128_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_22_128_23&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_127_19_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_19_127_20&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
            where (</span><a name="loc_125_20_125_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_20_125_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_125_22_125_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_22_125_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">charsStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_124_18_124_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_18_124_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                  </span><a name="loc_126_19_126_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_19_126_20&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="hl_varref"><span class="mpre">getEntityEnd</span></span></a><span class="mpre"> </span><a href="#loc_125_20_125_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_20_125_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                  </span><a name="loc_127_19_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_19_127_20&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="#loc_138_9_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_13&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_165_1_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_12&#39;)"><span class="hl_varref"><span class="mpre">isEntityEnd</span></span></a><span class="mpre"> </span><a href="#loc_125_20_125_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_20_125_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                  (</span><a name="loc_128_20_128_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_20_128_21&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,</span><a name="loc_128_22_128_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_22_128_23&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) = </span><a href="Text.HTML.TagSoup.Options.html#loc_38_6_38_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_38_6_38_21&#39;)"><span class="hl_varref"><span class="mpre">optEntityAttrib</span></span></a><span class="mpre"> (</span><a href="#loc_125_22_125_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_22_125_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_126_19_126_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_19_126_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_fundecl"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a name="loc_129_16_129_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_16_129_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_129_18_129_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_18_129_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_129_16_129_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_16_129_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">, </span><a href="#loc_162_1_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_15&#39;)"><span class="hl_varref"><span class="mpre">isEntityNumHex</span></span></a><span class="mpre"> </span><a href="#loc_129_18_129_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_18_129_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre"> (</span><a href="#loc_145_1_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_10&#39;)"><span class="hl_varref"><span class="mpre">entityChr</span></span></a><span class="mpre"> </span><a href="#loc_129_18_129_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_18_129_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_130_22_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_22_130_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_varref"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a href="#loc_129_16_129_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_16_129_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_131_19_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_19_131_20&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
            where (</span><a name="loc_130_20_130_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_20_130_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_130_22_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_22_130_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_116_9_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_14&#39;)"><span class="hl_varref"><span class="mpre">chars</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_129_18_129_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_18_129_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                  </span><a name="loc_131_19_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_19_131_20&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="#loc_138_9_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_13&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_165_1_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_12&#39;)"><span class="hl_varref"><span class="mpre">isEntityEnd</span></span></a><span class="mpre"> </span><a href="#loc_130_20_130_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_20_130_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
        </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_fundecl"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a name="loc_132_16_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_16_132_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> ((_,</span><a name="loc_132_22_132_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_22_132_23&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">),</span><a href="#loc_32_7_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_10&#39;)"><span class="hl_conref"><span class="mpre">Pos</span></span></a><span class="mpre"> </span><a name="loc_132_29_132_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_29_132_30&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_132_31_132_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_31_132_33&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_varref"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a href="#loc_132_16_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_16_132_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> ((</span><a href="#loc_132_29_132_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_29_132_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_132_22_132_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_22_132_23&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">),</span><a href="#loc_132_31_132_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_31_132_33&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_fundecl"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a name="loc_133_16_133_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_16_133_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_133_18_133_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_18_133_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">a</span></span><span class="mpre"> &lt;- </span><a href="#loc_169_1_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_9&#39;)"><span class="hl_varref"><span class="mpre">fromWarn</span></span></a><span class="mpre"> </span><a href="#loc_133_18_133_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_18_133_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_varref"><span class="mpre">charss</span></span></a><span class="mpre"> </span><a href="#loc_133_16_133_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_16_133_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (if </span><a href="Text.HTML.TagSoup.Options.html#loc_36_6_36_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_36_6_36_19&#39;)"><span class="hl_varref"><span class="mpre">optTagWarning</span></span></a><span class="mpre"> then </span><a href="#loc_139_9_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_17&#39;)"><span class="hl_varref"><span class="mpre">addWarns</span></span></a><span class="mpre"> [</span><a href="Text.HTML.TagSoup.Type.html#loc_64_6_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_64_6_64_16&#39;)"><span class="hl_conref"><span class="mpre">TagWarning</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.StringLike.html#loc_32_5_32_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_32_5_32_15&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">a</span></span><span class="mpre">] else </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_133_18_133_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_18_133_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="#loc_122_9_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_15&#39;)"><span class="hl_fundecl"><span class="mpre">charss</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre"> </span><a name="loc_134_18_134_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_18_134_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_134_18_134_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_18_134_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, [])

        </span><span class="hl_comment"><span class="mpre">-- utility functions</span></span><span class="mpre">
        </span><a name="loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_137_14_137_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_14_137_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_137_14_137_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_14_137_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_138_9_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_13&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a name="loc_138_14_138_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_14_138_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_138_16_138_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_16_138_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_151_1_151_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_6&#39;)"><span class="hl_varref"><span class="mpre">isEof</span></span></a><span class="mpre"> </span><a href="#loc_138_16_138_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_16_138_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_138_14_138_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_14_138_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_138_16_138_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_16_138_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_137_9_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_13&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_138_16_138_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_16_138_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
        </span><a name="loc_139_9_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_17&#39;)"><span class="hl_fundecl"><span class="mpre">addWarns</span></span></a><span class="mpre"> </span><a name="loc_139_18_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_20&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre"> </span><a name="loc_139_21_139_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_21_139_22&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@((</span><a name="loc_139_25_139_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_25_139_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_139_27_139_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_27_139_28&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">),</span><a name="loc_139_30_139_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_30_139_31&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = ((</span><a href="#loc_139_25_139_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_25_139_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> (</span><a href="#loc_142_9_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_13&#39;)"><span class="hl_varref"><span class="mpre">poss</span></span></a><span class="mpre"> </span><a href="#loc_139_21_139_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_21_139_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_139_18_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_20&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_139_27_139_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_27_139_28&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">), </span><a href="#loc_139_30_139_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_30_139_31&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
        </span><a name="loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_fundecl"><span class="mpre">pos</span></span></a><span class="mpre"> ((</span><a name="loc_140_15_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,_),_) </span><a name="loc_140_23_140_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_23_140_27&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> = if </span><a href="Text.HTML.TagSoup.Options.html#loc_35_6_35_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_35_6_35_20&#39;)"><span class="hl_varref"><span class="mpre">optTagPosition</span></span></a><span class="mpre"> then </span><a href="Text.HTML.TagSoup.Type.html#loc_54_1_54_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_54_1_54_12&#39;)"><span class="hl_varref"><span class="mpre">tagPosition</span></span></a><span class="mpre"> </span><a href="#loc_140_15_140_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_140_23_140_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_23_140_27&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> else </span><a href="#loc_140_23_140_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_23_140_27&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a name="loc_141_9_141_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_13&#39;)"><span class="hl_fundecl"><span class="mpre">warn</span></span></a><span class="mpre"> </span><a name="loc_141_14_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_14_141_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_141_16_141_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_16_141_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_141_18_141_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_18_141_22&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> = if </span><a href="Text.HTML.TagSoup.Options.html#loc_36_6_36_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Options.html#loc_36_6_36_19&#39;)"><span class="hl_varref"><span class="mpre">optTagWarning</span></span></a><span class="mpre"> then </span><a href="#loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_141_14_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_14_141_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.HTML.TagSoup.Type.html#loc_64_6_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_64_6_64_16&#39;)"><span class="hl_conref"><span class="mpre">TagWarning</span></span></a><span class="mpre"> (</span><a href="Text.StringLike.html#loc_32_5_32_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_32_5_32_15&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a href="#loc_141_16_141_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_16_141_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_141_18_141_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_18_141_22&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> else </span><a href="#loc_141_18_141_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_18_141_22&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a name="loc_142_9_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_13&#39;)"><span class="hl_fundecl"><span class="mpre">poss</span></span></a><span class="mpre"> </span><a name="loc_142_14_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_14_142_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (\</span><a name="loc_142_30_142_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_30_142_31&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_140_9_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_12&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_142_14_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_14_142_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> [</span><a href="#loc_142_30_142_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_30_142_31&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">]) 


</span><a name="loc_145_1_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_10&#39;)"><span class="hl_fundecl"><span class="mpre">entityChr</span></span></a><span class="mpre"> </span><a name="loc_145_11_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_145_13_145_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_13_145_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> | </span><a href="#loc_163_1_163_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_12&#39;)"><span class="hl_varref"><span class="mpre">isEntityNum</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_147_11_147_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_11_147_15&#39;)"><span class="hl_varref"><span class="mpre">chr_</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">read</span></span><span class="mpre"> </span><a href="#loc_145_13_145_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_13_145_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
              | </span><a href="#loc_164_1_164_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_12&#39;)"><span class="hl_varref"><span class="mpre">isEntityHex</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_147_11_147_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_11_147_15&#39;)"><span class="hl_varref"><span class="mpre">chr_</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Numeric.html#loc_94_1_94_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Numeric.html#loc_94_1_94_8&#39;)"><span class="hl_varref"><span class="mpre">readHex</span></span></a><span class="mpre"> </span><a href="#loc_145_13_145_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_13_145_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    where </span><a name="loc_147_11_147_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_11_147_15&#39;)"><span class="hl_fundecl"><span class="mpre">chr_</span></span></a><span class="mpre"> </span><a name="loc_147_16_147_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_16_147_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">inRange</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">minBound</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">maxBound</span></span><span class="mpre">) </span><a href="#loc_147_16_147_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_16_147_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a href="#loc_147_16_147_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_16_147_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="mpre">


</span><a name="loc_151_1_151_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_6&#39;)"><span class="hl_fundecl"><span class="mpre">isEof</span></span></a><span class="mpre"> (_,[]) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_151_1_151_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_6&#39;)"><span class="hl_fundecl"><span class="mpre">isEof</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_152_1_152_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_7&#39;)"><span class="hl_fundecl"><span class="mpre">isChar</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 11, srcSpanEndLine = 152, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 15, srcSpanEndLine = 152, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">Char{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_152_1_152_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_7&#39;)"><span class="hl_fundecl"><span class="mpre">isChar</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_153_1_153_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_6&#39;)"><span class="hl_fundecl"><span class="mpre">isTag</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 153, srcSpanStartColumn = 10, srcSpanEndLine = 153, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 153, srcSpanStartColumn = 13, srcSpanEndLine = 153, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">Tag{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_153_1_153_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_6&#39;)"><span class="hl_fundecl"><span class="mpre">isTag</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_154_1_154_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_10&#39;)"><span class="hl_fundecl"><span class="mpre">isTagShut</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 14, srcSpanEndLine = 154, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 21, srcSpanEndLine = 154, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagShut{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_154_1_154_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_10&#39;)"><span class="hl_fundecl"><span class="mpre">isTagShut</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_155_1_155_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_10&#39;)"><span class="hl_fundecl"><span class="mpre">isAttName</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 14, srcSpanEndLine = 155, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 21, srcSpanEndLine = 155, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">AttName{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_155_1_155_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_10&#39;)"><span class="hl_fundecl"><span class="mpre">isAttName</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_156_1_156_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_9&#39;)"><span class="hl_fundecl"><span class="mpre">isAttVal</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 156, srcSpanStartColumn = 13, srcSpanEndLine = 156, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 156, srcSpanStartColumn = 19, srcSpanEndLine = 156, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">AttVal{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_156_1_156_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_9&#39;)"><span class="hl_fundecl"><span class="mpre">isAttVal</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="hl_fundecl"><span class="mpre">isTagEnd</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 13, srcSpanEndLine = 157, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 19, srcSpanEndLine = 157, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagEnd{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="hl_fundecl"><span class="mpre">isTagEnd</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_158_1_158_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_14&#39;)"><span class="hl_fundecl"><span class="mpre">isTagEndClose</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 18, srcSpanEndLine = 158, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 29, srcSpanEndLine = 158, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagEndClose{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_158_1_158_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_14&#39;)"><span class="hl_fundecl"><span class="mpre">isTagEndClose</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_159_1_159_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_10&#39;)"><span class="hl_fundecl"><span class="mpre">isComment</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 159, srcSpanStartColumn = 14, srcSpanEndLine = 159, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 159, srcSpanStartColumn = 21, srcSpanEndLine = 159, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">Comment{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_159_1_159_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_10&#39;)"><span class="hl_fundecl"><span class="mpre">isComment</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_160_1_160_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_13&#39;)"><span class="hl_fundecl"><span class="mpre">isCommentEnd</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 160, srcSpanStartColumn = 17, srcSpanEndLine = 160, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 160, srcSpanStartColumn = 27, srcSpanEndLine = 160, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">CommentEnd{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_160_1_160_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_13&#39;)"><span class="hl_fundecl"><span class="mpre">isCommentEnd</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_161_1_161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_13&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityName</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 17, srcSpanEndLine = 161, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 27, srcSpanEndLine = 161, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">EntityName{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_161_1_161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_13&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityName</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_162_1_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_15&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityNumHex</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 19, srcSpanEndLine = 162, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 28, srcSpanEndLine = 162, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">EntityNum{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_162_1_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_15&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityNumHex</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 60, srcSpanEndLine = 162, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 69, srcSpanEndLine = 162, srcSpanEndColumn = 70},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">EntityHex{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_162_1_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_15&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityNumHex</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_163_1_163_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_12&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityNum</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 163, srcSpanStartColumn = 16, srcSpanEndLine = 163, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 163, srcSpanStartColumn = 25, srcSpanEndLine = 163, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">EntityNum{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_163_1_163_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_12&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityNum</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_164_1_164_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_12&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityHex</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 164, srcSpanStartColumn = 16, srcSpanEndLine = 164, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 164, srcSpanStartColumn = 25, srcSpanEndLine = 164, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">EntityHex{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_164_1_164_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_12&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityHex</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_165_1_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_12&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityEnd</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 165, srcSpanStartColumn = 16, srcSpanEndLine = 165, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 165, srcSpanStartColumn = 25, srcSpanEndLine = 165, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">EntityEnd{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_165_1_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_12&#39;)"><span class="hl_fundecl"><span class="mpre">isEntityEnd</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a name="loc_166_1_166_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_7&#39;)"><span class="hl_fundecl"><span class="mpre">isWarn</span></span></a><span class="mpre"> (_,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 11, srcSpanEndLine = 166, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 15, srcSpanEndLine = 166, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">Warn{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; </span><a href="#loc_166_1_166_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_7&#39;)"><span class="hl_fundecl"><span class="mpre">isWarn</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a name="loc_168_1_168_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_8&#39;)"><span class="hl_fundecl"><span class="mpre">fromChr</span></span></a><span class="mpre"> (_,</span><a href="#loc_18_7_18_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_7_18_11&#39;)"><span class="hl_conref"><span class="mpre">Char</span></span></a><span class="mpre"> </span><a name="loc_168_17_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_17_168_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_168_17_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_17_168_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> ; </span><a href="#loc_168_1_168_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_8&#39;)"><span class="hl_fundecl"><span class="mpre">fromChr</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a name="loc_169_1_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_9&#39;)"><span class="hl_fundecl"><span class="mpre">fromWarn</span></span></a><span class="mpre"> (_,</span><a href="#loc_31_7_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_11&#39;)"><span class="hl_conref"><span class="mpre">Warn</span></span></a><span class="mpre"> </span><a name="loc_169_18_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_18_169_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_169_18_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_18_169_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> ; </span><a href="#loc_169_1_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_9&#39;)"><span class="hl_fundecl"><span class="mpre">fromWarn</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><a name="loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="hl_fundecl"><span class="mpre">getEntityEnd</span></span></a><span class="mpre"> (_,</span><a href="#loc_30_7_30_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_7_30_16&#39;)"><span class="hl_conref"><span class="mpre">EntityEnd</span></span></a><span class="mpre"> </span><a name="loc_171_27_171_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_27_171_28&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="#loc_171_27_171_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_27_171_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Merge all adjacent TagText bits</span></span><span class="mpre">
</span><a href="#loc_176_1_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_13&#39;)"><span class="mpre">tagTextMerge</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 175, srcSpanStartColumn = 17, srcSpanEndLine = 175, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 175, srcSpanStartColumn = 32, srcSpanEndLine = 175, srcSpanEndColumn = 34}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/"><span class="mpre">StringLike str =&gt;</span></span><span class="mpre"> [</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">] -&gt; [</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]
</span><a name="loc_176_1_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_13&#39;)"><span class="hl_fundecl"><span class="mpre">tagTextMerge</span></span></a><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_62_6_62_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_62_6_62_13&#39;)"><span class="hl_conref"><span class="mpre">TagText</span></span></a><span class="mpre"> </span><a name="loc_176_23_176_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_23_176_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_176_25_176_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_25_176_27&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="Text.HTML.TagSoup.Type.html#loc_62_6_62_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_62_6_62_13&#39;)"><span class="hl_conref"><span class="mpre">TagText</span></span></a><span class="mpre"> (</span><a href="Text.StringLike.html#loc_36_5_36_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.StringLike.html#loc_36_5_36_14&#39;)"><span class="hl_varref"><span class="mpre">strConcat</span></span></a><span class="mpre"> (</span><a href="#loc_176_23_176_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_23_176_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_178_10_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_10_178_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_176_1_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_13&#39;)"><span class="hl_varref"><span class="mpre">tagTextMerge</span></span></a><span class="mpre"> </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
    where
        (</span><a name="loc_178_10_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_10_178_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_181_9_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_176_25_176_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_25_176_27&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- additional brackets on 3 lines to work around HSE 1.3.2 bugs with pattern fixities</span></span><span class="mpre">
        </span><a name="loc_181_9_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_62_6_62_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_62_6_62_13&#39;)"><span class="hl_conref"><span class="mpre">TagText</span></span></a><span class="mpre"> </span><a name="loc_181_20_181_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_20_181_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_181_22_181_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_22_181_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = (</span><a href="#loc_181_20_181_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_20_181_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_182_20_182_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_20_182_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_182_22_182_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_22_182_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
            where (</span><a name="loc_182_20_182_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_20_182_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_182_22_182_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_22_182_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_181_9_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_181_22_181_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_22_181_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_181_9_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 183, srcSpanStartColumn = 12, srcSpanEndLine = 183, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 183, srcSpanStartColumn = 23, srcSpanEndLine = 183, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagPosition{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a name="loc_183_27_183_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_27_183_28&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 183, srcSpanStartColumn = 29, srcSpanEndLine = 183, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 183, srcSpanStartColumn = 36, srcSpanEndLine = 183, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagText{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_183_39_183_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_39_183_41&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)) = </span><a href="#loc_181_9_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_183_27_183_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_27_183_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_183_39_183_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_39_183_41&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_181_9_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_184_11_184_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_11_184_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_184_11_184_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_11_184_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_184_11_184_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_11_184_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><a name="loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_186_11_186_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_11_186_12&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_186_13_186_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_13_186_15&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> (</span><a name="loc_186_17_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_17_186_18&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 19, srcSpanEndLine = 186, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 30, srcSpanEndLine = 186, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagPosition{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a name="loc_186_34_186_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_34_186_35&#39;)"><span class="hl_specname"><span class="mpre">w</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 36, srcSpanEndLine = 186, srcSpanEndColumn = 48}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 46, srcSpanEndLine = 186, srcSpanEndColumn = 47},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagWarning{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_186_49_186_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_49_186_51&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)) = </span><a href="#loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_186_11_186_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_11_186_12&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> (</span><a href="#loc_186_13_186_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_13_186_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_186_17_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_17_186_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_186_34_186_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_34_186_35&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) </span><a href="#loc_186_49_186_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_49_186_51&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_187_11_187_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_11_187_12&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_187_13_187_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_13_187_15&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> (</span><a name="loc_187_17_187_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_17_187_18&#39;)"><span class="hl_specname"><span class="mpre">w</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 187, srcSpanStartColumn = 19, srcSpanEndLine = 187, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 187, srcSpanStartColumn = 29, srcSpanEndLine = 187, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagWarning{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_187_32_187_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_32_187_34&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_187_11_187_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_11_187_12&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> (</span><a href="#loc_187_13_187_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_13_187_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_187_17_187_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_17_187_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) </span><a href="#loc_187_32_187_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_32_187_34&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">o</span></span><span class="mpre"> </span><a name="loc_188_13_188_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_15&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> (</span><a name="loc_188_17_188_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_17_188_18&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 188, srcSpanStartColumn = 19, srcSpanEndLine = 188, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 188, srcSpanStartColumn = 30, srcSpanEndLine = 188, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagPosition{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a name="loc_188_34_188_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_34_188_35&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 188, srcSpanStartColumn = 36, srcSpanEndLine = 188, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 188, srcSpanStartColumn = 43, srcSpanEndLine = 188, srcSpanEndColumn = 44},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagText{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_188_46_188_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_46_188_48&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)) = </span><a href="#loc_181_9_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_188_17_188_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_17_188_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_188_34_188_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_34_188_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_188_13_188_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_188_46_188_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_46_188_48&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">o</span></span><span class="mpre"> </span><a name="loc_189_13_189_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_13_189_15&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> (</span><a name="loc_189_17_189_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_17_189_18&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 189, srcSpanStartColumn = 19, srcSpanEndLine = 189, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Implementation.hs&quot;, srcSpanStartLine = 189, srcSpanStartColumn = 26, srcSpanEndLine = 189, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTM"><span class="mpre">TagText{}</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_189_29_189_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_29_189_31&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_181_9_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_189_17_189_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_17_189_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_189_13_189_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_13_189_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_189_29_189_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_29_189_31&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_186_9_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_190_11_190_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_12&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">op</span></span><span class="mpre"> _ = ([], </span><a href="#loc_190_11_190_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_12&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">)

</span><a href="#loc_176_1_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_13&#39;)"><span class="hl_fundecl"><span class="mpre">tagTextMerge</span></span></a><span class="mpre"> (</span><a name="loc_192_15_192_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_15_192_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_192_17_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_17_192_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_192_15_192_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_15_192_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_176_1_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_13&#39;)"><span class="hl_varref"><span class="mpre">tagTextMerge</span></span></a><span class="mpre"> </span><a href="#loc_192_17_192_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_17_192_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
</span><a href="#loc_176_1_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_13&#39;)"><span class="hl_fundecl"><span class="mpre">tagTextMerge</span></span></a><span class="mpre"> [] = []
</span></div></body></html>