<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE DeriveDataTypeable #-}

module Network.Wai.Handler.Warp.Thread (
    forkIOwithBreakableForever
  , breakForever
  ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Thread.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 8, srcSpanEndLine = 8, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre"> (forkIO)
import Control.Exception (</span><a href="Control.Exception.Base.html#loc_181_1_181_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_181_1_181_7&#39;)"><span class="mpre">handle</span></a><span class="mpre">, throw, </span><a href="GHC.IO.html#loc_426_1_426_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_426_1_426_6&#39;)"><span class="mpre">mask_</span></a><span class="mpre">, Exception)
import Control.Monad (</span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="mpre">void</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_189_1_189_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_189_1_189_8&#39;)"><span class="mpre">forever</span></a><span class="mpre">)
import Data.IORef
import Data.Typeable

data </span><a name="loc_14_6_14_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_6_14_18&#39;)"><span class="hl_tycondecl"><span class="mpre">BreakForever</span></span></a><span class="mpre"> = </span><a name="loc_14_21_14_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_21_14_33&#39;)"><span class="hl_condecl"><span class="mpre">BreakForever</span></span></a><span class="mpre"> </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Thread.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 34, srcSpanEndLine = 14, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Thread.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 34, srcSpanEndLine = 14, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Hand"><span class="mpre">deriving (Show, Typeable)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Exception</span></span><span class="mpre"> </span><a href="#loc_14_6_14_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_6_14_18&#39;)"><span class="hl_tyconref"><span class="mpre">BreakForever</span></span></a><span class="mpre">

</span><a href="#loc_19_1_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_27&#39;)"><span class="mpre">forkIOwithBreakableForever</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_19_1_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_27&#39;)"><span class="hl_fundecl"><span class="mpre">forkIOwithBreakableForever</span></span></a><span class="mpre"> </span><a name="loc_19_28_19_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_28_19_31&#39;)"><span class="hl_vardecl"><span class="mpre">ini</span></span></a><span class="mpre"> </span><a name="loc_19_32_19_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_32_19_38&#39;)"><span class="hl_vardecl"><span class="mpre">action</span></span></a><span class="mpre"> = do
    </span><a name="loc_20_5_20_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_19_28_19_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_28_19_31&#39;)"><span class="hl_varref"><span class="mpre">ini</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Exception.Base.html#loc_181_1_181_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_181_1_181_7&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a href="#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">stopPropagation</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_189_1_189_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_189_1_189_8&#39;)"><span class="hl_varref"><span class="mpre">forever</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_426_1_426_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_426_1_426_6&#39;)"><span class="hl_varref"><span class="mpre">mask_</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_19_32_19_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_32_19_38&#39;)"><span class="hl_varref"><span class="mpre">action</span></span></a><span class="mpre"> </span><a href="#loc_20_5_20_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_20_5_20_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

</span><a href="#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="mpre">stopPropagation</span></a><span class="mpre"> :: </span><a href="#loc_14_6_14_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_6_14_18&#39;)"><span class="hl_tyconref"><span class="mpre">BreakForever</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="hl_fundecl"><span class="mpre">stopPropagation</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_28_1_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_13&#39;)"><span class="mpre">breakForever</span></a><span class="mpre"> :: </span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_28_1_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_13&#39;)"><span class="hl_fundecl"><span class="mpre">breakForever</span></span></a><span class="mpre"> </span><a name="loc_28_14_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_14_28_17&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_28_14_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_14_28_17&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_28_45_28_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_45_28_46&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">throw</span></span><span class="mpre"> </span><a href="#loc_14_21_14_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_21_14_33&#39;)"><span class="hl_conref"><span class="mpre">BreakForever</span></span></a><span class="mpre">, </span><a href="#loc_28_45_28_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_45_28_46&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span></div></body></html>