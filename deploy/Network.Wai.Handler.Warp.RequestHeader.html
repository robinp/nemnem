<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE BangPatterns #-}

module Network.Wai.Handler.Warp.RequestHeader (
      parseHeaderLines
    , parseByteRanges
    ) where

import Control.Exception (</span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="mpre">throwIO</span></a><span class="mpre">)
import Control.Monad (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/RequestHeader.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 18, srcSpanEndLine = 11, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/RequestHeader.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as B (unpack, readInteger)
import Data.ByteString.Internal (</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="mpre">ByteString</span></a><span class="mpre">(..), </span><a href="Data.ByteString.Internal.html#loc_612_1_612_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_612_1_612_7&#39;)"><span class="mpre">memchr</span></a><span class="mpre">)
import qualified Data.CaseInsensitive as CI
import Data.Word (Word8)
import Foreign.ForeignPtr (</span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="mpre">withForeignPtr</span></a><span class="mpre">)
import Foreign.Ptr (Ptr, plusPtr, minusPtr, nullPtr)
import Foreign.Storable (peek)
import qualified Network.HTTP.Types as H
import qualified Network.HTTP.Types.URI as H
import Network.Wai.Handler.Warp.Types
import qualified Network.HTTP.Types.Header as HH
</span><span class="hl_comment"><span class="mpre">-- $setup</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; :set -XOverloadedStrings</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_36_1_36_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_17&#39;)"><span class="mpre">parseHeaderLines</span></a><span class="mpre"> :: [</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">]
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">H.Method</span></span><span class="mpre">
                       ,</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">--  Path</span></span><span class="mpre">
                       ,</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">--  Path, parsed</span></span><span class="mpre">
                       ,</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">--  Query</span></span><span class="mpre">
                       ,</span><a href="Network.HTTP.Types.Version.html#loc_13_6_13_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Version.html#loc_13_6_13_17&#39;)"><span class="hl_tyconref"><span class="mpre">H.HttpVersion</span></span></a><span class="mpre">
                       ,</span><span class="hl_tyconref"><span class="mpre">H.RequestHeaders</span></span><span class="mpre">
                       )
</span><a name="loc_36_1_36_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseHeaderLines</span></span></a><span class="mpre"> [] = </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Types.html#loc_44_23_44_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_44_23_44_37&#39;)"><span class="hl_conref"><span class="mpre">NotEnoughLines</span></span></a><span class="mpre"> []
</span><a href="#loc_36_1_36_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseHeaderLines</span></span></a><span class="mpre"> (</span><a name="loc_37_19_37_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_28&#39;)"><span class="hl_vardecl"><span class="mpre">firstLine</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_37_29_37_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_29_37_39&#39;)"><span class="hl_vardecl"><span class="mpre">otherLines</span></span></a><span class="mpre">) = do
    (</span><a name="loc_38_6_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_12&#39;)"><span class="hl_vardecl"><span class="mpre">method</span></span></a><span class="mpre">, </span><a name="loc_38_14_38_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_14_38_19&#39;)"><span class="hl_vardecl"><span class="mpre">path&#39;</span></span></a><span class="mpre">, </span><a name="loc_38_21_38_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_26&#39;)"><span class="hl_vardecl"><span class="mpre">query</span></span></a><span class="mpre">, </span><a name="loc_38_28_38_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_28_38_39&#39;)"><span class="hl_vardecl"><span class="mpre">httpversion</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_60_1_60_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_17&#39;)"><span class="hl_varref"><span class="mpre">parseRequestLine</span></span></a><span class="mpre"> </span><a href="#loc_37_19_37_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_28&#39;)"><span class="hl_varref"><span class="mpre">firstLine</span></span></a><span class="mpre">
    let </span><a name="loc_39_9_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_13&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Types.URI.html#loc_303_1_303_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.URI.html#loc_303_1_303_12&#39;)"><span class="hl_varref"><span class="mpre">H.extractPath</span></span></a><span class="mpre"> </span><a href="#loc_38_14_38_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_14_38_19&#39;)"><span class="hl_varref"><span class="mpre">path&#39;</span></span></a><span class="mpre">
        </span><a name="loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_vardecl"><span class="mpre">hdr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">parseHeader</span></span></a><span class="mpre"> </span><a href="#loc_37_29_37_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_29_37_39&#39;)"><span class="hl_varref"><span class="mpre">otherLines</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_38_6_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_12&#39;)"><span class="hl_varref"><span class="mpre">method</span></span></a><span class="mpre">, </span><a href="#loc_38_14_38_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_14_38_19&#39;)"><span class="hl_varref"><span class="mpre">path&#39;</span></span></a><span class="mpre">, </span><a href="#loc_39_9_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_13&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">, </span><a href="#loc_38_21_38_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_26&#39;)"><span class="hl_varref"><span class="mpre">query</span></span></a><span class="mpre">, </span><a href="#loc_38_28_38_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_28_38_39&#39;)"><span class="hl_varref"><span class="mpre">httpversion</span></span></a><span class="mpre">, </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; parseRequestLine &quot;GET / HTTP/1.1&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&quot;GET&quot;,&quot;/&quot;,&quot;&quot;,HTTP/1.1)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; parseRequestLine &quot;POST /cgi/search.cgi?key=foo HTTP/1.0&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&quot;POST&quot;,&quot;/cgi/search.cgi&quot;,&quot;?key=foo&quot;,HTTP/1.0)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; parseRequestLine &quot;GET &quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- *** Exception: Warp: Invalid first line of request: &quot;GET &quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; parseRequestLine &quot;GET /NotHTTP UNKNOWN/1.1&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- *** Exception: Warp: Request line specified a non-HTTP request</span></span><span class="mpre">
</span><a href="#loc_60_1_60_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_17&#39;)"><span class="mpre">parseRequestLine</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">H.Method</span></span><span class="mpre">
                       ,</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- Path</span></span><span class="mpre">
                       ,</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- Query</span></span><span class="mpre">
                       ,</span><a href="Network.HTTP.Types.Version.html#loc_13_6_13_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Version.html#loc_13_6_13_17&#39;)"><span class="hl_tyconref"><span class="mpre">H.HttpVersion</span></span></a><span class="mpre">)
</span><a name="loc_60_1_60_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseRequestLine</span></span></a><span class="mpre"> </span><a name="loc_60_18_60_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_18_60_29&#39;)"><span class="hl_specname"><span class="mpre">requestLine</span></span></a><span class="mpre">@(</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_60_34_60_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_34_60_38&#39;)"><span class="hl_vardecl"><span class="mpre">fptr</span></span></a><span class="mpre"> </span><a name="loc_60_39_60_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_39_60_42&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_60_43_60_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_43_60_46&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_60_34_60_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_34_60_38&#39;)"><span class="hl_varref"><span class="mpre">fptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_60_73_60_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_73_60_76&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_60_43_60_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_43_60_46&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="#loc_92_5_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_11&#39;)"><span class="hl_varref"><span class="mpre">baderr</span></span></a><span class="mpre">
    let </span><a name="loc_62_9_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_18&#39;)"><span class="hl_vardecl"><span class="mpre">methodptr</span></span></a><span class="mpre"> = </span><a href="#loc_60_73_60_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_73_60_76&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_60_39_60_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_39_60_42&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre">
        </span><a name="loc_63_9_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_15&#39;)"><span class="hl_vardecl"><span class="mpre">limptr</span></span></a><span class="mpre"> = </span><a href="#loc_62_9_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_18&#39;)"><span class="hl_varref"><span class="mpre">methodptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_60_43_60_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_43_60_46&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
        </span><a name="loc_64_9_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_13&#39;)"><span class="hl_vardecl"><span class="mpre">lim0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_60_43_60_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_43_60_46&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">

    </span><a name="loc_66_5_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_13&#39;)"><span class="hl_vardecl"><span class="mpre">pathptr0</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_612_1_612_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_612_1_612_7&#39;)"><span class="hl_varref"><span class="mpre">memchr</span></span></a><span class="mpre"> </span><a href="#loc_62_9_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_18&#39;)"><span class="hl_varref"><span class="mpre">methodptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><a href="#loc_64_9_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_13&#39;)"><span class="hl_varref"><span class="mpre">lim0</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39; &#39;</span></span><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_66_5_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_13&#39;)"><span class="hl_varref"><span class="mpre">pathptr0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><a href="#loc_63_9_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_15&#39;)"><span class="hl_varref"><span class="mpre">limptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_66_5_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_13&#39;)"><span class="hl_varref"><span class="mpre">pathptr0</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="#loc_92_5_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_11&#39;)"><span class="hl_varref"><span class="mpre">baderr</span></span></a><span class="mpre">
    let </span><a name="loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_vardecl"><span class="mpre">pathptr</span></span></a><span class="mpre"> = </span><a href="#loc_66_5_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_13&#39;)"><span class="hl_varref"><span class="mpre">pathptr0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_70_9_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_13&#39;)"><span class="hl_vardecl"><span class="mpre">lim1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_63_9_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_15&#39;)"><span class="hl_varref"><span class="mpre">limptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_66_5_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_13&#39;)"><span class="hl_varref"><span class="mpre">pathptr0</span></span></a><span class="mpre">)

    </span><a name="loc_72_5_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_13&#39;)"><span class="hl_vardecl"><span class="mpre">httpptr0</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_612_1_612_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_612_1_612_7&#39;)"><span class="hl_varref"><span class="mpre">memchr</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_varref"><span class="mpre">pathptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><a href="#loc_70_9_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_13&#39;)"><span class="hl_varref"><span class="mpre">lim1</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39; &#39;</span></span><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_72_5_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_13&#39;)"><span class="hl_varref"><span class="mpre">httpptr0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> (</span><a href="#loc_63_9_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_15&#39;)"><span class="hl_varref"><span class="mpre">limptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_72_5_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_13&#39;)"><span class="hl_varref"><span class="mpre">httpptr0</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="#loc_92_5_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_11&#39;)"><span class="hl_varref"><span class="mpre">baderr</span></span></a><span class="mpre">
    let </span><a name="loc_75_9_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_16&#39;)"><span class="hl_vardecl"><span class="mpre">httpptr</span></span></a><span class="mpre"> = </span><a href="#loc_72_5_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_13&#39;)"><span class="hl_varref"><span class="mpre">httpptr0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_76_9_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_13&#39;)"><span class="hl_vardecl"><span class="mpre">lim2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_72_5_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_13&#39;)"><span class="hl_varref"><span class="mpre">httpptr0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_varref"><span class="mpre">pathptr</span></span></a><span class="mpre">)

    </span><a href="#loc_97_5_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_14&#39;)"><span class="hl_varref"><span class="mpre">checkHTTP</span></span></a><span class="mpre"> </span><a href="#loc_75_9_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_16&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre">
    !</span><a name="loc_79_6_79_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_6_79_8&#39;)"><span class="hl_vardecl"><span class="mpre">hv</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_104_5_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_16&#39;)"><span class="hl_varref"><span class="mpre">httpVersion</span></span></a><span class="mpre"> </span><a href="#loc_75_9_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_16&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre">
    </span><a name="loc_80_5_80_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_13&#39;)"><span class="hl_vardecl"><span class="mpre">queryptr</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_612_1_612_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_612_1_612_7&#39;)"><span class="hl_varref"><span class="mpre">memchr</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_varref"><span class="mpre">pathptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">63</span></span><span class="mpre"> </span><a href="#loc_76_9_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_13&#39;)"><span class="hl_varref"><span class="mpre">lim2</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39;?&#39;</span></span><span class="mpre">

    let !</span><a name="loc_82_10_82_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_10_82_16&#39;)"><span class="hl_vardecl"><span class="mpre">method</span></span></a><span class="mpre"> = </span><a href="#loc_111_5_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_60_73_60_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_73_60_76&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_62_9_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_18&#39;)"><span class="hl_varref"><span class="mpre">methodptr</span></span></a><span class="mpre"> </span><a href="#loc_66_5_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_13&#39;)"><span class="hl_varref"><span class="mpre">pathptr0</span></span></a><span class="mpre">
        !</span><a name="loc_83_10_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_14&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre">
          | </span><a href="#loc_80_5_80_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_13&#39;)"><span class="hl_varref"><span class="mpre">queryptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> = </span><a href="#loc_111_5_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_60_73_60_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_73_60_76&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_varref"><span class="mpre">pathptr</span></span></a><span class="mpre"> </span><a href="#loc_72_5_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_13&#39;)"><span class="hl_varref"><span class="mpre">httpptr0</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           = </span><a href="#loc_111_5_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_60_73_60_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_73_60_76&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_varref"><span class="mpre">pathptr</span></span></a><span class="mpre"> </span><a href="#loc_80_5_80_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_13&#39;)"><span class="hl_varref"><span class="mpre">queryptr</span></span></a><span class="mpre">
        !</span><a name="loc_86_10_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_10_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">query</span></span></a><span class="mpre">
          | </span><a href="#loc_80_5_80_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_13&#39;)"><span class="hl_varref"><span class="mpre">queryptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           = </span><a href="#loc_111_5_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_60_73_60_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_73_60_76&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_80_5_80_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_13&#39;)"><span class="hl_varref"><span class="mpre">queryptr</span></span></a><span class="mpre"> </span><a href="#loc_72_5_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_13&#39;)"><span class="hl_varref"><span class="mpre">httpptr0</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_82_10_82_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_10_82_16&#39;)"><span class="hl_varref"><span class="mpre">method</span></span></a><span class="mpre">,</span><a href="#loc_83_10_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_14&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">,</span><a href="#loc_86_10_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_10_86_15&#39;)"><span class="hl_varref"><span class="mpre">query</span></span></a><span class="mpre">,</span><a href="#loc_79_6_79_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_6_79_8&#39;)"><span class="hl_varref"><span class="mpre">hv</span></span></a><span class="mpre">)
  where
    </span><a name="loc_92_5_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_11&#39;)"><span class="hl_vardecl"><span class="mpre">baderr</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Handler.Warp.Types.html#loc_45_23_45_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_45_23_45_35&#39;)"><span class="hl_conref"><span class="mpre">BadFirstLine</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unpack</span></span><span class="mpre"> </span><a href="#loc_60_18_60_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_18_60_29&#39;)"><span class="hl_varref"><span class="mpre">requestLine</span></span></a><span class="mpre">
    </span><a href="#loc_94_5_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_10&#39;)"><span class="mpre">check</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_94_5_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_10&#39;)"><span class="hl_fundecl"><span class="mpre">check</span></span></a><span class="mpre"> </span><a name="loc_94_11_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_94_15_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_16&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = do
        </span><a name="loc_95_9_95_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_11&#39;)"><span class="hl_vardecl"><span class="mpre">w0</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_94_11_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_95_9_95_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_11&#39;)"><span class="hl_varref"><span class="mpre">w0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_94_15_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_16&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Types.html#loc_46_23_46_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_46_23_46_30&#39;)"><span class="hl_conref"><span class="mpre">NonHttp</span></span></a><span class="mpre">
    </span><a name="loc_97_5_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_14&#39;)"><span class="hl_fundecl"><span class="mpre">checkHTTP</span></span></a><span class="mpre"> </span><a name="loc_97_15_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_15_97_22&#39;)"><span class="hl_vardecl"><span class="mpre">httpptr</span></span></a><span class="mpre"> = do
        </span><a href="#loc_94_5_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><a href="#loc_97_15_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_15_97_22&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">72</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39;H&#39;</span></span><span class="mpre">
        </span><a href="#loc_94_5_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><a href="#loc_97_15_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_15_97_22&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">84</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39;T&#39;</span></span><span class="mpre">
        </span><a href="#loc_94_5_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><a href="#loc_97_15_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_15_97_22&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">84</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39;T&#39;</span></span><span class="mpre">
        </span><a href="#loc_94_5_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><a href="#loc_97_15_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_15_97_22&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">80</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39;P&#39;</span></span><span class="mpre">
        </span><a href="#loc_94_5_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><a href="#loc_97_15_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_15_97_22&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39;/&#39;</span></span><span class="mpre">
        </span><a href="#loc_94_5_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><a href="#loc_97_15_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_15_97_22&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">46</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39;.&#39;</span></span><span class="mpre">
    </span><a name="loc_104_5_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_16&#39;)"><span class="hl_fundecl"><span class="mpre">httpVersion</span></span></a><span class="mpre"> </span><a name="loc_104_17_104_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_24&#39;)"><span class="hl_vardecl"><span class="mpre">httpptr</span></span></a><span class="mpre"> = do
        </span><a name="loc_105_9_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_14&#39;)"><span class="hl_vardecl"><span class="mpre">major</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_104_17_104_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_24&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">
        </span><a name="loc_106_9_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_14&#39;)"><span class="hl_vardecl"><span class="mpre">minor</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_104_17_104_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_24&#39;)"><span class="hl_varref"><span class="mpre">httpptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">
        if </span><a href="#loc_105_9_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_14&#39;)"><span class="hl_varref"><span class="mpre">major</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">49</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_106_9_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_14&#39;)"><span class="hl_varref"><span class="mpre">minor</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">49</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) then
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.Version.html#loc_33_1_33_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Version.html#loc_33_1_33_7&#39;)"><span class="hl_varref"><span class="mpre">H.http11</span></span></a><span class="mpre">
          else
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.Version.html#loc_29_1_29_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Version.html#loc_29_1_29_7&#39;)"><span class="hl_varref"><span class="mpre">H.http10</span></span></a><span class="mpre">
    </span><a name="loc_111_5_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_7&#39;)"><span class="hl_fundecl"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a name="loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_111_12_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_14&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre"> </span><a name="loc_111_15_111_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_17&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_60_34_60_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_34_60_38&#39;)"><span class="hl_varref"><span class="mpre">fptr</span></span></a><span class="mpre"> </span><a href="#loc_113_9_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_10&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_114_9_114_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
      where
        </span><a name="loc_113_9_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_10&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = </span><a href="#loc_111_12_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_14&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_111_8_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_11&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
        </span><a name="loc_114_9_114_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_111_15_111_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_17&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_111_12_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_14&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; parseHeader &quot;Content-Length:47&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&quot;Content-Length&quot;,&quot;47&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; parseHeader &quot;Accept-Ranges: bytes&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&quot;Accept-Ranges&quot;,&quot;bytes&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; parseHeader &quot;Host:  example.com:8080&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&quot;Host&quot;,&quot;example.com:8080&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; parseHeader &quot;NoSemiColon&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&quot;NoSemiColon&quot;,&quot;&quot;)</span></span><span class="mpre">

</span><a href="#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_12&#39;)"><span class="mpre">parseHeader</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">H.Header</span></span><span class="mpre">
</span><a name="loc_130_1_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_12&#39;)"><span class="hl_fundecl"><span class="mpre">parseHeader</span></span></a><span class="mpre"> </span><a name="loc_130_13_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_13_130_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    let (</span><a name="loc_131_10_131_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_10_131_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_131_13_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_13_131_17&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.breakByte</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">58</span></span><span class="mpre"> </span><a href="#loc_130_13_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_13_130_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39;:&#39;</span></span><span class="mpre">
        </span><a name="loc_132_9_132_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_9_132_14&#39;)"><span class="hl_vardecl"><span class="mpre">rest&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> (\</span><a name="loc_132_31_132_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_31_132_32&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_132_31_132_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_31_132_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_132_31_132_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_31_132_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_131_13_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_13_131_17&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
     in (</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">CI.mk</span></span></a><span class="mpre"> </span><a href="#loc_131_10_131_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_10_131_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">, </span><a href="#loc_132_9_132_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_9_132_14&#39;)"><span class="hl_varref"><span class="mpre">rest&#39;</span></span></a><span class="mpre">)

</span><a href="#loc_136_1_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_16&#39;)"><span class="mpre">parseByteRanges</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HH.ByteRanges</span></span><span class="mpre">
</span><a name="loc_136_1_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_16&#39;)"><span class="hl_fundecl"><span class="mpre">parseByteRanges</span></span></a><span class="mpre"> </span><a name="loc_136_17_136_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_17_136_20&#39;)"><span class="hl_vardecl"><span class="mpre">bs1</span></span></a><span class="mpre"> = do
    </span><a name="loc_137_5_137_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_8&#39;)"><span class="hl_vardecl"><span class="mpre">bs2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_159_5_159_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_16&#39;)"><span class="hl_varref"><span class="mpre">stripPrefix</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytes=&quot;</span></span><span class="mpre"> </span><a href="#loc_136_17_136_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_17_136_20&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre">
    (</span><a name="loc_138_6_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_7&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">, </span><a name="loc_138_9_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_12&#39;)"><span class="hl_vardecl"><span class="mpre">bs3</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_141_5_141_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_5_141_10&#39;)"><span class="hl_varref"><span class="mpre">range</span></span></a><span class="mpre"> </span><a href="#loc_137_5_137_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_8&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">
    </span><a href="#loc_152_5_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_11&#39;)"><span class="hl_varref"><span class="mpre">ranges</span></span></a><span class="mpre"> (</span><a href="#loc_138_6_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_7&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><a href="#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_12&#39;)"><span class="hl_varref"><span class="mpre">bs3</span></span></a><span class="mpre">
  where
    </span><a name="loc_141_5_141_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_5_141_10&#39;)"><span class="hl_fundecl"><span class="mpre">range</span></span></a><span class="mpre"> </span><a name="loc_141_11_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs2</span></span></a><span class="mpre"> =
        case </span><a href="#loc_159_5_159_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_16&#39;)"><span class="hl_varref"><span class="mpre">stripPrefix</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><a href="#loc_141_11_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_14&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_143_18_143_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_18_143_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs3</span></span></a><span class="mpre"> -&gt; do
                (</span><a name="loc_144_18_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_18_144_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, </span><a name="loc_144_21_144_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_21_144_24&#39;)"><span class="hl_vardecl"><span class="mpre">bs4</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">B.readInteger</span></span><span class="mpre"> </span><a href="#loc_143_18_143_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_18_143_21&#39;)"><span class="hl_varref"><span class="mpre">bs3</span></span></a><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="Network.HTTP.Types.Header.html#loc_89_5_89_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_89_5_89_20&#39;)"><span class="hl_conref"><span class="mpre">HH.ByteRangeSuffix</span></span></a><span class="mpre"> </span><a href="#loc_144_18_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_18_144_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">, </span><a href="#loc_144_21_144_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_21_144_24&#39;)"><span class="hl_varref"><span class="mpre">bs4</span></span></a><span class="mpre">)
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; do
                (</span><a name="loc_147_18_147_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_18_147_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, </span><a name="loc_147_21_147_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_21_147_24&#39;)"><span class="hl_vardecl"><span class="mpre">bs3</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">B.readInteger</span></span><span class="mpre"> </span><a href="#loc_141_11_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_14&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">
                </span><a name="loc_148_17_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_17_148_20&#39;)"><span class="hl_vardecl"><span class="mpre">bs4</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_159_5_159_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_16&#39;)"><span class="hl_varref"><span class="mpre">stripPrefix</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><a href="#loc_147_21_147_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_21_147_24&#39;)"><span class="hl_varref"><span class="mpre">bs3</span></span></a><span class="mpre">
                case </span><span class="hl_varref"><span class="mpre">B.readInteger</span></span><span class="mpre"> </span><a href="#loc_148_17_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_17_148_20&#39;)"><span class="hl_varref"><span class="mpre">bs4</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="Network.HTTP.Types.Header.html#loc_87_5_87_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_87_5_87_18&#39;)"><span class="hl_conref"><span class="mpre">HH.ByteRangeFrom</span></span></a><span class="mpre"> </span><a href="#loc_147_18_147_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_18_147_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">, </span><a href="#loc_148_17_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_17_148_20&#39;)"><span class="hl_varref"><span class="mpre">bs4</span></span></a><span class="mpre">)
                    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_151_27_151_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_27_151_28&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre">, </span><a name="loc_151_30_151_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_30_151_33&#39;)"><span class="hl_vardecl"><span class="mpre">bs5</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="Network.HTTP.Types.Header.html#loc_88_5_88_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Header.html#loc_88_5_88_20&#39;)"><span class="hl_conref"><span class="mpre">HH.ByteRangeFromTo</span></span></a><span class="mpre"> </span><a href="#loc_147_18_147_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_18_147_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_151_27_151_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_27_151_28&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">, </span><a href="#loc_151_30_151_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_30_151_33&#39;)"><span class="hl_varref"><span class="mpre">bs5</span></span></a><span class="mpre">)
    </span><a name="loc_152_5_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_11&#39;)"><span class="hl_fundecl"><span class="mpre">ranges</span></span></a><span class="mpre"> </span><a name="loc_152_12_152_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_12_152_17&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> </span><a name="loc_152_18_152_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs3</span></span></a><span class="mpre"> =
        case </span><a href="#loc_159_5_159_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_16&#39;)"><span class="hl_varref"><span class="mpre">stripPrefix</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="mpre"> </span><a href="#loc_152_18_152_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_21&#39;)"><span class="hl_varref"><span class="mpre">bs3</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_152_12_152_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_12_152_17&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> [])
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_155_18_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs4</span></span></a><span class="mpre"> -&gt; do
                (</span><a name="loc_156_18_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_18_156_19&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">, </span><a name="loc_156_21_156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_24&#39;)"><span class="hl_vardecl"><span class="mpre">bs5</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_141_5_141_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_5_141_10&#39;)"><span class="hl_varref"><span class="mpre">range</span></span></a><span class="mpre"> </span><a href="#loc_155_18_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_21&#39;)"><span class="hl_varref"><span class="mpre">bs4</span></span></a><span class="mpre">
                </span><a href="#loc_152_5_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_11&#39;)"><span class="hl_varref"><span class="mpre">ranges</span></span></a><span class="mpre"> (</span><a href="#loc_152_12_152_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_12_152_17&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_156_18_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_18_156_19&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) </span><a href="#loc_156_21_156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_24&#39;)"><span class="hl_varref"><span class="mpre">bs5</span></span></a><span class="mpre">

    </span><a name="loc_159_5_159_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_16&#39;)"><span class="hl_fundecl"><span class="mpre">stripPrefix</span></span></a><span class="mpre"> </span><a name="loc_159_17_159_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_17_159_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_159_19_159_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_19_159_20&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">
        | </span><a href="#loc_159_17_159_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_17_159_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`S.isPrefixOf`</span></span><span class="mpre"> </span><a href="#loc_159_19_159_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_19_159_20&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_159_17_159_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_17_159_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_159_19_159_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_19_159_20&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span></div></body></html>