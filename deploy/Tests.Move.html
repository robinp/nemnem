<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Tests.Move (tests) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartLine = 3, srcSpanStartColumn = 8, srcSpanEndLine = 3, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartLine = 4, srcSpanStartColumn = 8, srcSpanEndLine = 4, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Test.Framework.Providers.QuickCheck2&quot;"><span class="mpre">Test.Framework.Providers.QuickCheck2</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartLine = 6, srcSpanStartColumn = 8, srcSpanEndLine = 6, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Utilities&quot;"><span class="mpre">Utilities</span></span><span class="mpre"> ()

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 18, srcSpanEndLine = 8, srcSpanEndColumn = 37}, srcInfoPoints = []}) &quot;Data.Vector.Generic&quot;"><span class="mpre">Data.Vector.Generic</span></span><span class="mpre"> as G
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartLine = 9, srcSpanStartColumn = 18, srcSpanEndLine = 9, srcSpanEndColumn = 45}, srcInfoPoints = []}) &quot;Data.Vector.Generic.Mutable&quot;"><span class="mpre">Data.Vector.Generic.Mutable</span></span><span class="mpre"> as M

import qualified Data.Vector as V
import qualified Data.Vector.Primitive as P
import qualified Data.Vector.Storable as S
import qualified Data.Vector.Unboxed as U

</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="mpre">basicMove</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 14, srcSpanEndLine = 16, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 27, srcSpanEndLine = 16, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10."><span class="mpre">G.Vector v a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">basicMove</span></span></a><span class="mpre"> </span><a name="loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_17_13_17_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_13_17_19&#39;)"><span class="hl_vardecl"><span class="mpre">dstOff</span></span></a><span class="mpre"> </span><a name="loc_17_20_17_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_20_17_26&#39;)"><span class="hl_vardecl"><span class="mpre">srcOff</span></span></a><span class="mpre"> </span><a name="loc_17_27_17_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_27_17_30&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> 
  | </span><a href="#loc_17_27_17_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_27_17_30&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">G.modify</span></span><span class="mpre"> (\ </span><a name="loc_18_27_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_27_18_29&#39;)"><span class="hl_vardecl"><span class="mpre">mv</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">G.copy</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">M.slice</span></span><span class="mpre"> </span><a href="#loc_17_13_17_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_13_17_19&#39;)"><span class="hl_varref"><span class="mpre">dstOff</span></span></a><span class="mpre"> </span><a href="#loc_17_27_17_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_27_17_30&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_18_27_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_27_18_29&#39;)"><span class="hl_varref"><span class="mpre">mv</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">G.slice</span></span><span class="mpre"> </span><a href="#loc_17_20_17_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_20_17_26&#39;)"><span class="hl_varref"><span class="mpre">srcOff</span></span></a><span class="mpre"> </span><a href="#loc_17_27_17_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_27_17_30&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)) </span><a href="#loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><a href="#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_9&#39;)"><span class="mpre">testMove</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 13, srcSpanEndLine = 21, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 13, srcSpanEndLine = 21, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/tests/Tests/Move.hs&quot;, srcSpanStartL"><span class="mpre">(G.Vector v a, Show (v a), Eq (v a)) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Property</span></span><span class="mpre">
</span><a name="loc_22_1_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_9&#39;)"><span class="hl_fundecl"><span class="mpre">testMove</span></span></a><span class="mpre"> </span><a name="loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">G.length</span></span><span class="mpre"> </span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==&gt;</span></span><span class="mpre"> (do
  </span><a name="loc_23_3_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_3_23_9&#39;)"><span class="hl_vardecl"><span class="mpre">dstOff</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">G.length</span></span><span class="mpre"> </span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
  </span><a name="loc_24_3_24_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_3_24_9&#39;)"><span class="hl_vardecl"><span class="mpre">srcOff</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">G.length</span></span><span class="mpre"> </span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
  </span><a name="loc_25_3_25_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_6&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">G.length</span></span><span class="mpre"> </span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_23_3_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_3_23_9&#39;)"><span class="hl_varref"><span class="mpre">dstOff</span></span></a><span class="mpre"> </span><a href="#loc_24_3_24_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_3_24_9&#39;)"><span class="hl_varref"><span class="mpre">srcOff</span></span></a><span class="mpre">)
  let </span><a name="loc_26_7_26_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_15&#39;)"><span class="hl_vardecl"><span class="mpre">expected</span></span></a><span class="mpre"> = </span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_varref"><span class="mpre">basicMove</span></span></a><span class="mpre"> </span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_23_3_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_3_23_9&#39;)"><span class="hl_varref"><span class="mpre">dstOff</span></span></a><span class="mpre"> </span><a href="#loc_24_3_24_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_3_24_9&#39;)"><span class="hl_varref"><span class="mpre">srcOff</span></span></a><span class="mpre"> </span><a href="#loc_25_3_25_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_6&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
  let </span><a name="loc_27_7_27_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_13&#39;)"><span class="hl_vardecl"><span class="mpre">actual</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">G.modify</span></span><span class="mpre"> (\ </span><a name="loc_27_28_27_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_28_27_30&#39;)"><span class="hl_vardecl"><span class="mpre">mv</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">M.move</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">M.slice</span></span><span class="mpre"> </span><a href="#loc_23_3_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_3_23_9&#39;)"><span class="hl_varref"><span class="mpre">dstOff</span></span></a><span class="mpre"> </span><a href="#loc_25_3_25_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_6&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_27_28_27_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_28_27_30&#39;)"><span class="hl_varref"><span class="mpre">mv</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">M.slice</span></span><span class="mpre"> </span><a href="#loc_24_3_24_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_3_24_9&#39;)"><span class="hl_varref"><span class="mpre">srcOff</span></span></a><span class="mpre"> </span><a href="#loc_25_3_25_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_6&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_27_28_27_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_28_27_30&#39;)"><span class="hl_varref"><span class="mpre">mv</span></span></a><span class="mpre">)) </span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">printTestCase</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Move: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_23_3_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_3_23_9&#39;)"><span class="hl_varref"><span class="mpre">dstOff</span></span></a><span class="mpre">, </span><a href="#loc_24_3_24_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_3_24_9&#39;)"><span class="hl_varref"><span class="mpre">srcOff</span></span></a><span class="mpre">, </span><a href="#loc_25_3_25_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_6&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)) (</span><a href="#loc_26_7_26_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_15&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_27_7_27_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_13&#39;)"><span class="hl_varref"><span class="mpre">actual</span></span></a><span class="mpre">))

</span><a name="loc_30_1_30_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> =
    [</span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.Vector.Mutable (Move)&quot;</span></span><span class="mpre"> (</span><a href="#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_9&#39;)"><span class="hl_varref"><span class="mpre">testMove</span></span></a><span class="mpre"> :: </span><a href="Data.Vector.html#loc_200_6_200_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_200_6_200_12&#39;)"><span class="hl_tyconref"><span class="mpre">V.Vector</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Property</span></span><span class="mpre">),
     </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.Vector.Primitive.Mutable (Move)&quot;</span></span><span class="mpre"> (</span><a href="#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_9&#39;)"><span class="hl_varref"><span class="mpre">testMove</span></span></a><span class="mpre"> :: </span><a href="Data.Vector.Primitive.html#loc_176_6_176_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Primitive.html#loc_176_6_176_12&#39;)"><span class="hl_tyconref"><span class="mpre">P.Vector</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Property</span></span><span class="mpre">),
     </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.Vector.Unboxed.Mutable (Move)&quot;</span></span><span class="mpre"> (</span><a href="#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_9&#39;)"><span class="hl_varref"><span class="mpre">testMove</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">U.Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Property</span></span><span class="mpre">),
     </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.Vector.Storable.Mutable (Move)&quot;</span></span><span class="mpre"> (</span><a href="#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_9&#39;)"><span class="hl_varref"><span class="mpre">testMove</span></span></a><span class="mpre"> :: </span><a href="Data.Vector.Storable.html#loc_183_6_183_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Storable.html#loc_183_6_183_12&#39;)"><span class="hl_tyconref"><span class="mpre">S.Vector</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Property</span></span><span class="mpre">)]</span></div></body></html>