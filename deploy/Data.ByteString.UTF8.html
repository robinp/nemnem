<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
#if __GLASGOW_HASKELL__ &gt;= 701
{-# LANGUAGE Trustworthy #-}
#endif
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.ByteString.UTF8</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Iavor S. Diatchki 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  emertens@galois.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This module provides fast, validated encoding and decoding functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   between &#39;ByteString&#39;s and &#39;String&#39;s. It does not exactly match the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   output of the Codec.Binary.UTF8.String output for invalid encodings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   as the number of replacement characters is sometimes longer.</span></span><span class="mpre">
module Data.ByteString.UTF8
  ( B.ByteString
  , decode
  , replacement_char
  , uncons
  , splitAt
  , take
  , drop
  , span
  , break
  , fromString
  , toString
  , foldl
  , foldr
  , length
  , lines
  , lines&#39;
  ) where

import Data.Bits
import Data.Word
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/utf8-string-0.3.8/Data/ByteString/UTF8.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 18, srcSpanEndLine = 40, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Prelude hiding (take,drop,splitAt,span,break,foldr,foldl,length,</span><a href="Data.List.html#loc_1044_1_1044_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1044_1_1044_6&#39;)"><span class="mpre">lines</span></a><span class="mpre">)

import Codec.Binary.UTF8.String(</span><a href="Codec.Binary.UTF8.String.html#loc_72_1_72_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.String.html#loc_72_1_72_7&#39;)"><span class="mpre">encode</span></a><span class="mpre">)
import Codec.Binary.UTF8.Generic (</span><a href="Codec.Binary.UTF8.Generic.html#loc_51_3_51_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.Generic.html#loc_51_3_51_10&#39;)"><span class="mpre">buncons</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Converts a Haskell string into a UTF8 encoded bytestring.</span></span><span class="mpre">
</span><a href="#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_11&#39;)"><span class="mpre">fromString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_48_1_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_11&#39;)"><span class="hl_fundecl"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a name="loc_48_12_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_12_48_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> (</span><a href="Codec.Binary.UTF8.String.html#loc_72_1_72_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.String.html#loc_72_1_72_7&#39;)"><span class="hl_varref"><span class="mpre">encode</span></span></a><span class="mpre"> </span><a href="#loc_48_12_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_12_48_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Convert a UTF8 encoded bytestring into a Haskell string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid characters are replaced with &#39;\xFFFD&#39;.</span></span><span class="mpre">
</span><a href="#loc_53_1_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_9&#39;)"><span class="mpre">toString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_53_1_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_9&#39;)"><span class="hl_fundecl"><span class="mpre">toString</span></span></a><span class="mpre"> </span><a name="loc_53_10_53_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_12&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="hl_varref"><span class="mpre">foldr</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> [] </span><a href="#loc_53_10_53_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_12&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This character is used to mark errors in a UTF8 encoded string.</span></span><span class="mpre">
</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="mpre">replacement_char</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_vardecl"><span class="mpre">replacement_char</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;\xfffd&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Try to extract a character from a byte string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Returns &#39;Nothing&#39; if there are no more bytes in the byte string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Otherwise, it returns a decoded character and the number of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bytes used in its representation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Errors are replaced by character &#39;\0xFFFD&#39;.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- XXX: Should we combine sequences of errors into a single replacement</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- character?</span></span><span class="mpre">
</span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="mpre">decode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_fundecl"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a name="loc_68_8_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_8_68_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = do (</span><a name="loc_68_17_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_17_68_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_68_19_68_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_19_68_21&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) &lt;- </span><a href="Codec.Binary.UTF8.Generic.html#loc_51_3_51_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.Generic.html#loc_51_3_51_10&#39;)"><span class="hl_varref"><span class="mpre">buncons</span></span></a><span class="mpre"> </span><a href="#loc_68_8_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_8_68_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
               </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_72_3_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_3_72_9&#39;)"><span class="hl_varref"><span class="mpre">choose</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_68_17_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_17_68_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_68_19_68_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_19_68_21&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
  where
  </span><a href="#loc_72_3_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_3_72_9&#39;)"><span class="mpre">choose</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  </span><a name="loc_72_3_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_3_72_9&#39;)"><span class="hl_fundecl"><span class="mpre">choose</span></span></a><span class="mpre"> </span><a name="loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_72_12_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_14&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">
    | </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">  = (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    | </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre">  = (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    | </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre">  = </span><a href="#loc_97_3_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_9&#39;)"><span class="hl_varref"><span class="mpre">bytes2</span></span></a><span class="mpre"> (</span><a href="#loc_81_3_81_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_3_81_7&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1f</span></span><span class="mpre">) </span><a href="#loc_72_12_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
    | </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre">  = </span><a href="#loc_103_3_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_9&#39;)"><span class="hl_varref"><span class="mpre">bytes3</span></span></a><span class="mpre"> (</span><a href="#loc_81_3_81_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_3_81_7&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x0f</span></span><span class="mpre">) </span><a href="#loc_72_12_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
    | </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf8</span></span><span class="mpre">  = </span><a href="#loc_114_3_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_3_114_9&#39;)"><span class="hl_varref"><span class="mpre">bytes4</span></span></a><span class="mpre"> (</span><a href="#loc_81_3_81_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_3_81_7&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x07</span></span><span class="mpre">) </span><a href="#loc_72_12_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

  </span><a href="#loc_81_3_81_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_3_81_7&#39;)"><span class="mpre">mask</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><a name="loc_81_3_81_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_3_81_7&#39;)"><span class="hl_fundecl"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a name="loc_81_8_81_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_8_81_9&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_81_10_81_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_10_81_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_81_8_81_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_8_81_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><a href="#loc_81_10_81_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_10_81_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)

  </span><a href="#loc_84_3_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_3_84_10&#39;)"><span class="mpre">combine</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><a name="loc_84_3_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_3_84_10&#39;)"><span class="hl_fundecl"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a name="loc_84_11_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_11_84_14&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_84_15_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_15_84_16&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_84_11_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_11_84_14&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_84_15_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_15_84_16&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)

  </span><a href="#loc_87_3_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_11&#39;)"><span class="mpre">follower</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><a name="loc_87_3_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_11&#39;)"><span class="hl_fundecl"><span class="mpre">follower</span></span></a><span class="mpre"> </span><a name="loc_87_12_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_15&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_87_16_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_16_87_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> | </span><a href="#loc_87_16_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_16_87_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_84_3_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_3_84_10&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a href="#loc_87_12_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_15&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_87_16_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_16_87_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
  </span><a href="#loc_87_3_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_11&#39;)"><span class="hl_fundecl"><span class="mpre">follower</span></span></a><span class="mpre"> _ _                        = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_92_3_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_15&#39;)"><span class="mpre">get_follower</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="#loc_92_3_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_15&#39;)"><span class="mpre">get_follower</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
  </span><a name="loc_92_3_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_15&#39;)"><span class="hl_fundecl"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a name="loc_92_16_92_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_16_92_19&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_92_20_92_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_22&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = do (</span><a name="loc_92_29_92_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_29_92_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_92_31_92_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_31_92_33&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) &lt;- </span><a href="Codec.Binary.UTF8.Generic.html#loc_51_3_51_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.Generic.html#loc_51_3_51_10&#39;)"><span class="hl_varref"><span class="mpre">buncons</span></span></a><span class="mpre"> </span><a href="#loc_92_20_92_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_22&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
                           </span><a name="loc_93_28_93_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_28_93_32&#39;)"><span class="hl_vardecl"><span class="mpre">acc1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_87_3_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_11&#39;)"><span class="hl_varref"><span class="mpre">follower</span></span></a><span class="mpre"> </span><a href="#loc_92_16_92_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_16_92_19&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_92_29_92_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_29_92_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                           </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_93_28_93_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_28_93_32&#39;)"><span class="hl_varref"><span class="mpre">acc1</span></span></a><span class="mpre">,</span><a href="#loc_92_31_92_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_31_92_33&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

  </span><a href="#loc_97_3_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_9&#39;)"><span class="mpre">bytes2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  </span><a name="loc_97_3_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_9&#39;)"><span class="hl_fundecl"><span class="mpre">bytes2</span></span></a><span class="mpre"> </span><a name="loc_97_10_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_10_97_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_97_12_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_14&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = case </span><a href="#loc_92_3_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_97_10_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_10_97_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_97_12_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
                  </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_98_25_98_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_25_98_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">, _) | </span><a href="#loc_98_25_98_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_25_98_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">  -&gt; (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_98_25_98_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_25_98_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
                              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  -&gt; (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                  _ -&gt; (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

  </span><a href="#loc_103_3_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_9&#39;)"><span class="mpre">bytes3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  </span><a name="loc_103_3_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_9&#39;)"><span class="hl_fundecl"><span class="mpre">bytes3</span></span></a><span class="mpre"> </span><a name="loc_103_10_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_10_103_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_103_12_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_12_103_14&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> =
    case </span><a href="#loc_92_3_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_103_10_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_10_103_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_103_12_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_12_103_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_105_13_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_15&#39;)"><span class="hl_vardecl"><span class="mpre">d1</span></span></a><span class="mpre">, </span><a name="loc_105_17_105_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_20&#39;)"><span class="hl_vardecl"><span class="mpre">cs1</span></span></a><span class="mpre">) -&gt;
        case </span><a href="#loc_92_3_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_105_13_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_15&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a href="#loc_105_17_105_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_20&#39;)"><span class="hl_varref"><span class="mpre">cs1</span></span></a><span class="mpre"> of
          </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_107_17_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_17_107_18&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">, _) | (</span><a href="#loc_107_17_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_17_107_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_107_17_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_17_107_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xd800</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
                        (</span><a href="#loc_107_17_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_17_107_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xdfff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_107_17_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_17_107_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfffe</span></span><span class="mpre">) -&gt; (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_107_17_107_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_17_107_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
          _ -&gt; (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
      _ -&gt; (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

  </span><a href="#loc_114_3_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_3_114_9&#39;)"><span class="mpre">bytes4</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  </span><a name="loc_114_3_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_3_114_9&#39;)"><span class="hl_fundecl"><span class="mpre">bytes4</span></span></a><span class="mpre"> </span><a name="loc_114_10_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_114_12_114_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_14&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> =
    case </span><a href="#loc_92_3_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_114_10_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_114_12_114_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_116_13_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_15&#39;)"><span class="hl_vardecl"><span class="mpre">d1</span></span></a><span class="mpre">, </span><a name="loc_116_17_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_17_116_20&#39;)"><span class="hl_vardecl"><span class="mpre">cs1</span></span></a><span class="mpre">) -&gt;
        case </span><a href="#loc_92_3_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_116_13_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_15&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a href="#loc_116_17_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_17_116_20&#39;)"><span class="hl_varref"><span class="mpre">cs1</span></span></a><span class="mpre"> of
          </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_118_17_118_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_17_118_19&#39;)"><span class="hl_vardecl"><span class="mpre">d2</span></span></a><span class="mpre">, </span><a name="loc_118_21_118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_21_118_24&#39;)"><span class="hl_vardecl"><span class="mpre">cs2</span></span></a><span class="mpre">) -&gt;
            case </span><a href="#loc_92_3_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_118_17_118_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_17_118_19&#39;)"><span class="hl_varref"><span class="mpre">d2</span></span></a><span class="mpre"> </span><a href="#loc_118_21_118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_21_118_24&#39;)"><span class="hl_varref"><span class="mpre">cs2</span></span></a><span class="mpre"> of
              </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">,_) | </span><a href="#loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x110000</span></span><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_120_21_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_21_120_22&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
                         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                    -&gt; (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
              _ -&gt; (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
          _ -&gt; (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
      _ -&gt; (</span><a href="#loc_57_1_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Split after a given number of characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Negative values are treated as if they are 0.</span></span><span class="mpre">
</span><a href="#loc_130_1_130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_8&#39;)"><span class="mpre">splitAt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_130_1_130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_8&#39;)"><span class="hl_fundecl"><span class="mpre">splitAt</span></span></a><span class="mpre"> </span><a name="loc_130_9_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_130_11_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_13&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_131_9_131_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_130_9_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_130_11_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where </span><a name="loc_131_9_131_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_131_14_131_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_14_131_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_131_16_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_16_131_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ | </span><a href="#loc_131_16_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_16_131_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_131_14_131_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_14_131_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_130_11_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        </span><a href="#loc_131_9_131_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_132_14_132_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_14_132_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_132_16_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_16_132_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_132_18_132_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_18_132_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs1</span></span></a><span class="mpre"> = case </span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_132_18_132_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_18_132_21&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre"> of
                         </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (_,</span><a name="loc_133_34_133_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_34_133_35&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_131_9_131_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_132_14_132_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_14_132_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_133_34_133_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_34_133_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a href="#loc_132_16_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_16_132_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_133_34_133_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_34_133_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_132_18_132_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_18_132_21&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre">)
                         </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">    -&gt; (</span><a href="#loc_130_11_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @take n s@ returns the first @n@ characters of @s@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If @s@ has less than @n@ characters, then we return the whole of @s@.</span></span><span class="mpre">
</span><a href="#loc_139_1_139_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_5&#39;)"><span class="mpre">take</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_139_1_139_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_5&#39;)"><span class="hl_fundecl"><span class="mpre">take</span></span></a><span class="mpre"> </span><a name="loc_139_6_139_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_7&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_139_8_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_8_139_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="Data.Tuple.html#loc_48_1_48_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tuple.html#loc_48_1_48_4&#39;)"><span class="hl_varref"><span class="mpre">fst</span></span></a><span class="mpre"> (</span><a href="#loc_130_1_130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_8&#39;)"><span class="hl_varref"><span class="mpre">splitAt</span></span></a><span class="mpre"> </span><a href="#loc_139_6_139_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_7&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_139_8_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_8_139_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @drop n s@ returns the @s@ without its first @n@ characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If @s@ has less than @n@ characters, then we return an empty string.</span></span><span class="mpre">
</span><a href="#loc_144_1_144_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_5&#39;)"><span class="mpre">drop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_144_1_144_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_5&#39;)"><span class="hl_fundecl"><span class="mpre">drop</span></span></a><span class="mpre"> </span><a name="loc_144_6_144_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_6_144_7&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_144_8_144_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_8_144_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="Data.Tuple.html#loc_52_1_52_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tuple.html#loc_52_1_52_4&#39;)"><span class="hl_varref"><span class="mpre">snd</span></span></a><span class="mpre"> (</span><a href="#loc_130_1_130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_8&#39;)"><span class="hl_varref"><span class="mpre">splitAt</span></span></a><span class="mpre"> </span><a href="#loc_144_6_144_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_6_144_7&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_144_8_144_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_8_144_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Split a string into two parts:  the first is the longest prefix</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that contains only characters that satisfy the predicate; the second</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- part is the rest of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid characters are passed as &#39;\0xFFFD&#39; to the predicate.</span></span><span class="mpre">
</span><a href="#loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="mpre">span</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="hl_fundecl"><span class="mpre">span</span></span></a><span class="mpre"> </span><a name="loc_151_6_151_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_6_151_7&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_151_8_151_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_8_151_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_152_9_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_9_152_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_151_8_151_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_8_151_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where </span><a name="loc_152_9_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_9_152_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_152_14_152_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_14_152_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_152_16_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_16_152_18&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = case </span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_152_16_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_16_152_18&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
                      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_153_29_153_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_29_153_30&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_153_31_153_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_31_153_32&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) | </span><a href="#loc_151_6_151_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_6_151_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_153_29_153_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_29_153_30&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_152_9_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_9_152_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_152_14_152_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_14_152_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_153_31_153_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_31_153_32&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_153_31_153_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_31_153_32&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_152_16_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_16_152_18&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
                      _ -&gt; </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_152_14_152_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_14_152_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_151_8_151_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_8_151_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Split a string into two parts:  the first is the longest prefix</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that contains only characters that do not satisfy the predicate; the second</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- part is the rest of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid characters are passed as &#39;\0xFFFD&#39; to the predicate.</span></span><span class="mpre">
</span><a href="#loc_161_1_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_6&#39;)"><span class="mpre">break</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_161_1_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_6&#39;)"><span class="hl_fundecl"><span class="mpre">break</span></span></a><span class="mpre"> </span><a name="loc_161_7_161_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_7_161_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_161_9_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_151_1_151_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_5&#39;)"><span class="hl_varref"><span class="mpre">span</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_161_7_161_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_7_161_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="#loc_161_9_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the first character of a byte string, if any.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Malformed characters are replaced by &#39;\0xFFFD&#39;.</span></span><span class="mpre">
</span><a href="#loc_166_1_166_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_7&#39;)"><span class="mpre">uncons</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_166_1_166_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_7&#39;)"><span class="hl_fundecl"><span class="mpre">uncons</span></span></a><span class="mpre"> </span><a name="loc_166_8_166_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_8_166_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = do (</span><a name="loc_166_17_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_17_166_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_166_19_166_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_19_166_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_166_8_166_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_8_166_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
               </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_166_17_166_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_17_166_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_166_19_166_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_19_166_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_166_8_166_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_8_166_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Traverse a bytestring (right biased).</span></span><span class="mpre">
</span><a href="#loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="mpre">foldr</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="hl_fundecl"><span class="mpre">foldr</span></span></a><span class="mpre"> </span><a name="loc_171_7_171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_7_171_11&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a name="loc_171_12_171_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_12_171_15&#39;)"><span class="hl_vardecl"><span class="mpre">nil</span></span></a><span class="mpre"> </span><a name="loc_171_16_171_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_16_171_18&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = case </span><a href="#loc_166_1_166_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_7&#39;)"><span class="hl_varref"><span class="mpre">uncons</span></span></a><span class="mpre"> </span><a href="#loc_171_16_171_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_16_171_18&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
                      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_172_29_172_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_29_172_30&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_172_31_172_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_31_172_33&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_171_7_171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_7_171_11&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a href="#loc_172_29_172_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_29_172_30&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="hl_varref"><span class="mpre">foldr</span></span></a><span class="mpre"> </span><a href="#loc_171_7_171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_7_171_11&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a href="#loc_171_12_171_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_12_171_15&#39;)"><span class="hl_varref"><span class="mpre">nil</span></span></a><span class="mpre"> </span><a href="#loc_172_31_172_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_31_172_33&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">)
                      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_171_12_171_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_12_171_15&#39;)"><span class="hl_varref"><span class="mpre">nil</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Traverse a bytestring (left biased).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function is strict in the accumulator.</span></span><span class="mpre">
</span><a href="#loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="mpre">foldl</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="hl_fundecl"><span class="mpre">foldl</span></span></a><span class="mpre"> </span><a name="loc_178_7_178_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_7_178_10&#39;)"><span class="hl_vardecl"><span class="mpre">add</span></span></a><span class="mpre"> </span><a name="loc_178_11_178_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_11_178_14&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_178_15_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_15_178_17&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">  = case </span><a href="#loc_166_1_166_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_7&#39;)"><span class="hl_varref"><span class="mpre">uncons</span></span></a><span class="mpre"> </span><a href="#loc_178_15_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_15_178_17&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
                      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_179_29_179_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_29_179_30&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_179_31_179_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_31_179_33&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">) -&gt; let </span><a name="loc_179_42_179_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_42_179_43&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_178_7_178_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_7_178_10&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> </span><a href="#loc_178_11_178_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_11_178_14&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_179_29_179_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_29_179_30&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                                     in </span><a href="Prelude.html#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_167_1_167_4&#39;)"><span class="hl_varref"><span class="mpre">seq</span></span></a><span class="mpre"> </span><a href="#loc_179_42_179_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_42_179_43&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><a href="#loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="hl_varref"><span class="mpre">foldl</span></span></a><span class="mpre"> </span><a href="#loc_178_7_178_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_7_178_10&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> </span><a href="#loc_179_42_179_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_42_179_43&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_179_31_179_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_31_179_33&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">)
                      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_178_11_178_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_11_178_14&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Counts the number of characters encoded in the bytestring.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that this includes replacement characters.</span></span><span class="mpre">
</span><a href="#loc_186_1_186_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_7&#39;)"><span class="mpre">length</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_186_1_186_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_7&#39;)"><span class="hl_fundecl"><span class="mpre">length</span></span></a><span class="mpre"> </span><a name="loc_186_8_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_8_186_9&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_187_9_187_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_186_8_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_8_186_9&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  where </span><a name="loc_187_9_187_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_187_14_187_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_14_187_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_187_16_187_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_16_187_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = case </span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_187_16_187_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_16_187_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (_,</span><a name="loc_188_31_188_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_31_188_32&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_187_9_187_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_187_14_187_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_14_187_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_188_31_188_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_31_188_32&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_187_16_187_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_16_187_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
                      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_187_14_187_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_14_187_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Split a string into a list of lines.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Lines are terminated by &#39;\n&#39; or the end of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Empty lines may not be terminated by the end of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See also &#39;lines\&#39;&#39;.</span></span><span class="mpre">
</span><a href="#loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="mpre">lines</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">]
</span><a name="loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="hl_fundecl"><span class="mpre">lines</span></span></a><span class="mpre"> </span><a name="loc_196_7_196_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_7_196_9&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_196_7_196_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_7_196_9&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">  = []
</span><a href="#loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="hl_fundecl"><span class="mpre">lines</span></span></a><span class="mpre"> </span><a name="loc_197_7_197_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_7_197_9&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">B.elemIndex</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_197_7_197_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_7_197_9&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
             </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_198_19_198_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_19_198_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; let (</span><a name="loc_198_29_198_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_29_198_31&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_198_32_198_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_32_198_34&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_198_19_198_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_19_198_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_197_7_197_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_7_197_9&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                       in </span><a href="#loc_198_29_198_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_29_198_31&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_196_1_196_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_6&#39;)"><span class="hl_varref"><span class="mpre">lines</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.tail</span></span><span class="mpre"> </span><a href="#loc_198_32_198_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_32_198_34&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)
             </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_197_7_197_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_7_197_9&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | Split a string into a list of lines.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Lines are terminated by &#39;\n&#39; or the end of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Empty lines may not be terminated by the end of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function preserves the terminators.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See also &#39;lines&#39;.</span></span><span class="mpre">
</span><a href="#loc_208_1_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_7&#39;)"><span class="mpre">lines&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">]
</span><a name="loc_208_1_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_7&#39;)"><span class="hl_fundecl"><span class="mpre">lines&#39;</span></span></a><span class="mpre"> </span><a name="loc_208_8_208_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_8_208_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_208_8_208_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_8_208_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">  = []
</span><a href="#loc_208_1_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_7&#39;)"><span class="hl_fundecl"><span class="mpre">lines&#39;</span></span></a><span class="mpre"> </span><a name="loc_209_8_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_8_209_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">B.elemIndex</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_209_8_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_8_209_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
              </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_210_20_210_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_20_210_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; let (</span><a name="loc_210_30_210_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_30_210_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_210_33_210_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_33_210_35&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> (</span><a href="#loc_210_20_210_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_20_210_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_209_8_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_8_209_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                        in </span><a href="#loc_210_30_210_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_30_210_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_208_1_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_7&#39;)"><span class="hl_varref"><span class="mpre">lines&#39;</span></span></a><span class="mpre"> </span><a href="#loc_210_33_210_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_33_210_35&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
              </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_209_8_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_8_209_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">]

</span></div></body></html>