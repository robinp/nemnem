<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}

module System.IO.Streams.Tests.Zlib (tests) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           Blaze.ByteString.Builder
import qualified Codec.Compression.GZip               as GZ
import qualified Codec.Compression.Zlib               as Z
import           Control.Monad                        hiding (</span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="mpre">mapM</span></a><span class="mpre">)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Zlib.hs&quot;, srcSpanStartLine = 10, srcSpanStartColumn = 18, srcSpanEndLine = 10, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">                (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Zlib.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 18, srcSpanEndLine = 11, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">                as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Zlib.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre">           as L
import           Prelude                              hiding (</span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="mpre">mapM</span></a><span class="mpre">, </span><a href="Text.Read.html#loc_91_1_91_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.html#loc_91_1_91_5&#39;)"><span class="mpre">read</span></a><span class="mpre">)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Zlib.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Test.Framework&quot;"><span class="mpre">Test.Framework</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Zlib.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 18, srcSpanEndLine = 15, srcSpanEndColumn = 48}, srcInfoPoints = []}) &quot;Test.Framework.Providers.HUnit&quot;"><span class="mpre">Test.Framework.Providers.HUnit</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Zlib.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 18, srcSpanEndLine = 16, srcSpanEndColumn = 54}, srcInfoPoints = []}) &quot;Test.Framework.Providers.QuickCheck2&quot;"><span class="mpre">Test.Framework.Providers.QuickCheck2</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Zlib.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 18, srcSpanEndLine = 17, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">                           hiding (Test)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Zlib.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 18, srcSpanEndLine = 18, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre">                      hiding (output)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Zlib.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 18, srcSpanEndLine = 19, srcSpanEndColumn = 41}, srcInfoPoints = []}) &quot;Test.QuickCheck.Monadic&quot;"><span class="mpre">Test.QuickCheck.Monadic</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           System.IO.Streams                    hiding (</span><a href="System.IO.Streams.ByteString.html#loc_99_1_99_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_99_1_99_15&#39;)"><span class="mpre">fromByteString</span></a><span class="mpre">)
import           System.IO.Streams.Tests.Common

</span><a href="#loc_25_1_25_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_6&#39;)"><span class="mpre">tests</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">]
</span><a name="loc_25_1_25_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = [ </span><a href="#loc_36_1_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_11&#39;)"><span class="hl_varref"><span class="mpre">testIdGzip</span></span></a><span class="mpre">
        , </span><a href="#loc_44_1_44_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_15&#39;)"><span class="hl_varref"><span class="mpre">testIdCompress</span></span></a><span class="mpre">
        , </span><a href="#loc_82_1_82_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_14&#39;)"><span class="hl_varref"><span class="mpre">testBigString</span></span></a><span class="mpre">
        , </span><a href="#loc_129_1_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_21&#39;)"><span class="hl_varref"><span class="mpre">testBuilderFlushGZip</span></span></a><span class="mpre">
        , </span><a href="#loc_138_1_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_25&#39;)"><span class="hl_varref"><span class="mpre">testBuilderFlushCompress</span></span></a><span class="mpre">
        , </span><a href="#loc_179_1_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_13&#39;)"><span class="hl_varref"><span class="mpre">testTrivials</span></span></a><span class="mpre">
        ]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_36_1_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_11&#39;)"><span class="mpre">testIdGzip</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_36_1_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">testIdGzip</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;zlib/idGZip&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_39_5_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_39_5_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_39_5_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_39_10_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_10_39_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_61_1_61_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_7&#39;)"><span class="hl_varref"><span class="mpre">propId</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;idGZip&quot;</span></span><span class="mpre"> </span><a href="Codec.Compression.GZip.html#loc_95_1_95_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_95_1_95_11&#39;)"><span class="hl_varref"><span class="mpre">GZ.decompress</span></span></a><span class="mpre"> </span><a href="Codec.Compression.GZip.html#loc_117_1_117_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_117_1_117_9&#39;)"><span class="hl_varref"><span class="mpre">GZ.compress</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Zlib.html#loc_48_1_48_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_48_1_48_7&#39;)"><span class="hl_varref"><span class="mpre">gunzip</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Zlib.html#loc_183_1_183_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_183_1_183_5&#39;)"><span class="hl_varref"><span class="mpre">gzip</span></span></a><span class="mpre"> </span><a href="#loc_39_10_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_10_39_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_44_1_44_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_15&#39;)"><span class="mpre">testIdCompress</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_44_1_44_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_15&#39;)"><span class="hl_vardecl"><span class="mpre">testIdCompress</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;zlib/idCompress&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                 </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_48_5_48_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_5_48_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_48_5_48_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_5_48_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_48_5_48_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_5_48_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_48_10_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_61_1_61_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_7&#39;)"><span class="hl_varref"><span class="mpre">propId</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;idCompress&quot;</span></span><span class="mpre"> </span><a href="Codec.Compression.Zlib.html#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.Zlib.html#loc_83_1_83_11&#39;)"><span class="hl_varref"><span class="mpre">Z.decompress</span></span></a><span class="mpre"> </span><a href="Codec.Compression.Zlib.html#loc_105_1_105_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.Zlib.html#loc_105_1_105_9&#39;)"><span class="hl_varref"><span class="mpre">Z.compress</span></span></a><span class="mpre">
                    </span><a href="System.IO.Streams.Zlib.html#loc_54_1_54_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_54_1_54_11&#39;)"><span class="hl_varref"><span class="mpre">decompress</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Zlib.html#loc_192_1_192_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_192_1_192_9&#39;)"><span class="hl_varref"><span class="mpre">compress</span></span></a><span class="mpre"> </span><a href="#loc_48_10_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_61_1_61_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_7&#39;)"><span class="mpre">propId</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
       -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">)
       -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">)
       -&gt; (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">))
       -&gt; (</span><a href="System.IO.Streams.Zlib.html#loc_162_9_162_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_162_9_162_25&#39;)"><span class="hl_tyconref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
                            -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">))
       -&gt; [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">]
       -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_61_1_61_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_7&#39;)"><span class="hl_fundecl"><span class="mpre">propId</span></span></a><span class="mpre"> </span><a name="loc_61_8_61_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_8_61_12&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_61_13_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_13_61_16&#39;)"><span class="hl_vardecl"><span class="mpre">inf</span></span></a><span class="mpre"> </span><a name="loc_61_17_61_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_17_61_20&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> </span><a name="loc_61_21_61_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_21_61_27&#39;)"><span class="hl_vardecl"><span class="mpre">infStr</span></span></a><span class="mpre"> </span><a name="loc_61_28_61_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_28_61_34&#39;)"><span class="hl_vardecl"><span class="mpre">defStr</span></span></a><span class="mpre"> </span><a name="loc_61_35_61_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_35_61_37&#39;)"><span class="hl_vardecl"><span class="mpre">l0</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">pre</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_61_35_61_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_35_61_37&#39;)"><span class="hl_varref"><span class="mpre">l0</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_61_35_61_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_35_61_37&#39;)"><span class="hl_varref"><span class="mpre">l0</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        let </span><a name="loc_64_13_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_13_64_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_61_35_61_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_35_61_37&#39;)"><span class="hl_varref"><span class="mpre">l0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
                  [ </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">cycle</span></span><span class="mpre"> </span><a href="#loc_61_35_61_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_35_61_37&#39;)"><span class="hl_varref"><span class="mpre">l0</span></span></a><span class="mpre"> ]
        let </span><a name="loc_67_13_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_13_67_16&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> = </span><a href="#loc_61_17_61_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_17_61_20&#39;)"><span class="hl_varref"><span class="mpre">def</span></span></a><span class="mpre"> </span><a href="#loc_64_13_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_13_64_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

        </span><a name="loc_69_9_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_11&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">          &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_67_13_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_13_67_16&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_61_21_61_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_21_61_27&#39;)"><span class="hl_varref"><span class="mpre">infStr</span></span></a><span class="mpre">
        (</span><a name="loc_70_10_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_13&#39;)"><span class="hl_vardecl"><span class="mpre">os0</span></span></a><span class="mpre">, </span><a name="loc_70_15_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_15_70_19&#39;)"><span class="hl_vardecl"><span class="mpre">grab</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
        </span><a name="loc_71_9_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_11&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">          &lt;- </span><a href="#loc_61_28_61_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_28_61_34&#39;)"><span class="hl_varref"><span class="mpre">defStr</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Zlib.html#loc_169_1_169_24" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_169_1_169_24&#39;)"><span class="hl_varref"><span class="mpre">defaultCompressionLevel</span></span></a><span class="mpre"> </span><a href="#loc_70_10_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_13&#39;)"><span class="hl_varref"><span class="mpre">os0</span></span></a><span class="mpre">

        </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_11&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">
        </span><a name="loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_vardecl"><span class="mpre">outp</span></span></a><span class="mpre">        &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_70_15_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_15_70_19&#39;)"><span class="hl_varref"><span class="mpre">grab</span></span></a><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><a href="#loc_61_8_61_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_8_61_12&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_64_13_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_13_64_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_61_13_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_13_61_16&#39;)"><span class="hl_varref"><span class="mpre">inf</span></span></a><span class="mpre"> </span><a href="#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_varref"><span class="mpre">outp</span></span></a><span class="mpre">)



</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_82_1_82_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_14&#39;)"><span class="mpre">testBigString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_82_1_82_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_14&#39;)"><span class="hl_vardecl"><span class="mpre">testBigString</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;zlib/bigString&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    let </span><a name="loc_83_9_83_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">640000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cycle</span></span><span class="mpre">
            [ </span><span class="hl_string"><span class="mpre">&quot;lfkdsjflkdshflkjdhsfkljhdslkfhdslakjfhlkdsjhflkjdsahflkjhsa&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;39287647893264987368947632198746328974698327649873216498713&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;bznmbxz879hJKHYG^&amp;%^&amp;^%*&amp;^%*&amp;^%*&amp;^%&amp;*^%&amp;*65tykjhdgbmdnvkjch&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;VBUYDUHKJC*(HJKDHLCJBUYEOUIHJCHUOY&amp;*^(*)@HJDNM&lt;NCKJHVUKHLKJ&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;())))))A(JXNZMWJ#*&amp;^&amp;YIUHDHKJHKJLNCnkfdhkfy32huukhksnc8310s&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;|||||A!@2iuozukx|djklu8udjlm3n3888****8ijlfkdjvnchiuyuis&#39;;&#39;&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;56%^%^%^%^4dnmcnjjk3NJKNKJCiejnhfj[]][}{[][]f[][]d]299ikkjn&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;fjlkdjklfozi898888****2jkmdc,x.//,.,/asl;oi39uijdp&#39;&#39;&#39;qwjkjh&quot;</span></span><span class="mpre">
            ]

    (</span><a name="loc_94_6_94_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_6_94_9&#39;)"><span class="hl_vardecl"><span class="mpre">os0</span></span></a><span class="mpre">, </span><a name="loc_94_11_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_15&#39;)"><span class="hl_vardecl"><span class="mpre">grab</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
    </span><a name="loc_95_5_95_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_5_95_7&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Zlib.html#loc_183_1_183_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_183_1_183_5&#39;)"><span class="hl_varref"><span class="mpre">gzip</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><a href="#loc_94_6_94_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_6_94_9&#39;)"><span class="hl_varref"><span class="mpre">os0</span></span></a><span class="mpre">

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><a href="#loc_83_9_83_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_204_1_204_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_204_1_204_10&#39;)"><span class="hl_varref"><span class="mpre">connectTo</span></span></a><span class="mpre"> </span><a href="#loc_95_5_95_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_5_95_7&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">

    </span><a name="loc_99_5_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_8&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_94_11_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_15&#39;)"><span class="hl_varref"><span class="mpre">grab</span></span></a><span class="mpre">



    let </span><a name="loc_103_9_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_11&#39;)"><span class="hl_vardecl"><span class="mpre">o1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><a href="#loc_83_9_83_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_9_83_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">]
    let </span><a name="loc_104_9_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_11&#39;)"><span class="hl_vardecl"><span class="mpre">o2</span></span></a><span class="mpre"> = </span><a href="Codec.Compression.GZip.html#loc_95_1_95_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_95_1_95_11&#39;)"><span class="hl_varref"><span class="mpre">GZ.decompress</span></span></a><span class="mpre"> </span><a href="#loc_99_5_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_8&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">

    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_103_9_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_11&#39;)"><span class="hl_varref"><span class="mpre">o1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_104_9_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_11&#39;)"><span class="hl_varref"><span class="mpre">o2</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;o1 /= o2&quot;</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;o1 = &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000</span></span><span class="mpre"> </span><a href="#loc_103_9_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_11&#39;)"><span class="hl_varref"><span class="mpre">o1</span></span></a><span class="mpre">)
                     </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;...&quot;</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;o2 = &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000</span></span><span class="mpre"> </span><a href="#loc_104_9_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_11&#39;)"><span class="hl_varref"><span class="mpre">o2</span></span></a><span class="mpre">)
                     </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;...&quot;</span></span><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;len(o1)=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_103_9_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_11&#39;)"><span class="hl_varref"><span class="mpre">o1</span></span></a><span class="mpre">)
        </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;len(o2)=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_104_9_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_11&#39;)"><span class="hl_varref"><span class="mpre">o2</span></span></a><span class="mpre">)

    </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bigString1&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_103_9_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_11&#39;)"><span class="hl_varref"><span class="mpre">o1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_104_9_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_11&#39;)"><span class="hl_varref"><span class="mpre">o2</span></span></a><span class="mpre">

    </span><a name="loc_118_5_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_5_118_8&#39;)"><span class="hl_vardecl"><span class="mpre">is2</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> ([</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_99_5_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_8&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Zlib.html#loc_48_1_48_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_48_1_48_7&#39;)"><span class="hl_varref"><span class="mpre">gunzip</span></span></a><span class="mpre">
    (</span><a name="loc_119_6_119_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_6_119_9&#39;)"><span class="hl_vardecl"><span class="mpre">os1</span></span></a><span class="mpre">, </span><a name="loc_119_11_119_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_11_119_16&#39;)"><span class="hl_vardecl"><span class="mpre">grab&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_118_5_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_5_118_8&#39;)"><span class="hl_varref"><span class="mpre">is2</span></span></a><span class="mpre"> </span><a href="#loc_119_6_119_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_6_119_9&#39;)"><span class="hl_varref"><span class="mpre">os1</span></span></a><span class="mpre">
    </span><a name="loc_121_5_121_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_9&#39;)"><span class="hl_vardecl"><span class="mpre">out&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_119_11_119_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_11_119_16&#39;)"><span class="hl_varref"><span class="mpre">grab&#39;</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bigString2&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_103_9_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_11&#39;)"><span class="hl_varref"><span class="mpre">o1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_121_5_121_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_9&#39;)"><span class="hl_varref"><span class="mpre">out&#39;</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_129_1_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_21&#39;)"><span class="mpre">testBuilderFlushGZip</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_129_1_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_21&#39;)"><span class="hl_vardecl"><span class="mpre">testBuilderFlushGZip</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;zlib/builderFlushGZip&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                       </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_133_5_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_5_133_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_133_5_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_5_133_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_133_5_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_5_133_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> (</span><a name="loc_133_11_133_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_11_133_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_133_13_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_13_133_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_153_1_153_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_17&#39;)"><span class="hl_varref"><span class="mpre">propBuilderFlush</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzip&quot;</span></span><span class="mpre"> </span><a href="Codec.Compression.GZip.html#loc_95_1_95_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_95_1_95_11&#39;)"><span class="hl_varref"><span class="mpre">GZ.decompress</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Zlib.html#loc_123_1_123_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_123_1_123_12&#39;)"><span class="hl_varref"><span class="mpre">gzipBuilder</span></span></a><span class="mpre"> </span><a href="#loc_133_11_133_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_11_133_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_133_13_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_13_133_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_138_1_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_25&#39;)"><span class="mpre">testBuilderFlushCompress</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_138_1_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_25&#39;)"><span class="hl_vardecl"><span class="mpre">testBuilderFlushCompress</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;zlib/builderFlushCompress&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                           </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_142_5_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_5_142_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_142_5_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_5_142_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_142_5_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_5_142_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> (</span><a name="loc_142_11_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_11_142_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_142_13_142_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_13_142_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_153_1_153_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_17&#39;)"><span class="hl_varref"><span class="mpre">propBuilderFlush</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;zlib&quot;</span></span><span class="mpre"> </span><a href="Codec.Compression.Zlib.html#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.Zlib.html#loc_83_1_83_11&#39;)"><span class="hl_varref"><span class="mpre">Z.decompress</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Zlib.html#loc_133_1_133_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_133_1_133_16&#39;)"><span class="hl_varref"><span class="mpre">compressBuilder</span></span></a><span class="mpre"> </span><a href="#loc_142_11_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_11_142_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_142_13_142_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_13_142_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_153_1_153_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_17&#39;)"><span class="mpre">propBuilderFlush</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                 -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">)
                 -&gt; (</span><a href="System.IO.Streams.Zlib.html#loc_162_9_162_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_162_9_162_25&#39;)"><span class="hl_tyconref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre">
                     -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">))
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_153_1_153_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_17&#39;)"><span class="hl_fundecl"><span class="mpre">propBuilderFlush</span></span></a><span class="mpre"> </span><a name="loc_153_18_153_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_18_153_22&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_153_23_153_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_23_153_26&#39;)"><span class="hl_vardecl"><span class="mpre">inf</span></span></a><span class="mpre"> </span><a name="loc_153_27_153_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_27_153_31&#39;)"><span class="hl_vardecl"><span class="mpre">comp</span></span></a><span class="mpre"> </span><a name="loc_153_32_153_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_32_153_33&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_153_34_153_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_35&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">pre</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_153_32_153_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_32_153_33&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_153_34_153_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_35&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">))
    </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a href="#loc_162_5_162_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_5_162_6&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> [ </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_153_32_153_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_32_153_33&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_153_34_153_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_35&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            , </span><a href="Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre"> ]

        </span><a href="#loc_162_5_162_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_5_162_6&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> [ </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_153_32_153_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_32_153_33&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_153_34_153_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_35&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> ]

  where
    </span><a name="loc_162_5_162_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_5_162_6&#39;)"><span class="hl_fundecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_162_7_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_7_162_15&#39;)"><span class="hl_vardecl"><span class="mpre">expected</span></span></a><span class="mpre"> </span><a name="loc_162_16_162_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_16_162_21&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = do
        (</span><a name="loc_163_10_163_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_10_163_13&#39;)"><span class="hl_vardecl"><span class="mpre">os0</span></span></a><span class="mpre">, </span><a name="loc_163_15_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_15_163_19&#39;)"><span class="hl_vardecl"><span class="mpre">grab</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
        </span><a name="loc_164_9_164_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_9_164_11&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">          &lt;- </span><a href="System.IO.Streams.Builder.html#loc_94_1_94_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Builder.html#loc_94_1_94_14&#39;)"><span class="hl_varref"><span class="mpre">builderStream</span></span></a><span class="mpre"> </span><a href="#loc_163_10_163_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_10_163_13&#39;)"><span class="hl_varref"><span class="mpre">os0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_153_27_153_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_27_153_31&#39;)"><span class="hl_varref"><span class="mpre">comp</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Zlib.html#loc_169_1_169_24" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_169_1_169_24&#39;)"><span class="hl_varref"><span class="mpre">defaultCompressionLevel</span></span></a><span class="mpre">

        </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><a href="#loc_162_16_162_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_16_162_21&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_204_1_204_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_204_1_204_10&#39;)"><span class="hl_varref"><span class="mpre">connectTo</span></span></a><span class="mpre"> </span><a href="#loc_164_9_164_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_9_164_11&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">
        </span><a name="loc_167_9_167_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_11&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_163_15_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_15_163_19&#39;)"><span class="hl_varref"><span class="mpre">grab</span></span></a><span class="mpre">

        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_167_9_167_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_11&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_162_7_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_7_162_15&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;xs is &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_167_9_167_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_11&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> (</span><a href="#loc_153_18_153_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_18_153_22&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/len&quot;</span></span><span class="mpre">) </span><a href="#loc_162_7_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_7_162_15&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_167_9_167_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_11&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

        let </span><a name="loc_172_13_172_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_13_172_17&#39;)"><span class="hl_vardecl"><span class="mpre">outp</span></span></a><span class="mpre"> = </span><a href="#loc_153_23_153_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_23_153_26&#39;)"><span class="hl_varref"><span class="mpre">inf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_167_9_167_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_9_167_11&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> (</span><a href="#loc_153_18_153_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_18_153_22&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/eq&quot;</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><a href="#loc_153_32_153_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_32_153_33&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_153_34_153_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_35&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">]) </span><a href="#loc_172_13_172_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_13_172_17&#39;)"><span class="hl_varref"><span class="mpre">outp</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_179_1_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_13&#39;)"><span class="mpre">testTrivials</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_179_1_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_13&#39;)"><span class="hl_vardecl"><span class="mpre">testTrivials</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;zlib/trivials&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    let </span><a name="loc_180_9_180_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_9_180_11&#39;)"><span class="hl_vardecl"><span class="mpre">cl</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Zlib.html#loc_162_28_162_44" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Zlib.html#loc_162_28_162_44&#39;)"><span class="hl_conref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
    </span><a href="System.IO.Streams.Tests.Common.html#loc_57_1_57_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_57_1_57_18&#39;)"><span class="hl_varref"><span class="mpre">coverReadInstance</span></span></a><span class="mpre"> </span><a href="#loc_180_9_180_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_9_180_11&#39;)"><span class="hl_varref"><span class="mpre">cl</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Tests.Common.html#loc_48_1_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_48_1_48_18&#39;)"><span class="hl_varref"><span class="mpre">coverShowInstance</span></span></a><span class="mpre"> </span><a href="#loc_180_9_180_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_9_180_11&#39;)"><span class="hl_varref"><span class="mpre">cl</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Tests.Common.html#loc_64_1_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_64_1_64_16&#39;)"><span class="hl_varref"><span class="mpre">coverEqInstance</span></span></a><span class="mpre">   </span><a href="#loc_180_9_180_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_9_180_11&#39;)"><span class="hl_varref"><span class="mpre">cl</span></span></a><span class="mpre">
</span></div></body></html>