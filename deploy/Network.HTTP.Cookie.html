<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Network.HTTP.Cookie</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  See LICENSE file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Ganesh Sittampalam &lt;ganesh@earth.li&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (not tested)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module provides the data types and functions for working with HTTP cookies.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Right now, it contains mostly functionality needed by &#39;Network.Browser&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
module Network.HTTP.Cookie
       ( Cookie(..)
       , cookieMatch          </span><span class="hl_comment"><span class="mpre">-- :: (String,String) -&gt; Cookie -&gt; Bool</span></span><span class="mpre">

          </span><span class="hl_comment"><span class="mpre">-- functions for translating cookies and headers.</span></span><span class="mpre">
       , cookiesToHeader      </span><span class="hl_comment"><span class="mpre">-- :: [Cookie] -&gt; Header</span></span><span class="mpre">
       , processCookieHeaders </span><span class="hl_comment"><span class="mpre">-- :: String -&gt; [Header] -&gt; ([String], [Cookie])</span></span><span class="mpre">
       ) where

import Network.HTTP.Headers

import Data.Char
import Data.List
import Data.Maybe

import Text.ParserCombinators.Parsec
   ( Parser, char, </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="mpre">many</span></a><span class="mpre">, </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="mpre">many1</span></a><span class="mpre">, satisfy, </span><a href="Text.Parsec.Prim.html#loc_642_1_642_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_642_1_642_6&#39;)"><span class="mpre">parse</span></a><span class="mpre">, </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="mpre">option</span></a><span class="mpre">, </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="mpre">try</span></a><span class="mpre">
   , </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="mpre">(&lt;|&gt;)</span></a><span class="mpre">, </span><a href="Text.Parsec.Combinator.html#loc_117_1_117_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_117_1_117_7&#39;)"><span class="mpre">sepBy1</span></a><span class="mpre">
   )

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------- Cookie Stuff -----------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @Cookie@ is the Haskell representation of HTTP cookie values.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See its relevant specs for authoritative details.</span></span><span class="mpre">
data </span><a name="loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Cookie</span></span></a><span class="mpre"> 
 = </span><span class="hl_condecl"><span class="mpre">MkCookie</span></span><span class="mpre"> 
    { </span><a name="loc_43_7_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_15&#39;)"><span class="hl_fielddecl"><span class="mpre">ckDomain</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_44_7_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_13&#39;)"><span class="hl_fielddecl"><span class="mpre">ckName</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_45_7_45_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_14&#39;)"><span class="hl_fielddecl"><span class="mpre">ckValue</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_46_7_46_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_13&#39;)"><span class="hl_fielddecl"><span class="mpre">ckPath</span></span></a><span class="mpre">    :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_47_7_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_7_47_16&#39;)"><span class="hl_fielddecl"><span class="mpre">ckComment</span></span></a><span class="mpre"> :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_48_7_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_16&#39;)"><span class="hl_fielddecl"><span class="mpre">ckVersion</span></span></a><span class="mpre"> :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Cookie.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 5, srcSpanEndLine = 50, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Cookie.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 5, srcSpanEndLine = 50, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Cookie.hs&quot;, srcSpanStar"><span class="mpre">deriving(Show,Read)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre"> </span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre"> where
    </span><a name="loc_53_5_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">==</span></span><span class="mpre"> </span><a name="loc_53_10_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">  =  </span><a href="#loc_43_7_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_15&#39;)"><span class="hl_varref"><span class="mpre">ckDomain</span></span></a><span class="mpre"> </span><a href="#loc_53_5_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_43_7_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_15&#39;)"><span class="hl_varref"><span class="mpre">ckDomain</span></span></a><span class="mpre"> </span><a href="#loc_53_10_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> 
            </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_44_7_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_13&#39;)"><span class="hl_varref"><span class="mpre">ckName</span></span></a><span class="mpre"> </span><a href="#loc_53_5_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_44_7_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_13&#39;)"><span class="hl_varref"><span class="mpre">ckName</span></span></a><span class="mpre"> </span><a href="#loc_53_10_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> 
            </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_46_7_46_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_13&#39;)"><span class="hl_varref"><span class="mpre">ckPath</span></span></a><span class="mpre"> </span><a href="#loc_53_5_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_46_7_46_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_13&#39;)"><span class="hl_varref"><span class="mpre">ckPath</span></span></a><span class="mpre"> </span><a href="#loc_53_10_53_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @cookieToHeaders ck@ serialises @Cookie@s to an HTTP request header.</span></span><span class="mpre">
</span><a href="#loc_59_1_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_16&#39;)"><span class="mpre">cookiesToHeader</span></a><span class="mpre"> :: [</span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">] -&gt; </span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">
</span><a name="loc_59_1_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_16&#39;)"><span class="hl_fundecl"><span class="mpre">cookiesToHeader</span></span></a><span class="mpre"> </span><a name="loc_59_17_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_19&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Headers.html#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_89_4_89_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_89_4_89_13&#39;)"><span class="hl_conref"><span class="mpre">HdrCookie</span></span></a><span class="mpre"> (</span><a href="#loc_64_1_64_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_20&#39;)"><span class="hl_varref"><span class="mpre">mkCookieHeaderValue</span></span></a><span class="mpre"> </span><a href="#loc_59_17_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_19&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Turn a list of cookies into a key=value pair list, separated by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- semicolons.</span></span><span class="mpre">
</span><a href="#loc_64_1_64_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_20&#39;)"><span class="mpre">mkCookieHeaderValue</span></a><span class="mpre"> :: [</span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_64_1_64_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_20&#39;)"><span class="hl_vardecl"><span class="mpre">mkCookieHeaderValue</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_66_5_66_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_25&#39;)"><span class="hl_varref"><span class="mpre">mkCookieHeaderValue1</span></span></a><span class="mpre">
  where
    </span><a name="loc_66_5_66_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_25&#39;)"><span class="hl_fundecl"><span class="mpre">mkCookieHeaderValue1</span></span></a><span class="mpre"> </span><a name="loc_66_26_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_26_66_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_44_7_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_13&#39;)"><span class="hl_varref"><span class="mpre">ckName</span></span></a><span class="mpre"> </span><a href="#loc_66_26_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_26_66_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_45_7_45_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_14&#39;)"><span class="hl_varref"><span class="mpre">ckValue</span></span></a><span class="mpre"> </span><a href="#loc_66_26_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_26_66_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @cookieMatch (domain,path) ck@ performs the standard cookie</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- match wrt the given domain and path. </span></span><span class="mpre">
</span><a href="#loc_71_1_71_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_12&#39;)"><span class="mpre">cookieMatch</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; </span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_71_1_71_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_12&#39;)"><span class="hl_fundecl"><span class="mpre">cookieMatch</span></span></a><span class="mpre"> (</span><a name="loc_71_14_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_17&#39;)"><span class="hl_vardecl"><span class="mpre">dom</span></span></a><span class="mpre">,</span><a name="loc_71_18_71_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_22&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre">) </span><a name="loc_71_24_71_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_24_71_26&#39;)"><span class="hl_vardecl"><span class="mpre">ck</span></span></a><span class="mpre"> =
 </span><a href="#loc_43_7_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_15&#39;)"><span class="hl_varref"><span class="mpre">ckDomain</span></span></a><span class="mpre"> </span><a href="#loc_71_24_71_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_24_71_26&#39;)"><span class="hl_varref"><span class="mpre">ck</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_294_1_294_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_294_1_294_11&#39;)"><span class="hl_infix"><span class="mpre">`isSuffixOf`</span></span></a><span class="mpre"> </span><a href="#loc_71_14_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_17&#39;)"><span class="hl_varref"><span class="mpre">dom</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
 case </span><a href="#loc_46_7_46_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_13&#39;)"><span class="hl_varref"><span class="mpre">ckPath</span></span></a><span class="mpre"> </span><a href="#loc_71_24_71_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_24_71_26&#39;)"><span class="hl_varref"><span class="mpre">ck</span></span></a><span class="mpre"> of
   </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
   </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_75_9_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_75_9_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_71_18_71_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_22&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @processCookieHeaders dom hdrs@ </span></span><span class="mpre">
</span><a href="#loc_80_1_80_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_21&#39;)"><span class="mpre">processCookieHeaders</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">] -&gt; ([</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">], [</span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">])
</span><a name="loc_80_1_80_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_21&#39;)"><span class="hl_fundecl"><span class="mpre">processCookieHeaders</span></span></a><span class="mpre"> </span><a name="loc_80_22_80_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_22_80_25&#39;)"><span class="hl_vardecl"><span class="mpre">dom</span></span></a><span class="mpre"> </span><a name="loc_80_26_80_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_26_80_30&#39;)"><span class="hl_vardecl"><span class="mpre">hdrs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><a href="#loc_84_1_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_16&#39;)"><span class="hl_varref"><span class="mpre">headerToCookies</span></span></a><span class="mpre"> </span><a href="#loc_80_22_80_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_22_80_25&#39;)"><span class="hl_varref"><span class="mpre">dom</span></span></a><span class="mpre">) ([],[]) </span><a href="#loc_80_26_80_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_26_80_30&#39;)"><span class="hl_varref"><span class="mpre">hdrs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @headerToCookies dom hdr acc@ </span></span><span class="mpre">
</span><a href="#loc_84_1_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_16&#39;)"><span class="mpre">headerToCookies</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">], [</span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">]) -&gt; ([</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">], [</span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">])
</span><a name="loc_84_1_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_16&#39;)"><span class="hl_fundecl"><span class="mpre">headerToCookies</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">dom</span></span><span class="mpre"> (</span><a href="Network.HTTP.Headers.html#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Headers.html#loc_110_4_110_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_110_4_110_16&#39;)"><span class="hl_conref"><span class="mpre">HdrSetCookie</span></span></a><span class="mpre"> </span><a name="loc_84_42_84_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_42_84_45&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre">) (</span><a name="loc_84_48_84_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_48_84_54&#39;)"><span class="hl_vardecl"><span class="mpre">accErr</span></span></a><span class="mpre">, </span><a name="loc_84_56_84_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_56_84_65&#39;)"><span class="hl_vardecl"><span class="mpre">accCookie</span></span></a><span class="mpre">) = 
    case </span><a href="Text.Parsec.Prim.html#loc_642_1_642_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_642_1_642_6&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="#loc_90_4_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_4_90_11&#39;)"><span class="hl_varref"><span class="mpre">cookies</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_84_42_84_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_42_84_45&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> of
        </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Cookie.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 9, srcSpanEndLine = 86, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Cookie.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 13, srcSpanEndLine = 86, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Cookie.hs&quot;, srcSpanStartLi"><span class="mpre">Left{}</span></span><span class="mpre">  -&gt; (</span><a href="#loc_84_42_84_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_42_84_45&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_84_48_84_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_48_84_54&#39;)"><span class="hl_varref"><span class="mpre">accErr</span></span></a><span class="mpre">, </span><a href="#loc_84_56_84_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_56_84_65&#39;)"><span class="hl_varref"><span class="mpre">accCookie</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_87_15_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_84_48_84_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_48_84_54&#39;)"><span class="hl_varref"><span class="mpre">accErr</span></span></a><span class="mpre">, </span><a href="#loc_87_15_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_84_56_84_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_56_84_65&#39;)"><span class="hl_varref"><span class="mpre">accCookie</span></span></a><span class="mpre">)
  where
   </span><a href="#loc_90_4_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_4_90_11&#39;)"><span class="mpre">cookies</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> [</span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">]
   </span><a name="loc_90_4_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_4_90_11&#39;)"><span class="hl_vardecl"><span class="mpre">cookies</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Combinator.html#loc_117_1_117_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_117_1_117_7&#39;)"><span class="hl_varref"><span class="mpre">sepBy1</span></span></a><span class="mpre"> </span><a href="#loc_93_4_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_4_93_10&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre">)

   </span><a href="#loc_93_4_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_4_93_10&#39;)"><span class="mpre">cookie</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">
   </span><a name="loc_93_4_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_4_93_10&#39;)"><span class="hl_vardecl"><span class="mpre">cookie</span></span></a><span class="mpre"> =
       do </span><a name="loc_94_11_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_15&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_141_1_141_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_5&#39;)"><span class="hl_varref"><span class="mpre">word</span></span></a><span class="mpre">
          _    &lt;- </span><a href="#loc_104_4_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_4_104_12&#39;)"><span class="hl_varref"><span class="mpre">spaces_l</span></span></a><span class="mpre">
          _    &lt;- </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre">
          _    &lt;- </span><a href="#loc_104_4_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_4_104_12&#39;)"><span class="hl_varref"><span class="mpre">spaces_l</span></span></a><span class="mpre">
          </span><a name="loc_98_11_98_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_15&#39;)"><span class="hl_vardecl"><span class="mpre">val1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_106_4_106_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_4_106_10&#39;)"><span class="hl_varref"><span class="mpre">cvalue</span></span></a><span class="mpre">
          </span><a name="loc_99_11_99_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_11_99_15&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_110_4_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_4_110_11&#39;)"><span class="hl_varref"><span class="mpre">cdetail</span></span></a><span class="mpre">
          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_121_4_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_4_121_12&#39;)"><span class="hl_varref"><span class="mpre">mkCookie</span></span></a><span class="mpre"> </span><a href="#loc_94_11_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_15&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_98_11_98_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_15&#39;)"><span class="hl_varref"><span class="mpre">val1</span></span></a><span class="mpre"> </span><a href="#loc_99_11_99_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_11_99_15&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">

   </span><a href="#loc_106_4_106_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_4_106_10&#39;)"><span class="mpre">cvalue</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
   
   </span><a name="loc_104_4_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_4_104_12&#39;)"><span class="hl_vardecl"><span class="mpre">spaces_l</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre">)

   </span><a name="loc_106_4_106_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_4_106_10&#39;)"><span class="hl_vardecl"><span class="mpre">cvalue</span></span></a><span class="mpre"> = </span><a href="#loc_135_1_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_13&#39;)"><span class="hl_varref"><span class="mpre">quotedstring</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;;&#39;</span></span><span class="mpre">)) </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
   
   </span><span class="hl_comment"><span class="mpre">-- all keys in the result list MUST be in lower case</span></span><span class="mpre">
   </span><a href="#loc_110_4_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_4_110_11&#39;)"><span class="mpre">cdetail</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
   </span><a name="loc_110_4_110_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_4_110_11&#39;)"><span class="hl_vardecl"><span class="mpre">cdetail</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
       </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> (do _  &lt;- </span><a href="#loc_104_4_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_4_104_12&#39;)"><span class="hl_varref"><span class="mpre">spaces_l</span></span></a><span class="mpre">
               _  &lt;- </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;;&#39;</span></span><span class="mpre">
               _  &lt;- </span><a href="#loc_104_4_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_4_104_12&#39;)"><span class="hl_varref"><span class="mpre">spaces_l</span></span></a><span class="mpre">
               </span><a name="loc_114_16_114_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_16_114_18&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_141_1_141_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_5&#39;)"><span class="hl_varref"><span class="mpre">word</span></span></a><span class="mpre">
               _  &lt;- </span><a href="#loc_104_4_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_4_104_12&#39;)"><span class="hl_varref"><span class="mpre">spaces_l</span></span></a><span class="mpre">
               </span><a name="loc_116_16_116_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_18&#39;)"><span class="hl_vardecl"><span class="mpre">s2</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_104_4_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_4_104_12&#39;)"><span class="hl_varref"><span class="mpre">spaces_l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_106_4_106_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_4_106_10&#39;)"><span class="hl_varref"><span class="mpre">cvalue</span></span></a><span class="mpre">)
               </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_114_16_114_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_16_114_18&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre">,</span><a href="#loc_116_16_116_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_18&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="mpre">)
           )

   </span><a href="#loc_121_4_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_4_121_12&#39;)"><span class="mpre">mkCookie</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><a href="#loc_41_6_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">
   </span><a name="loc_121_4_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_4_121_12&#39;)"><span class="hl_fundecl"><span class="mpre">mkCookie</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">nm</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cval</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">more</span></span><span class="mpre"> = 
          </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Cookie.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 11, srcSpanEndLine = 128, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Cookie.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 20, srcSpanEndLine = 122, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Cookie.hs&quot;, srcS"><span class="mpre">MkCookie { ckName    = nm
                   , ckValue   = cval
                   , ckDomain  = map toLower (fromMaybe dom (lookup &quot;domain&quot; more))
                   , ckPath    = lookup &quot;path&quot; more
                   , ckVersion = lookup &quot;version&quot; more
                   , ckComment = lookup &quot;comment&quot; more
                   }</span></span><span class="mpre">
</span><a href="#loc_84_1_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_16&#39;)"><span class="hl_fundecl"><span class="mpre">headerToCookies</span></span></a><span class="mpre"> _ _ </span><a name="loc_129_21_129_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_21_129_24&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> = </span><a href="#loc_129_21_129_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_21_129_24&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">

      


</span><a href="#loc_141_1_141_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_5&#39;)"><span class="mpre">word</span></a><span class="mpre">, </span><a href="#loc_135_1_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_13&#39;)"><span class="mpre">quotedstring</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_135_1_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_13&#39;)"><span class="hl_vardecl"><span class="mpre">quotedstring</span></span></a><span class="mpre"> =
    do _   &lt;- </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- &quot;</span></span><span class="mpre">
       </span><a name="loc_137_8_137_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_8_137_11&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">))
       _   &lt;- </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">
       </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_137_8_137_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_8_137_11&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">

</span><a name="loc_141_1_141_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_5&#39;)"><span class="hl_vardecl"><span class="mpre">word</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">satisfy</span></span><span class="mpre"> (\</span><a name="loc_141_25_141_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_25_141_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Unicode.html#loc_136_1_136_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_136_1_136_11&#39;)"><span class="hl_varref"><span class="mpre">isAlphaNum</span></span></a><span class="mpre"> </span><a href="#loc_141_25_141_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_25_141_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_141_25_141_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_25_141_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_141_25_141_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_25_141_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_141_25_141_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_25_141_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_141_25_141_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_25_141_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">))
</span></div></body></html>