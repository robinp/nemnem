<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE MultiParamTypeClasses, FunctionalDependencies #-}
{-# LANGUAGE ParallelListComp #-}
</span><span class="hl_comment"><span class="mpre">{-|
 Maintainer: Thomas.DuBuisson@gmail.com
 Stability: beta
 Portability: portable 

This is the heart of the crypto-api package.  By making (or having) 
an instance of Hash, AsymCipher, BlockCipher or StreamCipher you provide (or obtain)
access to any infrastructure built on these primitives include block cipher modes
of operation, hashing, hmac, signing, etc.  These classes allow users to build
routines that are agnostic to the algorithm used so changing algorithms is as simple
as changing a type signature.
-}</span></span><span class="mpre">

module Crypto.Classes
        (
        </span><span class="hl_comment"><span class="mpre">-- * Hash class and helper functions</span></span><span class="mpre">
          Hash(..)
        , hashFunc&#39;
        , hashFunc
        </span><span class="hl_comment"><span class="mpre">-- * Cipher classes and helper functions</span></span><span class="mpre">
        , BlockCipher(..)
        , blockSizeBytes
        , keyLengthBytes
        , buildKeyIO
        , buildKeyGen
        , StreamCipher(..)
        , buildStreamKeyIO
        , buildStreamKeyGen
        , AsymCipher(..)
        , buildKeyPairIO
        , buildKeyPairGen
        , Signing(..)
        , buildSigningKeyPairIO
        , buildSigningKeyPairGen
        </span><span class="hl_comment"><span class="mpre">-- * Misc helper functions</span></span><span class="mpre">
        , encode
        , zeroIV
        , incIV
        , getIV, getIVIO
        , chunkFor, chunkFor&#39;
        , module Crypto.Util
        , module Crypto.Types
        ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 8, srcSpanEndLine = 47, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
import Data.Typeable
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 8, srcSpanEndLine = 49, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Data.Serialize&quot;"><span class="mpre">Data.Serialize</span></span><span class="mpre">
import qualified Data.Serialize.Get as SG
import qualified Data.Serialize.Put as SP
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 18, srcSpanEndLine = 52, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 18, srcSpanEndLine = 53, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified Data.ByteString.Internal as I
import Data.ByteString.Unsafe (</span><a href="Data.ByteString.Unsafe.html#loc_311_1_311_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_311_1_311_22&#39;)"><span class="mpre">unsafeUseAsCStringLen</span></a><span class="mpre">)
import Control.Monad.Trans.Class (</span><a href="Control.Monad.Trans.Class.html#loc_49_5_49_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_49_5_49_9&#39;)"><span class="mpre">lift</span></a><span class="mpre">)
import Control.Monad.Trans.State (</span><a href="Control.Monad.Trans.State.Lazy.html#loc_136_9_136_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_136_9_136_15&#39;)"><span class="mpre">StateT</span></a><span class="mpre">(..), </span><a href="Control.Monad.Trans.State.Lazy.html#loc_136_33_136_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_136_33_136_42&#39;)"><span class="mpre">runStateT</span></a><span class="mpre">)
import Control.Monad (</span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="mpre">liftM</span></a><span class="mpre">)
import Data.Bits
import Data.List (</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">, </span><a href="Data.List.html#loc_607_1_607_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_607_1_607_12&#39;)"><span class="mpre">genericDrop</span></a><span class="mpre">)
import Data.Word (Word8, Word16, Word64)
import Data.Tagged
import Data.Proxy
import Crypto.Types
import Crypto.Random
import Crypto.Util
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)
import Foreign (Ptr)
import Foreign.C (CChar(..), CInt(..))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 8, srcSpanEndLine = 70, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;System.Entropy&quot;"><span class="mpre">System.Entropy</span></span><span class="mpre">
import {-# SOURCE #-} </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 23, srcSpanEndLine = 71, srcSpanEndColumn = 35}, srcInfoPoints = []}) &quot;Crypto.Modes&quot;"><span class="mpre">Crypto.Modes</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |The Hash class is intended as the generic interface</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- targeted by maintainers of Haskell digest implementations.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Using this generic interface, higher level functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- such as &#39;hash&#39; and &#39;hash&#39;&#39; provide a useful API</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for comsumers of hash implementations.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Any instantiated implementation must handle unaligned data.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Minimum complete definition: &#39;outputLength&#39;, &#39;blockLength&#39;, &#39;initialCtx&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;updateCtx&#39;, and &#39;finalize&#39;.</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 7, srcSpanEndLine = 84, srcSpanEndColumn = 7}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 7, srcSpanEndLine = 83, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 83, src"><span class="mpre">(Serialize d, Eq d, Ord d)
    =&gt;</span></span><span class="mpre"> </span><a name="loc_84_8_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_8_84_12&#39;)"><span class="hl_classdecl"><span class="mpre">Hash</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ctx</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> | </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 21, srcSpanEndLine = 84, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 23, srcSpanEndLine = 84, srcSpanEndColumn = 25}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypt"><span class="mpre">d -&gt; ctx</span></span><span class="mpre">, </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 31, srcSpanEndLine = 84, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 35, srcSpanEndLine = 84, srcSpanEndColumn = 37}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypt"><span class="mpre">ctx -&gt; d</span></span><span class="mpre"> where
  </span><a name="loc_85_3_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_15&#39;)"><span class="mpre">outputLength</span></a><span class="mpre">  :: </span><a href="Data.Tagged.html#loc_59_9_59_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_59_9_59_15&#39;)"><span class="hl_tyconref"><span class="mpre">Tagged</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ The size of the digest when encoded</span></span><span class="mpre">
  </span><a name="loc_86_3_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_3_86_14&#39;)"><span class="mpre">blockLength</span></a><span class="mpre">   :: </span><a href="Data.Tagged.html#loc_59_9_59_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_59_9_59_15&#39;)"><span class="hl_tyconref"><span class="mpre">Tagged</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ The amount of data operated on in each round of the digest computation</span></span><span class="mpre">
  </span><a name="loc_87_3_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_13&#39;)"><span class="mpre">initialCtx</span></a><span class="mpre">    :: </span><span class="hl_tyvar"><span class="mpre">ctx</span></span><span class="mpre">                        </span><span class="hl_comment"><span class="mpre">-- ^ An initial context, provided with the first call to &#39;updateCtx&#39;</span></span><span class="mpre">
  </span><a name="loc_88_3_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_12&#39;)"><span class="mpre">updateCtx</span></a><span class="mpre">     :: </span><span class="hl_tyvar"><span class="mpre">ctx</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">ctx</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Used to update a context, repeatedly called until all data is exhausted</span></span><span class="mpre">
                                              </span><span class="hl_comment"><span class="mpre">--   must operate correctly for imputs of @n*blockLength@ bytes for @n `elem` [0..]@</span></span><span class="mpre">
  </span><a name="loc_90_3_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_11&#39;)"><span class="mpre">finalize</span></a><span class="mpre">      :: </span><span class="hl_tyvar"><span class="mpre">ctx</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Finializing a context, plus any message data less than the block size, into a digest</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |Hash a lazy ByteString, creating a digest</span></span><span class="mpre">
  </span><a name="loc_93_3_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_7&#39;)"><span class="mpre">hash</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 11, srcSpanEndLine = 93, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 11, srcSpanEndLine = 93, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 93,"><span class="mpre">(Hash ctx d) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">
  </span><a href="#loc_93_3_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_7&#39;)"><span class="hl_fundecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_94_8_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_8_94_11&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><a href="#loc_96_5_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_5_96_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
    where
    </span><a name="loc_96_5_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_5_96_8&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = </span><a href="#loc_90_3_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_11&#39;)"><span class="hl_varref"><span class="mpre">finalize</span></span></a><span class="mpre"> </span><a href="#loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_98_11_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_14&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre">
    </span><a name="loc_97_5_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_8&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_88_3_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_12&#39;)"><span class="hl_varref"><span class="mpre">updateCtx</span></span></a><span class="mpre"> </span><a href="#loc_87_3_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_13&#39;)"><span class="hl_varref"><span class="mpre">initialCtx</span></span></a><span class="mpre"> </span><a href="#loc_98_6_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_10&#39;)"><span class="hl_varref"><span class="mpre">blks</span></span></a><span class="mpre">
    (</span><a name="loc_98_6_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_6_98_10&#39;)"><span class="hl_vardecl"><span class="mpre">blks</span></span></a><span class="mpre">,</span><a name="loc_98_11_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_11_98_14&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre">) = </span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">makeBlocks</span></span></a><span class="mpre"> </span><a href="#loc_94_8_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_8_94_11&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a href="#loc_99_5_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_13&#39;)"><span class="hl_varref"><span class="mpre">blockLen</span></span></a><span class="mpre">
    </span><a name="loc_99_5_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_13&#39;)"><span class="hl_vardecl"><span class="mpre">blockLen</span></span></a><span class="mpre"> = (</span><a href="#loc_86_3_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_3_86_14&#39;)"><span class="hl_varref"><span class="mpre">blockLength</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_50_1_50_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_50_1_50_7&#39;)"><span class="hl_infix"><span class="mpre">.::.</span></span></a><span class="mpre"> </span><a href="#loc_96_5_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_5_96_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |Hash a strict ByteString, creating a digest</span></span><span class="mpre">
  </span><a name="loc_102_3_102_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_8&#39;)"><span class="mpre">hash&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 12, srcSpanEndLine = 102, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 12, srcSpanEndLine = 102, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(Hash ctx d) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">
  </span><a href="#loc_102_3_102_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_8&#39;)"><span class="hl_fundecl"><span class="mpre">hash&#39;</span></span></a><span class="mpre"> </span><a name="loc_103_9_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_12&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><a href="#loc_105_5_105_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
    where
    </span><a name="loc_105_5_105_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_8&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = </span><a href="#loc_90_3_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_11&#39;)"><span class="hl_varref"><span class="mpre">finalize</span></span></a><span class="mpre"> (</span><a href="#loc_88_3_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_12&#39;)"><span class="hl_varref"><span class="mpre">updateCtx</span></span></a><span class="mpre"> </span><a href="#loc_87_3_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_3_87_13&#39;)"><span class="hl_varref"><span class="mpre">initialCtx</span></span></a><span class="mpre"> </span><a href="#loc_106_6_106_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_6_106_9&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre">) </span><a href="#loc_106_11_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_11_106_14&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre">
    (</span><a name="loc_106_6_106_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_6_106_9&#39;)"><span class="hl_vardecl"><span class="mpre">top</span></span></a><span class="mpre">, </span><a name="loc_106_11_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_11_106_14&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_107_5_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_5_107_11&#39;)"><span class="hl_varref"><span class="mpre">remlen</span></span></a><span class="mpre"> </span><a href="#loc_103_9_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_12&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
    </span><a name="loc_107_5_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_5_107_11&#39;)"><span class="hl_vardecl"><span class="mpre">remlen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_103_9_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_12&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_103_9_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_12&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`rem`</span></span><span class="mpre"> </span><a href="#loc_108_5_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_5_108_9&#39;)"><span class="hl_varref"><span class="mpre">bLen</span></span></a><span class="mpre">)
    </span><a name="loc_108_5_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_5_108_9&#39;)"><span class="hl_vardecl"><span class="mpre">bLen</span></span></a><span class="mpre"> = </span><a href="#loc_86_3_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_3_86_14&#39;)"><span class="hl_varref"><span class="mpre">blockLength</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_105_5_105_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Obtain a lazy hash function whose result is the same type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as the given digest, which is discarded.  If the type is already inferred then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- consider using the &#39;hash&#39; function instead.</span></span><span class="mpre">
</span><a href="#loc_114_1_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_9&#39;)"><span class="mpre">hashFunc</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 13, srcSpanEndLine = 113, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 22, srcSpanEndLine = 113, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">Hash c d =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">)
</span><a name="loc_114_1_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_9&#39;)"><span class="hl_fundecl"><span class="mpre">hashFunc</span></span></a><span class="mpre"> </span><a name="loc_114_10_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_11&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="#loc_116_3_116_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_3_116_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
  where
  </span><a name="loc_116_3_116_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_3_116_4&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_93_3_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_7&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre">
  </span><span class="hl_vardecl"><span class="mpre">a</span></span><span class="mpre"> = </span><a href="#loc_116_3_116_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_3_116_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`asTypeOf`</span></span><span class="mpre"> </span><a href="#loc_114_10_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_11&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Obtain a strict hash function whose result is the same type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as the given digest, which is discarded.  If the type is already inferred then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- consider using the &#39;hash&#39;&#39; function instead.</span></span><span class="mpre">
</span><a href="#loc_123_1_123_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_10&#39;)"><span class="mpre">hashFunc&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 14, srcSpanEndLine = 122, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 23, srcSpanEndLine = 122, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">Hash c d =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">)
</span><a name="loc_123_1_123_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_10&#39;)"><span class="hl_fundecl"><span class="mpre">hashFunc&#39;</span></span></a><span class="mpre"> </span><a name="loc_123_11_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_11_123_12&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="#loc_125_3_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_3_125_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
  where
  </span><a name="loc_125_3_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_3_125_4&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_102_3_102_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_8&#39;)"><span class="hl_varref"><span class="mpre">hash&#39;</span></span></a><span class="mpre">
  </span><span class="hl_vardecl"><span class="mpre">a</span></span><span class="mpre"> = </span><a href="#loc_125_3_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_3_125_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`asTypeOf`</span></span><span class="mpre"> </span><a href="#loc_123_11_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_11_123_12&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-# INLINABLE makeBlocks #-}</span></span><span class="mpre">
</span><a href="#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="mpre">makeBlocks</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteLength</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_130_1_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_11&#39;)"><span class="hl_fundecl"><span class="mpre">makeBlocks</span></span></a><span class="mpre"> </span><a name="loc_130_12_130_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_12_130_15&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a name="loc_130_16_130_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_16_130_19&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="#loc_132_3_132_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_3_132_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_130_12_130_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_12_130_15&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">)
  where
  </span><a name="loc_132_3_132_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_3_132_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] = ([],</span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">)
  </span><a href="#loc_132_3_132_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_3_132_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_133_7_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_7_133_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_133_9_133_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_11&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_133_7_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_7_133_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_130_16_130_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_16_130_19&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> =
        let </span><a name="loc_135_13_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_13_135_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_133_7_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_7_133_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_133_7_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_7_133_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`rem`</span></span><span class="mpre"> </span><a href="#loc_130_16_130_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_16_130_19&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
            (</span><a name="loc_136_14_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_14_136_17&#39;)"><span class="hl_vardecl"><span class="mpre">top</span></span></a><span class="mpre">,</span><a name="loc_136_18_136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_21&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_135_13_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_13_135_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_133_7_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_7_133_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            (</span><a name="loc_137_14_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_14_137_18&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">,</span><a name="loc_137_19_137_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_19_137_26&#39;)"><span class="hl_vardecl"><span class="mpre">trueEnd</span></span></a><span class="mpre">) = </span><a href="#loc_132_3_132_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_3_132_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_136_18_136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_21&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_133_9_133_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_11&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        in (</span><a href="#loc_136_14_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_14_136_17&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_137_14_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_14_137_18&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">, </span><a href="#loc_137_19_137_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_19_137_26&#39;)"><span class="hl_varref"><span class="mpre">trueEnd</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
        case </span><a href="#loc_133_9_133_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_11&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                [] -&gt; ([], </span><a href="#loc_133_7_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_7_133_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                (</span><a name="loc_142_18_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_18_142_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_142_20_142_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_22&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_132_3_132_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_3_132_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.append</span></span><span class="mpre"> </span><a href="#loc_133_7_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_7_133_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_142_18_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_18_142_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_142_20_142_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_22&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |The BlockCipher class is intended as the generic interface</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- targeted by maintainers of Haskell cipher implementations.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Minimum complete definition: blockSize, encryptBlock, decryptBlock,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- buildKey, and keyLength.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Instances must handle unaligned data</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 7, srcSpanEndLine = 151, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 7, srcSpanEndLine = 151, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 15"><span class="mpre">( Serialize k) =&gt;</span></span><span class="mpre"> </span><a name="loc_151_25_151_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_25_151_36&#39;)"><span class="hl_classdecl"><span class="mpre">BlockCipher</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> where
  </span><a name="loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="mpre">blockSize</span></a><span class="mpre">     :: </span><a href="Data.Tagged.html#loc_59_9_59_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_59_9_59_15&#39;)"><span class="hl_tyconref"><span class="mpre">Tagged</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^ The size of a single block; the smallest unit on which the cipher operates.</span></span><span class="mpre">
  </span><a name="loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="mpre">encryptBlock</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ encrypt data of size @n*blockSize@ where @n `elem` [0..]@  (ecb encryption)</span></span><span class="mpre">
  </span><a name="loc_154_3_154_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_15&#39;)"><span class="mpre">decryptBlock</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ decrypt data of size @n*blockSize@ where @n `elem` [0..]@  (ecb decryption)</span></span><span class="mpre">
  </span><a name="loc_155_3_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_3_155_11&#39;)"><span class="mpre">buildKey</span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- ^ smart constructor for keys from a bytestring.</span></span><span class="mpre">
  </span><a name="loc_156_3_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_3_156_12&#39;)"><span class="mpre">keyLength</span></a><span class="mpre">     :: </span><a href="Data.Tagged.html#loc_59_9_59_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_59_9_59_15&#39;)"><span class="hl_tyconref"><span class="mpre">Tagged</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^ length of the cryptographic key</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- * Modes of operation over strict bytestrings</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | Electronic Cookbook (encryption)</span></span><span class="mpre">
  </span><a name="loc_160_3_160_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_3_160_6&#39;)"><span class="mpre">ecb</span></a><span class="mpre">           :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
  </span><a href="#loc_160_3_160_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_3_160_6&#39;)"><span class="hl_vardecl"><span class="mpre">ecb</span></span></a><span class="mpre"> = </span><a href="#loc_558_1_558_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_1_558_9&#39;)"><span class="hl_varref"><span class="mpre">modeEcb&#39;</span></span></a><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | Electronic Cookbook (decryption)</span></span><span class="mpre">
  </span><a name="loc_163_3_163_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_3_163_8&#39;)"><span class="mpre">unEcb</span></a><span class="mpre">         :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
  </span><a href="#loc_163_3_163_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_3_163_8&#39;)"><span class="hl_vardecl"><span class="mpre">unEcb</span></span></a><span class="mpre"> = </span><a href="#loc_565_1_565_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_1_565_11&#39;)"><span class="hl_varref"><span class="mpre">modeUnEcb&#39;</span></span></a><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | Cipherblock Chaining (encryption)</span></span><span class="mpre">
  </span><a name="loc_166_3_166_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_3_166_6&#39;)"><span class="mpre">cbc</span></a><span class="mpre">           :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_166_3_166_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_3_166_6&#39;)"><span class="hl_vardecl"><span class="mpre">cbc</span></span></a><span class="mpre"> = </span><a href="#loc_572_1_572_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_1_572_9&#39;)"><span class="hl_varref"><span class="mpre">modeCbc&#39;</span></span></a><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | Cipherblock Chaining (decryption)</span></span><span class="mpre">
  </span><a name="loc_169_3_169_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_3_169_8&#39;)"><span class="mpre">unCbc</span></a><span class="mpre">         :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_169_3_169_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_3_169_8&#39;)"><span class="hl_vardecl"><span class="mpre">unCbc</span></span></a><span class="mpre"> = </span><a href="#loc_586_1_586_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_1_586_11&#39;)"><span class="hl_varref"><span class="mpre">modeUnCbc&#39;</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- | Counter (encryption)</span></span><span class="mpre">
  </span><a name="loc_173_3_173_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_3_173_6&#39;)"><span class="mpre">ctr</span></a><span class="mpre">           :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_173_3_173_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_3_173_6&#39;)"><span class="hl_vardecl"><span class="mpre">ctr</span></span></a><span class="mpre"> = </span><a href="#loc_615_1_615_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_1_615_9&#39;)"><span class="hl_varref"><span class="mpre">modeCtr&#39;</span></span></a><span class="mpre"> </span><a href="#loc_668_1_668_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_6&#39;)"><span class="hl_varref"><span class="mpre">incIV</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- | Counter (decryption)</span></span><span class="mpre">
  </span><a name="loc_177_3_177_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_3_177_8&#39;)"><span class="mpre">unCtr</span></a><span class="mpre">         :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_177_3_177_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_3_177_8&#39;)"><span class="hl_vardecl"><span class="mpre">unCtr</span></span></a><span class="mpre"> = </span><a href="#loc_620_1_620_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_1_620_11&#39;)"><span class="hl_varref"><span class="mpre">modeUnCtr&#39;</span></span></a><span class="mpre"> </span><a href="#loc_668_1_668_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_6&#39;)"><span class="hl_varref"><span class="mpre">incIV</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- | Counter (encryption)</span></span><span class="mpre">
  </span><a name="loc_181_3_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_3_181_10&#39;)"><span class="mpre">ctrLazy</span></a><span class="mpre">           :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_181_3_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_3_181_10&#39;)"><span class="hl_vardecl"><span class="mpre">ctrLazy</span></span></a><span class="mpre"> = </span><a href="#loc_442_1_442_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_1_442_8&#39;)"><span class="hl_varref"><span class="mpre">modeCtr</span></span></a><span class="mpre"> </span><a href="#loc_668_1_668_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_6&#39;)"><span class="hl_varref"><span class="mpre">incIV</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- | Counter (decryption)</span></span><span class="mpre">
  </span><a name="loc_185_3_185_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_3_185_12&#39;)"><span class="mpre">unCtrLazy</span></a><span class="mpre">         :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_185_3_185_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_3_185_12&#39;)"><span class="hl_vardecl"><span class="mpre">unCtrLazy</span></span></a><span class="mpre"> = </span><a href="#loc_446_1_446_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_10&#39;)"><span class="hl_varref"><span class="mpre">modeUnCtr</span></span></a><span class="mpre"> </span><a href="#loc_668_1_668_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_6&#39;)"><span class="hl_varref"><span class="mpre">incIV</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- | Ciphertext feedback (encryption)</span></span><span class="mpre">
  </span><a name="loc_189_3_189_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_3_189_6&#39;)"><span class="mpre">cfb</span></a><span class="mpre">           :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_189_3_189_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_3_189_6&#39;)"><span class="hl_vardecl"><span class="mpre">cfb</span></span></a><span class="mpre"> = </span><a href="#loc_631_1_631_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_1_631_9&#39;)"><span class="hl_varref"><span class="mpre">modeCfb&#39;</span></span></a><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | Ciphertext feedback (decryption)</span></span><span class="mpre">
  </span><a name="loc_192_3_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_8&#39;)"><span class="mpre">unCfb</span></a><span class="mpre">         :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_192_3_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_8&#39;)"><span class="hl_vardecl"><span class="mpre">unCfb</span></span></a><span class="mpre"> = </span><a href="#loc_645_1_645_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_1_645_11&#39;)"><span class="hl_varref"><span class="mpre">modeUnCfb&#39;</span></span></a><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | Output feedback (encryption)</span></span><span class="mpre">
  </span><a name="loc_195_3_195_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_3_195_6&#39;)"><span class="mpre">ofb</span></a><span class="mpre">           :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_195_3_195_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_3_195_6&#39;)"><span class="hl_vardecl"><span class="mpre">ofb</span></span></a><span class="mpre"> = </span><a href="#loc_600_1_600_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_1_600_9&#39;)"><span class="hl_varref"><span class="mpre">modeOfb&#39;</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- | Output feedback (decryption)</span></span><span class="mpre">
  </span><a name="loc_199_3_199_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_3_199_8&#39;)"><span class="mpre">unOfb</span></a><span class="mpre">         :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_199_3_199_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_3_199_8&#39;)"><span class="hl_vardecl"><span class="mpre">unOfb</span></span></a><span class="mpre"> = </span><a href="#loc_605_1_605_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_11&#39;)"><span class="hl_varref"><span class="mpre">modeUnOfb&#39;</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |Cipher block chaining encryption for lazy bytestrings</span></span><span class="mpre">
  </span><a name="loc_203_3_203_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_3_203_10&#39;)"><span class="mpre">cbcLazy</span></a><span class="mpre">       :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_203_3_203_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_3_203_10&#39;)"><span class="hl_vardecl"><span class="mpre">cbcLazy</span></span></a><span class="mpre"> = </span><a href="#loc_415_1_415_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_1_415_8&#39;)"><span class="hl_varref"><span class="mpre">modeCbc</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |Cipher block chaining decryption for lazy bytestrings</span></span><span class="mpre">
  </span><a name="loc_207_3_207_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_3_207_12&#39;)"><span class="mpre">unCbcLazy</span></a><span class="mpre">     :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_207_3_207_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_3_207_12&#39;)"><span class="hl_vardecl"><span class="mpre">unCbcLazy</span></span></a><span class="mpre"> = </span><a href="#loc_428_1_428_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_10&#39;)"><span class="hl_varref"><span class="mpre">modeUnCbc</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |SIV (Synthetic IV) mode for lazy bytestrings. The third argument is</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- the optional list of bytestrings to be authenticated but not</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- encrypted As required by the specification this algorithm may</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- return nothing when certain constraints aren&#39;t met.</span></span><span class="mpre">
  </span><a name="loc_214_3_214_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_3_214_10&#39;)"><span class="mpre">sivLazy</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
  </span><a href="#loc_214_3_214_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_3_214_10&#39;)"><span class="hl_vardecl"><span class="mpre">sivLazy</span></span></a><span class="mpre"> = </span><a href="#loc_358_1_358_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_1_358_8&#39;)"><span class="hl_varref"><span class="mpre">modeSiv</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |SIV (Synthetic IV) for lazy bytestrings.  The third argument is the</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- optional list of bytestrings to be authenticated but not encrypted.</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- As required by the specification this algorithm may return nothing</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- when authentication fails.</span></span><span class="mpre">
  </span><a name="loc_221_3_221_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_3_221_12&#39;)"><span class="mpre">unSivLazy</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
  </span><a href="#loc_221_3_221_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_3_221_12&#39;)"><span class="hl_vardecl"><span class="mpre">unSivLazy</span></span></a><span class="mpre"> = </span><a href="#loc_376_1_376_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_10&#39;)"><span class="hl_varref"><span class="mpre">modeUnSiv</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |SIV (Synthetic IV) mode for strict bytestrings.  First argument is</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- the optional list of bytestrings to be authenticated but not</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- encrypted.  As required by the specification this algorithm may</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- return nothing when certain constraints aren&#39;t met.</span></span><span class="mpre">
  </span><a name="loc_228_3_228_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_3_228_6&#39;)"><span class="mpre">siv</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
  </span><a href="#loc_228_3_228_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_3_228_6&#39;)"><span class="hl_vardecl"><span class="mpre">siv</span></span></a><span class="mpre"> = </span><a href="#loc_391_1_391_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_9&#39;)"><span class="hl_varref"><span class="mpre">modeSiv&#39;</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |SIV (Synthetic IV) for strict bytestrings First argument is the</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- optional list of bytestrings to be authenticated but not encrypted</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- As required by the specification this algorithm may return nothing</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- when authentication fails.</span></span><span class="mpre">
  </span><a name="loc_235_3_235_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_3_235_8&#39;)"><span class="mpre">unSiv</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
  </span><a href="#loc_235_3_235_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_3_235_8&#39;)"><span class="hl_vardecl"><span class="mpre">unSiv</span></span></a><span class="mpre"> = </span><a href="#loc_403_1_403_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_11&#39;)"><span class="hl_varref"><span class="mpre">modeUnSiv&#39;</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |Cook book mode - not really a mode at all.  If you don&#39;t know what you&#39;re doing, don&#39;t use this mode^H^H^H^H library.</span></span><span class="mpre">
  </span><a name="loc_239_3_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_3_239_10&#39;)"><span class="mpre">ecbLazy</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
  </span><a href="#loc_239_3_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_3_239_10&#39;)"><span class="hl_vardecl"><span class="mpre">ecbLazy</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_8&#39;)"><span class="hl_varref"><span class="mpre">modeEcb</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |ECB decrypt, complementary to `ecb`.</span></span><span class="mpre">
  </span><a name="loc_243_3_243_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_3_243_12&#39;)"><span class="mpre">unEcbLazy</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
  </span><a href="#loc_243_3_243_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_3_243_12&#39;)"><span class="hl_vardecl"><span class="mpre">unEcbLazy</span></span></a><span class="mpre"> = </span><a href="#loc_348_1_348_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_10&#39;)"><span class="hl_varref"><span class="mpre">modeUnEcb</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |Ciphertext feed-back encryption mode for lazy bytestrings (with s</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- == blockSize)</span></span><span class="mpre">
  </span><a name="loc_248_3_248_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_3_248_10&#39;)"><span class="mpre">cfbLazy</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_248_3_248_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_3_248_10&#39;)"><span class="hl_vardecl"><span class="mpre">cfbLazy</span></span></a><span class="mpre"> = </span><a href="#loc_282_1_282_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_8&#39;)"><span class="hl_varref"><span class="mpre">modeCfb</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |Ciphertext feed-back decryption mode for lazy bytestrings (with s</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- == blockSize)</span></span><span class="mpre">
  </span><a name="loc_253_3_253_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_3_253_12&#39;)"><span class="mpre">unCfbLazy</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_253_3_253_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_3_253_12&#39;)"><span class="hl_vardecl"><span class="mpre">unCfbLazy</span></span></a><span class="mpre"> = </span><a href="#loc_297_1_297_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_10&#39;)"><span class="hl_varref"><span class="mpre">modeUnCfb</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |Output feedback mode for lazy bytestrings</span></span><span class="mpre">
  </span><a name="loc_257_3_257_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_3_257_10&#39;)"><span class="mpre">ofbLazy</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_257_3_257_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_3_257_10&#39;)"><span class="hl_vardecl"><span class="mpre">ofbLazy</span></span></a><span class="mpre"> = </span><a href="#loc_266_1_266_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_1_266_8&#39;)"><span class="hl_varref"><span class="mpre">modeOfb</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- |Output feedback mode for lazy bytestrings</span></span><span class="mpre">
  </span><a name="loc_261_3_261_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_3_261_12&#39;)"><span class="mpre">unOfbLazy</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
  </span><a href="#loc_261_3_261_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_3_261_12&#39;)"><span class="hl_vardecl"><span class="mpre">unOfbLazy</span></span></a><span class="mpre"> = </span><a href="#loc_271_1_271_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_10&#39;)"><span class="hl_varref"><span class="mpre">modeUnOfb</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Output feedback mode for lazy bytestrings</span></span><span class="mpre">
</span><a href="#loc_266_1_266_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_1_266_8&#39;)"><span class="mpre">modeOfb</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 265, srcSpanStartColumn = 12, srcSpanEndLine = 265, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 265, srcSpanStartColumn = 26, srcSpanEndLine = 265, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_266_1_266_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_1_266_8&#39;)"><span class="hl_vardecl"><span class="mpre">modeOfb</span></span></a><span class="mpre"> = </span><a href="#loc_271_1_271_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_10&#39;)"><span class="hl_varref"><span class="mpre">modeUnOfb</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeOfb #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Output feedback mode for lazy bytestrings</span></span><span class="mpre">
</span><a href="#loc_271_1_271_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_10&#39;)"><span class="mpre">modeUnOfb</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 270, srcSpanStartColumn = 14, srcSpanEndLine = 270, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 270, srcSpanStartColumn = 28, srcSpanEndLine = 270, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_271_1_271_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_1_271_10&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnOfb</span></span></a><span class="mpre"> </span><a name="loc_271_11_271_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_11_271_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_271_17_271_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_17_271_19&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a name="loc_271_21_271_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_21_271_24&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
        let </span><a name="loc_272_13_272_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_13_272_18&#39;)"><span class="hl_vardecl"><span class="mpre">ivStr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">iterate</span></span><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_271_11_271_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_11_271_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_271_17_271_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_17_271_19&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
            </span><a name="loc_273_13_273_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_13_273_18&#39;)"><span class="hl_vardecl"><span class="mpre">ivLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_271_17_271_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_17_271_19&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
            </span><a name="loc_274_13_274_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_13_274_18&#39;)"><span class="hl_vardecl"><span class="mpre">newIV</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.take</span></span><span class="mpre"> </span><a href="#loc_273_13_273_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_13_273_18&#39;)"><span class="hl_varref"><span class="mpre">ivLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_271_21_271_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_21_271_24&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_272_13_272_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_13_272_18&#39;)"><span class="hl_varref"><span class="mpre">ivStr</span></span></a><span class="mpre">
        in (</span><a href="Crypto.Util.html#loc_97_1_97_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_97_1_97_4&#39;)"><span class="hl_varref"><span class="mpre">zwp</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_272_13_272_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_13_272_18&#39;)"><span class="hl_varref"><span class="mpre">ivStr</span></span></a><span class="mpre">) </span><a href="#loc_271_21_271_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_21_271_24&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">, </span><a href="#loc_274_13_274_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_13_274_18&#39;)"><span class="hl_varref"><span class="mpre">newIV</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeUnOfb #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- |Ciphertext feed-back encryption mode for lazy bytestrings (with s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- == blockSize)</span></span><span class="mpre">
</span><a href="#loc_282_1_282_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_8&#39;)"><span class="mpre">modeCfb</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 281, srcSpanStartColumn = 12, srcSpanEndLine = 281, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 281, srcSpanStartColumn = 26, srcSpanEndLine = 281, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_282_1_282_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_8&#39;)"><span class="hl_fundecl"><span class="mpre">modeCfb</span></span></a><span class="mpre"> </span><a name="loc_282_9_282_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_282_15_282_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_15_282_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_282_18_282_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_18_282_21&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
        let </span><a name="loc_283_13_283_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_13_283_17&#39;)"><span class="hl_vardecl"><span class="mpre">blks</span></span></a><span class="mpre"> = </span><a href="#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_1_686_9&#39;)"><span class="hl_varref"><span class="mpre">chunkFor</span></span></a><span class="mpre"> </span><a href="#loc_282_9_282_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_282_18_282_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_18_282_21&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
            (</span><a name="loc_284_14_284_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_14_284_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">,</span><a name="loc_284_17_284_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_17_284_20&#39;)"><span class="hl_vardecl"><span class="mpre">ivF</span></span></a><span class="mpre">) = </span><a href="#loc_287_3_287_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_282_15_282_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_15_282_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_283_13_283_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_13_283_17&#39;)"><span class="hl_varref"><span class="mpre">blks</span></span></a><span class="mpre">
        in (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_284_14_284_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_14_284_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_284_17_284_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_17_284_20&#39;)"><span class="hl_varref"><span class="mpre">ivF</span></span></a><span class="mpre">)
  where
  </span><a name="loc_287_3_287_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_287_6_287_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_6_287_8&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> [] = ([],</span><a href="#loc_287_6_287_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_6_287_8&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  </span><a href="#loc_287_3_287_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_288_6_288_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_6_288_8&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> (</span><a name="loc_288_10_288_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_10_288_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_288_12_288_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_12_288_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) =
        let </span><a name="loc_289_13_289_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_13_289_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_282_9_282_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_288_6_288_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_6_288_8&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a href="#loc_288_10_288_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_10_288_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            (</span><a name="loc_290_14_290_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_14_290_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">,</span><a name="loc_290_17_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_17_290_24&#39;)"><span class="hl_vardecl"><span class="mpre">ivFinal</span></span></a><span class="mpre">) = </span><a href="#loc_287_3_287_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_289_13_289_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_13_289_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_288_12_288_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_12_288_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        in (</span><a href="#loc_289_13_289_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_13_289_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_290_14_290_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_14_290_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a href="#loc_290_17_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_17_290_24&#39;)"><span class="hl_varref"><span class="mpre">ivFinal</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeCfb #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Ciphertext feed-back decryption mode for lazy bytestrings (with s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- == blockSize)</span></span><span class="mpre">
</span><a href="#loc_297_1_297_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_10&#39;)"><span class="mpre">modeUnCfb</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 296, srcSpanStartColumn = 14, srcSpanEndLine = 296, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 296, srcSpanStartColumn = 28, srcSpanEndLine = 296, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_297_1_297_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_10&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnCfb</span></span></a><span class="mpre"> </span><a name="loc_297_11_297_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_11_297_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_297_17_297_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_17_297_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_297_20_297_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_20_297_23&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = 
        let </span><a name="loc_298_13_298_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_13_298_17&#39;)"><span class="hl_vardecl"><span class="mpre">blks</span></span></a><span class="mpre"> = </span><a href="#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_1_686_9&#39;)"><span class="hl_varref"><span class="mpre">chunkFor</span></span></a><span class="mpre"> </span><a href="#loc_297_11_297_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_11_297_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_297_20_297_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_20_297_23&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
            (</span><a name="loc_299_14_299_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_14_299_16&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a name="loc_299_18_299_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_18_299_21&#39;)"><span class="hl_vardecl"><span class="mpre">ivF</span></span></a><span class="mpre">) = </span><a href="#loc_302_3_302_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_297_17_297_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_17_297_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_298_13_298_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_13_298_17&#39;)"><span class="hl_varref"><span class="mpre">blks</span></span></a><span class="mpre">
        in (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_299_14_299_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_14_299_16&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_299_18_299_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_18_299_21&#39;)"><span class="hl_varref"><span class="mpre">ivF</span></span></a><span class="mpre">)
  where
  </span><a name="loc_302_3_302_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_302_6_302_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_6_302_8&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> [] = ([], </span><a href="#loc_302_6_302_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_6_302_8&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  </span><a href="#loc_302_3_302_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_303_6_303_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_6_303_8&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> (</span><a name="loc_303_10_303_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_10_303_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_303_12_303_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_12_303_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) =
        let </span><a name="loc_304_13_304_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_13_304_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_297_11_297_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_11_297_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_303_6_303_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_6_303_8&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a href="#loc_303_10_303_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_10_303_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            (</span><a name="loc_305_14_305_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_14_305_16&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a name="loc_305_18_305_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_18_305_21&#39;)"><span class="hl_vardecl"><span class="mpre">ivF</span></span></a><span class="mpre">) = </span><a href="#loc_302_3_302_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_303_10_303_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_10_303_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_303_12_303_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_12_303_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        in (</span><a href="#loc_304_13_304_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_13_304_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_305_14_305_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_14_305_16&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a href="#loc_305_18_305_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_18_305_21&#39;)"><span class="hl_varref"><span class="mpre">ivF</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeUnCfb #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Obtain an `IV` using the provided CryptoRandomGenerator.</span></span><span class="mpre">
</span><a href="#loc_311_1_311_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_1_311_6&#39;)"><span class="mpre">getIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 310, srcSpanStartColumn = 10, srcSpanEndLine = 310, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 310, srcSpanStartColumn = 10, srcSpanEndLine = 310, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k, CryptoRandomGen g) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_311_1_311_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_1_311_6&#39;)"><span class="hl_fundecl"><span class="mpre">getIV</span></span></a><span class="mpre"> </span><a name="loc_311_7_311_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_7_311_8&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> =
        let </span><a name="loc_312_13_312_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_13_312_18&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> = </span><a href="#loc_713_1_713_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_1_713_17&#39;)"><span class="hl_varref"><span class="mpre">ivBlockSizeBytes</span></span></a><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
            </span><a name="loc_313_13_313_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_13_313_16&#39;)"><span class="hl_vardecl"><span class="mpre">gen</span></span></a><span class="mpre"> = </span><a href="Crypto.Random.html#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">genBytes</span></span></a><span class="mpre"> </span><a href="#loc_312_13_312_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_13_312_18&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre"> </span><a href="#loc_311_7_311_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_7_311_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
            </span><a name="loc_314_13_314_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_13_314_22&#39;)"><span class="hl_fundecl"><span class="mpre">fromRight</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_314_30_314_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_30_314_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_314_30_314_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_30_314_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            </span><a name="loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">  = </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_314_13_314_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_13_314_22&#39;)"><span class="hl_varref"><span class="mpre">fromRight</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_313_13_313_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_13_313_16&#39;)"><span class="hl_varref"><span class="mpre">gen</span></span></a><span class="mpre">)
        in case </span><a href="#loc_313_13_313_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_13_313_16&#39;)"><span class="hl_varref"><span class="mpre">gen</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_317_22_317_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_22_317_25&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_317_22_317_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_22_317_25&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_318_24_318_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_24_318_26&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">,</span><a name="loc_318_27_318_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_27_318_29&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">)
                        | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_318_24_318_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_24_318_26&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_312_13_312_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_13_312_18&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">, </span><a href="#loc_318_27_318_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_27_318_29&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">)
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">             -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><a href="Crypto.Random.html#loc_63_11_63_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_63_11_63_24&#39;)"><span class="hl_conref"><span class="mpre">GenErrorOther</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Generator failed to provide requested number of bytes&quot;</span></span><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE getIV #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Obtain an &#39;IV&#39; using the system entropy (see &#39;System.Crypto.Random&#39;)</span></span><span class="mpre">
</span><a href="#loc_325_1_325_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_1_325_8&#39;)"><span class="mpre">getIVIO</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 324, srcSpanStartColumn = 12, srcSpanEndLine = 324, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 324, srcSpanStartColumn = 12, srcSpanEndLine = 324, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_325_1_325_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_1_325_8&#39;)"><span class="hl_vardecl"><span class="mpre">getIVIO</span></span></a><span class="mpre"> = do
        let </span><a name="loc_326_13_326_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_13_326_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Data.Proxy.html#loc_47_16_47_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_16_47_21&#39;)"><span class="hl_conref"><span class="mpre">Proxy</span></span></a><span class="mpre">
            </span><a href="#loc_328_13_328_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_23&#39;)"><span class="mpre">getTypedIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 327, srcSpanStartColumn = 27, srcSpanEndLine = 327, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 327, srcSpanStartColumn = 41, srcSpanEndLine = 327, srcSpanEndColumn = 43}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><a href="Data.Proxy.html#loc_47_6_47_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_6_47_11&#39;)"><span class="hl_tyconref"><span class="mpre">Proxy</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
            </span><a name="loc_328_13_328_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_23&#39;)"><span class="hl_fundecl"><span class="mpre">getTypedIV</span></span></a><span class="mpre"> </span><a name="loc_328_24_328_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_24_328_26&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">getEntropy</span></span><span class="mpre"> (</span><a href="Data.Tagged.html#loc_276_1_276_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_276_1_276_6&#39;)"><span class="hl_varref"><span class="mpre">proxy</span></span></a><span class="mpre"> </span><a href="#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_328_24_328_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_24_328_26&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">))
        </span><a name="loc_329_9_329_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_9_329_11&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_328_13_328_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_23&#39;)"><span class="hl_varref"><span class="mpre">getTypedIV</span></span></a><span class="mpre"> </span><a href="#loc_326_13_326_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_13_326_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_329_9_329_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_9_329_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="Data.Proxy.html#loc_184_1_184_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_184_1_184_14&#39;)"><span class="hl_infix"><span class="mpre">`asProxyTypeOf`</span></span></a><span class="mpre"> </span><a href="#loc_334_1_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_8&#39;)"><span class="hl_varref"><span class="mpre">ivProxy</span></span></a><span class="mpre"> </span><a href="#loc_326_13_326_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_13_326_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE getIVIO #-}</span></span><span class="mpre">

</span><a href="#loc_334_1_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_8&#39;)"><span class="mpre">ivProxy</span></a><span class="mpre"> :: </span><a href="Data.Proxy.html#loc_47_6_47_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_6_47_11&#39;)"><span class="hl_tyconref"><span class="mpre">Proxy</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Data.Proxy.html#loc_47_6_47_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_6_47_11&#39;)"><span class="hl_tyconref"><span class="mpre">Proxy</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_334_1_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_8&#39;)"><span class="hl_vardecl"><span class="mpre">ivProxy</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="Data.Proxy.html#loc_47_16_47_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_16_47_21&#39;)"><span class="hl_conref"><span class="mpre">Proxy</span></span></a><span class="mpre">

</span><a href="#loc_337_1_337_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_1_337_10&#39;)"><span class="mpre">deIVProxy</span></a><span class="mpre"> :: </span><a href="Data.Proxy.html#loc_47_6_47_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_6_47_11&#39;)"><span class="hl_tyconref"><span class="mpre">Proxy</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) -&gt; </span><a href="Data.Proxy.html#loc_47_6_47_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_6_47_11&#39;)"><span class="hl_tyconref"><span class="mpre">Proxy</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_337_1_337_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_1_337_10&#39;)"><span class="hl_vardecl"><span class="mpre">deIVProxy</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="Data.Proxy.html#loc_47_16_47_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_16_47_21&#39;)"><span class="hl_conref"><span class="mpre">Proxy</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Cook book mode - not really a mode at all.  If you don&#39;t know what you&#39;re doing, don&#39;t use this mode^H^H^H^H library.</span></span><span class="mpre">
</span><a href="#loc_341_1_341_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_8&#39;)"><span class="mpre">modeEcb</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 340, srcSpanStartColumn = 12, srcSpanEndLine = 340, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 340, srcSpanStartColumn = 26, srcSpanEndLine = 340, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_341_1_341_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_8&#39;)"><span class="hl_fundecl"><span class="mpre">modeEcb</span></span></a><span class="mpre"> </span><a name="loc_341_9_341_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_9_341_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_341_11_341_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_11_341_14&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
        let </span><a name="loc_342_13_342_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_13_342_19&#39;)"><span class="hl_vardecl"><span class="mpre">chunks</span></span></a><span class="mpre"> = </span><a href="#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_1_686_9&#39;)"><span class="hl_varref"><span class="mpre">chunkFor</span></span></a><span class="mpre"> </span><a href="#loc_341_9_341_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_9_341_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_341_11_341_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_11_341_14&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
        in </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_341_9_341_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_9_341_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_342_13_342_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_13_342_19&#39;)"><span class="hl_varref"><span class="mpre">chunks</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeEcb #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |ECB decrypt, complementary to `ecb`.</span></span><span class="mpre">
</span><a href="#loc_348_1_348_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_10&#39;)"><span class="mpre">modeUnEcb</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 347, srcSpanStartColumn = 14, srcSpanEndLine = 347, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 347, srcSpanStartColumn = 28, srcSpanEndLine = 347, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_348_1_348_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_10&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnEcb</span></span></a><span class="mpre"> </span><a name="loc_348_11_348_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_11_348_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_348_13_348_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_13_348_16&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
        let </span><a name="loc_349_13_349_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_13_349_19&#39;)"><span class="hl_vardecl"><span class="mpre">chunks</span></span></a><span class="mpre"> = </span><a href="#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_1_686_9&#39;)"><span class="hl_varref"><span class="mpre">chunkFor</span></span></a><span class="mpre"> </span><a href="#loc_348_11_348_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_11_348_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_348_13_348_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_13_348_16&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
        in </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_154_3_154_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_15&#39;)"><span class="hl_varref"><span class="mpre">decryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_348_11_348_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_11_348_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_349_13_349_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_13_349_19&#39;)"><span class="hl_varref"><span class="mpre">chunks</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeUnEcb #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |SIV (Synthetic IV) mode for lazy bytestrings. The third argument is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the optional list of bytestrings to be authenticated but not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- encrypted As required by the specification this algorithm may</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- return nothing when certain constraints aren&#39;t met.</span></span><span class="mpre">
</span><a href="#loc_358_1_358_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_1_358_8&#39;)"><span class="mpre">modeSiv</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 357, srcSpanStartColumn = 12, srcSpanEndLine = 357, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 357, srcSpanStartColumn = 26, srcSpanEndLine = 357, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_358_1_358_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_1_358_8&#39;)"><span class="hl_fundecl"><span class="mpre">modeSiv</span></span></a><span class="mpre"> </span><a name="loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a name="loc_358_12_358_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_12_358_14&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a name="loc_358_15_358_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_15_358_17&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_358_18_358_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_18_358_19&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_358_15_358_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_15_358_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_367_8_367_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_8_367_14&#39;)"><span class="hl_varref"><span class="mpre">bSizeb</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.append</span></span><span class="mpre"> </span><a href="#loc_368_8_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_8_368_10&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_181_3_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_3_181_10&#39;)"><span class="hl_varref"><span class="mpre">ctrLazy</span></span></a><span class="mpre"> </span><a href="#loc_358_12_358_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_12_358_14&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_705_1_705_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_8&#39;)"><span class="hl_varref"><span class="mpre">sivMask</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_368_8_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_8_368_10&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
                </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_358_18_358_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_18_358_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
  where
       </span><span class="hl_vardecl"><span class="mpre">bSize</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">
       </span><a name="loc_367_8_367_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_8_367_14&#39;)"><span class="hl_vardecl"><span class="mpre">bSizeb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">
       </span><a name="loc_368_8_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_8_368_10&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">cMacStar</span></span><span class="mpre"> </span><a href="#loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_358_15_358_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_15_358_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_358_18_358_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_18_358_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">-- |SIV (Synthetic IV) for lazy bytestrings.  The third argument is the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- optional list of bytestrings to be authenticated but not encrypted.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- As required by the specification this algorithm may return nothing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- when authentication fails.</span></span><span class="mpre">
</span><a href="#loc_376_1_376_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_10&#39;)"><span class="mpre">modeUnSiv</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 375, srcSpanStartColumn = 14, srcSpanEndLine = 375, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 375, srcSpanStartColumn = 28, srcSpanEndLine = 375, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_376_1_376_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_10&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnSiv</span></span></a><span class="mpre"> </span><a name="loc_376_11_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_11_376_13&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a name="loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a name="loc_376_17_376_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_17_376_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_376_20_376_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_20_376_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_376_17_376_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_17_376_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_382_8_382_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_8_382_14&#39;)"><span class="hl_varref"><span class="mpre">bSizeb</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                 | </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_376_20_376_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_20_376_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_381_8_381_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_8_381_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                 | </span><a href="#loc_383_9_383_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_9_383_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cMacStar</span></span><span class="mpre"> </span><a href="#loc_376_11_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_11_376_13&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_376_17_376_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_17_376_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_384_8_384_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_8_384_10&#39;)"><span class="hl_varref"><span class="mpre">dm</span></span></a><span class="mpre">]) = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_384_8_384_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_8_384_10&#39;)"><span class="hl_varref"><span class="mpre">dm</span></span></a><span class="mpre">
  where
       </span><a name="loc_381_8_381_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_8_381_13&#39;)"><span class="hl_vardecl"><span class="mpre">bSize</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_376_11_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_11_376_13&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">
       </span><a name="loc_382_8_382_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_8_382_14&#39;)"><span class="hl_vardecl"><span class="mpre">bSizeb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_376_11_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_11_376_13&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">
       (</span><a name="loc_383_9_383_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_9_383_11&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">,</span><a name="loc_383_12_383_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_12_383_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_381_8_381_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_8_381_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre">) </span><a href="#loc_376_20_376_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_20_376_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
       </span><a name="loc_384_8_384_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_8_384_10&#39;)"><span class="hl_vardecl"><span class="mpre">dm</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_446_1_446_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_10&#39;)"><span class="hl_varref"><span class="mpre">modeUnCtr</span></span></a><span class="mpre"> </span><a href="#loc_668_1_668_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_6&#39;)"><span class="hl_varref"><span class="mpre">incIV</span></span></a><span class="mpre"> </span><a href="#loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_705_1_705_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_8&#39;)"><span class="hl_varref"><span class="mpre">sivMask</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_383_9_383_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_9_383_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a href="#loc_383_12_383_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_12_383_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |SIV (Synthetic IV) mode for strict bytestrings.  First argument is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the optional list of bytestrings to be authenticated but not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- encrypted.  As required by the specification this algorithm may</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- return nothing when certain constraints aren&#39;t met.</span></span><span class="mpre">
</span><a href="#loc_391_1_391_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_9&#39;)"><span class="mpre">modeSiv&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 390, srcSpanStartColumn = 13, srcSpanEndLine = 390, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 390, srcSpanStartColumn = 27, srcSpanEndLine = 390, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_391_1_391_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_9&#39;)"><span class="hl_fundecl"><span class="mpre">modeSiv&#39;</span></span></a><span class="mpre"> </span><a name="loc_391_10_391_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_10_391_12&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a name="loc_391_13_391_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_13_391_15&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a name="loc_391_16_391_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_16_391_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_391_19_391_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_19_391_20&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_391_16_391_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_16_391_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_395_8_395_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_8_395_14&#39;)"><span class="hl_varref"><span class="mpre">bSizeb</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.append</span></span><span class="mpre"> </span><a href="#loc_396_8_396_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_8_396_10&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Crypto.Classes.ctr</span></span><span class="mpre"> </span><a href="#loc_391_13_391_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_13_391_15&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_705_1_705_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_8&#39;)"><span class="hl_varref"><span class="mpre">sivMask</span></span></a><span class="mpre"> </span><a href="#loc_396_8_396_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_8_396_10&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a href="#loc_391_19_391_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_19_391_20&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
  where
       </span><span class="hl_vardecl"><span class="mpre">bSize</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_391_10_391_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_10_391_12&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">
       </span><a name="loc_395_8_395_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_8_395_14&#39;)"><span class="hl_vardecl"><span class="mpre">bSizeb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_391_10_391_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_10_391_12&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">
       </span><a name="loc_396_8_396_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_8_396_10&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">cMacStar&#39;</span></span><span class="mpre"> </span><a href="#loc_391_10_391_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_10_391_12&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_391_16_391_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_16_391_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_391_19_391_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_19_391_20&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- |SIV (Synthetic IV) for strict bytestrings First argument is the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- optional list of bytestrings to be authenticated but not encrypted</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- As required by the specification this algorithm may return nothing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- when authentication fails.</span></span><span class="mpre">
</span><a href="#loc_403_1_403_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_11&#39;)"><span class="mpre">modeUnSiv&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 402, srcSpanStartColumn = 15, srcSpanEndLine = 402, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 402, srcSpanStartColumn = 29, srcSpanEndLine = 402, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_403_1_403_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_11&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnSiv&#39;</span></span></a><span class="mpre"> </span><a name="loc_403_12_403_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_12_403_14&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a name="loc_403_15_403_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_15_403_17&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a name="loc_403_18_403_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_18_403_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_403_21_403_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_21_403_22&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_403_18_403_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_18_403_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_409_8_409_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_8_409_14&#39;)"><span class="hl_varref"><span class="mpre">bSizeb</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_403_21_403_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_21_403_22&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_408_8_408_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_8_408_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                  | </span><a href="#loc_410_9_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_9_410_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cMacStar&#39;</span></span><span class="mpre"> </span><a href="#loc_403_12_403_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_12_403_14&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_403_18_403_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_18_403_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_411_8_411_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_8_411_10&#39;)"><span class="hl_varref"><span class="mpre">dm</span></span></a><span class="mpre">]) = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_411_8_411_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_8_411_10&#39;)"><span class="hl_varref"><span class="mpre">dm</span></span></a><span class="mpre">
  where
       </span><a name="loc_408_8_408_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_8_408_13&#39;)"><span class="hl_vardecl"><span class="mpre">bSize</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_403_12_403_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_12_403_14&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">
       </span><a name="loc_409_8_409_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_8_409_14&#39;)"><span class="hl_vardecl"><span class="mpre">bSizeb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_403_12_403_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_12_403_14&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">
       (</span><a name="loc_410_9_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_9_410_11&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">,</span><a name="loc_410_12_410_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_12_410_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_408_8_408_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_8_408_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre"> </span><a href="#loc_403_21_403_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_21_403_22&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
       </span><a name="loc_411_8_411_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_8_411_10&#39;)"><span class="hl_vardecl"><span class="mpre">dm</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Crypto.Classes.unCtr</span></span><span class="mpre"> </span><a href="#loc_403_15_403_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_15_403_17&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_705_1_705_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_8&#39;)"><span class="hl_varref"><span class="mpre">sivMask</span></span></a><span class="mpre"> </span><a href="#loc_410_9_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_9_410_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a href="#loc_410_12_410_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_12_410_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">


</span><a href="#loc_415_1_415_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_1_415_8&#39;)"><span class="mpre">modeCbc</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 414, srcSpanStartColumn = 12, srcSpanEndLine = 414, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 414, srcSpanStartColumn = 26, srcSpanEndLine = 414, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_415_1_415_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_1_415_8&#39;)"><span class="hl_fundecl"><span class="mpre">modeCbc</span></span></a><span class="mpre"> </span><a name="loc_415_9_415_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_9_415_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_415_15_415_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_15_415_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_415_18_415_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_18_415_27&#39;)"><span class="hl_vardecl"><span class="mpre">plaintext</span></span></a><span class="mpre"> =
        let </span><a name="loc_416_13_416_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_13_416_17&#39;)"><span class="hl_vardecl"><span class="mpre">blks</span></span></a><span class="mpre"> = </span><a href="#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_1_686_9&#39;)"><span class="hl_varref"><span class="mpre">chunkFor</span></span></a><span class="mpre"> </span><a href="#loc_415_9_415_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_9_415_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_415_18_415_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_18_415_27&#39;)"><span class="hl_varref"><span class="mpre">plaintext</span></span></a><span class="mpre">
            (</span><a name="loc_417_14_417_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_14_417_17&#39;)"><span class="hl_vardecl"><span class="mpre">cts</span></span></a><span class="mpre">, </span><a name="loc_417_19_417_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_19_417_21&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">) = </span><a href="#loc_420_3_420_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_3_420_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_416_13_416_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_13_416_17&#39;)"><span class="hl_varref"><span class="mpre">blks</span></span></a><span class="mpre"> </span><a href="#loc_415_15_415_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_15_415_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
        in (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_417_14_417_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_14_417_17&#39;)"><span class="hl_varref"><span class="mpre">cts</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_417_19_417_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_19_417_21&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  where
  </span><a name="loc_420_3_420_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_3_420_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><a name="loc_420_9_420_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_9_420_11&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> = ([], </span><a href="#loc_420_9_420_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_9_420_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  </span><a href="#loc_420_3_420_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_3_420_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_421_7_421_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_7_421_8&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_421_9_421_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_9_421_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a name="loc_421_13_421_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_13_421_15&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> =
        let </span><a name="loc_422_13_422_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_13_422_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_415_9_415_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_9_415_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_421_13_421_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_13_421_15&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_421_7_421_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_7_421_8&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
            (</span><a name="loc_423_14_423_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_14_423_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a name="loc_423_18_423_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_18_423_25&#39;)"><span class="hl_vardecl"><span class="mpre">ivFinal</span></span></a><span class="mpre">) = </span><a href="#loc_420_3_420_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_3_420_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_421_9_421_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_9_421_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_422_13_422_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_13_422_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
        in (</span><a href="#loc_422_13_422_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_13_422_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_423_14_423_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_14_423_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a href="#loc_423_18_423_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_18_423_25&#39;)"><span class="hl_varref"><span class="mpre">ivFinal</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeCbc #-}</span></span><span class="mpre">

</span><a href="#loc_428_1_428_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_10&#39;)"><span class="mpre">modeUnCbc</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 427, srcSpanStartColumn = 14, srcSpanEndLine = 427, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 427, srcSpanStartColumn = 28, srcSpanEndLine = 427, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_428_1_428_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_10&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnCbc</span></span></a><span class="mpre"> </span><a name="loc_428_11_428_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_11_428_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_428_17_428_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_17_428_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_428_20_428_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_20_428_30&#39;)"><span class="hl_vardecl"><span class="mpre">ciphertext</span></span></a><span class="mpre"> =
        let </span><a name="loc_429_13_429_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_13_429_17&#39;)"><span class="hl_vardecl"><span class="mpre">blks</span></span></a><span class="mpre"> = </span><a href="#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_1_686_9&#39;)"><span class="hl_varref"><span class="mpre">chunkFor</span></span></a><span class="mpre"> </span><a href="#loc_428_11_428_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_11_428_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_428_20_428_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_20_428_30&#39;)"><span class="hl_varref"><span class="mpre">ciphertext</span></span></a><span class="mpre">
            (</span><a name="loc_430_14_430_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_14_430_17&#39;)"><span class="hl_vardecl"><span class="mpre">pts</span></span></a><span class="mpre">, </span><a name="loc_430_19_430_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_19_430_21&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">) = </span><a href="#loc_433_3_433_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_3_433_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_429_13_429_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_13_429_17&#39;)"><span class="hl_varref"><span class="mpre">blks</span></span></a><span class="mpre"> </span><a href="#loc_428_17_428_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_17_428_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
        in (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_430_14_430_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_14_430_17&#39;)"><span class="hl_varref"><span class="mpre">pts</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_430_19_430_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_19_430_21&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  where
  </span><a name="loc_433_3_433_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_3_433_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><a name="loc_433_9_433_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_9_433_11&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> = ([], </span><a href="#loc_433_9_433_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_9_433_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  </span><a href="#loc_433_3_433_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_3_433_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_434_7_434_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_7_434_8&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_434_9_434_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_9_434_11&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) </span><a name="loc_434_13_434_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_13_434_15&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> =
        let </span><a name="loc_435_13_435_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_13_435_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_154_3_154_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_15&#39;)"><span class="hl_varref"><span class="mpre">decryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_428_11_428_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_11_428_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_434_7_434_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_7_434_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_434_13_434_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_13_434_15&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
            (</span><a name="loc_436_14_436_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_14_436_16&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a name="loc_436_18_436_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_18_436_25&#39;)"><span class="hl_vardecl"><span class="mpre">ivFinal</span></span></a><span class="mpre">) = </span><a href="#loc_433_3_433_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_3_433_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_434_9_434_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_9_434_11&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> </span><a href="#loc_434_7_434_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_7_434_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
        in (</span><a href="#loc_435_13_435_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_13_435_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_436_14_436_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_14_436_16&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a href="#loc_436_18_436_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_18_436_25&#39;)"><span class="hl_varref"><span class="mpre">ivFinal</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeUnCbc #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Counter mode for lazy bytestrings</span></span><span class="mpre">
</span><a href="#loc_442_1_442_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_1_442_8&#39;)"><span class="mpre">modeCtr</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 441, srcSpanStartColumn = 12, srcSpanEndLine = 441, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 441, srcSpanStartColumn = 26, srcSpanEndLine = 441, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_442_1_442_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_1_442_8&#39;)"><span class="hl_vardecl"><span class="mpre">modeCtr</span></span></a><span class="mpre"> = </span><a href="#loc_446_1_446_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_10&#39;)"><span class="hl_varref"><span class="mpre">modeUnCtr</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Counter  mode for lazy bytestrings</span></span><span class="mpre">
</span><a href="#loc_446_1_446_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_10&#39;)"><span class="mpre">modeUnCtr</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 445, srcSpanStartColumn = 14, srcSpanEndLine = 445, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 445, srcSpanStartColumn = 28, srcSpanEndLine = 445, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_446_1_446_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_10&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnCtr</span></span></a><span class="mpre"> </span><a name="loc_446_11_446_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_446_13_446_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_13_446_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_446_19_446_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_19_446_21&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a name="loc_446_23_446_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_23_446_26&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
       let </span><a name="loc_447_12_447_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_12_447_17&#39;)"><span class="hl_vardecl"><span class="mpre">ivStr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">iterate</span></span><span class="mpre"> </span><a href="#loc_446_11_446_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_446_19_446_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_19_446_21&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
           </span><a name="loc_448_12_448_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_12_448_17&#39;)"><span class="hl_vardecl"><span class="mpre">ivLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_446_19_446_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_19_446_21&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
           </span><a name="loc_449_12_449_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_12_449_17&#39;)"><span class="hl_vardecl"><span class="mpre">newIV</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_607_1_607_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_607_1_607_12&#39;)"><span class="hl_varref"><span class="mpre">genericDrop</span></span></a><span class="mpre"> ((</span><a href="#loc_448_12_448_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_12_448_17&#39;)"><span class="hl_varref"><span class="mpre">ivLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_446_23_446_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_23_446_26&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_448_12_448_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_12_448_17&#39;)"><span class="hl_varref"><span class="mpre">ivLen</span></span></a><span class="mpre">) </span><a href="#loc_447_12_447_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_12_447_17&#39;)"><span class="hl_varref"><span class="mpre">ivStr</span></span></a><span class="mpre">
       in (</span><a href="Crypto.Util.html#loc_97_1_97_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_97_1_97_4&#39;)"><span class="hl_varref"><span class="mpre">zwp</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_446_13_446_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_13_446_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_18_19_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_18_19_38&#39;)"><span class="hl_varref"><span class="mpre">initializationVector</span></span></a><span class="mpre"> </span><a href="#loc_447_12_447_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_12_447_17&#39;)"><span class="hl_varref"><span class="mpre">ivStr</span></span></a><span class="mpre">) </span><a href="#loc_446_23_446_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_23_446_26&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">, </span><a href="#loc_449_12_449_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_12_449_17&#39;)"><span class="hl_varref"><span class="mpre">newIV</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- |The number of bytes in a block cipher block</span></span><span class="mpre">
</span><a href="#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_15&#39;)"><span class="mpre">blockSizeBytes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 454, srcSpanStartColumn = 19, srcSpanEndLine = 454, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 454, srcSpanStartColumn = 19, srcSpanEndLine = 454, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k) =&gt;</span></span><span class="mpre"> </span><a href="Data.Tagged.html#loc_59_9_59_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_59_9_59_15&#39;)"><span class="hl_tyconref"><span class="mpre">Tagged</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteLength</span></span><span class="mpre">
</span><a name="loc_455_1_455_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_15&#39;)"><span class="hl_vardecl"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><a href="#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |The number of bytes in a block cipher key (assuming it is an even</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- multiple of 8 bits)</span></span><span class="mpre">
</span><a href="#loc_460_1_460_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_15&#39;)"><span class="mpre">keyLengthBytes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 459, srcSpanStartColumn = 19, srcSpanEndLine = 459, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 459, srcSpanStartColumn = 19, srcSpanEndLine = 459, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k) =&gt;</span></span><span class="mpre"> </span><a href="Data.Tagged.html#loc_59_9_59_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_59_9_59_15&#39;)"><span class="hl_tyconref"><span class="mpre">Tagged</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteLength</span></span><span class="mpre">
</span><a name="loc_460_1_460_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_15&#39;)"><span class="hl_vardecl"><span class="mpre">keyLengthBytes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><a href="#loc_156_3_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_3_156_12&#39;)"><span class="hl_varref"><span class="mpre">keyLength</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Build a symmetric key using the system entropy (see &#39;System.Crypto.Random&#39;)</span></span><span class="mpre">
</span><a href="#loc_464_1_464_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_11&#39;)"><span class="mpre">buildKeyIO</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 463, srcSpanStartColumn = 15, srcSpanEndLine = 463, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 463, srcSpanStartColumn = 15, srcSpanEndLine = 463, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_464_1_464_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_11&#39;)"><span class="hl_vardecl"><span class="mpre">buildKeyIO</span></span></a><span class="mpre"> = </span><a href="#loc_471_1_471_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_1_471_10&#39;)"><span class="hl_varref"><span class="mpre">buildKeyM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getEntropy</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Build a symmetric key using a given &#39;Crypto.Random.CryptoRandomGen&#39;</span></span><span class="mpre">
</span><a href="#loc_468_1_468_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_1_468_12&#39;)"><span class="mpre">buildKeyGen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 467, srcSpanStartColumn = 16, srcSpanEndLine = 467, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 467, srcSpanStartColumn = 16, srcSpanEndLine = 467, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k, CryptoRandomGen g) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_468_1_468_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_1_468_12&#39;)"><span class="hl_vardecl"><span class="mpre">buildKeyGen</span></span></a><span class="mpre"> = </span><a href="Control.Monad.Trans.State.Lazy.html#loc_136_33_136_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_136_33_136_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> (</span><a href="#loc_471_1_471_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_1_471_10&#39;)"><span class="hl_varref"><span class="mpre">buildKeyM</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">StateT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">genBytes</span></span></a><span class="mpre">) (</span><a href="Control.Monad.Trans.Class.html#loc_49_5_49_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_49_5_49_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_63_11_63_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_63_11_63_24&#39;)"><span class="hl_conref"><span class="mpre">GenErrorOther</span></span></a><span class="mpre">))

</span><a href="#loc_471_1_471_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_1_471_10&#39;)"><span class="mpre">buildKeyM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 470, srcSpanStartColumn = 14, srcSpanEndLine = 470, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 470, srcSpanStartColumn = 14, srcSpanEndLine = 470, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_471_1_471_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_1_471_10&#39;)"><span class="hl_fundecl"><span class="mpre">buildKeyM</span></span></a><span class="mpre"> </span><a name="loc_471_11_471_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_11_471_18&#39;)"><span class="hl_vardecl"><span class="mpre">getMore</span></span></a><span class="mpre"> </span><a name="loc_471_19_471_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_19_471_22&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> = </span><a href="#loc_473_3_473_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_3_473_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  where
  </span><a name="loc_473_3_473_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_3_473_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000</span></span><span class="mpre"> = </span><a href="#loc_471_19_471_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_19_471_22&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Tried 1000 times to generate a key from the system entropy.\
                \  No keys were returned! Perhaps the system entropy is broken\
                \ or perhaps the BlockCipher instance being used has a non-flat\
                \ keyspace.&quot;</span></span><span class="mpre">
  </span><a href="#loc_473_3_473_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_3_473_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_477_6_477_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_6_477_7&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = do
    let </span><a name="loc_478_9_478_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_9_478_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_156_3_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_3_156_12&#39;)"><span class="hl_varref"><span class="mpre">keyLength</span></span></a><span class="mpre">
    </span><a name="loc_479_5_479_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_5_479_7&#39;)"><span class="hl_vardecl"><span class="mpre">kd</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_471_11_471_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_11_471_18&#39;)"><span class="hl_varref"><span class="mpre">getMore</span></span></a><span class="mpre"> ((</span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Data.Tagged.html#loc_252_1_252_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_252_1_252_6&#39;)"><span class="hl_varref"><span class="mpre">untag</span></span></a><span class="mpre"> </span><a href="#loc_478_9_478_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_9_478_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)
    case </span><a href="#loc_155_3_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_3_155_11&#39;)"><span class="hl_varref"><span class="mpre">buildKey</span></span></a><span class="mpre"> </span><a href="#loc_479_5_479_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_5_479_7&#39;)"><span class="hl_varref"><span class="mpre">kd</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_473_3_473_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_3_473_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_477_6_477_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_6_477_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_482_14_482_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_14_482_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_482_14_482_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_14_482_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="Data.Tagged.html#loc_261_1_261_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_261_1_261_15&#39;)"><span class="hl_infix"><span class="mpre">`asTaggedTypeOf`</span></span></a><span class="mpre"> </span><a href="#loc_478_9_478_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_9_478_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Asymetric ciphers (common ones being RSA or EC based)</span></span><span class="mpre">
class </span><a name="loc_485_7_485_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_7_485_17&#39;)"><span class="hl_classdecl"><span class="mpre">AsymCipher</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> | </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 485, srcSpanStartColumn = 24, srcSpanEndLine = 485, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 485, srcSpanStartColumn = 26, srcSpanEndLine = 485, srcSpanEndColumn = 28}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/C"><span class="mpre">p -&gt; v</span></span><span class="mpre">, </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 485, srcSpanStartColumn = 32, srcSpanEndLine = 485, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 485, srcSpanStartColumn = 34, srcSpanEndLine = 485, srcSpanEndColumn = 36}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/C"><span class="mpre">v -&gt; p</span></span><span class="mpre"> where
  </span><a name="loc_486_3_486_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_486_3_486_15&#39;)"><span class="mpre">buildKeyPair</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 486, srcSpanStartColumn = 19, srcSpanEndLine = 486, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 486, srcSpanStartColumn = 37, srcSpanEndLine = 486, srcSpanEndColumn = 39}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">CryptoRandomGen g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> ((</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">),</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ build a public/private key pair using the provided generator</span></span><span class="mpre">
  </span><a name="loc_487_3_487_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_3_487_14&#39;)"><span class="mpre">encryptAsym</span></a><span class="mpre">      :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 487, srcSpanStartColumn = 23, srcSpanEndLine = 487, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 487, srcSpanStartColumn = 23, srcSpanEndLine = 487, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(CryptoRandomGen g) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ Asymetric encryption</span></span><span class="mpre">
  </span><a name="loc_488_3_488_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_3_488_14&#39;)"><span class="mpre">decryptAsym</span></a><span class="mpre">      :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 488, srcSpanStartColumn = 23, srcSpanEndLine = 488, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 488, srcSpanStartColumn = 23, srcSpanEndLine = 488, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(CryptoRandomGen g) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ Asymetric decryption</span></span><span class="mpre">
  </span><a name="loc_489_3_489_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_3_489_18&#39;)"><span class="mpre">publicKeyLength</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre">
  </span><a name="loc_490_3_490_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_3_490_19&#39;)"><span class="mpre">privateKeyLength</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Build a pair of asymmetric keys using the system random generator.</span></span><span class="mpre">
</span><a href="#loc_494_1_494_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_15&#39;)"><span class="mpre">buildKeyPairIO</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 493, srcSpanStartColumn = 19, srcSpanEndLine = 493, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 493, srcSpanStartColumn = 34, srcSpanEndLine = 493, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">AsymCipher p v =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">))
</span><a name="loc_494_1_494_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_15&#39;)"><span class="hl_fundecl"><span class="mpre">buildKeyPairIO</span></span></a><span class="mpre"> </span><a name="loc_494_16_494_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_16_494_18&#39;)"><span class="hl_vardecl"><span class="mpre">bl</span></span></a><span class="mpre"> = do
        </span><a name="loc_495_9_495_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_9_495_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> &lt;- </span><a href="Crypto.Random.html#loc_165_9_165_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_165_9_165_17&#39;)"><span class="hl_varref"><span class="mpre">newGenIO</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_204_6_204_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_204_6_204_18&#39;)"><span class="hl_tyconref"><span class="mpre">SystemRandom</span></span></a><span class="mpre">
        case </span><a href="#loc_486_3_486_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_486_3_486_15&#39;)"><span class="hl_varref"><span class="mpre">buildKeyPair</span></span></a><span class="mpre"> </span><a href="#loc_495_9_495_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_9_495_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_494_16_494_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_16_494_18&#39;)"><span class="hl_varref"><span class="mpre">bl</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_497_22_497_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_22_497_25&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_497_22_497_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_22_497_25&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)
                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_498_24_498_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_24_498_25&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">,_) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_498_24_498_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_24_498_25&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Flipped &#39;buildKeyPair&#39; for ease of use with state monads.</span></span><span class="mpre">
</span><a href="#loc_502_1_502_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_1_502_16&#39;)"><span class="mpre">buildKeyPairGen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 501, srcSpanStartColumn = 20, srcSpanEndLine = 501, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 501, srcSpanStartColumn = 20, srcSpanEndLine = 501, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(CryptoRandomGen g, AsymCipher p v) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> ((</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">),</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_502_1_502_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_1_502_16&#39;)"><span class="hl_vardecl"><span class="mpre">buildKeyPairGen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_486_3_486_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_486_3_486_15&#39;)"><span class="hl_varref"><span class="mpre">buildKeyPair</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A stream cipher class.  Instance are expected to work on messages as small as one byte</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The length of the resulting cipher text should be equal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the length of the input message.</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 507, srcSpanStartColumn = 7, srcSpanEndLine = 507, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 507, srcSpanStartColumn = 7, srcSpanEndLine = 507, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 50"><span class="mpre">(Serialize k) =&gt;</span></span><span class="mpre"> </span><a name="loc_507_24_507_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_507_24_507_36&#39;)"><span class="hl_classdecl"><span class="mpre">StreamCipher</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">iv</span></span><span class="mpre"> | </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 507, srcSpanStartColumn = 44, srcSpanEndLine = 507, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 507, srcSpanStartColumn = 46, srcSpanEndLine = 507, srcSpanEndColumn = 48}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/C"><span class="mpre">k -&gt; iv</span></span><span class="mpre"> where
  </span><a name="loc_508_3_508_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_3_508_17&#39;)"><span class="mpre">buildStreamKey</span></a><span class="mpre">        :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
  </span><a name="loc_509_3_509_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_3_509_16&#39;)"><span class="mpre">encryptStream</span></a><span class="mpre">         :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">iv</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">iv</span></span><span class="mpre">)
  </span><a name="loc_510_3_510_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_3_510_16&#39;)"><span class="mpre">decryptStream</span></a><span class="mpre">         :: </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">iv</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">iv</span></span><span class="mpre">)
  </span><a name="loc_511_3_511_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_3_511_18&#39;)"><span class="mpre">streamKeyLength</span></a><span class="mpre">       :: </span><a href="Data.Tagged.html#loc_59_9_59_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_59_9_59_15&#39;)"><span class="hl_tyconref"><span class="mpre">Tagged</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Build a stream key using the system random generator</span></span><span class="mpre">
</span><a href="#loc_515_1_515_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_1_515_17&#39;)"><span class="mpre">buildStreamKeyIO</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 514, srcSpanStartColumn = 21, srcSpanEndLine = 514, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 514, srcSpanStartColumn = 39, srcSpanEndLine = 514, srcSpanEndColumn = 41}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">StreamCipher k iv =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_515_1_515_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_1_515_17&#39;)"><span class="hl_vardecl"><span class="mpre">buildStreamKeyIO</span></span></a><span class="mpre"> = </span><a href="#loc_522_1_522_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_1_522_16&#39;)"><span class="hl_varref"><span class="mpre">buildStreamKeyM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getEntropy</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Build a stream key using the provided random generator</span></span><span class="mpre">
</span><a href="#loc_519_1_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_18&#39;)"><span class="mpre">buildStreamKeyGen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 518, srcSpanStartColumn = 22, srcSpanEndLine = 518, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 518, srcSpanStartColumn = 22, srcSpanEndLine = 518, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(StreamCipher k iv, CryptoRandomGen g) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_519_1_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_18&#39;)"><span class="hl_vardecl"><span class="mpre">buildStreamKeyGen</span></span></a><span class="mpre"> = </span><a href="Control.Monad.Trans.State.Lazy.html#loc_136_33_136_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_136_33_136_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> (</span><a href="#loc_522_1_522_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_1_522_16&#39;)"><span class="hl_varref"><span class="mpre">buildStreamKeyM</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">StateT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_117_9_117_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_117_9_117_17&#39;)"><span class="hl_varref"><span class="mpre">genBytes</span></span></a><span class="mpre">) (</span><a href="Control.Monad.Trans.Class.html#loc_49_5_49_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_49_5_49_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_63_11_63_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_63_11_63_24&#39;)"><span class="hl_conref"><span class="mpre">GenErrorOther</span></span></a><span class="mpre">))

</span><a href="#loc_522_1_522_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_1_522_16&#39;)"><span class="mpre">buildStreamKeyM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 521, srcSpanStartColumn = 20, srcSpanEndLine = 521, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 521, srcSpanStartColumn = 20, srcSpanEndLine = 521, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(Monad m, StreamCipher k iv) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_522_1_522_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_1_522_16&#39;)"><span class="hl_fundecl"><span class="mpre">buildStreamKeyM</span></span></a><span class="mpre"> </span><a name="loc_522_17_522_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_17_522_24&#39;)"><span class="hl_vardecl"><span class="mpre">getMore</span></span></a><span class="mpre"> </span><a name="loc_522_25_522_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_25_522_28&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> = </span><a href="#loc_524_3_524_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_3_524_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  where
  </span><a name="loc_524_3_524_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_3_524_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000</span></span><span class="mpre"> = </span><a href="#loc_522_25_522_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_25_522_28&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Tried 1000 times to generate a stream key from the system entropy.\
                \  No keys were returned! Perhaps the system entropy is broken\
                \ or perhaps the BlockCipher instance being used has a non-flat\
                \ keyspace.&quot;</span></span><span class="mpre">
  </span><a href="#loc_524_3_524_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_3_524_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_528_6_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_6_528_7&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = do
    let </span><a name="loc_529_9_529_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_9_529_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_511_3_511_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_3_511_18&#39;)"><span class="hl_varref"><span class="mpre">streamKeyLength</span></span></a><span class="mpre">
    </span><a name="loc_530_5_530_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_5_530_7&#39;)"><span class="hl_vardecl"><span class="mpre">kd</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_522_17_522_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_17_522_24&#39;)"><span class="hl_varref"><span class="mpre">getMore</span></span></a><span class="mpre"> ((</span><a href="Data.Tagged.html#loc_252_1_252_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_252_1_252_6&#39;)"><span class="hl_varref"><span class="mpre">untag</span></span></a><span class="mpre"> </span><a href="#loc_529_9_529_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_9_529_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)
    case </span><a href="#loc_508_3_508_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_3_508_17&#39;)"><span class="hl_varref"><span class="mpre">buildStreamKey</span></span></a><span class="mpre"> </span><a href="#loc_530_5_530_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_5_530_7&#39;)"><span class="hl_varref"><span class="mpre">kd</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_524_3_524_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_3_524_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_528_6_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_6_528_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_533_14_533_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_14_533_16&#39;)"><span class="hl_vardecl"><span class="mpre">k&#39;</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_533_14_533_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_14_533_16&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a href="Data.Tagged.html#loc_261_1_261_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_261_1_261_15&#39;)"><span class="hl_infix"><span class="mpre">`asTaggedTypeOf`</span></span></a><span class="mpre"> </span><a href="#loc_529_9_529_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_9_529_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A class for signing operations which inherently can not be as generic</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as asymetric ciphers (ex: DSA).</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 537, srcSpanStartColumn = 7, srcSpanEndLine = 537, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 537, srcSpanStartColumn = 7, srcSpanEndLine = 537, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 53"><span class="mpre">(Serialize p, Serialize v) =&gt;</span></span><span class="mpre"> </span><a name="loc_537_37_537_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_37_537_44&#39;)"><span class="hl_classdecl"><span class="mpre">Signing</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> | </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 537, srcSpanStartColumn = 51, srcSpanEndLine = 537, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 537, srcSpanStartColumn = 53, srcSpanEndLine = 537, srcSpanEndColumn = 55}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/C"><span class="mpre">p -&gt; v</span></span><span class="mpre">, </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 537, srcSpanStartColumn = 59, srcSpanEndLine = 537, srcSpanEndColumn = 65}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 537, srcSpanStartColumn = 61, srcSpanEndLine = 537, srcSpanEndColumn = 63}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/C"><span class="mpre">v -&gt; p</span></span><span class="mpre">  where
  </span><a name="loc_538_3_538_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_538_3_538_7&#39;)"><span class="mpre">sign</span></a><span class="mpre">   :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 538, srcSpanStartColumn = 13, srcSpanEndLine = 538, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 538, srcSpanStartColumn = 31, srcSpanEndLine = 538, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">CryptoRandomGen g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
  </span><a name="loc_539_3_539_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_3_539_9&#39;)"><span class="mpre">verify</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
  </span><a name="loc_540_3_540_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_19&#39;)"><span class="mpre">buildSigningPair</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 540, srcSpanStartColumn = 23, srcSpanEndLine = 540, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 540, srcSpanStartColumn = 41, srcSpanEndLine = 540, srcSpanEndColumn = 43}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">CryptoRandomGen g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> ((</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">), </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
  </span><a name="loc_541_3_541_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_3_541_19&#39;)"><span class="mpre">signingKeyLength</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre">
  </span><a name="loc_542_3_542_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_3_542_21&#39;)"><span class="mpre">verifyingKeyLength</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Build a signing key using the system random generator</span></span><span class="mpre">
</span><a href="#loc_546_1_546_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_1_546_22&#39;)"><span class="mpre">buildSigningKeyPairIO</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 545, srcSpanStartColumn = 26, srcSpanEndLine = 545, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 545, srcSpanStartColumn = 26, srcSpanEndLine = 545, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(Signing p v) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">))
</span><a name="loc_546_1_546_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_1_546_22&#39;)"><span class="hl_fundecl"><span class="mpre">buildSigningKeyPairIO</span></span></a><span class="mpre"> </span><a name="loc_546_23_546_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_23_546_25&#39;)"><span class="hl_vardecl"><span class="mpre">bl</span></span></a><span class="mpre"> = do
        </span><a name="loc_547_9_547_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_547_9_547_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> &lt;- </span><a href="Crypto.Random.html#loc_165_9_165_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_165_9_165_17&#39;)"><span class="hl_varref"><span class="mpre">newGenIO</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_204_6_204_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_204_6_204_18&#39;)"><span class="hl_tyconref"><span class="mpre">SystemRandom</span></span></a><span class="mpre">
        case </span><a href="#loc_540_3_540_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_19&#39;)"><span class="hl_varref"><span class="mpre">buildSigningPair</span></span></a><span class="mpre"> </span><a href="#loc_547_9_547_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_547_9_547_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_546_23_546_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_23_546_25&#39;)"><span class="hl_varref"><span class="mpre">bl</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_549_22_549_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_22_549_25&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_549_22_549_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_22_549_25&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_550_24_550_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_550_24_550_25&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">,_) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_550_24_550_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_550_24_550_25&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Flipped &#39;buildSigningPair&#39; for ease of use with state monads.</span></span><span class="mpre">
</span><a href="#loc_554_1_554_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_1_554_23&#39;)"><span class="mpre">buildSigningKeyPairGen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 553, srcSpanStartColumn = 27, srcSpanEndLine = 553, srcSpanEndColumn = 62}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 553, srcSpanStartColumn = 27, srcSpanEndLine = 553, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(Signing p v, CryptoRandomGen g) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BitLength</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Random.html#loc_62_6_62_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.html#loc_62_6_62_14&#39;)"><span class="hl_tyconref"><span class="mpre">GenError</span></span></a><span class="mpre"> ((</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">), </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_554_1_554_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_1_554_23&#39;)"><span class="hl_vardecl"><span class="mpre">buildSigningKeyPairGen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_540_3_540_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_19&#39;)"><span class="hl_varref"><span class="mpre">buildSigningPair</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like `ecb` but for strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_558_1_558_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_1_558_9&#39;)"><span class="mpre">modeEcb&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 557, srcSpanStartColumn = 13, srcSpanEndLine = 557, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 557, srcSpanStartColumn = 27, srcSpanEndLine = 557, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_558_1_558_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_1_558_9&#39;)"><span class="hl_fundecl"><span class="mpre">modeEcb&#39;</span></span></a><span class="mpre"> </span><a name="loc_558_10_558_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_10_558_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_558_12_558_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_12_558_15&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
        let </span><a name="loc_559_13_559_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_13_559_19&#39;)"><span class="hl_vardecl"><span class="mpre">chunks</span></span></a><span class="mpre"> = </span><a href="#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_1_696_10&#39;)"><span class="hl_varref"><span class="mpre">chunkFor&#39;</span></span></a><span class="mpre"> </span><a href="#loc_558_10_558_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_10_558_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_558_12_558_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_12_558_15&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
        in </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_558_10_558_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_10_558_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_559_13_559_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_13_559_19&#39;)"><span class="hl_varref"><span class="mpre">chunks</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_558_1_558_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_1_558_9&#39;)"><span class="mpre">modeEcb&#39;</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Decryption complement to `ecb&#39;`</span></span><span class="mpre">
</span><a href="#loc_565_1_565_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_1_565_11&#39;)"><span class="mpre">modeUnEcb&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 564, srcSpanStartColumn = 15, srcSpanEndLine = 564, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 564, srcSpanStartColumn = 29, srcSpanEndLine = 564, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_565_1_565_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_1_565_11&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnEcb&#39;</span></span></a><span class="mpre"> </span><a name="loc_565_12_565_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_12_565_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_565_14_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_14_565_16&#39;)"><span class="hl_vardecl"><span class="mpre">ct</span></span></a><span class="mpre"> =
        let </span><a name="loc_566_13_566_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_566_13_566_19&#39;)"><span class="hl_vardecl"><span class="mpre">chunks</span></span></a><span class="mpre"> = </span><a href="#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_1_696_10&#39;)"><span class="hl_varref"><span class="mpre">chunkFor&#39;</span></span></a><span class="mpre"> </span><a href="#loc_565_12_565_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_12_565_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_565_14_565_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_14_565_16&#39;)"><span class="hl_varref"><span class="mpre">ct</span></span></a><span class="mpre">
        in </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_154_3_154_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_15&#39;)"><span class="hl_varref"><span class="mpre">decryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_565_12_565_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_12_565_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_566_13_566_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_566_13_566_19&#39;)"><span class="hl_varref"><span class="mpre">chunks</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_565_1_565_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_1_565_11&#39;)"><span class="mpre">modeUnEcb&#39;</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Cipher block chaining encryption mode on strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_572_1_572_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_1_572_9&#39;)"><span class="mpre">modeCbc&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 571, srcSpanStartColumn = 13, srcSpanEndLine = 571, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 571, srcSpanStartColumn = 27, srcSpanEndLine = 571, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_572_1_572_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_1_572_9&#39;)"><span class="hl_fundecl"><span class="mpre">modeCbc&#39;</span></span></a><span class="mpre"> </span><a name="loc_572_10_572_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_10_572_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_572_16_572_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_16_572_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_572_19_572_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_19_572_28&#39;)"><span class="hl_vardecl"><span class="mpre">plaintext</span></span></a><span class="mpre"> =
        let </span><a name="loc_573_13_573_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_13_573_17&#39;)"><span class="hl_vardecl"><span class="mpre">blks</span></span></a><span class="mpre"> = </span><a href="#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_1_696_10&#39;)"><span class="hl_varref"><span class="mpre">chunkFor&#39;</span></span></a><span class="mpre"> </span><a href="#loc_572_10_572_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_10_572_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_572_19_572_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_19_572_28&#39;)"><span class="hl_varref"><span class="mpre">plaintext</span></span></a><span class="mpre">
            (</span><a name="loc_574_14_574_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_14_574_17&#39;)"><span class="hl_vardecl"><span class="mpre">cts</span></span></a><span class="mpre">, </span><a name="loc_574_19_574_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_19_574_21&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">) = </span><a href="#loc_577_3_577_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_3_577_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_573_13_573_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_13_573_17&#39;)"><span class="hl_varref"><span class="mpre">blks</span></span></a><span class="mpre"> </span><a href="#loc_572_16_572_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_16_572_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
        in (</span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><a href="#loc_574_14_574_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_14_574_17&#39;)"><span class="hl_varref"><span class="mpre">cts</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_574_19_574_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_19_574_21&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  where
  </span><a name="loc_577_3_577_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_3_577_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><a name="loc_577_9_577_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_9_577_11&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> = ([], </span><a href="#loc_577_9_577_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_9_577_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  </span><a href="#loc_577_3_577_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_3_577_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_578_7_578_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_7_578_8&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_578_9_578_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_9_578_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a name="loc_578_13_578_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_13_578_15&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> =
        let </span><a name="loc_579_13_579_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_13_579_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_572_10_572_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_10_572_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_578_13_578_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_13_578_15&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_578_7_578_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_7_578_8&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
            (</span><a name="loc_580_14_580_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_14_580_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a name="loc_580_18_580_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_18_580_25&#39;)"><span class="hl_vardecl"><span class="mpre">ivFinal</span></span></a><span class="mpre">) = </span><a href="#loc_577_3_577_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_3_577_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_578_9_578_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_9_578_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_579_13_579_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_13_579_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
        in (</span><a href="#loc_579_13_579_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_13_579_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_580_14_580_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_14_580_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a href="#loc_580_18_580_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_18_580_25&#39;)"><span class="hl_varref"><span class="mpre">ivFinal</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeCbc&#39; #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Cipher block chaining decryption for strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_586_1_586_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_1_586_11&#39;)"><span class="mpre">modeUnCbc&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 585, srcSpanStartColumn = 15, srcSpanEndLine = 585, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 585, srcSpanStartColumn = 29, srcSpanEndLine = 585, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_586_1_586_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_1_586_11&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnCbc&#39;</span></span></a><span class="mpre"> </span><a name="loc_586_12_586_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_12_586_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_586_18_586_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_18_586_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_586_21_586_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_21_586_31&#39;)"><span class="hl_vardecl"><span class="mpre">ciphertext</span></span></a><span class="mpre"> =
        let </span><a name="loc_587_13_587_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_587_13_587_17&#39;)"><span class="hl_vardecl"><span class="mpre">blks</span></span></a><span class="mpre"> = </span><a href="#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_1_696_10&#39;)"><span class="hl_varref"><span class="mpre">chunkFor&#39;</span></span></a><span class="mpre"> </span><a href="#loc_586_12_586_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_12_586_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_586_21_586_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_21_586_31&#39;)"><span class="hl_varref"><span class="mpre">ciphertext</span></span></a><span class="mpre">
            (</span><a name="loc_588_14_588_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_14_588_17&#39;)"><span class="hl_vardecl"><span class="mpre">pts</span></span></a><span class="mpre">, </span><a name="loc_588_19_588_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_19_588_21&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">) = </span><a href="#loc_591_3_591_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_3_591_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_587_13_587_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_587_13_587_17&#39;)"><span class="hl_varref"><span class="mpre">blks</span></span></a><span class="mpre"> </span><a href="#loc_586_18_586_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_18_586_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
        in (</span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><a href="#loc_588_14_588_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_14_588_17&#39;)"><span class="hl_varref"><span class="mpre">pts</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_588_19_588_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_19_588_21&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  where
  </span><a name="loc_591_3_591_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_3_591_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><a name="loc_591_9_591_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_9_591_11&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> = ([], </span><a href="#loc_591_9_591_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_9_591_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  </span><a href="#loc_591_3_591_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_3_591_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_592_7_592_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_7_592_8&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_592_9_592_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_9_592_11&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) </span><a name="loc_592_13_592_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_13_592_15&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> =
        let </span><a name="loc_593_13_593_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_13_593_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_154_3_154_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_15&#39;)"><span class="hl_varref"><span class="mpre">decryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_586_12_586_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_12_586_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_592_7_592_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_7_592_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_592_13_592_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_13_592_15&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
            (</span><a name="loc_594_14_594_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_14_594_16&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a name="loc_594_18_594_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_18_594_25&#39;)"><span class="hl_vardecl"><span class="mpre">ivFinal</span></span></a><span class="mpre">) = </span><a href="#loc_591_3_591_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_3_591_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_592_9_592_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_9_592_11&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> </span><a href="#loc_592_7_592_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_7_592_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
        in (</span><a href="#loc_593_13_593_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_13_593_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_594_14_594_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_14_594_16&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a href="#loc_594_18_594_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_18_594_25&#39;)"><span class="hl_varref"><span class="mpre">ivFinal</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeUnCbc&#39; #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Output feedback mode for strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_600_1_600_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_1_600_9&#39;)"><span class="mpre">modeOfb&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 599, srcSpanStartColumn = 13, srcSpanEndLine = 599, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 599, srcSpanStartColumn = 27, srcSpanEndLine = 599, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_600_1_600_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_1_600_9&#39;)"><span class="hl_vardecl"><span class="mpre">modeOfb&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_605_1_605_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_11&#39;)"><span class="hl_varref"><span class="mpre">modeUnOfb&#39;</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeOfb&#39; #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Output feedback mode for strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_605_1_605_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_11&#39;)"><span class="mpre">modeUnOfb&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 604, srcSpanStartColumn = 15, srcSpanEndLine = 604, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 604, srcSpanStartColumn = 29, srcSpanEndLine = 604, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_605_1_605_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_1_605_11&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnOfb&#39;</span></span></a><span class="mpre"> </span><a name="loc_605_12_605_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_12_605_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_605_18_605_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_18_605_20&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a name="loc_605_22_605_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_22_605_25&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
        let </span><a name="loc_606_13_606_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_13_606_18&#39;)"><span class="hl_vardecl"><span class="mpre">ivStr</span></span></a><span class="mpre"> = </span><a href="Crypto.Util.html#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_115_1_115_8&#39;)"><span class="hl_varref"><span class="mpre">collect</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_605_22_605_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_22_605_25&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_607_13_607_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_13_607_18&#39;)"><span class="hl_varref"><span class="mpre">ivLen</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">iterate</span></span><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_605_12_605_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_12_605_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_605_18_605_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_18_605_20&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">))
            </span><a name="loc_607_13_607_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_13_607_18&#39;)"><span class="hl_vardecl"><span class="mpre">ivLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_605_18_605_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_18_605_20&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
            </span><a name="loc_608_13_608_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_608_13_608_17&#39;)"><span class="hl_vardecl"><span class="mpre">mLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_605_22_605_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_22_605_25&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">)
            </span><a name="loc_609_13_609_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_13_609_18&#39;)"><span class="hl_vardecl"><span class="mpre">newIV</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.take</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_607_13_607_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_13_607_18&#39;)"><span class="hl_varref"><span class="mpre">ivLen</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.drop</span></span><span class="mpre"> </span><a href="#loc_608_13_608_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_608_13_608_17&#39;)"><span class="hl_varref"><span class="mpre">mLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_606_13_606_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_13_606_18&#39;)"><span class="hl_varref"><span class="mpre">ivStr</span></span></a><span class="mpre">
        in (</span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><a href="#loc_606_13_606_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_13_606_18&#39;)"><span class="hl_varref"><span class="mpre">ivStr</span></span></a><span class="mpre">) </span><a href="#loc_605_22_605_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_22_605_25&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">, </span><a href="#loc_609_13_609_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_13_609_18&#39;)"><span class="hl_varref"><span class="mpre">newIV</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeUnOfb&#39; #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Counter mode for strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_615_1_615_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_1_615_9&#39;)"><span class="mpre">modeCtr&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 614, srcSpanStartColumn = 13, srcSpanEndLine = 614, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 614, srcSpanStartColumn = 27, srcSpanEndLine = 614, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_615_1_615_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_1_615_9&#39;)"><span class="hl_vardecl"><span class="mpre">modeCtr&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_620_1_620_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_1_620_11&#39;)"><span class="hl_varref"><span class="mpre">modeUnCtr&#39;</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeCtr&#39; #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Counter mode for strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_620_1_620_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_1_620_11&#39;)"><span class="mpre">modeUnCtr&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 619, srcSpanStartColumn = 15, srcSpanEndLine = 619, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 619, srcSpanStartColumn = 29, srcSpanEndLine = 619, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_620_1_620_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_1_620_11&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnCtr&#39;</span></span></a><span class="mpre"> </span><a name="loc_620_12_620_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_12_620_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_620_14_620_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_14_620_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_620_16_620_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_16_620_18&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a name="loc_620_19_620_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_19_620_22&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
       let </span><a name="loc_621_12_621_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_12_621_14&#39;)"><span class="hl_fundecl"><span class="mpre">fa</span></span></a><span class="mpre"> (</span><a name="loc_621_16_621_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_16_621_18&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre">,</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_621_22_621_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_22_621_24&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a name="loc_621_26_621_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_26_621_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> 
              | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_621_16_621_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_16_621_18&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> = </span><a href="#loc_621_12_621_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_12_621_14&#39;)"><span class="hl_varref"><span class="mpre">fa</span></span></a><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_620_14_620_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_14_620_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_621_22_621_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_22_621_24&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">, </span><a href="#loc_620_12_620_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_12_620_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_621_22_621_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_22_621_24&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)) </span><a href="#loc_621_26_621_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_26_621_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = let </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_623_39_623_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_39_623_40&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">,</span><a name="loc_623_41_623_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_41_623_44&#39;)"><span class="hl_vardecl"><span class="mpre">nst</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.uncons</span></span><span class="mpre"> </span><a href="#loc_621_16_621_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_16_621_18&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> in ((</span><a href="#loc_623_41_623_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_41_623_44&#39;)"><span class="hl_varref"><span class="mpre">nst</span></span></a><span class="mpre">,</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_621_22_621_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_22_621_24&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">),</span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">xor</span></span></a><span class="mpre"> </span><a href="#loc_621_26_621_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_26_621_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_623_39_623_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_39_623_40&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
           ((_,</span><a name="loc_624_16_624_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_16_624_21&#39;)"><span class="hl_vardecl"><span class="mpre">newIV</span></span></a><span class="mpre">),</span><a name="loc_624_23_624_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_23_624_26&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.mapAccumL</span></span><span class="mpre"> </span><a href="#loc_621_12_621_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_12_621_14&#39;)"><span class="hl_varref"><span class="mpre">fa</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">,</span><a href="#loc_620_16_620_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_16_620_18&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a href="#loc_620_19_620_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_19_620_22&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> 
       in (</span><a href="#loc_624_23_624_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_23_624_26&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">,</span><a href="#loc_624_16_624_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_16_624_21&#39;)"><span class="hl_varref"><span class="mpre">newIV</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeUnCtr&#39; #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Ciphertext feed-back encryption mode for strict bytestrings (with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- s == blockSize)</span></span><span class="mpre">
</span><a href="#loc_631_1_631_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_1_631_9&#39;)"><span class="mpre">modeCfb&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 630, srcSpanStartColumn = 13, srcSpanEndLine = 630, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 630, srcSpanStartColumn = 27, srcSpanEndLine = 630, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_631_1_631_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_1_631_9&#39;)"><span class="hl_fundecl"><span class="mpre">modeCfb&#39;</span></span></a><span class="mpre"> </span><a name="loc_631_10_631_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_10_631_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_631_16_631_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_16_631_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_631_19_631_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_19_631_22&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
        let </span><a name="loc_632_13_632_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_632_13_632_17&#39;)"><span class="hl_vardecl"><span class="mpre">blks</span></span></a><span class="mpre"> = </span><a href="#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_1_696_10&#39;)"><span class="hl_varref"><span class="mpre">chunkFor&#39;</span></span></a><span class="mpre"> </span><a href="#loc_631_10_631_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_10_631_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_631_19_631_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_19_631_22&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
            (</span><a name="loc_633_14_633_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_14_633_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">,</span><a name="loc_633_17_633_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_17_633_20&#39;)"><span class="hl_vardecl"><span class="mpre">ivF</span></span></a><span class="mpre">) = </span><a href="#loc_636_3_636_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_3_636_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_631_16_631_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_16_631_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_632_13_632_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_632_13_632_17&#39;)"><span class="hl_varref"><span class="mpre">blks</span></span></a><span class="mpre">
        in (</span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><a href="#loc_633_14_633_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_14_633_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_633_17_633_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_17_633_20&#39;)"><span class="hl_varref"><span class="mpre">ivF</span></span></a><span class="mpre">)
  where
  </span><a name="loc_636_3_636_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_3_636_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_636_6_636_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_6_636_8&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> [] = ([],</span><a href="#loc_636_6_636_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_6_636_8&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  </span><a href="#loc_636_3_636_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_3_636_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_637_6_637_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_6_637_8&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> (</span><a name="loc_637_10_637_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_10_637_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_637_12_637_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_12_637_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) =
        let </span><a name="loc_638_13_638_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_13_638_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_631_10_631_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_631_10_631_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_637_6_637_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_6_637_8&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a href="#loc_637_10_637_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_10_637_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            (</span><a name="loc_639_14_639_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_14_639_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">,</span><a name="loc_639_17_639_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_17_639_24&#39;)"><span class="hl_vardecl"><span class="mpre">ivFinal</span></span></a><span class="mpre">) = </span><a href="#loc_636_3_636_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_3_636_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_638_13_638_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_13_638_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_637_12_637_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_12_637_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        in (</span><a href="#loc_638_13_638_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_13_638_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_639_14_639_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_14_639_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a href="#loc_639_17_639_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_17_639_24&#39;)"><span class="hl_varref"><span class="mpre">ivFinal</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeCfb&#39; #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Ciphertext feed-back decryption mode for strict bytestrings (with s == blockSize)</span></span><span class="mpre">
</span><a href="#loc_645_1_645_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_1_645_11&#39;)"><span class="mpre">modeUnCfb&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 644, srcSpanStartColumn = 15, srcSpanEndLine = 644, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 644, srcSpanStartColumn = 29, srcSpanEndLine = 644, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_645_1_645_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_1_645_11&#39;)"><span class="hl_fundecl"><span class="mpre">modeUnCfb&#39;</span></span></a><span class="mpre"> </span><a name="loc_645_12_645_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_12_645_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_645_18_645_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_18_645_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_645_21_645_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_21_645_24&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
        let </span><a name="loc_646_13_646_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_13_646_17&#39;)"><span class="hl_vardecl"><span class="mpre">blks</span></span></a><span class="mpre"> = </span><a href="#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_1_696_10&#39;)"><span class="hl_varref"><span class="mpre">chunkFor&#39;</span></span></a><span class="mpre"> </span><a href="#loc_645_12_645_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_12_645_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_645_21_645_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_21_645_24&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
            (</span><a name="loc_647_14_647_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_14_647_16&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a name="loc_647_18_647_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_18_647_21&#39;)"><span class="hl_vardecl"><span class="mpre">ivF</span></span></a><span class="mpre">) = </span><a href="#loc_650_3_650_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_3_650_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_645_18_645_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_18_645_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_646_13_646_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_13_646_17&#39;)"><span class="hl_varref"><span class="mpre">blks</span></span></a><span class="mpre">
        in (</span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><a href="#loc_647_14_647_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_14_647_16&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a href="#loc_647_18_647_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_18_647_21&#39;)"><span class="hl_varref"><span class="mpre">ivF</span></span></a><span class="mpre">)
  where
  </span><a name="loc_650_3_650_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_3_650_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_650_6_650_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_6_650_8&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> [] = ([], </span><a href="#loc_650_6_650_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_6_650_8&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
  </span><a href="#loc_650_3_650_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_3_650_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_651_6_651_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_6_651_8&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> (</span><a name="loc_651_10_651_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_10_651_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_651_12_651_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_12_651_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) =
        let </span><a name="loc_652_13_652_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_13_652_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_645_12_645_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_12_645_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_651_6_651_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_6_651_8&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">) </span><a href="#loc_651_10_651_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_10_651_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            (</span><a name="loc_653_14_653_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_14_653_16&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a name="loc_653_18_653_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_18_653_21&#39;)"><span class="hl_vardecl"><span class="mpre">ivF</span></span></a><span class="mpre">) = </span><a href="#loc_650_3_650_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_3_650_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_651_10_651_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_10_651_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_651_12_651_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_12_651_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        in (</span><a href="#loc_652_13_652_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_13_652_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_653_14_653_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_14_653_16&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a href="#loc_653_18_653_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_18_653_21&#39;)"><span class="hl_varref"><span class="mpre">ivF</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE modeUnCfb&#39; #-}</span></span><span class="mpre">

</span><a href="#loc_658_1_658_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_658_1_658_9&#39;)"><span class="mpre">toChunks</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">]
</span><a name="loc_658_1_658_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_658_1_658_9&#39;)"><span class="hl_fundecl"><span class="mpre">toChunks</span></span></a><span class="mpre"> </span><a name="loc_658_10_658_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_658_10_658_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_658_12_658_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_658_12_658_15&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> = </span><a href="#loc_660_3_660_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_3_660_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_658_12_658_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_658_12_658_15&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">
  where
  </span><a name="loc_660_3_660_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_3_660_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_660_6_660_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_6_660_7&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_660_6_660_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_6_660_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = []
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = let (</span><a name="loc_662_30_662_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_30_662_31&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">,</span><a name="loc_662_32_662_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_32_662_33&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_658_10_658_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_658_10_658_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_660_6_660_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_6_660_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                        in </span><a href="#loc_662_30_662_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_30_662_31&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_660_3_660_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_3_660_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_662_32_662_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_662_32_662_33&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Increase an `IV` by one.  This is way faster than decoding,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- increasing, encoding</span></span><span class="mpre">
</span><a href="#loc_668_1_668_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_6&#39;)"><span class="mpre">incIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 667, srcSpanStartColumn = 10, srcSpanEndLine = 667, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 667, srcSpanStartColumn = 24, srcSpanEndLine = 667, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_668_1_668_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_1_668_6&#39;)"><span class="hl_fundecl"><span class="mpre">incIV</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_668_11_668_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_11_668_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.mapAccumR</span></span><span class="mpre"> (</span><a href="#loc_671_8_671_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_8_671_12&#39;)"><span class="hl_varref"><span class="mpre">incw</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_668_11_668_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_11_668_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  where
       </span><a href="#loc_671_8_671_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_8_671_12&#39;)"><span class="mpre">incw</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
       </span><a name="loc_671_8_671_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_8_671_12&#39;)"><span class="hl_fundecl"><span class="mpre">incw</span></span></a><span class="mpre"> </span><a name="loc_671_13_671_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_13_671_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_671_15_671_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_15_671_16&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = let </span><a name="loc_671_23_671_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_23_671_25&#39;)"><span class="hl_vardecl"><span class="mpre">nw</span></span></a><span class="mpre">=</span><a href="#loc_671_13_671_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_13_671_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre">(</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_671_15_671_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_15_671_16&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) in (</span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_varref"><span class="mpre">shiftR</span></span></a><span class="mpre"> </span><a href="#loc_671_23_671_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_23_671_25&#39;)"><span class="hl_varref"><span class="mpre">nw</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_671_23_671_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_23_671_25&#39;)"><span class="hl_varref"><span class="mpre">nw</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Obtain an `IV` made only of zeroes</span></span><span class="mpre">
</span><a href="#loc_675_1_675_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_1_675_7&#39;)"><span class="mpre">zeroIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 674, srcSpanStartColumn = 11, srcSpanEndLine = 674, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 674, srcSpanStartColumn = 11, srcSpanEndLine = 674, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k) =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_675_1_675_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_1_675_7&#39;)"><span class="hl_vardecl"><span class="mpre">zeroIV</span></span></a><span class="mpre"> = </span><a href="#loc_677_9_677_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_9_677_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
  where </span><a name="loc_676_9_676_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_9_676_14&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> = </span><a href="#loc_713_1_713_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_1_713_17&#39;)"><span class="hl_varref"><span class="mpre">ivBlockSizeBytes</span></span></a><span class="mpre"> </span><a href="#loc_677_9_677_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_9_677_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
        </span><a name="loc_677_9_677_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_9_677_11&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">  = </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre">  </span><a href="#loc_676_9_676_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_9_676_14&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><a href="#loc_680_1_680_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_10&#39;)"><span class="mpre">zeroIVcwc</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 679, srcSpanStartColumn = 14, srcSpanEndLine = 679, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 679, srcSpanStartColumn = 28, srcSpanEndLine = 679, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_680_1_680_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_10&#39;)"><span class="hl_vardecl"><span class="mpre">zeroIVcwc</span></span></a><span class="mpre"> = </span><a href="#loc_682_9_682_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_9_682_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
  where </span><a name="loc_681_9_681_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_9_681_14&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> = </span><a href="#loc_713_1_713_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_1_713_17&#39;)"><span class="hl_varref"><span class="mpre">ivBlockSizeBytes</span></span></a><span class="mpre"> </span><a href="#loc_682_9_682_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_9_682_11&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- a constant of cwc (4 bytes for ctr mode, 1 for a sort of header on the iv)</span></span><span class="mpre">
        </span><a name="loc_682_9_682_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_9_682_11&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">    = </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> </span><a href="#loc_681_9_681_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_9_681_14&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Break a bytestring into block size chunks.</span></span><span class="mpre">
</span><a href="#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_1_686_9&#39;)"><span class="mpre">chunkFor</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 685, srcSpanStartColumn = 13, srcSpanEndLine = 685, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 685, srcSpanStartColumn = 13, srcSpanEndLine = 685, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">]
</span><a name="loc_686_1_686_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_1_686_9&#39;)"><span class="hl_fundecl"><span class="mpre">chunkFor</span></span></a><span class="mpre"> </span><a name="loc_686_10_686_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_10_686_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_690_3_690_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_3_690_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
  </span><a name="loc_688_3_688_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_3_688_8&#39;)"><span class="hl_vardecl"><span class="mpre">blkSz</span></span></a><span class="mpre"> = (</span><a href="#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_686_10_686_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_10_686_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">
  </span><a name="loc_689_3_689_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_3_689_9&#39;)"><span class="hl_vardecl"><span class="mpre">blkSzI</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_688_3_688_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_688_3_688_8&#39;)"><span class="hl_varref"><span class="mpre">blkSz</span></span></a><span class="mpre">
  </span><a name="loc_690_3_690_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_3_690_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_690_6_690_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_6_690_8&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_690_6_690_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_6_690_8&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_689_3_689_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_3_689_9&#39;)"><span class="hl_varref"><span class="mpre">blkSzI</span></span></a><span class="mpre"> = []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">            = let (</span><a name="loc_691_39_691_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_39_691_42&#39;)"><span class="hl_vardecl"><span class="mpre">blk</span></span></a><span class="mpre">,</span><a name="loc_691_43_691_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_43_691_47&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> </span><a href="#loc_689_3_689_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_3_689_9&#39;)"><span class="hl_varref"><span class="mpre">blkSzI</span></span></a><span class="mpre"> </span><a href="#loc_690_6_690_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_6_690_8&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> in </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_691_39_691_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_39_691_42&#39;)"><span class="hl_varref"><span class="mpre">blk</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_690_3_690_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_3_690_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_691_43_691_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_43_691_47&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_686_1_686_9&#39;)"><span class="mpre">chunkFor</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Break a bytestring into block size chunks.</span></span><span class="mpre">
</span><a href="#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_1_696_10&#39;)"><span class="mpre">chunkFor&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 695, srcSpanStartColumn = 14, srcSpanEndLine = 695, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 695, srcSpanStartColumn = 14, srcSpanEndLine = 695, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">]
</span><a name="loc_696_1_696_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_1_696_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunkFor&#39;</span></span></a><span class="mpre"> </span><a name="loc_696_11_696_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_11_696_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_699_3_699_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_3_699_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
  </span><a name="loc_698_3_698_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_3_698_8&#39;)"><span class="hl_vardecl"><span class="mpre">blkSz</span></span></a><span class="mpre"> = (</span><a href="#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_696_11_696_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_11_696_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">
  </span><a name="loc_699_3_699_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_3_699_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_699_6_699_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_6_699_8&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_699_6_699_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_6_699_8&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_698_3_698_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_3_698_8&#39;)"><span class="hl_varref"><span class="mpre">blkSz</span></span></a><span class="mpre"> = []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           = let (</span><a name="loc_700_38_700_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_700_38_700_41&#39;)"><span class="hl_vardecl"><span class="mpre">blk</span></span></a><span class="mpre">,</span><a name="loc_700_42_700_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_700_42_700_46&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_698_3_698_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_3_698_8&#39;)"><span class="hl_varref"><span class="mpre">blkSz</span></span></a><span class="mpre"> </span><a href="#loc_699_6_699_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_6_699_8&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> in </span><a href="#loc_700_38_700_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_700_38_700_41&#39;)"><span class="hl_varref"><span class="mpre">blk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_699_3_699_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_3_699_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_700_42_700_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_700_42_700_46&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_696_1_696_10&#39;)"><span class="mpre">chunkFor&#39;</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Create the mask for SIV based ciphers</span></span><span class="mpre">
</span><a href="#loc_705_1_705_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_8&#39;)"><span class="mpre">sivMask</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_705_1_705_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_8&#39;)"><span class="hl_fundecl"><span class="mpre">sivMask</span></span></a><span class="mpre"> </span><a name="loc_705_9_705_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_9_705_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.mapAccumR</span></span><span class="mpre"> (</span><a href="#loc_708_8_708_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_8_708_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_705_9_705_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_9_705_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  where
       </span><a href="#loc_708_8_708_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_8_708_10&#39;)"><span class="mpre">go</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
       </span><a name="loc_708_8_708_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_8_708_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre"> </span><a name="loc_708_14_708_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_14_708_15&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = (</span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">,</span><a href="Data.Bits.html#loc_161_5_161_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_161_5_161_13&#39;)"><span class="hl_varref"><span class="mpre">clearBit</span></span></a><span class="mpre"> </span><a href="#loc_708_14_708_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_14_708_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">)
       </span><a href="#loc_708_8_708_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_8_708_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre"> </span><a name="loc_709_14_709_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_709_14_709_15&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = (</span><span class="hl_num"><span class="mpre">64</span></span><span class="mpre">,</span><a href="Data.Bits.html#loc_161_5_161_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_161_5_161_13&#39;)"><span class="hl_varref"><span class="mpre">clearBit</span></span></a><span class="mpre"> </span><a href="#loc_709_14_709_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_709_14_709_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">)
       </span><a href="#loc_708_8_708_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_8_708_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_710_11_710_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_710_11_710_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_710_13_710_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_710_13_710_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = (</span><a href="#loc_710_11_710_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_710_11_710_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,</span><a href="#loc_710_13_710_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_710_13_710_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><a href="#loc_713_1_713_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_1_713_17&#39;)"><span class="mpre">ivBlockSizeBytes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 712, srcSpanStartColumn = 21, srcSpanEndLine = 712, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 712, srcSpanStartColumn = 35, srcSpanEndLine = 712, srcSpanEndColumn = 37}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_713_1_713_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_1_713_17&#39;)"><span class="hl_fundecl"><span class="mpre">ivBlockSizeBytes</span></span></a><span class="mpre"> </span><a name="loc_713_18_713_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_18_713_20&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> =
        let </span><a name="loc_714_13_714_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_13_714_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_337_1_337_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_1_337_10&#39;)"><span class="hl_varref"><span class="mpre">deIVProxy</span></span></a><span class="mpre"> (</span><a href="#loc_718_3_718_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_718_3_718_10&#39;)"><span class="hl_varref"><span class="mpre">proxyOf</span></span></a><span class="mpre"> </span><a href="#loc_713_18_713_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_18_713_20&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
        in </span><a href="Data.Tagged.html#loc_276_1_276_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_276_1_276_6&#39;)"><span class="hl_varref"><span class="mpre">proxy</span></span></a><span class="mpre"> </span><a href="#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_714_13_714_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_13_714_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">
 where
  </span><a href="#loc_718_3_718_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_718_3_718_10&#39;)"><span class="mpre">proxyOf</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Proxy.html#loc_47_6_47_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_6_47_11&#39;)"><span class="hl_tyconref"><span class="mpre">Proxy</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  </span><a name="loc_718_3_718_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_718_3_718_10&#39;)"><span class="hl_vardecl"><span class="mpre">proxyOf</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="Data.Proxy.html#loc_47_16_47_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_16_47_21&#39;)"><span class="hl_conref"><span class="mpre">Proxy</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE ivBlockSizeBytes #-}</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 721, srcSpanStartColumn = 10, srcSpanEndLine = 721, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 721, srcSpanStartColumn = 10, srcSpanEndLine = 721, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine ="><span class="mpre">(BlockCipher k) =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Serialize</span></span><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) where
        </span><span class="hl_vardecl"><span class="mpre">get</span></span><span class="mpre"> = do
                let </span><a name="loc_723_21_723_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_21_723_22&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Data.Proxy.html#loc_47_16_47_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_16_47_21&#39;)"><span class="hl_conref"><span class="mpre">Proxy</span></span></a><span class="mpre">
                    </span><a href="#loc_725_21_725_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_21_725_26&#39;)"><span class="mpre">doGet</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 724, srcSpanStartColumn = 30, srcSpanEndLine = 724, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Classes.hs&quot;, srcSpanStartLine = 724, srcSpanStartColumn = 44, srcSpanEndLine = 724, srcSpanEndColumn = 46}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.1"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><a href="Data.Proxy.html#loc_47_6_47_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_47_6_47_11&#39;)"><span class="hl_tyconref"><span class="mpre">Proxy</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Get</span></span><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
                    </span><a name="loc_725_21_725_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_21_725_26&#39;)"><span class="hl_fundecl"><span class="mpre">doGet</span></span></a><span class="mpre"> </span><a name="loc_725_27_725_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_27_725_29&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> (</span><a href="Data.Serialize.Get.html#loc_424_1_424_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_424_1_424_14&#39;)"><span class="hl_varref"><span class="mpre">SG.getByteString</span></span></a><span class="mpre"> (</span><a href="Data.Tagged.html#loc_276_1_276_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tagged.html#loc_276_1_276_6&#39;)"><span class="hl_varref"><span class="mpre">proxy</span></span></a><span class="mpre"> </span><a href="#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="#loc_725_27_725_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_27_725_29&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">))
                </span><a name="loc_726_17_726_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_17_726_19&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_725_21_725_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_21_725_26&#39;)"><span class="hl_varref"><span class="mpre">doGet</span></span></a><span class="mpre"> </span><a href="#loc_723_21_723_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_21_723_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_726_17_726_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_17_726_19&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="Data.Proxy.html#loc_184_1_184_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Proxy.html#loc_184_1_184_14&#39;)"><span class="hl_infix"><span class="mpre">`asProxyTypeOf`</span></span></a><span class="mpre"> </span><a href="#loc_334_1_334_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_8&#39;)"><span class="hl_varref"><span class="mpre">ivProxy</span></span></a><span class="mpre"> </span><a href="#loc_723_21_723_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_21_723_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">put</span></span><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_728_17_728_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_17_728_19&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">) = </span><a href="Data.Serialize.Put.html#loc_182_1_182_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_182_1_182_14&#39;)"><span class="hl_varref"><span class="mpre">SP.putByteString</span></span></a><span class="mpre"> </span><a href="#loc_728_17_728_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_17_728_19&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">

</span></div></body></html>