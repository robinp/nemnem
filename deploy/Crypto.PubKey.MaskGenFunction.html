<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.PubKey.MaskGenFunction</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.PubKey.MaskGenFunction
    ( MaskGenAlgorithm
    , mgf1
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/MaskGenFunction.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 8, srcSpanEndLine = 13, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/MaskGenFunction.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Crypto.PubKey.HashDescr
import Crypto.Number.Serialize (</span><a href="Crypto.Number.Serialize.html#loc_103_1_103_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_103_1_103_9&#39;)"><span class="mpre">i2ospOf_</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Represent a mask generation algorithm</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/MaskGenFunction.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/MaskGenFunction.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 1, srcSpanEndLine = 19, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Cr"><span class="mpre">type MaskGenAlgorithm = HashFunction </span><span class="hl_comment"><span class="mpre">-- ^ hash function to use</span></span><span class="mpre">
                     -&gt; ByteString   </span><span class="hl_comment"><span class="mpre">-- ^ seed</span></span><span class="mpre">
                     -&gt; Int          </span><span class="hl_comment"><span class="mpre">-- ^ length to generate</span></span><span class="mpre">
                     -&gt; ByteString</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Mask generation algorithm MGF1</span></span><span class="mpre">
</span><a href="#loc_26_1_26_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_5&#39;)"><span class="mpre">mgf1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">MaskGenAlgorithm</span></span><span class="mpre">
</span><a name="loc_26_1_26_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_5&#39;)"><span class="hl_fundecl"><span class="mpre">mgf1</span></span></a><span class="mpre"> </span><a name="loc_26_6_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_6_26_11&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><a name="loc_26_12_26_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_12_26_16&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a name="loc_26_17_26_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_17_26_20&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="#loc_27_11_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_11_27_15&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    where </span><a name="loc_27_11_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_11_27_15&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_27_16_27_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_27_18_27_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_18_27_25&#39;)"><span class="hl_vardecl"><span class="mpre">counter</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_27_16_27_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_26_17_26_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_17_26_20&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre"> </span><a href="#loc_26_17_26_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_17_26_20&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_27_16_27_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = let </span><a name="loc_29_39_29_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_39_29_48&#39;)"><span class="hl_vardecl"><span class="mpre">counterBS</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.Serialize.html#loc_103_1_103_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_103_1_103_9&#39;)"><span class="hl_varref"><span class="mpre">i2ospOf_</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_27_18_27_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_18_27_25&#39;)"><span class="hl_varref"><span class="mpre">counter</span></span></a><span class="mpre">
                                      </span><a name="loc_30_39_30_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_39_30_43&#39;)"><span class="hl_vardecl"><span class="mpre">newT</span></span></a><span class="mpre"> = </span><a href="#loc_27_16_27_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> </span><a href="#loc_26_6_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_6_26_11&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> (</span><a href="#loc_26_12_26_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_12_26_16&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> </span><a href="#loc_29_39_29_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_39_29_48&#39;)"><span class="hl_varref"><span class="mpre">counterBS</span></span></a><span class="mpre">)
                                   in </span><a href="#loc_27_11_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_11_27_15&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_30_39_30_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_39_30_43&#39;)"><span class="hl_varref"><span class="mpre">newT</span></span></a><span class="mpre"> (</span><a href="#loc_27_18_27_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_18_27_25&#39;)"><span class="hl_varref"><span class="mpre">counter</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
</span></div></body></html>