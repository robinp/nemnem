<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE DeriveDataTypeable #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.Socks5.Wire</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
module Network.Socks5.Wire
    ( SocksHello(..)
    , SocksHelloResponse(..)
    , SocksRequest(..)
    , SocksResponse(..)
    ) where

import Control.Applicative
import Control.Monad
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 18, srcSpanEndLine = 17, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Data.Serialize&quot;"><span class="mpre">Data.Serialize</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre"> (PortNumber)

import Network.Socks5.Types

</span><span class="hl_comment"><span class="mpre">-- | Initial message sent by client with the list of authentification methods supported</span></span><span class="mpre">
data </span><a name="loc_25_6_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_16&#39;)"><span class="hl_tycondecl"><span class="mpre">SocksHello</span></span></a><span class="mpre"> = </span><a name="loc_25_19_25_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_19_25_29&#39;)"><span class="hl_condecl"><span class="mpre">SocksHello</span></span></a><span class="mpre"> { </span><a name="loc_25_32_25_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_32_25_52&#39;)"><span class="hl_fielddecl"><span class="mpre">getSocksHelloMethods</span></span></a><span class="mpre"> :: [</span><a href="Network.Socks5.Types.html#loc_44_6_44_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_44_6_44_17&#39;)"><span class="hl_tyconref"><span class="mpre">SocksMethod</span></span></a><span class="mpre">] }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 5, srcSpanEndLine = 26, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 5, srcSpanEndLine = 26, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 2"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Initial message send by server in return from Hello, with the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- server chosen method of authentication</span></span><span class="mpre">
data </span><a name="loc_30_6_30_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_24&#39;)"><span class="hl_tycondecl"><span class="mpre">SocksHelloResponse</span></span></a><span class="mpre"> = </span><a name="loc_30_27_30_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_27_30_45&#39;)"><span class="hl_condecl"><span class="mpre">SocksHelloResponse</span></span></a><span class="mpre"> { </span><a name="loc_30_48_30_75" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_48_30_75&#39;)"><span class="hl_fielddecl"><span class="mpre">getSocksHelloResponseMethod</span></span></a><span class="mpre"> :: </span><a href="Network.Socks5.Types.html#loc_44_6_44_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_44_6_44_17&#39;)"><span class="hl_tyconref"><span class="mpre">SocksMethod</span></span></a><span class="mpre"> }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 5, srcSpanEndLine = 31, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 5, srcSpanEndLine = 31, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 3"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Define a SOCKS requests</span></span><span class="mpre">
data </span><a name="loc_34_6_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_18&#39;)"><span class="hl_tycondecl"><span class="mpre">SocksRequest</span></span></a><span class="mpre"> = </span><a name="loc_34_21_34_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_21_34_33&#39;)"><span class="hl_condecl"><span class="mpre">SocksRequest</span></span></a><span class="mpre">
    { </span><a name="loc_35_7_35_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_21&#39;)"><span class="hl_fielddecl"><span class="mpre">requestCommand</span></span></a><span class="mpre">  :: </span><a href="Network.Socks5.Types.html#loc_33_6_33_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_33_6_33_18&#39;)"><span class="hl_tyconref"><span class="mpre">SocksCommand</span></span></a><span class="mpre">
    , </span><a name="loc_36_7_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_21&#39;)"><span class="hl_fielddecl"><span class="mpre">requestDstAddr</span></span></a><span class="mpre">  :: </span><a href="Network.Socks5.Types.html#loc_53_6_53_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_53_6_53_22&#39;)"><span class="hl_tyconref"><span class="mpre">SocksHostAddress</span></span></a><span class="mpre">
    , </span><a name="loc_37_7_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_21&#39;)"><span class="hl_fielddecl"><span class="mpre">requestDstPort</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">PortNumber</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 7, srcSpanEndLine = 38, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 7, srcSpanEndLine = 38, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 3"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Define a SOCKS response</span></span><span class="mpre">
data </span><a name="loc_41_6_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_19&#39;)"><span class="hl_tycondecl"><span class="mpre">SocksResponse</span></span></a><span class="mpre"> = </span><a name="loc_41_22_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_22_41_35&#39;)"><span class="hl_condecl"><span class="mpre">SocksResponse</span></span></a><span class="mpre">
    { </span><a name="loc_42_7_42_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_20&#39;)"><span class="hl_fielddecl"><span class="mpre">responseReply</span></span></a><span class="mpre">    :: </span><a href="Network.Socks5.Types.html#loc_91_6_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_91_6_91_16&#39;)"><span class="hl_tyconref"><span class="mpre">SocksReply</span></span></a><span class="mpre">
    , </span><a name="loc_43_7_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_23&#39;)"><span class="hl_fielddecl"><span class="mpre">responseBindAddr</span></span></a><span class="mpre"> :: </span><a href="Network.Socks5.Types.html#loc_53_6_53_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_53_6_53_22&#39;)"><span class="hl_tyconref"><span class="mpre">SocksHostAddress</span></span></a><span class="mpre">
    , </span><a name="loc_44_7_44_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_23&#39;)"><span class="hl_fielddecl"><span class="mpre">responseBindPort</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">PortNumber</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 7, srcSpanEndLine = 45, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 7, srcSpanEndLine = 45, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Wire.hs&quot;, srcSpanStartLine = 4"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><a name="loc_47_1_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_8&#39;)"><span class="hl_fundecl"><span class="mpre">getAddr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><a href="Network.Socks5.Types.html#loc_54_7_54_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_54_7_54_20&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrIPV4</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord32host</span></span><span class="mpre">
</span><a href="#loc_47_1_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_8&#39;)"><span class="hl_fundecl"><span class="mpre">getAddr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> = </span><a href="Network.Socks5.Types.html#loc_55_7_55_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_55_7_55_26&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrDomainName</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getByteString</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">)
</span><a href="#loc_47_1_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_8&#39;)"><span class="hl_fundecl"><span class="mpre">getAddr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> = </span><a href="Network.Socks5.Types.html#loc_56_7_56_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_56_7_56_20&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrIPV6</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><a href="Control.Monad.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">liftM4</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(,,,)</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord32host</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord32host</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord32host</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord32host</span></span><span class="mpre">)
</span><a href="#loc_47_1_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_8&#39;)"><span class="hl_fundecl"><span class="mpre">getAddr</span></span></a><span class="mpre"> </span><a name="loc_50_9_50_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;cannot get unknown socket address type: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_50_9_50_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><a name="loc_52_1_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_8&#39;)"><span class="hl_fundecl"><span class="mpre">putAddr</span></span></a><span class="mpre"> (</span><a href="Network.Socks5.Types.html#loc_54_7_54_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_54_7_54_20&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrIPV4</span></span></a><span class="mpre"> </span><a name="loc_52_24_52_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_24_52_25&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">)         = </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">putWord32host</span></span><span class="mpre"> </span><a href="#loc_52_24_52_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_24_52_25&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
</span><a href="#loc_52_1_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_8&#39;)"><span class="hl_fundecl"><span class="mpre">putAddr</span></span></a><span class="mpre"> (</span><a href="Network.Socks5.Types.html#loc_55_7_55_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_55_7_55_26&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrDomainName</span></span></a><span class="mpre"> </span><a name="loc_53_30_53_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_30_53_31&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">)   = </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_53_30_53_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_30_53_31&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">putByteString</span></span><span class="mpre"> </span><a href="#loc_53_30_53_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_30_53_31&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
</span><a href="#loc_52_1_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_8&#39;)"><span class="hl_fundecl"><span class="mpre">putAddr</span></span></a><span class="mpre"> (</span><a href="Network.Socks5.Types.html#loc_56_7_56_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_56_7_56_20&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrIPV6</span></span></a><span class="mpre"> (</span><a name="loc_54_25_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_25_54_26&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_54_27_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_27_54_28&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,</span><a name="loc_54_29_54_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_29_54_30&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_54_31_54_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_31_54_32&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">)) = </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">putWord32host</span></span><span class="mpre"> [</span><a href="#loc_54_25_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_25_54_26&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_54_27_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_27_54_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">,</span><a href="#loc_54_29_54_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_29_54_30&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">,</span><a href="#loc_54_31_54_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_31_54_32&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">]

</span><a name="loc_56_1_56_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_16&#39;)"><span class="hl_fundecl"><span class="mpre">getSocksRequest</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> = do
    </span><a name="loc_57_5_57_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_8&#39;)"><span class="hl_vardecl"><span class="mpre">cmd</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre">
    _   &lt;- </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre">
    </span><a name="loc_59_5_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_9&#39;)"><span class="hl_vardecl"><span class="mpre">addr</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_47_1_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_8&#39;)"><span class="hl_varref"><span class="mpre">getAddr</span></span></a><span class="mpre">
    </span><a name="loc_60_5_60_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_9&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord16be</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_34_21_34_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_21_34_33&#39;)"><span class="hl_conref"><span class="mpre">SocksRequest</span></span></a><span class="mpre"> </span><a href="#loc_57_5_57_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_8&#39;)"><span class="hl_varref"><span class="mpre">cmd</span></span></a><span class="mpre"> </span><a href="#loc_59_5_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_9&#39;)"><span class="hl_varref"><span class="mpre">addr</span></span></a><span class="mpre"> </span><a href="#loc_60_5_60_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_9&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">
</span><a href="#loc_56_1_56_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_16&#39;)"><span class="hl_fundecl"><span class="mpre">getSocksRequest</span></span></a><span class="mpre"> </span><a name="loc_62_17_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_17_62_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;unsupported version of the protocol &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_62_17_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_17_62_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)

</span><a name="loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="hl_fundecl"><span class="mpre">getSocksResponse</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> = do
    </span><a name="loc_66_5_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_10&#39;)"><span class="hl_vardecl"><span class="mpre">reply</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre">
    _     &lt;- </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre">
    </span><a name="loc_68_5_68_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_9&#39;)"><span class="hl_vardecl"><span class="mpre">addr</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_47_1_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_8&#39;)"><span class="hl_varref"><span class="mpre">getAddr</span></span></a><span class="mpre">
    </span><a name="loc_69_5_69_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_9&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord16be</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_41_22_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_22_41_35&#39;)"><span class="hl_conref"><span class="mpre">SocksResponse</span></span></a><span class="mpre"> </span><a href="#loc_66_5_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_10&#39;)"><span class="hl_varref"><span class="mpre">reply</span></span></a><span class="mpre"> </span><a href="#loc_68_5_68_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_9&#39;)"><span class="hl_varref"><span class="mpre">addr</span></span></a><span class="mpre"> </span><a href="#loc_69_5_69_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_9&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">
</span><a href="#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="hl_fundecl"><span class="mpre">getSocksResponse</span></span></a><span class="mpre"> </span><a name="loc_71_18_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;unsupported version of the protocol &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_71_18_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Serialize</span></span><span class="mpre"> </span><a href="#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_16&#39;)"><span class="hl_tyconref"><span class="mpre">SocksHello</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">put</span></span><span class="mpre"> (</span><a href="#loc_25_19_25_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_19_25_29&#39;)"><span class="hl_conref"><span class="mpre">SocksHello</span></span></a><span class="mpre"> </span><a name="loc_75_21_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_23&#39;)"><span class="hl_vardecl"><span class="mpre">ms</span></span></a><span class="mpre">) = do
        </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_75_21_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_23&#39;)"><span class="hl_varref"><span class="mpre">ms</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre">) </span><a href="#loc_75_21_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_23&#39;)"><span class="hl_varref"><span class="mpre">ms</span></span></a><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">get</span></span><span class="mpre"> = do
        </span><a name="loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre">
        case </span><a href="#loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> of
            </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_25_19_25_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_19_25_29&#39;)"><span class="hl_conref"><span class="mpre">SocksHello</span></span></a><span class="mpre">
            _ -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unsupported sock hello version&quot;</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Serialize</span></span><span class="mpre"> </span><a href="#loc_30_6_30_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_24&#39;)"><span class="hl_tyconref"><span class="mpre">SocksHelloResponse</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">put</span></span><span class="mpre"> (</span><a href="#loc_30_27_30_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_27_30_45&#39;)"><span class="hl_conref"><span class="mpre">SocksHelloResponse</span></span></a><span class="mpre"> </span><a name="loc_86_29_86_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_30&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_86_29_86_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_30&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)
    </span><span class="hl_vardecl"><span class="mpre">get</span></span><span class="mpre"> = do
        </span><a name="loc_88_9_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_9_88_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre">
        case </span><a href="#loc_88_9_88_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_9_88_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> of
            </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> -&gt; </span><a href="#loc_30_27_30_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_27_30_45&#39;)"><span class="hl_conref"><span class="mpre">SocksHelloResponse</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre">
            _ -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unsupported sock hello response version&quot;</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Serialize</span></span><span class="mpre"> </span><a href="#loc_34_6_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">SocksRequest</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">put</span></span><span class="mpre"> </span><a name="loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = do
        </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_35_7_35_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_21&#39;)"><span class="hl_varref"><span class="mpre">requestCommand</span></span></a><span class="mpre"> </span><a href="#loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        </span><a href="#loc_52_1_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_8&#39;)"><span class="hl_varref"><span class="mpre">putAddr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_36_7_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_21&#39;)"><span class="hl_varref"><span class="mpre">requestDstAddr</span></span></a><span class="mpre"> </span><a href="#loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">putWord16be</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_37_7_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_21&#39;)"><span class="hl_varref"><span class="mpre">requestDstPort</span></span></a><span class="mpre"> </span><a href="#loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
        
    </span><span class="hl_vardecl"><span class="mpre">get</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_56_1_56_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_16&#39;)"><span class="hl_varref"><span class="mpre">getSocksRequest</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Serialize</span></span><span class="mpre"> </span><a href="#loc_41_6_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_19&#39;)"><span class="hl_tyconref"><span class="mpre">SocksResponse</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">put</span></span><span class="mpre"> </span><a name="loc_104_9_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_12&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = do
        </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_42_7_42_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_20&#39;)"><span class="hl_varref"><span class="mpre">responseReply</span></span></a><span class="mpre"> </span><a href="#loc_104_9_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">putWord8</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        </span><a href="#loc_52_1_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_8&#39;)"><span class="hl_varref"><span class="mpre">putAddr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_43_7_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_23&#39;)"><span class="hl_varref"><span class="mpre">responseBindAddr</span></span></a><span class="mpre"> </span><a href="#loc_104_9_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">putWord16be</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_44_7_44_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_23&#39;)"><span class="hl_varref"><span class="mpre">responseBindPort</span></span></a><span class="mpre"> </span><a href="#loc_104_9_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">get</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">getWord8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">getSocksResponse</span></span></a><span class="mpre">
</span></div></body></html>