<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, MagicHash, UnboxedTuples, NoImplicitPrelude #-}
{-# OPTIONS_HADDOCK hide #-}

#include &quot;MachDeps.h&quot;

</span><span class="hl_comment"><span class="mpre">-- Fast integer logarithms to base 2.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- integerLog2# and wordLog2# are of general usefulness,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the others are only needed for a fast implementation of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fromRational.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since they are needed in GHC.Float, we must expose this</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- module, but it should not show up in the docs.</span></span><span class="mpre">

module GHC.Integer.Logarithms.Internals
    ( integerLog2#
    , integerLog2IsPowerOf2#
    , wordLog2#
    , roundingMode#
    ) where

import GHC.Prim
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/integer-gmp-0.5.1.0/GHC/Integer/Logarithms/Internals.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 8, srcSpanEndLine = 21, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;GHC.Types&quot;"><span class="mpre">GHC.Types</span></span><span class="mpre"> (isTrue#)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/integer-gmp-0.5.1.0/GHC/Integer/Logarithms/Internals.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 8, srcSpanEndLine = 22, srcSpanEndColumn = 24}, srcInfoPoints = []}) &quot;GHC.Integer.Type&quot;"><span class="mpre">GHC.Integer.Type</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- When larger word sizes become common, add support for those,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it is not hard, just tedious.</span></span><span class="mpre">
#if (WORD_SIZE_IN_BITS != 32) &amp;&amp; (WORD_SIZE_IN_BITS != 64)

</span><span class="hl_comment"><span class="mpre">-- Less than ideal implementations for strange word sizes</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/integer-gmp-0.5.1.0/GHC/Integer/Logarithms/Internals.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 8, srcSpanEndLine = 30, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;GHC.Integer&quot;"><span class="mpre">GHC.Integer</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclDefaultDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/integer-gmp-0.5.1.0/GHC/Integer/Logarithms/Internals.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 1, srcSpanEndLine = 32, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/integer-gmp-0.5.1.0/GHC/Integer/Logarithms/Internals.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 1, srcSpanEndLine = 32, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/integer-gmp-0"><span class="mpre">default ()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- We do not know whether the word has 30 bits or 128 or even more,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- so we cannot start from the top, although that would be much more</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- efficient.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Count the bits until the highest set bit is found.</span></span><span class="mpre">
</span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="mpre">wordLog2#</span></a><span class="mpre"> :: </span><a href="GHC.Prim.html#loc_1526_6_1526_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1526_6_1526_11&#39;)"><span class="hl_tyconref"><span class="mpre">Word#</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">
</span><a name="loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_fundecl"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> </span><a name="loc_39_11_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_41_5_41_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> 8# </span><a href="#loc_39_11_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
  where
    </span><a name="loc_41_5_41_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_41_8_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_8_41_11&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_41_12_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_12_41_13&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> = case </span><a href="#loc_41_12_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_12_41_13&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1577_1_1577_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1577_1_1577_18&#39;)"><span class="hl_infix"><span class="mpre">`uncheckedShiftRL#`</span></span></a><span class="mpre"> 8# of
                0## -&gt; case </span><a href="#loc_243_1_243_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_13&#39;)"><span class="hl_varref"><span class="mpre">leadingZeros</span></span></a><span class="mpre"> of
                        </span><a href="#loc_240_11_240_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_11_240_13&#39;)"><span class="hl_conref"><span class="mpre">BA</span></span></a><span class="mpre"> </span><a name="loc_43_28_43_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_28_43_30&#39;)"><span class="hl_vardecl"><span class="mpre">ba</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_41_8_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_8_41_11&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_2021_1_2021_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2021_1_2021_16&#39;)"><span class="hl_varref"><span class="mpre">indexInt8Array#</span></span></a><span class="mpre"> </span><a href="#loc_43_28_43_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_28_43_30&#39;)"><span class="hl_varref"><span class="mpre">ba</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="hl_varref"><span class="mpre">word2Int#</span></span></a><span class="mpre"> </span><a href="#loc_41_12_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_12_41_13&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)
                </span><a name="loc_44_17_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">   -&gt; </span><a href="#loc_41_5_41_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_41_8_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_8_41_11&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1388_1_1388_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1388_1_1388_5&#39;)"><span class="hl_infix"><span class="mpre">+#</span></span></a><span class="mpre"> 8#) </span><a href="#loc_44_17_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Assumption: Integer is strictly positive</span></span><span class="mpre">
</span><a href="#loc_48_1_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_13&#39;)"><span class="mpre">integerLog2#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">
</span><a name="loc_48_1_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_13&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog2#</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">S#</span></span><span class="mpre"> </span><a name="loc_48_18_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_18_48_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1494_1_1494_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1494_1_1494_10&#39;)"><span class="hl_varref"><span class="mpre">int2Word#</span></span></a><span class="mpre"> </span><a href="#loc_48_18_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_18_48_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- that is easy</span></span><span class="mpre">
</span><a href="#loc_48_1_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_13&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog2#</span></span></a><span class="mpre"> </span><a name="loc_49_14_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_14_49_15&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = case </span><a href="#loc_58_5_58_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_49_14_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_14_49_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">smallInteger</span></span><span class="mpre"> 2#) 1# of
                    (# _, </span><a name="loc_50_27_50_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_27_50_28&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> #) -&gt; </span><a href="#loc_50_27_50_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_27_50_28&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  where
    </span><span class="hl_comment"><span class="mpre">-- Invariants:</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- pw = 2 ^ lg</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- case step n pw lg of</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   (q, e) -&gt; pw^(2*e) &lt;= n &lt; pw^(2*e+2)</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--              &amp;&amp; q &lt;= n/pw^(2*e) &lt; (q+1)</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--              &amp;&amp; q &lt; pw^2</span></span><span class="mpre">
    </span><a name="loc_58_5_58_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_9&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_58_10_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_58_12_58_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_12_58_14&#39;)"><span class="hl_vardecl"><span class="mpre">pw</span></span></a><span class="mpre"> </span><a name="loc_58_15_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_15_58_17&#39;)"><span class="hl_vardecl"><span class="mpre">lg</span></span></a><span class="mpre"> =
      if </span><a href="#loc_58_10_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`ltInteger`</span></span><span class="mpre"> </span><a href="#loc_58_12_58_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_12_58_14&#39;)"><span class="hl_varref"><span class="mpre">pw</span></span></a><span class="mpre">
        then (# </span><a href="#loc_58_10_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, 0# #)
        else case </span><a href="#loc_58_5_58_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_58_10_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_10_58_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">shiftLInteger</span></span><span class="mpre"> </span><a href="#loc_58_12_58_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_12_58_14&#39;)"><span class="hl_varref"><span class="mpre">pw</span></span></a><span class="mpre"> </span><a href="#loc_58_15_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_15_58_17&#39;)"><span class="hl_varref"><span class="mpre">lg</span></span></a><span class="mpre">) (2# </span><a href="GHC.Prim.html#loc_1398_1_1398_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1398_1_1398_5&#39;)"><span class="hl_infix"><span class="mpre">*#</span></span></a><span class="mpre"> </span><a href="#loc_58_15_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_15_58_17&#39;)"><span class="hl_varref"><span class="mpre">lg</span></span></a><span class="mpre">) of
              (# </span><a name="loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">, </span><a name="loc_62_21_62_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_21_62_22&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> #) -&gt;
                if </span><a href="#loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`ltInteger`</span></span><span class="mpre"> </span><a href="#loc_58_12_58_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_12_58_14&#39;)"><span class="hl_varref"><span class="mpre">pw</span></span></a><span class="mpre">
                  then (# </span><a href="#loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">, 2# </span><a href="GHC.Prim.html#loc_1398_1_1398_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1398_1_1398_5&#39;)"><span class="hl_infix"><span class="mpre">*#</span></span></a><span class="mpre"> </span><a href="#loc_62_21_62_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_21_62_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> #)
                  else (# </span><a href="#loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shiftRInteger`</span></span><span class="mpre"> </span><a href="#loc_58_15_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_15_58_17&#39;)"><span class="hl_varref"><span class="mpre">lg</span></span></a><span class="mpre">, 2# </span><a href="GHC.Prim.html#loc_1398_1_1398_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1398_1_1398_5&#39;)"><span class="hl_infix"><span class="mpre">*#</span></span></a><span class="mpre"> </span><a href="#loc_62_21_62_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_21_62_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1388_1_1388_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1388_1_1388_5&#39;)"><span class="hl_infix"><span class="mpre">+#</span></span></a><span class="mpre"> 1# #)

</span><span class="hl_comment"><span class="mpre">-- Calculate the log2 of a positive integer and check</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- whether it is a power of 2.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- By coincidence, the presence of a power of 2 is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- signalled by zero and not one.</span></span><span class="mpre">
</span><a href="#loc_72_1_72_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_23&#39;)"><span class="mpre">integerLog2IsPowerOf2#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (# </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">, </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre"> #)
</span><a name="loc_72_1_72_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_23&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog2IsPowerOf2#</span></span></a><span class="mpre"> </span><a name="loc_72_24_72_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_24_72_25&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> =
    case </span><a href="#loc_48_1_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_13&#39;)"><span class="hl_varref"><span class="mpre">integerLog2#</span></span></a><span class="mpre"> </span><a href="#loc_72_24_72_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_24_72_25&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> of
      </span><a name="loc_74_7_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_9&#39;)"><span class="hl_vardecl"><span class="mpre">lg</span></span></a><span class="mpre"> -&gt; if </span><a href="#loc_72_24_72_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_24_72_25&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`eqInteger`</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">smallInteger</span></span><span class="mpre"> 1# </span><span class="hl_infix"><span class="mpre">`shiftLInteger`</span></span><span class="mpre"> </span><a href="#loc_74_7_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_9&#39;)"><span class="hl_varref"><span class="mpre">lg</span></span></a><span class="mpre">)
              then (# </span><a href="#loc_74_7_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_9&#39;)"><span class="hl_varref"><span class="mpre">lg</span></span></a><span class="mpre">, 0# #)
              else (# </span><a href="#loc_74_7_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_9&#39;)"><span class="hl_varref"><span class="mpre">lg</span></span></a><span class="mpre">, 1# #)

</span><span class="hl_comment"><span class="mpre">-- Detect the rounding mode,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 0# means round to zero,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 1# means round to even,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 2# means round away from zero</span></span><span class="mpre">
</span><a href="#loc_83_1_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_14&#39;)"><span class="mpre">roundingMode#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">
</span><a name="loc_83_1_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_14&#39;)"><span class="hl_fundecl"><span class="mpre">roundingMode#</span></span></a><span class="mpre"> </span><a name="loc_83_15_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_15_83_16&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_83_17_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_18&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> =
    case </span><span class="hl_varref"><span class="mpre">smallInteger</span></span><span class="mpre"> 1# </span><span class="hl_infix"><span class="mpre">`shiftLInteger`</span></span><span class="mpre"> </span><a href="#loc_83_17_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_18&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> of
      </span><a name="loc_85_7_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_8&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_83_15_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_15_83_16&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`andInteger`</span></span><span class="mpre">
                ((</span><a href="#loc_85_7_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusInteger`</span></span><span class="mpre"> </span><a href="#loc_85_7_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`minusInteger`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">smallInteger</span></span><span class="mpre"> 1#) of
             </span><a name="loc_87_14_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_15&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt;
               if </span><a href="#loc_85_7_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`ltInteger`</span></span><span class="mpre"> </span><a href="#loc_87_14_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_15&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                 then 2#
                 else if </span><a href="#loc_85_7_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`gtInteger`</span></span><span class="mpre"> </span><a href="#loc_87_14_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_15&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                        then 0#
                        else 1#

#else

</span><span class="warning" data-warning="DeclDefaultDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/integer-gmp-0.5.1.0/GHC/Integer/Logarithms/Internals.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 1, srcSpanEndLine = 96, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/integer-gmp-0.5.1.0/GHC/Integer/Logarithms/Internals.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 1, srcSpanEndLine = 96, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/integer-gmp-0"><span class="mpre">default ()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- We have a nice word size, we can do much better now.</span></span><span class="mpre">

#if WORD_SIZE_IN_BITS == 32

#define WSHIFT 5
#define MMASK 31

#else

#define WSHIFT 6
#define MMASK 63

#endif

</span><span class="hl_comment"><span class="mpre">-- Assumption: Integer is strictly positive</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For small integers, use wordLog#,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in the general case, check words from the most</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- significant down, once a nonzero word is found,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- calculate its log2 and add the number of following bits.</span></span><span class="mpre">
</span><a href="#loc_48_1_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_13&#39;)"><span class="mpre">integerLog2#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">
</span><a name="loc_118_1_118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_13&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog2#</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">S#</span></span><span class="mpre"> </span><a name="loc_118_18_118_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_18_118_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1494_1_1494_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1494_1_1494_10&#39;)"><span class="hl_varref"><span class="mpre">int2Word#</span></span></a><span class="mpre"> </span><a href="#loc_118_18_118_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_18_118_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
</span><a href="#loc_118_1_118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_13&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog2#</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">J#</span></span><span class="mpre"> </span><a name="loc_119_18_119_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_18_119_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_119_20_119_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_20_119_22&#39;)"><span class="hl_vardecl"><span class="mpre">ba</span></span></a><span class="mpre">) = </span><a href="#loc_121_5_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> (</span><a href="#loc_119_18_119_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_18_119_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 1#)
  where
    </span><a name="loc_121_5_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_10&#39;)"><span class="hl_fundecl"><span class="mpre">check</span></span></a><span class="mpre"> </span><a name="loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = case </span><a href="GHC.Prim.html#loc_2006_1_2006_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2006_1_2006_16&#39;)"><span class="hl_varref"><span class="mpre">indexWordArray#</span></span></a><span class="mpre"> </span><a href="#loc_119_20_119_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_20_119_22&#39;)"><span class="hl_varref"><span class="mpre">ba</span></span></a><span class="mpre"> </span><a href="#loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
                0## -&gt; </span><a href="#loc_121_5_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> (</span><a href="#loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 1#)
                </span><a name="loc_123_17_123_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_17_123_18&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">   -&gt; </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> </span><a href="#loc_123_17_123_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_17_123_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1388_1_1388_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1388_1_1388_5&#39;)"><span class="hl_infix"><span class="mpre">+#</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1512_1_1512_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1512_1_1512_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedIShiftL#</span></span></a><span class="mpre"> </span><a href="#loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">WSHIFT#</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Assumption: Integer is strictly positive</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- First component is log2 n, second is 0# iff n is a power of two</span></span><span class="mpre">
</span><a href="#loc_72_1_72_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_23&#39;)"><span class="mpre">integerLog2IsPowerOf2#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (# </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">, </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre"> #)
</span><span class="hl_comment"><span class="mpre">-- The power of 2 test is n&amp;(n-1) == 0, thus powers of 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are indicated bythe second component being zero.</span></span><span class="mpre">
</span><a name="loc_130_1_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_23&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog2IsPowerOf2#</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">S#</span></span><span class="mpre"> </span><a name="loc_130_28_130_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_28_130_29&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) =
    case </span><a href="GHC.Prim.html#loc_1494_1_1494_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1494_1_1494_10&#39;)"><span class="hl_varref"><span class="mpre">int2Word#</span></span></a><span class="mpre"> </span><a href="#loc_130_28_130_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_28_130_29&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
      </span><a name="loc_132_7_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_7_132_8&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt; (# </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> </span><a href="#loc_132_7_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_7_132_8&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">, </span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="hl_varref"><span class="mpre">word2Int#</span></span></a><span class="mpre"> (</span><a href="#loc_132_7_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_7_132_8&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1556_1_1556_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1556_1_1556_5&#39;)"><span class="hl_infix"><span class="mpre">`and#`</span></span></a><span class="mpre"> (</span><a href="#loc_132_7_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_7_132_8&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1535_1_1535_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1535_1_1535_11&#39;)"><span class="hl_infix"><span class="mpre">`minusWord#`</span></span></a><span class="mpre"> 1##)) #)
</span><span class="hl_comment"><span class="mpre">-- Find the log2 as above, test whether that word is a power</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of 2, if so, check whether only zero bits follow.</span></span><span class="mpre">
</span><a href="#loc_130_1_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_23&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog2IsPowerOf2#</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">J#</span></span><span class="mpre"> </span><a name="loc_135_28_135_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_28_135_29&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_135_30_135_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_30_135_32&#39;)"><span class="hl_vardecl"><span class="mpre">ba</span></span></a><span class="mpre">) = </span><a href="#loc_138_5_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> (</span><a href="#loc_135_28_135_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_28_135_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 1#)
  where
    </span><a href="#loc_138_5_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_10&#39;)"><span class="mpre">check</span></a><span class="mpre"> :: </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre"> -&gt; (# </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">, </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre"> #)
    </span><a name="loc_138_5_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_10&#39;)"><span class="hl_fundecl"><span class="mpre">check</span></span></a><span class="mpre"> </span><a name="loc_138_11_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_11_138_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = case </span><a href="GHC.Prim.html#loc_2006_1_2006_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2006_1_2006_16&#39;)"><span class="hl_varref"><span class="mpre">indexWordArray#</span></span></a><span class="mpre"> </span><a href="#loc_135_30_135_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_30_135_32&#39;)"><span class="hl_varref"><span class="mpre">ba</span></span></a><span class="mpre"> </span><a href="#loc_138_11_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_11_138_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
                0## -&gt; </span><a href="#loc_138_5_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> (</span><a href="#loc_138_11_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_11_138_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 1#)
                </span><a name="loc_140_17_140_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_18&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">   -&gt; (# </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> </span><a href="#loc_140_17_140_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1388_1_1388_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1388_1_1388_5&#39;)"><span class="hl_infix"><span class="mpre">+#</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1512_1_1512_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1512_1_1512_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedIShiftL#</span></span></a><span class="mpre"> </span><a href="#loc_138_11_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_11_138_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">WSHIFT#</span></span><span class="mpre">)
                        , case </span><a href="#loc_140_17_140_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1556_1_1556_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1556_1_1556_5&#39;)"><span class="hl_infix"><span class="mpre">`and#`</span></span></a><span class="mpre"> (</span><a href="#loc_140_17_140_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1535_1_1535_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1535_1_1535_11&#39;)"><span class="hl_infix"><span class="mpre">`minusWord#`</span></span></a><span class="mpre"> 1##) of
                            0## -&gt; </span><a href="#loc_145_5_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_5_145_9&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> (</span><a href="#loc_138_11_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_11_138_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 1#)
                            _   -&gt; 1# #)
    </span><a href="#loc_145_5_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_5_145_9&#39;)"><span class="mpre">test</span></a><span class="mpre"> :: </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">
    </span><a name="loc_145_5_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_5_145_9&#39;)"><span class="hl_fundecl"><span class="mpre">test</span></span></a><span class="mpre"> </span><a name="loc_145_10_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_145_10_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1484_1_1484_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1484_1_1484_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;#</span></span></a><span class="mpre"> 0#)
                then 0#
                else case </span><a href="GHC.Prim.html#loc_2006_1_2006_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2006_1_2006_16&#39;)"><span class="hl_varref"><span class="mpre">indexWordArray#</span></span></a><span class="mpre"> </span><a href="#loc_135_30_135_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_30_135_32&#39;)"><span class="hl_varref"><span class="mpre">ba</span></span></a><span class="mpre"> </span><a href="#loc_145_10_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
                        0## -&gt; </span><a href="#loc_145_5_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_5_145_9&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> (</span><a href="#loc_145_10_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 1#)
                        _   -&gt; 1#

</span><span class="hl_comment"><span class="mpre">-- Assumption: Integer and Int# are strictly positive, Int# is less</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- than logBase 2 of Integer, otherwise havoc ensues.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Used only for the numerator in fromRational when the denominator</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is a power of 2.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The Int# argument is log2 n minus the number of bits in the mantissa</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of the target type, i.e. the index of the first non-integral bit in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the quotient.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 0# means round down (towards zero)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 1# means we have a half-integer, round to even</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 2# means round up (away from zero)</span></span><span class="mpre">
</span><a href="#loc_83_1_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_14&#39;)"><span class="mpre">roundingMode#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">
</span><a name="loc_163_1_163_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_14&#39;)"><span class="hl_fundecl"><span class="mpre">roundingMode#</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">S#</span></span><span class="mpre"> </span><a name="loc_163_19_163_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_19_163_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) </span><a name="loc_163_22_163_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_22_163_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> =
    case </span><a href="GHC.Prim.html#loc_1494_1_1494_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1494_1_1494_10&#39;)"><span class="hl_varref"><span class="mpre">int2Word#</span></span></a><span class="mpre"> </span><a href="#loc_163_19_163_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_19_163_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1556_1_1556_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1556_1_1556_5&#39;)"><span class="hl_infix"><span class="mpre">`and#`</span></span></a><span class="mpre"> ((</span><a href="GHC.Prim.html#loc_1571_1_1571_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1571_1_1571_17&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftL#</span></span></a><span class="mpre"> 2## </span><a href="#loc_163_22_163_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_22_163_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="GHC.Prim.html#loc_1535_1_1535_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1535_1_1535_11&#39;)"><span class="hl_infix"><span class="mpre">`minusWord#`</span></span></a><span class="mpre"> 1##) of
      </span><a name="loc_165_7_165_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_7_165_8&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; case </span><a href="GHC.Prim.html#loc_1571_1_1571_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1571_1_1571_17&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftL#</span></span></a><span class="mpre"> 1## </span><a href="#loc_163_22_163_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_22_163_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> of
            </span><a name="loc_166_13_166_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_13_166_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_166_13_166_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_13_166_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1583_1_1583_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1583_1_1583_8&#39;)"><span class="hl_infix"><span class="mpre">`gtWord#`</span></span></a><span class="mpre"> </span><a href="#loc_165_7_165_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_7_165_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
                    then 0#
                    else if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_166_13_166_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_13_166_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1595_1_1595_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1595_1_1595_8&#39;)"><span class="hl_infix"><span class="mpre">`ltWord#`</span></span></a><span class="mpre"> </span><a href="#loc_165_7_165_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_7_165_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
                            then 2#
                            else 1#
</span><a href="#loc_163_1_163_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_14&#39;)"><span class="hl_fundecl"><span class="mpre">roundingMode#</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">J#</span></span><span class="mpre"> _ </span><a name="loc_171_21_171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_21_171_23&#39;)"><span class="hl_vardecl"><span class="mpre">ba</span></span></a><span class="mpre">) </span><a name="loc_171_25_171_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_25_171_26&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> =
    case </span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="hl_varref"><span class="mpre">word2Int#</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1494_1_1494_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1494_1_1494_10&#39;)"><span class="hl_varref"><span class="mpre">int2Word#</span></span></a><span class="mpre"> </span><a href="#loc_171_25_171_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_25_171_26&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1556_1_1556_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1556_1_1556_5&#39;)"><span class="hl_infix"><span class="mpre">`and#`</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">MMASK</span></span><span class="hl_infix"><span class="mpre">##</span></span><span class="mpre">) of
      </span><a name="loc_173_7_173_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_7_173_8&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> -&gt;      </span><span class="hl_comment"><span class="mpre">-- index of relevant bit in word</span></span><span class="mpre">
        case </span><a href="GHC.Prim.html#loc_1518_1_1518_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1518_1_1518_19&#39;)"><span class="hl_varref"><span class="mpre">uncheckedIShiftRA#</span></span></a><span class="mpre"> </span><a href="#loc_171_25_171_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_25_171_26&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">WSHIFT#</span></span><span class="mpre"> of
          </span><a name="loc_175_11_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_11_175_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt;  </span><span class="hl_comment"><span class="mpre">-- index of relevant word</span></span><span class="mpre">
            case </span><a href="GHC.Prim.html#loc_2006_1_2006_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2006_1_2006_16&#39;)"><span class="hl_varref"><span class="mpre">indexWordArray#</span></span></a><span class="mpre"> </span><a href="#loc_171_21_171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_21_171_23&#39;)"><span class="hl_varref"><span class="mpre">ba</span></span></a><span class="mpre"> </span><a href="#loc_175_11_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_11_175_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1556_1_1556_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1556_1_1556_5&#39;)"><span class="hl_infix"><span class="mpre">`and#`</span></span></a><span class="mpre">
                    ((</span><a href="GHC.Prim.html#loc_1571_1_1571_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1571_1_1571_17&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftL#</span></span></a><span class="mpre"> 2## </span><a href="#loc_173_7_173_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_7_173_8&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">) </span><a href="GHC.Prim.html#loc_1535_1_1535_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1535_1_1535_11&#39;)"><span class="hl_infix"><span class="mpre">`minusWord#`</span></span></a><span class="mpre"> 1##) of
              </span><a name="loc_178_15_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_15_178_16&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt;
                case </span><a href="GHC.Prim.html#loc_1571_1_1571_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1571_1_1571_17&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftL#</span></span></a><span class="mpre"> 1## </span><a href="#loc_173_7_173_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_7_173_8&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> of
                  </span><a name="loc_180_19_180_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_19_180_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_180_19_180_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_19_180_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1583_1_1583_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1583_1_1583_8&#39;)"><span class="hl_infix"><span class="mpre">`gtWord#`</span></span></a><span class="mpre"> </span><a href="#loc_178_15_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_15_178_16&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
                        then 0#
                        else if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_180_19_180_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_19_180_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1595_1_1595_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1595_1_1595_8&#39;)"><span class="hl_infix"><span class="mpre">`ltWord#`</span></span></a><span class="mpre"> </span><a href="#loc_178_15_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_15_178_16&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
                                then 2#
                                else </span><a href="#loc_186_5_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_5_186_9&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> (</span><a href="#loc_175_11_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_11_175_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 1#)
  where
    </span><a name="loc_186_5_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_5_186_9&#39;)"><span class="hl_fundecl"><span class="mpre">test</span></span></a><span class="mpre"> </span><a name="loc_186_10_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_10_186_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_186_10_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_10_186_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1484_1_1484_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1484_1_1484_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;#</span></span></a><span class="mpre"> 0#)
                then 1#
                else case </span><a href="GHC.Prim.html#loc_2006_1_2006_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2006_1_2006_16&#39;)"><span class="hl_varref"><span class="mpre">indexWordArray#</span></span></a><span class="mpre"> </span><a href="#loc_171_21_171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_21_171_23&#39;)"><span class="hl_varref"><span class="mpre">ba</span></span></a><span class="mpre"> </span><a href="#loc_186_10_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_10_186_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
                        0## -&gt; </span><a href="#loc_186_5_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_5_186_9&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> (</span><a href="#loc_186_10_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_10_186_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 1#)
                        _   -&gt; 2#

</span><span class="hl_comment"><span class="mpre">-- wordLog2# 0## = -1#</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="mpre">wordLog2#</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="mpre">wordLog2#</span></a><span class="mpre"> :: </span><a href="GHC.Prim.html#loc_1526_6_1526_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1526_6_1526_11&#39;)"><span class="hl_tyconref"><span class="mpre">Word#</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_1384_6_1384_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1384_6_1384_10&#39;)"><span class="hl_tyconref"><span class="mpre">Int#</span></span></a><span class="mpre">
</span><span class="hl_fundecl"><span class="mpre">wordLog2#</span></span><span class="mpre"> </span><a name="loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> =
  case </span><a href="#loc_243_1_243_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_13&#39;)"><span class="hl_varref"><span class="mpre">leadingZeros</span></span></a><span class="mpre"> of
   </span><a href="#loc_240_11_240_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_11_240_13&#39;)"><span class="hl_conref"><span class="mpre">BA</span></span></a><span class="mpre"> </span><a name="loc_197_7_197_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_7_197_9&#39;)"><span class="hl_vardecl"><span class="mpre">lz</span></span></a><span class="mpre"> -&gt;
    let </span><a name="loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_fundecl"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a name="loc_198_15_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_16&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> = </span><a href="GHC.Prim.html#loc_2021_1_2021_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2021_1_2021_16&#39;)"><span class="hl_varref"><span class="mpre">indexInt8Array#</span></span></a><span class="mpre"> </span><a href="#loc_197_7_197_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_7_197_9&#39;)"><span class="hl_varref"><span class="mpre">lz</span></span></a><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="hl_varref"><span class="mpre">word2Int#</span></span></a><span class="mpre"> </span><a href="#loc_198_15_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) in
#if WORD_SIZE_IN_BITS == 64
    case </span><a href="GHC.Prim.html#loc_1577_1_1577_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1577_1_1577_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span></a><span class="mpre"> </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 56# of
     </span><a name="loc_201_6_201_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_6_201_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt;
      if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_201_6_201_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_6_201_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1592_1_1592_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1592_1_1592_8&#39;)"><span class="hl_infix"><span class="mpre">`neWord#`</span></span></a><span class="mpre"> 0##)
       then 64# </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_201_6_201_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_6_201_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
       else
        case </span><a href="GHC.Prim.html#loc_1577_1_1577_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1577_1_1577_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span></a><span class="mpre"> </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 48# of
         </span><a name="loc_206_10_206_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_10_206_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt;
          if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_206_10_206_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_10_206_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1592_1_1592_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1592_1_1592_8&#39;)"><span class="hl_infix"><span class="mpre">`neWord#`</span></span></a><span class="mpre"> 0##)
           then 56# </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_206_10_206_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_10_206_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
           else
            case </span><a href="GHC.Prim.html#loc_1577_1_1577_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1577_1_1577_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span></a><span class="mpre"> </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 40# of
             </span><a name="loc_211_14_211_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_14_211_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt;
              if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_211_14_211_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_14_211_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1592_1_1592_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1592_1_1592_8&#39;)"><span class="hl_infix"><span class="mpre">`neWord#`</span></span></a><span class="mpre"> 0##)
               then 48# </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_211_14_211_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_14_211_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
               else
                case </span><a href="GHC.Prim.html#loc_1577_1_1577_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1577_1_1577_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span></a><span class="mpre"> </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 32# of
                 </span><a name="loc_216_18_216_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_18_216_19&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> -&gt;
                  if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_216_18_216_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_18_216_19&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1592_1_1592_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1592_1_1592_8&#39;)"><span class="hl_infix"><span class="mpre">`neWord#`</span></span></a><span class="mpre"> 0##)
                   then 40# </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_216_18_216_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_18_216_19&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
                   else
#endif
                    case </span><a href="GHC.Prim.html#loc_1577_1_1577_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1577_1_1577_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span></a><span class="mpre"> </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 24# of
                     </span><a name="loc_222_22_222_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_22_222_23&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
                      if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_222_22_222_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_22_222_23&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1592_1_1592_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1592_1_1592_8&#39;)"><span class="hl_infix"><span class="mpre">`neWord#`</span></span></a><span class="mpre"> 0##)
                       then 32# </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_222_22_222_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_22_222_23&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                       else
                        case </span><a href="GHC.Prim.html#loc_1577_1_1577_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1577_1_1577_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span></a><span class="mpre"> </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 16# of
                         </span><a name="loc_227_26_227_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_26_227_27&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt;
                          if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_227_26_227_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_26_227_27&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1592_1_1592_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1592_1_1592_8&#39;)"><span class="hl_infix"><span class="mpre">`neWord#`</span></span></a><span class="mpre"> 0##)
                           then 24# </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_227_26_227_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_26_227_27&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
                           else
                            case </span><a href="GHC.Prim.html#loc_1577_1_1577_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1577_1_1577_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span></a><span class="mpre"> </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 8# of
                             </span><a name="loc_232_30_232_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_30_232_31&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> -&gt;
                              if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_232_30_232_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_30_232_31&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1592_1_1592_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1592_1_1592_8&#39;)"><span class="hl_infix"><span class="mpre">`neWord#`</span></span></a><span class="mpre"> 0##)
                               then 16# </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_232_30_232_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_30_232_31&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                               else 8# </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">

#endif

</span><span class="hl_comment"><span class="mpre">-- Lookup table</span></span><span class="mpre">
data </span><a name="loc_240_6_240_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_6_240_8&#39;)"><span class="hl_tycondecl"><span class="mpre">BA</span></span></a><span class="mpre"> = </span><a name="loc_240_11_240_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_11_240_13&#39;)"><span class="hl_condecl"><span class="mpre">BA</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1949_6_1949_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1949_6_1949_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteArray#</span></span></a><span class="mpre">

</span><a href="#loc_243_1_243_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_13&#39;)"><span class="mpre">leadingZeros</span></a><span class="mpre"> :: </span><a href="#loc_240_6_240_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_6_240_8&#39;)"><span class="hl_tyconref"><span class="mpre">BA</span></span></a><span class="mpre">
</span><a name="loc_243_1_243_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_13&#39;)"><span class="hl_vardecl"><span class="mpre">leadingZeros</span></span></a><span class="mpre"> =
    let </span><a name="loc_244_9_244_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_9_244_14&#39;)"><span class="hl_fundecl"><span class="mpre">mkArr</span></span></a><span class="mpre"> </span><a name="loc_244_15_244_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_15_244_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
          case </span><a href="GHC.Prim.html#loc_1957_1_1957_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1957_1_1957_14&#39;)"><span class="hl_varref"><span class="mpre">newByteArray#</span></span></a><span class="mpre"> 256# </span><a href="#loc_244_15_244_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_15_244_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
            (# </span><a name="loc_246_16_246_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_16_246_18&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre">, </span><a name="loc_246_20_246_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_23&#39;)"><span class="hl_vardecl"><span class="mpre">mba</span></span></a><span class="mpre"> #) -&gt;
              case </span><a href="GHC.Prim.html#loc_2125_1_2125_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2125_1_2125_16&#39;)"><span class="hl_varref"><span class="mpre">writeInt8Array#</span></span></a><span class="mpre"> </span><a href="#loc_246_20_246_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_23&#39;)"><span class="hl_varref"><span class="mpre">mba</span></span></a><span class="mpre"> 0# 9# </span><a href="#loc_246_16_246_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_16_246_18&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> of
                </span><a name="loc_248_17_248_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_17_248_19&#39;)"><span class="hl_vardecl"><span class="mpre">s2</span></span></a><span class="mpre"> -&gt;
                  let </span><a name="loc_249_23_249_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_23_249_28&#39;)"><span class="hl_fundecl"><span class="mpre">fillA</span></span></a><span class="mpre"> </span><a name="loc_249_29_249_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_29_249_32&#39;)"><span class="hl_vardecl"><span class="mpre">lim</span></span></a><span class="mpre"> </span><a name="loc_249_33_249_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_33_249_36&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> </span><a name="loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a name="loc_249_41_249_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_41_249_43&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> =
                        if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1476_1_1476_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1476_1_1476_6&#39;)"><span class="hl_infix"><span class="mpre">==#</span></span></a><span class="mpre"> 256#)
                          then </span><a href="#loc_249_41_249_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_41_249_43&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">
                          else if </span><span class="hl_varref"><span class="mpre">isTrue#</span></span><span class="mpre"> (</span><a href="#loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1484_1_1484_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1484_1_1484_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;#</span></span></a><span class="mpre"> </span><a href="#loc_249_29_249_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_29_249_32&#39;)"><span class="hl_varref"><span class="mpre">lim</span></span></a><span class="mpre">)
                                then case </span><a href="GHC.Prim.html#loc_2125_1_2125_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2125_1_2125_16&#39;)"><span class="hl_varref"><span class="mpre">writeInt8Array#</span></span></a><span class="mpre"> </span><a href="#loc_246_20_246_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_23&#39;)"><span class="hl_varref"><span class="mpre">mba</span></span></a><span class="mpre"> </span><a href="#loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_249_33_249_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_33_249_36&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> </span><a href="#loc_249_41_249_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_41_249_43&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> of
                                        </span><a name="loc_254_41_254_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_41_254_43&#39;)"><span class="hl_vardecl"><span class="mpre">nx</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_249_23_249_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_23_249_28&#39;)"><span class="hl_varref"><span class="mpre">fillA</span></span></a><span class="mpre"> </span><a href="#loc_249_29_249_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_29_249_32&#39;)"><span class="hl_varref"><span class="mpre">lim</span></span></a><span class="mpre"> </span><a href="#loc_249_33_249_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_33_249_36&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> (</span><a href="#loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1388_1_1388_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1388_1_1388_5&#39;)"><span class="hl_infix"><span class="mpre">+#</span></span></a><span class="mpre"> 1#) </span><a href="#loc_254_41_254_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_41_254_43&#39;)"><span class="hl_varref"><span class="mpre">nx</span></span></a><span class="mpre">
                                else </span><a href="#loc_249_23_249_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_23_249_28&#39;)"><span class="hl_varref"><span class="mpre">fillA</span></span></a><span class="mpre"> (2# </span><a href="GHC.Prim.html#loc_1398_1_1398_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1398_1_1398_5&#39;)"><span class="hl_infix"><span class="mpre">*#</span></span></a><span class="mpre"> </span><a href="#loc_249_29_249_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_29_249_32&#39;)"><span class="hl_varref"><span class="mpre">lim</span></span></a><span class="mpre">) (</span><a href="#loc_249_33_249_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_33_249_36&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 1#) </span><a href="#loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_249_41_249_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_41_249_43&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">
                  in case </span><a href="#loc_249_23_249_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_23_249_28&#39;)"><span class="hl_varref"><span class="mpre">fillA</span></span></a><span class="mpre"> 2# 8# 1# </span><a href="#loc_248_17_248_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_17_248_19&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="mpre"> of
                      </span><a name="loc_257_23_257_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_23_257_25&#39;)"><span class="hl_vardecl"><span class="mpre">s3</span></span></a><span class="mpre"> -&gt; case </span><a href="GHC.Prim.html#loc_1980_1_1980_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1980_1_1980_23&#39;)"><span class="hl_varref"><span class="mpre">unsafeFreezeByteArray#</span></span></a><span class="mpre"> </span><a href="#loc_246_20_246_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_23&#39;)"><span class="hl_varref"><span class="mpre">mba</span></span></a><span class="mpre"> </span><a href="#loc_257_23_257_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_23_257_25&#39;)"><span class="hl_varref"><span class="mpre">s3</span></span></a><span class="mpre"> of
                              (# _, </span><a name="loc_258_37_258_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_37_258_39&#39;)"><span class="hl_vardecl"><span class="mpre">ba</span></span></a><span class="mpre"> #) -&gt; </span><a href="#loc_258_37_258_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_37_258_39&#39;)"><span class="hl_varref"><span class="mpre">ba</span></span></a><span class="mpre">
    in case </span><a href="#loc_244_9_244_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_9_244_14&#39;)"><span class="hl_varref"><span class="mpre">mkArr</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">realWorld#</span></span><span class="mpre"> of
        </span><a name="loc_260_9_260_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_9_260_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_240_11_240_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_11_240_13&#39;)"><span class="hl_conref"><span class="mpre">BA</span></span></a><span class="mpre"> </span><a href="#loc_260_9_260_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_9_260_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
</span></div></body></html>