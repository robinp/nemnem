<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module TestData.Graph ( randomGraph )
where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/vector-0.10.11.0/benchmarks/TestData/Graph.hs&quot;, srcSpanStartLine = 4, srcSpanStartColumn = 8, srcSpanEndLine = 4, srcSpanEndColumn = 25}, srcInfoPoints = []}) &quot;System.Random.MWC&quot;"><span class="mpre">System.Random.MWC</span></span><span class="mpre">
import qualified Data.Array.ST as STA
import qualified Data.Vector.Unboxed as V

import Control.Monad.ST ( ST, runST )

</span><a href="#loc_11_1_11_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_1_11_12&#39;)"><span class="mpre">randomGraph</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">V.Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">V.Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_11_1_11_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_1_11_12&#39;)"><span class="hl_fundecl"><span class="mpre">randomGraph</span></span></a><span class="mpre"> </span><a name="loc_11_13_11_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_13_11_14&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">
  = </span><span class="hl_varref"><span class="mpre">runST</span></span><span class="mpre"> (
    do
      </span><a name="loc_14_7_14_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_7_14_8&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">create</span></span><span class="mpre">
      </span><a name="loc_15_7_15_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_10&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">STA.newArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_22_5_22_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) [] :: </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">STA.STArray</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">])
      </span><a href="#loc_25_1_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_15&#39;)"><span class="hl_varref"><span class="mpre">addRandomEdges</span></span></a><span class="mpre"> </span><a href="#loc_22_5_22_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_14_7_14_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_7_14_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_15_7_15_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_10&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_11_13_11_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_13_11_14&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
      </span><a name="loc_17_7_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_7_17_9&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">STA.getAssocs</span></span><span class="mpre"> </span><a href="#loc_15_7_15_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_10&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre">
      let (</span><a name="loc_18_12_18_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_12_18_14&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">,</span><a name="loc_18_15_18_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_15_18_17&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">unzip</span></span><span class="mpre"> [(</span><a href="#loc_18_37_18_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_37_18_38&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">,</span><a href="#loc_18_50_18_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_50_18_51&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">) | (</span><a name="loc_18_37_18_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_37_18_38&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">,</span><a name="loc_18_39_18_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_39_18_41&#39;)"><span class="hl_vardecl"><span class="mpre">js</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_17_7_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_7_17_9&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">, </span><a name="loc_18_50_18_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_50_18_51&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_18_39_18_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_39_18_41&#39;)"><span class="hl_varref"><span class="mpre">js</span></span></a><span class="mpre"> ]
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_22_5_22_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="Data.Vector.Unboxed.html#loc_1339_1_1339_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_1339_1_1339_10&#39;)"><span class="hl_varref"><span class="mpre">V.fromListN</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_18_12_18_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_12_18_14&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">) </span><a href="#loc_18_12_18_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_12_18_14&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">, </span><a href="Data.Vector.Unboxed.html#loc_1339_1_1339_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_1339_1_1339_10&#39;)"><span class="hl_varref"><span class="mpre">V.fromListN</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_18_15_18_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_15_18_17&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a href="#loc_18_15_18_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_15_18_17&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
    )
  where
    </span><a name="loc_22_5_22_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_6&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_11_13_11_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_13_11_14&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">

</span><a href="#loc_25_1_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_15&#39;)"><span class="mpre">addRandomEdges</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Gen</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">STA.STArray</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_25_1_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_15&#39;)"><span class="hl_fundecl"><span class="mpre">addRandomEdges</span></span></a><span class="mpre"> </span><a name="loc_25_16_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_25_18_25_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_18_25_19&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_25_20_25_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_20_25_23&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> = </span><a href="#loc_27_5_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_9&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre">
  where
    </span><a name="loc_27_5_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_9&#39;)"><span class="hl_fundecl"><span class="mpre">fill</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_27_5_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_9&#39;)"><span class="hl_fundecl"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a name="loc_28_10_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_10_28_11&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">
      = do
          </span><a name="loc_30_11_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_11_30_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_41_5_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_17&#39;)"><span class="hl_varref"><span class="mpre">random_index</span></span></a><span class="mpre">
          </span><a name="loc_31_11_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_11_31_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_41_5_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_17&#39;)"><span class="hl_varref"><span class="mpre">random_index</span></span></a><span class="mpre">
          let </span><a name="loc_32_15_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_15_32_17&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_30_11_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_11_30_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_31_11_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_11_31_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
              </span><a name="loc_33_15_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_17&#39;)"><span class="hl_vardecl"><span class="mpre">hi</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_30_11_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_11_30_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_31_11_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_11_31_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
          </span><a name="loc_34_11_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_11_34_13&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">STA.readArray</span></span><span class="mpre"> </span><a href="#loc_25_20_25_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_20_25_23&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_32_15_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_15_32_17&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre">
          if </span><a href="#loc_32_15_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_15_32_17&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_33_15_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_17&#39;)"><span class="hl_varref"><span class="mpre">hi</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_33_15_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_17&#39;)"><span class="hl_varref"><span class="mpre">hi</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_34_11_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_11_34_13&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">
            then </span><a href="#loc_27_5_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_9&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a href="#loc_28_10_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_10_28_11&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
            else do
                   </span><span class="hl_varref"><span class="mpre">STA.writeArray</span></span><span class="mpre"> </span><a href="#loc_25_20_25_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_20_25_23&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_32_15_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_15_32_17&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre"> (</span><a href="#loc_33_15_33_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_17&#39;)"><span class="hl_varref"><span class="mpre">hi</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_34_11_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_11_34_13&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">)
                   </span><a href="#loc_27_5_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_9&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> (</span><a href="#loc_28_10_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_10_28_11&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

    </span><a name="loc_41_5_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_17&#39;)"><span class="hl_vardecl"><span class="mpre">random_index</span></span></a><span class="mpre"> = do
                     </span><a name="loc_42_22_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_22_42_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">uniform</span></span><span class="mpre"> </span><a href="#loc_25_18_25_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_18_25_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                     let </span><a name="loc_43_26_43_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_26_43_27&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">floor</span></span><span class="mpre"> ((</span><a href="#loc_42_22_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_22_42_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_25_16_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
                     if </span><a href="#loc_43_26_43_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_26_43_27&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_25_16_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_43_26_43_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_26_43_27&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span></div></body></html>