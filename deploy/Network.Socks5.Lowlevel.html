<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Network.Socks5.Lowlevel
    ( resolveToSockAddr
    , socksListen
    </span><span class="hl_comment"><span class="mpre">-- * lowlevel types</span></span><span class="mpre">
    , module Network.Socks5.Wire
    , module Network.Socks5.Command
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Lowlevel.hs&quot;, srcSpanStartLine = 9, srcSpanStartColumn = 8, srcSpanEndLine = 9, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Lowlevel.hs&quot;, srcSpanStartLine = 10, srcSpanStartColumn = 8, srcSpanEndLine = 10, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Network.BSD&quot;"><span class="mpre">Network.BSD</span></span><span class="mpre">
import Network.Socks5.Command
import Network.Socks5.Wire
import Network.Socks5.Types
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/socks-0.5.4/Network/Socks5/Lowlevel.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BC

</span><a href="#loc_17_1_17_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_18&#39;)"><span class="mpre">resolveToSockAddr</span></a><span class="mpre"> :: </span><a href="Network.Socks5.Types.html#loc_87_6_87_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_87_6_87_18&#39;)"><span class="hl_tyconref"><span class="mpre">SocksAddress</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SockAddr</span></span><span class="mpre">
</span><a name="loc_17_1_17_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_18&#39;)"><span class="hl_fundecl"><span class="mpre">resolveToSockAddr</span></span></a><span class="mpre"> (</span><a href="Network.Socks5.Types.html#loc_87_21_87_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_87_21_87_33&#39;)"><span class="hl_conref"><span class="mpre">SocksAddress</span></span></a><span class="mpre"> </span><a name="loc_17_33_17_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_33_17_45&#39;)"><span class="hl_vardecl"><span class="mpre">sockHostAddr</span></span></a><span class="mpre"> </span><a name="loc_17_46_17_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_46_17_50&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre">) =
    case </span><a href="#loc_17_33_17_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_33_17_45&#39;)"><span class="hl_varref"><span class="mpre">sockHostAddr</span></span></a><span class="mpre"> of
        </span><a href="Network.Socks5.Types.html#loc_54_7_54_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_54_7_54_20&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrIPV4</span></span></a><span class="mpre"> </span><a name="loc_19_23_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_23_19_25&#39;)"><span class="hl_vardecl"><span class="mpre">ha</span></span></a><span class="mpre">       -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SockAddrInet</span></span><span class="mpre"> </span><a href="#loc_17_46_17_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_46_17_50&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre"> </span><a href="#loc_19_23_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_23_19_25&#39;)"><span class="hl_varref"><span class="mpre">ha</span></span></a><span class="mpre">
        </span><a href="Network.Socks5.Types.html#loc_56_7_56_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_56_7_56_20&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrIPV6</span></span></a><span class="mpre"> </span><a name="loc_20_23_20_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_23_20_26&#39;)"><span class="hl_vardecl"><span class="mpre">ha6</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SockAddrInet6</span></span><span class="mpre"> </span><a href="#loc_17_46_17_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_46_17_50&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_20_23_20_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_23_20_26&#39;)"><span class="hl_varref"><span class="mpre">ha6</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        </span><a href="Network.Socks5.Types.html#loc_55_7_55_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_55_7_55_26&#39;)"><span class="hl_conref"><span class="mpre">SocksAddrDomainName</span></span></a><span class="mpre"> </span><a name="loc_21_29_21_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_29_21_31&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> -&gt; do </span><a name="loc_21_38_21_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_38_21_40&#39;)"><span class="hl_vardecl"><span class="mpre">he</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getHostByName</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BC.unpack</span></span><span class="mpre"> </span><a href="#loc_21_29_21_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_29_21_31&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
                                     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SockAddrInet</span></span><span class="mpre"> </span><a href="#loc_17_46_17_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_46_17_50&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">hostAddress</span></span><span class="mpre"> </span><a href="#loc_21_38_21_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_38_21_40&#39;)"><span class="hl_varref"><span class="mpre">he</span></span></a><span class="mpre">)

</span><a href="#loc_25_1_25_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_12&#39;)"><span class="mpre">socksListen</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Socket</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.Socks5.Wire.html#loc_34_6_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Wire.html#loc_34_6_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">SocksRequest</span></span></a><span class="mpre">
</span><a name="loc_25_1_25_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_12&#39;)"><span class="hl_fundecl"><span class="mpre">socksListen</span></span></a><span class="mpre"> </span><a name="loc_25_13_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_13_25_17&#39;)"><span class="hl_vardecl"><span class="mpre">sock</span></span></a><span class="mpre"> = do
    </span><a name="loc_26_5_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_10&#39;)"><span class="hl_vardecl"><span class="mpre">hello</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Socks5.Command.html#loc_82_1_82_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Command.html#loc_82_1_82_15&#39;)"><span class="hl_varref"><span class="mpre">waitSerialized</span></span></a><span class="mpre"> </span><a href="#loc_25_13_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_13_25_17&#39;)"><span class="hl_varref"><span class="mpre">sock</span></span></a><span class="mpre">
    case </span><a href="Network.Socks5.Wire.html#loc_25_32_25_52" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Wire.html#loc_25_32_25_52&#39;)"><span class="hl_varref"><span class="mpre">getSocksHelloMethods</span></span></a><span class="mpre"> </span><a href="#loc_26_5_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_10&#39;)"><span class="hl_varref"><span class="mpre">hello</span></span></a><span class="mpre"> of
        _ -&gt; do </span><a href="Network.Socks5.Command.html#loc_79_1_79_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Command.html#loc_79_1_79_15&#39;)"><span class="hl_varref"><span class="mpre">sendSerialized</span></span></a><span class="mpre"> </span><a href="#loc_25_13_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_13_25_17&#39;)"><span class="hl_varref"><span class="mpre">sock</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">SocksHelloResponse</span></span><span class="mpre"> </span><a href="Network.Socks5.Types.html#loc_45_7_45_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Types.html#loc_45_7_45_22&#39;)"><span class="hl_conref"><span class="mpre">SocksMethodNone</span></span></a><span class="mpre">)
                </span><a href="Network.Socks5.Command.html#loc_82_1_82_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Socks5.Command.html#loc_82_1_82_15&#39;)"><span class="hl_varref"><span class="mpre">waitSerialized</span></span></a><span class="mpre"> </span><a href="#loc_25_13_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_13_25_17&#39;)"><span class="hl_varref"><span class="mpre">sock</span></span></a><span class="mpre">
</span></div></body></html>