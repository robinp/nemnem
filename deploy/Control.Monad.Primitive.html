<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, MagicHash, UnboxedTuples, TypeFamilies #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Control.Monad.Primitive</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) Roman Leshchinskiy 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Roman Leshchinskiy &lt;rl@cse.unsw.edu.au&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : non-portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Primitive state-transformer monads</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

module Control.Monad.Primitive (
  PrimMonad(..), RealWorld, primitive_,
  primToPrim, primToIO, primToST,
  unsafePrimToPrim, unsafePrimToIO, unsafePrimToST,
  unsafeInlinePrim, unsafeInlineIO, unsafeInlineST,
  touch
) where

import GHC.Prim   ( </span><a href="GHC.Prim.html#loc_2647_6_2647_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2647_6_2647_12&#39;)"><span class="mpre">State#</span></a><span class="mpre">, </span><a href="GHC.Prim.html#loc_2653_6_2653_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2653_6_2653_15&#39;)"><span class="mpre">RealWorld</span></a><span class="mpre">, </span><a href="GHC.Prim.html#loc_2713_1_2713_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2713_1_2713_7&#39;)"><span class="mpre">touch#</span></a><span class="mpre"> )
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 8, srcSpanEndLine = 23, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">   ( unsafeCoerce#, realWorld# )
#if MIN_VERSION_base(4,2,0)
import GHC.IO     ( IO(..) )
#else
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 8, srcSpanEndLine = 27, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;GHC.IOBase&quot;"><span class="mpre">GHC.IOBase</span></span><span class="mpre"> ( IO(..) )
#endif
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 8, srcSpanEndLine = 29, srcSpanEndColumn = 14}, srcInfoPoints = []}) &quot;GHC.ST&quot;"><span class="mpre">GHC.ST</span></span><span class="mpre">     ( ST(..) )

</span><span class="hl_comment"><span class="mpre">-- | Class of primitive state-transformer monads</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 7, srcSpanEndLine = 32, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 15, srcSpanEndLine = 32, srcSpanEndColumn = 17}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pu"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a name="loc_32_18_32_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_27&#39;)"><span class="hl_classdecl"><span class="mpre">PrimMonad</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> where
  </span><span class="hl_comment"><span class="mpre">-- | State token type</span></span><span class="mpre">
  </span><span class="warning" data-warning="ClassDecl ClsTyFam (SrcSpanInfo {srcInfoClsTyFam (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 3, srcSpanEndLine = 34, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 3, srcSpanEndLine = 34, srcSpanEndColumn = 7}]}) (DHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/"><span class="mpre">type PrimState m</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- | Execute a primitive operation</span></span><span class="mpre">
  </span><a name="loc_37_3_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_12&#39;)"><span class="mpre">primitive</span></a><span class="mpre"> :: (</span><a href="GHC.Prim.html#loc_2647_6_2647_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2647_6_2647_12&#39;)"><span class="hl_tyconref"><span class="mpre">State#</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">PrimState</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) -&gt; (# </span><a href="GHC.Prim.html#loc_2647_6_2647_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2647_6_2647_12&#39;)"><span class="hl_tyconref"><span class="mpre">State#</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">PrimState</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">), </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> #)) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">


  </span><span class="hl_comment"><span class="mpre">-- | Expose the internal structure of the monad</span></span><span class="mpre">
  </span><a name="loc_41_3_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_3_41_11&#39;)"><span class="mpre">internal</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="GHC.Prim.html#loc_2647_6_2647_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2647_6_2647_12&#39;)"><span class="hl_tyconref"><span class="mpre">State#</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">PrimState</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) -&gt; (# </span><a href="GHC.Prim.html#loc_2647_6_2647_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2647_6_2647_12&#39;)"><span class="hl_tyconref"><span class="mpre">State#</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">PrimState</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">), </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> #)

</span><span class="hl_comment"><span class="mpre">-- | Execute a primitive operation with no result</span></span><span class="mpre">
</span><a href="#loc_47_1_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_11&#39;)"><span class="mpre">primitive_</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 15, srcSpanEndLine = 45, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 15, srcSpanEndLine = 45, srcSpanEndColumn = 17}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">PrimMonad m
              =&gt;</span></span><span class="mpre"> (</span><a href="GHC.Prim.html#loc_2647_6_2647_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2647_6_2647_12&#39;)"><span class="hl_tyconref"><span class="mpre">State#</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">PrimState</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) -&gt; </span><a href="GHC.Prim.html#loc_2647_6_2647_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2647_6_2647_12&#39;)"><span class="hl_tyconref"><span class="mpre">State#</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">PrimState</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_47_1_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_11&#39;)"><span class="mpre">primitive_</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_47_1_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_11&#39;)"><span class="hl_fundecl"><span class="mpre">primitive_</span></span></a><span class="mpre"> </span><a name="loc_47_12_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_12_47_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_37_3_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_12&#39;)"><span class="hl_varref"><span class="mpre">primitive</span></span></a><span class="mpre"> (\</span><a name="loc_47_28_47_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_28_47_30&#39;)"><span class="hl_vardecl"><span class="mpre">s#</span></span></a><span class="mpre"> -&gt; (# </span><a href="#loc_47_12_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_12_47_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_47_28_47_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_28_47_30&#39;)"><span class="hl_varref"><span class="mpre">s#</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> #))

instance </span><a href="#loc_32_18_32_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_27&#39;)"><span class="hl_classref"><span class="mpre">PrimMonad</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> where
  </span><span class="warning" data-warning="InstDeclInsType (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 3, srcSpanEndLine = 50, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 3, srcSpanEndLine = 50, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primiti"><span class="mpre">type PrimState IO = RealWorld</span></span><span class="mpre">
  </span><a href="#loc_37_3_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_12&#39;)"><span class="hl_vardecl"><span class="mpre">primitive</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">IO</span></span><span class="mpre">
  </span><a href="#loc_41_3_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_3_41_11&#39;)"><span class="hl_fundecl"><span class="mpre">internal</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">IO</span></span><span class="mpre"> </span><a name="loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_37_3_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_12&#39;)"><span class="mpre">primitive</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_41_3_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_3_41_11&#39;)"><span class="mpre">internal</span></a><span class="mpre"> #-}</span></span><span class="mpre">

instance </span><a href="#loc_32_18_32_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_27&#39;)"><span class="hl_classref"><span class="mpre">PrimMonad</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
  </span><span class="warning" data-warning="InstDeclInsType (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 3, srcSpanEndLine = 57, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 3, srcSpanEndLine = 57, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primiti"><span class="mpre">type PrimState (ST s) = s</span></span><span class="mpre">
  </span><a href="#loc_37_3_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_12&#39;)"><span class="hl_vardecl"><span class="mpre">primitive</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ST</span></span><span class="mpre">
  </span><a href="#loc_41_3_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_3_41_11&#39;)"><span class="hl_fundecl"><span class="mpre">internal</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ST</span></span><span class="mpre"> </span><a name="loc_59_16_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_16_59_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_59_16_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_16_59_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_37_3_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_12&#39;)"><span class="mpre">primitive</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_41_3_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_3_41_11&#39;)"><span class="mpre">internal</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a &#39;PrimMonad&#39; to another monad with the same state token.</span></span><span class="mpre">
</span><a href="#loc_67_1_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_11&#39;)"><span class="mpre">primToPrim</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 15, srcSpanEndLine = 65, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 15, srcSpanEndLine = 64, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Prim"><span class="mpre">(PrimMonad m1, PrimMonad m2, PrimState m1 ~ PrimState m2)
        =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m1</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m2</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_67_1_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_11&#39;)"><span class="mpre">primToPrim</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_67_1_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_11&#39;)"><span class="hl_fundecl"><span class="mpre">primToPrim</span></span></a><span class="mpre"> </span><a name="loc_67_12_67_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_12_67_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_37_3_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_12&#39;)"><span class="hl_varref"><span class="mpre">primitive</span></span></a><span class="mpre"> (</span><a href="#loc_41_3_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_3_41_11&#39;)"><span class="hl_varref"><span class="mpre">internal</span></span></a><span class="mpre"> </span><a href="#loc_67_12_67_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_12_67_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Convert a &#39;PrimMonad&#39; with a &#39;RealWorld&#39; state token to &#39;IO&#39;</span></span><span class="mpre">
</span><a href="#loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="mpre">primToIO</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 13, srcSpanEndLine = 70, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 13, srcSpanEndLine = 70, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Prim"><span class="mpre">(PrimMonad m, PrimState m ~ RealWorld) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="mpre">primToIO</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="hl_vardecl"><span class="mpre">primToIO</span></span></a><span class="mpre"> = </span><a href="#loc_67_1_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_11&#39;)"><span class="hl_varref"><span class="mpre">primToPrim</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a &#39;PrimMonad&#39; to &#39;ST&#39;</span></span><span class="mpre">
</span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="mpre">primToST</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 13, srcSpanEndLine = 75, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 25, srcSpanEndLine = 75, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">PrimMonad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">PrimState</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="mpre">primToST</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="hl_vardecl"><span class="mpre">primToST</span></span></a><span class="mpre"> = </span><a href="#loc_67_1_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_11&#39;)"><span class="hl_varref"><span class="mpre">primToPrim</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a &#39;PrimMonad&#39; to another monad with a possibly different state</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- token. This operation is highly unsafe!</span></span><span class="mpre">
</span><a href="#loc_83_1_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_17&#39;)"><span class="mpre">unsafePrimToPrim</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 21, srcSpanEndLine = 81, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 21, srcSpanEndLine = 81, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Prim"><span class="mpre">(PrimMonad m1, PrimMonad m2) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m1</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m2</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_83_1_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_17&#39;)"><span class="mpre">unsafePrimToPrim</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_83_1_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_17&#39;)"><span class="hl_fundecl"><span class="mpre">unsafePrimToPrim</span></span></a><span class="mpre"> </span><a name="loc_83_18_83_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_18_83_19&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_37_3_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_12&#39;)"><span class="hl_varref"><span class="mpre">primitive</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">unsafeCoerce#</span></span><span class="mpre"> (</span><a href="#loc_41_3_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_3_41_11&#39;)"><span class="hl_varref"><span class="mpre">internal</span></span></a><span class="mpre"> </span><a href="#loc_83_18_83_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_18_83_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Convert any &#39;PrimMonad&#39; to &#39;ST&#39; with an arbitrary state token. This</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- operation is highly unsafe!</span></span><span class="mpre">
</span><a href="#loc_89_1_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_15&#39;)"><span class="mpre">unsafePrimToST</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 19, srcSpanEndLine = 87, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 31, srcSpanEndLine = 87, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">PrimMonad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_89_1_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_15&#39;)"><span class="mpre">unsafePrimToST</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_89_1_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_15&#39;)"><span class="hl_vardecl"><span class="mpre">unsafePrimToST</span></span></a><span class="mpre"> = </span><a href="#loc_83_1_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_17&#39;)"><span class="hl_varref"><span class="mpre">unsafePrimToPrim</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert any &#39;PrimMonad&#39; to &#39;IO&#39;. This operation is highly unsafe!</span></span><span class="mpre">
</span><a href="#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_15&#39;)"><span class="mpre">unsafePrimToIO</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 19, srcSpanEndLine = 92, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 31, srcSpanEndLine = 92, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">PrimMonad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_15&#39;)"><span class="mpre">unsafePrimToIO</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_94_1_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_15&#39;)"><span class="hl_vardecl"><span class="mpre">unsafePrimToIO</span></span></a><span class="mpre"> = </span><a href="#loc_83_1_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_17&#39;)"><span class="hl_varref"><span class="mpre">unsafePrimToPrim</span></span></a><span class="mpre">

</span><a href="#loc_98_1_98_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_17&#39;)"><span class="mpre">unsafeInlinePrim</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 21, srcSpanEndLine = 96, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 33, srcSpanEndLine = 96, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">PrimMonad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_98_1_98_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_17&#39;)"><span class="mpre">unsafeInlinePrim</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_98_1_98_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_17&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeInlinePrim</span></span></a><span class="mpre"> </span><a name="loc_98_18_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_18_98_19&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_102_1_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_15&#39;)"><span class="hl_varref"><span class="mpre">unsafeInlineIO</span></span></a><span class="mpre"> (</span><a href="#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">unsafePrimToIO</span></span></a><span class="mpre"> </span><a href="#loc_98_18_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_18_98_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)

</span><a href="#loc_102_1_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_15&#39;)"><span class="mpre">unsafeInlineIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_102_1_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_15&#39;)"><span class="mpre">unsafeInlineIO</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_102_1_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_15&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeInlineIO</span></span></a><span class="mpre"> </span><a name="loc_102_16_102_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_16_102_17&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = case </span><a href="#loc_41_3_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_3_41_11&#39;)"><span class="hl_varref"><span class="mpre">internal</span></span></a><span class="mpre"> </span><a href="#loc_102_16_102_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_16_102_17&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">realWorld#</span></span><span class="mpre"> of (# _, </span><a name="loc_102_56_102_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_56_102_57&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> #) -&gt; </span><a href="#loc_102_56_102_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_56_102_57&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_106_1_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_15&#39;)"><span class="mpre">unsafeInlineST</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_106_1_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_15&#39;)"><span class="mpre">unsafeInlineST</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_106_1_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_15&#39;)"><span class="hl_vardecl"><span class="mpre">unsafeInlineST</span></span></a><span class="mpre"> = </span><a href="#loc_98_1_98_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_17&#39;)"><span class="hl_varref"><span class="mpre">unsafeInlinePrim</span></span></a><span class="mpre">

</span><a href="#loc_110_1_110_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_6&#39;)"><span class="mpre">touch</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 108, srcSpanStartColumn = 10, srcSpanEndLine = 108, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/primitive-0.5.3.0/Control/Monad/Primitive.hs&quot;, srcSpanStartLine = 108, srcSpanStartColumn = 22, srcSpanEndLine = 108, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">PrimMonad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_110_1_110_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_6&#39;)"><span class="mpre">touch</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_110_1_110_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_6&#39;)"><span class="hl_fundecl"><span class="mpre">touch</span></span></a><span class="mpre"> </span><a name="loc_110_7_110_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_7_110_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_83_1_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_17&#39;)"><span class="hl_varref"><span class="mpre">unsafePrimToPrim</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_37_3_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_3_37_12&#39;)"><span class="hl_varref"><span class="mpre">primitive</span></span></a><span class="mpre"> (\</span><a name="loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; case </span><a href="GHC.Prim.html#loc_2713_1_2713_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2713_1_2713_7&#39;)"><span class="hl_varref"><span class="mpre">touch#</span></span></a><span class="mpre"> </span><a href="#loc_110_7_110_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_7_110_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of { </span><a name="loc_111_50_111_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_50_111_52&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> -&gt; (# </span><a href="#loc_111_50_111_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_50_111_52&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> #) }) :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)

</span></div></body></html>