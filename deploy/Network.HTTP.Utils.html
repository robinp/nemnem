<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Network.HTTP.Utils</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  See LICENSE file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Ganesh Sittampalam &lt;ganesh@earth.li&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (not tested)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Set of utility functions and definitions used by package modules.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.HTTP.Utils
       ( trim     </span><span class="hl_comment"><span class="mpre">-- :: String -&gt; String</span></span><span class="mpre">
       , trimL    </span><span class="hl_comment"><span class="mpre">-- :: String -&gt; String</span></span><span class="mpre">
       , trimR    </span><span class="hl_comment"><span class="mpre">-- :: String -&gt; String</span></span><span class="mpre">
       
       , crlf     </span><span class="hl_comment"><span class="mpre">-- :: String</span></span><span class="mpre">
       , lf       </span><span class="hl_comment"><span class="mpre">-- :: String</span></span><span class="mpre">
       , sp       </span><span class="hl_comment"><span class="mpre">-- :: String</span></span><span class="mpre">

       , split    </span><span class="hl_comment"><span class="mpre">-- :: Eq a =&gt; a -&gt; [a] -&gt; Maybe ([a],[a])</span></span><span class="mpre">
       , splitBy  </span><span class="hl_comment"><span class="mpre">-- :: Eq a =&gt; a -&gt; [a] -&gt; [[a]]</span></span><span class="mpre">
       
       , readsOne </span><span class="hl_comment"><span class="mpre">-- :: Read a =&gt; (a -&gt; b) -&gt; b -&gt; String -&gt; b</span></span><span class="mpre">

       , dropWhileTail </span><span class="hl_comment"><span class="mpre">-- :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</span></span><span class="mpre">
       , chopAtDelim   </span><span class="hl_comment"><span class="mpre">-- :: Eq a =&gt; a -&gt; [a] -&gt; ([a],[a])</span></span><span class="mpre">
       
       ) where
       
import Data.Char
import Data.List ( elemIndex )
import Data.Maybe ( fromMaybe )

</span><span class="hl_comment"><span class="mpre">-- | @crlf@ is our beloved two-char line terminator.</span></span><span class="mpre">
</span><a href="#loc_38_1_38_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_5&#39;)"><span class="mpre">crlf</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_38_1_38_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_5&#39;)"><span class="hl_vardecl"><span class="mpre">crlf</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @lf@ is a tolerated line terminator, per RFC 2616 section 19.3.</span></span><span class="mpre">
</span><a href="#loc_42_1_42_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_3&#39;)"><span class="mpre">lf</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_42_1_42_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_3&#39;)"><span class="hl_vardecl"><span class="mpre">lf</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @sp@ lets you save typing one character.</span></span><span class="mpre">
</span><a href="#loc_46_1_46_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_3&#39;)"><span class="mpre">sp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_46_1_46_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_3&#39;)"><span class="hl_vardecl"><span class="mpre">sp</span></span></a><span class="mpre">   = </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @split delim ls@ splits a list into two parts, the @delim@ occurring</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- at the head of the second list.  If @delim@ isn&#39;t in @ls@, @Nothing@ is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returned.</span></span><span class="mpre">
</span><a href="#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_6&#39;)"><span class="mpre">split</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Utils.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 10, srcSpanEndLine = 51, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Utils.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 15, srcSpanEndLine = 51, srcSpanEndColumn = 17}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2."><span class="mpre">Eq a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">],[</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">])
</span><a name="loc_52_1_52_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_6&#39;)"><span class="hl_fundecl"><span class="mpre">split</span></span></a><span class="mpre"> </span><a name="loc_52_7_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_12&#39;)"><span class="hl_vardecl"><span class="mpre">delim</span></span></a><span class="mpre"> </span><a name="loc_52_13_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_17&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> = case </span><a href="#loc_52_7_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_12&#39;)"><span class="hl_varref"><span class="mpre">delim</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elemIndex`</span></span><span class="mpre"> </span><a href="#loc_52_13_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_17&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_54_10_54_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">splitAt</span></span><span class="mpre"> </span><a href="#loc_54_10_54_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_52_13_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_17&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @trim str@ removes leading and trailing whitespace from @str@.</span></span><span class="mpre">
</span><a href="#loc_58_1_58_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_5&#39;)"><span class="mpre">trim</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_58_1_58_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_5&#39;)"><span class="hl_fundecl"><span class="mpre">trim</span></span></a><span class="mpre"> </span><a name="loc_58_6_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_8&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_6&#39;)"><span class="hl_varref"><span class="mpre">trimR</span></span></a><span class="mpre"> (</span><a href="#loc_63_1_63_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_6&#39;)"><span class="hl_varref"><span class="mpre">trimL</span></span></a><span class="mpre"> </span><a href="#loc_58_6_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_8&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
   
</span><span class="hl_comment"><span class="mpre">-- | @trimL str@ removes leading whitespace (as defined by &#39;Data.Char.isSpace&#39;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- from @str@.</span></span><span class="mpre">
</span><a href="#loc_63_1_63_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_6&#39;)"><span class="mpre">trimL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_63_1_63_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_6&#39;)"><span class="hl_fundecl"><span class="mpre">trimL</span></span></a><span class="mpre"> </span><a name="loc_63_7_63_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_9&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isSpace</span></span><span class="mpre"> </span><a href="#loc_63_7_63_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_9&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @trimL str@ removes trailing whitespace (as defined by &#39;Data.Char.isSpace&#39;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- from @str@.</span></span><span class="mpre">
</span><a href="#loc_68_1_68_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_6&#39;)"><span class="mpre">trimR</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_68_1_68_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_6&#39;)"><span class="hl_fundecl"><span class="mpre">trimR</span></span></a><span class="mpre"> </span><a name="loc_68_7_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_7_68_10&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromMaybe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_70_3_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_3_70_9&#39;)"><span class="hl_varref"><span class="mpre">trimIt</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_68_7_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_7_68_10&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
 where
  </span><a name="loc_70_3_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_3_70_9&#39;)"><span class="hl_fundecl"><span class="mpre">trimIt</span></span></a><span class="mpre"> </span><a name="loc_70_10_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_70_18_70_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_70_10_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_70_18_70_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_18_70_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
  </span><a href="#loc_70_3_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_3_70_9&#39;)"><span class="hl_fundecl"><span class="mpre">trimIt</span></span></a><span class="mpre"> </span><a name="loc_71_10_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_10_71_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">   
   | </span><span class="hl_varref"><span class="mpre">isSpace</span></span><span class="mpre"> </span><a href="#loc_71_10_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_10_71_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> [</span><a href="#loc_71_10_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_10_71_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | @splitMany delim ls@ removes the delimiter @delim@ from @ls@.</span></span><span class="mpre">
</span><a href="#loc_77_1_77_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_8&#39;)"><span class="mpre">splitBy</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Utils.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 12, srcSpanEndLine = 76, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Utils.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 17, srcSpanEndLine = 76, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2."><span class="mpre">Eq a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [[</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]]
</span><a name="loc_77_1_77_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_8&#39;)"><span class="hl_fundecl"><span class="mpre">splitBy</span></span></a><span class="mpre"> _ [] = []
</span><a href="#loc_77_1_77_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_8&#39;)"><span class="hl_fundecl"><span class="mpre">splitBy</span></span></a><span class="mpre"> </span><a name="loc_78_9_78_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_78_11_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_13&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = 
    case </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_78_9_78_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_78_11_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_13&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
      (_,[]) -&gt; [</span><a href="#loc_78_11_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_13&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">]
      (</span><a name="loc_81_8_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_8_81_10&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">,_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_81_13_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_81_8_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_8_81_10&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_77_1_77_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_8&#39;)"><span class="hl_varref"><span class="mpre">splitBy</span></span></a><span class="mpre"> </span><a href="#loc_78_9_78_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_81_13_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @readsOne f def str@ tries to &#39;read&#39; @str@, taking</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the first result and passing it to @f@. If the &#39;read&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- doesn&#39;t succeed, return @def@.</span></span><span class="mpre">
</span><a href="#loc_87_1_87_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_9&#39;)"><span class="mpre">readsOne</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Utils.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 13, srcSpanEndLine = 86, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Utils.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 20, srcSpanEndLine = 86, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2."><span class="mpre">Read a =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_87_1_87_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_9&#39;)"><span class="hl_fundecl"><span class="mpre">readsOne</span></span></a><span class="mpre"> </span><a name="loc_87_10_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_87_12_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_87_14_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_17&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = 
 case </span><span class="hl_varref"><span class="mpre">reads</span></span><span class="mpre"> </span><a href="#loc_87_14_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
   ((</span><a name="loc_89_6_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_7&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><a href="#loc_87_10_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_89_6_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_7&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
   _ -&gt; </span><a href="#loc_87_12_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @dropWhileTail p ls@ chops off trailing elements from @ls@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- until @p@ returns @False@.</span></span><span class="mpre">
</span><a href="#loc_96_1_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_14&#39;)"><span class="mpre">dropWhileTail</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_96_1_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_14&#39;)"><span class="hl_fundecl"><span class="mpre">dropWhileTail</span></span></a><span class="mpre"> </span><a name="loc_96_15_96_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_96_17_96_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_17_96_19&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> =
 case </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_varref"><span class="mpre">chop</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_96_17_96_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_17_96_19&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> of { </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_97_39_97_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_39_97_41&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_97_39_97_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_39_97_41&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; [] }
  where
    </span><a name="loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_fundecl"><span class="mpre">chop</span></span></a><span class="mpre"> </span><a name="loc_99_10_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_10_99_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_99_18_99_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_99_10_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_10_99_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_99_18_99_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    </span><a href="#loc_99_5_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_5_99_9&#39;)"><span class="hl_fundecl"><span class="mpre">chop</span></span></a><span class="mpre"> </span><a name="loc_100_10_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_10_100_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> _
     | </span><a href="#loc_96_15_96_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_100_10_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_10_100_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">       = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
     | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> [</span><a href="#loc_100_10_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_10_100_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | @chopAtDelim elt ls@ breaks up @ls@ into two at first occurrence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of @elt@; @elt@ is elided too. If @elt@ does not occur, the second</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- list is empty and the first is equal to @ls@.</span></span><span class="mpre">
</span><a href="#loc_108_1_108_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_12&#39;)"><span class="mpre">chopAtDelim</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Utils.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 16, srcSpanEndLine = 107, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Utils.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 21, srcSpanEndLine = 107, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-400"><span class="mpre">Eq a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">],[</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">])
</span><a name="loc_108_1_108_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_12&#39;)"><span class="hl_fundecl"><span class="mpre">chopAtDelim</span></span></a><span class="mpre"> </span><a name="loc_108_13_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_13_108_16&#39;)"><span class="hl_vardecl"><span class="mpre">elt</span></span></a><span class="mpre"> </span><a name="loc_108_17_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> =
  case </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_108_13_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_13_108_16&#39;)"><span class="hl_varref"><span class="mpre">elt</span></span></a><span class="mpre">) </span><a href="#loc_108_17_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
    (_,[])    -&gt; (</span><a href="#loc_108_17_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,[])
    (</span><a name="loc_111_6_111_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_8&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">,_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_111_11_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_13&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_111_6_111_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_6_111_8&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">,</span><a href="#loc_111_11_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
</span></div></body></html>