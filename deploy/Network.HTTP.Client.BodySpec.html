<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
module Network.HTTP.Client.BodySpec where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/BodySpec.hs&quot;, srcSpanStartLine = 4, srcSpanStartColumn = 8, srcSpanEndLine = 4, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import Network.HTTP.Client
import Network.HTTP.Client.Internal
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/BodySpec.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 18, srcSpanEndLine = 7, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import Codec.Compression.GZip (</span><a href="Codec.Compression.GZip.html#loc_117_1_117_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_117_1_117_9&#39;)"><span class="mpre">compress</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/BodySpec.hs&quot;, srcSpanStartLine = 9, srcSpanStartColumn = 18, srcSpanEndLine = 9, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L

</span><a href="#loc_12_1_12_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_12_1_12_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hspec</span></span><span class="mpre"> </span><a href="#loc_20_1_20_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_5&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">

</span><a href="#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_11&#39;)"><span class="mpre">brComplete</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BodyReader</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_15_1_15_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_11&#39;)"><span class="hl_fundecl"><span class="mpre">brComplete</span></span></a><span class="mpre"> </span><a name="loc_15_12_15_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_12_15_18&#39;)"><span class="hl_vardecl"><span class="mpre">brRead</span></span></a><span class="mpre"> = do
  </span><a name="loc_16_3_16_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_3_16_5&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_15_12_15_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_12_15_18&#39;)"><span class="hl_varref"><span class="mpre">brRead</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_16_3_16_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_3_16_5&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)

</span><a href="#loc_20_1_20_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_5&#39;)"><span class="mpre">spec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_20_1_20_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_5&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;BodySpec&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;chunked, single&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_22_10_22_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, _, </span><a name="loc_22_19_22_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_19_22_24&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre">
            [ </span><span class="hl_string"><span class="mpre">&quot;5\r\nhello\r\n6\r\n world\r\n0\r\nnot consumed&quot;</span></span><span class="mpre">
            ]
        </span><a name="loc_25_9_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_15&#39;)"><span class="hl_vardecl"><span class="mpre">reader</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_131_1_131_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_131_1_131_18&#39;)"><span class="hl_varref"><span class="mpre">makeChunkedReader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_22_10_22_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a name="loc_26_9_26_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_13&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_26_9_26_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_13&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hello world&quot;</span></span><span class="mpre">
        </span><a name="loc_28_9_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_15&#39;)"><span class="hl_vardecl"><span class="mpre">input&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_22_19_22_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_19_22_24&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_28_9_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_15&#39;)"><span class="hl_varref"><span class="mpre">input&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not consumed&quot;</span></span><span class="mpre">
        </span><a href="#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_11&#39;)"><span class="hl_varref"><span class="mpre">brComplete</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldReturn`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;chunked, pieces&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_33_10_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_10_33_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, _, </span><a name="loc_33_19_33_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_19_33_24&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.singleton</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.unpack</span></span><span class="mpre">
            </span><span class="hl_string"><span class="mpre">&quot;5\r\nhello\r\n6\r\n world\r\n0\r\nnot consumed&quot;</span></span><span class="mpre">
        </span><a name="loc_35_9_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_15&#39;)"><span class="hl_vardecl"><span class="mpre">reader</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_131_1_131_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_131_1_131_18&#39;)"><span class="hl_varref"><span class="mpre">makeChunkedReader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_33_10_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_10_33_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a name="loc_36_9_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_13&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="#loc_35_9_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_36_9_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_13&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hello world&quot;</span></span><span class="mpre">
        </span><a name="loc_38_9_38_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_15&#39;)"><span class="hl_vardecl"><span class="mpre">input&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_33_19_33_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_19_33_24&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_38_9_38_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_15&#39;)"><span class="hl_varref"><span class="mpre">input&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not consumed&quot;</span></span><span class="mpre">
        </span><a href="#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_11&#39;)"><span class="hl_varref"><span class="mpre">brComplete</span></span></a><span class="mpre"> </span><a href="#loc_35_9_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldReturn`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;chunked, raw&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_43_10_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_10_43_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, _, </span><a name="loc_43_19_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_24&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre">
            [ </span><span class="hl_string"><span class="mpre">&quot;5\r\nhello\r\n6\r\n world\r\n0\r\nnot consumed&quot;</span></span><span class="mpre">
            ]
        </span><a name="loc_46_9_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_15&#39;)"><span class="hl_vardecl"><span class="mpre">reader</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_131_1_131_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_131_1_131_18&#39;)"><span class="hl_varref"><span class="mpre">makeChunkedReader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_43_10_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_10_43_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a name="loc_47_9_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_13&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="#loc_46_9_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_47_9_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_13&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;5\r\nhello\r\n6\r\n world\r\n0\r\n&quot;</span></span><span class="mpre">
        </span><a name="loc_49_9_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_15&#39;)"><span class="hl_vardecl"><span class="mpre">input&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_43_19_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_24&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_49_9_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_15&#39;)"><span class="hl_varref"><span class="mpre">input&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not consumed&quot;</span></span><span class="mpre">
        </span><a href="#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_11&#39;)"><span class="hl_varref"><span class="mpre">brComplete</span></span></a><span class="mpre"> </span><a href="#loc_46_9_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldReturn`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;chunked, pieces, raw&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_54_10_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, _, </span><a name="loc_54_19_54_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_24&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.singleton</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.unpack</span></span><span class="mpre">
            </span><span class="hl_string"><span class="mpre">&quot;5\r\nhello\r\n6\r\n world\r\n0\r\nnot consumed&quot;</span></span><span class="mpre">
        </span><a name="loc_56_9_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_15&#39;)"><span class="hl_vardecl"><span class="mpre">reader</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_131_1_131_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_131_1_131_18&#39;)"><span class="hl_varref"><span class="mpre">makeChunkedReader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_54_10_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a name="loc_57_9_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_9_57_13&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="#loc_56_9_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_57_9_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_9_57_13&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;5\r\nhello\r\n6\r\n world\r\n0\r\n&quot;</span></span><span class="mpre">
        </span><a name="loc_59_9_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_15&#39;)"><span class="hl_vardecl"><span class="mpre">input&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_54_19_54_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_24&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_59_9_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_15&#39;)"><span class="hl_varref"><span class="mpre">input&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not consumed&quot;</span></span><span class="mpre">
        </span><a href="#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_11&#39;)"><span class="hl_varref"><span class="mpre">brComplete</span></span></a><span class="mpre"> </span><a href="#loc_56_9_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldReturn`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;length, single&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_64_10_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, _, </span><a name="loc_64_19_64_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_19_64_24&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre">
            [ </span><span class="hl_string"><span class="mpre">&quot;hello world done&quot;</span></span><span class="mpre">
            ]
        </span><a name="loc_67_9_67_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_15&#39;)"><span class="hl_vardecl"><span class="mpre">reader</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_106_1_106_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_106_1_106_17&#39;)"><span class="hl_varref"><span class="mpre">makeLengthReader</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre"> </span><a href="#loc_64_10_64_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a name="loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="#loc_67_9_67_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hello world&quot;</span></span><span class="mpre">
        </span><a name="loc_70_9_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_15&#39;)"><span class="hl_vardecl"><span class="mpre">input&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_64_19_64_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_19_64_24&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_70_9_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_15&#39;)"><span class="hl_varref"><span class="mpre">input&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; done&quot;</span></span><span class="mpre">
        </span><a href="#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_11&#39;)"><span class="hl_varref"><span class="mpre">brComplete</span></span></a><span class="mpre"> </span><a href="#loc_67_9_67_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldReturn`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;length, pieces&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_75_10_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, _, </span><a name="loc_75_19_75_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_19_75_24&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.singleton</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.unpack</span></span><span class="mpre">
            </span><span class="hl_string"><span class="mpre">&quot;hello world done&quot;</span></span><span class="mpre">
        </span><a name="loc_77_9_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_15&#39;)"><span class="hl_vardecl"><span class="mpre">reader</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_106_1_106_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_106_1_106_17&#39;)"><span class="hl_varref"><span class="mpre">makeLengthReader</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre"> </span><a href="#loc_75_10_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_10_75_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a name="loc_78_9_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_13&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="#loc_77_9_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_78_9_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_13&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hello world&quot;</span></span><span class="mpre">
        </span><a name="loc_80_9_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">input&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_75_19_75_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_19_75_24&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">input&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; done&quot;</span></span><span class="mpre">
        </span><a href="#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_11&#39;)"><span class="hl_varref"><span class="mpre">brComplete</span></span></a><span class="mpre"> </span><a href="#loc_77_9_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldReturn`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzip&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        let </span><a name="loc_85_13_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_17&#39;)"><span class="hl_vardecl"><span class="mpre">orig</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5000</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Hello world!&quot;</span></span><span class="mpre">
            </span><a name="loc_86_13_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_13_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">origZ</span></span></a><span class="mpre"> = </span><a href="Codec.Compression.GZip.html#loc_117_1_117_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_117_1_117_9&#39;)"><span class="hl_varref"><span class="mpre">compress</span></span></a><span class="mpre"> </span><a href="#loc_85_13_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_17&#39;)"><span class="hl_varref"><span class="mpre">orig</span></span></a><span class="mpre">
        (</span><a name="loc_87_10_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, _, </span><a name="loc_87_19_87_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_19_87_24&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_86_13_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_13_86_18&#39;)"><span class="hl_varref"><span class="mpre">origZ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ignored&quot;</span></span><span class="mpre">]
        </span><a name="loc_88_9_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_9_88_16&#39;)"><span class="hl_vardecl"><span class="mpre">reader&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_106_1_106_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_106_1_106_17&#39;)"><span class="hl_varref"><span class="mpre">makeLengthReader</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_86_13_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_13_86_18&#39;)"><span class="hl_varref"><span class="mpre">origZ</span></span></a><span class="mpre">) </span><a href="#loc_87_10_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a name="loc_89_9_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_15&#39;)"><span class="hl_vardecl"><span class="mpre">reader</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_67_1_67_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_67_1_67_15&#39;)"><span class="hl_varref"><span class="mpre">makeGzipReader</span></span></a><span class="mpre"> </span><a href="#loc_88_9_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_9_88_16&#39;)"><span class="hl_varref"><span class="mpre">reader&#39;</span></span></a><span class="mpre">
        </span><a name="loc_90_9_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_13&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="#loc_89_9_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_90_9_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_13&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><a href="#loc_85_13_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_17&#39;)"><span class="hl_varref"><span class="mpre">orig</span></span></a><span class="mpre">
        </span><a name="loc_92_9_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_15&#39;)"><span class="hl_vardecl"><span class="mpre">input&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_87_19_87_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_19_87_24&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_92_9_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_15&#39;)"><span class="hl_varref"><span class="mpre">input&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ignored&quot;</span></span><span class="mpre">
        </span><a href="#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_11&#39;)"><span class="hl_varref"><span class="mpre">brComplete</span></span></a><span class="mpre"> </span><a href="#loc_89_9_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_15&#39;)"><span class="hl_varref"><span class="mpre">reader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldReturn`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span></div></body></html>