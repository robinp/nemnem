<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | This module contains the definitions for a generic parser, with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   running state.  These are the parts that are shared between the State</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   and StateLazy variations.  Do not import this module directly, but only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   via T.P.Poly.State or T.P.Poly.StateLazy.</span></span><span class="mpre">
module Text.ParserCombinators.Poly.StateParser
  ( </span><span class="hl_comment"><span class="mpre">-- * The Parser datatype</span></span><span class="mpre">
    Parser(P)        </span><span class="hl_comment"><span class="mpre">-- datatype, instance of: Functor, Monad, PolyParse</span></span><span class="mpre">
  , Result(..)        </span><span class="hl_comment"><span class="mpre">-- internal to the parser monad</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** basic parsers</span></span><span class="mpre">
  , next        </span><span class="hl_comment"><span class="mpre">-- :: Parser s t t</span></span><span class="mpre">
  , eof                </span><span class="hl_comment"><span class="mpre">-- :: Parser s t ()</span></span><span class="mpre">
  , satisfy        </span><span class="hl_comment"><span class="mpre">-- :: (t-&gt;Bool) -&gt; Parser s t t</span></span><span class="mpre">
  , onFail      </span><span class="hl_comment"><span class="mpre">-- :: Parser s t a -&gt; Parser s t a -&gt; Parser s t a</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** State-handling</span></span><span class="mpre">
  , stUpdate    </span><span class="hl_comment"><span class="mpre">-- :: (s-&gt;s) -&gt; Parser s t ()</span></span><span class="mpre">
  , stQuery     </span><span class="hl_comment"><span class="mpre">-- :: (s-&gt;a) -&gt; Parser s t a</span></span><span class="mpre">
  , stGet       </span><span class="hl_comment"><span class="mpre">-- :: Parser s t s</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** re-parsing</span></span><span class="mpre">
  , reparse        </span><span class="hl_comment"><span class="mpre">-- :: [t] -&gt; Parser s t ()</span></span><span class="mpre">
  ) where


import Text.ParserCombinators.Poly.Base
import Text.ParserCombinators.Poly.Result

</span><span class="hl_comment"><span class="mpre">-- | This @Parser@ datatype is a fairly generic parsing monad with error</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   reporting, and running state.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   It can be used for arbitrary token types, not just String input.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   (If you do not require a running state, use module Poly.Plain instead)</span></span><span class="mpre">
newtype </span><a name="loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_condecl"><span class="mpre">P</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">] -&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_6_13_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_6_13_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> ([</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">],</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_33_10_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_10_33_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_33_15_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_33_24_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_24_33_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">-&gt; </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_33_10_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_10_33_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_33_15_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_33_24_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_24_33_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_36_12_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_12_36_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">     = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_36_24_36_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_24_36_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_36_26_36_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_26_36_28&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">-&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> (</span><a href="#loc_36_26_36_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_26_36_28&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">,</span><a href="#loc_36_24_36_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_24_36_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_36_12_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_12_36_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> </span><a name="loc_37_10_37_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_11&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">       = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_37_24_37_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_24_37_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_37_26_37_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_26_37_28&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">-&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> (</span><a href="#loc_37_26_37_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_26_37_28&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">,</span><a href="#loc_37_24_37_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_24_37_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_37_10_37_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_11&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
    (</span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_38_8_38_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_8_38_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_38_15_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_15_38_16&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">  = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_38_24_38_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_24_38_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">-&gt; </span><a href="#loc_40_9_40_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_17&#39;)"><span class="hl_varref"><span class="mpre">continue</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_38_8_38_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_8_38_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_38_24_38_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_24_38_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
      where
        </span><a name="loc_40_9_40_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_17&#39;)"><span class="hl_fundecl"><span class="mpre">continue</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> (</span><a name="loc_40_28_40_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_28_40_30&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">,</span><a name="loc_40_31_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_31_40_32&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_40_34_40_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_34_40_35&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)        = let (</span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_40_53_40_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_53_40_55&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_38_15_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_15_38_16&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_40_34_40_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_34_40_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> in </span><a href="#loc_40_53_40_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_53_40_55&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre"> </span><a href="#loc_40_31_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_31_40_32&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_40_28_40_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_28_40_30&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
        </span><a href="#loc_40_9_40_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_17&#39;)"><span class="hl_fundecl"><span class="mpre">continue</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> </span><a name="loc_41_29_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_29_41_30&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)             = </span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> (</span><a href="#loc_40_9_40_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_17&#39;)"><span class="hl_varref"><span class="mpre">continue</span></span></a><span class="mpre"> </span><a href="#loc_41_29_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_29_41_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
        </span><a href="#loc_40_9_40_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_17&#39;)"><span class="hl_fundecl"><span class="mpre">continue</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> </span><a name="loc_42_27_42_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_27_42_30&#39;)"><span class="hl_vardecl"><span class="mpre">tss</span></span></a><span class="mpre"> </span><a name="loc_42_31_42_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_31_42_32&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)           = </span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> </span><a href="#loc_42_27_42_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_27_42_30&#39;)"><span class="hl_varref"><span class="mpre">tss</span></span></a><span class="mpre"> </span><a href="#loc_42_31_42_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_31_42_32&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">

instance </span><a href="Text.ParserCombinators.Poly.Base.html#loc_44_7_44_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_44_7_44_17&#39;)"><span class="hl_classref"><span class="mpre">Commitment</span></span></a><span class="mpre"> (</span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) where
    </span><a href="Text.ParserCombinators.Poly.Base.html#loc_49_5_49_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_49_5_49_11&#39;)"><span class="hl_fundecl"><span class="mpre">commit</span></span></a><span class="mpre"> (</span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_45_15_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_15_45_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)         = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_45_32_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_32_45_33&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">-&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_varref"><span class="mpre">squash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_45_15_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_15_45_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_45_32_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_32_45_33&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
      where
        </span><a name="loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_fundecl"><span class="mpre">squash</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> </span><a name="loc_47_27_47_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_27_47_28&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_varref"><span class="mpre">squash</span></span></a><span class="mpre"> </span><a href="#loc_47_27_47_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_27_47_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
        </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_fundecl"><span class="mpre">squash</span></span></a><span class="mpre"> </span><a name="loc_48_16_48_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_16_48_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">             = </span><a href="#loc_48_16_48_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_16_48_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    (</span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_49_8_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_8_49_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="Text.ParserCombinators.Poly.Base.html#loc_52_5_52_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_52_5_52_14&#39;)"><span class="hl_fundecl"><span class="mpre">`adjustErr`</span></span></a><span class="mpre"> </span><a name="loc_49_23_49_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_23_49_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_49_32_49_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_32_49_33&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">-&gt; </span><a href="#loc_51_9_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_15&#39;)"><span class="hl_varref"><span class="mpre">adjust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_49_8_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_8_49_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_49_32_49_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_32_49_33&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
      where
        </span><a name="loc_51_9_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_15&#39;)"><span class="hl_fundecl"><span class="mpre">adjust</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> </span><a name="loc_51_25_51_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_25_51_27&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre"> </span><a name="loc_51_28_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_28_51_29&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)  = </span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> </span><a href="#loc_51_25_51_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_25_51_27&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre"> (</span><a href="#loc_49_23_49_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_23_49_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_51_28_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_28_51_29&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
        </span><a href="#loc_51_9_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_15&#39;)"><span class="hl_fundecl"><span class="mpre">adjust</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> </span><a name="loc_52_27_52_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_27_52_28&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)   = </span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> (</span><a href="#loc_51_9_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_15&#39;)"><span class="hl_varref"><span class="mpre">adjust</span></span></a><span class="mpre"> </span><a href="#loc_52_27_52_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_27_52_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
        </span><a href="#loc_51_9_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_15&#39;)"><span class="hl_fundecl"><span class="mpre">adjust</span></span></a><span class="mpre">  </span><a name="loc_53_17_53_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_17_53_21&#39;)"><span class="hl_vardecl"><span class="mpre">good</span></span></a><span class="mpre">           = </span><a href="#loc_53_17_53_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_17_53_21&#39;)"><span class="hl_varref"><span class="mpre">good</span></span></a><span class="mpre">

    </span><a href="Text.ParserCombinators.Poly.Base.html#loc_56_5_56_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_56_5_56_11&#39;)"><span class="hl_vardecl"><span class="mpre">oneOf&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_56_13_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_18&#39;)"><span class="hl_varref"><span class="mpre">accum</span></span></a><span class="mpre"> []
      where </span><a name="loc_56_13_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_18&#39;)"><span class="hl_fundecl"><span class="mpre">accum</span></span></a><span class="mpre"> </span><a name="loc_56_19_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_23&#39;)"><span class="hl_vardecl"><span class="mpre">errs</span></span></a><span class="mpre"> [] =
                </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;failed to parse any of the possible choices:\n&quot;</span></span><span class="mpre">
                            </span><span class="hl_infix"><span class="mpre">++</span></span><a href="Text.ParserCombinators.Poly.Base.html#loc_122_1_122_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_122_1_122_7&#39;)"><span class="hl_varref"><span class="mpre">indent</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_66_13_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_20&#39;)"><span class="hl_varref"><span class="mpre">showErr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_56_19_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_23&#39;)"><span class="hl_varref"><span class="mpre">errs</span></span></a><span class="mpre">)))
            </span><a href="#loc_56_13_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_18&#39;)"><span class="hl_fundecl"><span class="mpre">accum</span></span></a><span class="mpre"> </span><a name="loc_59_19_59_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_23&#39;)"><span class="hl_vardecl"><span class="mpre">errs</span></span></a><span class="mpre"> ((</span><a name="loc_59_26_59_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_27&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">,</span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_59_30_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_30_59_31&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_59_33_59_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_33_59_35&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) =
                </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_60_21_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_60_23_60_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_23_60_25&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">-&gt; case </span><a href="#loc_59_30_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_30_59_31&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_60_21_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_60_23_60_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_23_60_25&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> of
                           </span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> _ </span><a name="loc_61_38_61_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_38_61_41&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt;
                                       let (</span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_62_47_62_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_47_62_48&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_56_13_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_18&#39;)"><span class="hl_varref"><span class="mpre">accum</span></span></a><span class="mpre"> ((</span><a href="#loc_59_26_59_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_27&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">,</span><a href="#loc_61_38_61_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_38_61_41&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_59_19_59_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_23&#39;)"><span class="hl_varref"><span class="mpre">errs</span></span></a><span class="mpre">) </span><a href="#loc_59_33_59_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_33_59_35&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
                                       in </span><a href="#loc_62_47_62_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_47_62_48&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_60_21_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_60_23_60_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_23_60_25&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                           </span><a name="loc_64_28_64_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_28_64_29&#39;)"><span class="hl_specname"><span class="mpre">r</span></span></a><span class="mpre">@(</span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> _ </span><span class="hl_vardecl"><span class="mpre">a</span></span><span class="mpre">)  -&gt; </span><a href="#loc_64_28_64_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_28_64_29&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                           </span><a name="loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_specname"><span class="mpre">r</span></span></a><span class="mpre">@(</span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> _)  -&gt; </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> )
            </span><a name="loc_66_13_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_20&#39;)"><span class="hl_fundecl"><span class="mpre">showErr</span></span></a><span class="mpre"> (</span><a name="loc_66_22_66_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_22_66_26&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">,</span><a name="loc_66_27_66_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_27_66_30&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">) = </span><a href="#loc_66_22_66_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_22_66_26&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;:\n&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="Text.ParserCombinators.Poly.Base.html#loc_122_1_122_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_122_1_122_7&#39;)"><span class="hl_varref"><span class="mpre">indent</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_66_27_66_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_27_66_30&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/Poly/StateParser.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 1, srcSpanEndLine = 68, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/Poly/StateParser.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 8, srcSpanEndLine = 68, srcSpanEndColumn = 9}]}) (AssocLeft (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanF"><span class="mpre">infixl 6 `onFail`</span></span><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- not sure about precedence 6?</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @p `onFail` q@ means parse p, unless p fails, in which case</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   parse q instead.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Can be chained together to give multiple attempts to parse something.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   (Note that q could itself be a failing parser, e.g. to change the error</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   message from that defined in p to something different.)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   However, a severe failure in p cannot be ignored.</span></span><span class="mpre">
</span><a href="#loc_77_7_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_7_77_15&#39;)"><span class="mpre">onFail</span></a><span class="mpre"> :: </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
(</span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_77_4_77_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_4_77_5&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a name="loc_77_7_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_7_77_15&#39;)"><span class="hl_fundecl"><span class="mpre">`onFail`</span></span></a><span class="mpre"> (</span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_77_19_77_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_20&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">) = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_77_28_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_28_77_29&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_77_30_77_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_30_77_32&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">-&gt; </span><a href="#loc_79_9_79_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_17&#39;)"><span class="hl_varref"><span class="mpre">continue</span></span></a><span class="mpre"> </span><a href="#loc_77_28_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_28_77_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_77_30_77_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_30_77_32&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_77_4_77_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_4_77_5&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_77_28_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_28_77_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_77_30_77_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_30_77_32&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">)
      where
        </span><a name="loc_79_9_79_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_17&#39;)"><span class="hl_fundecl"><span class="mpre">continue</span></span></a><span class="mpre"> </span><a name="loc_79_18_79_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_18_79_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_79_20_79_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_20_79_22&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_77_19_77_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_20&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><a href="#loc_79_18_79_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_18_79_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_79_20_79_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_20_79_22&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--  continue _ _  (Committed r)   = r        -- no, remain Committed</span></span><span class="mpre">
        </span><a href="#loc_79_9_79_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_17&#39;)"><span class="hl_fundecl"><span class="mpre">continue</span></span></a><span class="mpre"> _ _  </span><a name="loc_81_23_81_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_23_81_24&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">               = </span><a href="#loc_81_23_81_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_23_81_24&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Simply return the next token in the input tokenstream.</span></span><span class="mpre">
</span><a href="#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_5&#39;)"><span class="mpre">next</span></a><span class="mpre"> :: </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_87_1_87_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_5&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre"> = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_87_12_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_87_14_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">-&gt; case </span><a href="#loc_87_14_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_16&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> of
                  []      -&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> ([],</span><a href="#loc_87_12_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_string"><span class="mpre">&quot;Ran out of input (EOF)&quot;</span></span><span class="mpre">
                  (</span><a name="loc_89_20_89_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_20_89_21&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_89_22_89_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_22_89_25&#39;)"><span class="hl_vardecl"><span class="mpre">ts&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> (</span><a href="#loc_89_22_89_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_22_89_25&#39;)"><span class="hl_varref"><span class="mpre">ts&#39;</span></span></a><span class="mpre">,</span><a href="#loc_87_12_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_89_20_89_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_20_89_21&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> )

</span><span class="hl_comment"><span class="mpre">-- | Succeed if the end of file/input has been reached, fail otherwise.</span></span><span class="mpre">
</span><a href="#loc_93_1_93_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_4&#39;)"><span class="mpre">eof</span></a><span class="mpre">  :: </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_93_1_93_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_4&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre">  = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_93_12_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_93_14_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_14_93_16&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">-&gt; case </span><a href="#loc_93_14_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_14_93_16&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> of
                  []      -&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> ([],</span><a href="#loc_93_12_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                  (</span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_vardecl"><span class="mpre">ts&#39;</span></span><span class="mpre">) -&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> (</span><a href="#loc_93_14_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_14_93_16&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">,</span><a href="#loc_93_12_93_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_string"><span class="mpre">&quot;Expected end of input (eof)&quot;</span></span><span class="mpre"> )


</span><span class="hl_comment"><span class="mpre">-- | Return the next token if it satisfies the given predicate.</span></span><span class="mpre">
</span><a href="#loc_100_1_100_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_8&#39;)"><span class="mpre">satisfy</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">-&gt;</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_100_1_100_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_8&#39;)"><span class="hl_fundecl"><span class="mpre">satisfy</span></span></a><span class="mpre"> </span><a name="loc_100_9_100_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_13&#39;)"><span class="hl_vardecl"><span class="mpre">pred</span></span></a><span class="mpre"> = do { </span><a name="loc_100_21_100_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_21_100_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre">
                  ; if </span><a href="#loc_100_9_100_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_13&#39;)"><span class="hl_varref"><span class="mpre">pred</span></span></a><span class="mpre"> </span><a href="#loc_100_21_100_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_21_100_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_100_21_100_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_21_100_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Parse.satisfy: failed&quot;</span></span><span class="mpre">
                  }
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- State handling</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Update the internal state.</span></span><span class="mpre">
</span><a href="#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_9&#39;)"><span class="mpre">stUpdate</span></a><span class="mpre">   :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_108_1_108_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_9&#39;)"><span class="hl_fundecl"><span class="mpre">stUpdate</span></span></a><span class="mpre"> </span><a name="loc_108_10_108_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_10_108_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_108_19_108_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_108_21_108_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_21_108_23&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">-&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> (</span><a href="#loc_108_21_108_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_21_108_23&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">, </span><a href="#loc_108_10_108_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_10_108_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_108_19_108_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Query the internal state.</span></span><span class="mpre">
</span><a href="#loc_112_1_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_8&#39;)"><span class="mpre">stQuery</span></a><span class="mpre">    :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_112_1_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_8&#39;)"><span class="hl_fundecl"><span class="mpre">stQuery</span></span></a><span class="mpre"> </span><a name="loc_112_9_112_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">   = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_112_19_112_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_19_112_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_112_21_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_21_112_23&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">-&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> (</span><a href="#loc_112_21_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_21_112_23&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">,</span><a href="#loc_112_19_112_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_19_112_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><a href="#loc_112_9_112_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_112_19_112_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_19_112_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Deliver the entire internal state.</span></span><span class="mpre">
</span><a href="#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_6&#39;)"><span class="mpre">stGet</span></a><span class="mpre">      :: </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_116_1_116_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_6&#39;)"><span class="hl_vardecl"><span class="mpre">stGet</span></span></a><span class="mpre">       = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_116_19_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_116_21_116_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_21_116_23&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">-&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> (</span><a href="#loc_116_21_116_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_21_116_23&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">,</span><a href="#loc_116_19_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_116_19_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_19_116_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Push some tokens back onto the front of the input stream and reparse.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This is useful e.g. for recursively expanding macros.  When the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   user-parser recognises a macro use, it can lookup the macro</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   expansion from the parse state, lex it, and then stuff the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   lexed expansion back down into the parser.</span></span><span class="mpre">
</span><a href="#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_8&#39;)"><span class="mpre">reparse</span></a><span class="mpre">    :: [</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">] -&gt; </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_126_1_126_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_8&#39;)"><span class="hl_fundecl"><span class="mpre">reparse</span></span></a><span class="mpre"> </span><a name="loc_126_9_126_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_11&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">  = </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_126_19_126_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_19_126_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_126_21_126_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_21_126_24&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre">-&gt; </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> ((</span><a href="#loc_126_9_126_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_11&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_126_21_126_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_21_126_24&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">),</span><a href="#loc_126_19_126_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_19_126_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span></div></body></html>