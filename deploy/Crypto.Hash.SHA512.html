<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ForeignFunctionInterface #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Hash.SHA512</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A module containing SHA512 bindings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Hash.SHA512
    ( Ctx(..)

    </span><span class="hl_comment"><span class="mpre">-- * Incremental hashing Functions</span></span><span class="mpre">
    , init     </span><span class="hl_comment"><span class="mpre">-- :: Ctx</span></span><span class="mpre">
    , init_t   </span><span class="hl_comment"><span class="mpre">-- :: Int -&gt; Ctx</span></span><span class="mpre">
    , update   </span><span class="hl_comment"><span class="mpre">-- :: Ctx -&gt; ByteString -&gt; Ctx</span></span><span class="mpre">
    , updates  </span><span class="hl_comment"><span class="mpre">-- :: Ctx -&gt; [ByteString] -&gt; Ctx</span></span><span class="mpre">
    , finalize </span><span class="hl_comment"><span class="mpre">-- :: Ctx -&gt; ByteString</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- * Single Pass hashing</span></span><span class="mpre">
    , hash     </span><span class="hl_comment"><span class="mpre">-- :: ByteString -&gt; ByteString</span></span><span class="mpre">
    , hashlazy </span><span class="hl_comment"><span class="mpre">-- :: ByteString -&gt; ByteString</span></span><span class="mpre">
    ) where

import Prelude hiding (init)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 8, srcSpanEndLine = 28, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Foreign.Ptr&quot;"><span class="mpre">Foreign.Ptr</span></span><span class="mpre">
import Foreign.ForeignPtr (withForeignPtr)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 8, srcSpanEndLine = 30, srcSpanEndColumn = 24}, srcInfoPoints = []}) &quot;Foreign.Storable&quot;"><span class="mpre">Foreign.Storable</span></span><span class="mpre">
import Foreign.Marshal.Alloc
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 18, srcSpanEndLine = 32, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 18, srcSpanEndLine = 33, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 8, srcSpanEndLine = 34, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Data.ByteString.Unsafe (</span><a href="Data.ByteString.Unsafe.html#loc_311_1_311_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_311_1_311_22&#39;)"><span class="mpre">unsafeUseAsCStringLen</span></a><span class="mpre">)
import Data.ByteString.Internal (</span><a href="Data.ByteString.Internal.html#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_434_1_434_7&#39;)"><span class="mpre">create</span></a><span class="mpre">, </span><a href="Data.ByteString.Internal.html#loc_405_1_405_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_405_1_405_13&#39;)"><span class="mpre">toForeignPtr</span></a><span class="mpre">)
import Data.Word
import Crypto.Hash.Internal (</span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="mpre">unsafeDoIO</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | SHA512 Context</span></span><span class="mpre">
newtype </span><a name="loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Ctx</span></span></a><span class="mpre"> = </span><a name="loc_41_15_41_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_18&#39;)"><span class="hl_condecl"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_45_1_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_11&#39;)"><span class="mpre">digestSize</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_45_1_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_11&#39;)"><span class="mpre">digestSize</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_45_1_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_11&#39;)"><span class="hl_vardecl"><span class="mpre">digestSize</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">64</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="mpre">sizeCtx</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="mpre">sizeCtx</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_vardecl"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">256</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;digestSize&quot; B.length (finalize init) = digestSize #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;hash&quot; forall b. finalize (update init b) = hash b #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;hash.list1&quot; forall b. finalize (updates init [b]) = hash b #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;hashmany&quot; forall b. finalize (foldl update init b) = hashlazy (L.fromChunks b) #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;hashlazy&quot; forall b. finalize (foldl update init $ L.toChunks b) = hashlazy b #-}</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_59_1_59_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_18&#39;)"><span class="mpre">withByteStringPtr</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_59_1_59_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_18&#39;)"><span class="mpre">withByteStringPtr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_59_1_59_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_18&#39;)"><span class="hl_fundecl"><span class="mpre">withByteStringPtr</span></span></a><span class="mpre"> </span><a name="loc_59_19_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_20&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_61_12_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_12_61_16&#39;)"><span class="hl_varref"><span class="mpre">fptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_60_28_60_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_28_60_31&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_60_28_60_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_28_60_31&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_61_18_61_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_21&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre">)
    where (</span><a name="loc_61_12_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_12_61_16&#39;)"><span class="hl_vardecl"><span class="mpre">fptr</span></span></a><span class="mpre">, </span><a name="loc_61_18_61_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_21&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre">, _) = </span><a href="Data.ByteString.Internal.html#loc_405_1_405_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_405_1_405_13&#39;)"><span class="hl_varref"><span class="mpre">toForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_59_19_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_65_1_65_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_10&#39;)"><span class="mpre">memcopy64</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_65_1_65_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_10&#39;)"><span class="mpre">memcopy64</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_65_1_65_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_10&#39;)"><span class="hl_fundecl"><span class="mpre">memcopy64</span></span></a><span class="mpre"> </span><a name="loc_65_11_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_11_65_14&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a name="loc_65_15_65_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_15_65_18&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a href="#loc_66_11_66_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_11_66_22&#39;)"><span class="hl_varref"><span class="mpre">peekAndPoke</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 39, srcSpanEndLine = 65, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 39, srcSpanEndLine = 65, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, s"><span class="mpre">[0..(32-1)]</span></span><span class="mpre">
    where </span><a name="loc_66_11_66_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_11_66_22&#39;)"><span class="hl_fundecl"><span class="mpre">peekAndPoke</span></span></a><span class="mpre"> </span><a name="loc_66_23_66_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_23_66_24&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> </span><a href="#loc_65_15_65_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_15_65_18&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_66_23_66_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_23_66_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pokeElemOff</span></span><span class="mpre"> </span><a href="#loc_65_11_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_11_65_14&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a href="#loc_66_23_66_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_23_66_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="mpre">withCtxCopy</span></a><span class="mpre"> :: </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_fundecl"><span class="mpre">withCtxCopy</span></span></a><span class="mpre"> (</span><a href="#loc_41_15_41_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_18&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><a name="loc_69_18_69_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_18_69_22&#39;)"><span class="hl_vardecl"><span class="mpre">ctxB</span></span></a><span class="mpre">) </span><a name="loc_69_24_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_24_69_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_41_15_41_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_18&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_70_11_70_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_11_70_20&#39;)"><span class="hl_varref"><span class="mpre">createCtx</span></span></a><span class="mpre">
    where </span><a name="loc_70_11_70_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_11_70_20&#39;)"><span class="hl_vardecl"><span class="mpre">createCtx</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">create</span></span></a><span class="mpre"> </span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_varref"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_70_41_70_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_41_70_47&#39;)"><span class="hl_vardecl"><span class="mpre">dstPtr</span></span></a><span class="mpre"> -&gt;
                      </span><a href="#loc_59_1_59_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_18&#39;)"><span class="hl_varref"><span class="mpre">withByteStringPtr</span></span></a><span class="mpre"> </span><a href="#loc_69_18_69_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_18_69_22&#39;)"><span class="hl_varref"><span class="mpre">ctxB</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_71_49_71_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_49_71_55&#39;)"><span class="hl_vardecl"><span class="mpre">srcPtr</span></span></a><span class="mpre"> -&gt; do
                          </span><a href="#loc_65_1_65_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_10&#39;)"><span class="hl_varref"><span class="mpre">memcopy64</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_70_41_70_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_41_70_47&#39;)"><span class="hl_varref"><span class="mpre">dstPtr</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_71_49_71_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_49_71_55&#39;)"><span class="hl_varref"><span class="mpre">srcPtr</span></span></a><span class="mpre">)
                          </span><a href="#loc_69_24_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_24_69_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_70_41_70_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_41_70_47&#39;)"><span class="hl_varref"><span class="mpre">dstPtr</span></span></a><span class="mpre">)

</span><a href="#loc_76_1_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_13&#39;)"><span class="mpre">withCtxThrow</span></a><span class="mpre"> :: </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_76_1_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_13&#39;)"><span class="hl_fundecl"><span class="mpre">withCtxThrow</span></span></a><span class="mpre"> (</span><a href="#loc_41_15_41_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_18&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><a name="loc_76_19_76_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_23&#39;)"><span class="hl_vardecl"><span class="mpre">ctxB</span></span></a><span class="mpre">) </span><a name="loc_76_25_76_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_25_76_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
    </span><a href="Foreign.Marshal.Alloc.html#loc_121_1_121_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_121_1_121_12&#39;)"><span class="hl_varref"><span class="mpre">allocaBytes</span></span></a><span class="mpre"> </span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_varref"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_77_28_77_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_28_77_34&#39;)"><span class="hl_vardecl"><span class="mpre">dstPtr</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_59_1_59_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_18&#39;)"><span class="hl_varref"><span class="mpre">withByteStringPtr</span></span></a><span class="mpre"> </span><a href="#loc_76_19_76_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_23&#39;)"><span class="hl_varref"><span class="mpre">ctxB</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_78_31_78_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_31_78_37&#39;)"><span class="hl_vardecl"><span class="mpre">srcPtr</span></span></a><span class="mpre"> -&gt; do
        </span><a href="#loc_65_1_65_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_10&#39;)"><span class="hl_varref"><span class="mpre">memcopy64</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_77_28_77_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_28_77_34&#39;)"><span class="hl_varref"><span class="mpre">dstPtr</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_78_31_78_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_31_78_37&#39;)"><span class="hl_varref"><span class="mpre">srcPtr</span></span></a><span class="mpre">)
        </span><a href="#loc_76_25_76_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_25_76_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_77_28_77_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_28_77_34&#39;)"><span class="hl_varref"><span class="mpre">dstPtr</span></span></a><span class="mpre">)

</span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="mpre">withCtxNew</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_fundecl"><span class="mpre">withCtxNew</span></span></a><span class="mpre"> </span><a name="loc_83_12_83_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_12_83_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_41_15_41_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_18&#39;)"><span class="hl_conref"><span class="mpre">Ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">create</span></span></a><span class="mpre"> </span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_varref"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> (</span><a href="#loc_83_12_83_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_12_83_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre">)

</span><a href="#loc_86_1_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_16&#39;)"><span class="mpre">withCtxNewThrow</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_86_1_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_16&#39;)"><span class="hl_fundecl"><span class="mpre">withCtxNewThrow</span></span></a><span class="mpre"> </span><a name="loc_86_17_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="Foreign.Marshal.Alloc.html#loc_121_1_121_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_121_1_121_12&#39;)"><span class="hl_varref"><span class="mpre">allocaBytes</span></span></a><span class="mpre"> </span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_varref"><span class="mpre">sizeCtx</span></span></a><span class="mpre"> (</span><a href="#loc_86_17_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre">)

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 1, srcSpanEndLine = 89, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 1, srcSpanEndLine = 88, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanS"><span class="mpre">foreign import ccall unsafe &quot;sha512.h sha512_init&quot;
    c_sha512_init :: Ptr Ctx -&gt; IO ()</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 1, srcSpanEndLine = 92, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 1, srcSpanEndLine = 91, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanS"><span class="mpre">foreign import ccall &quot;sha512.h sha512_update&quot;
    c_sha512_update :: Ptr Ctx -&gt; Ptr Word8 -&gt; Word32 -&gt; IO ()</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 1, srcSpanEndLine = 95, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 1, srcSpanEndLine = 94, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanS"><span class="mpre">foreign import ccall unsafe &quot;sha512.h sha512_finalize&quot;
    c_sha512_finalize :: Ptr Ctx -&gt; Ptr Word8 -&gt; IO ()</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 1, srcSpanEndLine = 98, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 1, srcSpanEndLine = 97, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryptohash-0.11.6/Crypto/Hash/SHA512.hs&quot;, srcSpanS"><span class="mpre">foreign import ccall unsafe &quot;sha512.h sha512_init_t&quot;
    c_sha512_init_t :: Ptr Ctx -&gt; Int -&gt; IO ()</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_103_1_103_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_7&#39;)"><span class="mpre">init_t</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | init a context using FIPS 180-4 for truncated SHA512</span></span><span class="mpre">
</span><a href="#loc_103_1_103_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_7&#39;)"><span class="mpre">init_t</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_103_1_103_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_7&#39;)"><span class="hl_fundecl"><span class="mpre">init_t</span></span></a><span class="mpre"> </span><a name="loc_103_8_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_8_103_9&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_varref"><span class="mpre">withCtxNew</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_103_39_103_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_39_103_42&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">c_sha512_init_t</span></span><span class="mpre"> </span><a href="#loc_103_39_103_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_39_103_42&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_103_8_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_8_103_9&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><a href="#loc_106_1_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_17&#39;)"><span class="mpre">updateInternalIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_106_1_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_17&#39;)"><span class="hl_fundecl"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a name="loc_106_18_106_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_18_106_21&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_106_22_106_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_22_106_23&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> =
    </span><a href="Data.ByteString.Unsafe.html#loc_311_1_311_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_311_1_311_22&#39;)"><span class="hl_varref"><span class="mpre">unsafeUseAsCStringLen</span></span></a><span class="mpre"> </span><a href="#loc_106_22_106_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_22_106_23&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> (\(</span><a name="loc_107_32_107_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_32_107_34&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a name="loc_107_36_107_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_36_107_39&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">c_sha512_update</span></span><span class="mpre"> </span><a href="#loc_106_18_106_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_18_106_21&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_107_32_107_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_32_107_34&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_107_36_107_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_36_107_39&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">))

</span><a href="#loc_110_1_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_19&#39;)"><span class="mpre">finalizeInternalIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_110_1_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_19&#39;)"><span class="hl_fundecl"><span class="mpre">finalizeInternalIO</span></span></a><span class="mpre"> </span><a name="loc_110_20_110_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_20_110_23&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">create</span></span></a><span class="mpre"> </span><a href="#loc_45_1_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_11&#39;)"><span class="hl_varref"><span class="mpre">digestSize</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">c_sha512_finalize</span></span><span class="mpre"> </span><a href="#loc_110_20_110_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_20_110_23&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">)

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_115_1_115_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_5&#39;)"><span class="mpre">init</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | init a context</span></span><span class="mpre">
</span><a href="#loc_115_1_115_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_5&#39;)"><span class="mpre">init</span></a><span class="mpre"> :: </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_115_1_115_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_5&#39;)"><span class="hl_vardecl"><span class="mpre">init</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_varref"><span class="mpre">withCtxNew</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">c_sha512_init</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_120_1_120_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_7&#39;)"><span class="mpre">update</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | update a context with a bytestring</span></span><span class="mpre">
</span><a href="#loc_120_1_120_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_7&#39;)"><span class="mpre">update</span></a><span class="mpre"> :: </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_120_1_120_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_7&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> </span><a name="loc_120_8_120_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_8_120_11&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_120_12_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_12_120_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_varref"><span class="mpre">withCtxCopy</span></span></a><span class="mpre"> </span><a href="#loc_120_8_120_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_8_120_11&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_120_48_120_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_48_120_51&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_106_1_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_17&#39;)"><span class="hl_varref"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_120_48_120_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_48_120_51&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_120_12_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_12_120_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_125_1_125_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_8&#39;)"><span class="mpre">updates</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | updates a context with multiples bytestring</span></span><span class="mpre">
</span><a href="#loc_125_1_125_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_8&#39;)"><span class="mpre">updates</span></a><span class="mpre"> :: </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre">
</span><a name="loc_125_1_125_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_8&#39;)"><span class="hl_fundecl"><span class="mpre">updates</span></span></a><span class="mpre"> </span><a name="loc_125_9_125_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_9_125_12&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_125_13_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_13_125_14&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_varref"><span class="mpre">withCtxCopy</span></span></a><span class="mpre"> </span><a href="#loc_125_9_125_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_9_125_12&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_125_49_125_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_49_125_52&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><a href="#loc_106_1_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_17&#39;)"><span class="hl_varref"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_125_49_125_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_49_125_52&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">) </span><a href="#loc_125_13_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_13_125_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_130_1_130_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_9&#39;)"><span class="mpre">finalize</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | finalize the context into a digest bytestring</span></span><span class="mpre">
</span><a href="#loc_130_1_130_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_9&#39;)"><span class="mpre">finalize</span></a><span class="mpre"> :: </span><a href="#loc_41_9_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_12&#39;)"><span class="hl_tyconref"><span class="mpre">Ctx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_130_1_130_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">finalize</span></span></a><span class="mpre"> </span><a name="loc_130_10_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_10_130_13&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_76_1_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_13&#39;)"><span class="hl_varref"><span class="mpre">withCtxThrow</span></span></a><span class="mpre"> </span><a href="#loc_130_10_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_10_130_13&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_110_1_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_19&#39;)"><span class="hl_varref"><span class="mpre">finalizeInternalIO</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_135_1_135_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_5&#39;)"><span class="mpre">hash</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | hash a strict bytestring into a digest bytestring</span></span><span class="mpre">
</span><a href="#loc_135_1_135_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_5&#39;)"><span class="mpre">hash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_135_1_135_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_5&#39;)"><span class="hl_fundecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_135_6_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_6_135_7&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_86_1_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_16&#39;)"><span class="hl_varref"><span class="mpre">withCtxNewThrow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_135_42_135_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_42_135_45&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">c_sha512_init</span></span><span class="mpre"> </span><a href="#loc_135_42_135_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_42_135_45&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_106_1_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_17&#39;)"><span class="hl_varref"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_135_42_135_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_42_135_45&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_135_6_135_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_6_135_7&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_110_1_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_19&#39;)"><span class="hl_varref"><span class="mpre">finalizeInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_135_42_135_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_42_135_45&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_141_1_141_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_9&#39;)"><span class="mpre">hashlazy</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | hash a lazy bytestring into a digest bytestring</span></span><span class="mpre">
</span><a href="#loc_141_1_141_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_9&#39;)"><span class="mpre">hashlazy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_141_1_141_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_9&#39;)"><span class="hl_fundecl"><span class="mpre">hashlazy</span></span></a><span class="mpre"> </span><a name="loc_141_10_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_10_141_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.Internal.html#loc_20_1_20_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.Internal.html#loc_20_1_20_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeDoIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_86_1_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_16&#39;)"><span class="hl_varref"><span class="mpre">withCtxNewThrow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_141_46_141_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_46_141_49&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">c_sha512_init</span></span><span class="mpre"> </span><a href="#loc_141_46_141_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_46_141_49&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><a href="#loc_106_1_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_17&#39;)"><span class="hl_varref"><span class="mpre">updateInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_141_46_141_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_46_141_49&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_141_10_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_10_141_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_110_1_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_19&#39;)"><span class="hl_varref"><span class="mpre">finalizeInternalIO</span></span></a><span class="mpre"> </span><a href="#loc_141_46_141_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_46_141_49&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
</span></div></body></html>