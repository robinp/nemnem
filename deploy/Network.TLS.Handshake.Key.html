<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Handshake.Key</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- functions for RSA operations</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Handshake.Key
    ( encryptRSA
    , signRSA
    , decryptRSA
    , verifyRSA
    , generateDHE
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Handshake/Key.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Handshake/Key.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 18, srcSpanEndLine = 19, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B

import Network.TLS.Handshake.State
import Network.TLS.State (</span><a href="Network.TLS.State.html#loc_213_1_213_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_213_1_213_8&#39;)"><span class="mpre">withRNG</span></a><span class="mpre">, </span><a href="Network.TLS.State.html#loc_165_1_165_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_165_1_165_11&#39;)"><span class="mpre">getVersion</span></a><span class="mpre">)
import Network.TLS.Crypto
import Network.TLS.Types
import Network.TLS.Context.Internal

</span><span class="hl_comment"><span class="mpre">{- if the RSA encryption fails we just return an empty bytestring, and let the protocol
 - fail by itself; however it would be probably better to just report it since it&#39;s an internal problem.
 -}</span></span><span class="mpre">
</span><a href="#loc_31_1_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_11&#39;)"><span class="mpre">encryptRSA</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_31_1_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_11&#39;)"><span class="hl_fundecl"><span class="mpre">encryptRSA</span></span></a><span class="mpre"> </span><a name="loc_31_12_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_12_31_15&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_31_16_31_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_16_31_23&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = do
    </span><a name="loc_32_5_32_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_5_32_14&#39;)"><span class="hl_vardecl"><span class="mpre">publicKey</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_186_1_186_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_186_1_186_12&#39;)"><span class="hl_varref"><span class="mpre">usingHState</span></span></a><span class="mpre"> </span><a href="#loc_31_12_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_12_31_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="Network.TLS.Handshake.State.html#loc_130_1_130_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.State.html#loc_130_1_130_19&#39;)"><span class="hl_varref"><span class="mpre">getRemotePublicKey</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Context.Internal.html#loc_183_1_183_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_183_1_183_12&#39;)"><span class="hl_varref"><span class="mpre">usingState_</span></span></a><span class="mpre"> </span><a href="#loc_31_12_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_12_31_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_34_9_34_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">      &lt;- </span><a href="Network.TLS.State.html#loc_213_1_213_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_213_1_213_8&#39;)"><span class="hl_varref"><span class="mpre">withRNG</span></span></a><span class="mpre"> (\</span><a name="loc_34_29_34_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_29_34_30&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Crypto.html#loc_137_1_137_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_137_1_137_10&#39;)"><span class="hl_varref"><span class="mpre">kxEncrypt</span></span></a><span class="mpre"> </span><a href="#loc_34_29_34_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_29_34_30&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_32_5_32_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_5_32_14&#39;)"><span class="hl_varref"><span class="mpre">publicKey</span></span></a><span class="mpre"> </span><a href="#loc_31_16_31_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_16_31_23&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">)
        case </span><a href="#loc_34_9_34_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_36_18_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_18_36_21&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">       -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;rsa encrypt failed: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_36_18_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_18_36_21&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)
            </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_37_19_37_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_27&#39;)"><span class="hl_vardecl"><span class="mpre">econtent</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_37_19_37_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_27&#39;)"><span class="hl_varref"><span class="mpre">econtent</span></span></a><span class="mpre">

</span><a href="#loc_40_1_40_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_8&#39;)"><span class="mpre">signRSA</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Types.html#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Role</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_40_1_40_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_8&#39;)"><span class="hl_fundecl"><span class="mpre">signRSA</span></span></a><span class="mpre"> </span><a name="loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> _ </span><a name="loc_40_15_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_15_40_18&#39;)"><span class="hl_vardecl"><span class="mpre">hsh</span></span></a><span class="mpre"> </span><a name="loc_40_19_40_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_19_40_26&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = do
    </span><a name="loc_41_5_41_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_15&#39;)"><span class="hl_vardecl"><span class="mpre">privateKey</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_186_1_186_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_186_1_186_12&#39;)"><span class="hl_varref"><span class="mpre">usingHState</span></span></a><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="Network.TLS.Handshake.State.html#loc_133_1_133_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.State.html#loc_133_1_133_19&#39;)"><span class="hl_varref"><span class="mpre">getLocalPrivateKey</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Context.Internal.html#loc_183_1_183_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_183_1_183_12&#39;)"><span class="hl_varref"><span class="mpre">usingState_</span></span></a><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_43_9_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">      &lt;- </span><a href="Network.TLS.State.html#loc_213_1_213_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_213_1_213_8&#39;)"><span class="hl_varref"><span class="mpre">withRNG</span></span></a><span class="mpre"> (\</span><a name="loc_43_29_43_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_29_43_30&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Crypto.html#loc_161_1_161_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_161_1_161_7&#39;)"><span class="hl_varref"><span class="mpre">kxSign</span></span></a><span class="mpre"> </span><a href="#loc_43_29_43_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_29_43_30&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_41_5_41_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_15&#39;)"><span class="hl_varref"><span class="mpre">privateKey</span></span></a><span class="mpre"> </span><a href="#loc_40_15_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_15_40_18&#39;)"><span class="hl_varref"><span class="mpre">hsh</span></span></a><span class="mpre"> </span><a href="#loc_40_19_40_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_19_40_26&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">)
        case </span><a href="#loc_43_9_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_45_18_45_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_18_45_21&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">       -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;rsa sign failed: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_45_18_45_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_18_45_21&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)
            </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_46_19_46_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_27&#39;)"><span class="hl_vardecl"><span class="mpre">econtent</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_46_19_46_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_27&#39;)"><span class="hl_varref"><span class="mpre">econtent</span></span></a><span class="mpre">

</span><a href="#loc_49_1_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_11&#39;)"><span class="mpre">decryptRSA</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Crypto.html#loc_54_6_54_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_54_6_54_13&#39;)"><span class="hl_tyconref"><span class="mpre">KxError</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_49_1_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_11&#39;)"><span class="hl_fundecl"><span class="mpre">decryptRSA</span></span></a><span class="mpre"> </span><a name="loc_49_12_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_12_49_15&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_49_16_49_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_16_49_24&#39;)"><span class="hl_vardecl"><span class="mpre">econtent</span></span></a><span class="mpre"> = do
    </span><a name="loc_50_5_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_15&#39;)"><span class="hl_vardecl"><span class="mpre">privateKey</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_186_1_186_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_186_1_186_12&#39;)"><span class="hl_varref"><span class="mpre">usingHState</span></span></a><span class="mpre"> </span><a href="#loc_49_12_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_12_49_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="Network.TLS.Handshake.State.html#loc_133_1_133_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.State.html#loc_133_1_133_19&#39;)"><span class="hl_varref"><span class="mpre">getLocalPrivateKey</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Context.Internal.html#loc_183_1_183_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_183_1_183_12&#39;)"><span class="hl_varref"><span class="mpre">usingState_</span></span></a><span class="mpre"> </span><a href="#loc_49_12_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_12_49_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_52_9_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_12&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre">     &lt;- </span><a href="Network.TLS.State.html#loc_165_1_165_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_165_1_165_11&#39;)"><span class="hl_varref"><span class="mpre">getVersion</span></span></a><span class="mpre">
        let </span><a name="loc_53_13_53_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_13_53_19&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> = if </span><a href="#loc_52_9_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_12&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="Network.TLS.Types.html#loc_25_30_25_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_30_25_35&#39;)"><span class="hl_conref"><span class="mpre">TLS10</span></span></a><span class="mpre"> then </span><a href="#loc_49_16_49_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_16_49_24&#39;)"><span class="hl_varref"><span class="mpre">econtent</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_49_16_49_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_16_49_24&#39;)"><span class="hl_varref"><span class="mpre">econtent</span></span></a><span class="mpre">
        </span><a href="Network.TLS.State.html#loc_213_1_213_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_213_1_213_8&#39;)"><span class="hl_varref"><span class="mpre">withRNG</span></span></a><span class="mpre"> (\</span><a name="loc_54_19_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_20&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Crypto.html#loc_141_1_141_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_141_1_141_10&#39;)"><span class="hl_varref"><span class="mpre">kxDecrypt</span></span></a><span class="mpre"> </span><a href="#loc_54_19_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_20&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_50_5_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_15&#39;)"><span class="hl_varref"><span class="mpre">privateKey</span></span></a><span class="mpre"> </span><a href="#loc_53_13_53_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_13_53_19&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">)

</span><a href="#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_10&#39;)"><span class="mpre">verifyRSA</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Types.html#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Role</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_57_1_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_10&#39;)"><span class="hl_fundecl"><span class="mpre">verifyRSA</span></span></a><span class="mpre"> </span><a name="loc_57_11_57_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_14&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> _ </span><a name="loc_57_17_57_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_20&#39;)"><span class="hl_vardecl"><span class="mpre">hsh</span></span></a><span class="mpre"> </span><a name="loc_57_21_57_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_21_57_29&#39;)"><span class="hl_vardecl"><span class="mpre">econtent</span></span></a><span class="mpre"> </span><a name="loc_57_30_57_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_30_57_34&#39;)"><span class="hl_vardecl"><span class="mpre">sign</span></span></a><span class="mpre"> = do
    </span><a name="loc_58_5_58_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_14&#39;)"><span class="hl_vardecl"><span class="mpre">publicKey</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_186_1_186_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_186_1_186_12&#39;)"><span class="hl_varref"><span class="mpre">usingHState</span></span></a><span class="mpre"> </span><a href="#loc_57_11_57_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_14&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="Network.TLS.Handshake.State.html#loc_130_1_130_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Handshake.State.html#loc_130_1_130_19&#39;)"><span class="hl_varref"><span class="mpre">getRemotePublicKey</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Crypto.html#loc_148_1_148_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_148_1_148_9&#39;)"><span class="hl_varref"><span class="mpre">kxVerify</span></span></a><span class="mpre"> </span><a href="#loc_58_5_58_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_14&#39;)"><span class="hl_varref"><span class="mpre">publicKey</span></span></a><span class="mpre"> </span><a href="#loc_57_17_57_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_20&#39;)"><span class="hl_varref"><span class="mpre">hsh</span></span></a><span class="mpre"> </span><a href="#loc_57_21_57_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_21_57_29&#39;)"><span class="hl_varref"><span class="mpre">econtent</span></span></a><span class="mpre"> </span><a href="#loc_57_30_57_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_30_57_34&#39;)"><span class="hl_varref"><span class="mpre">sign</span></span></a><span class="mpre">

</span><a href="#loc_62_1_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_12&#39;)"><span class="mpre">generateDHE</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DHParams</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">DHPrivate</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">DHPublic</span></span><span class="mpre">)
</span><a name="loc_62_1_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_12&#39;)"><span class="hl_fundecl"><span class="mpre">generateDHE</span></span></a><span class="mpre"> </span><a name="loc_62_13_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_13_62_16&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_62_17_62_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_17_62_20&#39;)"><span class="hl_vardecl"><span class="mpre">dhp</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Context.Internal.html#loc_183_1_183_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_183_1_183_12&#39;)"><span class="hl_varref"><span class="mpre">usingState_</span></span></a><span class="mpre"> </span><a href="#loc_62_13_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_13_62_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.State.html#loc_213_1_213_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.State.html#loc_213_1_213_8&#39;)"><span class="hl_varref"><span class="mpre">withRNG</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_62_52_62_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_52_62_55&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Crypto.DH.html#loc_39_1_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.DH.html#loc_39_1_39_18&#39;)"><span class="hl_varref"><span class="mpre">dhGenerateKeyPair</span></span></a><span class="mpre"> </span><a href="#loc_62_52_62_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_52_62_55&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_62_17_62_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_17_62_20&#39;)"><span class="hl_varref"><span class="mpre">dhp</span></span></a><span class="mpre">
</span></div></body></html>