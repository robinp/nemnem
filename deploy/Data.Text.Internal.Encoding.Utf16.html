<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE MagicHash, BangPatterns #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Text.Internal.Encoding.Utf16</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2008, 2009 Tom Harper,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) 2009 Bryan O&#39;Sullivan,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) 2009 Duncan Coutts</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Warning/: this is an internal module, and does not have a stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- API or name. Functions in this module may not check or enforce</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- preconditions expected by public modules. Use at your own risk!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Basic UTF-16 validation and character manipulation.</span></span><span class="mpre">
module Data.Text.Internal.Encoding.Utf16
    (
      chr2
    , validate1
    , validate2
    ) where

import GHC.Exts
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Encoding/Utf16.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 8, srcSpanEndLine = 27, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Word&quot;"><span class="mpre">GHC.Word</span></span><span class="mpre"> (Word16(..))

</span><a href="#loc_30_1_30_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_5&#39;)"><span class="mpre">chr2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_30_1_30_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_5&#39;)"><span class="hl_fundecl"><span class="mpre">chr2</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">W16#</span></span><span class="mpre"> </span><a name="loc_30_12_30_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_12_30_14&#39;)"><span class="hl_vardecl"><span class="mpre">a#</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">W16#</span></span><span class="mpre"> </span><a name="loc_30_22_30_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_22_30_24&#39;)"><span class="hl_vardecl"><span class="mpre">b#</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">C#</span></span><span class="mpre"> (</span><a href="GHC.Prim.html#loc_1491_1_1491_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1491_1_1491_5&#39;)"><span class="hl_varref"><span class="mpre">chr#</span></span></a><span class="mpre"> (</span><a href="#loc_34_8_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_8_34_14&#39;)"><span class="hl_varref"><span class="mpre">upper#</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1388_1_1388_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1388_1_1388_5&#39;)"><span class="hl_infix"><span class="mpre">+#</span></span></a><span class="mpre"> </span><a href="#loc_35_8_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_8_35_14&#39;)"><span class="hl_varref"><span class="mpre">lower#</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1388_1_1388_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1388_1_1388_5&#39;)"><span class="hl_infix"><span class="mpre">+#</span></span></a><span class="mpre"> 0x10000#))
    where
      !</span><a name="loc_32_8_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_8_32_10&#39;)"><span class="hl_vardecl"><span class="mpre">x#</span></span></a><span class="mpre"> = </span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="hl_varref"><span class="mpre">word2Int#</span></span></a><span class="mpre"> </span><a href="#loc_30_12_30_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_12_30_14&#39;)"><span class="hl_varref"><span class="mpre">a#</span></span></a><span class="mpre">
      !</span><a name="loc_33_8_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_8_33_10&#39;)"><span class="hl_vardecl"><span class="mpre">y#</span></span></a><span class="mpre"> = </span><a href="GHC.Prim.html#loc_1580_1_1580_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1580_1_1580_10&#39;)"><span class="hl_varref"><span class="mpre">word2Int#</span></span></a><span class="mpre"> </span><a href="#loc_30_22_30_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_22_30_24&#39;)"><span class="hl_varref"><span class="mpre">b#</span></span></a><span class="mpre">
      !</span><a name="loc_34_8_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_8_34_14&#39;)"><span class="hl_vardecl"><span class="mpre">upper#</span></span></a><span class="mpre"> = </span><a href="GHC.Prim.html#loc_1512_1_1512_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1512_1_1512_18&#39;)"><span class="hl_varref"><span class="mpre">uncheckedIShiftL#</span></span></a><span class="mpre"> (</span><a href="#loc_32_8_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_8_32_10&#39;)"><span class="hl_varref"><span class="mpre">x#</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 0xD800#) 10#
      !</span><a name="loc_35_8_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_8_35_14&#39;)"><span class="hl_vardecl"><span class="mpre">lower#</span></span></a><span class="mpre"> = </span><a href="#loc_33_8_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_8_33_10&#39;)"><span class="hl_varref"><span class="mpre">y#</span></span></a><span class="mpre"> </span><a href="GHC.Prim.html#loc_1392_1_1392_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_1392_1_1392_5&#39;)"><span class="hl_infix"><span class="mpre">-#</span></span></a><span class="mpre"> 0xDC00#
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_30_1_30_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_5&#39;)"><span class="mpre">chr2</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="mpre">validate1</span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_fundecl"><span class="mpre">validate1</span></span></a><span class="mpre"> </span><a name="loc_39_11_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_13&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> = </span><a href="#loc_39_11_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_39_11_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDFFF</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="mpre">validate1</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_43_1_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_10&#39;)"><span class="mpre">validate2</span></a><span class="mpre">       ::  </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_43_1_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_10&#39;)"><span class="hl_fundecl"><span class="mpre">validate2</span></span></a><span class="mpre"> </span><a name="loc_43_11_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_13&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_43_14_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_16&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><a href="#loc_43_11_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_43_11_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDBFF</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
                  </span><a href="#loc_43_14_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_16&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDC00</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_43_14_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_16&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDFFF</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_43_1_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_10&#39;)"><span class="mpre">validate2</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>