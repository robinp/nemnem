<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
module Network.HTTP.Client.RequestSpec where

import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)
import Control.Monad (</span><a href="Control.Monad.html#loc_204_1_204_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_204_1_204_5&#39;)"><span class="mpre">join</span></a><span class="mpre">)
import Data.Maybe (</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="mpre">isJust</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/RequestSpec.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 8, srcSpanEndLine = 7, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import Network.HTTP.Client (parseUrl, </span><a href="Network.HTTP.Client.Types.html#loc_306_7_306_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_306_7_306_21&#39;)"><span class="mpre">requestHeaders</span></a><span class="mpre">, applyBasicProxyAuth)
import Control.Monad (</span><a href="Control.Monad.html#loc_168_1_168_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_168_1_168_6&#39;)"><span class="mpre">forM_</span></a><span class="mpre">)

</span><a href="#loc_12_1_12_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_5&#39;)"><span class="mpre">spec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_12_1_12_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_5&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> = do
  </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;case insensitive scheme&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="Control.Monad.html#loc_168_1_168_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_168_1_168_6&#39;)"><span class="hl_varref"><span class="mpre">forM_</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;http://example.com&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;httP://example.com&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;HttP://example.com&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;HttPs://example.com&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_14_104_14_107" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_104_14_107&#39;)"><span class="hl_vardecl"><span class="mpre">url</span></span></a><span class="mpre"> -&gt;
      </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><a href="#loc_14_104_14_107" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_104_14_107&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><a href="#loc_14_104_14_107" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_104_14_107&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;failed&quot;</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="Control.Monad.html#loc_168_1_168_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_168_1_168_6&#39;)"><span class="hl_varref"><span class="mpre">forM_</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ftp://example.com&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_18_36_18_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_36_18_39&#39;)"><span class="hl_vardecl"><span class="mpre">url</span></span></a><span class="mpre"> -&gt;
      </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><a href="#loc_18_36_18_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_36_18_39&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><a href="#loc_18_36_18_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_36_18_39&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_21_14_21_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_14_21_17&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_21_14_21_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_14_21_17&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;applyBasicProxyAuth&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    let </span><a name="loc_23_9_23_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_9_23_16&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">applyBasicProxyAuth</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;user&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;pass&quot;</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;http://example.org&quot;</span></span><span class="mpre">
        </span><a name="loc_24_9_24_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_14&#39;)"><span class="hl_vardecl"><span class="mpre">field</span></span></a><span class="mpre">   = </span><a href="Control.Monad.html#loc_204_1_204_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_204_1_204_5&#39;)"><span class="hl_varref"><span class="mpre">join</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Proxy-Authorization&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_306_7_306_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_306_7_306_21&#39;)"><span class="hl_varref"><span class="mpre">requestHeaders</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_23_9_23_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_9_23_16&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Should add a proxy-authorization header&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
      </span><a href="#loc_24_9_24_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_14&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldSatisfy`</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Should add a proxy-authorization header with the specified username and password.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
      </span><a href="#loc_24_9_24_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_14&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Basic dXNlcjpwYXNz&quot;</span></span><span class="mpre">
</span></div></body></html>