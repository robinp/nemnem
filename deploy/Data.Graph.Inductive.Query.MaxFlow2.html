<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | Alternative Maximum Flow</span></span><span class="mpre">
module Data.Graph.Inductive.Query.MaxFlow2(
    Network,
    ekSimple, ekFused, ekList,
) where

</span><span class="hl_comment"><span class="mpre">--   ekSimple, ekFused, ekList) where</span></span><span class="mpre">


import Data.Maybe

import Data.Graph.Inductive.Graph
import Data.Graph.Inductive.PatriciaTree
import Data.Graph.Inductive.Internal.FiniteMap
import Data.Graph.Inductive.Internal.Queue
import Data.Graph.Inductive.Query.BFS (</span><a href="Data.Graph.Inductive.Query.BFS.html#loc_97_1_97_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Query.BFS.html#loc_97_1_97_4&#39;)"><span class="mpre">bft</span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Data types</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Network data type</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">type Network = Gr () (Double, Double)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Data type for direction in which an edge is traversed</span></span><span class="mpre">
data </span><span class="hl_tycondecl"><span class="mpre">Direction</span></span><span class="mpre"> = </span><a name="loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_condecl"><span class="mpre">Forward</span></span></a><span class="mpre"> | </span><a name="loc_26_28_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_28_26_36&#39;)"><span class="hl_condecl"><span class="mpre">Backward</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 5, srcSpanEndLine = 27, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 5, srcSpanEndLine = 27, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/In"><span class="mpre">deriving (Eq, Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Data type for edge with direction of traversal</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 30, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 30, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">type DirEdge b = (Node, Node, b, Direction)</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 1, srcSpanEndLine = 32, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 1, srcSpanEndLine = 32, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">type DirPath=[(Node, Direction)]</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 1, srcSpanEndLine = 33, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 1, srcSpanEndLine = 33, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">type DirRTree=[DirPath]</span></span><span class="mpre">

</span><a name="loc_35_1_35_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_16&#39;)"><span class="hl_vardecl"><span class="mpre">pathFromDirPath</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_35_26_35_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_26_35_27&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,_)-&gt;</span><a href="#loc_35_26_35_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_26_35_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example networks</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Example number 1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This network has a maximum flow of 2000</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-
exampleNetwork1 :: Network
exampleNetwork1=mkGraph [ (1,()), (2,()), (3,()), (4,()) ]
    [ (1,2,(1000,0)), (1,3,(1000,0)),
    (2,3,(1,0)), (2,4,(1000,0)), (3,4,(1000,0)) ]

-- Example number 2
-- Taken from &quot;Introduction to Algorithms&quot; (Cormen, Leiserson, Rivest)
-- This network has a maximum flow of 23
exampleNetwork2 :: Network
-- Names of nodes in &quot;Introduction to Algorithms&quot;:
-- 1: s
-- 2: v1
-- 3: v2
-- 4: v3
-- 5: v4
-- 6: t
exampleNetwork2=mkGraph [ (1,()), (2,()), (3,()), (4,()), (5,()), (6,()) ]
    [ (1, 2, (16, 0)),
    (1, 3, (13, 0)),
    (2, 3, (10, 0)),
    (3, 2, (4, 0)),
    (2, 4, (12, 0)),
    (3, 5, (14, 0)),
    (4, 3, (9, 0)),
    (5, 4, (7, 0)),
    (4, 6, (20, 0)),
    (5, 6, (4, 0)) ]
-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Implementation of Edmonds-Karp algorithm</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- EXTRACT fglEdmondsFused.txt</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Compute an augmenting path</span></span><span class="mpre">
</span><a href="#loc_77_1_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_13&#39;)"><span class="mpre">augPathFused</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">DirPath</span></span><span class="mpre">
</span><a name="loc_77_1_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_13&#39;)"><span class="hl_fundecl"><span class="mpre">augPathFused</span></span></a><span class="mpre"> </span><a name="loc_77_14_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_14_77_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_77_16_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_16_77_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_109_1_109_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_109_1_109_12&#39;)"><span class="hl_varref"><span class="mpre">listToMaybe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\((</span><a name="loc_78_16_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_17&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><a href="#loc_78_16_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_17&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="#loc_79_11_79_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_15&#39;)"><span class="hl_varref"><span class="mpre">tree</span></span></a><span class="mpre">
    where </span><a name="loc_79_11_79_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_15&#39;)"><span class="hl_vardecl"><span class="mpre">tree</span></span></a><span class="mpre"> = </span><a href="#loc_83_1_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_9&#39;)"><span class="hl_varref"><span class="mpre">bftForEK</span></span></a><span class="mpre"> </span><a href="#loc_77_16_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_16_77_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_77_14_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_14_77_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Breadth First Search wrapper function</span></span><span class="mpre">
</span><a href="#loc_83_1_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_9&#39;)"><span class="mpre">bftForEK</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DirRTree</span></span><span class="mpre">
</span><a name="loc_83_1_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_9&#39;)"><span class="hl_fundecl"><span class="mpre">bftForEK</span></span></a><span class="mpre"> </span><a name="loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="hl_varref"><span class="mpre">bfForEK</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_15_1_15_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_15_1_15_9&#39;)"><span class="hl_varref"><span class="mpre">queuePut</span></span></a><span class="mpre"> [(</span><a href="#loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">Forward</span></span></a><span class="mpre">)] </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8&#39;)"><span class="hl_varref"><span class="mpre">mkQueue</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Breadth First Search, tailored for Edmonds &amp; Karp</span></span><span class="mpre">
</span><a href="#loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="mpre">bfForEK</span></a><span class="mpre"> :: </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11&#39;)"><span class="hl_tyconref"><span class="mpre">Queue</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">DirPath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DirRTree</span></span><span class="mpre">
</span><a name="loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="hl_fundecl"><span class="mpre">bfForEK</span></span></a><span class="mpre"> </span><a name="loc_87_9_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_10&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_87_11_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_12&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">
    | </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11&#39;)"><span class="hl_varref"><span class="mpre">queueEmpty</span></span></a><span class="mpre"> </span><a href="#loc_87_9_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_10&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_179_3_179_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_179_3_179_10&#39;)"><span class="hl_varref"><span class="mpre">isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_87_11_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_12&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> = []
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                 = case </span><a href="Data.Graph.Inductive.Graph.html#loc_182_3_182_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_182_3_182_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_101_16_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_16_101_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_87_11_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_12&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> of
        (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a name="loc_90_19_90_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_21&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">)                     -&gt; </span><a href="#loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="hl_varref"><span class="mpre">bfForEK</span></span></a><span class="mpre"> </span><a href="#loc_101_25_101_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_25_101_27&#39;)"><span class="hl_varref"><span class="mpre">q1</span></span></a><span class="mpre"> </span><a href="#loc_90_19_90_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_21&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
        (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_91_16_91_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_16_91_22&#39;)"><span class="hl_vardecl"><span class="mpre">preAdj</span></span></a><span class="mpre">, _, _, </span><a name="loc_91_30_91_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_30_91_36&#39;)"><span class="hl_vardecl"><span class="mpre">sucAdj</span></span></a><span class="mpre">), </span><a name="loc_91_39_91_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_39_91_41&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="hl_varref"><span class="mpre">bfForEK</span></span></a><span class="mpre"> </span><a href="#loc_94_17_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_17_94_19&#39;)"><span class="hl_varref"><span class="mpre">q2</span></span></a><span class="mpre"> </span><a href="#loc_91_39_91_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_39_91_41&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
            where
                </span><span class="hl_comment"><span class="mpre">-- Insert successor nodes (with path to root) into queue</span></span><span class="mpre">
                </span><a name="loc_94_17_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_17_94_19&#39;)"><span class="hl_vardecl"><span class="mpre">q2</span></span></a><span class="mpre">   = </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13&#39;)"><span class="hl_varref"><span class="mpre">queuePutList</span></span></a><span class="mpre"> </span><a href="#loc_96_17_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_17_96_21&#39;)"><span class="hl_varref"><span class="mpre">suc1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13&#39;)"><span class="hl_varref"><span class="mpre">queuePutList</span></span></a><span class="mpre"> </span><a href="#loc_99_17_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_21&#39;)"><span class="hl_varref"><span class="mpre">suc2</span></span></a><span class="mpre"> </span><a href="#loc_101_25_101_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_25_101_27&#39;)"><span class="hl_varref"><span class="mpre">q1</span></span></a><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- Traverse edges in reverse if flow positive</span></span><span class="mpre">
                </span><a name="loc_96_17_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_17_96_21&#39;)"><span class="hl_vardecl"><span class="mpre">suc1</span></span></a><span class="mpre"> = [ (</span><a href="#loc_97_32_97_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_32_97_39&#39;)"><span class="hl_varref"><span class="mpre">preNode</span></span></a><span class="mpre">, </span><a href="#loc_26_28_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_28_26_36&#39;)"><span class="hl_conref"><span class="mpre">Backward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                    | ((_, </span><a name="loc_97_28_97_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_28_97_29&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">), </span><a name="loc_97_32_97_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_32_97_39&#39;)"><span class="hl_vardecl"><span class="mpre">preNode</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_91_16_91_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_16_91_22&#39;)"><span class="hl_varref"><span class="mpre">preAdj</span></span></a><span class="mpre">, </span><a href="#loc_97_28_97_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_28_97_29&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
                </span><span class="hl_comment"><span class="mpre">-- Traverse edges forwards if flow less than capacity</span></span><span class="mpre">
                </span><a name="loc_99_17_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_21&#39;)"><span class="hl_vardecl"><span class="mpre">suc2</span></span></a><span class="mpre"> = [ (</span><a href="#loc_100_32_100_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_32_100_39&#39;)"><span class="hl_varref"><span class="mpre">sucNode</span></span></a><span class="mpre">,</span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">Forward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                    | ((</span><a name="loc_100_25_100_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_25_100_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">, </span><a name="loc_100_28_100_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_28_100_29&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">), </span><a name="loc_100_32_100_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_32_100_39&#39;)"><span class="hl_vardecl"><span class="mpre">sucNode</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_91_30_91_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_30_91_36&#39;)"><span class="hl_varref"><span class="mpre">sucAdj</span></span></a><span class="mpre">, </span><a href="#loc_100_25_100_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_25_100_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><a href="#loc_100_28_100_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_28_100_29&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">]
    where (</span><a name="loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@((</span><a name="loc_101_16_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_16_101_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_), </span><a name="loc_101_25_101_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_25_101_27&#39;)"><span class="hl_vardecl"><span class="mpre">q1</span></span></a><span class="mpre">)=</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9&#39;)"><span class="hl_varref"><span class="mpre">queueGet</span></span></a><span class="mpre"> </span><a href="#loc_87_9_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_10&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Extract augmenting path from network; return path as a sequence of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- edges with direction of traversal, and new network with augmenting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- path removed.</span></span><span class="mpre">
</span><a href="#loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="mpre">extractPathFused</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DirPath</span></span><span class="mpre">
    -&gt; ([</span><span class="hl_tyconref"><span class="mpre">DirEdge</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)], </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre">)
</span><a name="loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="hl_fundecl"><span class="mpre">extractPathFused</span></span></a><span class="mpre"> </span><a name="loc_108_18_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_18_108_19&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> []  = ([], </span><a href="#loc_108_18_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_18_108_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
</span><a href="#loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="hl_fundecl"><span class="mpre">extractPathFused</span></span></a><span class="mpre"> </span><a name="loc_109_18_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_18_109_19&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> [(_,_)] = ([], </span><a href="#loc_109_18_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_18_109_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
</span><a href="#loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="hl_fundecl"><span class="mpre">extractPathFused</span></span></a><span class="mpre"> </span><a name="loc_110_18_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_19&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> ((</span><a name="loc_110_22_110_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_22_110_23&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_110_27_110_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_27_110_31&#39;)"><span class="hl_specname"><span class="mpre">rest</span></span></a><span class="mpre">@((</span><a name="loc_110_34_110_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_34_110_35&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">Forward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)) =
    ((</span><a href="#loc_110_22_110_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_22_110_23&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">, </span><a href="#loc_110_34_110_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_34_110_35&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_113_21_113_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_21_113_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">Forward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_112_16_112_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_16_112_25&#39;)"><span class="hl_varref"><span class="mpre">tailedges</span></span></a><span class="mpre">, </span><a href="#loc_112_27_112_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_27_112_33&#39;)"><span class="hl_varref"><span class="mpre">newerg</span></span></a><span class="mpre">)
        where (</span><a name="loc_112_16_112_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_16_112_25&#39;)"><span class="hl_vardecl"><span class="mpre">tailedges</span></span></a><span class="mpre">, </span><a name="loc_112_27_112_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_27_112_33&#39;)"><span class="hl_vardecl"><span class="mpre">newerg</span></span></a><span class="mpre">) = </span><a href="#loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="hl_varref"><span class="mpre">extractPathFused</span></span></a><span class="mpre"> </span><a href="#loc_113_24_113_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_24_113_28&#39;)"><span class="hl_varref"><span class="mpre">newg</span></span></a><span class="mpre"> </span><a href="#loc_110_27_110_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_27_110_31&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
              </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_113_21_113_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_21_113_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_113_24_113_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_24_113_28&#39;)"><span class="hl_vardecl"><span class="mpre">newg</span></span></a><span class="mpre">)    = </span><a href="#loc_168_1_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_12&#39;)"><span class="hl_varref"><span class="mpre">extractEdge</span></span></a><span class="mpre"> </span><a href="#loc_110_18_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_110_22_110_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_22_110_23&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><a href="#loc_110_34_110_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_34_110_35&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (\(</span><a name="loc_113_56_113_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_56_113_57&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_113_58_113_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_58_113_59&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_113_56_113_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_56_113_57&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><a href="#loc_113_58_113_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_58_113_59&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">))
</span><a href="#loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="hl_fundecl"><span class="mpre">extractPathFused</span></span></a><span class="mpre"> </span><a name="loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> ((</span><a name="loc_114_22_114_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_22_114_23&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_114_27_114_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_27_114_31&#39;)"><span class="hl_specname"><span class="mpre">rest</span></span></a><span class="mpre">@((</span><a name="loc_114_34_114_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_34_114_35&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_26_28_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_28_26_36&#39;)"><span class="hl_conref"><span class="mpre">Backward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)) =
    ((</span><a href="#loc_114_34_114_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_34_114_35&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_114_22_114_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_22_114_23&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">, </span><a href="#loc_117_21_117_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_21_117_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="#loc_26_28_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_28_26_36&#39;)"><span class="hl_conref"><span class="mpre">Backward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_116_16_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_25&#39;)"><span class="hl_varref"><span class="mpre">tailedges</span></span></a><span class="mpre">, </span><a href="#loc_116_27_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_27_116_33&#39;)"><span class="hl_varref"><span class="mpre">newerg</span></span></a><span class="mpre">)
        where (</span><a name="loc_116_16_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_25&#39;)"><span class="hl_vardecl"><span class="mpre">tailedges</span></span></a><span class="mpre">, </span><a name="loc_116_27_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_27_116_33&#39;)"><span class="hl_vardecl"><span class="mpre">newerg</span></span></a><span class="mpre">) = </span><a href="#loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="hl_varref"><span class="mpre">extractPathFused</span></span></a><span class="mpre"> </span><a href="#loc_117_24_117_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_24_117_28&#39;)"><span class="hl_varref"><span class="mpre">newg</span></span></a><span class="mpre"> </span><a href="#loc_114_27_114_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_27_114_31&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
              </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_117_21_117_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_21_117_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_117_24_117_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_24_117_28&#39;)"><span class="hl_vardecl"><span class="mpre">newg</span></span></a><span class="mpre">)    = </span><a href="#loc_168_1_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_12&#39;)"><span class="hl_varref"><span class="mpre">extractEdge</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_114_34_114_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_34_114_35&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_114_22_114_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_22_114_23&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> (\(_,</span><a name="loc_117_58_117_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_58_117_59&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_117_58_117_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_58_117_59&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- ekFusedStep :: EKStepFunc</span></span><span class="mpre">
</span><a name="loc_120_1_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_12&#39;)"><span class="hl_fundecl"><span class="mpre">ekFusedStep</span></span></a><span class="mpre"> </span><a name="loc_120_13_120_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_13_120_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_120_15_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_15_120_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_120_17_120_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_17_120_18&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = case </span><a href="#loc_124_11_124_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_11_124_20&#39;)"><span class="hl_varref"><span class="mpre">maybePath</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> _          -&gt;
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> ((</span><a href="Data.Graph.Inductive.Graph.html#loc_277_1_277_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_277_1_277_9&#39;)"><span class="hl_varref"><span class="mpre">insEdges</span></span></a><span class="mpre"> (</span><a href="#loc_193_1_193_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_15&#39;)"><span class="hl_varref"><span class="mpre">integrateDelta</span></span></a><span class="mpre"> </span><a href="#loc_125_12_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_12_125_14&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><a href="#loc_126_11_126_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_16&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">) </span><a href="#loc_125_16_125_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_16_125_20&#39;)"><span class="hl_varref"><span class="mpre">newg</span></span></a><span class="mpre">), </span><a href="#loc_126_11_126_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_16&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">)
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">   -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    where </span><a name="loc_124_11_124_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_11_124_20&#39;)"><span class="hl_vardecl"><span class="mpre">maybePath</span></span></a><span class="mpre">     = </span><a href="#loc_77_1_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_13&#39;)"><span class="hl_varref"><span class="mpre">augPathFused</span></span></a><span class="mpre"> </span><a href="#loc_120_13_120_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_13_120_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_120_15_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_15_120_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_120_17_120_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_17_120_18&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
          (</span><a name="loc_125_12_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_12_125_14&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">, </span><a name="loc_125_16_125_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_16_125_20&#39;)"><span class="hl_vardecl"><span class="mpre">newg</span></span></a><span class="mpre">) = </span><a href="#loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="hl_varref"><span class="mpre">extractPathFused</span></span></a><span class="mpre"> </span><a href="#loc_120_13_120_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_13_120_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><a href="#loc_124_11_124_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_11_124_20&#39;)"><span class="hl_varref"><span class="mpre">maybePath</span></span></a><span class="mpre">)
          </span><a name="loc_126_11_126_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_16&#39;)"><span class="hl_vardecl"><span class="mpre">delta</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">minimum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_186_1_186_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_14&#39;)"><span class="hl_varref"><span class="mpre">getPathDeltas</span></span></a><span class="mpre"> </span><a href="#loc_125_12_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_12_125_14&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">

</span><a href="#loc_129_1_129_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_8&#39;)"><span class="mpre">ekFused</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)
</span><a name="loc_129_1_129_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_8&#39;)"><span class="hl_vardecl"><span class="mpre">ekFused</span></span></a><span class="mpre"> = </span><a href="#loc_212_1_212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_7&#39;)"><span class="hl_varref"><span class="mpre">ekWith</span></span></a><span class="mpre"> </span><a href="#loc_120_1_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_12&#39;)"><span class="hl_varref"><span class="mpre">ekFusedStep</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ENDEXTRACT</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Alternative implementation: Use an explicit residual graph</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- EXTRACT fglEdmondsSimple.txt</span></span><span class="mpre">
</span><a href="#loc_137_1_137_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_14&#39;)"><span class="mpre">residualGraph</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><a href="Data.Graph.Inductive.PatriciaTree.html#loc_33_9_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.PatriciaTree.html#loc_33_9_33_11&#39;)"><span class="hl_tyconref"><span class="mpre">Gr</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_137_1_137_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_14&#39;)"><span class="hl_fundecl"><span class="mpre">residualGraph</span></span></a><span class="mpre"> </span><a name="loc_137_15_137_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_16&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> =
    </span><a href="Data.Graph.Inductive.Graph.html#loc_184_3_184_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_184_3_184_10&#39;)"><span class="hl_varref"><span class="mpre">mkGraph</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_186_3_186_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_186_3_186_11&#39;)"><span class="hl_varref"><span class="mpre">labNodes</span></span></a><span class="mpre"> </span><a href="#loc_137_15_137_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_16&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
        ([(</span><a href="#loc_139_26_139_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_26_139_27&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">, </span><a href="#loc_139_29_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_29_139_30&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_139_33_139_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_34&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_139_35_139_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_35_139_36&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) | (</span><a name="loc_139_26_139_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_26_139_27&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">, </span><a name="loc_139_29_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_29_139_30&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">, (</span><a name="loc_139_33_139_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_34&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_139_35_139_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_35_139_36&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)) &lt;- </span><a href="Data.Graph.Inductive.Graph.html#loc_196_3_196_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_196_3_196_11&#39;)"><span class="hl_varref"><span class="mpre">labEdges</span></span></a><span class="mpre"> </span><a href="#loc_137_15_137_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_16&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">, </span><a href="#loc_139_33_139_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_34&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><a href="#loc_139_35_139_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_35_139_36&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> ] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
         [(</span><a href="#loc_140_26_140_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_26_140_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_140_24_140_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_24_140_25&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">, </span><a href="#loc_140_31_140_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_31_140_32&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) | (</span><a name="loc_140_24_140_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_24_140_25&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">,</span><a name="loc_140_26_140_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_26_140_27&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,(_,</span><a name="loc_140_31_140_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_31_140_32&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)) &lt;- </span><a href="Data.Graph.Inductive.Graph.html#loc_196_3_196_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_196_3_196_11&#39;)"><span class="hl_varref"><span class="mpre">labEdges</span></span></a><span class="mpre"> </span><a href="#loc_137_15_137_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_16&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">, </span><a href="#loc_140_31_140_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_31_140_32&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">])

</span><a href="#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_8&#39;)"><span class="mpre">augPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Path</span></span><span class="mpre">
</span><a name="loc_143_1_143_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_8&#39;)"><span class="hl_fundecl"><span class="mpre">augPath</span></span></a><span class="mpre"> </span><a name="loc_143_9_143_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_143_11_143_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_11_143_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_143_13_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_13_143_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_109_1_109_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_109_1_109_12&#39;)"><span class="hl_varref"><span class="mpre">listToMaybe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\(</span><a name="loc_143_55_143_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_55_143_56&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><a href="#loc_143_55_143_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_55_143_56&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_143_13_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_13_143_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="#loc_144_11_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_11_144_15&#39;)"><span class="hl_varref"><span class="mpre">tree</span></span></a><span class="mpre">
    where </span><a name="loc_144_11_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_11_144_15&#39;)"><span class="hl_vardecl"><span class="mpre">tree</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Query.BFS.html#loc_97_1_97_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Query.BFS.html#loc_97_1_97_4&#39;)"><span class="hl_varref"><span class="mpre">bft</span></span></a><span class="mpre"> </span><a href="#loc_143_11_143_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_11_143_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_137_1_137_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_14&#39;)"><span class="hl_varref"><span class="mpre">residualGraph</span></span></a><span class="mpre"> </span><a href="#loc_143_9_143_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Extract augmenting path from network; return path as a sequence of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- edges with direction of traversal, and new network with augmenting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- path removed.</span></span><span class="mpre">
</span><a href="#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_12&#39;)"><span class="mpre">extractPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Path</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">DirEdge</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)], </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre">)
</span><a name="loc_150_1_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_12&#39;)"><span class="hl_fundecl"><span class="mpre">extractPath</span></span></a><span class="mpre"> </span><a name="loc_150_13_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> []  = ([], </span><a href="#loc_150_13_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
</span><a href="#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_12&#39;)"><span class="hl_fundecl"><span class="mpre">extractPath</span></span></a><span class="mpre"> </span><a name="loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> [_] = ([], </span><a href="#loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
</span><a href="#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_12&#39;)"><span class="hl_fundecl"><span class="mpre">extractPath</span></span></a><span class="mpre"> </span><a name="loc_152_13_152_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> (</span><a name="loc_152_16_152_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_16_152_17&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_152_18_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_152_20_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_22&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">) =
    case </span><a href="#loc_162_11_162_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_11_162_21&#39;)"><span class="hl_varref"><span class="mpre">fwdExtract</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_154_15_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_154_18_154_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_18_154_22&#39;)"><span class="hl_vardecl"><span class="mpre">newg</span></span></a><span class="mpre">) -&gt; ((</span><a href="#loc_152_16_152_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_16_152_17&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">, </span><a href="#loc_152_18_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_154_15_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">Forward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_155_20_155_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_20_155_29&#39;)"><span class="hl_varref"><span class="mpre">tailedges</span></span></a><span class="mpre">, </span><a href="#loc_155_31_155_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_31_155_37&#39;)"><span class="hl_varref"><span class="mpre">newerg</span></span></a><span class="mpre">)
            where (</span><a name="loc_155_20_155_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_20_155_29&#39;)"><span class="hl_vardecl"><span class="mpre">tailedges</span></span></a><span class="mpre">, </span><a name="loc_155_31_155_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_31_155_37&#39;)"><span class="hl_vardecl"><span class="mpre">newerg</span></span></a><span class="mpre">) = </span><a href="#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">extractPath</span></span></a><span class="mpre"> </span><a href="#loc_154_18_154_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_18_154_22&#39;)"><span class="hl_varref"><span class="mpre">newg</span></span></a><span class="mpre"> (</span><a href="#loc_152_18_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_152_20_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_22&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">)
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">          -&gt;
            case </span><a href="#loc_163_11_163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_11_163_21&#39;)"><span class="hl_varref"><span class="mpre">revExtract</span></span></a><span class="mpre"> of
                </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_158_23_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_23_158_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_158_26_158_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_26_158_30&#39;)"><span class="hl_vardecl"><span class="mpre">newg</span></span></a><span class="mpre">) -&gt;
                    ((</span><a href="#loc_152_18_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_152_16_152_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_16_152_17&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">, </span><a href="#loc_158_23_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_23_158_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="#loc_26_28_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_28_26_36&#39;)"><span class="hl_conref"><span class="mpre">Backward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_160_28_160_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_28_160_37&#39;)"><span class="hl_varref"><span class="mpre">tailedges</span></span></a><span class="mpre">, </span><a href="#loc_160_39_160_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_39_160_45&#39;)"><span class="hl_varref"><span class="mpre">newerg</span></span></a><span class="mpre">)
                    where (</span><a name="loc_160_28_160_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_28_160_37&#39;)"><span class="hl_vardecl"><span class="mpre">tailedges</span></span></a><span class="mpre">, </span><a name="loc_160_39_160_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_39_160_45&#39;)"><span class="hl_vardecl"><span class="mpre">newerg</span></span></a><span class="mpre">) = </span><a href="#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">extractPath</span></span></a><span class="mpre"> </span><a href="#loc_158_26_158_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_26_158_30&#39;)"><span class="hl_varref"><span class="mpre">newg</span></span></a><span class="mpre"> (</span><a href="#loc_152_18_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_152_20_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_22&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">)
                </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">               -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;extractPath: revExtract == Nothing&quot;</span></span><span class="mpre">
    where </span><a name="loc_162_11_162_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_11_162_21&#39;)"><span class="hl_vardecl"><span class="mpre">fwdExtract</span></span></a><span class="mpre"> = </span><a href="#loc_168_1_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_12&#39;)"><span class="hl_varref"><span class="mpre">extractEdge</span></span></a><span class="mpre"> </span><a href="#loc_152_13_152_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_152_16_152_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_16_152_17&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><a href="#loc_152_18_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (\(</span><a name="loc_162_45_162_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_45_162_46&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_162_47_162_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_47_162_48&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_162_45_162_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_45_162_46&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><a href="#loc_162_47_162_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_47_162_48&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">))
          </span><a name="loc_163_11_163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_11_163_21&#39;)"><span class="hl_vardecl"><span class="mpre">revExtract</span></span></a><span class="mpre"> = </span><a href="#loc_168_1_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_12&#39;)"><span class="hl_varref"><span class="mpre">extractEdge</span></span></a><span class="mpre"> </span><a href="#loc_152_13_152_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_152_18_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_152_16_152_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_16_152_17&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> (\(_,</span><a name="loc_163_47_163_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_47_163_48&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_163_47_163_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_47_163_48&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- Extract an edge from the graph that satisfies a given predicate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Return the label on the edge and the graph without the edge</span></span><span class="mpre">
</span><a href="#loc_168_1_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_12&#39;)"><span class="mpre">extractEdge</span></a><span class="mpre"> :: </span><a href="Data.Graph.Inductive.PatriciaTree.html#loc_33_9_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.PatriciaTree.html#loc_33_9_33_11&#39;)"><span class="hl_tyconref"><span class="mpre">Gr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">-&gt;</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><a href="Data.Graph.Inductive.PatriciaTree.html#loc_33_9_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.PatriciaTree.html#loc_33_9_33_11&#39;)"><span class="hl_tyconref"><span class="mpre">Gr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_168_1_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_12&#39;)"><span class="hl_fundecl"><span class="mpre">extractEdge</span></span></a><span class="mpre"> </span><a name="loc_168_13_168_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_13_168_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_168_15_168_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_15_168_16&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_168_17_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_17_168_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_168_19_168_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> =
    case </span><a href="#loc_173_12_173_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_12_173_15&#39;)"><span class="hl_varref"><span class="mpre">adj</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_170_15_170_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_15_170_17&#39;)"><span class="hl_vardecl"><span class="mpre">el</span></span></a><span class="mpre">, _) -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_170_15_170_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_15_170_17&#39;)"><span class="hl_varref"><span class="mpre">el</span></span></a><span class="mpre">, (</span><a href="#loc_172_18_172_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_18_172_20&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">, </span><a href="#loc_172_22_172_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_22_172_26&#39;)"><span class="hl_varref"><span class="mpre">node</span></span></a><span class="mpre">, </span><a href="#loc_172_28_172_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_28_172_29&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="#loc_173_17_173_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_17_173_21&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">) </span><a href="Data.Graph.Inductive.Graph.html#loc_208_3_208_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_208_3_208_6&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_172_35_172_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_35_172_39&#39;)"><span class="hl_varref"><span class="mpre">newg</span></span></a><span class="mpre">)
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">      -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    where (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_172_18_172_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_18_172_20&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre">, </span><a name="loc_172_22_172_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_22_172_26&#39;)"><span class="hl_vardecl"><span class="mpre">node</span></span></a><span class="mpre">, </span><a name="loc_172_28_172_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_28_172_29&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_172_31_172_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_31_172_32&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">), </span><a name="loc_172_35_172_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_35_172_39&#39;)"><span class="hl_vardecl"><span class="mpre">newg</span></span></a><span class="mpre">) = </span><a href="Data.Graph.Inductive.Graph.html#loc_182_3_182_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_182_3_182_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_168_15_168_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_15_168_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><a href="#loc_168_13_168_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_13_168_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
          (</span><a name="loc_173_12_173_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_12_173_15&#39;)"><span class="hl_vardecl"><span class="mpre">adj</span></span></a><span class="mpre">, </span><a name="loc_173_17_173_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_17_173_21&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)=</span><a href="#loc_179_1_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_11&#39;)"><span class="hl_varref"><span class="mpre">extractAdj</span></span></a><span class="mpre"> </span><a href="#loc_172_31_172_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_31_172_32&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
              (\(</span><a name="loc_174_18_174_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_18_174_20&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">, </span><a name="loc_174_22_174_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_22_174_26&#39;)"><span class="hl_vardecl"><span class="mpre">dest</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_174_22_174_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_22_174_26&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_168_17_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_17_168_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><a href="#loc_168_19_168_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_174_18_174_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_18_174_20&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- Extract an item from an adjacency list that satisfies a given</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- predicate. Return the item and the rest of the adjacency list</span></span><span class="mpre">
</span><a href="#loc_179_1_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_11&#39;)"><span class="mpre">extractAdj</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Adj</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; ((</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">)-&gt;</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">), </span><span class="hl_tyconref"><span class="mpre">Adj</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_179_1_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_11&#39;)"><span class="hl_fundecl"><span class="mpre">extractAdj</span></span></a><span class="mpre"> []         _ = (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, [])
</span><a href="#loc_179_1_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_11&#39;)"><span class="hl_fundecl"><span class="mpre">extractAdj</span></span></a><span class="mpre"> (</span><a name="loc_180_13_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_16&#39;)"><span class="hl_vardecl"><span class="mpre">adj</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_180_17_180_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_17_180_21&#39;)"><span class="hl_vardecl"><span class="mpre">adjs</span></span></a><span class="mpre">) </span><a name="loc_180_23_180_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_23_180_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">
    | </span><a href="#loc_180_23_180_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_23_180_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_180_13_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_16&#39;)"><span class="hl_varref"><span class="mpre">adj</span></span></a><span class="mpre">     = (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_180_13_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_16&#39;)"><span class="hl_varref"><span class="mpre">adj</span></span></a><span class="mpre">, </span><a href="#loc_180_17_180_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_17_180_21&#39;)"><span class="hl_varref"><span class="mpre">adjs</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (</span><a href="#loc_183_16_183_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_16_183_22&#39;)"><span class="hl_varref"><span class="mpre">theone</span></span></a><span class="mpre">, </span><a href="#loc_180_13_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_16&#39;)"><span class="hl_varref"><span class="mpre">adj</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_183_24_183_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_24_183_28&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        where (</span><a name="loc_183_16_183_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_16_183_22&#39;)"><span class="hl_vardecl"><span class="mpre">theone</span></span></a><span class="mpre">, </span><a name="loc_183_24_183_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_24_183_28&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)=</span><a href="#loc_179_1_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_11&#39;)"><span class="hl_varref"><span class="mpre">extractAdj</span></span></a><span class="mpre"> </span><a href="#loc_180_17_180_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_17_180_21&#39;)"><span class="hl_varref"><span class="mpre">adjs</span></span></a><span class="mpre"> </span><a href="#loc_180_23_180_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_23_180_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_186_1_186_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_14&#39;)"><span class="mpre">getPathDeltas</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">DirEdge</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">]
</span><a name="loc_186_1_186_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_14&#39;)"><span class="hl_fundecl"><span class="mpre">getPathDeltas</span></span></a><span class="mpre"> []     = []
</span><a href="#loc_186_1_186_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_14&#39;)"><span class="hl_fundecl"><span class="mpre">getPathDeltas</span></span></a><span class="mpre"> (</span><a name="loc_187_16_187_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_16_187_17&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_187_18_187_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_18_187_20&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">) = case </span><a href="#loc_187_16_187_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_16_187_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
    (_, _, (</span><a name="loc_188_13_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_188_15_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_15_188_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">), </span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">Forward</span></span></a><span class="mpre">)  -&gt; (</span><a href="#loc_188_13_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_188_15_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_15_188_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_186_1_186_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_14&#39;)"><span class="hl_varref"><span class="mpre">getPathDeltas</span></span></a><span class="mpre"> </span><a href="#loc_187_18_187_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_18_187_20&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
    (_, _, (_,</span><a name="loc_189_15_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_15_189_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">), </span><a href="#loc_26_28_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_28_26_36&#39;)"><span class="hl_conref"><span class="mpre">Backward</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_189_15_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_15_189_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_186_1_186_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_14&#39;)"><span class="hl_varref"><span class="mpre">getPathDeltas</span></span></a><span class="mpre"> </span><a href="#loc_187_18_187_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_18_187_20&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)

</span><a href="#loc_193_1_193_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_15&#39;)"><span class="mpre">integrateDelta</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">DirEdge</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
    -&gt; [</span><span class="hl_tyconref"><span class="mpre">LEdge</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)]
</span><a name="loc_193_1_193_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_15&#39;)"><span class="hl_fundecl"><span class="mpre">integrateDelta</span></span></a><span class="mpre"> []          _ = []
</span><a href="#loc_193_1_193_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_15&#39;)"><span class="hl_fundecl"><span class="mpre">integrateDelta</span></span></a><span class="mpre"> (</span><a name="loc_194_17_194_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_17_194_18&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_194_19_194_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_19_194_21&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">) </span><a name="loc_194_23_194_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_28&#39;)"><span class="hl_vardecl"><span class="mpre">delta</span></span></a><span class="mpre"> = case </span><a href="#loc_194_17_194_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_17_194_18&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> of
    (</span><a name="loc_195_6_195_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_6_195_7&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">, </span><a name="loc_195_9_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">, (</span><a name="loc_195_13_195_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_13_195_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">, </span><a name="loc_195_16_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_16_195_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">), </span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">Forward</span></span></a><span class="mpre">) -&gt;
        (</span><a href="#loc_195_6_195_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_6_195_7&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">, </span><a href="#loc_195_9_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, (</span><a href="#loc_195_13_195_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_13_195_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="#loc_195_16_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_16_195_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_194_23_194_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_28&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_193_1_193_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_15&#39;)"><span class="hl_varref"><span class="mpre">integrateDelta</span></span></a><span class="mpre"> </span><a href="#loc_194_19_194_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_19_194_21&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><a href="#loc_194_23_194_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_28&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">)
    (</span><a name="loc_197_6_197_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_6_197_7&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">, </span><a name="loc_197_9_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">, (</span><a name="loc_197_13_197_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_13_197_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">, </span><a name="loc_197_16_197_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_16_197_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">), </span><a href="#loc_26_28_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_28_26_36&#39;)"><span class="hl_conref"><span class="mpre">Backward</span></span></a><span class="mpre">) -&gt;
        (</span><a href="#loc_197_6_197_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_6_197_7&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">, </span><a href="#loc_197_9_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, (</span><a href="#loc_197_13_197_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_13_197_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="#loc_197_16_197_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_16_197_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_194_23_194_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_28&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_193_1_193_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_15&#39;)"><span class="hl_varref"><span class="mpre">integrateDelta</span></span></a><span class="mpre"> </span><a href="#loc_194_19_194_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_19_194_21&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><a href="#loc_194_23_194_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_28&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">)

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 200, srcSpanStartColumn = 1, srcSpanEndLine = 200, srcSpanEndColumn = 69}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 200, srcSpanStartColumn = 1, srcSpanEndLine = 200, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph"><span class="mpre">type EKStepFunc = Network -&gt; Node -&gt; Node -&gt; Maybe (Network, Double)</span></span><span class="mpre">

</span><a href="#loc_203_1_203_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_13&#39;)"><span class="mpre">ekSimpleStep</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">EKStepFunc</span></span><span class="mpre">
</span><a name="loc_203_1_203_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_13&#39;)"><span class="hl_fundecl"><span class="mpre">ekSimpleStep</span></span></a><span class="mpre"> </span><a name="loc_203_14_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_14_203_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_203_16_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_16_203_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_203_18_203_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_19&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = case </span><a href="#loc_207_11_207_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_11_207_20&#39;)"><span class="hl_varref"><span class="mpre">maybePath</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> _ -&gt;
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> ((</span><a href="Data.Graph.Inductive.Graph.html#loc_277_1_277_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_277_1_277_9&#39;)"><span class="hl_varref"><span class="mpre">insEdges</span></span></a><span class="mpre"> (</span><a href="#loc_193_1_193_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_15&#39;)"><span class="hl_varref"><span class="mpre">integrateDelta</span></span></a><span class="mpre"> </span><a href="#loc_208_12_208_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_12_208_14&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><a href="#loc_209_11_209_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_11_209_16&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">) </span><a href="#loc_208_16_208_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_16_208_20&#39;)"><span class="hl_varref"><span class="mpre">newg</span></span></a><span class="mpre">), </span><a href="#loc_209_11_209_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_11_209_16&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">)
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">   -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    where </span><a name="loc_207_11_207_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_11_207_20&#39;)"><span class="hl_vardecl"><span class="mpre">maybePath</span></span></a><span class="mpre">  = </span><a href="#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">augPath</span></span></a><span class="mpre"> </span><a href="#loc_203_14_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_14_203_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_203_16_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_16_203_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_203_18_203_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_19&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
          (</span><a name="loc_208_12_208_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_12_208_14&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">, </span><a name="loc_208_16_208_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_16_208_20&#39;)"><span class="hl_vardecl"><span class="mpre">newg</span></span></a><span class="mpre">) = </span><a href="#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">extractPath</span></span></a><span class="mpre"> </span><a href="#loc_203_14_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_14_203_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><a href="#loc_207_11_207_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_11_207_20&#39;)"><span class="hl_varref"><span class="mpre">maybePath</span></span></a><span class="mpre">)
          </span><a name="loc_209_11_209_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_11_209_16&#39;)"><span class="hl_vardecl"><span class="mpre">delta</span></span></a><span class="mpre">      = </span><span class="hl_varref"><span class="mpre">minimum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_186_1_186_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_14&#39;)"><span class="hl_varref"><span class="mpre">getPathDeltas</span></span></a><span class="mpre"> </span><a href="#loc_208_12_208_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_12_208_14&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">

</span><a href="#loc_212_1_212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_7&#39;)"><span class="mpre">ekWith</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">EKStepFunc</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)
</span><a name="loc_212_1_212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_7&#39;)"><span class="hl_fundecl"><span class="mpre">ekWith</span></span></a><span class="mpre"> </span><a name="loc_212_8_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_8_212_16&#39;)"><span class="hl_vardecl"><span class="mpre">stepfunc</span></span></a><span class="mpre"> </span><a name="loc_212_17_212_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_17_212_18&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_212_19_212_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_19_212_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_212_21_212_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_21_212_22&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = case </span><a href="#loc_212_8_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_8_212_16&#39;)"><span class="hl_varref"><span class="mpre">stepfunc</span></span></a><span class="mpre"> </span><a href="#loc_212_17_212_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_17_212_18&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_212_19_212_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_19_212_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_212_21_212_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_21_212_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> of
    </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_213_11_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_15&#39;)"><span class="hl_vardecl"><span class="mpre">newg</span></span></a><span class="mpre">, </span><a name="loc_213_17_213_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_17_213_22&#39;)"><span class="hl_vardecl"><span class="mpre">delta</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_214_16_214_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_16_214_22&#39;)"><span class="hl_varref"><span class="mpre">finalg</span></span></a><span class="mpre">, </span><a href="#loc_214_24_214_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_24_214_32&#39;)"><span class="hl_varref"><span class="mpre">capacity</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_213_17_213_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_17_213_22&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">)
        where (</span><a name="loc_214_16_214_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_16_214_22&#39;)"><span class="hl_vardecl"><span class="mpre">finalg</span></span></a><span class="mpre">, </span><a name="loc_214_24_214_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_24_214_32&#39;)"><span class="hl_vardecl"><span class="mpre">capacity</span></span></a><span class="mpre">) = (</span><a href="#loc_212_1_212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_7&#39;)"><span class="hl_varref"><span class="mpre">ekWith</span></span></a><span class="mpre"> </span><a href="#loc_212_8_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_8_212_16&#39;)"><span class="hl_varref"><span class="mpre">stepfunc</span></span></a><span class="mpre"> </span><a href="#loc_213_11_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_15&#39;)"><span class="hl_varref"><span class="mpre">newg</span></span></a><span class="mpre"> </span><a href="#loc_212_19_212_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_19_212_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_212_21_212_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_21_212_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
    </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">            -&gt; (</span><a href="#loc_212_17_212_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_17_212_18&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

</span><a href="#loc_218_1_218_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_9&#39;)"><span class="mpre">ekSimple</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)
</span><a name="loc_218_1_218_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_9&#39;)"><span class="hl_vardecl"><span class="mpre">ekSimple</span></span></a><span class="mpre"> = </span><a href="#loc_212_1_212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_7&#39;)"><span class="hl_varref"><span class="mpre">ekWith</span></span></a><span class="mpre"> </span><a href="#loc_203_1_203_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_13&#39;)"><span class="hl_varref"><span class="mpre">ekSimpleStep</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ENDEXTRACT</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Alternative implementation: Process list of edges to extract path instead</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of operating on graph structure</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- EXTRACT fglEdmondsList.txt</span></span><span class="mpre">
</span><a href="#loc_227_1_227_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_12&#39;)"><span class="mpre">setFromList</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 226, srcSpanStartColumn = 16, srcSpanEndLine = 226, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 226, srcSpanStartColumn = 22, srcSpanEndLine = 226, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/"><span class="mpre">Ord a =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><a href="Data.Graph.Inductive.Internal.FiniteMap.html#loc_22_6_22_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.FiniteMap.html#loc_22_6_22_15&#39;)"><span class="hl_tyconref"><span class="mpre">FiniteMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_227_1_227_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_12&#39;)"><span class="hl_fundecl"><span class="mpre">setFromList</span></span></a><span class="mpre"> [] = </span><a href="Data.Graph.Inductive.Internal.FiniteMap.html#loc_64_1_64_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.FiniteMap.html#loc_64_1_64_8&#39;)"><span class="hl_varref"><span class="mpre">emptyFM</span></span></a><span class="mpre">
</span><a href="#loc_227_1_227_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_12&#39;)"><span class="hl_fundecl"><span class="mpre">setFromList</span></span></a><span class="mpre"> (</span><a name="loc_228_14_228_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_14_228_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_228_16_228_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_16_228_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="Data.Graph.Inductive.Internal.FiniteMap.html#loc_67_1_67_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.FiniteMap.html#loc_67_1_67_8&#39;)"><span class="hl_varref"><span class="mpre">addToFM</span></span></a><span class="mpre"> (</span><a href="#loc_227_1_227_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_12&#39;)"><span class="hl_varref"><span class="mpre">setFromList</span></span></a><span class="mpre"> </span><a href="#loc_228_16_228_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_16_228_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_228_14_228_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_14_228_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_231_1_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_12&#39;)"><span class="mpre">setContains</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 230, srcSpanStartColumn = 16, srcSpanEndLine = 230, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow2.hs&quot;, srcSpanStartLine = 230, srcSpanStartColumn = 22, srcSpanEndLine = 230, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/"><span class="mpre">Ord a =&gt;</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Internal.FiniteMap.html#loc_22_6_22_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.FiniteMap.html#loc_22_6_22_15&#39;)"><span class="hl_tyconref"><span class="mpre">FiniteMap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_231_1_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_12&#39;)"><span class="hl_fundecl"><span class="mpre">setContains</span></span></a><span class="mpre"> </span><a name="loc_231_13_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_13_231_14&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_231_15_231_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_15_231_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = case (</span><a href="Data.Graph.Inductive.Internal.FiniteMap.html#loc_105_1_105_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.FiniteMap.html#loc_105_1_105_9&#39;)"><span class="hl_varref"><span class="mpre">lookupFM</span></span></a><span class="mpre"> </span><a href="#loc_231_13_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_13_231_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_231_15_231_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_15_231_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) of
    </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><a href="#loc_237_1_237_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_16&#39;)"><span class="mpre">extractPathList</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">LEdge</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)] -&gt; </span><a href="Data.Graph.Inductive.Internal.FiniteMap.html#loc_22_6_22_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.FiniteMap.html#loc_22_6_22_15&#39;)"><span class="hl_tyconref"><span class="mpre">FiniteMap</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    -&gt; ([</span><span class="hl_tyconref"><span class="mpre">DirEdge</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)], [</span><span class="hl_tyconref"><span class="mpre">LEdge</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)])
</span><a name="loc_237_1_237_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_16&#39;)"><span class="hl_fundecl"><span class="mpre">extractPathList</span></span></a><span class="mpre"> []                 _ = ([], [])
</span><a href="#loc_237_1_237_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_16&#39;)"><span class="hl_fundecl"><span class="mpre">extractPathList</span></span></a><span class="mpre"> (</span><a name="loc_238_18_238_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_18_238_22&#39;)"><span class="hl_specname"><span class="mpre">edge</span></span></a><span class="mpre">@(</span><a name="loc_238_24_238_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_24_238_25&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">,</span><a name="loc_238_26_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_27&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_238_28_238_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_28_238_29&#39;)"><span class="hl_specname"><span class="mpre">l</span></span></a><span class="mpre">@(</span><a name="loc_238_31_238_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_31_238_32&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_238_33_238_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_33_238_34&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">))</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_238_37_238_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_37_238_39&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">) </span><a name="loc_238_41_238_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_41_238_44&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre">
    | (</span><a href="#loc_238_31_238_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_31_238_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><a href="#loc_238_33_238_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_33_238_34&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><a href="#loc_231_1_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_12&#39;)"><span class="hl_varref"><span class="mpre">setContains</span></span></a><span class="mpre"> </span><a href="#loc_238_41_238_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_41_238_44&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_238_24_238_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_24_238_25&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">,</span><a href="#loc_238_26_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)) =
        let (</span><a name="loc_240_14_240_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_22&#39;)"><span class="hl_vardecl"><span class="mpre">pathrest</span></span></a><span class="mpre">, </span><a name="loc_240_24_240_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_24_240_31&#39;)"><span class="hl_vardecl"><span class="mpre">notrest</span></span></a><span class="mpre">)=</span><a href="#loc_237_1_237_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_16&#39;)"><span class="hl_varref"><span class="mpre">extractPathList</span></span></a><span class="mpre"> </span><a href="#loc_238_37_238_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_37_238_39&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.FiniteMap.html#loc_90_1_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.FiniteMap.html#loc_90_1_90_10&#39;)"><span class="hl_varref"><span class="mpre">delFromFM</span></span></a><span class="mpre"> </span><a href="#loc_238_41_238_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_41_238_44&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_238_24_238_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_24_238_25&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">,</span><a href="#loc_238_26_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">))
            in ((</span><a href="#loc_238_24_238_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_24_238_25&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">,</span><a href="#loc_238_26_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_238_28_238_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_28_238_29&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_26_18_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_25&#39;)"><span class="hl_conref"><span class="mpre">Forward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_240_14_240_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_22&#39;)"><span class="hl_varref"><span class="mpre">pathrest</span></span></a><span class="mpre">, </span><a href="#loc_240_24_240_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_24_240_31&#39;)"><span class="hl_varref"><span class="mpre">notrest</span></span></a><span class="mpre">)
    | (</span><a href="#loc_238_33_238_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_33_238_34&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><a href="#loc_231_1_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_12&#39;)"><span class="hl_varref"><span class="mpre">setContains</span></span></a><span class="mpre"> </span><a href="#loc_238_41_238_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_41_238_44&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_238_26_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_238_24_238_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_24_238_25&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)) =
        let (</span><a name="loc_243_14_243_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_14_243_22&#39;)"><span class="hl_vardecl"><span class="mpre">pathrest</span></span></a><span class="mpre">, </span><a name="loc_243_24_243_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_24_243_31&#39;)"><span class="hl_vardecl"><span class="mpre">notrest</span></span></a><span class="mpre">)=</span><a href="#loc_237_1_237_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_16&#39;)"><span class="hl_varref"><span class="mpre">extractPathList</span></span></a><span class="mpre"> </span><a href="#loc_238_37_238_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_37_238_39&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.FiniteMap.html#loc_90_1_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.FiniteMap.html#loc_90_1_90_10&#39;)"><span class="hl_varref"><span class="mpre">delFromFM</span></span></a><span class="mpre"> </span><a href="#loc_238_41_238_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_41_238_44&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_238_24_238_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_24_238_25&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">,</span><a href="#loc_238_26_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">))
            in ((</span><a href="#loc_238_24_238_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_24_238_25&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">,</span><a href="#loc_238_26_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_26_238_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_238_28_238_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_28_238_29&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_26_28_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_28_26_36&#39;)"><span class="hl_conref"><span class="mpre">Backward</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_243_14_243_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_14_243_22&#39;)"><span class="hl_varref"><span class="mpre">pathrest</span></span></a><span class="mpre">, </span><a href="#loc_243_24_243_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_24_243_31&#39;)"><span class="hl_varref"><span class="mpre">notrest</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                        =
        let (</span><a name="loc_246_14_246_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_14_246_22&#39;)"><span class="hl_vardecl"><span class="mpre">pathrest</span></span></a><span class="mpre">, </span><a name="loc_246_24_246_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_24_246_31&#39;)"><span class="hl_vardecl"><span class="mpre">notrest</span></span></a><span class="mpre">)=</span><a href="#loc_237_1_237_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_16&#39;)"><span class="hl_varref"><span class="mpre">extractPathList</span></span></a><span class="mpre"> </span><a href="#loc_238_37_238_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_37_238_39&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><a href="#loc_238_41_238_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_41_238_44&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> in
            (</span><a href="#loc_246_14_246_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_14_246_22&#39;)"><span class="hl_varref"><span class="mpre">pathrest</span></span></a><span class="mpre">, </span><a href="#loc_238_18_238_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_18_238_22&#39;)"><span class="hl_varref"><span class="mpre">edge</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_246_24_246_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_24_246_31&#39;)"><span class="hl_varref"><span class="mpre">notrest</span></span></a><span class="mpre">)

</span><a href="#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_11&#39;)"><span class="mpre">ekStepList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">EKStepFunc</span></span><span class="mpre">
</span><a name="loc_250_1_250_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_11&#39;)"><span class="hl_fundecl"><span class="mpre">ekStepList</span></span></a><span class="mpre"> </span><a name="loc_250_12_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_12_250_13&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_250_14_250_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_14_250_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_250_16_250_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_16_250_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = case </span><a href="#loc_254_11_254_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_11_254_20&#39;)"><span class="hl_varref"><span class="mpre">maybePath</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> _  -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_184_3_184_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_184_3_184_10&#39;)"><span class="hl_varref"><span class="mpre">mkGraph</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_186_3_186_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_186_3_186_11&#39;)"><span class="hl_varref"><span class="mpre">labNodes</span></span></a><span class="mpre"> </span><a href="#loc_250_12_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_12_250_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><a href="#loc_253_11_253_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_11_253_19&#39;)"><span class="hl_varref"><span class="mpre">newEdges</span></span></a><span class="mpre">, </span><a href="#loc_257_11_257_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_11_257_16&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">)
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    where </span><a name="loc_253_11_253_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_11_253_19&#39;)"><span class="hl_vardecl"><span class="mpre">newEdges</span></span></a><span class="mpre">      = (</span><a href="#loc_193_1_193_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_15&#39;)"><span class="hl_varref"><span class="mpre">integrateDelta</span></span></a><span class="mpre"> </span><a href="#loc_255_12_255_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_12_255_14&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><a href="#loc_257_11_257_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_11_257_16&#39;)"><span class="hl_varref"><span class="mpre">delta</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_255_16_255_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_16_255_26&#39;)"><span class="hl_varref"><span class="mpre">otheredges</span></span></a><span class="mpre">
          </span><a name="loc_254_11_254_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_11_254_20&#39;)"><span class="hl_vardecl"><span class="mpre">maybePath</span></span></a><span class="mpre">     = </span><a href="#loc_77_1_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_13&#39;)"><span class="hl_varref"><span class="mpre">augPathFused</span></span></a><span class="mpre"> </span><a href="#loc_250_12_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_12_250_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_250_14_250_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_14_250_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_250_16_250_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_16_250_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
          (</span><a name="loc_255_12_255_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_12_255_14&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">, </span><a name="loc_255_16_255_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_16_255_26&#39;)"><span class="hl_vardecl"><span class="mpre">otheredges</span></span></a><span class="mpre">) = </span><a href="#loc_237_1_237_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_16&#39;)"><span class="hl_varref"><span class="mpre">extractPathList</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_196_3_196_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_196_3_196_11&#39;)"><span class="hl_varref"><span class="mpre">labEdges</span></span></a><span class="mpre"> </span><a href="#loc_250_12_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_12_250_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
              (</span><a href="#loc_227_1_227_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_12&#39;)"><span class="hl_varref"><span class="mpre">setFromList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><a href="#loc_258_11_258_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_11_258_19&#39;)"><span class="hl_varref"><span class="mpre">justPath</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_258_11_258_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_11_258_19&#39;)"><span class="hl_varref"><span class="mpre">justPath</span></span></a><span class="mpre">)))
          </span><a name="loc_257_11_257_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_11_257_16&#39;)"><span class="hl_vardecl"><span class="mpre">delta</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">minimum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_186_1_186_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_14&#39;)"><span class="hl_varref"><span class="mpre">getPathDeltas</span></span></a><span class="mpre"> </span><a href="#loc_255_12_255_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_12_255_14&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">
          </span><a name="loc_258_11_258_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_11_258_19&#39;)"><span class="hl_vardecl"><span class="mpre">justPath</span></span></a><span class="mpre">      = </span><a href="#loc_35_1_35_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_16&#39;)"><span class="hl_varref"><span class="mpre">pathFromDirPath</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><a href="#loc_254_11_254_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_11_254_20&#39;)"><span class="hl_varref"><span class="mpre">maybePath</span></span></a><span class="mpre">)

</span><a href="#loc_261_1_261_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_7&#39;)"><span class="mpre">ekList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Network</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)
</span><a name="loc_261_1_261_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_7&#39;)"><span class="hl_vardecl"><span class="mpre">ekList</span></span></a><span class="mpre"> = </span><a href="#loc_212_1_212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_7&#39;)"><span class="hl_varref"><span class="mpre">ekWith</span></span></a><span class="mpre"> </span><a href="#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">ekStepList</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ENDEXTRACT</span></span><span class="mpre">

</span></div></body></html>