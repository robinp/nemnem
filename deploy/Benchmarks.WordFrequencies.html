<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | A word frequency count using the different string types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Tested in this benchmark:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Splitting into words</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Converting to lowercase</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Comparing: Eq/Ord instances</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Benchmarks.WordFrequencies
    ( benchmark
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/WordFrequencies.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 8, srcSpanEndLine = 15, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Criterion&quot;"><span class="mpre">Criterion</span></span><span class="mpre"> (Benchmark, bench, bgroup, whnf)
import Data.Char (</span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">)
import Data.List (</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">)
import Data.Map (Map)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/WordFrequencies.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 18, srcSpanEndLine = 19, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as B
import qualified Data.Map as M
import qualified Data.Text as T
import qualified Data.Text.IO as T

</span><a href="#loc_25_1_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_10&#39;)"><span class="mpre">benchmark</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Benchmark</span></span><span class="mpre">
</span><a name="loc_25_1_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_10&#39;)"><span class="hl_fundecl"><span class="mpre">benchmark</span></span></a><span class="mpre"> </span><a name="loc_25_11_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_13&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> = do
    </span><a name="loc_26_5_26_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">readFile</span></span><span class="mpre"> </span><a href="#loc_25_11_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_13&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
    </span><a name="loc_27_5_27_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_6&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">B.readFile</span></span><span class="mpre"> </span><a href="#loc_25_11_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_13&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
    </span><a name="loc_28_5_28_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_6&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.IO.html#loc_88_1_88_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.IO.html#loc_88_1_88_9&#39;)"><span class="hl_varref"><span class="mpre">T.readFile</span></span></a><span class="mpre"> </span><a href="#loc_25_11_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_13&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bgroup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;WordFrequencies&quot;</span></span><span class="mpre">
        [ </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;String&quot;</span></span><span class="mpre">     </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">whnf</span></span><span class="mpre"> (</span><a href="#loc_36_1_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_12&#39;)"><span class="hl_varref"><span class="mpre">frequencies</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">words</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre">)     </span><a href="#loc_26_5_26_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ByteString&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">whnf</span></span><span class="mpre"> (</span><a href="#loc_36_1_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_12&#39;)"><span class="hl_varref"><span class="mpre">frequencies</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.words</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre">) </span><a href="#loc_27_5_27_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_6&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Text&quot;</span></span><span class="mpre">       </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">whnf</span></span><span class="mpre"> (</span><a href="#loc_36_1_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_12&#39;)"><span class="hl_varref"><span class="mpre">frequencies</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_1478_1_1478_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1478_1_1478_6&#39;)"><span class="hl_varref"><span class="mpre">T.words</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_706_1_706_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_706_1_706_8&#39;)"><span class="hl_varref"><span class="mpre">T.toLower</span></span></a><span class="mpre">)     </span><a href="#loc_28_5_28_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_6&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        ]

</span><a href="#loc_36_1_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_12&#39;)"><span class="mpre">frequencies</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/WordFrequencies.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 16, srcSpanEndLine = 35, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/WordFrequencies.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 22, srcSpanEndLine = 35, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpan"><span class="mpre">Ord a =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Map</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_36_1_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_12&#39;)"><span class="hl_vardecl"><span class="mpre">frequencies</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> (\</span><a name="loc_36_24_36_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_24_36_25&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_36_26_36_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_26_36_27&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">M.insertWith</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(+)</span></span><span class="mpre"> </span><a href="#loc_36_26_36_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_26_36_27&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_36_24_36_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_24_36_25&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">M.empty</span></span><span class="mpre">
</span></div></body></html>