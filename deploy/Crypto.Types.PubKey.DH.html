<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE GeneralizedNewtypeDeriving #-}
{-# LANGUAGE DeriveDataTypeable #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Types.PubKey.DH</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : Stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Excellent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Types.PubKey.DH
    ( Params(..)
    , PublicNumber(..)
    , PrivateNumber(..)
    , SharedKey(..)
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 8, srcSpanEndLine = 17, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
import Data.ASN1.Types

</span><span class="hl_comment"><span class="mpre">-- | Represent Diffie Hellman parameters namely P (prime), and G (generator).</span></span><span class="mpre">
data </span><a name="loc_21_6_21_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_6_21_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Params</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Params</span></span><span class="mpre">
    { </span><a name="loc_22_7_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_7_22_15&#39;)"><span class="hl_fielddecl"><span class="mpre">params_p</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    , </span><a name="loc_23_7_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_7_23_15&#39;)"><span class="hl_fielddecl"><span class="mpre">params_g</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 7, srcSpanEndLine = 24, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 7, srcSpanEndLine = 24, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types"><span class="mpre">deriving (Show,Read,Eq,Data,Typeable)</span></span><span class="mpre">

instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_21_6_21_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_6_21_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a name="loc_27_12_27_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_12_27_18&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre"> = \</span><a name="loc_27_22_27_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_22_27_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
                           </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_22_7_22_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_7_22_15&#39;)"><span class="hl_varref"><span class="mpre">params_p</span></span></a><span class="mpre"> </span><a href="#loc_27_12_27_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_12_27_18&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">)
                           </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="#loc_23_7_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_7_23_15&#39;)"><span class="hl_varref"><span class="mpre">params_g</span></span></a><span class="mpre"> </span><a href="#loc_27_12_27_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_12_27_18&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">)
                           </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
                           </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_27_22_27_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_22_27_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> 

    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">g</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_33_61_33_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_61_33_63&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) =
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 16, srcSpanEndLine = 34, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 23, srcSpanEndLine = 34, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-ty"><span class="mpre">Params { params_p = p, params_g = g }</span></span><span class="mpre">, </span><a href="#loc_33_61_33_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_61_33_63&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;fromASN1: DH.Params: unexpected format&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Represent Diffie Hellman public number Y.</span></span><span class="mpre">
newtype </span><a name="loc_38_9_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_21&#39;)"><span class="hl_tycondecl"><span class="mpre">PublicNumber</span></span></a><span class="mpre"> = </span><a name="loc_38_24_38_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_24_38_36&#39;)"><span class="hl_condecl"><span class="mpre">PublicNumber</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 5, srcSpanEndLine = 39, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 5, srcSpanEndLine = 39, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types"><span class="mpre">deriving (Show,Read,Eq,Enum,Real,Num,Ord)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Represent Diffie Hellman private number X.</span></span><span class="mpre">
newtype </span><a name="loc_42_9_42_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_22&#39;)"><span class="hl_tycondecl"><span class="mpre">PrivateNumber</span></span></a><span class="mpre"> = </span><a name="loc_42_25_42_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_25_42_38&#39;)"><span class="hl_condecl"><span class="mpre">PrivateNumber</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 5, srcSpanEndLine = 43, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 5, srcSpanEndLine = 43, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types"><span class="mpre">deriving (Show,Read,Eq,Enum,Real,Num,Ord)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Represent Diffie Hellman shared secret.</span></span><span class="mpre">
newtype </span><a name="loc_46_9_46_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_18&#39;)"><span class="hl_tycondecl"><span class="mpre">SharedKey</span></span></a><span class="mpre"> = </span><a name="loc_46_21_46_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_21_46_30&#39;)"><span class="hl_condecl"><span class="mpre">SharedKey</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 5, srcSpanEndLine = 47, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types-0.4.2.2/Crypto/Types/PubKey/DH.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 5, srcSpanEndLine = 47, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-types"><span class="mpre">deriving (Show,Read,Eq,Enum,Real,Num,Ord)</span></span><span class="mpre">
</span></div></body></html>