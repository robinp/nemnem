<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, MagicHash, UnboxedTuples #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.Attoparsec.Zepto</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Bryan O&#39;Sullivan 2007-2014</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A tiny, highly specialized combinator parser for &#39;B.ByteString&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- strings.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- While the main attoparsec module generally performs well, this</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- module is particularly fast for simple non-recursive loops that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- should not normally result in failed parses.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Warning/: on more complex inputs involving recursion or failure,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parsers based on this module may be as much as /ten times slower/</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- than regular attoparsec! You should /only/ use this module when you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- have benchmarks that prove that its use speeds your code up.</span></span><span class="mpre">
module Data.Attoparsec.Zepto
    (
      Parser
    , parse
    , atEnd
    , string
    , take
    , takeWhile
    ) where

import Data.Word (Word8)
import Control.Applicative
import Control.Monad
import Data.Monoid
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/attoparsec-0.12.1.0/Data/Attoparsec/Zepto.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 18, srcSpanEndLine = 37, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified Data.ByteString.Unsafe as B
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/attoparsec-0.12.1.0/Data/Attoparsec/Zepto.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 8, srcSpanEndLine = 39, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Prelude hiding (take, takeWhile)

newtype </span><a name="loc_42_9_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_10&#39;)"><span class="hl_tycondecl"><span class="mpre">S</span></span></a><span class="mpre"> = </span><a name="loc_42_13_42_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_14&#39;)"><span class="hl_condecl"><span class="mpre">S</span></span></a><span class="mpre"> {
      </span><a name="loc_43_7_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_12&#39;)"><span class="hl_fielddecl"><span class="mpre">input</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    }

data </span><a name="loc_46_6_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_6_46_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_condecl"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
              | </span><a name="loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_condecl"><span class="mpre">OK</span></span></a><span class="mpre"> !</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A simple parser.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This monad is strict in its state, and the monadic bind operator</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&#39;&gt;&gt;=&#39;) evaluates each result to weak head normal form before</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- passing it along.</span></span><span class="mpre">
newtype </span><a name="loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_54_20_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_26&#39;)"><span class="hl_condecl"><span class="mpre">Parser</span></span></a><span class="mpre"> {
      </span><a name="loc_55_7_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_16&#39;)"><span class="hl_fielddecl"><span class="mpre">runParser</span></span></a><span class="mpre"> :: </span><a href="#loc_42_9_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_10&#39;)"><span class="hl_tyconref"><span class="mpre">S</span></span></a><span class="mpre"> -&gt; (# </span><a href="#loc_46_6_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_6_46_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><a href="#loc_42_9_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_10&#39;)"><span class="hl_tyconref"><span class="mpre">S</span></span></a><span class="mpre"> #)
    }

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_59_12_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_12_59_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_54_20_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_26&#39;)"><span class="hl_conref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_59_26_59_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_55_7_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_16&#39;)"><span class="hl_varref"><span class="mpre">runParser</span></span></a><span class="mpre"> </span><a href="#loc_59_12_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_12_59_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_59_26_59_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
                                (# </span><a href="#loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_conref"><span class="mpre">OK</span></span></a><span class="mpre"> </span><a name="loc_60_39_60_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_39_60_40&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_60_42_60_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_42_60_44&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> #)     -&gt; (# </span><a href="#loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_conref"><span class="mpre">OK</span></span></a><span class="mpre"> (</span><a href="#loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_60_39_60_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_39_60_40&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">), </span><a href="#loc_60_42_60_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_42_60_44&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> #)
                                (# </span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a name="loc_61_41_61_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_41_61_44&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">, </span><a name="loc_61_46_61_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_46_61_48&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> #) -&gt; (# </span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a href="#loc_61_41_61_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_41_61_44&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">, </span><a href="#loc_61_46_61_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_46_61_48&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> #)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE fmap #-}</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_65_12_65_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_12_65_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_54_20_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_26&#39;)"><span class="hl_conref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_65_26_65_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_26_65_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; (# </span><a href="#loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_conref"><span class="mpre">OK</span></span></a><span class="mpre"> </span><a href="#loc_65_12_65_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_12_65_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_65_26_65_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_26_65_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> #)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE return #-}</span></span><span class="mpre">

    </span><a name="loc_68_5_68_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_68_11_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">   = </span><a href="#loc_54_20_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_26&#39;)"><span class="hl_conref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_68_27_68_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_27_68_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_55_7_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_16&#39;)"><span class="hl_varref"><span class="mpre">runParser</span></span></a><span class="mpre"> </span><a href="#loc_68_5_68_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_68_27_68_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_27_68_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
                                 (# </span><a href="#loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_conref"><span class="mpre">OK</span></span></a><span class="mpre"> </span><a name="loc_69_40_69_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_40_69_41&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_69_43_69_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_43_69_45&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> #) -&gt; </span><a href="#loc_55_7_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_16&#39;)"><span class="hl_varref"><span class="mpre">runParser</span></span></a><span class="mpre"> (</span><a href="#loc_68_11_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_69_40_69_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_40_69_41&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_69_43_69_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_43_69_45&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
                                 (# </span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a name="loc_70_42_70_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_42_70_45&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">, </span><a name="loc_70_47_70_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_47_70_49&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> #) -&gt; (# </span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a href="#loc_70_42_70_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_42_70_45&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">, </span><a href="#loc_70_47_70_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_47_70_49&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> #)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&gt;&gt;=) #-}</span></span><span class="mpre">

    </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> </span><a name="loc_73_10_73_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_13&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><a href="#loc_54_20_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_26&#39;)"><span class="hl_conref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_73_26_73_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_26_73_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; (# </span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a href="#loc_73_10_73_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_13&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">, </span><a href="#loc_73_26_73_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_26_73_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> #)

instance </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="hl_classref"><span class="mpre">MonadPlus</span></span></a><span class="mpre"> </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> where
    </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">mzero</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mzero&quot;</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="mpre">mzero</span></a><span class="mpre"> #-}</span></span><span class="mpre">

    </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">mplus</span></span></a><span class="mpre"> </span><a name="loc_79_11_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_54_20_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_26&#39;)"><span class="hl_conref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_79_27_79_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_27_79_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
                case </span><a href="#loc_55_7_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_16&#39;)"><span class="hl_varref"><span class="mpre">runParser</span></span></a><span class="mpre"> </span><a href="#loc_79_11_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_79_27_79_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_27_79_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
                  (# </span><a name="loc_81_22_81_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_22_81_24&#39;)"><span class="hl_specname"><span class="mpre">ok</span></span></a><span class="mpre">@(</span><a href="#loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_conref"><span class="mpre">OK</span></span></a><span class="mpre"> _), </span><a name="loc_81_33_81_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_33_81_35&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> #) -&gt; (# </span><a href="#loc_81_22_81_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_22_81_24&#39;)"><span class="hl_varref"><span class="mpre">ok</span></span></a><span class="mpre">, </span><a href="#loc_81_33_81_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_33_81_35&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> #)
                  (# _, _ #) -&gt; case </span><a href="#loc_55_7_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_16&#39;)"><span class="hl_varref"><span class="mpre">runParser</span></span></a><span class="mpre"> </span><a href="#loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_79_27_79_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_27_79_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
                                   (# </span><a name="loc_83_39_83_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_39_83_41&#39;)"><span class="hl_specname"><span class="mpre">ok</span></span></a><span class="mpre">@(</span><a href="#loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_conref"><span class="mpre">OK</span></span></a><span class="mpre"> _), </span><a name="loc_83_50_83_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_50_83_53&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre"> #) -&gt; (# </span><a href="#loc_83_39_83_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_39_83_41&#39;)"><span class="hl_varref"><span class="mpre">ok</span></span></a><span class="mpre">, </span><a href="#loc_83_50_83_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_50_83_53&#39;)"><span class="hl_varref"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre"> #)
                                   (# </span><a name="loc_84_39_84_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_39_84_42&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">, </span><a name="loc_84_44_84_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_44_84_47&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre"> #) -&gt; (# </span><a href="#loc_84_39_84_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_39_84_42&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">, </span><a href="#loc_84_44_84_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_44_84_47&#39;)"><span class="hl_varref"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre"> #)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="mpre">mplus</span></a><span class="mpre"> #-}</span></span><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> where
    </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="mpre">pure</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre">  = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="mpre">(&lt;*&gt;)</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_94_1_94_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_5&#39;)"><span class="mpre">gets</span></a><span class="mpre"> :: (</span><a href="#loc_42_9_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_10&#39;)"><span class="hl_tyconref"><span class="mpre">S</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_94_1_94_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_5&#39;)"><span class="hl_fundecl"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a name="loc_94_6_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_6_94_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_54_20_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_26&#39;)"><span class="hl_conref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_94_20_94_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_20_94_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; (# </span><a href="#loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_conref"><span class="mpre">OK</span></span></a><span class="mpre"> (</span><a href="#loc_94_6_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_6_94_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_94_20_94_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_20_94_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">), </span><a href="#loc_94_20_94_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_20_94_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> #)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_94_1_94_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_5&#39;)"><span class="mpre">gets</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_98_1_98_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_4&#39;)"><span class="mpre">put</span></a><span class="mpre"> :: </span><a href="#loc_42_9_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_10&#39;)"><span class="hl_tyconref"><span class="mpre">S</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_98_1_98_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_4&#39;)"><span class="hl_fundecl"><span class="mpre">put</span></span></a><span class="mpre"> </span><a name="loc_98_5_98_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_54_20_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_20_54_26&#39;)"><span class="hl_conref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ -&gt; (# </span><a href="#loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_conref"><span class="mpre">OK</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><a href="#loc_98_5_98_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> #)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_98_1_98_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_4&#39;)"><span class="mpre">put</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Run a parser.</span></span><span class="mpre">
</span><a href="#loc_103_1_103_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_6&#39;)"><span class="mpre">parse</span></a><span class="mpre"> :: </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_103_1_103_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_6&#39;)"><span class="hl_fundecl"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a name="loc_103_7_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_7_103_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_103_9_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = case </span><a href="#loc_55_7_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_16&#39;)"><span class="hl_varref"><span class="mpre">runParser</span></span></a><span class="mpre"> </span><a href="#loc_103_7_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_7_103_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_42_13_42_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_14&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> </span><a href="#loc_103_9_103_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) of
               (# </span><a href="#loc_47_17_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_19&#39;)"><span class="hl_conref"><span class="mpre">OK</span></span></a><span class="mpre"> </span><a name="loc_104_22_104_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_22_104_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, _ #) -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_104_22_104_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_22_104_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
               (# </span><a href="#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a name="loc_105_24_105_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_24_105_27&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">, _ #) -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_105_24_105_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_24_105_27&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> (</span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mempty&quot;</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_vardecl"><span class="mpre">mappend</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_varref"><span class="mpre">mplus</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre"> #-}</span></span><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="hl_classref"><span class="mpre">Alternative</span></span></a><span class="mpre"> </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> where
    </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;empty&quot;</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="mpre">empty</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;|&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_varref"><span class="mpre">mplus</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="mpre">(&lt;|&gt;)</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Consume input while the predicate returns &#39;True&#39;.</span></span><span class="mpre">
</span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="mpre">takeWhile</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_fundecl"><span class="mpre">takeWhile</span></span></a><span class="mpre"> </span><a name="loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do
  (</span><a name="loc_122_4_122_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_4_122_5&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">,</span><a name="loc_122_6_122_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_6_122_7&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_94_1_94_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.span</span></span><span class="mpre"> </span><a href="#loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_43_7_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_12&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">)
  </span><a href="#loc_98_1_98_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_4&#39;)"><span class="hl_varref"><span class="mpre">put</span></span></a><span class="mpre"> (</span><a href="#loc_42_13_42_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_14&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> </span><a href="#loc_122_6_122_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_6_122_7&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_122_4_122_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_4_122_5&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="mpre">takeWhile</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Consume @n@ bytes of input.</span></span><span class="mpre">
</span><a href="#loc_129_1_129_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_5&#39;)"><span class="mpre">take</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_129_1_129_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_5&#39;)"><span class="hl_fundecl"><span class="mpre">take</span></span></a><span class="mpre"> !</span><a name="loc_129_7_129_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_7_129_8&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = do
  </span><a name="loc_130_3_130_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_3_130_4&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_94_1_94_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_12&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
  if </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_130_3_130_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_3_130_4&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_129_7_129_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_7_129_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    then </span><a href="#loc_98_1_98_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_4&#39;)"><span class="hl_varref"><span class="mpre">put</span></span></a><span class="mpre"> (</span><a href="#loc_42_13_42_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_14&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Unsafe.html#loc_148_1_148_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_148_1_148_11&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeDrop</span></span></a><span class="mpre"> </span><a href="#loc_129_7_129_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_7_129_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_130_3_130_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_3_130_4&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.ByteString.Unsafe.html#loc_142_1_142_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_142_1_142_11&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeTake</span></span></a><span class="mpre"> </span><a href="#loc_129_7_129_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_7_129_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_130_3_130_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_3_130_4&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    else </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;insufficient input&quot;</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_129_1_129_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_5&#39;)"><span class="mpre">take</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Match a string exactly.</span></span><span class="mpre">
</span><a href="#loc_138_1_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_7&#39;)"><span class="mpre">string</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_138_1_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_7&#39;)"><span class="hl_fundecl"><span class="mpre">string</span></span></a><span class="mpre"> </span><a name="loc_138_8_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
  </span><a name="loc_139_3_139_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_3_139_4&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_94_1_94_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_12&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
  if </span><a href="#loc_138_8_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.isPrefixOf`</span></span><span class="mpre"> </span><a href="#loc_139_3_139_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_3_139_4&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
    then </span><a href="#loc_98_1_98_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_4&#39;)"><span class="hl_varref"><span class="mpre">put</span></span></a><span class="mpre"> (</span><a href="#loc_42_13_42_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_14&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Unsafe.html#loc_148_1_148_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_148_1_148_11&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeDrop</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_138_8_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_139_3_139_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_3_139_4&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    else </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;string&quot;</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_138_1_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_7&#39;)"><span class="mpre">string</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Indicate whether the end of the input has been reached.</span></span><span class="mpre">
</span><a href="#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_6&#39;)"><span class="mpre">atEnd</span></a><span class="mpre"> :: </span><a href="#loc_54_9_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_147_1_147_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_6&#39;)"><span class="hl_vardecl"><span class="mpre">atEnd</span></span></a><span class="mpre"> = do
  </span><a name="loc_148_3_148_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_3_148_4&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_94_1_94_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_12&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_148_3_148_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_3_148_4&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_6&#39;)"><span class="mpre">atEnd</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>