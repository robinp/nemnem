<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.PublicKey</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Public key handling in X.509 infrastructure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.X509.PublicKey
    ( PubKey(..)
    , pubkeyToAlg
    ) where

import Data.ASN1.Types
import Data.ASN1.Encoding
import Data.ASN1.BinaryEncoding
import Data.ASN1.BitArray

import Data.X509.Internal
import Data.X509.AlgorithmIdentifier

import qualified Crypto.Types.PubKey.RSA as RSA
import qualified Crypto.Types.PubKey.DSA as DSA
import qualified Crypto.Types.PubKey.ECC as ECC
import Data.Word

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/PublicKey.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 18, srcSpanEndLine = 28, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B

</span><span class="hl_comment"><span class="mpre">-- | Public key types known and used in X.509</span></span><span class="mpre">
data </span><a name="loc_31_6_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_6_31_12&#39;)"><span class="hl_tycondecl"><span class="mpre">PubKey</span></span></a><span class="mpre"> =
      </span><a name="loc_32_7_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_16&#39;)"><span class="hl_condecl"><span class="mpre">PubKeyRSA</span></span></a><span class="mpre"> </span><a href="Crypto.Types.PubKey.RSA.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">RSA.PublicKey</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ RSA public key</span></span><span class="mpre">
    | </span><a name="loc_33_7_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_16&#39;)"><span class="hl_condecl"><span class="mpre">PubKeyDSA</span></span></a><span class="mpre"> </span><a href="Crypto.Types.PubKey.DSA.html#loc_68_6_68_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_68_6_68_15&#39;)"><span class="hl_tyconref"><span class="mpre">DSA.PublicKey</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ DSA public key</span></span><span class="mpre">
    | </span><a name="loc_34_7_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_15&#39;)"><span class="hl_condecl"><span class="mpre">PubKeyDH</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">,([</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">))
                                </span><span class="hl_comment"><span class="mpre">-- ^ DH format with (p,g,q,j,(seed,pgenCounter))</span></span><span class="mpre">
    | </span><a name="loc_36_7_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_18&#39;)"><span class="hl_condecl"><span class="mpre">PubKeyECDSA</span></span></a><span class="mpre"> </span><a href="Crypto.Types.PubKey.ECC.html#loc_82_6_82_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_82_6_82_15&#39;)"><span class="hl_tyconref"><span class="mpre">ECC.CurveName</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
    | </span><a name="loc_37_7_37_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_20&#39;)"><span class="hl_condecl"><span class="mpre">PubKeyUnknown</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">OID</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ unrecognized format</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/PublicKey.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 5, srcSpanEndLine = 38, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/PublicKey.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 5, srcSpanEndLine = 38, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/PublicKey.hs&quot;, srcSpanStartLine = 3"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Public key are in the format:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Start Sequence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      OID (Public key algorithm)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      [public key specific format]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      BitString</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- End Sequence</span></span><span class="mpre">
instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_31_6_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_6_31_12&#39;)"><span class="hl_tyconref"><span class="mpre">PubKey</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_49_7_49_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_49_7_49_10&#39;)"><span class="hl_conref"><span class="mpre">OID</span></span></a><span class="mpre"> </span><a name="loc_48_49_48_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_49_48_54&#39;)"><span class="hl_vardecl"><span class="mpre">pkalg</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_48_55_48_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_55_48_57&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
        | </span><a href="#loc_48_49_48_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_49_48_54&#39;)"><span class="hl_varref"><span class="mpre">pkalg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Data.ASN1.OID.html#loc_22_5_22_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_22_5_22_16&#39;)"><span class="hl_varref"><span class="mpre">getObjectID</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_30_7_30_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_30_7_30_20&#39;)"><span class="hl_conref"><span class="mpre">PubKeyALG_RSA</span></span></a><span class="mpre"> =
            case </span><a href="#loc_83_13_83_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_23&#39;)"><span class="hl_varref"><span class="mpre">removeNull</span></span></a><span class="mpre"> </span><a href="#loc_48_55_48_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_55_48_57&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                </span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_46_7_46_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_46_7_46_16&#39;)"><span class="hl_conref"><span class="mpre">BitString</span></span></a><span class="mpre"> </span><a name="loc_51_40_51_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_40_51_44&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_51_58_51_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_58_51_61&#39;)"><span class="hl_vardecl"><span class="mpre">xs2</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_75_13_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_26&#39;)"><span class="hl_varref"><span class="mpre">decodeASN1Err</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;RSA&quot;</span></span><span class="mpre"> </span><a href="#loc_51_40_51_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_40_51_44&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre"> </span><a href="#loc_51_58_51_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_58_51_61&#39;)"><span class="hl_varref"><span class="mpre">xs2</span></span></a><span class="mpre"> (</span><a href="#loc_81_13_81_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_24&#39;)"><span class="hl_varref"><span class="mpre">toPubKeyRSA</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_varref"><span class="mpre">fromASN1</span></span></a><span class="mpre">)
                _ -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;fromASN1: X509.PubKey: unknown RSA format: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_48_55_48_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_55_48_57&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        | </span><a href="#loc_48_49_48_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_49_48_54&#39;)"><span class="hl_varref"><span class="mpre">pkalg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Data.ASN1.OID.html#loc_22_5_22_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_22_5_22_16&#39;)"><span class="hl_varref"><span class="mpre">getObjectID</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_31_7_31_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_31_7_31_20&#39;)"><span class="hl_conref"><span class="mpre">PubKeyALG_DSA</span></span></a><span class="mpre">   =
            case </span><a href="#loc_48_55_48_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_55_48_57&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">q</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">g</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_46_7_46_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_46_7_46_16&#39;)"><span class="hl_conref"><span class="mpre">BitString</span></span></a><span class="mpre"> </span><a name="loc_55_95_55_99" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_95_55_99&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_55_113_55_116" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_113_55_116&#39;)"><span class="hl_vardecl"><span class="mpre">xs2</span></span></a><span class="mpre"> -&gt;
                    </span><a href="#loc_75_13_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_26&#39;)"><span class="hl_varref"><span class="mpre">decodeASN1Err</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;DSA&quot;</span></span><span class="mpre"> </span><a href="#loc_55_95_55_99" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_95_55_99&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre"> </span><a href="#loc_55_113_55_116" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_113_55_116&#39;)"><span class="hl_varref"><span class="mpre">xs2</span></span></a><span class="mpre"> (\</span><a name="loc_56_52_56_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_52_56_53&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_56_52_56_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_52_56_53&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> of
                        [</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">dsapub</span></span><span class="mpre">] -&gt;
                            let </span><a name="loc_58_33_58_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_33_58_39&#39;)"><span class="hl_vardecl"><span class="mpre">pubkey</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/PublicKey.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 42, srcSpanEndLine = 62, srcSpanEndColumn = 101}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/PublicKey.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 56, srcSpanEndLine = 58, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/PublicKey.hs&quot;, srcSpanStartLine"><span class="mpre">DSA.PublicKey { DSA.public_params = DSA.Params { DSA.params_p = p
                                                                                        , DSA.params_q = q
                                                                                        , DSA.params_g = g
                                                                                        }
                                                                           , DSA.public_y = dsapub }</span></span><span class="mpre">
                             in </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_33_7_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_16&#39;)"><span class="hl_conref"><span class="mpre">PubKeyDSA</span></span></a><span class="mpre"> </span><a href="#loc_58_33_58_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_33_58_39&#39;)"><span class="hl_varref"><span class="mpre">pubkey</span></span></a><span class="mpre">, [])
                        _ -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;fromASN1: X509.PubKey: unknown DSA format&quot;</span></span><span class="mpre">
                        )
                _ -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;fromASN1: X509.PubKey: unknown DSA format&quot;</span></span><span class="mpre">
        | </span><a href="#loc_48_49_48_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_49_48_54&#39;)"><span class="hl_varref"><span class="mpre">pkalg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Data.ASN1.OID.html#loc_22_5_22_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_22_5_22_16&#39;)"><span class="hl_varref"><span class="mpre">getObjectID</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_32_7_32_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_32_7_32_22&#39;)"><span class="hl_conref"><span class="mpre">PubKeyALG_ECDSA</span></span></a><span class="mpre"> =
            case </span><a href="#loc_48_55_48_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_55_48_57&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                </span><a href="Data.ASN1.Types.html#loc_49_7_49_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_49_7_49_10&#39;)"><span class="hl_conref"><span class="mpre">OID</span></span></a><span class="mpre"> </span><a name="loc_69_21_69_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_21_69_29&#39;)"><span class="hl_vardecl"><span class="mpre">curveOid</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_46_7_46_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_46_7_46_16&#39;)"><span class="hl_conref"><span class="mpre">BitString</span></span></a><span class="mpre"> </span><a name="loc_69_53_69_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_53_69_57&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_69_71_69_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_71_69_74&#39;)"><span class="hl_vardecl"><span class="mpre">xs2</span></span></a><span class="mpre"> -&gt;
                    case </span><a href="Data.ASN1.OID.html#loc_27_5_27_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_27_5_27_17&#39;)"><span class="hl_varref"><span class="mpre">fromObjectID</span></span></a><span class="mpre"> </span><a href="#loc_69_21_69_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_21_69_29&#39;)"><span class="hl_varref"><span class="mpre">curveOid</span></span></a><span class="mpre"> of
                        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_71_30_71_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_30_71_39&#39;)"><span class="hl_vardecl"><span class="mpre">curveName</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_36_7_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_18&#39;)"><span class="hl_conref"><span class="mpre">PubKeyECDSA</span></span></a><span class="mpre"> </span><a href="#loc_71_30_71_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_30_71_39&#39;)"><span class="hl_varref"><span class="mpre">curveName</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.BitArray.html#loc_77_1_77_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BitArray.html#loc_77_1_77_16&#39;)"><span class="hl_varref"><span class="mpre">bitArrayGetData</span></span></a><span class="mpre"> </span><a href="#loc_69_53_69_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_53_69_57&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre">), </span><a href="#loc_69_71_69_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_71_69_74&#39;)"><span class="hl_varref"><span class="mpre">xs2</span></span></a><span class="mpre">)
                        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">        -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;fromASN1: X509.Pubkey: ECDSA unknown curve &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_69_21_69_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_21_69_29&#39;)"><span class="hl_varref"><span class="mpre">curveOid</span></span></a><span class="mpre">)
                _ -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;fromASN1: X509.PubKey: unknown ECDSA format&quot;</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;unknown public key OID: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_48_49_48_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_49_48_54&#39;)"><span class="hl_varref"><span class="mpre">pkalg</span></span></a><span class="mpre">)
      where </span><a name="loc_75_13_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_26&#39;)"><span class="hl_fundecl"><span class="mpre">decodeASN1Err</span></span></a><span class="mpre"> </span><a name="loc_75_27_75_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_27_75_33&#39;)"><span class="hl_vardecl"><span class="mpre">format</span></span></a><span class="mpre"> </span><a name="loc_75_34_75_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_34_75_38&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="mpre"> </span><a name="loc_75_39_75_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_39_75_42&#39;)"><span class="hl_vardecl"><span class="mpre">xs2</span></span></a><span class="mpre"> </span><a name="loc_75_43_75_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_43_75_44&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
                case </span><a href="Data.ASN1.Encoding.html#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">decodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_27_12_27_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_27_12_27_15&#39;)"><span class="hl_conref"><span class="mpre">BER</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.BitArray.html#loc_77_1_77_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BitArray.html#loc_77_1_77_16&#39;)"><span class="hl_varref"><span class="mpre">bitArrayGetData</span></span></a><span class="mpre"> </span><a href="#loc_75_34_75_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_34_75_38&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre">) of
                    </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_77_26_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_26_77_29&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;fromASN1: X509.PubKey &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_75_27_75_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_27_75_33&#39;)"><span class="hl_varref"><span class="mpre">format</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; bitarray cannot be parsed: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_77_26_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_26_77_29&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)
                    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_78_27_78_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_27_78_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  -&gt; case </span><a href="#loc_75_43_75_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_43_75_44&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_78_27_78_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_27_78_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
                                    </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_79_42_79_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_42_79_45&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_79_42_79_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_42_79_45&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
                                    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_80_44_80_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_44_80_45&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">, </span><a name="loc_80_47_80_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_47_80_54&#39;)"><span class="hl_vardecl"><span class="mpre">xsinner</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_80_44_80_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_44_80_45&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">, </span><a href="#loc_80_47_80_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_47_80_54&#39;)"><span class="hl_varref"><span class="mpre">xsinner</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_75_39_75_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_39_75_42&#39;)"><span class="hl_varref"><span class="mpre">xs2</span></span></a><span class="mpre">)
            </span><a name="loc_81_13_81_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_24&#39;)"><span class="hl_vardecl"><span class="mpre">toPubKeyRSA</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (\(</span><a name="loc_81_42_81_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_42_81_48&#39;)"><span class="hl_vardecl"><span class="mpre">rsaKey</span></span></a><span class="mpre">, </span><a name="loc_81_50_81_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_50_81_51&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_32_7_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_16&#39;)"><span class="hl_conref"><span class="mpre">PubKeyRSA</span></span></a><span class="mpre"> </span><a href="#loc_81_42_81_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_42_81_48&#39;)"><span class="hl_varref"><span class="mpre">rsaKey</span></span></a><span class="mpre">, </span><a href="#loc_81_50_81_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_50_81_51&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">))

            </span><a name="loc_83_13_83_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_23&#39;)"><span class="hl_fundecl"><span class="mpre">removeNull</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_48_7_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_48_7_48_11&#39;)"><span class="hl_conref"><span class="mpre">Null</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_83_30_83_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_30_83_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_83_30_83_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_30_83_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
            </span><a href="#loc_83_13_83_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_23&#39;)"><span class="hl_fundecl"><span class="mpre">removeNull</span></span></a><span class="mpre"> </span><a name="loc_84_24_84_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_24_84_25&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">         = </span><a href="#loc_84_24_84_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_24_84_25&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> </span><a name="loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;fromASN1: X509.PubKey: unknown format:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a name="loc_87_12_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = \</span><a name="loc_87_17_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_98_1_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_9&#39;)"><span class="hl_varref"><span class="mpre">encodePK</span></span></a><span class="mpre"> </span><a href="#loc_87_12_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_87_17_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a Public key to the Public Key Algorithm type</span></span><span class="mpre">
</span><a href="#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_12&#39;)"><span class="mpre">pubkeyToAlg</span></a><span class="mpre"> :: </span><a href="#loc_31_6_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_6_31_12&#39;)"><span class="hl_tyconref"><span class="mpre">PubKey</span></span></a><span class="mpre"> -&gt; </span><a href="Data.X509.AlgorithmIdentifier.html#loc_29_6_29_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_29_6_29_15&#39;)"><span class="hl_tyconref"><span class="mpre">PubKeyALG</span></span></a><span class="mpre">
</span><a name="loc_91_1_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_12&#39;)"><span class="hl_fundecl"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> (</span><a href="#loc_32_7_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_16&#39;)"><span class="hl_conref"><span class="mpre">PubKeyRSA</span></span></a><span class="mpre"> _)         = </span><a href="Data.X509.AlgorithmIdentifier.html#loc_30_7_30_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_30_7_30_20&#39;)"><span class="hl_conref"><span class="mpre">PubKeyALG_RSA</span></span></a><span class="mpre">
</span><a href="#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_12&#39;)"><span class="hl_fundecl"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> (</span><a href="#loc_33_7_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_16&#39;)"><span class="hl_conref"><span class="mpre">PubKeyDSA</span></span></a><span class="mpre"> _)         = </span><a href="Data.X509.AlgorithmIdentifier.html#loc_31_7_31_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_31_7_31_20&#39;)"><span class="hl_conref"><span class="mpre">PubKeyALG_DSA</span></span></a><span class="mpre">
</span><a href="#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_12&#39;)"><span class="hl_fundecl"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> (</span><a href="#loc_34_7_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_15&#39;)"><span class="hl_conref"><span class="mpre">PubKeyDH</span></span></a><span class="mpre"> _)          = </span><a href="Data.X509.AlgorithmIdentifier.html#loc_33_7_33_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_33_7_33_19&#39;)"><span class="hl_conref"><span class="mpre">PubKeyALG_DH</span></span></a><span class="mpre">
</span><a href="#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_12&#39;)"><span class="hl_fundecl"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> (</span><a href="#loc_36_7_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_18&#39;)"><span class="hl_conref"><span class="mpre">PubKeyECDSA</span></span></a><span class="mpre"> _ _)     = </span><a href="Data.X509.AlgorithmIdentifier.html#loc_32_7_32_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_32_7_32_22&#39;)"><span class="hl_conref"><span class="mpre">PubKeyALG_ECDSA</span></span></a><span class="mpre">
</span><a href="#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_12&#39;)"><span class="hl_fundecl"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> (</span><a href="#loc_37_7_37_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_20&#39;)"><span class="hl_conref"><span class="mpre">PubKeyUnknown</span></span></a><span class="mpre"> </span><a name="loc_95_28_95_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_28_95_31&#39;)"><span class="hl_vardecl"><span class="mpre">oid</span></span></a><span class="mpre"> _) = </span><a href="Data.X509.AlgorithmIdentifier.html#loc_34_7_34_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_34_7_34_24&#39;)"><span class="hl_conref"><span class="mpre">PubKeyALG_Unknown</span></span></a><span class="mpre"> </span><a href="#loc_95_28_95_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_28_95_31&#39;)"><span class="hl_varref"><span class="mpre">oid</span></span></a><span class="mpre">

</span><a href="#loc_98_1_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_9&#39;)"><span class="mpre">encodePK</span></a><span class="mpre"> :: </span><a href="#loc_31_6_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_6_31_12&#39;)"><span class="hl_tyconref"><span class="mpre">PubKey</span></span></a><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">]
</span><a name="loc_98_1_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_9&#39;)"><span class="hl_fundecl"><span class="mpre">encodePK</span></span></a><span class="mpre"> </span><a name="loc_98_10_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_13&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre"> = </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> (</span><a href="#loc_101_5_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_16&#39;)"><span class="hl_varref"><span class="mpre">encodeInner</span></span></a><span class="mpre"> </span><a href="#loc_98_10_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_13&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">)
  where
    </span><a name="loc_100_5_100_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_10&#39;)"><span class="hl_vardecl"><span class="mpre">pkalg</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Types.html#loc_49_7_49_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_49_7_49_10&#39;)"><span class="hl_conref"><span class="mpre">OID</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.OID.html#loc_22_5_22_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.OID.html#loc_22_5_22_16&#39;)"><span class="hl_varref"><span class="mpre">getObjectID</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_12&#39;)"><span class="hl_varref"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> </span><a href="#loc_98_10_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_13&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">
    </span><a name="loc_101_5_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_16&#39;)"><span class="hl_fundecl"><span class="mpre">encodeInner</span></span></a><span class="mpre"> (</span><a href="#loc_32_7_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_16&#39;)"><span class="hl_conref"><span class="mpre">PubKeyRSA</span></span></a><span class="mpre"> </span><a name="loc_101_28_101_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_28_101_34&#39;)"><span class="hl_vardecl"><span class="mpre">pubkey</span></span></a><span class="mpre">) =
        </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> [</span><a href="#loc_100_5_100_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_10&#39;)"><span class="hl_varref"><span class="mpre">pkalg</span></span></a><span class="mpre">,</span><a href="Data.ASN1.Types.html#loc_48_7_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_48_7_48_11&#39;)"><span class="hl_conref"><span class="mpre">Null</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_46_7_46_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_46_7_46_16&#39;)"><span class="hl_conref"><span class="mpre">BitString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.BitArray.html#loc_81_1_81_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BitArray.html#loc_81_1_81_11&#39;)"><span class="hl_varref"><span class="mpre">toBitArray</span></span></a><span class="mpre"> </span><a href="#loc_103_13_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_13_103_17&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
      where </span><a name="loc_103_13_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_13_103_17&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_27_7_27_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_27_7_27_15&#39;)"><span class="hl_varref"><span class="mpre">RSA.public_n</span></span></a><span class="mpre"> </span><a href="#loc_101_28_101_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_28_101_34&#39;)"><span class="hl_varref"><span class="mpre">pubkey</span></span></a><span class="mpre">), </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_28_7_28_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_28_7_28_15&#39;)"><span class="hl_varref"><span class="mpre">RSA.public_e</span></span></a><span class="mpre"> </span><a href="#loc_101_28_101_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_28_101_34&#39;)"><span class="hl_varref"><span class="mpre">pubkey</span></span></a><span class="mpre">)]
    </span><a href="#loc_101_5_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_16&#39;)"><span class="hl_fundecl"><span class="mpre">encodeInner</span></span></a><span class="mpre"> (</span><a href="#loc_33_7_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_16&#39;)"><span class="hl_conref"><span class="mpre">PubKeyDSA</span></span></a><span class="mpre"> </span><a name="loc_104_28_104_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_28_104_34&#39;)"><span class="hl_vardecl"><span class="mpre">pubkey</span></span></a><span class="mpre">) =
        </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> ([</span><a href="#loc_100_5_100_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_10&#39;)"><span class="hl_varref"><span class="mpre">pkalg</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_107_9_107_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_15&#39;)"><span class="hl_varref"><span class="mpre">dsaseq</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_46_7_46_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_46_7_46_16&#39;)"><span class="hl_conref"><span class="mpre">BitString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.BitArray.html#loc_81_1_81_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BitArray.html#loc_81_1_81_11&#39;)"><span class="hl_varref"><span class="mpre">toBitArray</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_13&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
      where
        </span><a name="loc_107_9_107_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_15&#39;)"><span class="hl_vardecl"><span class="mpre">dsaseq</span></span></a><span class="mpre"> = </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.DSA.html#loc_35_7_35_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_35_7_35_15&#39;)"><span class="hl_varref"><span class="mpre">DSA.params_p</span></span></a><span class="mpre"> </span><a href="#loc_110_9_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_15&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">)
                                        ,</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.DSA.html#loc_37_7_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_37_7_37_15&#39;)"><span class="hl_varref"><span class="mpre">DSA.params_q</span></span></a><span class="mpre"> </span><a href="#loc_110_9_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_15&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">)
                                        ,</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.DSA.html#loc_36_7_36_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_36_7_36_15&#39;)"><span class="hl_varref"><span class="mpre">DSA.params_g</span></span></a><span class="mpre"> </span><a href="#loc_110_9_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_15&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">)]
        </span><a name="loc_110_9_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_15&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre"> = </span><a href="Crypto.Types.PubKey.DSA.html#loc_69_7_69_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_69_7_69_20&#39;)"><span class="hl_varref"><span class="mpre">DSA.public_params</span></span></a><span class="mpre"> </span><a href="#loc_104_28_104_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_28_104_34&#39;)"><span class="hl_varref"><span class="mpre">pubkey</span></span></a><span class="mpre">
        </span><a name="loc_111_9_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_13&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="mpre">   = </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.DSA.html#loc_70_7_70_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_70_7_70_15&#39;)"><span class="hl_varref"><span class="mpre">DSA.public_y</span></span></a><span class="mpre"> </span><a href="#loc_104_28_104_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_28_104_34&#39;)"><span class="hl_varref"><span class="mpre">pubkey</span></span></a><span class="mpre">]
    </span><a href="#loc_101_5_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_16&#39;)"><span class="hl_fundecl"><span class="mpre">encodeInner</span></span></a><span class="mpre"> (</span><a href="#loc_36_7_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_18&#39;)"><span class="hl_conref"><span class="mpre">PubKeyECDSA</span></span></a><span class="mpre"> </span><a name="loc_112_30_112_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_30_112_39&#39;)"><span class="hl_vardecl"><span class="mpre">curveName</span></span></a><span class="mpre"> </span><a name="loc_112_40_112_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_40_112_44&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="mpre">) =
        </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> [</span><a href="#loc_100_5_100_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_10&#39;)"><span class="hl_varref"><span class="mpre">pkalg</span></span></a><span class="mpre">,</span><a href="Data.ASN1.Types.html#loc_49_7_49_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_49_7_49_10&#39;)"><span class="hl_conref"><span class="mpre">OID</span></span></a><span class="mpre"> </span><a href="#loc_115_9_115_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_13&#39;)"><span class="hl_varref"><span class="mpre">eOid</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_46_7_46_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_46_7_46_16&#39;)"><span class="hl_conref"><span class="mpre">BitString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.BitArray.html#loc_81_1_81_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BitArray.html#loc_81_1_81_11&#39;)"><span class="hl_varref"><span class="mpre">toBitArray</span></span></a><span class="mpre"> </span><a href="#loc_112_40_112_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_40_112_44&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
      where
        </span><a name="loc_115_9_115_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_13&#39;)"><span class="hl_vardecl"><span class="mpre">eOid</span></span></a><span class="mpre"> = case </span><a href="#loc_112_30_112_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_30_112_39&#39;)"><span class="hl_varref"><span class="mpre">curveName</span></span></a><span class="mpre"> of
                    </span><a href="Crypto.Types.PubKey.ECC.html#loc_96_7_96_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.ECC.html#loc_96_7_96_17&#39;)"><span class="hl_conref"><span class="mpre">ECC.SEC_p384r1</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">132</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">34</span></span><span class="mpre">]
                    _              -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;undefined curve OID: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_112_30_112_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_30_112_39&#39;)"><span class="hl_varref"><span class="mpre">curveName</span></span></a><span class="mpre">)
    </span><a href="#loc_101_5_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_16&#39;)"><span class="hl_fundecl"><span class="mpre">encodeInner</span></span></a><span class="mpre"> (</span><a href="#loc_34_7_34_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_15&#39;)"><span class="hl_conref"><span class="mpre">PubKeyDH</span></span></a><span class="mpre"> _) = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;encodeInner: unimplemented public key DH&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_5_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_16&#39;)"><span class="hl_fundecl"><span class="mpre">encodeInner</span></span></a><span class="mpre"> (</span><a href="#loc_37_7_37_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_20&#39;)"><span class="hl_conref"><span class="mpre">PubKeyUnknown</span></span></a><span class="mpre"> _ </span><a name="loc_119_34_119_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_34_119_35&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) =
        </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> [</span><a href="#loc_100_5_100_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_10&#39;)"><span class="hl_varref"><span class="mpre">pkalg</span></span></a><span class="mpre">,</span><a href="Data.ASN1.Types.html#loc_48_7_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_48_7_48_11&#39;)"><span class="hl_conref"><span class="mpre">Null</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_46_7_46_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_46_7_46_16&#39;)"><span class="hl_conref"><span class="mpre">BitString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.BitArray.html#loc_81_1_81_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BitArray.html#loc_81_1_81_11&#39;)"><span class="hl_varref"><span class="mpre">toBitArray</span></span></a><span class="mpre"> </span><a href="#loc_119_34_119_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_34_119_35&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
</span></div></body></html>