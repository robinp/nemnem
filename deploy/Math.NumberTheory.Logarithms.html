<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, MagicHash, UnboxedTuples #-}

</span><span class="hl_comment"><span class="mpre">-- | Integer logarithm, copied from Daniel Fischer&#39;s @arithmoi@</span></span><span class="mpre">
module Math.NumberTheory.Logarithms ( integerLog10&#39; ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/scientific-0.3.2.1/src/Math/NumberTheory/Logarithms.hs&quot;, srcSpanStartLine = 6, srcSpanStartColumn = 8, srcSpanEndLine = 6, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">

#if __GLASGOW_HASKELL__ &gt;= 702
import GHC.Integer.Logarithms
#else
#include &quot;MachDeps.h&quot;

import GHC.Integer.GMP.Internals

#if (WORD_SIZE_IN_BITS != 32) &amp;&amp; (WORD_SIZE_IN_BITS != 64)
#error Only word sizes 32 and 64 are supported.
#endif


#if WORD_SIZE_IN_BITS == 32

#define WSHIFT 5
#define MMASK 31

#else

#define WSHIFT 6
#define MMASK 63

#endif

</span><span class="hl_comment"><span class="mpre">-- | Calculate the integer base 2 logarithm of an &#39;Integer&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The calculation is much more efficient than for the general case.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The argument must be strictly positive, that condition is /not/ checked.</span></span><span class="mpre">
</span><a href="#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="mpre">integerLog2#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int#</span></span><span class="mpre">
</span><a name="loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog2#</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">S#</span></span><span class="mpre"> </span><a name="loc_37_18_37_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_18_37_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">int2Word#</span></span><span class="mpre"> </span><a href="#loc_37_18_37_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_18_37_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
</span><a href="#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog2#</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">J#</span></span><span class="mpre"> </span><a name="loc_38_18_38_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_18_38_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_38_20_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_20_38_22&#39;)"><span class="hl_vardecl"><span class="mpre">ba</span></span></a><span class="mpre">) = </span><a href="#loc_40_5_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> (</span><a href="#loc_38_18_38_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_18_38_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> 1#)
  where
    </span><a name="loc_40_5_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_10&#39;)"><span class="hl_fundecl"><span class="mpre">check</span></span></a><span class="mpre"> </span><a name="loc_40_11_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">indexWordArray#</span></span><span class="mpre"> </span><a href="#loc_38_20_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_20_38_22&#39;)"><span class="hl_varref"><span class="mpre">ba</span></span></a><span class="mpre"> </span><a href="#loc_40_11_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
                0## -&gt; </span><a href="#loc_40_5_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> (</span><a href="#loc_40_11_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> 1#)
                </span><a name="loc_42_17_42_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_18&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">   -&gt; </span><a href="#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> </span><a href="#loc_42_17_42_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+#</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uncheckedIShiftL#</span></span><span class="mpre"> </span><a href="#loc_40_11_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">WSHIFT#</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | This function calculates the integer base 2 logarithm of a &#39;Word#&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   @&#39;wordLog2#&#39; 0## = -1#@.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_10&#39;)"><span class="mpre">wordLog2#</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_10&#39;)"><span class="mpre">wordLog2#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word#</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int#</span></span><span class="mpre">
</span><a name="loc_48_1_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_10&#39;)"><span class="hl_fundecl"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> </span><a name="loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> =
  case </span><a href="#loc_94_1_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_13&#39;)"><span class="hl_varref"><span class="mpre">leadingZeros</span></span></a><span class="mpre"> of
   </span><a href="#loc_91_11_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_13&#39;)"><span class="hl_conref"><span class="mpre">BA</span></span></a><span class="mpre"> </span><a name="loc_50_7_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_9&#39;)"><span class="hl_vardecl"><span class="mpre">lz</span></span></a><span class="mpre"> -&gt;
    let </span><a name="loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_fundecl"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a name="loc_51_15_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_15_51_16&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">indexInt8Array#</span></span><span class="mpre"> </span><a href="#loc_50_7_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_9&#39;)"><span class="hl_varref"><span class="mpre">lz</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">word2Int#</span></span><span class="mpre"> </span><a href="#loc_51_15_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_15_51_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) in
#if WORD_SIZE_IN_BITS == 64
    case </span><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span><span class="mpre"> </span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 56# of
     </span><a name="loc_54_6_54_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt;
      if </span><a href="#loc_54_6_54_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`neWord#`</span></span><span class="mpre"> 0##
       then 64# </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_54_6_54_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
       else
        case </span><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span><span class="mpre"> </span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 48# of
         </span><a name="loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt;
          if </span><a href="#loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`neWord#`</span></span><span class="mpre"> 0##
           then 56# </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
           else
            case </span><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span><span class="mpre"> </span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 40# of
             </span><a name="loc_64_14_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_14_64_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt;
              if </span><a href="#loc_64_14_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_14_64_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`neWord#`</span></span><span class="mpre"> 0##
               then 48# </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_64_14_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_14_64_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
               else
                case </span><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span><span class="mpre"> </span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 32# of
                 </span><a name="loc_69_18_69_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_18_69_19&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> -&gt;
                  if </span><a href="#loc_69_18_69_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_18_69_19&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`neWord#`</span></span><span class="mpre"> 0##
                   then 40# </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_69_18_69_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_18_69_19&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
                   else
#endif
                    case </span><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span><span class="mpre"> </span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 24# of
                     </span><a name="loc_75_22_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_22_75_23&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
                      if </span><a href="#loc_75_22_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_22_75_23&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`neWord#`</span></span><span class="mpre"> 0##
                       then 32# </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_75_22_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_22_75_23&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                       else
                        case </span><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span><span class="mpre"> </span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 16# of
                         </span><a name="loc_80_26_80_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_26_80_27&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt;
                          if </span><a href="#loc_80_26_80_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_26_80_27&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`neWord#`</span></span><span class="mpre"> 0##
                           then 24# </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_80_26_80_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_26_80_27&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
                           else
                            case </span><span class="hl_varref"><span class="mpre">uncheckedShiftRL#</span></span><span class="mpre"> </span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> 8# of
                             </span><a name="loc_85_30_85_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_30_85_31&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> -&gt;
                              if </span><a href="#loc_85_30_85_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_30_85_31&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`neWord#`</span></span><span class="mpre"> 0##
                               then 16# </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_85_30_85_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_30_85_31&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                               else 8# </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">zeros</span></span></a><span class="mpre"> </span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Lookup table</span></span><span class="mpre">
data </span><a name="loc_91_6_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_6_91_8&#39;)"><span class="hl_tycondecl"><span class="mpre">BA</span></span></a><span class="mpre"> = </span><a name="loc_91_11_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_13&#39;)"><span class="hl_condecl"><span class="mpre">BA</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteArray#</span></span><span class="mpre">

</span><a href="#loc_94_1_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_13&#39;)"><span class="mpre">leadingZeros</span></a><span class="mpre"> :: </span><a href="#loc_91_6_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_6_91_8&#39;)"><span class="hl_tyconref"><span class="mpre">BA</span></span></a><span class="mpre">
</span><a name="loc_94_1_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_13&#39;)"><span class="hl_vardecl"><span class="mpre">leadingZeros</span></span></a><span class="mpre"> =
    let </span><a name="loc_95_9_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_14&#39;)"><span class="hl_fundecl"><span class="mpre">mkArr</span></span></a><span class="mpre"> </span><a name="loc_95_15_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_15_95_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
          case </span><span class="hl_varref"><span class="mpre">newByteArray#</span></span><span class="mpre"> 256# </span><a href="#loc_95_15_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_15_95_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
            (# </span><a name="loc_97_16_97_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_16_97_18&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre">, </span><a name="loc_97_20_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_23&#39;)"><span class="hl_vardecl"><span class="mpre">mba</span></span></a><span class="mpre"> #) -&gt;
              case </span><span class="hl_varref"><span class="mpre">writeInt8Array#</span></span><span class="mpre"> </span><a href="#loc_97_20_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_23&#39;)"><span class="hl_varref"><span class="mpre">mba</span></span></a><span class="mpre"> 0# 9# </span><a href="#loc_97_16_97_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_16_97_18&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> of
                </span><a name="loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_vardecl"><span class="mpre">s2</span></span></a><span class="mpre"> -&gt;
                  let </span><a name="loc_100_23_100_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_23_100_28&#39;)"><span class="hl_fundecl"><span class="mpre">fillA</span></span></a><span class="mpre"> </span><a name="loc_100_29_100_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_29_100_32&#39;)"><span class="hl_vardecl"><span class="mpre">lim</span></span></a><span class="mpre"> </span><a name="loc_100_33_100_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_33_100_36&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> </span><a name="loc_100_37_100_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_37_100_40&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a name="loc_100_41_100_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_41_100_43&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> =
                        if </span><a href="#loc_100_37_100_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_37_100_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==#</span></span><span class="mpre"> 256#
                          then </span><a href="#loc_100_41_100_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_41_100_43&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">
                          else if </span><a href="#loc_100_37_100_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_37_100_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;#</span></span><span class="mpre"> </span><a href="#loc_100_29_100_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_29_100_32&#39;)"><span class="hl_varref"><span class="mpre">lim</span></span></a><span class="mpre">
                                then case </span><span class="hl_varref"><span class="mpre">writeInt8Array#</span></span><span class="mpre"> </span><a href="#loc_97_20_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_23&#39;)"><span class="hl_varref"><span class="mpre">mba</span></span></a><span class="mpre"> </span><a href="#loc_100_37_100_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_37_100_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_100_33_100_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_33_100_36&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> </span><a href="#loc_100_41_100_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_41_100_43&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> of
                                        </span><a name="loc_105_41_105_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_41_105_43&#39;)"><span class="hl_vardecl"><span class="mpre">nx</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_100_23_100_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_23_100_28&#39;)"><span class="hl_varref"><span class="mpre">fillA</span></span></a><span class="mpre"> </span><a href="#loc_100_29_100_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_29_100_32&#39;)"><span class="hl_varref"><span class="mpre">lim</span></span></a><span class="mpre"> </span><a href="#loc_100_33_100_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_33_100_36&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> (</span><a href="#loc_100_37_100_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_37_100_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+#</span></span><span class="mpre"> 1#) </span><a href="#loc_105_41_105_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_41_105_43&#39;)"><span class="hl_varref"><span class="mpre">nx</span></span></a><span class="mpre">
                                else </span><a href="#loc_100_23_100_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_23_100_28&#39;)"><span class="hl_varref"><span class="mpre">fillA</span></span></a><span class="mpre"> (2# </span><span class="hl_infix"><span class="mpre">*#</span></span><span class="mpre"> </span><a href="#loc_100_29_100_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_29_100_32&#39;)"><span class="hl_varref"><span class="mpre">lim</span></span></a><span class="mpre">) (</span><a href="#loc_100_33_100_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_33_100_36&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> 1#) </span><a href="#loc_100_37_100_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_37_100_40&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_100_41_100_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_41_100_43&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">
                  in case </span><a href="#loc_100_23_100_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_23_100_28&#39;)"><span class="hl_varref"><span class="mpre">fillA</span></span></a><span class="mpre"> 2# 8# 1# </span><a href="#loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="mpre"> of
                      </span><a name="loc_108_23_108_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_25&#39;)"><span class="hl_vardecl"><span class="mpre">s3</span></span></a><span class="mpre"> -&gt; case </span><span class="hl_varref"><span class="mpre">unsafeFreezeByteArray#</span></span><span class="mpre"> </span><a href="#loc_97_20_97_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_23&#39;)"><span class="hl_varref"><span class="mpre">mba</span></span></a><span class="mpre"> </span><a href="#loc_108_23_108_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_25&#39;)"><span class="hl_varref"><span class="mpre">s3</span></span></a><span class="mpre"> of
                              (# _, </span><a name="loc_109_37_109_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_37_109_39&#39;)"><span class="hl_vardecl"><span class="mpre">ba</span></span></a><span class="mpre"> #) -&gt; </span><a href="#loc_109_37_109_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_37_109_39&#39;)"><span class="hl_varref"><span class="mpre">ba</span></span></a><span class="mpre">
    in case </span><a href="#loc_95_9_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_14&#39;)"><span class="hl_varref"><span class="mpre">mkArr</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">realWorld#</span></span><span class="mpre"> of
        </span><a name="loc_111_9_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_91_11_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_13&#39;)"><span class="hl_conref"><span class="mpre">BA</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | Only defined for positive inputs!</span></span><span class="mpre">
</span><a href="#loc_116_1_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_14&#39;)"><span class="mpre">integerLog10&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_116_1_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_14&#39;)"><span class="hl_fundecl"><span class="mpre">integerLog10&#39;</span></span></a><span class="mpre"> </span><a name="loc_116_15_116_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_15_116_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
  | </span><a href="#loc_116_15_116_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_15_116_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">      = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  | </span><a href="#loc_116_15_116_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_15_116_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">     = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   = </span><a href="#loc_126_7_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_7_126_9&#39;)"><span class="hl_varref"><span class="mpre">ex</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_116_1_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_14&#39;)"><span class="hl_varref"><span class="mpre">integerLog10&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_116_15_116_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_15_116_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><a href="#loc_142_1_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_13&#39;)"><span class="hl_varref"><span class="mpre">integerPower</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_126_7_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_7_126_9&#39;)"><span class="hl_varref"><span class="mpre">ex</span></span></a><span class="mpre">)
    where
      </span><a name="loc_121_7_121_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_9&#39;)"><span class="hl_vardecl"><span class="mpre">ln</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> (</span><a href="#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="hl_varref"><span class="mpre">integerLog2#</span></span></a><span class="mpre"> </span><a href="#loc_116_15_116_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_15_116_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
      </span><span class="hl_comment"><span class="mpre">-- u/v is a good approximation of log 2/log 10</span></span><span class="mpre">
      </span><a name="loc_123_7_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_8&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">  = </span><span class="hl_num"><span class="mpre">1936274</span></span><span class="mpre">
      </span><a name="loc_124_7_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_8&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">  = </span><span class="hl_num"><span class="mpre">6432163</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- so ex is a good approximation to integerLogBase 10 n</span></span><span class="mpre">
      </span><a name="loc_126_7_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_7_126_9&#39;)"><span class="hl_vardecl"><span class="mpre">ex</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> ((</span><a href="#loc_123_7_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_8&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_121_7_121_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_9&#39;)"><span class="hl_varref"><span class="mpre">ln</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><a href="#loc_124_7_124_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_8&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Power of an &#39;Integer&#39; by the left-to-right repeated squaring algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This needs two multiplications in each step while the right-to-left</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   algorithm needs only one multiplication for 0-bits, but here the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   two factors always have approximately the same size, which on average</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   gains a bit when the result is large.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   For small results, it is unlikely to be any faster than &#39;(^)&#39;, quite</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   possibly slower (though the difference shouldn&#39;t be large), and for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   exponents with few bits set, the same holds. But for exponents with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   many bits set, the speedup can be significant.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   /Warning:/ No check for the negativity of the exponent is performed,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   a negative exponent is interpreted as a large positive exponent.</span></span><span class="mpre">
</span><a href="#loc_142_1_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_13&#39;)"><span class="mpre">integerPower</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_142_1_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_13&#39;)"><span class="hl_fundecl"><span class="mpre">integerPower</span></span></a><span class="mpre"> </span><a name="loc_142_14_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_14_142_15&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a name="loc_142_20_142_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_22&#39;)"><span class="hl_vardecl"><span class="mpre">e#</span></span></a><span class="mpre">) = </span><a href="#loc_145_1_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_6&#39;)"><span class="hl_varref"><span class="mpre">power</span></span></a><span class="mpre"> </span><a href="#loc_142_14_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_14_142_15&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">int2Word#</span></span><span class="mpre"> </span><a href="#loc_142_20_142_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_22&#39;)"><span class="hl_varref"><span class="mpre">e#</span></span></a><span class="mpre">)

</span><a href="#loc_145_1_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_6&#39;)"><span class="mpre">power</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word#</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_145_1_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_6&#39;)"><span class="hl_fundecl"><span class="mpre">power</span></span></a><span class="mpre"> </span><a name="loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_145_9_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_11&#39;)"><span class="hl_vardecl"><span class="mpre">w#</span></span></a><span class="mpre">
  | </span><a href="#loc_161_1_161_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_8&#39;)"><span class="hl_varref"><span class="mpre">isTrue#</span></span></a><span class="mpre"> (</span><a href="#loc_145_9_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_11&#39;)"><span class="hl_varref"><span class="mpre">w#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`eqWord#`</span></span><span class="mpre"> 0##) = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
  | </span><a href="#loc_161_1_161_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_8&#39;)"><span class="hl_varref"><span class="mpre">isTrue#</span></span></a><span class="mpre"> (</span><a href="#loc_145_9_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_11&#39;)"><span class="hl_varref"><span class="mpre">w#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`eqWord#`</span></span><span class="mpre"> 1##) = </span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           = </span><a href="#loc_150_7_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_7_150_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_48_1_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_10&#39;)"><span class="hl_varref"><span class="mpre">wordLog2#</span></span></a><span class="mpre"> </span><a href="#loc_145_9_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_11&#39;)"><span class="hl_varref"><span class="mpre">w#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> 1#) </span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
    where
      </span><a name="loc_150_7_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_7_150_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> 0# </span><a name="loc_150_13_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_150_15_150_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_15_150_16&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = if </span><a href="#loc_161_1_161_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_8&#39;)"><span class="hl_varref"><span class="mpre">isTrue#</span></span></a><span class="mpre"> ((</span><a href="#loc_145_9_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_11&#39;)"><span class="hl_varref"><span class="mpre">w#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`and#`</span></span><span class="mpre"> 1##) </span><span class="hl_infix"><span class="mpre">`eqWord#`</span></span><span class="mpre"> 0##) then </span><a href="#loc_150_13_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_150_13_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> else (</span><a href="#loc_150_13_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_150_15_150_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_15_150_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)
      </span><a href="#loc_150_7_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_7_150_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_151_10_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_10_151_12&#39;)"><span class="hl_vardecl"><span class="mpre">i#</span></span></a><span class="mpre"> </span><a name="loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">
        | </span><a href="#loc_145_9_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_11&#39;)"><span class="hl_varref"><span class="mpre">w#</span></span></a><span class="mpre"> </span><a href="#loc_157_1_157_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_8&#39;)"><span class="hl_infix"><span class="mpre">`hasBit#`</span></span></a><span class="mpre"> </span><a href="#loc_151_10_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_10_151_12&#39;)"><span class="hl_varref"><span class="mpre">i#</span></span></a><span class="mpre">   = </span><a href="#loc_150_7_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_7_150_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_151_10_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_10_151_12&#39;)"><span class="hl_varref"><span class="mpre">i#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> 1#) (</span><a href="#loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) (</span><a href="#loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = </span><a href="#loc_150_7_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_7_150_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_151_10_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_10_151_12&#39;)"><span class="hl_varref"><span class="mpre">i#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> 1#) (</span><a href="#loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) (</span><a href="#loc_151_13_151_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_13_151_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | A raw version of testBit for &#39;Word#&#39;.</span></span><span class="mpre">
</span><a href="#loc_157_1_157_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_8&#39;)"><span class="mpre">hasBit#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word#</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int#</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_157_1_157_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_8&#39;)"><span class="hl_fundecl"><span class="mpre">hasBit#</span></span></a><span class="mpre"> </span><a name="loc_157_9_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_11&#39;)"><span class="hl_vardecl"><span class="mpre">w#</span></span></a><span class="mpre"> </span><a name="loc_157_12_157_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_12_157_14&#39;)"><span class="hl_vardecl"><span class="mpre">i#</span></span></a><span class="mpre"> = </span><a href="#loc_161_1_161_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_8&#39;)"><span class="hl_varref"><span class="mpre">isTrue#</span></span></a><span class="mpre"> (((</span><a href="#loc_157_9_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_11&#39;)"><span class="hl_varref"><span class="mpre">w#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`uncheckedShiftRL#`</span></span><span class="mpre"> </span><a href="#loc_157_12_157_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_12_157_14&#39;)"><span class="hl_varref"><span class="mpre">i#</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`and#`</span></span><span class="mpre"> 1##) </span><span class="hl_infix"><span class="mpre">`neWord#`</span></span><span class="mpre"> 0##)

#if __GLASGOW_HASKELL__ &lt; 707
</span><a href="#loc_161_1_161_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_8&#39;)"><span class="mpre">isTrue#</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_161_1_161_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_8&#39;)"><span class="hl_vardecl"><span class="mpre">isTrue#</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
#endif
</span></div></body></html>