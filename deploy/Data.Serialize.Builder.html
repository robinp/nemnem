<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP       #-}
{-# LANGUAGE MagicHash #-}
</span><span class="hl_comment"><span class="mpre">-- for unboxed shifts</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Serialize.Builder</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : Lennart Kolmodin, Ross Paterson, Galois Inc. 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Trevor Elliott &lt;trevor@galois.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Efficient construction of lazy bytestrings.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

#if defined(__GLASGOW_HASKELL__) &amp;&amp; !defined(__HADDOCK__)
#include &quot;MachDeps.h&quot;
#endif

module Data.Serialize.Builder (

    </span><span class="hl_comment"><span class="mpre">-- * The Builder type</span></span><span class="mpre">
      Builder
    , toByteString
    , toLazyByteString

    </span><span class="hl_comment"><span class="mpre">-- * Constructing Builders</span></span><span class="mpre">
    , empty
    , singleton
    , append
    , fromByteString        </span><span class="hl_comment"><span class="mpre">-- :: S.ByteString -&gt; Builder</span></span><span class="mpre">
    , fromLazyByteString    </span><span class="hl_comment"><span class="mpre">-- :: L.ByteString -&gt; Builder</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- * Flushing the buffer state</span></span><span class="mpre">
    , flush

    </span><span class="hl_comment"><span class="mpre">-- * Derived Builders</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** Big-endian writes</span></span><span class="mpre">
    , putWord16be           </span><span class="hl_comment"><span class="mpre">-- :: Word16 -&gt; Builder</span></span><span class="mpre">
    , putWord32be           </span><span class="hl_comment"><span class="mpre">-- :: Word32 -&gt; Builder</span></span><span class="mpre">
    , putWord64be           </span><span class="hl_comment"><span class="mpre">-- :: Word64 -&gt; Builder</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- ** Little-endian writes</span></span><span class="mpre">
    , putWord16le           </span><span class="hl_comment"><span class="mpre">-- :: Word16 -&gt; Builder</span></span><span class="mpre">
    , putWord32le           </span><span class="hl_comment"><span class="mpre">-- :: Word32 -&gt; Builder</span></span><span class="mpre">
    , putWord64le           </span><span class="hl_comment"><span class="mpre">-- :: Word64 -&gt; Builder</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- ** Host-endian, unaligned writes</span></span><span class="mpre">
    , putWordhost           </span><span class="hl_comment"><span class="mpre">-- :: Word -&gt; Builder</span></span><span class="mpre">
    , putWord16host         </span><span class="hl_comment"><span class="mpre">-- :: Word16 -&gt; Builder</span></span><span class="mpre">
    , putWord32host         </span><span class="hl_comment"><span class="mpre">-- :: Word32 -&gt; Builder</span></span><span class="mpre">
    , putWord64host         </span><span class="hl_comment"><span class="mpre">-- :: Word64 -&gt; Builder</span></span><span class="mpre">

  ) where

import Data.Monoid
import Data.Word
import Foreign.ForeignPtr
import Foreign.Ptr (Ptr,plusPtr)
import Foreign.Storable
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 18, srcSpanEndLine = 65, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">          as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 18, srcSpanEndLine = 66, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre">     as L
import qualified Data.ByteString.Internal as S

#if defined(__GLASGOW_HASKELL__) &amp;&amp; !defined(__HADDOCK__)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 8, srcSpanEndLine = 70, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 8, srcSpanEndLine = 71, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Word&quot;"><span class="mpre">GHC.Word</span></span><span class="mpre"> (Word32(..),Word16(..),Word64(..))

#if WORD_SIZE_IN_BITS &lt; 64 &amp;&amp; __GLASGOW_HASKELL__ &gt;= 608
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 8, srcSpanEndLine = 74, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Word&quot;"><span class="mpre">GHC.Word</span></span><span class="mpre"> (uncheckedShiftRL64#)
#endif
#else
import Data.Word
#endif

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A &#39;Builder&#39; is an efficient way to build lazy &#39;L.ByteString&#39;s.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- There are several functions for constructing &#39;Builder&#39;s, but only one</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to inspect them: to extract any data, you have to turn them into lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;L.ByteString&#39;s using &#39;toLazyByteString&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Internally, a &#39;Builder&#39; constructs a lazy &#39;L.Bytestring&#39; by filling byte</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- arrays piece by piece.  As each buffer is filled, it is \&#39;popped\&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- off, to become a new chunk of the resulting lazy &#39;L.ByteString&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- All this is hidden from the user of the &#39;Builder&#39;.</span></span><span class="mpre">

newtype </span><a name="loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Builder</span></span></a><span class="mpre"> = </span><a name="loc_92_19_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_26&#39;)"><span class="hl_condecl"><span class="mpre">Builder</span></span></a><span class="mpre"> {
        </span><span class="hl_comment"><span class="mpre">-- Invariant (from Data.ByteString.Lazy):</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">--      The lists include no null ByteStrings.</span></span><span class="mpre">
        </span><a name="loc_95_9_95_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_19&#39;)"><span class="hl_fielddecl"><span class="mpre">runBuilder</span></span></a><span class="mpre"> :: (</span><a href="#loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; [</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">]) -&gt; </span><a href="#loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; [</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">]
    }

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> where
    </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre">  = </span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_vardecl"><span class="mpre">mappend</span></span></a><span class="mpre"> = </span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="hl_varref"><span class="mpre">append</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)./ The empty Builder, satisfying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * @&#39;toLazyByteString&#39; &#39;empty&#39; = &#39;L.empty&#39;@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="mpre">empty</span></a><span class="mpre"> :: </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><a href="#loc_92_19_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="mpre">empty</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)./ A Builder taking a single byte, satisfying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * @&#39;toLazyByteString&#39; (&#39;singleton&#39; b) = &#39;L.singleton&#39; b@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_119_1_119_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_10&#39;)"><span class="mpre">singleton</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_119_1_119_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_10&#39;)"><span class="hl_vardecl"><span class="mpre">singleton</span></span></a><span class="mpre"> = </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_varref"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_119_1_119_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_10&#39;)"><span class="mpre">singleton</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)./ The concatenation of two Builders, an associative operation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with identity &#39;empty&#39;, satisfying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * @&#39;toLazyByteString&#39; (&#39;append&#39; x y) = &#39;L.append&#39; (&#39;toLazyByteString&#39; x) (&#39;toLazyByteString&#39; y)@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="mpre">append</span></a><span class="mpre"> :: </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="hl_fundecl"><span class="mpre">append</span></span></a><span class="mpre"> (</span><a href="#loc_92_19_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><a name="loc_130_17_130_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) (</span><a href="#loc_92_19_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><a name="loc_130_29_130_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_30&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) = </span><a href="#loc_92_19_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> (</span><a href="#loc_130_17_130_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_130_29_130_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_30&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="mpre">append</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)./ A Builder taking a &#39;S.ByteString&#39;, satisfying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * @&#39;toLazyByteString&#39; (&#39;fromByteString&#39; bs) = &#39;L.fromChunks&#39; [bs]@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_138_1_138_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_15&#39;)"><span class="mpre">fromByteString</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_138_1_138_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_15&#39;)"><span class="hl_fundecl"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a name="loc_138_16_138_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_16_138_18&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_138_16_138_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_16_138_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre"> </span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="hl_infix"><span class="mpre">`append`</span></span></a><span class="mpre"> </span><a href="#loc_209_1_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_11&#39;)"><span class="hl_varref"><span class="mpre">mapBuilder</span></span></a><span class="mpre"> (</span><a href="#loc_138_16_138_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_16_138_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_138_1_138_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_15&#39;)"><span class="mpre">fromByteString</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)./ A Builder taking a lazy &#39;L.ByteString&#39;, satisfying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * @&#39;toLazyByteString&#39; (&#39;fromLazyByteString&#39; bs) = bs@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_148_1_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_19&#39;)"><span class="mpre">fromLazyByteString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_148_1_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_19&#39;)"><span class="hl_fundecl"><span class="mpre">fromLazyByteString</span></span></a><span class="mpre"> </span><a name="loc_148_20_148_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_20_148_23&#39;)"><span class="hl_vardecl"><span class="mpre">bss</span></span></a><span class="mpre"> = </span><a href="#loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre"> </span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="hl_infix"><span class="mpre">`append`</span></span></a><span class="mpre"> </span><a href="#loc_209_1_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_11&#39;)"><span class="hl_varref"><span class="mpre">mapBuilder</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_148_20_148_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_20_148_23&#39;)"><span class="hl_varref"><span class="mpre">bss</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_148_1_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_19&#39;)"><span class="mpre">fromLazyByteString</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Our internal buffer type</span></span><span class="mpre">
data </span><a name="loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Buffer</span></span></a><span class="mpre"> = </span><a name="loc_154_15_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_21&#39;)"><span class="hl_condecl"><span class="mpre">Buffer</span></span></a><span class="mpre"> {-# UNPACK #-} !(</span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
                     {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- offset</span></span><span class="mpre">
                     {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- used bytes</span></span><span class="mpre">
                     {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- length left</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_162_1_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_13&#39;)"><span class="mpre">toByteString</span></a><span class="mpre"> :: </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">
</span><a name="loc_162_1_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_13&#39;)"><span class="hl_fundecl"><span class="mpre">toByteString</span></span></a><span class="mpre"> </span><a name="loc_162_14_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_14_162_15&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><a name="loc_163_3_163_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_3_163_6&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_233_1_233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_10&#39;)"><span class="hl_varref"><span class="mpre">newBuffer</span></span></a><span class="mpre"> </span><a href="#loc_189_1_189_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_12&#39;)"><span class="hl_varref"><span class="mpre">defaultSize</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_95_9_95_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_19&#39;)"><span class="hl_varref"><span class="mpre">runBuilder</span></span></a><span class="mpre"> (</span><a href="#loc_162_14_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_14_162_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="hl_infix"><span class="mpre">`append`</span></span></a><span class="mpre"> </span><a href="#loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> []) </span><a href="#loc_163_3_163_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_3_163_6&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | /O(n)./ Extract a lazy &#39;L.ByteString&#39; from a &#39;Builder&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The construction work takes place if and when the relevant part of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the lazy &#39;L.ByteString&#39; is demanded.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_171_1_171_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_17&#39;)"><span class="mpre">toLazyByteString</span></a><span class="mpre"> :: </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_171_1_171_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_17&#39;)"><span class="hl_fundecl"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><a name="loc_171_18_171_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_18_171_19&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_172_5_172_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_8&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_233_1_233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_10&#39;)"><span class="hl_varref"><span class="mpre">newBuffer</span></span></a><span class="mpre"> </span><a href="#loc_189_1_189_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_12&#39;)"><span class="hl_varref"><span class="mpre">defaultSize</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_95_9_95_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_19&#39;)"><span class="hl_varref"><span class="mpre">runBuilder</span></span></a><span class="mpre"> (</span><a href="#loc_171_18_171_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_18_171_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="hl_infix"><span class="mpre">`append`</span></span></a><span class="mpre"> </span><a href="#loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> []) </span><a href="#loc_172_5_172_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_8&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | /O(1)./ Pop the &#39;S.ByteString&#39; we have constructed so far, if any,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- yielding a new chunk in the result lazy &#39;L.ByteString&#39;.</span></span><span class="mpre">
</span><a href="#loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="mpre">flush</span></a><span class="mpre"> :: </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="hl_vardecl"><span class="mpre">flush</span></span></a><span class="mpre"> = </span><a href="#loc_92_19_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_178_21_178_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_21_178_22&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_178_23_178_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_23_178_26&#39;)"><span class="hl_specname"><span class="mpre">buf</span></span></a><span class="mpre">@(</span><a href="#loc_154_15_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_21&#39;)"><span class="hl_conref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><a name="loc_178_35_178_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_35_178_36&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_178_37_178_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_37_178_38&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_178_39_178_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_39_178_40&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_178_41_178_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_41_178_42&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) -&gt;
    if </span><a href="#loc_178_39_178_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_39_178_40&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      then </span><a href="#loc_178_21_178_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_21_178_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_178_23_178_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_23_178_26&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">
      else </span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a href="#loc_178_35_178_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_35_178_36&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_178_37_178_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_37_178_38&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_178_39_178_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_39_178_40&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_178_21_178_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_21_178_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_154_15_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_21&#39;)"><span class="hl_conref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><a href="#loc_178_35_178_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_35_178_36&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_178_37_178_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_37_178_38&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_178_39_178_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_39_178_40&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_178_41_178_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_41_178_42&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- copied from Data.ByteString.Lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_189_1_189_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_12&#39;)"><span class="mpre">defaultSize</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_189_1_189_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_12&#39;)"><span class="hl_vardecl"><span class="mpre">defaultSize</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_190_11_190_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_191_11_191_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_11_191_19&#39;)"><span class="hl_varref"><span class="mpre">overhead</span></span></a><span class="mpre">
    where </span><a name="loc_190_11_190_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1024</span></span><span class="mpre">
          </span><a name="loc_191_11_191_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_11_191_19&#39;)"><span class="hl_vardecl"><span class="mpre">overhead</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Sequence an IO operation on the buffer</span></span><span class="mpre">
</span><a href="#loc_197_1_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_13&#39;)"><span class="mpre">unsafeLiftIO</span></a><span class="mpre"> :: (</span><a href="#loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_197_1_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_13&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeLiftIO</span></span></a><span class="mpre"> </span><a name="loc_197_14_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_14_197_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =  </span><a href="#loc_92_19_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_197_31_197_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_31_197_32&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_197_33_197_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_33_197_36&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_592_1_592_16&#39;)"><span class="hl_varref"><span class="mpre">S.inlinePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_198_5_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_9&#39;)"><span class="hl_vardecl"><span class="mpre">buf&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_197_14_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_14_197_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_197_33_197_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_33_197_36&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_197_31_197_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_31_197_32&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_198_5_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_9&#39;)"><span class="hl_varref"><span class="mpre">buf&#39;</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_197_1_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_13&#39;)"><span class="mpre">unsafeLiftIO</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the size of the buffer</span></span><span class="mpre">
</span><a href="#loc_204_1_204_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_9&#39;)"><span class="mpre">withSize</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_204_1_204_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_9&#39;)"><span class="hl_fundecl"><span class="mpre">withSize</span></span></a><span class="mpre"> </span><a name="loc_204_10_204_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_10_204_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_92_19_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_204_26_204_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_26_204_27&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_204_28_204_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_28_204_31&#39;)"><span class="hl_specname"><span class="mpre">buf</span></span></a><span class="mpre">@(</span><a href="#loc_154_15_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_21&#39;)"><span class="hl_conref"><span class="mpre">Buffer</span></span></a><span class="mpre"> _ _ _ </span><a name="loc_204_46_204_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_46_204_47&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) -&gt;
    </span><a href="#loc_95_9_95_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_19&#39;)"><span class="hl_varref"><span class="mpre">runBuilder</span></span></a><span class="mpre"> (</span><a href="#loc_204_10_204_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_10_204_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_204_46_204_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_46_204_47&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_204_26_204_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_26_204_27&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_204_28_204_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_28_204_31&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Map the resulting list of bytestrings.</span></span><span class="mpre">
</span><a href="#loc_209_1_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_11&#39;)"><span class="mpre">mapBuilder</span></a><span class="mpre"> :: ([</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">] -&gt; [</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">]) -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_209_1_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_11&#39;)"><span class="hl_fundecl"><span class="mpre">mapBuilder</span></span></a><span class="mpre"> </span><a name="loc_209_12_209_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_12_209_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_92_19_92_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> (</span><a href="#loc_209_12_209_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_12_209_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Ensure that there are at least @n@ many bytes available.</span></span><span class="mpre">
</span><a href="#loc_215_1_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_11&#39;)"><span class="mpre">ensureFree</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_215_1_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_11&#39;)"><span class="hl_fundecl"><span class="mpre">ensureFree</span></span></a><span class="mpre"> </span><a name="loc_215_12_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_12_215_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_215_12_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_12_215_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="#loc_204_1_204_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_9&#39;)"><span class="hl_varref"><span class="mpre">withSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_215_37_215_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_37_215_38&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> -&gt;
    if </span><a href="#loc_215_12_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_12_215_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_215_37_215_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_37_215_38&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> then </span><a href="#loc_111_1_111_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre"> else
        </span><a href="#loc_178_1_178_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre"> </span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="hl_infix"><span class="mpre">`append`</span></span></a><span class="mpre"> </span><a href="#loc_197_1_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeLiftIO</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><a href="#loc_233_1_233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_10&#39;)"><span class="hl_varref"><span class="mpre">newBuffer</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_215_12_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_12_215_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_189_1_189_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_12&#39;)"><span class="hl_varref"><span class="mpre">defaultSize</span></span></a><span class="mpre">)))
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_215_1_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_11&#39;)"><span class="mpre">ensureFree</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Ensure that @n@ many bytes are available, and then use @f@ to write some</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bytes into the memory.</span></span><span class="mpre">
</span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="mpre">writeN</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_fundecl"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><a name="loc_223_8_223_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_8_223_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_223_10_223_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_10_223_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_215_1_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_11&#39;)"><span class="hl_varref"><span class="mpre">ensureFree</span></span></a><span class="mpre"> </span><a href="#loc_223_8_223_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_8_223_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="hl_infix"><span class="mpre">`append`</span></span></a><span class="mpre"> </span><a href="#loc_197_1_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeLiftIO</span></span></a><span class="mpre"> (</span><a href="#loc_227_1_227_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_13&#39;)"><span class="hl_varref"><span class="mpre">writeNBuffer</span></span></a><span class="mpre"> </span><a href="#loc_223_8_223_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_8_223_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_223_10_223_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_10_223_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="mpre">writeN</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_227_1_227_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_13&#39;)"><span class="mpre">writeNBuffer</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><a href="#loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre">
</span><a name="loc_227_1_227_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_13&#39;)"><span class="hl_fundecl"><span class="mpre">writeNBuffer</span></span></a><span class="mpre"> </span><a name="loc_227_14_227_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_14_227_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_227_16_227_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_16_227_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_154_15_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_21&#39;)"><span class="hl_conref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><a name="loc_227_26_227_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_26_227_28&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_227_29_227_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_29_227_30&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_227_31_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_31_227_32&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_227_33_227_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_33_227_34&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = do
    </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_227_26_227_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_26_227_28&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> (\</span><a name="loc_228_25_228_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_25_228_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_227_16_227_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_16_227_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_228_25_228_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_25_228_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_227_29_227_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_29_227_30&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_227_31_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_31_227_32&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)))
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_154_15_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_21&#39;)"><span class="hl_conref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><a href="#loc_227_26_227_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_26_227_28&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_227_29_227_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_29_227_30&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> (</span><a href="#loc_227_31_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_31_227_32&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_227_14_227_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_14_227_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><a href="#loc_227_33_227_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_33_227_34&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_227_14_227_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_14_227_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">))
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_227_1_227_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_13&#39;)"><span class="mpre">writeNBuffer</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_233_1_233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_10&#39;)"><span class="mpre">newBuffer</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre">
</span><a name="loc_233_1_233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_10&#39;)"><span class="hl_fundecl"><span class="mpre">newBuffer</span></span></a><span class="mpre"> </span><a name="loc_233_11_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_11_233_15&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> = do
    </span><a name="loc_234_5_234_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_7&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">S.mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_233_11_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_11_233_15&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_154_15_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_21&#39;)"><span class="hl_conref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><a href="#loc_234_5_234_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_233_11_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_11_233_15&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_233_1_233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_10&#39;)"><span class="mpre">newBuffer</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Aligned, host order writes of storable values</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Ensure that @n@ many bytes are available, and then use @f@ to write some</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- storable values into the memory.</span></span><span class="mpre">
</span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="mpre">writeNbytes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 243, srcSpanStartColumn = 16, srcSpanEndLine = 243, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 243, srcSpanStartColumn = 27, srcSpanEndLine = 243, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_fundecl"><span class="mpre">writeNbytes</span></span></a><span class="mpre"> </span><a name="loc_244_13_244_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_13_244_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_244_15_244_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_15_244_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_215_1_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_11&#39;)"><span class="hl_varref"><span class="mpre">ensureFree</span></span></a><span class="mpre"> </span><a href="#loc_244_13_244_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_13_244_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_130_1_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_7&#39;)"><span class="hl_infix"><span class="mpre">`append`</span></span></a><span class="mpre"> </span><a href="#loc_197_1_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeLiftIO</span></span></a><span class="mpre"> (</span><a href="#loc_248_1_248_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_18&#39;)"><span class="hl_varref"><span class="mpre">writeNBufferBytes</span></span></a><span class="mpre"> </span><a href="#loc_244_13_244_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_13_244_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_244_15_244_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_15_244_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="mpre">writeNbytes</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_248_1_248_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_18&#39;)"><span class="mpre">writeNBufferBytes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 247, srcSpanStartColumn = 22, srcSpanEndLine = 247, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 247, srcSpanStartColumn = 33, srcSpanEndLine = 247, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><a href="#loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_154_6_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_6_154_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre">
</span><a name="loc_248_1_248_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_18&#39;)"><span class="hl_fundecl"><span class="mpre">writeNBufferBytes</span></span></a><span class="mpre"> </span><a name="loc_248_19_248_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_19_248_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_248_21_248_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_21_248_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_154_15_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_21&#39;)"><span class="hl_conref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><a name="loc_248_31_248_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_31_248_33&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_248_34_248_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_34_248_35&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_248_36_248_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_36_248_37&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_248_38_248_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_38_248_39&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = do
    </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_248_31_248_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_31_248_33&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> (\</span><a name="loc_249_25_249_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_25_249_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_248_21_248_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_21_248_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_249_25_249_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_25_249_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_248_34_248_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_34_248_35&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_248_36_248_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_36_248_37&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)))
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_154_15_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_15_154_21&#39;)"><span class="hl_conref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><a href="#loc_248_31_248_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_31_248_33&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_248_34_248_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_34_248_35&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> (</span><a href="#loc_248_36_248_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_36_248_37&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_248_19_248_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_19_248_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><a href="#loc_248_38_248_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_38_248_39&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_248_19_248_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_19_248_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">))
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_248_1_248_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_18&#39;)"><span class="mpre">writeNBufferBytes</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We rely on the fromIntegral to do the right masking for us.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The inlining here is critical, and can be worth 4x performance</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a Word16 in big endian format</span></span><span class="mpre">
</span><a href="#loc_262_1_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_12&#39;)"><span class="mpre">putWord16be</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_262_1_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_12&#39;)"><span class="hl_fundecl"><span class="mpre">putWord16be</span></span></a><span class="mpre"> </span><a name="loc_262_13_262_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_13_262_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_varref"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_262_29_262_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_29_262_30&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_262_29_262_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_29_262_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">               (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_409_1_409_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w16</span></span></a><span class="mpre"> </span><a href="#loc_262_13_262_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_13_262_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_262_29_262_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_29_262_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_262_13_262_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_13_262_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)              :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_262_1_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_12&#39;)"><span class="mpre">putWord16be</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a Word16 in little endian format</span></span><span class="mpre">
</span><a href="#loc_269_1_269_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_1_269_12&#39;)"><span class="mpre">putWord16le</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_269_1_269_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_1_269_12&#39;)"><span class="hl_fundecl"><span class="mpre">putWord16le</span></span></a><span class="mpre"> </span><a name="loc_269_13_269_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_13_269_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_varref"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_269_29_269_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_29_269_30&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_269_29_269_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_29_269_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">               (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_269_13_269_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_13_269_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)              :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_269_29_269_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_29_269_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_409_1_409_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w16</span></span></a><span class="mpre"> </span><a href="#loc_269_13_269_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_13_269_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_269_1_269_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_1_269_12&#39;)"><span class="mpre">putWord16le</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- putWord16le w16 = writeN 2 (\p -&gt; poke (castPtr p) w16)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a Word32 in big endian format</span></span><span class="mpre">
</span><a href="#loc_278_1_278_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_12&#39;)"><span class="mpre">putWord32be</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_278_1_278_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_12&#39;)"><span class="hl_fundecl"><span class="mpre">putWord32be</span></span></a><span class="mpre"> </span><a name="loc_278_13_278_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_varref"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_278_29_278_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_29_278_30&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_278_29_278_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_29_278_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">               (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_278_13_278_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_278_29_278_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_29_278_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_278_13_278_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_278_29_278_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_29_278_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_278_13_278_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_278_29_278_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_29_278_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_278_13_278_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)               :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_278_1_278_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_12&#39;)"><span class="mpre">putWord32be</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a data type to tag Put/Check. writes construct these which are then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- inlined and flattened. matching Checks will be more robust with rules.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a Word32 in little endian format</span></span><span class="mpre">
</span><a href="#loc_292_1_292_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_12&#39;)"><span class="mpre">putWord32le</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_292_1_292_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_12&#39;)"><span class="hl_fundecl"><span class="mpre">putWord32le</span></span></a><span class="mpre"> </span><a name="loc_292_13_292_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_13_292_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_varref"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_292_29_292_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_29_292_30&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_292_29_292_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_29_292_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">               (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_292_13_292_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_13_292_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)               :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_292_29_292_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_29_292_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_292_13_292_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_13_292_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_292_29_292_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_29_292_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_292_13_292_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_13_292_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_292_29_292_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_29_292_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_292_13_292_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_13_292_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_292_1_292_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_12&#39;)"><span class="mpre">putWord32le</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- on a little endian machine:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- putWord32le w32 = writeN 4 (\p -&gt; poke (castPtr p) w32)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a Word64 in big endian format</span></span><span class="mpre">
</span><a href="#loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="mpre">putWord64be</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
#if WORD_SIZE_IN_BITS &lt; 64
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- To avoid expensive 64 bit shifts on 32 bit machines, we cast to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Word32, and write that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a name="loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="hl_fundecl"><span class="mpre">putWord64be</span></span></a><span class="mpre"> </span><a name="loc_309_13_309_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_13_309_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> =
    let </span><a name="loc_310_9_310_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_9_310_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_309_13_309_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_13_309_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
        </span><a name="loc_311_9_311_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_9_311_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_309_13_309_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_13_309_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">                 :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
    in </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_varref"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_312_20_312_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_20_312_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_312_20_312_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_20_312_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">               (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_310_9_310_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_9_310_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_312_20_312_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_20_312_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_310_9_310_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_9_310_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_312_20_312_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_20_312_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_310_9_310_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_9_310_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_312_20_312_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_20_312_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_310_9_310_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_9_310_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)               :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_312_20_312_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_20_312_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_311_9_311_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_9_311_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_312_20_312_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_20_312_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_311_9_311_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_9_311_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_312_20_312_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_20_312_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_311_9_311_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_9_311_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_312_20_312_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_20_312_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_311_9_311_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_9_311_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)               :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
#else
</span><a href="#loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="hl_fundecl"><span class="mpre">putWord64be</span></span></a><span class="mpre"> </span><a name="loc_322_13_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_varref"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_322_29_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_29_322_30&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_322_29_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_29_322_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">               (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_322_13_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_322_29_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_29_322_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_322_13_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_322_29_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_29_322_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_322_13_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_322_29_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_29_322_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_322_13_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_322_29_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_29_322_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_322_13_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_322_29_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_29_322_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_322_13_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_322_29_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_29_322_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_322_13_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_322_29_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_29_322_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_322_13_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)               :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
#endif
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="mpre">putWord64be</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a Word64 in little endian format</span></span><span class="mpre">
</span><a href="#loc_338_1_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_12&#39;)"><span class="mpre">putWord64le</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">

#if WORD_SIZE_IN_BITS &lt; 64
</span><a name="loc_338_1_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_12&#39;)"><span class="hl_fundecl"><span class="mpre">putWord64le</span></span></a><span class="mpre"> </span><a name="loc_338_13_338_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_13_338_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> =
    let </span><a name="loc_339_9_339_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_9_339_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_338_13_338_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_13_338_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
        </span><a name="loc_340_9_340_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_9_340_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_338_13_338_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_13_338_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">                 :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
    in </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_varref"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)             (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_340_9_340_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_9_340_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)               :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_340_9_340_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_9_340_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_340_9_340_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_9_340_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_340_9_340_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_9_340_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_339_9_339_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_9_339_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)               :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_339_9_339_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_9_339_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_339_9_339_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_9_339_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_341_20_341_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_20_341_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> </span><a href="#loc_339_9_339_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_9_339_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
#else
</span><a href="#loc_338_1_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_12&#39;)"><span class="hl_fundecl"><span class="mpre">putWord64le</span></span></a><span class="mpre"> </span><a name="loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_varref"><span class="mpre">writeN</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_351_29_351_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_29_351_30&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_351_29_351_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_29_351_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">               (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)               :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_351_29_351_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_29_351_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_351_29_351_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_29_351_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_351_29_351_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_29_351_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_351_29_351_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_29_351_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_351_29_351_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_29_351_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_351_29_351_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_29_351_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_351_29_351_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_29_351_30&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_varref"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> </span><a href="#loc_351_13_351_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_13_351_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
#endif
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_338_1_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_12&#39;)"><span class="mpre">putWord64le</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- on a little endian machine:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- putWord64le w64 = writeN 8 (\p -&gt; poke (castPtr p) w64)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unaligned, word size ops</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)./ A Builder taking a single native machine word. The word is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- written in host order, host endian form, for the machine you&#39;re on.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On a 64 bit machine the Word is an 8 byte value, on a 32 bit machine,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 4 bytes. Values written this way are not portable to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- different endian or word sized machines, without conversion.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_376_1_376_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_12&#39;)"><span class="mpre">putWordhost</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_376_1_376_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_12&#39;)"><span class="hl_fundecl"><span class="mpre">putWordhost</span></span></a><span class="mpre"> </span><a name="loc_376_13_376_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_13_376_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_varref"><span class="mpre">writeNbytes</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word</span></span><span class="mpre">)) (\</span><a name="loc_376_60_376_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_60_376_61&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_376_60_376_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_60_376_61&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_376_13_376_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_13_376_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_376_1_376_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_12&#39;)"><span class="mpre">putWordhost</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a Word16 in native host order and host endianness.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 2 bytes will be written, unaligned.</span></span><span class="mpre">
</span><a href="#loc_382_1_382_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_1_382_14&#39;)"><span class="mpre">putWord16host</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_382_1_382_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_1_382_14&#39;)"><span class="hl_fundecl"><span class="mpre">putWord16host</span></span></a><span class="mpre"> </span><a name="loc_382_15_382_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_15_382_18&#39;)"><span class="hl_vardecl"><span class="mpre">w16</span></span></a><span class="mpre"> = </span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_varref"><span class="mpre">writeNbytes</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">)) (\</span><a name="loc_382_66_382_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_66_382_67&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_382_66_382_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_66_382_67&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_382_15_382_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_15_382_18&#39;)"><span class="hl_varref"><span class="mpre">w16</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_382_1_382_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_1_382_14&#39;)"><span class="mpre">putWord16host</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a Word32 in native host order and host endianness.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 4 bytes will be written, unaligned.</span></span><span class="mpre">
</span><a href="#loc_388_1_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_14&#39;)"><span class="mpre">putWord32host</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_388_1_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_14&#39;)"><span class="hl_fundecl"><span class="mpre">putWord32host</span></span></a><span class="mpre"> </span><a name="loc_388_15_388_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_15_388_18&#39;)"><span class="hl_vardecl"><span class="mpre">w32</span></span></a><span class="mpre"> = </span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_varref"><span class="mpre">writeNbytes</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">)) (\</span><a name="loc_388_66_388_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_66_388_67&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_388_66_388_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_66_388_67&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_388_15_388_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_15_388_18&#39;)"><span class="hl_varref"><span class="mpre">w32</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_388_1_388_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_14&#39;)"><span class="mpre">putWord32host</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a Word64 in native host order.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On a 32 bit machine we write two host order Word32s, in big endian form.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 8 bytes will be written, unaligned.</span></span><span class="mpre">
</span><a href="#loc_395_1_395_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_14&#39;)"><span class="mpre">putWord64host</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><a href="#loc_92_9_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_395_1_395_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_14&#39;)"><span class="hl_fundecl"><span class="mpre">putWord64host</span></span></a><span class="mpre"> </span><a name="loc_395_15_395_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_15_395_16&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_varref"><span class="mpre">writeNbytes</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">)) (\</span><a name="loc_395_64_395_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_64_395_65&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_395_64_395_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_64_395_65&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_395_15_395_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_15_395_16&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_395_1_395_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_1_395_14&#39;)"><span class="mpre">putWord64host</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unchecked shifts</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_409_1_409_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_11&#39;)"><span class="mpre">shiftr_w16</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_409_1_409_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_11&#39;)"><span class="mpre">shiftr_w16</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="mpre">shiftr_w32</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="mpre">shiftr_w32</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="mpre">shiftr_w64</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="mpre">shiftr_w64</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">

#if defined(__GLASGOW_HASKELL__) &amp;&amp; !defined(__HADDOCK__)
</span><a name="loc_409_1_409_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_11&#39;)"><span class="hl_fundecl"><span class="mpre">shiftr_w16</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">W16#</span></span><span class="mpre"> </span><a name="loc_409_18_409_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_18_409_19&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a name="loc_409_25_409_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_25_409_26&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">W16#</span></span><span class="mpre"> (</span><a href="#loc_409_18_409_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_18_409_19&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`uncheckedShiftRL#`</span></span><span class="mpre">   </span><a href="#loc_409_25_409_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_25_409_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
</span><a name="loc_410_1_410_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_11&#39;)"><span class="hl_fundecl"><span class="mpre">shiftr_w32</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">W32#</span></span><span class="mpre"> </span><a name="loc_410_18_410_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_18_410_19&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a name="loc_410_25_410_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_25_410_26&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">W32#</span></span><span class="mpre"> (</span><a href="#loc_410_18_410_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_18_410_19&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`uncheckedShiftRL#`</span></span><span class="mpre">   </span><a href="#loc_410_25_410_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_25_410_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)

#if WORD_SIZE_IN_BITS &lt; 64
</span><a name="loc_413_1_413_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_1_413_11&#39;)"><span class="hl_fundecl"><span class="mpre">shiftr_w64</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">W64#</span></span><span class="mpre"> </span><a name="loc_413_18_413_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_18_413_19&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a name="loc_413_25_413_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_25_413_26&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">W64#</span></span><span class="mpre"> (</span><a href="#loc_413_18_413_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_18_413_19&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`uncheckedShiftRL64#`</span></span><span class="mpre"> </span><a href="#loc_413_25_413_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_25_413_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)

#if __GLASGOW_HASKELL__ &lt;= 606
</span><span class="hl_comment"><span class="mpre">-- Exported by GHC.Word in GHC 6.8 and higher</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 417, srcSpanStartColumn = 1, srcSpanEndLine = 418, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Builder.hs&quot;, srcSpanStartLine = 417, srcSpanStartColumn = 1, srcSpanEndLine = 417, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cereal-0.4.0.1/src/Data/Serialize/Bu"><span class="mpre">foreign import ccall unsafe &quot;stg_uncheckedShiftRL64&quot;
    uncheckedShiftRL64#     :: Word64# -&gt; Int# -&gt; Word64#</span></span><span class="mpre">
#endif

#else
</span><span class="hl_fundecl"><span class="mpre">shiftr_w64</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">W64#</span></span><span class="mpre"> </span><a name="loc_422_18_422_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_18_422_19&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a name="loc_422_25_422_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_25_422_26&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">W64#</span></span><span class="mpre"> (</span><a href="#loc_422_18_422_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_18_422_19&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`uncheckedShiftRL#`</span></span><span class="mpre"> </span><a href="#loc_422_25_422_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_25_422_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
#endif

#else
</span><span class="hl_vardecl"><span class="mpre">shiftr_w16</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">shiftR</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">shiftr_w32</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">shiftR</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">shiftr_w64</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">shiftR</span></span><span class="mpre">
#endif
</span></div></body></html>