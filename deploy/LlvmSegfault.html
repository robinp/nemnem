<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- Author: Simon Meier &lt;iridcode@gmail.com&gt;, 10/06/2010</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Attempt to find a small test-case for the segfaults that happen when</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- compiling the benchmarks with LLVM and GHC-7.0.1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module LlvmSegfault where

import Data.Word
import Data.Monoid
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/tests/LlvmSegfault.hs&quot;, srcSpanStartLine = 10, srcSpanStartColumn = 18, srcSpanEndLine = 10, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L

import Foreign

import Blaze.ByteString.Builder.Internal



</span><a href="#loc_19_1_19_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_10&#39;)"><span class="mpre">fromWord8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_19_1_19_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_10&#39;)"><span class="hl_fundecl"><span class="mpre">fromWord8</span></span></a><span class="mpre"> </span><a name="loc_19_11_19_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_11_19_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> =
    </span><span class="hl_conref"><span class="mpre">Builder</span></span><span class="mpre"> </span><a href="#loc_22_5_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre">
  where
    </span><a name="loc_22_5_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_9&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_22_12_22_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_12_22_14&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre"> </span><a name="loc_22_15_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_15_22_17&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre">
      | </span><a href="#loc_22_12_22_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_12_22_14&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_22_15_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_15_22_17&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre"> = do
          </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_22_12_22_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_12_22_14&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><a href="#loc_19_11_19_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_11_19_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
          let </span><a name="loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_vardecl"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_22_12_22_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_12_22_14&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
          </span><a href="#loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_varref"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_25_15_25_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_15_25_18&#39;)"><span class="hl_varref"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> </span><a href="#loc_22_15_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_15_22_17&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">               = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">BufferFull</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_22_12_22_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_12_22_14&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> (</span><a href="#loc_22_5_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_22_10_22_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)


</span><a href="#loc_31_1_31_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_7&#39;)"><span class="mpre">word8s</span></a><span class="mpre"> :: </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_31_1_31_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_7&#39;)"><span class="hl_vardecl"><span class="mpre">word8s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_19_1_19_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_10&#39;)"><span class="hl_varref"><span class="mpre">fromWord8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/tests/LlvmSegfault.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 43, srcSpanEndLine = 31, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/tests/LlvmSegfault.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 43, srcSpanEndLine = 31, srcSpanEndColumn = 44},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/tests/LlvmSeg"><span class="mpre">[(1::Int)..1000]</span></span><span class="mpre">

</span><a href="#loc_34_1_34_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_34_1_34_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">print</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.html#loc_181_1_181_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_181_1_181_21&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteStringWith</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><a href="#loc_31_1_31_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_7&#39;)"><span class="hl_varref"><span class="mpre">word8s</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">
</span></div></body></html>