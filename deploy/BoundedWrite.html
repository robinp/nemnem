<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, BangPatterns #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : BoundedWrite</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2010 Simon Meier</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Simon Meier &lt;iridcode@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : tested on GHC only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A more general/efficient write type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module BoundedWrite (main) where

import Foreign
import Data.Monoid
import Data.Char

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BoundedWrite.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 8, srcSpanEndLine = 19, srcSpanEndColumn = 20}, srcInfoPoints = []}) &quot;Foreign.UPtr&quot;"><span class="mpre">Foreign.UPtr</span></span><span class="mpre">

import qualified Data.ByteString.Internal as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BoundedWrite.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 18, srcSpanEndLine = 22, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L

import Blaze.ByteString.Builder.Internal
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BoundedWrite.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Blaze.ByteString.Builder.Write&quot;"><span class="mpre">Blaze.ByteString.Builder.Write</span></span><span class="mpre"> 
import Blaze.ByteString.Builder.Word 

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BoundedWrite.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 8, srcSpanEndLine = 28, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Criterion.Main&quot;"><span class="mpre">Criterion.Main</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Benchmarks</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_35_1_35_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_35_1_35_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">defaultMain</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">{-
    [ benchmark &quot;mconcat . map (fromWriteSingleton writeChar)&quot;
        bfrom3Chars
        from3Chars
        chars3
    ]
    -}</span></span><span class="mpre">
    [ </span><a href="#loc_49_5_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_14&#39;)"><span class="hl_varref"><span class="mpre">benchmark</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mconcat . map fromWord8&quot;</span></span><span class="mpre">
        (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_163_1_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_11&#39;)"><span class="hl_varref"><span class="mpre">bfromWord8</span></span></a><span class="mpre">)
        (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Word.html#loc_269_1_269_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Word.html#loc_269_1_269_10&#39;)"><span class="hl_varref"><span class="mpre">fromWord8</span></span></a><span class="mpre">)
        </span><a href="#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_7&#39;)"><span class="hl_varref"><span class="mpre">word8s</span></span></a><span class="mpre">
    ]
  where
    </span><a name="loc_49_5_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_14&#39;)"><span class="hl_fundecl"><span class="mpre">benchmark</span></span></a><span class="mpre"> </span><a name="loc_49_15_49_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_19&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_49_20_49_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_20_49_28&#39;)"><span class="hl_vardecl"><span class="mpre">boundedF</span></span></a><span class="mpre"> </span><a name="loc_49_29_49_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_29_49_36&#39;)"><span class="hl_vardecl"><span class="mpre">staticF</span></span></a><span class="mpre"> </span><a name="loc_49_37_49_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_37_49_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
        [ </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> (</span><a href="#loc_49_15_49_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_19&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &lt;- bounded write&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">whnf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_49_20_49_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_20_49_28&#39;)"><span class="hl_varref"><span class="mpre">boundedF</span></span></a><span class="mpre">) </span><a href="#loc_49_37_49_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_37_49_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> (</span><a href="#loc_49_15_49_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_19&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &lt;- static write&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">whnf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_49_29_49_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_29_49_36&#39;)"><span class="hl_varref"><span class="mpre">staticF</span></span></a><span class="mpre">) </span><a href="#loc_49_37_49_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_37_49_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        ]

</span><a href="#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_7&#39;)"><span class="mpre">word8s</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_57_1_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_7&#39;)"><span class="hl_vardecl"><span class="mpre">word8s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cycle</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BoundedWrite.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 30, srcSpanEndLine = 57, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BoundedWrite.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 30, srcSpanEndLine = 57, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/bench"><span class="mpre">[0..]</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_57_1_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_7&#39;)"><span class="mpre">word8s</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_61_1_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_6&#39;)"><span class="mpre">chars</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
</span><a name="loc_61_1_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_6&#39;)"><span class="hl_vardecl"><span class="mpre">chars</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BoundedWrite.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 23, srcSpanEndLine = 61, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BoundedWrite.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 23, srcSpanEndLine = 61, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/bench"><span class="mpre">[&#39;\0&#39;..]</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_61_1_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_6&#39;)"><span class="mpre">chars</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_65_1_65_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_7&#39;)"><span class="mpre">chars2</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)]
</span><a name="loc_65_1_65_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_7&#39;)"><span class="hl_vardecl"><span class="mpre">chars2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><a href="#loc_61_1_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_6&#39;)"><span class="hl_varref"><span class="mpre">chars</span></span></a><span class="mpre"> </span><a href="#loc_61_1_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_6&#39;)"><span class="hl_varref"><span class="mpre">chars</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_65_1_65_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_7&#39;)"><span class="mpre">chars2</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="mpre">chars3</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)]
</span><a name="loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_vardecl"><span class="mpre">chars3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">zip3</span></span><span class="mpre"> </span><a href="#loc_61_1_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_6&#39;)"><span class="hl_varref"><span class="mpre">chars</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_61_1_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_6&#39;)"><span class="hl_varref"><span class="mpre">chars</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_61_1_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_6&#39;)"><span class="hl_varref"><span class="mpre">chars</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="mpre">chars3</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a name="loc_72_1_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_11&#39;)"><span class="hl_vardecl"><span class="mpre">bfromChars</span></span></a><span class="mpre"> = (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_148_1_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_20&#39;)"><span class="hl_varref"><span class="mpre">fromBWriteSingleton</span></span></a><span class="mpre"> </span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">bwriteChar</span></span></a><span class="mpre">))
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_72_1_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_11&#39;)"><span class="mpre">bfromChars</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a name="loc_75_1_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_10&#39;)"><span class="hl_vardecl"><span class="mpre">fromChars</span></span></a><span class="mpre"> = (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_233_1_233_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_233_1_233_19&#39;)"><span class="hl_varref"><span class="mpre">fromWriteSingleton</span></span></a><span class="mpre"> </span><a href="#loc_195_1_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_10&#39;)"><span class="hl_varref"><span class="mpre">writeChar</span></span></a><span class="mpre">))
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_75_1_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_10&#39;)"><span class="mpre">fromChars</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a name="loc_78_1_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_12&#39;)"><span class="hl_vardecl"><span class="mpre">bfrom2Chars</span></span></a><span class="mpre"> = (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_148_1_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_20&#39;)"><span class="hl_varref"><span class="mpre">fromBWriteSingleton</span></span></a><span class="mpre"> (\(</span><a name="loc_78_54_78_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_54_78_56&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre">, </span><a name="loc_78_58_78_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_58_78_60&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">bwriteChar</span></span></a><span class="mpre"> </span><a href="#loc_78_54_78_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_54_78_56&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">bwriteChar</span></span></a><span class="mpre"> </span><a href="#loc_78_58_78_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_58_78_60&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">)))
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_78_1_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_12&#39;)"><span class="mpre">bfrom2Chars</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a name="loc_81_1_81_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_11&#39;)"><span class="hl_vardecl"><span class="mpre">from2Chars</span></span></a><span class="mpre"> = (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_233_1_233_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_233_1_233_19&#39;)"><span class="hl_varref"><span class="mpre">fromWriteSingleton</span></span></a><span class="mpre"> (\(</span><a name="loc_81_52_81_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_52_81_54&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre">, </span><a name="loc_81_56_81_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_56_81_58&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_195_1_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_10&#39;)"><span class="hl_varref"><span class="mpre">writeChar</span></span></a><span class="mpre"> </span><a href="#loc_81_52_81_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_52_81_54&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_195_1_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_10&#39;)"><span class="hl_varref"><span class="mpre">writeChar</span></span></a><span class="mpre"> </span><a href="#loc_81_56_81_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_56_81_58&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">)))
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_81_1_81_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_11&#39;)"><span class="mpre">from2Chars</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a name="loc_84_1_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_12&#39;)"><span class="hl_vardecl"><span class="mpre">bfrom3Chars</span></span></a><span class="mpre"> = (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_148_1_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_20&#39;)"><span class="hl_varref"><span class="mpre">fromBWriteSingleton</span></span></a><span class="mpre"> (\(</span><a name="loc_84_54_84_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_54_84_56&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre">, </span><a name="loc_84_58_84_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_58_84_60&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre">, </span><a name="loc_84_62_84_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_62_84_64&#39;)"><span class="hl_vardecl"><span class="mpre">c3</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">bwriteChar</span></span></a><span class="mpre"> </span><a href="#loc_84_54_84_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_54_84_56&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">bwriteChar</span></span></a><span class="mpre"> </span><a href="#loc_84_58_84_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_58_84_60&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">bwriteChar</span></span></a><span class="mpre"> </span><a href="#loc_84_62_84_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_62_84_64&#39;)"><span class="hl_varref"><span class="mpre">c3</span></span></a><span class="mpre">)))
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_84_1_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_12&#39;)"><span class="mpre">bfrom3Chars</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a name="loc_87_1_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_11&#39;)"><span class="hl_vardecl"><span class="mpre">from3Chars</span></span></a><span class="mpre"> = (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_233_1_233_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_233_1_233_19&#39;)"><span class="hl_varref"><span class="mpre">fromWriteSingleton</span></span></a><span class="mpre"> (\(</span><a name="loc_87_52_87_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_52_87_54&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre">, </span><a name="loc_87_56_87_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_56_87_58&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre">, </span><a name="loc_87_60_87_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_60_87_62&#39;)"><span class="hl_vardecl"><span class="mpre">c3</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_195_1_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_10&#39;)"><span class="hl_varref"><span class="mpre">writeChar</span></span></a><span class="mpre"> </span><a href="#loc_87_52_87_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_52_87_54&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_195_1_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_10&#39;)"><span class="hl_varref"><span class="mpre">writeChar</span></span></a><span class="mpre"> </span><a href="#loc_87_56_87_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_56_87_58&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_195_1_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_10&#39;)"><span class="hl_varref"><span class="mpre">writeChar</span></span></a><span class="mpre"> </span><a href="#loc_87_60_87_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_60_87_62&#39;)"><span class="hl_varref"><span class="mpre">c3</span></span></a><span class="mpre">)))
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_87_1_87_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_11&#39;)"><span class="mpre">from3Chars</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The Bounded Write Type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- * GRRR* GHC is too &#39;clever&#39;... code where we branch and each branch should</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- execute a few IO actions and then return a value cannot be taught to GHC. </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- At least not such that it returns the value of the branches unpacked.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Hmm.. at least he behaves much better for the Monoid instance of BWrite</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- than the one for Write. Serializing UTF-8 chars gets a slowdown of a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- factor 2 when 2 chars are composed. Perhaps I should try out the writeList</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instances also, as they may be more sensitive to to much work per Char.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_103_6_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_6_103_12&#39;)"><span class="hl_tycondecl"><span class="mpre">BWrite</span></span></a><span class="mpre"> = </span><a name="loc_103_15_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_21&#39;)"><span class="hl_condecl"><span class="mpre">BWrite</span></span></a><span class="mpre"> {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">UPtr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UPtr</span></span><span class="mpre">)

newtype </span><a name="loc_105_9_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_15&#39;)"><span class="hl_tycondecl"><span class="mpre">UWrite</span></span></a><span class="mpre"> = </span><a name="loc_105_18_105_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_24&#39;)"><span class="hl_condecl"><span class="mpre">UWrite</span></span></a><span class="mpre"> { </span><span class="hl_fielddecl"><span class="mpre">runUWrite</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">UPtr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UPtr</span></span><span class="mpre"> }

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_105_9_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_15&#39;)"><span class="hl_tyconref"><span class="mpre">UWrite</span></span></a><span class="mpre"> where
  </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_105_18_105_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_24&#39;)"><span class="hl_conref"><span class="mpre">UWrite</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_108_22_108_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_22_108_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_108_22_108_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_22_108_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  (</span><a href="#loc_105_18_105_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_24&#39;)"><span class="hl_conref"><span class="mpre">UWrite</span></span></a><span class="mpre"> </span><a name="loc_110_11_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_11_110_14&#39;)"><span class="hl_vardecl"><span class="mpre">uw1</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">`mappend`</span></span></a><span class="mpre"> (</span><a href="#loc_105_18_105_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_24&#39;)"><span class="hl_conref"><span class="mpre">UWrite</span></span></a><span class="mpre"> </span><a name="loc_110_34_110_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_34_110_37&#39;)"><span class="hl_vardecl"><span class="mpre">uw2</span></span></a><span class="mpre">) = </span><a href="#loc_105_18_105_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_24&#39;)"><span class="hl_conref"><span class="mpre">UWrite</span></span></a><span class="mpre"> (\</span><a name="loc_110_50_110_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_50_110_52&#39;)"><span class="hl_vardecl"><span class="mpre">up</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_110_34_110_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_34_110_37&#39;)"><span class="hl_varref"><span class="mpre">uw2</span></span></a><span class="mpre"> (</span><a href="#loc_110_11_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_11_110_14&#39;)"><span class="hl_varref"><span class="mpre">uw1</span></span></a><span class="mpre"> </span><a href="#loc_110_50_110_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_50_110_52&#39;)"><span class="hl_varref"><span class="mpre">up</span></span></a><span class="mpre">))
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre"> #-}</span></span><span class="mpre">

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_103_6_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_6_103_12&#39;)"><span class="hl_tyconref"><span class="mpre">BWrite</span></span></a><span class="mpre"> where
  </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_103_15_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_21&#39;)"><span class="hl_conref"><span class="mpre">BWrite</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (\</span><a name="loc_114_23_114_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_23_114_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_114_23_114_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_23_114_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  (</span><a href="#loc_103_15_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_21&#39;)"><span class="hl_conref"><span class="mpre">BWrite</span></span></a><span class="mpre"> </span><a name="loc_116_11_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_13&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a name="loc_116_14_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_14_116_17&#39;)"><span class="hl_vardecl"><span class="mpre">io1</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">`mappend`</span></span></a><span class="mpre"> (</span><a href="#loc_103_15_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_21&#39;)"><span class="hl_conref"><span class="mpre">BWrite</span></span></a><span class="mpre"> </span><a name="loc_116_37_116_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_37_116_39&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre"> </span><a name="loc_116_40_116_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_40_116_43&#39;)"><span class="hl_vardecl"><span class="mpre">io2</span></span></a><span class="mpre">) =
    </span><a href="#loc_103_15_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_21&#39;)"><span class="hl_conref"><span class="mpre">BWrite</span></span></a><span class="mpre"> (</span><a href="#loc_116_11_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_13&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_116_37_116_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_37_116_39&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">) (\</span><a name="loc_117_24_117_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_24_117_26&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_116_40_116_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_40_116_43&#39;)"><span class="hl_varref"><span class="mpre">io2</span></span></a><span class="mpre"> (</span><a href="#loc_116_14_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_14_116_17&#39;)"><span class="hl_varref"><span class="mpre">io1</span></span></a><span class="mpre"> </span><a href="#loc_117_24_117_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_24_117_26&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">))
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="mpre">execWrite</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UPtr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UPtr</span></span><span class="mpre">
</span><a name="loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_fundecl"><span class="mpre">execWrite</span></span></a><span class="mpre"> </span><a name="loc_121_11_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_13&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> </span><a name="loc_121_14_121_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_17&#39;)"><span class="hl_vardecl"><span class="mpre">op&#39;</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_592_1_592_16&#39;)"><span class="hl_varref"><span class="mpre">S.inlinePerformIO</span></span></a><span class="mpre"> </span><a href="#loc_121_11_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_13&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="#loc_121_14_121_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_17&#39;)"><span class="hl_varref"><span class="mpre">op&#39;</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="mpre">execWrite</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_125_1_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_14&#39;)"><span class="mpre">execWriteSize</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UPtr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UPtr</span></span><span class="mpre">
</span><a name="loc_125_1_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_14&#39;)"><span class="hl_fundecl"><span class="mpre">execWriteSize</span></span></a><span class="mpre"> </span><a name="loc_125_15_125_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_17&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> </span><a name="loc_125_18_125_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_18_125_22&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_125_23_125_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_23_125_25&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> = </span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">execWrite</span></span></a><span class="mpre"> (</span><a href="#loc_125_15_125_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_17&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uptrToPtr</span></span><span class="mpre"> </span><a href="#loc_125_23_125_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_23_125_25&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">)) (</span><a href="#loc_125_23_125_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_23_125_25&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusUPtr`</span></span><span class="mpre"> </span><a href="#loc_125_18_125_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_18_125_22&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_125_1_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_14&#39;)"><span class="mpre">execWriteSize</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_129_1_129_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_13&#39;)"><span class="mpre">staticBWrite</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><a href="#loc_103_6_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_6_103_12&#39;)"><span class="hl_tyconref"><span class="mpre">BWrite</span></span></a><span class="mpre">
</span><a name="loc_129_1_129_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_13&#39;)"><span class="hl_fundecl"><span class="mpre">staticBWrite</span></span></a><span class="mpre"> </span><a name="loc_129_14_129_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_14_129_18&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_129_19_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_19_129_21&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> = </span><a href="#loc_103_15_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_21&#39;)"><span class="hl_conref"><span class="mpre">BWrite</span></span></a><span class="mpre"> </span><a href="#loc_129_14_129_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_14_129_18&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> (</span><a href="#loc_125_1_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_14&#39;)"><span class="hl_varref"><span class="mpre">execWriteSize</span></span></a><span class="mpre"> </span><a href="#loc_129_19_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_19_129_21&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre"> </span><a href="#loc_129_14_129_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_14_129_18&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_129_1_129_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_13&#39;)"><span class="mpre">staticBWrite</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_133_1_133_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_12&#39;)"><span class="mpre">bwriteWord8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="#loc_103_6_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_6_103_12&#39;)"><span class="hl_tyconref"><span class="mpre">BWrite</span></span></a><span class="mpre"> 
</span><a name="loc_133_1_133_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_12&#39;)"><span class="hl_fundecl"><span class="mpre">bwriteWord8</span></span></a><span class="mpre"> </span><a name="loc_133_13_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_13_133_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_129_1_129_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_1_129_13&#39;)"><span class="hl_varref"><span class="mpre">staticBWrite</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`poke`</span></span><span class="mpre"> </span><a href="#loc_133_13_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_13_133_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_133_1_133_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_12&#39;)"><span class="mpre">bwriteWord8</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_137_1_137_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_11&#39;)"><span class="mpre">fromBWrite</span></a><span class="mpre"> :: </span><a href="#loc_103_6_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_6_103_12&#39;)"><span class="hl_tyconref"><span class="mpre">BWrite</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_137_1_137_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_11&#39;)"><span class="hl_fundecl"><span class="mpre">fromBWrite</span></span></a><span class="mpre"> (</span><a href="#loc_103_15_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_21&#39;)"><span class="hl_conref"><span class="mpre">BWrite</span></span></a><span class="mpre"> </span><a name="loc_137_20_137_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_24&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_137_25_137_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_27&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre">) =
    </span><span class="hl_conref"><span class="mpre">Builder</span></span><span class="mpre"> </span><a href="#loc_140_5_140_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre">
  where
    </span><a name="loc_140_5_140_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_9&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_140_10_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_10_140_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> !</span><a name="loc_140_13_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_13_140_15&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre"> !</span><a name="loc_140_17_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_19&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre">
      | </span><a href="#loc_140_13_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_13_140_15&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_137_20_137_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_24&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_140_17_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_19&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre"> = do
          let !</span><a name="loc_142_16_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_16_142_19&#39;)"><span class="hl_vardecl"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_137_25_137_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_27&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ptrToUPtr</span></span><span class="mpre"> </span><a href="#loc_140_13_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_13_140_15&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre">)
          </span><a href="#loc_140_10_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_10_140_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uptrToPtr</span></span><span class="mpre"> </span><a href="#loc_142_16_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_16_142_19&#39;)"><span class="hl_varref"><span class="mpre">pf&#39;</span></span></a><span class="mpre">) </span><a href="#loc_140_17_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_17_140_19&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">BufferFull</span></span><span class="mpre"> </span><a href="#loc_137_20_137_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_24&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_140_13_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_13_140_15&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> (</span><a href="#loc_140_5_140_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_140_10_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_10_140_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_137_1_137_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_11&#39;)"><span class="mpre">fromBWrite</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_148_1_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_20&#39;)"><span class="mpre">fromBWriteSingleton</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_103_6_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_6_103_12&#39;)"><span class="hl_tyconref"><span class="mpre">BWrite</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_148_1_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_20&#39;)"><span class="hl_fundecl"><span class="mpre">fromBWriteSingleton</span></span></a><span class="mpre"> </span><a name="loc_148_21_148_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_21_148_26&#39;)"><span class="hl_vardecl"><span class="mpre">write</span></span></a><span class="mpre"> = 
    </span><a href="#loc_151_5_151_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_5_151_10&#39;)"><span class="hl_varref"><span class="mpre">mkPut</span></span></a><span class="mpre">
  where
    </span><a name="loc_151_5_151_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_5_151_10&#39;)"><span class="hl_fundecl"><span class="mpre">mkPut</span></span></a><span class="mpre"> </span><a name="loc_151_11_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_11_151_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Builder</span></span><span class="mpre"> </span><a href="#loc_153_9_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_13&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre">
      where
        </span><a name="loc_153_9_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_13&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_153_14_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> !</span><a name="loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre"> !</span><a name="loc_153_21_153_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_21_153_23&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre">
          | </span><a href="#loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_159_20_159_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_20_159_24&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_153_21_153_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_21_153_23&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre"> = do
              let !</span><a name="loc_155_20_155_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_20_155_23&#39;)"><span class="hl_vardecl"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_159_25_159_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_25_159_27&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ptrToUPtr</span></span><span class="mpre"> </span><a href="#loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre">)
              </span><a href="#loc_153_14_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uptrToPtr</span></span><span class="mpre"> </span><a href="#loc_155_20_155_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_20_155_23&#39;)"><span class="hl_varref"><span class="mpre">pf&#39;</span></span></a><span class="mpre">) </span><a href="#loc_153_21_153_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_21_153_23&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">               = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">BufferFull</span></span><span class="mpre"> </span><a href="#loc_159_20_159_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_20_159_24&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> (</span><a href="#loc_153_9_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_13&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_153_14_153_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
          where
            </span><a href="#loc_103_15_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_21&#39;)"><span class="hl_conref"><span class="mpre">BWrite</span></span></a><span class="mpre"> </span><a name="loc_159_20_159_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_20_159_24&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_159_25_159_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_25_159_27&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> = </span><a href="#loc_148_21_148_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_21_148_26&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_151_11_151_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_11_151_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_148_1_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_20&#39;)"><span class="mpre">fromBWriteSingleton</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_163_1_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_11&#39;)"><span class="mpre">bfromWord8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_163_1_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_11&#39;)"><span class="hl_vardecl"><span class="mpre">bfromWord8</span></span></a><span class="mpre"> = </span><a href="#loc_148_1_148_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_20&#39;)"><span class="hl_varref"><span class="mpre">fromBWriteSingleton</span></span></a><span class="mpre"> </span><a href="#loc_133_1_133_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_12&#39;)"><span class="hl_varref"><span class="mpre">bwriteWord8</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Utf-8 encoding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------</span></span><span class="mpre">

</span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="mpre">bwriteChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_103_6_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_6_103_12&#39;)"><span class="hl_tyconref"><span class="mpre">BWrite</span></span></a><span class="mpre">
</span><a name="loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_fundecl"><span class="mpre">bwriteChar</span></span></a><span class="mpre"> </span><a name="loc_169_12_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_12_169_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_103_15_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_21&#39;)"><span class="hl_conref"><span class="mpre">BWrite</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> (</span><a href="#loc_223_1_223_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_15&#39;)"><span class="hl_varref"><span class="mpre">encodeCharUtf8</span></span></a><span class="mpre"> </span><a href="#loc_171_5_171_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_5_171_7&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a href="#loc_175_5_175_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_5_175_7&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a href="#loc_180_5_180_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_5_180_7&#39;)"><span class="hl_varref"><span class="mpre">f3</span></span></a><span class="mpre"> </span><a href="#loc_186_5_186_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_5_186_7&#39;)"><span class="hl_varref"><span class="mpre">f4</span></span></a><span class="mpre"> </span><a href="#loc_169_12_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_12_169_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
  where
    </span><a name="loc_171_5_171_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_5_171_7&#39;)"><span class="hl_fundecl"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a name="loc_171_8_171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_8_171_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =  \</span><a name="loc_171_14_171_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_14_171_18&#39;)"><span class="hl_vardecl"><span class="mpre">uptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">execWrite</span></span></a><span class="mpre"> (do let !</span><a name="loc_171_41_171_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_41_171_44&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">uptrToPtr</span></span><span class="mpre"> </span><a href="#loc_171_14_171_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_14_171_18&#39;)"><span class="hl_varref"><span class="mpre">uptr</span></span></a><span class="mpre">
                                   </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_171_41_171_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_41_171_44&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_171_8_171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_8_171_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> )
                               (</span><a href="#loc_171_14_171_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_14_171_18&#39;)"><span class="hl_varref"><span class="mpre">uptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusUPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

    </span><a name="loc_175_5_175_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_5_175_7&#39;)"><span class="hl_fundecl"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a name="loc_175_8_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_8_175_10&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_175_11_175_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_11_175_13&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = \</span><a name="loc_175_17_175_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_17_175_21&#39;)"><span class="hl_vardecl"><span class="mpre">uptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">execWrite</span></span></a><span class="mpre"> (do let !</span><a name="loc_175_44_175_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_44_175_47&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">uptrToPtr</span></span><span class="mpre"> </span><a href="#loc_175_17_175_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_17_175_21&#39;)"><span class="hl_varref"><span class="mpre">uptr</span></span></a><span class="mpre">
                                      </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_175_44_175_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_44_175_47&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_175_8_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_8_175_10&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
                                      </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_175_44_175_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_44_175_47&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_175_11_175_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_11_175_13&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> )
                                  (</span><a href="#loc_175_17_175_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_17_175_21&#39;)"><span class="hl_varref"><span class="mpre">uptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusUPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)

    </span><a name="loc_180_5_180_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_5_180_7&#39;)"><span class="hl_fundecl"><span class="mpre">f3</span></span></a><span class="mpre"> </span><a name="loc_180_8_180_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_8_180_10&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_180_11_180_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_11_180_13&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a name="loc_180_14_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_14_180_16&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre"> = \</span><a name="loc_180_20_180_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_20_180_24&#39;)"><span class="hl_vardecl"><span class="mpre">uptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">execWrite</span></span></a><span class="mpre"> (do let !</span><a name="loc_180_47_180_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_47_180_50&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">uptrToPtr</span></span><span class="mpre"> </span><a href="#loc_180_20_180_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_20_180_24&#39;)"><span class="hl_varref"><span class="mpre">uptr</span></span></a><span class="mpre">
                                         </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_180_47_180_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_47_180_50&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_180_8_180_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_8_180_10&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
                                         </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_180_47_180_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_47_180_50&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_180_11_180_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_11_180_13&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">
                                         </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_180_47_180_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_47_180_50&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_180_14_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_14_180_16&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre"> )
                                     (</span><a href="#loc_180_20_180_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_20_180_24&#39;)"><span class="hl_varref"><span class="mpre">uptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusUPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)

    </span><a name="loc_186_5_186_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_5_186_7&#39;)"><span class="hl_fundecl"><span class="mpre">f4</span></span></a><span class="mpre"> </span><a name="loc_186_8_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_8_186_10&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_186_11_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_11_186_13&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a name="loc_186_14_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_14_186_16&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre"> </span><a name="loc_186_17_186_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_17_186_19&#39;)"><span class="hl_vardecl"><span class="mpre">x4</span></span></a><span class="mpre"> = \</span><a name="loc_186_23_186_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_23_186_27&#39;)"><span class="hl_vardecl"><span class="mpre">uptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">execWrite</span></span></a><span class="mpre"> (do let !</span><a name="loc_186_50_186_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_50_186_53&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">uptrToPtr</span></span><span class="mpre"> </span><a href="#loc_186_23_186_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_23_186_27&#39;)"><span class="hl_varref"><span class="mpre">uptr</span></span></a><span class="mpre">
                                            </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_186_50_186_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_50_186_53&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_186_8_186_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_8_186_10&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
                                            </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_186_50_186_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_50_186_53&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_186_11_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_11_186_13&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">
                                            </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_186_50_186_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_50_186_53&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_186_14_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_14_186_16&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre">
                                            </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_186_50_186_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_50_186_53&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><a href="#loc_186_17_186_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_17_186_19&#39;)"><span class="hl_varref"><span class="mpre">x4</span></span></a><span class="mpre"> )
                                        (</span><a href="#loc_186_23_186_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_23_186_27&#39;)"><span class="hl_varref"><span class="mpre">uptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusUPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="mpre">bwriteChar</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_195_1_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_10&#39;)"><span class="mpre">writeChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">
</span><a name="loc_195_1_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_10&#39;)"><span class="hl_vardecl"><span class="mpre">writeChar</span></span></a><span class="mpre"> = </span><a href="#loc_223_1_223_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_15&#39;)"><span class="hl_varref"><span class="mpre">encodeCharUtf8</span></span></a><span class="mpre"> </span><a href="#loc_197_5_197_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_5_197_7&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a href="#loc_199_5_199_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_5_199_7&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a href="#loc_202_5_202_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_7&#39;)"><span class="hl_varref"><span class="mpre">f3</span></span></a><span class="mpre"> </span><a href="#loc_206_5_206_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_5_206_7&#39;)"><span class="hl_varref"><span class="mpre">f4</span></span></a><span class="mpre">
  where
    </span><a name="loc_197_5_197_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_5_197_7&#39;)"><span class="hl_fundecl"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a name="loc_197_8_197_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_8_197_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Write</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_197_23_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_23_197_26&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_197_23_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_23_197_26&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_197_8_197_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_8_197_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

    </span><a name="loc_199_5_199_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_5_199_7&#39;)"><span class="hl_fundecl"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a name="loc_199_8_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_8_199_10&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_199_11_199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_11_199_13&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Write</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_199_27_199_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_27_199_30&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_199_27_199_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_27_199_30&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_199_8_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_8_199_10&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
                                    </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_199_27_199_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_27_199_30&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_199_11_199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_11_199_13&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">

    </span><a name="loc_202_5_202_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_7&#39;)"><span class="hl_fundecl"><span class="mpre">f3</span></span></a><span class="mpre"> </span><a name="loc_202_8_202_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_8_202_10&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_202_11_202_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_11_202_13&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a name="loc_202_14_202_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_14_202_16&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Write</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_202_30_202_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_30_202_33&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_202_30_202_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_30_202_33&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_202_8_202_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_8_202_10&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
                                       </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_202_30_202_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_30_202_33&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_202_11_202_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_11_202_13&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">
                                       </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_202_30_202_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_30_202_33&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_202_14_202_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_14_202_16&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre">

    </span><a name="loc_206_5_206_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_5_206_7&#39;)"><span class="hl_fundecl"><span class="mpre">f4</span></span></a><span class="mpre"> </span><a name="loc_206_8_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_8_206_10&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_206_11_206_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_11_206_13&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a name="loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre"> </span><a name="loc_206_17_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_17_206_19&#39;)"><span class="hl_vardecl"><span class="mpre">x4</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Write</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_206_33_206_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_33_206_36&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_206_33_206_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_33_206_36&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_206_8_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_8_206_10&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
                                          </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_206_33_206_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_33_206_36&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_206_11_206_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_11_206_13&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">
                                          </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_206_33_206_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_33_206_36&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre">
                                          </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><a href="#loc_206_33_206_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_33_206_36&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><a href="#loc_206_17_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_17_206_19&#39;)"><span class="hl_varref"><span class="mpre">x4</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_195_1_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_10&#39;)"><span class="mpre">writeChar</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode a Unicode character to another datatype, using UTF-8. This function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- acts as an abstract way of encoding characters, as it is unaware of what</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- needs to happen with the resulting bytes: you have to specify functions to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- deal with those.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_223_1_223_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_15&#39;)"><span class="mpre">encodeCharUtf8</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)                             </span><span class="hl_comment"><span class="mpre">-- ^ 1-byte UTF-8</span></span><span class="mpre">
               -&gt; (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)                    </span><span class="hl_comment"><span class="mpre">-- ^ 2-byte UTF-8</span></span><span class="mpre">
               -&gt; (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)           </span><span class="hl_comment"><span class="mpre">-- ^ 3-byte UTF-8</span></span><span class="mpre">
               -&gt; (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)  </span><span class="hl_comment"><span class="mpre">-- ^ 4-byte UTF-8</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">                                     </span><span class="hl_comment"><span class="mpre">-- ^ Input &#39;Char&#39;</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                                        </span><span class="hl_comment"><span class="mpre">-- ^ Result</span></span><span class="mpre">
</span><a name="loc_223_1_223_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_15&#39;)"><span class="hl_fundecl"><span class="mpre">encodeCharUtf8</span></span></a><span class="mpre"> </span><a name="loc_223_16_223_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_16_223_18&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a name="loc_223_19_223_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_19_223_21&#39;)"><span class="hl_vardecl"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a name="loc_223_22_223_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_22_223_24&#39;)"><span class="hl_vardecl"><span class="mpre">f3</span></span></a><span class="mpre"> </span><a name="loc_223_25_223_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_25_223_27&#39;)"><span class="hl_vardecl"><span class="mpre">f4</span></span></a><span class="mpre"> </span><a name="loc_223_28_223_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_28_223_29&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_223_28_223_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_28_223_29&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
    </span><a name="loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7F</span></span><span class="mpre"> -&gt; </span><a href="#loc_223_16_223_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_16_223_18&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
      | </span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x07FF</span></span><span class="mpre"> -&gt;
           let </span><a name="loc_226_16_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_16_226_18&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xC0</span></span><span class="mpre">
               </span><a name="loc_227_16_227_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_16_227_18&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">)   </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
           in </span><a href="#loc_223_19_223_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_19_223_21&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre"> </span><a href="#loc_226_16_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_16_226_18&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_227_16_227_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_16_227_18&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">
      | </span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xFFFF</span></span><span class="mpre"> -&gt;
           let </span><a name="loc_230_16_230_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_16_230_18&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xE0</span></span><span class="mpre">
               </span><a name="loc_231_16_231_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_16_231_18&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> ((</span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
               </span><a name="loc_232_16_232_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_16_232_18&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
           in </span><a href="#loc_223_22_223_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_22_223_24&#39;)"><span class="hl_varref"><span class="mpre">f3</span></span></a><span class="mpre"> </span><a href="#loc_230_16_230_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_16_230_18&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_231_16_231_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_16_231_18&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a href="#loc_232_16_232_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_16_232_18&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
           let </span><a name="loc_235_16_235_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_16_235_18&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xF0</span></span><span class="mpre">
               </span><a name="loc_236_16_236_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_16_236_18&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> ((</span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
               </span><a name="loc_237_16_237_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_16_237_18&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> ((</span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
               </span><a name="loc_238_16_238_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_18&#39;)"><span class="hl_vardecl"><span class="mpre">x4</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_224_5_224_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
           in </span><a href="#loc_223_25_223_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_25_223_27&#39;)"><span class="hl_varref"><span class="mpre">f4</span></span></a><span class="mpre"> </span><a href="#loc_235_16_235_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_16_235_18&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_236_16_236_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_16_236_18&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a href="#loc_237_16_237_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_16_237_18&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre"> </span><a href="#loc_238_16_238_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_18&#39;)"><span class="hl_varref"><span class="mpre">x4</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_223_1_223_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_15&#39;)"><span class="mpre">encodeCharUtf8</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span></div></body></html>