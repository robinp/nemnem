<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Random.API</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Deprecated interface for compatibility of crypto-random-api user</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with crypto-random</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Random.API
    ( CPRG(..)
    , cprgGenBytes
    , genRandomBytes
    , genRandomBytes&#39;
    , withRandomBytes
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 8, srcSpanEndLine = 19, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Crypto.Random

</span><span class="hl_comment"><span class="mpre">-- | Generate bytes using the CPRG and the number specified.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For user of the API, it&#39;s recommended to use genRandomBytes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instead of this method directly. the CPRG need to be able</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to supply at minimum 2^20 bytes at a time.</span></span><span class="mpre">
</span><a href="#loc_28_1_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_13&#39;)"><span class="mpre">cprgGenBytes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 17, srcSpanEndLine = 27, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 24, srcSpanEndLine = 27, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryp"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_28_1_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_13&#39;)"><span class="hl_fundecl"><span class="mpre">cprgGenBytes</span></span></a><span class="mpre"> </span><a name="loc_28_14_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_14_28_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_28_16_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_20&#39;)"><span class="hl_vardecl"><span class="mpre">cprg</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">cprgGenerate</span></span><span class="mpre"> </span><a href="#loc_28_14_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_14_28_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_28_16_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_20&#39;)"><span class="hl_varref"><span class="mpre">cprg</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Generate bytes using the cprg in parameter.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the number of bytes requested is really high,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it&#39;s preferable to use &#39;genRandomBytes&#39; for better memory efficiency.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 1, srcSpanEndLine = 34, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 1, srcSpanEndLine = 34, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.h"><span class="mpre">{-# DEPRECATED genRandomBytes &quot;use cprgGenerate from Crypto.Random instead&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_39_1_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_15&#39;)"><span class="mpre">genRandomBytes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 19, srcSpanEndLine = 36, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 16, srcSpanEndLine = 36, srcSpanEndColumn = 18}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryp"><span class="mpre">CPRG g    
               =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ number of bytes to return</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ CPRG to use</span></span><span class="mpre">
               -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)  
</span><a name="loc_39_1_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_15&#39;)"><span class="hl_fundecl"><span class="mpre">genRandomBytes</span></span></a><span class="mpre"> </span><a name="loc_39_16_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_39_18_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_22&#39;)"><span class="hl_vardecl"><span class="mpre">cprg</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">cprgGenerate</span></span><span class="mpre"> </span><a href="#loc_39_16_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_39_18_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_22&#39;)"><span class="hl_varref"><span class="mpre">cprg</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Generate bytes using the cprg in parameter.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is not tail recursive and an excessive len (&gt;= 2^29) parameter would</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- result in stack overflow.</span></span><span class="mpre">
</span><a href="#loc_48_1_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_16&#39;)"><span class="mpre">genRandomBytes&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 20, srcSpanEndLine = 45, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/API.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 27, srcSpanEndLine = 45, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryp"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ number of bytes to return</span></span><span class="mpre">
                          -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ CPRG to use</span></span><span class="mpre">
                          -&gt; ([</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">], </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_48_1_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_16&#39;)"><span class="hl_fundecl"><span class="mpre">genRandomBytes&#39;</span></span></a><span class="mpre"> </span><a name="loc_48_17_48_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_20&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_48_21_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_21_48_24&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre">
    | </span><a href="#loc_48_17_48_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_20&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;genBytes: cannot request negative amount of bytes.&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><a href="#loc_51_19_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_23&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_48_21_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_21_48_24&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_48_17_48_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_20&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
            where </span><a name="loc_51_19_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_23&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_51_24_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_24_51_25&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_51_26_51_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_26_51_27&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
                    | </span><a href="#loc_51_26_51_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_26_51_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = ([], </span><a href="#loc_51_24_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_24_51_25&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = let </span><a name="loc_53_39_53_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_39_53_46&#39;)"><span class="hl_vardecl"><span class="mpre">itBytes</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre">(</span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">:: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)) </span><a href="#loc_51_26_51_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_26_51_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
                                      (</span><a name="loc_54_40_54_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_40_54_42&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">, </span><a name="loc_54_44_54_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_44_54_46&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_28_1_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_13&#39;)"><span class="hl_varref"><span class="mpre">cprgGenBytes</span></span></a><span class="mpre"> </span><a href="#loc_53_39_53_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_39_53_46&#39;)"><span class="hl_varref"><span class="mpre">itBytes</span></span></a><span class="mpre"> </span><a href="#loc_51_24_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_24_51_25&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                                      (</span><a name="loc_55_40_55_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_40_55_41&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_55_43_55_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_43_55_46&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_48_1_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_16&#39;)"><span class="hl_varref"><span class="mpre">genRandomBytes&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_51_26_51_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_26_51_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_53_39_53_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_39_53_46&#39;)"><span class="hl_varref"><span class="mpre">itBytes</span></span></a><span class="mpre">) </span><a href="#loc_54_44_54_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_44_54_46&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
                                   in (</span><a href="#loc_54_40_54_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_40_54_42&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_55_40_55_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_40_55_41&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="#loc_55_43_55_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_43_55_46&#39;)"><span class="hl_varref"><span class="mpre">g&#39;&#39;</span></span></a><span class="mpre">)
</span></div></body></html>