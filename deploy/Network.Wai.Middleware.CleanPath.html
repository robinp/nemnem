<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
module Network.Wai.Middleware.CleanPath
    ( cleanPath
    ) where

import Network.Wai
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/CleanPath.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 18, srcSpanEndLine = 7, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/CleanPath.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 18, srcSpanEndLine = 8, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import Network.HTTP.Types (</span><a href="Network.HTTP.Types.Status.html#loc_257_1_257_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_257_1_257_10&#39;)"><span class="mpre">status301</span></a><span class="mpre">)
import Data.Text (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">)
import Data.Monoid (</span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="mpre">mconcat</span></a><span class="mpre">)

</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="mpre">cleanPath</span></a><span class="mpre"> :: ([</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">])
          -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
          -&gt; ([</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">)
          -&gt; </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">cleanPath</span></span></a><span class="mpre"> </span><a name="loc_17_11_17_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_19&#39;)"><span class="hl_vardecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_17_20_17_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_20_17_26&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a name="loc_17_27_17_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_27_17_30&#39;)"><span class="hl_vardecl"><span class="mpre">app</span></span></a><span class="mpre"> </span><a name="loc_17_31_17_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_31_17_34&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> </span><a name="loc_17_35_17_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_35_17_47&#39;)"><span class="hl_vardecl"><span class="mpre">sendResponse</span></span></a><span class="mpre"> =
    case </span><a href="#loc_17_11_17_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_19&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_50_6_50_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_50_6_50_14&#39;)"><span class="hl_varref"><span class="mpre">pathInfo</span></span></a><span class="mpre"> </span><a href="#loc_17_31_17_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_31_17_34&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_19_15_19_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_15_19_21&#39;)"><span class="hl_vardecl"><span class="mpre">pieces</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_17_27_17_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_27_17_30&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre"> </span><a href="#loc_19_15_19_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_15_19_21&#39;)"><span class="hl_varref"><span class="mpre">pieces</span></span></a><span class="mpre"> </span><a href="#loc_17_31_17_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_31_17_34&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre"> </span><a href="#loc_17_35_17_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_35_17_47&#39;)"><span class="hl_varref"><span class="mpre">sendResponse</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_20_14_20_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_14_20_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_17_35_17_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_35_17_47&#39;)"><span class="hl_varref"><span class="mpre">sendResponse</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_257_1_257_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_257_1_257_10&#39;)"><span class="hl_varref"><span class="mpre">status301</span></span></a><span class="mpre">
                  [(</span><span class="hl_string"><span class="mpre">&quot;Location&quot;</span></span><span class="mpre">, </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> [</span><a href="#loc_17_20_17_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_20_17_26&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre">, </span><a href="#loc_20_14_20_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_14_20_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_26_9_26_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_15&#39;)"><span class="hl_varref"><span class="mpre">suffix</span></span></a><span class="mpre">])]
                </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">
    where
        </span><span class="hl_comment"><span class="mpre">-- include the query string if present</span></span><span class="mpre">
        </span><a name="loc_26_9_26_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_15&#39;)"><span class="hl_vardecl"><span class="mpre">suffix</span></span></a><span class="mpre"> =
            case </span><span class="hl_varref"><span class="mpre">B.uncons</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_34_6_34_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_34_6_34_20&#39;)"><span class="hl_varref"><span class="mpre">rawQueryString</span></span></a><span class="mpre"> </span><a href="#loc_17_31_17_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_31_17_34&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="mpre">, _) -&gt; </span><a href="Network.Wai.Internal.html#loc_34_6_34_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_34_6_34_20&#39;)"><span class="hl_varref"><span class="mpre">rawQueryString</span></span></a><span class="mpre"> </span><a href="#loc_17_31_17_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_31_17_34&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre">
                _ -&gt; </span><span class="hl_varref"><span class="mpre">B.cons</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_34_6_34_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_34_6_34_20&#39;)"><span class="hl_varref"><span class="mpre">rawQueryString</span></span></a><span class="mpre"> </span><a href="#loc_17_31_17_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_31_17_34&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre">
</span></div></body></html>