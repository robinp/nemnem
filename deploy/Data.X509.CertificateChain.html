<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.CertificateChain</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.X509.CertificateChain
    ( CertificateChain(..)
    , CertificateChainRaw(..)
    </span><span class="hl_comment"><span class="mpre">-- * marshall between CertificateChain and CertificateChainRaw</span></span><span class="mpre">
    , decodeCertificateChain
    , encodeCertificateChain
    ) where

import Data.X509.Cert (</span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="mpre">Certificate</span></a><span class="mpre">)
import Data.X509.Signed (</span><a href="Data.X509.Signed.html#loc_65_38_65_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_65_38_65_49&#39;)"><span class="mpre">SignedExact</span></a><span class="mpre">, </span><a href="Data.X509.Signed.html#loc_126_1_126_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_126_1_126_19&#39;)"><span class="mpre">decodeSignedObject</span></a><span class="mpre">, </span><a href="Data.X509.Signed.html#loc_69_7_69_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_69_7_69_25&#39;)"><span class="mpre">encodeSignedObject</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CertificateChain.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)

</span><span class="hl_comment"><span class="mpre">-- | A chain of X.509 certificates in exact form.</span></span><span class="mpre">
newtype </span><a name="loc_21_9_21_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_25&#39;)"><span class="hl_tycondecl"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> = </span><a name="loc_21_28_21_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_28_21_44&#39;)"><span class="hl_condecl"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> [</span><a href="Data.X509.Signed.html#loc_65_38_65_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_65_38_65_49&#39;)"><span class="hl_tyconref"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre">]
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CertificateChain.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 5, srcSpanEndLine = 22, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CertificateChain.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 5, srcSpanEndLine = 22, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CertificateChain.hs&quot;,"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Represent a chain of X.509 certificates in bytestring form.</span></span><span class="mpre">
newtype </span><a name="loc_25_9_25_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_28&#39;)"><span class="hl_tycondecl"><span class="mpre">CertificateChainRaw</span></span></a><span class="mpre"> = </span><a name="loc_25_31_25_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_31_25_50&#39;)"><span class="hl_condecl"><span class="mpre">CertificateChainRaw</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">]
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CertificateChain.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 5, srcSpanEndLine = 26, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CertificateChain.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 5, srcSpanEndLine = 26, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CertificateChain.hs&quot;,"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Decode a CertificateChainRaw into a CertificateChain if every</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- raw certificate are decoded correctly, otherwise return the index of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- failed certificate and the error associated.</span></span><span class="mpre">
</span><a href="#loc_32_1_32_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_23&#39;)"><span class="mpre">decodeCertificateChain</span></a><span class="mpre"> :: </span><a href="#loc_25_9_25_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_28&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChainRaw</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) </span><a href="#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre">
</span><a name="loc_32_1_32_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_23&#39;)"><span class="hl_fundecl"><span class="mpre">decodeCertificateChain</span></span></a><span class="mpre"> (</span><a href="#loc_25_31_25_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_31_25_50&#39;)"><span class="hl_conref"><span class="mpre">CertificateChainRaw</span></span></a><span class="mpre"> </span><a name="loc_32_45_32_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_45_32_46&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) =
    </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_28_21_44&#39;)"><span class="hl_conref"><span class="mpre">CertificateChain</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_34_9_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_32_45_32_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_45_32_46&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  where </span><a name="loc_34_9_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> _ []     = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> []
        </span><a href="#loc_34_9_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_35_14_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_14_35_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a name="loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_35_19_35_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_19_35_21&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) = case </span><a href="Data.X509.Signed.html#loc_126_1_126_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_126_1_126_19&#39;)"><span class="hl_varref"><span class="mpre">decodeSignedObject</span></span></a><span class="mpre"> </span><a href="#loc_35_17_35_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> of
                         </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_36_31_36_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_31_36_34&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><a href="#loc_35_14_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_14_35_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">, </span><a href="#loc_36_31_36_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_31_36_34&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)
                         </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_37_32_37_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_32_37_33&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_37_32_37_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_32_37_33&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_34_9_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_35_14_35_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_14_35_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_35_19_35_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_19_35_21&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a CertificateChain into a CertificateChainRaw</span></span><span class="mpre">
</span><a href="#loc_41_1_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_23&#39;)"><span class="mpre">encodeCertificateChain</span></a><span class="mpre"> :: </span><a href="#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_25_9_25_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_28&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChainRaw</span></span></a><span class="mpre">
</span><a name="loc_41_1_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeCertificateChain</span></span></a><span class="mpre"> (</span><a href="#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_28_21_44&#39;)"><span class="hl_conref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> </span><a name="loc_41_42_41_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_42_41_47&#39;)"><span class="hl_vardecl"><span class="mpre">chain</span></span></a><span class="mpre">) =
    </span><a href="#loc_25_31_25_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_31_25_50&#39;)"><span class="hl_conref"><span class="mpre">CertificateChainRaw</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.X509.Signed.html#loc_69_7_69_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_69_7_69_25&#39;)"><span class="hl_varref"><span class="mpre">encodeSignedObject</span></span></a><span class="mpre"> </span><a href="#loc_41_42_41_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_42_41_47&#39;)"><span class="hl_varref"><span class="mpre">chain</span></span></a><span class="mpre">
</span></div></body></html>