<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- (c) 2002 by Martin Erwig [see file COPYRIGHT]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Monadic Graph Algorithms</span></span><span class="mpre">

module Data.Graph.Inductive.Query.Monad(
    </span><span class="hl_comment"><span class="mpre">-- * Additional Graph Utilities</span></span><span class="mpre">
    mapFst, mapSnd, (&gt;&lt;), orP,
    </span><span class="hl_comment"><span class="mpre">-- * Graph Transformer Monad</span></span><span class="mpre">
    GT(..), apply, apply&#39;, applyWith, applyWith&#39;, runGT, condMGT&#39;, recMGT&#39;,
    condMGT, recMGT,
    </span><span class="hl_comment"><span class="mpre">-- * Graph Computations Based on Graph Monads</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** Monadic Graph Accessing Functions</span></span><span class="mpre">
    getNode, getContext, getNodes&#39;, getNodes, sucGT, sucM,
    </span><span class="hl_comment"><span class="mpre">-- ** Derived Graph Recursion Operators</span></span><span class="mpre">
    graphRec, graphRec&#39;, graphUFold,
    </span><span class="hl_comment"><span class="mpre">-- * Examples: Graph Algorithms as Instances of Recursion Operators</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** Instances of graphRec</span></span><span class="mpre">
    graphNodesM0, graphNodesM, graphNodes, graphFilterM, graphFilter,
    </span><span class="hl_comment"><span class="mpre">-- * Example: Monadic DFS Algorithm(s)</span></span><span class="mpre">
    dfsGT, dfsM, dfsM&#39;, dffM, graphDff, graphDff&#39;,
) where


</span><span class="hl_comment"><span class="mpre">-- Why all this?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- graph monad ensures single-threaded access </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  ==&gt; we can safely use imperative updates in the graph implementation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 8, srcSpanEndLine = 29, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Tree&quot;"><span class="mpre">Data.Tree</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--import Control.Monad (liftM)</span></span><span class="mpre">

import Data.Graph.Inductive.Graph
import Data.Graph.Inductive.Monad

</span><span class="hl_comment"><span class="mpre">-- some additional (graph) utilities</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_38_1_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_7&#39;)"><span class="mpre">mapFst</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
</span><a name="loc_38_1_38_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_7&#39;)"><span class="hl_fundecl"><span class="mpre">mapFst</span></span></a><span class="mpre"> </span><a name="loc_38_8_38_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_8_38_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_38_11_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_11_38_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_38_13_38_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_13_38_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = (</span><a href="#loc_38_8_38_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_8_38_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_38_11_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_11_38_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_38_13_38_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_13_38_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="mpre">mapSnd</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_fundecl"><span class="mpre">mapSnd</span></span></a><span class="mpre"> </span><a name="loc_40_8_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_8_40_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_40_11_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_40_13_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_13_40_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = (</span><a href="#loc_40_11_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_40_8_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_8_40_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_40_13_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_13_40_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 1, srcSpanEndLine = 42, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 8, srcSpanEndLine = 42, srcSpanEndColumn = 9}]}) (AssocRight (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/"><span class="mpre">infixr 8 &gt;&lt;</span></span><span class="mpre">
</span><a href="#loc_44_4_44_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_4_44_6&#39;)"><span class="mpre">(&gt;&lt;)</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">)
(</span><a name="loc_44_2_44_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_2_44_3&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_44_4_44_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_4_44_6&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&lt;</span></span></a><span class="mpre"> </span><a name="loc_44_7_44_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_8&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) (</span><a name="loc_44_11_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_44_13_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = (</span><a href="#loc_44_2_44_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_2_44_3&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_44_11_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_44_7_44_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_44_13_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><a href="#loc_47_1_47_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_4&#39;)"><span class="mpre">orP</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_47_1_47_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_4&#39;)"><span class="hl_fundecl"><span class="mpre">orP</span></span></a><span class="mpre"> </span><a name="loc_47_5_47_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_6&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_47_7_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_7_47_8&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> (</span><a name="loc_47_10_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_10_47_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_47_12_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_12_47_13&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><a href="#loc_47_5_47_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_6&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_47_10_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_10_47_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_47_7_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_7_47_8&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><a href="#loc_47_12_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_12_47_13&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;wrapped&quot; state transformer monad   ==</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- monadic graph transformer monad</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tycondecl"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_condecl"><span class="mpre">MGT</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">))

</span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="mpre">apply</span></a><span class="mpre"> :: </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_fundecl"><span class="mpre">apply</span></span></a><span class="mpre"> (</span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> </span><a name="loc_57_12_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_12_57_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) </span><a name="loc_57_15_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_15_57_17&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre"> = </span><a href="#loc_57_12_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_12_57_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_57_15_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_15_57_17&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">

</span><a href="#loc_60_1_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_7&#39;)"><span class="mpre">apply&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 11, srcSpanEndLine = 59, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 19, srcSpanEndLine = 59, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_60_1_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_7&#39;)"><span class="hl_fundecl"><span class="mpre">apply&#39;</span></span></a><span class="mpre"> </span><a name="loc_60_8_60_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_8_60_10&#39;)"><span class="hl_vardecl"><span class="mpre">gt</span></span></a><span class="mpre"> = </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_60_8_60_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_8_60_10&#39;)"><span class="hl_varref"><span class="mpre">gt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">

</span><a href="#loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="mpre">applyWith</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 14, srcSpanEndLine = 62, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 22, srcSpanEndLine = 62, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="hl_fundecl"><span class="mpre">applyWith</span></span></a><span class="mpre"> </span><a name="loc_63_11_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_12&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> </span><a name="loc_63_18_63_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_18_63_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) </span><a name="loc_63_21_63_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_23&#39;)"><span class="hl_vardecl"><span class="mpre">gm</span></span></a><span class="mpre"> = do {(</span><a name="loc_63_31_63_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_31_63_32&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_63_33_63_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_33_63_34&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_63_18_63_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_18_63_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_63_21_63_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_23&#39;)"><span class="hl_varref"><span class="mpre">gm</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_63_11_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_63_31_63_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_31_63_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_63_33_63_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_33_63_34&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)}

</span><a href="#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="mpre">applyWith&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 15, srcSpanEndLine = 65, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 23, srcSpanEndLine = 65, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">applyWith&#39;</span></span></a><span class="mpre"> </span><a name="loc_66_12_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_12_66_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_66_14_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_14_66_16&#39;)"><span class="hl_vardecl"><span class="mpre">gt</span></span></a><span class="mpre"> = </span><a href="#loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="hl_varref"><span class="mpre">applyWith</span></span></a><span class="mpre"> </span><a href="#loc_66_12_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_12_66_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_66_14_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_14_66_16&#39;)"><span class="hl_varref"><span class="mpre">gt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">

</span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="mpre">runGT</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 10, srcSpanEndLine = 68, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 18, srcSpanEndLine = 68, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_fundecl"><span class="mpre">runGT</span></span></a><span class="mpre"> </span><a name="loc_69_7_69_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_7_69_9&#39;)"><span class="hl_vardecl"><span class="mpre">gt</span></span></a><span class="mpre"> </span><a name="loc_69_10_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_12&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre"> = do {(</span><a name="loc_69_20_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,_) &lt;- </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_69_7_69_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_7_69_9&#39;)"><span class="hl_varref"><span class="mpre">gt</span></span></a><span class="mpre"> </span><a href="#loc_69_10_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_12&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_69_20_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}


instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 10, srcSpanEndLine = 72, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 18, srcSpanEndLine = 72, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">) where
  </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> (\</span><a name="loc_73_20_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_20_73_22&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre">-&gt;do {</span><a name="loc_73_28_73_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_28_73_29&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">&lt;-</span><a href="#loc_73_20_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_20_73_22&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_73_28_73_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_28_73_29&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)})
  </span><a name="loc_74_3_74_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_3_74_4&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_74_9_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_10&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">  = </span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> (\</span><a name="loc_74_20_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_20_74_22&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre">-&gt;do {(</span><a name="loc_74_29_74_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_29_74_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_74_31_74_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_31_74_32&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">)&lt;-</span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_74_3_74_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_3_74_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_74_20_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_20_74_22&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">; </span><a href="#loc_60_1_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_7&#39;)"><span class="hl_varref"><span class="mpre">apply&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_74_9_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_10&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_74_29_74_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_29_74_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_74_31_74_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_31_74_32&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">})

</span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="mpre">condMGT&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 13, srcSpanEndLine = 76, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 21, srcSpanEndLine = 76, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="hl_fundecl"><span class="mpre">condMGT&#39;</span></span></a><span class="mpre"> </span><a name="loc_77_10_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_77_14_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_14_77_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> (\</span><a name="loc_77_24_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_24_77_26&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre">-&gt;do {</span><a name="loc_77_32_77_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_32_77_33&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">&lt;-</span><a href="#loc_77_24_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_24_77_26&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">; if </span><a href="#loc_77_10_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_77_32_77_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_32_77_33&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> then </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_77_24_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_24_77_26&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre"> else </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_77_14_77_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_14_77_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_77_24_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_24_77_26&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">})
 
</span><a href="#loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="mpre">recMGT&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 12, srcSpanEndLine = 79, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 20, srcSpanEndLine = 79, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="hl_fundecl"><span class="mpre">recMGT&#39;</span></span></a><span class="mpre"> </span><a name="loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_80_11_80_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_13&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre"> </span><a name="loc_80_14_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_14_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_80_16_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_17&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> = </span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="hl_varref"><span class="mpre">condMGT&#39;</span></span></a><span class="mpre"> </span><a href="#loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_80_16_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_17&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) 
                            (do {</span><a name="loc_81_34_81_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_34_81_35&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">&lt;-</span><a href="#loc_80_11_80_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_13&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">;</span><a name="loc_81_40_81_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_40_81_41&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">&lt;-</span><a href="#loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="hl_varref"><span class="mpre">recMGT&#39;</span></span></a><span class="mpre"> </span><a href="#loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_80_11_80_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_13&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre"> </span><a href="#loc_80_14_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_14_80_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_80_16_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_17&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">;</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_80_14_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_14_80_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_81_34_81_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_34_81_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_81_40_81_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_40_81_41&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)})

</span><a href="#loc_84_1_84_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_8&#39;)"><span class="mpre">condMGT</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 12, srcSpanEndLine = 83, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 20, srcSpanEndLine = 83, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_84_1_84_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_8&#39;)"><span class="hl_fundecl"><span class="mpre">condMGT</span></span></a><span class="mpre"> </span><a name="loc_84_9_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_84_11_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_11_84_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_84_13_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> (\</span><a name="loc_84_23_84_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_23_84_25&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre">-&gt;do {</span><a name="loc_84_31_84_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_31_84_32&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">&lt;-</span><a href="#loc_84_9_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_84_23_84_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_23_84_25&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">; if </span><a href="#loc_84_31_84_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_31_84_32&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_84_11_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_11_84_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_84_23_84_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_23_84_25&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre"> else </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_84_23_84_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_23_84_25&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">})

</span><a href="#loc_87_1_87_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_7&#39;)"><span class="mpre">recMGT</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 11, srcSpanEndLine = 86, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 19, srcSpanEndLine = 86, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_87_1_87_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_7&#39;)"><span class="hl_fundecl"><span class="mpre">recMGT</span></span></a><span class="mpre"> </span><a name="loc_87_8_87_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_8_87_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_87_10_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_12&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre"> </span><a name="loc_87_13_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_87_15_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> = </span><a href="#loc_84_1_84_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_8&#39;)"><span class="hl_varref"><span class="mpre">condMGT</span></span></a><span class="mpre"> </span><a href="#loc_87_8_87_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_8_87_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_87_15_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) 
                          (do {</span><a name="loc_88_32_88_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_32_88_33&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">&lt;-</span><a href="#loc_87_10_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_12&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">;</span><a name="loc_88_38_88_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_38_88_39&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">&lt;-</span><a href="#loc_87_1_87_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_7&#39;)"><span class="hl_varref"><span class="mpre">recMGT</span></span></a><span class="mpre"> </span><a href="#loc_87_8_87_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_8_87_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_87_10_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_10_87_12&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre"> </span><a href="#loc_87_13_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_87_15_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">;</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_87_13_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_88_32_88_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_32_88_33&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_88_38_88_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_38_88_39&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)})


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- graph computations based on state monads/graph monads</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- some monadic graph accessing functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a href="#loc_99_1_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_8&#39;)"><span class="mpre">getNode</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 12, srcSpanEndLine = 98, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 24, srcSpanEndLine = 98, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">
</span><a name="loc_99_1_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_8&#39;)"><span class="hl_vardecl"><span class="mpre">getNode</span></span></a><span class="mpre"> = </span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> (\</span><a name="loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre">-&gt;do {((_,</span><a name="loc_99_29_99_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_29_99_30&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_,_),</span><a name="loc_99_36_99_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_36_99_37&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) &lt;- </span><a href="Data.Graph.Inductive.Monad.html#loc_49_3_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_49_3_49_12&#39;)"><span class="hl_varref"><span class="mpre">matchAnyM</span></span></a><span class="mpre"> </span><a href="#loc_99_17_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_17_99_19&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_99_29_99_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_29_99_30&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_99_36_99_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_36_99_37&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)})

</span><a href="#loc_102_1_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_11&#39;)"><span class="mpre">getContext</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 15, srcSpanEndLine = 101, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 27, srcSpanEndLine = 101, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_102_1_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_11&#39;)"><span class="hl_vardecl"><span class="mpre">getContext</span></span></a><span class="mpre"> = </span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Monad.html#loc_49_3_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_49_3_49_12&#39;)"><span class="hl_varref"><span class="mpre">matchAnyM</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- some functions defined by using the do-notation explicitly</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note: most of these can be expressed as an instance of graphRec</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a href="#loc_108_1_108_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_10&#39;)"><span class="mpre">getNodes&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 14, srcSpanEndLine = 107, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 14, srcSpanEndLine = 107, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">(Graph gr,GraphM m gr) =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_108_1_108_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_10&#39;)"><span class="hl_vardecl"><span class="mpre">getNodes&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="hl_varref"><span class="mpre">condMGT&#39;</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_179_3_179_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_179_3_179_10&#39;)"><span class="hl_varref"><span class="mpre">isEmpty</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [])
                             (do </span><a name="loc_109_34_109_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_34_109_35&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_99_1_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_8&#39;)"><span class="hl_varref"><span class="mpre">getNode</span></span></a><span class="mpre">
                                 </span><a name="loc_110_34_110_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_34_110_36&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_114_1_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_9&#39;)"><span class="hl_varref"><span class="mpre">getNodes</span></span></a><span class="mpre">
                                 </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_109_34_109_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_34_109_35&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_110_34_110_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_34_110_36&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">))

</span><a href="#loc_114_1_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_9&#39;)"><span class="mpre">getNodes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 13, srcSpanEndLine = 113, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 25, srcSpanEndLine = 113, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_114_1_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_9&#39;)"><span class="hl_vardecl"><span class="mpre">getNodes</span></span></a><span class="mpre"> = </span><a href="#loc_84_1_84_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_8&#39;)"><span class="hl_varref"><span class="mpre">condMGT</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Monad.html#loc_44_3_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_44_3_44_11&#39;)"><span class="hl_varref"><span class="mpre">isEmptyM</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [])
                            (do </span><a name="loc_115_33_115_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_33_115_34&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_99_1_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_8&#39;)"><span class="hl_varref"><span class="mpre">getNode</span></span></a><span class="mpre">
                                </span><a name="loc_116_33_116_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_33_116_35&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_114_1_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_9&#39;)"><span class="hl_varref"><span class="mpre">getNodes</span></span></a><span class="mpre">
                                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_115_33_115_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_33_115_34&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_116_33_116_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_33_116_35&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">))

</span><a href="#loc_120_1_120_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_6&#39;)"><span class="mpre">sucGT</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 119, srcSpanStartColumn = 10, srcSpanEndLine = 119, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 119, srcSpanStartColumn = 22, srcSpanEndLine = 119, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">])
</span><a name="loc_120_1_120_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_6&#39;)"><span class="hl_fundecl"><span class="mpre">sucGT</span></span></a><span class="mpre"> </span><a name="loc_120_7_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_7_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> (\</span><a name="loc_120_17_120_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_17_120_19&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre">-&gt;do (</span><a name="loc_120_25_120_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_25_120_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_120_27_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_28&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) &lt;- </span><a href="Data.Graph.Inductive.Monad.html#loc_45_3_45_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_45_3_45_9&#39;)"><span class="hl_varref"><span class="mpre">matchM</span></span></a><span class="mpre"> </span><a href="#loc_120_7_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_7_120_8&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_120_17_120_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_17_120_19&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">
                       case </span><a href="#loc_120_25_120_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_25_120_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
                         </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (_,_,_,</span><a name="loc_122_38_122_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_38_122_39&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_122_38_122_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_38_122_39&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">),</span><a href="#loc_120_27_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_28&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
                         </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">        -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a href="#loc_120_27_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_27_120_28&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
              )

</span><a href="#loc_127_1_127_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_5&#39;)"><span class="mpre">sucM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 126, srcSpanStartColumn = 9, srcSpanEndLine = 126, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 126, srcSpanStartColumn = 21, srcSpanEndLine = 126, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">])
</span><a name="loc_127_1_127_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_5&#39;)"><span class="hl_fundecl"><span class="mpre">sucM</span></span></a><span class="mpre"> </span><a name="loc_127_6_127_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_6_127_7&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">runGT</span></span></a><span class="mpre"> (</span><a href="#loc_120_1_120_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_6&#39;)"><span class="hl_varref"><span class="mpre">sucGT</span></span></a><span class="mpre"> </span><a href="#loc_127_6_127_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_6_127_7&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)



</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- some derived graph recursion operators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- graphRec :: GraphMonad a b c -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; GraphMonad a b d</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- graphRec f g u = cond isEmpty (return u) </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                               (do x &lt;- f</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                   y &lt;- graphRec f g u</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                   return (g x y))</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | encapsulates a simple recursion schema on graphs</span></span><span class="mpre">
</span><a href="#loc_145_1_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_9&#39;)"><span class="mpre">graphRec</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 13, srcSpanEndLine = 143, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 25, srcSpanEndLine = 143, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; 
                           (</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">
</span><a name="loc_145_1_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_9&#39;)"><span class="hl_vardecl"><span class="mpre">graphRec</span></span></a><span class="mpre"> = </span><a href="#loc_87_1_87_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_7&#39;)"><span class="hl_varref"><span class="mpre">recMGT</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Monad.html#loc_44_3_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_44_3_44_11&#39;)"><span class="hl_varref"><span class="mpre">isEmptyM</span></span></a><span class="mpre">

</span><a href="#loc_149_1_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_10&#39;)"><span class="mpre">graphRec&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 14, srcSpanEndLine = 147, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 14, srcSpanEndLine = 147, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">(Graph gr,GraphM m gr) =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; 
                           (</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">
</span><a name="loc_149_1_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_10&#39;)"><span class="hl_vardecl"><span class="mpre">graphRec&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="hl_varref"><span class="mpre">recMGT&#39;</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_179_3_179_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_179_3_179_10&#39;)"><span class="hl_varref"><span class="mpre">isEmpty</span></span></a><span class="mpre">

</span><a href="#loc_152_1_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_11&#39;)"><span class="mpre">graphUFold</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 15, srcSpanEndLine = 151, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 27, srcSpanEndLine = 151, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
</span><a name="loc_152_1_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_11&#39;)"><span class="hl_vardecl"><span class="mpre">graphUFold</span></span></a><span class="mpre"> = </span><a href="#loc_145_1_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_9&#39;)"><span class="hl_varref"><span class="mpre">graphRec</span></span></a><span class="mpre"> </span><a href="#loc_102_1_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_11&#39;)"><span class="hl_varref"><span class="mpre">getContext</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Examples: graph algorithms as instances of recursion operators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- instances of graphRec</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a href="#loc_163_1_163_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_13&#39;)"><span class="mpre">graphNodesM0</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 17, srcSpanEndLine = 162, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 29, srcSpanEndLine = 162, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_163_1_163_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_13&#39;)"><span class="hl_vardecl"><span class="mpre">graphNodesM0</span></span></a><span class="mpre"> = </span><a href="#loc_145_1_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_9&#39;)"><span class="hl_varref"><span class="mpre">graphRec</span></span></a><span class="mpre"> </span><a href="#loc_99_1_99_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_8&#39;)"><span class="hl_varref"><span class="mpre">getNode</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> []

</span><a href="#loc_166_1_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_12&#39;)"><span class="mpre">graphNodesM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 165, srcSpanStartColumn = 16, srcSpanEndLine = 165, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 165, srcSpanStartColumn = 28, srcSpanEndLine = 165, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_166_1_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_12&#39;)"><span class="hl_vardecl"><span class="mpre">graphNodesM</span></span></a><span class="mpre"> = </span><a href="#loc_152_1_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_11&#39;)"><span class="hl_varref"><span class="mpre">graphUFold</span></span></a><span class="mpre"> (\(_,</span><a name="loc_166_31_166_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_31_166_32&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_,_)-&gt;(</span><a href="#loc_166_31_166_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_31_166_32&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) []

</span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="mpre">graphNodes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 168, srcSpanStartColumn = 15, srcSpanEndLine = 168, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 168, srcSpanStartColumn = 27, srcSpanEndLine = 168, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_vardecl"><span class="mpre">graphNodes</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">runGT</span></span></a><span class="mpre"> </span><a href="#loc_166_1_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_1_166_12&#39;)"><span class="hl_varref"><span class="mpre">graphNodesM</span></span></a><span class="mpre">

</span><a href="#loc_173_1_173_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_13&#39;)"><span class="mpre">graphFilterM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 171, srcSpanStartColumn = 17, srcSpanEndLine = 171, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 171, srcSpanStartColumn = 29, srcSpanEndLine = 171, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt;
                              </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) [</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">]
</span><a name="loc_173_1_173_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_13&#39;)"><span class="hl_fundecl"><span class="mpre">graphFilterM</span></span></a><span class="mpre"> </span><a name="loc_173_14_173_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_14_173_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_152_1_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_11&#39;)"><span class="hl_varref"><span class="mpre">graphUFold</span></span></a><span class="mpre"> (\</span><a name="loc_173_31_173_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_31_173_32&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_173_33_173_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_33_173_35&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">-&gt;if </span><a href="#loc_173_14_173_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_14_173_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_173_31_173_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_31_173_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> then </span><a href="#loc_173_31_173_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_31_173_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_173_33_173_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_33_173_35&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> else </span><a href="#loc_173_33_173_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_33_173_35&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) []

</span><a href="#loc_176_1_176_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_12&#39;)"><span class="mpre">graphFilter</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 175, srcSpanStartColumn = 16, srcSpanEndLine = 175, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 175, srcSpanStartColumn = 28, srcSpanEndLine = 175, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">]
</span><a name="loc_176_1_176_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_12&#39;)"><span class="hl_fundecl"><span class="mpre">graphFilter</span></span></a><span class="mpre"> </span><a name="loc_176_13_176_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_13_176_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">runGT</span></span></a><span class="mpre"> (</span><a href="#loc_173_1_173_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_13&#39;)"><span class="hl_varref"><span class="mpre">graphFilterM</span></span></a><span class="mpre"> </span><a href="#loc_176_13_176_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_13_176_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)




</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example: monadic dfs algorithm(s)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Monadic graph algorithms are defined in two steps:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (1) define the (possibly parameterized) graph transformer (e.g., dfsGT)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  (2) run the graph transformer (applied to arguments) (e.g., dfsM)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><a href="#loc_192_1_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_6&#39;)"><span class="mpre">dfsGT</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 191, srcSpanStartColumn = 10, srcSpanEndLine = 191, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 191, srcSpanStartColumn = 22, srcSpanEndLine = 191, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">] -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_192_1_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_6&#39;)"><span class="hl_fundecl"><span class="mpre">dfsGT</span></span></a><span class="mpre"> []     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
</span><a href="#loc_192_1_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_6&#39;)"><span class="hl_fundecl"><span class="mpre">dfsGT</span></span></a><span class="mpre"> (</span><a name="loc_193_8_193_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_8_193_9&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_193_10_193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_10_193_12&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">) = </span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> (\</span><a name="loc_193_22_193_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_22_193_24&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre">-&gt;
               do (</span><a name="loc_194_20_194_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_20_194_22&#39;)"><span class="hl_vardecl"><span class="mpre">mc</span></span></a><span class="mpre">,</span><a name="loc_194_23_194_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_25&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="Data.Graph.Inductive.Monad.html#loc_45_3_45_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_45_3_45_9&#39;)"><span class="hl_varref"><span class="mpre">matchM</span></span></a><span class="mpre"> </span><a href="#loc_193_8_193_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_8_193_9&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_193_22_193_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_22_193_24&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">
                  case </span><a href="#loc_194_20_194_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_20_194_22&#39;)"><span class="hl_varref"><span class="mpre">mc</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (_,_,_,</span><a name="loc_196_33_196_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_33_196_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">applyWith&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_193_8_193_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_8_193_9&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) (</span><a href="#loc_192_1_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_6&#39;)"><span class="hl_varref"><span class="mpre">dfsGT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_196_33_196_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_33_196_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_193_10_193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_10_193_12&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">)) </span><a href="#loc_194_23_194_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_25&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
                    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">        -&gt; </span><a href="#loc_60_1_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_7&#39;)"><span class="hl_varref"><span class="mpre">apply&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_192_1_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_6&#39;)"><span class="hl_varref"><span class="mpre">dfsGT</span></span></a><span class="mpre"> </span><a href="#loc_193_10_193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_10_193_12&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">) </span><a href="#loc_194_23_194_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_25&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">  )

</span><span class="hl_comment"><span class="mpre">-- | depth-first search yielding number of nodes</span></span><span class="mpre">
</span><a href="#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_5&#39;)"><span class="mpre">dfsM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 200, srcSpanStartColumn = 9, srcSpanEndLine = 200, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 200, srcSpanStartColumn = 21, srcSpanEndLine = 200, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_201_1_201_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_5&#39;)"><span class="hl_fundecl"><span class="mpre">dfsM</span></span></a><span class="mpre"> </span><a name="loc_201_6_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_6_201_8&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">runGT</span></span></a><span class="mpre"> (</span><a href="#loc_192_1_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_6&#39;)"><span class="hl_varref"><span class="mpre">dfsGT</span></span></a><span class="mpre"> </span><a href="#loc_201_6_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_6_201_8&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">)

</span><a href="#loc_204_1_204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_6&#39;)"><span class="mpre">dfsM&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 203, srcSpanStartColumn = 10, srcSpanEndLine = 203, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 203, srcSpanStartColumn = 22, srcSpanEndLine = 203, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_204_1_204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_6&#39;)"><span class="hl_fundecl"><span class="mpre">dfsM&#39;</span></span></a><span class="mpre"> </span><a name="loc_204_7_204_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_7_204_9&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre"> = do {</span><a name="loc_204_16_204_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_16_204_18&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Graph.Inductive.Monad.html#loc_94_1_94_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_94_1_94_7&#39;)"><span class="hl_varref"><span class="mpre">nodesM</span></span></a><span class="mpre"> </span><a href="#loc_204_7_204_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_7_204_9&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">; </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">runGT</span></span></a><span class="mpre"> (</span><a href="#loc_192_1_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_6&#39;)"><span class="hl_varref"><span class="mpre">dfsGT</span></span></a><span class="mpre"> </span><a href="#loc_204_16_204_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_16_204_18&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">) </span><a href="#loc_204_7_204_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_7_204_9&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">}


</span><span class="hl_comment"><span class="mpre">-- | depth-first search yielding dfs forest</span></span><span class="mpre">
</span><a href="#loc_209_1_209_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_5&#39;)"><span class="mpre">dffM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 208, srcSpanStartColumn = 9, srcSpanEndLine = 208, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 208, srcSpanStartColumn = 21, srcSpanEndLine = 208, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">] -&gt; </span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_tyconref"><span class="mpre">GT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) [</span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_209_1_209_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_5&#39;)"><span class="hl_fundecl"><span class="mpre">dffM</span></span></a><span class="mpre"> </span><a name="loc_209_6_209_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_6_209_8&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><a href="#loc_54_17_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_20&#39;)"><span class="hl_conref"><span class="mpre">MGT</span></span></a><span class="mpre"> (\</span><a name="loc_209_17_209_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_17_209_19&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre">-&gt;
          do </span><a name="loc_210_14_210_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_14_210_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">&lt;-</span><a href="#loc_209_17_209_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_17_209_19&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">
             </span><a name="loc_211_14_211_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_14_211_15&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">&lt;-</span><a href="Data.Graph.Inductive.Monad.html#loc_44_3_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_44_3_44_11&#39;)"><span class="hl_varref"><span class="mpre">isEmptyM</span></span></a><span class="mpre"> </span><a href="#loc_209_17_209_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_17_209_19&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">
             if </span><a href="#loc_211_14_211_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_14_211_15&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">||</span></span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_209_6_209_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_6_209_8&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ([],</span><a href="#loc_210_14_210_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_14_210_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) else 
                let (</span><a name="loc_213_22_213_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_22_213_23&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_213_24_213_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_24_213_27&#39;)"><span class="hl_vardecl"><span class="mpre">vs&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_209_6_209_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_6_209_8&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> in
                do (</span><a name="loc_214_21_214_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_21_214_23&#39;)"><span class="hl_vardecl"><span class="mpre">mc</span></span></a><span class="mpre">,</span><a name="loc_214_24_214_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_24_214_26&#39;)"><span class="hl_vardecl"><span class="mpre">g1</span></span></a><span class="mpre">) &lt;- </span><a href="Data.Graph.Inductive.Monad.html#loc_45_3_45_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_45_3_45_9&#39;)"><span class="hl_varref"><span class="mpre">matchM</span></span></a><span class="mpre"> </span><a href="#loc_213_22_213_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_22_213_23&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_209_17_209_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_17_209_19&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">
                   case </span><a href="#loc_214_21_214_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_21_214_23&#39;)"><span class="hl_varref"><span class="mpre">mc</span></span></a><span class="mpre"> of
                     </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> (</span><a href="#loc_209_1_209_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_5&#39;)"><span class="hl_varref"><span class="mpre">dffM</span></span></a><span class="mpre"> </span><a href="#loc_213_24_213_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_24_213_27&#39;)"><span class="hl_varref"><span class="mpre">vs&#39;</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_214_24_214_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_24_214_26&#39;)"><span class="hl_varref"><span class="mpre">g1</span></span></a><span class="mpre">)
                     </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_217_27_217_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_27_217_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  -&gt; do (</span><a name="loc_217_37_217_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_37_217_39&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">, </span><a name="loc_217_41_217_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_41_217_43&#39;)"><span class="hl_vardecl"><span class="mpre">g2</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> (</span><a href="#loc_209_1_209_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_5&#39;)"><span class="hl_varref"><span class="mpre">dffM</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_371_1_371_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_371_1_371_5&#39;)"><span class="hl_varref"><span class="mpre">suc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_217_27_217_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_27_217_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)) (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_214_24_214_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_24_214_26&#39;)"><span class="hl_varref"><span class="mpre">g1</span></span></a><span class="mpre">)
                                   (</span><a name="loc_218_37_218_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_37_218_40&#39;)"><span class="hl_vardecl"><span class="mpre">ts&#39;</span></span></a><span class="mpre">,</span><a name="loc_218_41_218_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_41_218_43&#39;)"><span class="hl_vardecl"><span class="mpre">g3</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> (</span><a href="#loc_209_1_209_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_5&#39;)"><span class="hl_varref"><span class="mpre">dffM</span></span></a><span class="mpre"> </span><a href="#loc_213_24_213_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_24_213_27&#39;)"><span class="hl_varref"><span class="mpre">vs&#39;</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_217_41_217_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_41_217_43&#39;)"><span class="hl_varref"><span class="mpre">g2</span></span></a><span class="mpre">)
                                   </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_355_1_355_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_355_1_355_6&#39;)"><span class="hl_varref"><span class="mpre">node&#39;</span></span></a><span class="mpre"> </span><a href="#loc_217_27_217_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_27_217_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_217_37_217_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_37_217_39&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_218_37_218_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_37_218_40&#39;)"><span class="hl_varref"><span class="mpre">ts&#39;</span></span></a><span class="mpre">,</span><a href="#loc_218_41_218_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_41_218_43&#39;)"><span class="hl_varref"><span class="mpre">g3</span></span></a><span class="mpre">)
          )

</span><a href="#loc_223_1_223_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_9&#39;)"><span class="mpre">graphDff</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 222, srcSpanStartColumn = 13, srcSpanEndLine = 222, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 222, srcSpanStartColumn = 25, srcSpanEndLine = 222, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_223_1_223_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_9&#39;)"><span class="hl_fundecl"><span class="mpre">graphDff</span></span></a><span class="mpre"> </span><a name="loc_223_10_223_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_10_223_12&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">runGT</span></span></a><span class="mpre"> (</span><a href="#loc_209_1_209_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_5&#39;)"><span class="hl_varref"><span class="mpre">dffM</span></span></a><span class="mpre"> </span><a href="#loc_223_10_223_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_10_223_12&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">)

</span><a href="#loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="mpre">graphDff&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 225, srcSpanStartColumn = 14, srcSpanEndLine = 225, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/Monad.hs&quot;, srcSpanStartLine = 225, srcSpanStartColumn = 26, srcSpanEndLine = 225, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">GraphM m gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="hl_fundecl"><span class="mpre">graphDff&#39;</span></span></a><span class="mpre"> </span><a name="loc_226_11_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_11_226_13&#39;)"><span class="hl_vardecl"><span class="mpre">mg</span></span></a><span class="mpre"> = do {</span><a name="loc_226_20_226_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_20_226_22&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Graph.Inductive.Monad.html#loc_94_1_94_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_94_1_94_7&#39;)"><span class="hl_varref"><span class="mpre">nodesM</span></span></a><span class="mpre"> </span><a href="#loc_226_11_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_11_226_13&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">; </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">runGT</span></span></a><span class="mpre"> (</span><a href="#loc_209_1_209_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_5&#39;)"><span class="hl_varref"><span class="mpre">dffM</span></span></a><span class="mpre"> </span><a href="#loc_226_20_226_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_20_226_22&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">) </span><a href="#loc_226_11_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_11_226_13&#39;)"><span class="hl_varref"><span class="mpre">mg</span></span></a><span class="mpre">}

</span></div></body></html>