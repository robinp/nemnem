<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module System.IO.Streams.Tests.Concurrent (tests) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 4, srcSpanStartColumn = 18, srcSpanEndLine = 4, srcSpanEndColumn = 36}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre">
import           Control.Monad
import           Prelude                              hiding (</span><a href="Data.List.html#loc_1044_1_1044_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1044_1_1044_6&#39;)"><span class="mpre">lines</span></a><span class="mpre">, </span><a href="Text.Read.html#loc_91_1_91_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.html#loc_91_1_91_5&#39;)"><span class="mpre">read</span></a><span class="mpre">,
                                                       takeWhile, </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="mpre">unlines</span></a><span class="mpre">,
                                                       </span><a href="Data.List.html#loc_1081_1_1081_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1081_1_1081_8&#39;)"><span class="mpre">unwords</span></a><span class="mpre">, </span><a href="Data.List.html#loc_1081_1_1081_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1081_1_1081_8&#39;)"><span class="mpre">unwords</span></a><span class="mpre">,
                                                       </span><a href="Data.List.html#loc_1071_1_1071_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1071_1_1071_6&#39;)"><span class="mpre">words</span></a><span class="mpre">)
import qualified Prelude
import qualified System.IO.Streams                    as Streams
import qualified System.IO.Streams.Concurrent         as Streams
import           System.IO.Streams.Tests.Common
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Test.Framework&quot;"><span class="mpre">Test.Framework</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 18, srcSpanEndLine = 15, srcSpanEndColumn = 48}, srcInfoPoints = []}) &quot;Test.Framework.Providers.HUnit&quot;"><span class="mpre">Test.Framework.Providers.HUnit</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 18, srcSpanEndLine = 16, srcSpanEndColumn = 54}, srcInfoPoints = []}) &quot;Test.Framework.Providers.QuickCheck2&quot;"><span class="mpre">Test.Framework.Providers.QuickCheck2</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 18, srcSpanEndLine = 17, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">                           hiding (Test)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 18, srcSpanEndLine = 18, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre">                      hiding (output)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 18, srcSpanEndLine = 19, srcSpanEndColumn = 41}, srcInfoPoints = []}) &quot;Test.QuickCheck.Monadic&quot;"><span class="mpre">Test.QuickCheck.Monadic</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_23_1_23_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_6&#39;)"><span class="mpre">tests</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">]
</span><a name="loc_23_1_23_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = [ </span><a href="#loc_32_1_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_17&#39;)"><span class="hl_varref"><span class="mpre">testMakeChanPipe</span></span></a><span class="mpre">
        , </span><a href="#loc_45_1_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_20&#39;)"><span class="hl_varref"><span class="mpre">testConcurrentMerge</span></span></a><span class="mpre">
        , </span><a href="#loc_77_1_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_29&#39;)"><span class="hl_varref"><span class="mpre">testConcurrentMergeException</span></span></a><span class="mpre">
        , </span><a href="#loc_86_1_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_16&#39;)"><span class="hl_varref"><span class="mpre">testInputOutput</span></span></a><span class="mpre">
        ]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_32_1_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_17&#39;)"><span class="mpre">testMakeChanPipe</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_32_1_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_17&#39;)"><span class="hl_vardecl"><span class="mpre">testMakeChanPipe</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;concurrent/makeChanPipe&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                   </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                   </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_37_5_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_37_5_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_37_5_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_37_10_37_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_38_10_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_10_38_12&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">, </span><a name="loc_38_14_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_14_38_16&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.Concurrent.html#loc_98_1_98_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Concurrent.html#loc_98_1_98_13&#39;)"><span class="hl_varref"><span class="mpre">Streams.makeChanPipe</span></span></a><span class="mpre">
        _        &lt;- </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">Streams.writeList</span></span></a><span class="mpre"> </span><a href="#loc_37_10_37_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_38_14_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_14_38_16&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_38_14_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_14_38_16&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre"> </span><a href="#loc_38_10_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_10_38_12&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makeChanPipe&quot;</span></span><span class="mpre"> </span><a href="#loc_37_10_37_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_10_37_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_45_1_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_20&#39;)"><span class="mpre">testConcurrentMerge</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_45_1_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_20&#39;)"><span class="hl_vardecl"><span class="mpre">testConcurrentMerge</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;concurrent/concurrentMerge&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_46_5_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_10&#39;)"><span class="hl_vardecl"><span class="mpre">mvars</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><a href="#loc_62_5_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_13&#39;)"><span class="hl_varref"><span class="mpre">nthreads</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span><span class="mpre">
    </span><a name="loc_47_5_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_10&#39;)"><span class="hl_vardecl"><span class="mpre">chans</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><a href="#loc_62_5_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_13&#39;)"><span class="hl_varref"><span class="mpre">nthreads</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newChan</span></span><span class="mpre">
    let </span><a name="loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_vardecl"><span class="mpre">firstMVar</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_46_5_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_10&#39;)"><span class="hl_varref"><span class="mpre">mvars</span></span></a><span class="mpre">

    </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_64_5_64_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_9&#39;)"><span class="hl_varref"><span class="mpre">ring</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">zip3</span></span><span class="mpre"> </span><a href="#loc_46_5_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_10&#39;)"><span class="hl_varref"><span class="mpre">mvars</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_62_5_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_13&#39;)"><span class="hl_varref"><span class="mpre">nthreads</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cycle</span></span><span class="mpre"> </span><a href="#loc_46_5_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_10&#39;)"><span class="hl_varref"><span class="mpre">mvars</span></span></a><span class="mpre">)
                                 </span><a href="#loc_47_5_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_10&#39;)"><span class="hl_varref"><span class="mpre">chans</span></span></a><span class="mpre">
    </span><a name="loc_52_5_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_5_52_11&#39;)"><span class="hl_vardecl"><span class="mpre">inputs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Concurrent.html#loc_42_1_42_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Concurrent.html#loc_42_1_42_12&#39;)"><span class="hl_varref"><span class="mpre">Streams.chanToInput</span></span></a><span class="mpre"> </span><a href="#loc_47_5_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_10&#39;)"><span class="hl_varref"><span class="mpre">chans</span></span></a><span class="mpre">
    </span><a name="loc_53_5_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_15&#39;)"><span class="hl_vardecl"><span class="mpre">resultMVar</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Concurrent.html#loc_63_1_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Concurrent.html#loc_63_1_63_16&#39;)"><span class="hl_varref"><span class="mpre">Streams.concurrentMerge</span></span></a><span class="mpre"> </span><a href="#loc_52_5_52_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_5_52_11&#39;)"><span class="hl_varref"><span class="mpre">inputs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre">
                                           </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">putMVar</span></span><span class="mpre"> </span><a href="#loc_53_5_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_15&#39;)"><span class="hl_varref"><span class="mpre">resultMVar</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">putMVar</span></span><span class="mpre"> </span><a href="#loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_varref"><span class="mpre">firstMVar</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a name="loc_57_5_57_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_11&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">takeMVar</span></span><span class="mpre"> </span><a href="#loc_53_5_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_15&#39;)"><span class="hl_varref"><span class="mpre">resultMVar</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;concurrent merge&quot;</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 36, srcSpanEndLine = 58, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 36, srcSpanEndLine = 58, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull"><span class="mpre">[0..10]</span></span><span class="mpre"> </span><a href="#loc_57_5_57_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_11&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">

  where
    </span><a name="loc_61_5_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_11&#39;)"><span class="hl_vardecl"><span class="mpre">maxval</span></span></a><span class="mpre">   = </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a name="loc_62_5_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_13&#39;)"><span class="hl_vardecl"><span class="mpre">nthreads</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">

    </span><a name="loc_64_5_64_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_9&#39;)"><span class="hl_fundecl"><span class="mpre">ring</span></span></a><span class="mpre"> (</span><a name="loc_64_11_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_15&#39;)"><span class="hl_vardecl"><span class="mpre">prev</span></span></a><span class="mpre">, </span><a name="loc_64_17_64_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_21&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre">, </span><a name="loc_64_23_64_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_23_64_27&#39;)"><span class="hl_vardecl"><span class="mpre">chan</span></span></a><span class="mpre">) = </span><a href="#loc_66_9_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
      where
        </span><a name="loc_66_9_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_13&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = do </span><a name="loc_66_19_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_19_66_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">takeMVar</span></span><span class="mpre"> </span><a href="#loc_64_11_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_11_64_15&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre">
                  if </span><a href="#loc_66_19_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_19_66_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_61_5_61_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_11&#39;)"><span class="hl_varref"><span class="mpre">maxval</span></span></a><span class="mpre">
                    then do </span><span class="hl_varref"><span class="mpre">writeChan</span></span><span class="mpre"> </span><a href="#loc_64_23_64_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_23_64_27&#39;)"><span class="hl_varref"><span class="mpre">chan</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
                            </span><span class="hl_varref"><span class="mpre">putMVar</span></span><span class="mpre"> </span><a href="#loc_64_17_64_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_21&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_66_19_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_19_66_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                    else do </span><span class="hl_varref"><span class="mpre">writeChan</span></span><span class="mpre"> </span><a href="#loc_64_23_64_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_23_64_27&#39;)"><span class="hl_varref"><span class="mpre">chan</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_66_19_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_19_66_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                            </span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100000</span></span><span class="mpre">
                            </span><span class="hl_varref"><span class="mpre">putMVar</span></span><span class="mpre"> </span><a href="#loc_64_17_64_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_21&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_66_19_66_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_19_66_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                            </span><a href="#loc_66_9_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_77_1_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_29&#39;)"><span class="mpre">testConcurrentMergeException</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_77_1_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_29&#39;)"><span class="hl_vardecl"><span class="mpre">testConcurrentMergeException</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;concurrent/concurrentMerge/exception&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_79_9_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_12&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">Streams.makeInputStream</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bad&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
               </span><a href="System.IO.Streams.Concurrent.html#loc_63_1_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Concurrent.html#loc_63_1_63_16&#39;)"><span class="hl_varref"><span class="mpre">Streams.concurrentMerge</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[])
        </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre"> </span><a href="#loc_79_9_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_12&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_86_1_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_16&#39;)"><span class="mpre">testInputOutput</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_86_1_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_16&#39;)"><span class="hl_vardecl"><span class="mpre">testInputOutput</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;concurrent/input-output&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_87_5_87_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">   &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 30, srcSpanEndLine = 87, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 30, srcSpanEndLine = 87, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull"><span class="mpre">[1..10::Int]</span></span><span class="mpre">
    </span><a name="loc_88_5_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_5_88_9&#39;)"><span class="hl_vardecl"><span class="mpre">chan</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newChan</span></span><span class="mpre">
    </span><a name="loc_89_5_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_8&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.Concurrent.html#loc_42_1_42_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Concurrent.html#loc_42_1_42_12&#39;)"><span class="hl_varref"><span class="mpre">Streams.chanToInput</span></span></a><span class="mpre"> </span><a href="#loc_88_5_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_5_88_9&#39;)"><span class="hl_varref"><span class="mpre">chan</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Concurrent.html#loc_30_1_30_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Concurrent.html#loc_30_1_30_12&#39;)"><span class="hl_varref"><span class="mpre">Streams.inputToChan</span></span></a><span class="mpre"> </span><a href="#loc_87_5_87_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><a href="#loc_88_5_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_5_88_9&#39;)"><span class="hl_varref"><span class="mpre">chan</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre"> </span><a href="#loc_89_5_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_8&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;input-output&quot;</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 55, srcSpanEndLine = 91, srcSpanEndColumn = 62}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Concurrent.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 55, srcSpanEndLine = 91, srcSpanEndColumn = 56},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull"><span class="mpre">[1..10]</span></span><span class="mpre">
</span></div></body></html>