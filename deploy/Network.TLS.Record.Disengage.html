<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Record.Disengage</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Disengage a record from the Record layer.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The record is decrypted, checked for integrity and then decompressed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Record.Disengage
        ( disengageRecord
        ) where

import Control.Monad.State
import Control.Monad.Error

import Network.TLS.Struct
import Network.TLS.Cap
import Network.TLS.Record.State
import Network.TLS.Record.Types
import Network.TLS.Cipher
import Network.TLS.Compression
import Network.TLS.Util
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B

</span><a href="#loc_29_1_29_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_16&#39;)"><span class="mpre">disengageRecord</span></a><span class="mpre"> :: </span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_53_6_53_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_53_6_53_16&#39;)"><span class="hl_tyconref"><span class="mpre">Ciphertext</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_51_6_51_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_51_6_51_15&#39;)"><span class="hl_tyconref"><span class="mpre">Plaintext</span></span></a><span class="mpre">)
</span><a name="loc_29_1_29_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_16&#39;)"><span class="hl_vardecl"><span class="mpre">disengageRecord</span></span></a><span class="mpre"> = </span><a href="#loc_36_1_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_14&#39;)"><span class="hl_varref"><span class="mpre">decryptRecord</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_180_3_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_180_3_180_6&#39;)"><span class="hl_infix"><span class="mpre">&gt;=&gt;</span></span></a><span class="mpre"> </span><a href="#loc_32_1_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_17&#39;)"><span class="hl_varref"><span class="mpre">uncompressRecord</span></span></a><span class="mpre">

</span><a href="#loc_32_1_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_17&#39;)"><span class="mpre">uncompressRecord</span></a><span class="mpre"> :: </span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_52_6_52_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_52_6_52_16&#39;)"><span class="hl_tyconref"><span class="mpre">Compressed</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_51_6_51_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_51_6_51_15&#39;)"><span class="hl_tyconref"><span class="mpre">Plaintext</span></span></a><span class="mpre">)
</span><a name="loc_32_1_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_17&#39;)"><span class="hl_fundecl"><span class="mpre">uncompressRecord</span></span></a><span class="mpre"> </span><a name="loc_32_18_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_24&#39;)"><span class="hl_vardecl"><span class="mpre">record</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Record.Types.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">onRecordFragment</span></span></a><span class="mpre"> </span><a href="#loc_32_18_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_24&#39;)"><span class="hl_varref"><span class="mpre">record</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_84_1_84_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_84_1_84_19&#39;)"><span class="hl_varref"><span class="mpre">fragmentUncompress</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_32_75_32_80" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_75_32_80&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> -&gt;
    </span><a href="Network.TLS.Record.State.html#loc_111_1_111_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_111_1_111_16&#39;)"><span class="hl_varref"><span class="mpre">withCompression</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Compression.html#loc_52_1_52_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Compression.html#loc_52_1_52_19&#39;)"><span class="hl_varref"><span class="mpre">compressionInflate</span></span></a><span class="mpre"> </span><a href="#loc_32_75_32_80" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_75_32_80&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">

</span><a href="#loc_36_1_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_14&#39;)"><span class="mpre">decryptRecord</span></a><span class="mpre"> :: </span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_53_6_53_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_53_6_53_16&#39;)"><span class="hl_tyconref"><span class="mpre">Ciphertext</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_52_6_52_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_52_6_52_16&#39;)"><span class="hl_tyconref"><span class="mpre">Compressed</span></span></a><span class="mpre">)
</span><a name="loc_36_1_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_14&#39;)"><span class="hl_fundecl"><span class="mpre">decryptRecord</span></span></a><span class="mpre"> </span><a name="loc_36_15_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_15_36_21&#39;)"><span class="hl_vardecl"><span class="mpre">record</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Record.Types.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">onRecordFragment</span></span></a><span class="mpre"> </span><a href="#loc_36_15_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_15_36_21&#39;)"><span class="hl_varref"><span class="mpre">record</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_80_1_80_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_80_1_80_17&#39;)"><span class="hl_varref"><span class="mpre">fragmentUncipher</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_36_70_36_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_70_36_71&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; do
    </span><a name="loc_37_5_37_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_7&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
    case </span><a href="Network.TLS.Record.State.html#loc_51_7_51_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_51_7_51_15&#39;)"><span class="hl_varref"><span class="mpre">stCipher</span></span></a><span class="mpre"> </span><a href="#loc_37_5_37_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_7&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_36_70_36_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_70_36_71&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
        _       -&gt; </span><a href="Network.TLS.Record.State.html#loc_79_1_79_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_79_1_79_17&#39;)"><span class="hl_varref"><span class="mpre">getRecordVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_40_42_40_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_42_40_45&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="hl_varref"><span class="mpre">decryptData</span></span></a><span class="mpre"> </span><a href="#loc_40_42_40_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_42_40_45&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a href="#loc_36_15_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_15_36_21&#39;)"><span class="hl_varref"><span class="mpre">record</span></span></a><span class="mpre"> </span><a href="#loc_36_70_36_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_70_36_71&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_37_5_37_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_7&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">

</span><a href="#loc_43_1_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_14&#39;)"><span class="mpre">getCipherData</span></a><span class="mpre"> :: </span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_69_6_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_69_6_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">CipherData</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_43_1_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_14&#39;)"><span class="hl_fundecl"><span class="mpre">getCipherData</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Record.Types.html#loc_47_17_47_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_17_47_23&#39;)"><span class="hl_conref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a name="loc_43_23_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_23_43_25&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a name="loc_43_26_43_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_26_43_29&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> _) </span><a name="loc_43_33_43_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_33_43_38&#39;)"><span class="hl_vardecl"><span class="mpre">cdata</span></span></a><span class="mpre"> = do
    </span><span class="hl_comment"><span class="mpre">-- check if the MAC is valid.</span></span><span class="mpre">
    </span><a name="loc_45_5_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_13&#39;)"><span class="hl_vardecl"><span class="mpre">macValid</span></span></a><span class="mpre"> &lt;- case </span><a href="Network.TLS.Struct.html#loc_71_7_71_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_71_7_71_20&#39;)"><span class="hl_varref"><span class="mpre">cipherDataMAC</span></span></a><span class="mpre"> </span><a href="#loc_43_33_43_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_33_43_38&#39;)"><span class="hl_varref"><span class="mpre">cdata</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">     -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_47_14_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_14_47_20&#39;)"><span class="hl_vardecl"><span class="mpre">digest</span></span></a><span class="mpre"> -&gt; do
            let </span><a name="loc_48_17_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_24&#39;)"><span class="hl_vardecl"><span class="mpre">new_hdr</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_43_23_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_23_43_25&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a href="#loc_43_26_43_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_26_43_29&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_70_7_70_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_70_7_70_24&#39;)"><span class="hl_varref"><span class="mpre">cipherDataContent</span></span></a><span class="mpre"> </span><a href="#loc_43_33_43_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_33_43_38&#39;)"><span class="hl_varref"><span class="mpre">cdata</span></span></a><span class="mpre">)
            </span><a name="loc_49_13_49_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_13_49_28&#39;)"><span class="hl_vardecl"><span class="mpre">expected_digest</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Record.State.html#loc_130_1_130_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_130_1_130_11&#39;)"><span class="hl_varref"><span class="mpre">makeDigest</span></span></a><span class="mpre"> </span><a href="#loc_48_17_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_24&#39;)"><span class="hl_varref"><span class="mpre">new_hdr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_70_7_70_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_70_7_70_24&#39;)"><span class="hl_varref"><span class="mpre">cipherDataContent</span></span></a><span class="mpre"> </span><a href="#loc_43_33_43_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_33_43_38&#39;)"><span class="hl_varref"><span class="mpre">cdata</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_49_13_49_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_13_49_28&#39;)"><span class="hl_varref"><span class="mpre">expected_digest</span></span></a><span class="mpre"> </span><a href="Network.TLS.Util.html#loc_71_1_71_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Util.html#loc_71_1_71_8&#39;)"><span class="hl_infix"><span class="mpre">`bytesEq`</span></span></a><span class="mpre"> </span><a href="#loc_47_14_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_14_47_20&#39;)"><span class="hl_varref"><span class="mpre">digest</span></span></a><span class="mpre">)

    </span><span class="hl_comment"><span class="mpre">-- check if the padding is filled with the correct pattern if it exists</span></span><span class="mpre">
    </span><a name="loc_53_5_53_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_17&#39;)"><span class="hl_vardecl"><span class="mpre">paddingValid</span></span></a><span class="mpre"> &lt;- case </span><a href="Network.TLS.Struct.html#loc_72_7_72_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_72_7_72_24&#39;)"><span class="hl_varref"><span class="mpre">cipherDataPadding</span></span></a><span class="mpre"> </span><a href="#loc_43_33_43_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_33_43_38&#39;)"><span class="hl_varref"><span class="mpre">cdata</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_55_14_55_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_14_55_17&#39;)"><span class="hl_vardecl"><span class="mpre">pad</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_56_13_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_17&#39;)"><span class="hl_vardecl"><span class="mpre">cver</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Record.State.html#loc_79_1_79_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_79_1_79_17&#39;)"><span class="hl_varref"><span class="mpre">getRecordVersion</span></span></a><span class="mpre">
            let </span><a name="loc_57_17_57_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_18&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_55_14_55_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_14_55_17&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (if </span><a href="#loc_56_13_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_13_56_17&#39;)"><span class="hl_varref"><span class="mpre">cver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS10</span></span><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_55_14_55_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_14_55_17&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_57_17_57_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="Network.TLS.Util.html#loc_71_1_71_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Util.html#loc_71_1_71_8&#39;)"><span class="hl_infix"><span class="mpre">`bytesEq`</span></span></a><span class="mpre"> </span><a href="#loc_55_14_55_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_14_55_17&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre">)

    </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_45_5_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_13&#39;)"><span class="hl_varref"><span class="mpre">macValid</span></span></a><span class="mpre"> </span><a href="Network.TLS.Util.html#loc_62_7_62_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Util.html#loc_62_7_62_10&#39;)"><span class="hl_infix"><span class="mpre">&amp;&amp;!</span></span></a><span class="mpre"> </span><a href="#loc_53_5_53_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_17&#39;)"><span class="hl_varref"><span class="mpre">paddingValid</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_123_7_123_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_123_7_123_21&#39;)"><span class="hl_conref"><span class="mpre">Error_Protocol</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;bad record mac&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_184_7_184_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_184_7_184_19&#39;)"><span class="hl_conref"><span class="mpre">BadRecordMac</span></span></a><span class="mpre">)

    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_70_7_70_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_70_7_70_24&#39;)"><span class="hl_varref"><span class="mpre">cipherDataContent</span></span></a><span class="mpre"> </span><a href="#loc_43_33_43_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_33_43_38&#39;)"><span class="hl_varref"><span class="mpre">cdata</span></span></a><span class="mpre">

</span><a href="#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="mpre">decryptData</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_53_6_53_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_53_6_53_16&#39;)"><span class="hl_tyconref"><span class="mpre">Ciphertext</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_50_6_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_50_6_50_17&#39;)"><span class="hl_tyconref"><span class="mpre">RecordState</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="hl_fundecl"><span class="mpre">decryptData</span></span></a><span class="mpre"> </span><a name="loc_66_13_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_16&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a name="loc_66_17_66_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_23&#39;)"><span class="hl_vardecl"><span class="mpre">record</span></span></a><span class="mpre"> </span><a name="loc_66_24_66_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_24_66_32&#39;)"><span class="hl_vardecl"><span class="mpre">econtent</span></span></a><span class="mpre"> </span><a name="loc_66_33_66_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_33_66_36&#39;)"><span class="hl_vardecl"><span class="mpre">tst</span></span></a><span class="mpre"> = </span><a href="#loc_80_9_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_18&#39;)"><span class="hl_varref"><span class="mpre">decryptOf</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Cipher.html#loc_58_7_58_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_58_7_58_12&#39;)"><span class="hl_varref"><span class="mpre">bulkF</span></span></a><span class="mpre"> </span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_varref"><span class="mpre">bulk</span></span></a><span class="mpre">)
  where </span><a name="loc_67_9_67_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_15&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre">     = </span><a href="Network.TLS.Util.html#loc_53_1_53_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Util.html#loc_53_1_53_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;cipher&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Record.State.html#loc_51_7_51_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_51_7_51_15&#39;)"><span class="hl_varref"><span class="mpre">stCipher</span></span></a><span class="mpre"> </span><a href="#loc_66_33_66_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_33_66_36&#39;)"><span class="hl_varref"><span class="mpre">tst</span></span></a><span class="mpre">
        </span><a name="loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_vardecl"><span class="mpre">bulk</span></span></a><span class="mpre">       = </span><a href="Network.TLS.Cipher.html#loc_86_7_86_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_86_7_86_17&#39;)"><span class="hl_varref"><span class="mpre">cipherBulk</span></span></a><span class="mpre"> </span><a href="#loc_67_9_67_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_15&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">
        </span><a name="loc_69_9_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_12&#39;)"><span class="hl_vardecl"><span class="mpre">cst</span></span></a><span class="mpre">        = </span><a href="Network.TLS.Record.State.html#loc_53_7_53_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_53_7_53_19&#39;)"><span class="hl_varref"><span class="mpre">stCryptState</span></span></a><span class="mpre"> </span><a href="#loc_66_33_66_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_33_66_36&#39;)"><span class="hl_varref"><span class="mpre">tst</span></span></a><span class="mpre">
        </span><a name="loc_70_9_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_16&#39;)"><span class="hl_vardecl"><span class="mpre">macSize</span></span></a><span class="mpre">    = </span><a href="Network.TLS.Cipher.html#loc_72_7_72_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_72_7_72_15&#39;)"><span class="hl_varref"><span class="mpre">hashSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Cipher.html#loc_85_7_85_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_85_7_85_17&#39;)"><span class="hl_varref"><span class="mpre">cipherHash</span></span></a><span class="mpre"> </span><a href="#loc_67_9_67_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_15&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">
        </span><a name="loc_71_9_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_17&#39;)"><span class="hl_vardecl"><span class="mpre">writekey</span></span></a><span class="mpre">   = </span><a href="Network.TLS.Record.State.html#loc_41_7_41_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_41_7_41_13&#39;)"><span class="hl_varref"><span class="mpre">cstKey</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_12&#39;)"><span class="hl_varref"><span class="mpre">cst</span></span></a><span class="mpre">
        </span><a name="loc_72_9_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_18&#39;)"><span class="hl_vardecl"><span class="mpre">blockSize</span></span></a><span class="mpre">  = </span><a href="Network.TLS.Cipher.html#loc_57_7_57_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_57_7_57_20&#39;)"><span class="hl_varref"><span class="mpre">bulkBlockSize</span></span></a><span class="mpre"> </span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_varref"><span class="mpre">bulk</span></span></a><span class="mpre">
        </span><a name="loc_73_9_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_20&#39;)"><span class="hl_vardecl"><span class="mpre">econtentLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_66_24_66_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_24_66_32&#39;)"><span class="hl_varref"><span class="mpre">econtent</span></span></a><span class="mpre">

        </span><a name="loc_75_9_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_19&#39;)"><span class="hl_vardecl"><span class="mpre">explicitIV</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Cap.html#loc_19_1_19_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cap.html#loc_19_1_19_19&#39;)"><span class="hl_varref"><span class="mpre">hasExplicitBlockIV</span></span></a><span class="mpre"> </span><a href="#loc_66_13_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_16&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre">

        </span><a name="loc_77_9_77_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_25&#39;)"><span class="hl_vardecl"><span class="mpre">sanityCheckError</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_127_7_127_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_127_7_127_19&#39;)"><span class="hl_conref"><span class="mpre">Error_Packet</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;encrypted content too small for encryption parameters&quot;</span></span><span class="mpre">)

        </span><a href="#loc_80_9_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_18&#39;)"><span class="mpre">decryptOf</span></a><span class="mpre"> :: </span><a href="Network.TLS.Cipher.html#loc_33_6_33_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_33_6_33_19&#39;)"><span class="hl_tyconref"><span class="mpre">BulkFunctions</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
        </span><a name="loc_80_9_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_18&#39;)"><span class="hl_fundecl"><span class="mpre">decryptOf</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Cipher.html#loc_34_7_34_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_34_7_34_17&#39;)"><span class="hl_conref"><span class="mpre">BulkBlockF</span></span></a><span class="mpre"> _ </span><a name="loc_80_33_80_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_33_80_41&#39;)"><span class="hl_vardecl"><span class="mpre">decryptF</span></span></a><span class="mpre">) = do
            let </span><a name="loc_81_17_81_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_27&#39;)"><span class="hl_vardecl"><span class="mpre">minContent</span></span></a><span class="mpre"> = (if </span><a href="#loc_75_9_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_19&#39;)"><span class="hl_varref"><span class="mpre">explicitIV</span></span></a><span class="mpre"> then </span><a href="Network.TLS.Cipher.html#loc_56_7_56_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_56_7_56_17&#39;)"><span class="hl_varref"><span class="mpre">bulkIVSize</span></span></a><span class="mpre"> </span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_varref"><span class="mpre">bulk</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_70_9_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_16&#39;)"><span class="hl_varref"><span class="mpre">macSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_72_9_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_18&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre">
            </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> ((</span><a href="#loc_73_9_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_20&#39;)"><span class="hl_varref"><span class="mpre">econtentLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_72_9_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_18&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_73_9_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_20&#39;)"><span class="hl_varref"><span class="mpre">econtentLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_81_17_81_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_27&#39;)"><span class="hl_varref"><span class="mpre">minContent</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_77_9_77_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_25&#39;)"><span class="hl_varref"><span class="mpre">sanityCheckError</span></span></a><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">{- update IV -}</span></span><span class="mpre">
            (</span><a name="loc_84_14_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_14_84_16&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre">, </span><a name="loc_84_18_84_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_18_84_27&#39;)"><span class="hl_vardecl"><span class="mpre">econtent&#39;</span></span></a><span class="mpre">) &lt;- if </span><a href="#loc_75_9_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_19&#39;)"><span class="hl_varref"><span class="mpre">explicitIV</span></span></a><span class="mpre">
                                  then </span><a href="#loc_114_9_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_13&#39;)"><span class="hl_varref"><span class="mpre">get2</span></span></a><span class="mpre"> </span><a href="#loc_66_24_66_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_24_66_32&#39;)"><span class="hl_varref"><span class="mpre">econtent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Cipher.html#loc_56_7_56_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_56_7_56_17&#39;)"><span class="hl_varref"><span class="mpre">bulkIVSize</span></span></a><span class="mpre"> </span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_varref"><span class="mpre">bulk</span></span></a><span class="mpre">, </span><a href="#loc_73_9_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_20&#39;)"><span class="hl_varref"><span class="mpre">econtentLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="Network.TLS.Cipher.html#loc_56_7_56_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_56_7_56_17&#39;)"><span class="hl_varref"><span class="mpre">bulkIVSize</span></span></a><span class="mpre"> </span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_varref"><span class="mpre">bulk</span></span></a><span class="mpre">)
                                  else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Network.TLS.Record.State.html#loc_42_7_42_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_42_7_42_12&#39;)"><span class="hl_varref"><span class="mpre">cstIV</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_12&#39;)"><span class="hl_varref"><span class="mpre">cst</span></span></a><span class="mpre">, </span><a href="#loc_66_24_66_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_24_66_32&#39;)"><span class="hl_varref"><span class="mpre">econtent</span></span></a><span class="mpre">)
            let </span><span class="hl_vardecl"><span class="mpre">newiv</span></span><span class="mpre"> = </span><a href="Network.TLS.Util.html#loc_53_1_53_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Util.html#loc_53_1_53_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;new iv&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Util.html#loc_28_1_28_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Util.html#loc_28_1_28_9&#39;)"><span class="hl_varref"><span class="mpre">takelast</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Cipher.html#loc_57_7_57_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_57_7_57_20&#39;)"><span class="hl_varref"><span class="mpre">bulkBlockSize</span></span></a><span class="mpre"> </span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_varref"><span class="mpre">bulk</span></span></a><span class="mpre">) </span><a href="#loc_84_18_84_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_18_84_27&#39;)"><span class="hl_varref"><span class="mpre">econtent&#39;</span></span></a><span class="mpre">
            </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">txs</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 30, srcSpanEndLine = 88, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 34, srcSpanEndLine = 88, srcSpanEndColumn = 35},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.h"><span class="mpre">txs { stCryptState = cst { cstIV = newiv } }</span></span><span class="mpre">

            let </span><a name="loc_90_17_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_17_90_25&#39;)"><span class="hl_vardecl"><span class="mpre">content&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_80_33_80_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_33_80_41&#39;)"><span class="hl_varref"><span class="mpre">decryptF</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_17&#39;)"><span class="hl_varref"><span class="mpre">writekey</span></span></a><span class="mpre"> </span><a href="#loc_84_14_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_14_84_16&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_84_18_84_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_18_84_27&#39;)"><span class="hl_varref"><span class="mpre">econtent&#39;</span></span></a><span class="mpre">
            let </span><a name="loc_91_17_91_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_17_91_30&#39;)"><span class="hl_vardecl"><span class="mpre">paddinglength</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.last</span></span><span class="mpre"> </span><a href="#loc_90_17_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_17_90_25&#39;)"><span class="hl_varref"><span class="mpre">content&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            let </span><a name="loc_92_17_92_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_17_92_27&#39;)"><span class="hl_vardecl"><span class="mpre">contentlen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_90_17_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_17_90_25&#39;)"><span class="hl_varref"><span class="mpre">content&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_91_17_91_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_17_91_30&#39;)"><span class="hl_varref"><span class="mpre">paddinglength</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_70_9_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_16&#39;)"><span class="hl_varref"><span class="mpre">macSize</span></span></a><span class="mpre">
            (</span><span class="hl_vardecl"><span class="mpre">content</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">mac</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">padding</span></span><span class="mpre">) &lt;- </span><a href="#loc_113_9_113_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_13&#39;)"><span class="hl_varref"><span class="mpre">get3</span></span></a><span class="mpre"> </span><a href="#loc_90_17_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_17_90_25&#39;)"><span class="hl_varref"><span class="mpre">content&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_92_17_92_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_17_92_27&#39;)"><span class="hl_varref"><span class="mpre">contentlen</span></span></a><span class="mpre">, </span><a href="#loc_70_9_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_16&#39;)"><span class="hl_varref"><span class="mpre">macSize</span></span></a><span class="mpre">, </span><a href="#loc_91_17_91_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_17_91_30&#39;)"><span class="hl_varref"><span class="mpre">paddinglength</span></span></a><span class="mpre">)
            </span><a href="#loc_43_1_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_14&#39;)"><span class="hl_varref"><span class="mpre">getCipherData</span></span></a><span class="mpre"> </span><a href="#loc_66_17_66_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_23&#39;)"><span class="hl_varref"><span class="mpre">record</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 36, srcSpanEndLine = 98, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 21, srcSpanEndLine = 95, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.h"><span class="mpre">CipherData
                    { cipherDataContent = content
                    , cipherDataMAC     = Just mac
                    , cipherDataPadding = Just padding
                    }</span></span><span class="mpre">

        </span><a href="#loc_80_9_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_18&#39;)"><span class="hl_fundecl"><span class="mpre">decryptOf</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Cipher.html#loc_36_7_36_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_36_7_36_18&#39;)"><span class="hl_conref"><span class="mpre">BulkStreamF</span></span></a><span class="mpre"> </span><a name="loc_100_32_100_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_32_100_37&#39;)"><span class="hl_vardecl"><span class="mpre">initF</span></span></a><span class="mpre"> _ </span><a name="loc_100_40_100_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_40_100_48&#39;)"><span class="hl_vardecl"><span class="mpre">decryptF</span></span></a><span class="mpre">) = do
            </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_73_9_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_20&#39;)"><span class="hl_varref"><span class="mpre">econtentLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_70_9_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_16&#39;)"><span class="hl_varref"><span class="mpre">macSize</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_77_9_77_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_25&#39;)"><span class="hl_varref"><span class="mpre">sanityCheckError</span></span></a><span class="mpre">
            let (</span><a name="loc_102_18_102_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_26&#39;)"><span class="hl_vardecl"><span class="mpre">content&#39;</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">newiv</span></span><span class="mpre">) = </span><a href="#loc_100_40_100_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_40_100_48&#39;)"><span class="hl_varref"><span class="mpre">decryptF</span></span></a><span class="mpre"> (if </span><a href="Network.TLS.Record.State.html#loc_42_7_42_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_42_7_42_12&#39;)"><span class="hl_varref"><span class="mpre">cstIV</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_12&#39;)"><span class="hl_varref"><span class="mpre">cst</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre"> then </span><a href="Network.TLS.Record.State.html#loc_42_7_42_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_42_7_42_12&#39;)"><span class="hl_varref"><span class="mpre">cstIV</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_12&#39;)"><span class="hl_varref"><span class="mpre">cst</span></span></a><span class="mpre"> else </span><a href="#loc_100_32_100_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_32_100_37&#39;)"><span class="hl_varref"><span class="mpre">initF</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_17&#39;)"><span class="hl_varref"><span class="mpre">writekey</span></span></a><span class="mpre">) </span><a href="#loc_66_24_66_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_24_66_32&#39;)"><span class="hl_varref"><span class="mpre">econtent</span></span></a><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">{- update Ctx -}</span></span><span class="mpre">
            let </span><a name="loc_104_17_104_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_27&#39;)"><span class="hl_vardecl"><span class="mpre">contentlen</span></span></a><span class="mpre">        = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_102_18_102_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_26&#39;)"><span class="hl_varref"><span class="mpre">content&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_70_9_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_16&#39;)"><span class="hl_varref"><span class="mpre">macSize</span></span></a><span class="mpre">
            (</span><span class="hl_vardecl"><span class="mpre">content</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">mac</span></span><span class="mpre">) &lt;- </span><a href="#loc_114_9_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_13&#39;)"><span class="hl_varref"><span class="mpre">get2</span></span></a><span class="mpre"> </span><a href="#loc_102_18_102_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_26&#39;)"><span class="hl_varref"><span class="mpre">content&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_104_17_104_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_27&#39;)"><span class="hl_varref"><span class="mpre">contentlen</span></span></a><span class="mpre">, </span><a href="#loc_70_9_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_16&#39;)"><span class="hl_varref"><span class="mpre">macSize</span></span></a><span class="mpre">)
            </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">txs</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 30, srcSpanEndLine = 106, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 34, srcSpanEndLine = 106, srcSpanEndColumn = 35},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disenga"><span class="mpre">txs { stCryptState = cst { cstIV = newiv } }</span></span><span class="mpre">
            </span><a href="#loc_43_1_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_14&#39;)"><span class="hl_varref"><span class="mpre">getCipherData</span></span></a><span class="mpre"> </span><a href="#loc_66_17_66_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_23&#39;)"><span class="hl_varref"><span class="mpre">record</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 36, srcSpanEndLine = 111, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disengage.hs&quot;, srcSpanStartLine = 108, srcSpanStartColumn = 21, srcSpanEndLine = 108, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Disenga"><span class="mpre">CipherData
                    { cipherDataContent = content
                    , cipherDataMAC     = Just mac
                    , cipherDataPadding = Nothing
                    }</span></span><span class="mpre">

        </span><a name="loc_113_9_113_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_13&#39;)"><span class="hl_fundecl"><span class="mpre">get3</span></span></a><span class="mpre"> </span><a name="loc_113_14_113_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_14_113_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_113_16_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_16_113_18&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_127_7_127_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_127_7_127_19&#39;)"><span class="hl_conref"><span class="mpre">Error_Packet</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;record bad format&quot;</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Util.html#loc_33_1_33_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Util.html#loc_33_1_33_11&#39;)"><span class="hl_varref"><span class="mpre">partition3</span></span></a><span class="mpre"> </span><a href="#loc_113_14_113_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_14_113_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_113_16_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_16_113_18&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">
        </span><a name="loc_114_9_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">get2</span></span></a><span class="mpre"> </span><a name="loc_114_14_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_14_114_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a name="loc_114_17_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_17_114_19&#39;)"><span class="hl_vardecl"><span class="mpre">d1</span></span></a><span class="mpre">,</span><a name="loc_114_20_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_20_114_22&#39;)"><span class="hl_vardecl"><span class="mpre">d2</span></span></a><span class="mpre">) = </span><a href="#loc_113_9_113_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_13&#39;)"><span class="hl_varref"><span class="mpre">get3</span></span></a><span class="mpre"> </span><a href="#loc_114_14_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_14_114_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_114_17_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_17_114_19&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre">,</span><a href="#loc_114_20_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_20_114_22&#39;)"><span class="hl_varref"><span class="mpre">d2</span></span></a><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \(</span><a name="loc_114_49_114_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_49_114_51&#39;)"><span class="hl_vardecl"><span class="mpre">r1</span></span></a><span class="mpre">,</span><a name="loc_114_52_114_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_52_114_54&#39;)"><span class="hl_vardecl"><span class="mpre">r2</span></span></a><span class="mpre">,_) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_114_49_114_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_49_114_51&#39;)"><span class="hl_varref"><span class="mpre">r1</span></span></a><span class="mpre">,</span><a href="#loc_114_52_114_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_52_114_54&#39;)"><span class="hl_varref"><span class="mpre">r2</span></span></a><span class="mpre">)
</span></div></body></html>