<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module    : Text.XML.Light.Input</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright : (c) Galois, Inc. 2007</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License   : BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer: Iavor S. Diatchki &lt;diatchki@galois.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability : provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability: portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Lightweight XML parsing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

module Text.XML.Light.Input (parseXML,parseXMLDoc) where

import Text.XML.Light.Lexer
import Text.XML.Light.Types
import Text.XML.Light.Proc
import Text.XML.Light.Output(</span><a href="Text.XML.Light.Output.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Output.html#loc_189_1_189_7&#39;)"><span class="mpre">tagEnd</span></a><span class="mpre">)

import Data.List(</span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="mpre">isPrefixOf</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | parseXMLDoc, parse a XMLl document to maybe an element</span></span><span class="mpre">
</span><a href="#loc_25_1_25_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_12&#39;)"><span class="mpre">parseXMLDoc</span></a><span class="mpre">  :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 17, srcSpanEndLine = 24, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 29, srcSpanEndLine = 24, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/"><span class="mpre">XmlSource s =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Text.XML.Light.Types.html#loc_30_6_30_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_30_6_30_13&#39;)"><span class="hl_tyconref"><span class="mpre">Element</span></span></a><span class="mpre">
</span><a name="loc_25_1_25_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_12&#39;)"><span class="hl_fundecl"><span class="mpre">parseXMLDoc</span></span></a><span class="mpre"> </span><a name="loc_25_13_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_13_25_15&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">  = </span><a href="#loc_26_9_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_14&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> (</span><a href="#loc_35_1_35_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_9&#39;)"><span class="hl_varref"><span class="mpre">parseXML</span></span></a><span class="mpre"> </span><a href="#loc_25_13_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_13_25_15&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
  where </span><a name="loc_26_9_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_14&#39;)"><span class="hl_fundecl"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a name="loc_26_15_26_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_17&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = case </span><a href="Text.XML.Light.Proc.html#loc_28_1_28_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Proc.html#loc_28_1_28_10&#39;)"><span class="hl_varref"><span class="mpre">onlyElems</span></span></a><span class="mpre"> </span><a href="#loc_26_15_26_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_17&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
                    </span><a name="loc_27_21_27_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_21_27_22&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_27_25_27_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_25_27_27&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">
                      | </span><span class="hl_string"><span class="mpre">&quot;?xml&quot;</span></span><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span></a><span class="mpre"> </span><a href="Text.XML.Light.Types.html#loc_58_19_58_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_58_19_58_24&#39;)"><span class="hl_varref"><span class="mpre">qName</span></span></a><span class="mpre"> (</span><a href="Text.XML.Light.Types.html#loc_31_19_31_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_31_19_31_25&#39;)"><span class="hl_varref"><span class="mpre">elName</span></span></a><span class="mpre"> </span><a href="#loc_27_21_27_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_21_27_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
                          -&gt; </span><a href="#loc_26_9_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_14&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Text.XML.Light.Types.html#loc_24_17_24_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_17_24_21&#39;)"><span class="hl_conref"><span class="mpre">Elem</span></span></a><span class="mpre"> </span><a href="#loc_27_25_27_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_25_27_27&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_27_21_27_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_21_27_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                    _ -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | parseXML to a list of content chunks</span></span><span class="mpre">
</span><a href="#loc_35_1_35_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_9&#39;)"><span class="mpre">parseXML</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 13, srcSpanEndLine = 34, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 25, srcSpanEndLine = 34, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/"><span class="mpre">XmlSource s =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; [</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">]
</span><a name="loc_35_1_35_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_9&#39;)"><span class="hl_vardecl"><span class="mpre">parseXML</span></span></a><span class="mpre">  = </span><a href="#loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.XML.Light.Lexer.html#loc_73_1_73_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Lexer.html#loc_73_1_73_7&#39;)"><span class="hl_varref"><span class="mpre">tokens</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="mpre">parse</span></a><span class="mpre">      :: [</span><a href="Text.XML.Light.Lexer.html#loc_66_6_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Lexer.html#loc_66_6_66_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">] -&gt; [</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">]
</span><a name="loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="hl_fundecl"><span class="mpre">parse</span></span></a><span class="mpre"> []    = []
</span><a href="#loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="hl_fundecl"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a name="loc_41_7_41_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_9&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">    = let (</span><a name="loc_41_20_41_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_22&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">,_,</span><a name="loc_41_25_41_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_25_41_28&#39;)"><span class="hl_vardecl"><span class="mpre">ts1</span></span></a><span class="mpre">) = </span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_varref"><span class="mpre">nodes</span></span></a><span class="mpre"> ([],</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) [] </span><a href="#loc_41_7_41_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_9&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
              in </span><a href="#loc_41_20_41_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="#loc_41_25_41_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_25_41_28&#39;)"><span class="hl_varref"><span class="mpre">ts1</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Information about namespaces.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The first component is a map that associates prefixes to URIs,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the second is the URI for the default namespace, if one was provided.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 1, srcSpanEndLine = 47, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 1, srcSpanEndLine = 47, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 47"><span class="mpre">type NSInfo = ([(String,String)],Maybe String)</span></span><span class="mpre">

</span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="mpre">nodes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">NSInfo</span></span><span class="mpre"> -&gt; [</span><a href="Text.XML.Light.Types.html#loc_57_6_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_57_6_57_11&#39;)"><span class="hl_tyconref"><span class="mpre">QName</span></span></a><span class="mpre">] -&gt; [</span><a href="Text.XML.Light.Lexer.html#loc_66_6_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Lexer.html#loc_66_6_66_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">] -&gt; ([</span><a href="Text.XML.Light.Types.html#loc_24_6_24_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_6_24_13&#39;)"><span class="hl_tyconref"><span class="mpre">Content</span></span></a><span class="mpre">], [</span><a href="Text.XML.Light.Types.html#loc_57_6_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_57_6_57_11&#39;)"><span class="hl_tyconref"><span class="mpre">QName</span></span></a><span class="mpre">], [</span><a href="Text.XML.Light.Lexer.html#loc_66_6_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Lexer.html#loc_66_6_66_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">])

</span><a name="loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_fundecl"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a name="loc_51_7_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_7_51_9&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a name="loc_51_10_51_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_12&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> (</span><a href="Text.XML.Light.Lexer.html#loc_68_27_68_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Lexer.html#loc_68_27_68_34&#39;)"><span class="hl_conref"><span class="mpre">TokCRef</span></span></a><span class="mpre"> </span><a name="loc_51_22_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_22_51_25&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_51_28_51_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_28_51_30&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) =
  let (</span><a name="loc_52_8_52_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_8_52_10&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">,</span><a name="loc_52_11_52_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_13&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre">,</span><a name="loc_52_14_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_14_52_17&#39;)"><span class="hl_vardecl"><span class="mpre">ts1</span></span></a><span class="mpre">) = </span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_varref"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a href="#loc_51_7_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_7_51_9&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a href="#loc_51_10_51_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_12&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_51_28_51_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_28_51_30&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
  in (</span><a href="Text.XML.Light.Types.html#loc_26_17_26_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_26_17_26_21&#39;)"><span class="hl_conref"><span class="mpre">CRef</span></span></a><span class="mpre"> </span><a href="#loc_51_22_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_22_51_25&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_8_52_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_8_52_10&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">, </span><a href="#loc_52_11_52_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_13&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">, </span><a href="#loc_52_14_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_14_52_17&#39;)"><span class="hl_varref"><span class="mpre">ts1</span></span></a><span class="mpre">)

</span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_fundecl"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a name="loc_55_7_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_9&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a name="loc_55_10_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_10_55_12&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> (</span><a href="Text.XML.Light.Lexer.html#loc_69_27_69_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Lexer.html#loc_69_27_69_34&#39;)"><span class="hl_conref"><span class="mpre">TokText</span></span></a><span class="mpre"> </span><a name="loc_55_22_55_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_22_55_25&#39;)"><span class="hl_vardecl"><span class="mpre">txt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_55_28_55_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_28_55_30&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) =
  let (</span><a name="loc_56_8_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_8_56_10&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">,</span><a name="loc_56_11_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_11_56_13&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre">,</span><a name="loc_56_14_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_14_56_17&#39;)"><span class="hl_vardecl"><span class="mpre">ts1</span></span></a><span class="mpre">) = </span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_varref"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a href="#loc_55_7_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_9&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a href="#loc_55_10_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_10_55_12&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_55_28_55_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_28_55_30&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
      (</span><span class="hl_vardecl"><span class="mpre">more</span></span><span class="mpre">,</span><a name="loc_57_13_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_13_57_16&#39;)"><span class="hl_vardecl"><span class="mpre">es1</span></span></a><span class="mpre">)  = case </span><a href="#loc_56_8_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_8_56_10&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> of
                      </span><a href="Text.XML.Light.Types.html#loc_25_17_25_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_25_17_25_21&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_58_28_58_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_28_58_30&#39;)"><span class="hl_vardecl"><span class="mpre">cd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_58_33_58_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_33_58_37&#39;)"><span class="hl_vardecl"><span class="mpre">es1&#39;</span></span></a><span class="mpre">
                        | </span><a href="Text.XML.Light.Types.html#loc_45_19_45_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_45_19_45_29&#39;)"><span class="hl_varref"><span class="mpre">cdVerbatim</span></span></a><span class="mpre"> </span><a href="#loc_58_28_58_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_28_58_30&#39;)"><span class="hl_varref"><span class="mpre">cd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Text.XML.Light.Types.html#loc_45_19_45_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_45_19_45_29&#39;)"><span class="hl_varref"><span class="mpre">cdVerbatim</span></span></a><span class="mpre"> </span><a href="#loc_55_22_55_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_22_55_25&#39;)"><span class="hl_varref"><span class="mpre">txt</span></span></a><span class="mpre"> -&gt; (</span><a href="Text.XML.Light.Types.html#loc_46_19_46_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_46_19_46_25&#39;)"><span class="hl_varref"><span class="mpre">cdData</span></span></a><span class="mpre"> </span><a href="#loc_58_28_58_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_28_58_30&#39;)"><span class="hl_varref"><span class="mpre">cd</span></span></a><span class="mpre">,</span><a href="#loc_58_33_58_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_33_58_37&#39;)"><span class="hl_varref"><span class="mpre">es1&#39;</span></span></a><span class="mpre">)
                      _                                   -&gt; ([],</span><a href="#loc_56_8_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_8_56_10&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)

  in (</span><a href="Text.XML.Light.Types.html#loc_25_17_25_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_25_17_25_21&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 12, srcSpanEndLine = 62, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 16, srcSpanEndLine = 62, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine "><span class="mpre">txt { cdData = cdData txt ++ more }</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_57_13_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_13_57_16&#39;)"><span class="hl_varref"><span class="mpre">es1</span></span></a><span class="mpre">, </span><a href="#loc_56_11_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_11_56_13&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">, </span><a href="#loc_56_14_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_14_56_17&#39;)"><span class="hl_varref"><span class="mpre">ts1</span></span></a><span class="mpre">)

</span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_fundecl"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a name="loc_64_7_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_15&#39;)"><span class="hl_vardecl"><span class="mpre">cur_info</span></span></a><span class="mpre"> </span><a name="loc_64_16_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_16_64_18&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> (</span><a href="Text.XML.Light.Lexer.html#loc_66_27_66_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Lexer.html#loc_66_27_66_35&#39;)"><span class="hl_conref"><span class="mpre">TokStart</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> </span><a name="loc_64_31_64_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_31_64_32&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_64_33_64_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_33_64_35&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre"> </span><a name="loc_64_36_64_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_36_64_41&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_64_44_64_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_44_64_46&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = (</span><a href="#loc_68_3_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_3_68_7&#39;)"><span class="hl_varref"><span class="mpre">node</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_74_14_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_14_74_22&#39;)"><span class="hl_varref"><span class="mpre">siblings</span></span></a><span class="mpre">, </span><a href="#loc_74_23_74_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_23_74_27&#39;)"><span class="hl_varref"><span class="mpre">open</span></span></a><span class="mpre">, </span><a href="#loc_74_28_74_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_28_74_32&#39;)"><span class="hl_varref"><span class="mpre">toks</span></span></a><span class="mpre">)
  where
  </span><a name="loc_66_3_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_3_66_11&#39;)"><span class="hl_vardecl"><span class="mpre">new_name</span></span></a><span class="mpre">  = </span><a href="#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">annotName</span></span></a><span class="mpre"> </span><a href="#loc_67_3_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_3_67_11&#39;)"><span class="hl_varref"><span class="mpre">new_info</span></span></a><span class="mpre"> </span><a href="#loc_64_31_64_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_31_64_32&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
  </span><a name="loc_67_3_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_3_67_11&#39;)"><span class="hl_vardecl"><span class="mpre">new_info</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_110_1_110_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_6&#39;)"><span class="hl_varref"><span class="mpre">addNS</span></span></a><span class="mpre"> </span><a href="#loc_64_7_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_15&#39;)"><span class="hl_varref"><span class="mpre">cur_info</span></span></a><span class="mpre"> </span><a href="#loc_64_33_64_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_33_64_35&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">
  </span><a name="loc_68_3_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_3_68_7&#39;)"><span class="hl_vardecl"><span class="mpre">node</span></span></a><span class="mpre">      = </span><a href="Text.XML.Light.Types.html#loc_24_17_24_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_24_17_24_21&#39;)"><span class="hl_conref"><span class="mpre">Elem</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 20, srcSpanEndLine = 72, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 28, srcSpanEndLine = 68, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine "><span class="mpre">Element { elLine    = Just p
                           , elName    = new_name
                           , elAttribs = map (annotAttr new_info) as
                           , elContent = children
                           }</span></span><span class="mpre">

  (</span><span class="hl_vardecl"><span class="mpre">children</span></span><span class="mpre">,(</span><a name="loc_74_14_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_14_74_22&#39;)"><span class="hl_vardecl"><span class="mpre">siblings</span></span></a><span class="mpre">,</span><a name="loc_74_23_74_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_23_74_27&#39;)"><span class="hl_vardecl"><span class="mpre">open</span></span></a><span class="mpre">,</span><a name="loc_74_28_74_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_28_74_32&#39;)"><span class="hl_vardecl"><span class="mpre">toks</span></span></a><span class="mpre">))
    | </span><a href="#loc_64_36_64_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_36_64_41&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">     = ([], </span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_varref"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a href="#loc_64_7_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_15&#39;)"><span class="hl_varref"><span class="mpre">cur_info</span></span></a><span class="mpre"> </span><a href="#loc_64_16_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_16_64_18&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_64_44_64_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_44_64_46&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = let (</span><a name="loc_76_24_76_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_24_76_27&#39;)"><span class="hl_vardecl"><span class="mpre">es1</span></span></a><span class="mpre">,</span><a name="loc_76_28_76_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_31&#39;)"><span class="hl_vardecl"><span class="mpre">qs1</span></span></a><span class="mpre">,</span><a name="loc_76_32_76_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_32_76_35&#39;)"><span class="hl_vardecl"><span class="mpre">ts1</span></span></a><span class="mpre">) = </span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_varref"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a href="#loc_67_3_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_3_67_11&#39;)"><span class="hl_varref"><span class="mpre">new_info</span></span></a><span class="mpre"> (</span><a href="#loc_66_3_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_3_66_11&#39;)"><span class="hl_varref"><span class="mpre">new_name</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_64_16_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_16_64_18&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">) </span><a href="#loc_64_44_64_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_44_64_46&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                  in (</span><a href="#loc_76_24_76_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_24_76_27&#39;)"><span class="hl_varref"><span class="mpre">es1</span></span></a><span class="mpre">,
                      case </span><a href="#loc_76_28_76_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_31&#39;)"><span class="hl_varref"><span class="mpre">qs1</span></span></a><span class="mpre"> of
                        [] -&gt; </span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_varref"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a href="#loc_64_7_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_15&#39;)"><span class="hl_varref"><span class="mpre">cur_info</span></span></a><span class="mpre"> </span><a href="#loc_64_16_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_16_64_18&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_76_32_76_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_32_76_35&#39;)"><span class="hl_varref"><span class="mpre">ts1</span></span></a><span class="mpre">
                        _ </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_80_29_80_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_29_80_32&#39;)"><span class="hl_vardecl"><span class="mpre">qs3</span></span></a><span class="mpre"> -&gt; ([],</span><a href="#loc_80_29_80_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_29_80_32&#39;)"><span class="hl_varref"><span class="mpre">qs3</span></span></a><span class="mpre">,</span><a href="#loc_76_32_76_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_32_76_35&#39;)"><span class="hl_varref"><span class="mpre">ts1</span></span></a><span class="mpre">))

</span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_fundecl"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a name="loc_82_7_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_7_82_9&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a name="loc_82_10_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_10_82_12&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> (</span><a href="Text.XML.Light.Lexer.html#loc_67_27_67_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Lexer.html#loc_67_27_67_33&#39;)"><span class="hl_conref"><span class="mpre">TokEnd</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> </span><a name="loc_82_23_82_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_23_82_24&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_82_27_82_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_27_82_29&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">)   = let </span><a name="loc_82_39_82_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_39_82_41&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre"> = </span><a href="#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">annotName</span></span></a><span class="mpre"> </span><a href="#loc_82_7_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_7_82_9&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a href="#loc_82_23_82_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_23_82_24&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
                                in case </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><a href="#loc_82_39_82_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_39_82_41&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre">) </span><a href="#loc_82_10_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_10_82_12&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> of
                                  (</span><a name="loc_84_36_84_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_36_84_38&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">,_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; ([],</span><a href="#loc_84_36_84_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_36_84_38&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">,</span><a href="#loc_82_27_82_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_27_82_29&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">)
                                  </span><span class="hl_comment"><span class="mpre">-- Unknown closing tag. Insert as text.</span></span><span class="mpre">
                                  (_,[]) -&gt;
                                    let (</span><a name="loc_87_42_87_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_42_87_44&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">,</span><a name="loc_87_45_87_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_45_87_47&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre">,</span><a name="loc_87_48_87_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_48_87_51&#39;)"><span class="hl_vardecl"><span class="mpre">ts1</span></span></a><span class="mpre">) = </span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_varref"><span class="mpre">nodes</span></span></a><span class="mpre"> </span><a href="#loc_82_7_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_7_82_9&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a href="#loc_82_10_82_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_10_82_12&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_82_27_82_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_27_82_29&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                                    in (</span><a href="Text.XML.Light.Types.html#loc_25_17_25_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_25_17_25_21&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 46, srcSpanEndLine = 92, srcSpanEndColumn = 48}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 52, srcSpanEndLine = 88, srcSpanEndColumn = 53},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine "><span class="mpre">CData {
                                               cdLine = Just p,
                                               cdVerbatim = CDataText,
                                               cdData = tagEnd t &quot;&quot;
                                              }</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_87_42_87_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_42_87_44&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">,</span><a href="#loc_87_45_87_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_45_87_47&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">, </span><a href="#loc_87_48_87_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_48_87_51&#39;)"><span class="hl_varref"><span class="mpre">ts1</span></span></a><span class="mpre">)

</span><a href="#loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_fundecl"><span class="mpre">nodes</span></span></a><span class="mpre"> _ </span><a name="loc_94_9_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_11&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> []                 = ([],</span><a href="#loc_94_9_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_11&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">,[])


</span><a href="#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="mpre">annotName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">NSInfo</span></span><span class="mpre"> -&gt; </span><a href="Text.XML.Light.Types.html#loc_57_6_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_57_6_57_11&#39;)"><span class="hl_tyconref"><span class="mpre">QName</span></span></a><span class="mpre"> -&gt; </span><a href="Text.XML.Light.Types.html#loc_57_6_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_57_6_57_11&#39;)"><span class="hl_tyconref"><span class="mpre">QName</span></span></a><span class="mpre">
</span><a name="loc_98_1_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_10&#39;)"><span class="hl_fundecl"><span class="mpre">annotName</span></span></a><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">namespaces</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">def_ns</span></span><span class="mpre">) </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre"> =
  </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 3, srcSpanEndLine = 99, srcSpanEndColumn = 62}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 5, srcSpanEndLine = 99, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 9"><span class="mpre">n { qURI = maybe def_ns (`lookup` namespaces) (qPrefix n) }</span></span><span class="mpre">

</span><a href="#loc_102_1_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_10&#39;)"><span class="mpre">annotAttr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">NSInfo</span></span><span class="mpre"> -&gt; </span><a href="Text.XML.Light.Types.html#loc_38_6_38_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_38_6_38_10&#39;)"><span class="hl_tyconref"><span class="mpre">Attr</span></span></a><span class="mpre"> -&gt; </span><a href="Text.XML.Light.Types.html#loc_38_6_38_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_38_6_38_10&#39;)"><span class="hl_tyconref"><span class="mpre">Attr</span></span></a><span class="mpre">
</span><a name="loc_102_1_102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_10&#39;)"><span class="hl_fundecl"><span class="mpre">annotAttr</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ns</span></span><span class="mpre"> </span><a name="loc_102_14_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_15&#39;)"><span class="hl_specname"><span class="mpre">a</span></span></a><span class="mpre">@(</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 17, srcSpanEndLine = 102, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 22, srcSpanEndLine = 102, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine ="><span class="mpre">Attr { attrKey = k}</span></span><span class="mpre">) =
  case (</span><a href="Text.XML.Light.Types.html#loc_60_19_60_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_60_19_60_26&#39;)"><span class="hl_varref"><span class="mpre">qPrefix</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">k</span></span><span class="mpre">, </span><a href="Text.XML.Light.Types.html#loc_58_19_58_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_58_19_58_24&#39;)"><span class="hl_varref"><span class="mpre">qName</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">k</span></span><span class="mpre">) of
    </span><span class="hl_comment"><span class="mpre">-- Do not apply the default name-space to unqualified</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- attributes.  See Section 6.2 of &lt;http://www.w3.org/TR/REC-xml-names&gt;.</span></span><span class="mpre">
    (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">, _)      -&gt; </span><a href="#loc_102_14_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    _                 -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 26, srcSpanEndLine = 107, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 28, srcSpanEndLine = 107, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartL"><span class="mpre">a { attrKey = annotName ns k }</span></span><span class="mpre">

</span><a href="#loc_110_1_110_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_6&#39;)"><span class="mpre">addNS</span></a><span class="mpre"> :: </span><a href="Text.XML.Light.Types.html#loc_38_6_38_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_38_6_38_10&#39;)"><span class="hl_tyconref"><span class="mpre">Attr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">NSInfo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">NSInfo</span></span><span class="mpre">
</span><a name="loc_110_1_110_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_6&#39;)"><span class="hl_fundecl"><span class="mpre">addNS</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 8, srcSpanEndLine = 110, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 13, srcSpanEndLine = 110, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/xml-1.3.13/Text/XML/Light/Input.hs&quot;, srcSpanStartLine = "><span class="mpre">Attr { attrKey = key, attrVal = val }</span></span><span class="mpre">) (</span><a name="loc_110_48_110_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_48_110_50&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre">,</span><a name="loc_110_51_110_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_51_110_54&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre">) =
  case (</span><a href="Text.XML.Light.Types.html#loc_60_19_60_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_60_19_60_26&#39;)"><span class="hl_varref"><span class="mpre">qPrefix</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">key</span></span><span class="mpre">, </span><a href="Text.XML.Light.Types.html#loc_58_19_58_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.XML.Light.Types.html#loc_58_19_58_24&#39;)"><span class="hl_varref"><span class="mpre">qName</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">key</span></span><span class="mpre">) of
    (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;xmlns&quot;</span></span><span class="mpre">) -&gt; (</span><a href="#loc_110_48_110_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_48_110_50&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">, if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">val</span></span><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> else </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">val</span></span><span class="mpre">)
    (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;xmlns&quot;</span></span><span class="mpre">, </span><a name="loc_113_20_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_20_113_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">) -&gt; ((</span><a href="#loc_113_20_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_20_113_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">val</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_110_48_110_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_48_110_50&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">, </span><a href="#loc_110_51_110_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_51_110_54&#39;)"><span class="hl_varref"><span class="mpre">def</span></span></a><span class="mpre">)
    _                 -&gt; (</span><a href="#loc_110_48_110_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_48_110_50&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">,</span><a href="#loc_110_51_110_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_51_110_54&#39;)"><span class="hl_varref"><span class="mpre">def</span></span></a><span class="mpre">)
</span></div></body></html>