<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fno-warn-unused-imports #-}
{-# LANGUAGE ForeignFunctionInterface #-}
#include &quot;HsConfigure.h&quot;

</span><span class="hl_comment"><span class="mpre">-- #hide</span></span><span class="mpre">
module Data.Time.LocalTime.TimeZone
(
        </span><span class="hl_comment"><span class="mpre">-- * Time zones</span></span><span class="mpre">
        TimeZone(..),timeZoneOffsetString,timeZoneOffsetString&#39;,minutesToTimeZone,hoursToTimeZone,utc,

        </span><span class="hl_comment"><span class="mpre">-- getting the locale time zone</span></span><span class="mpre">
        getTimeZone,getCurrentTimeZone
) where

</span><span class="hl_comment"><span class="mpre">--import System.Time.Calendar.Format</span></span><span class="mpre">
import Data.Time.Calendar.Private
import Data.Time.Clock
import Data.Time.Clock.POSIX

import Foreign.Safe
import Foreign.C
import Control.DeepSeq
import Data.Typeable
#if LANGUAGE_Rank2Types
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/LocalTime/TimeZone.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | A TimeZone is a whole number of minutes offset from UTC, together with a name and a \&quot;just for summer\&quot; flag.</span></span><span class="mpre">
data </span><a name="loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tycondecl"><span class="mpre">TimeZone</span></span></a><span class="mpre"> = </span><a name="loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_condecl"><span class="mpre">TimeZone</span></span></a><span class="mpre"> {
        </span><span class="hl_comment"><span class="mpre">-- | The number of minutes offset from UTC. Positive means local time will be later in the day than UTC.</span></span><span class="mpre">
        </span><a name="loc_31_9_31_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_24&#39;)"><span class="hl_fielddecl"><span class="mpre">timeZoneMinutes</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,
        </span><span class="hl_comment"><span class="mpre">-- | Is this time zone just persisting for the summer?</span></span><span class="mpre">
        </span><a name="loc_33_9_33_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_27&#39;)"><span class="hl_fielddecl"><span class="mpre">timeZoneSummerOnly</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">,
        </span><span class="hl_comment"><span class="mpre">-- | The name of the zone, typically a three- or four-letter acronym.</span></span><span class="mpre">
        </span><a name="loc_35_9_35_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_21&#39;)"><span class="hl_fielddecl"><span class="mpre">timeZoneName</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
} </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/LocalTime/TimeZone.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 3, srcSpanEndLine = 42, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/LocalTime/TimeZone.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 3, srcSpanEndLine = 36, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/LocalTime/TimeZone.hs"><span class="mpre">deriving (Eq,Ord
#if LANGUAGE_DeriveDataTypeable
#if LANGUAGE_Rank2Types
    ,Data, Typeable
#endif
#endif
    )</span></span><span class="mpre">

instance </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> where
        </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> </span><a name="loc_45_23_45_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_23_45_24&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_45_25_45_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_25_45_27&#39;)"><span class="hl_vardecl"><span class="mpre">so</span></span></a><span class="mpre"> </span><a name="loc_45_28_45_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_28_45_29&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) = </span><a href="#loc_45_23_45_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_23_45_24&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="Control.DeepSeq.html#loc_85_1_85_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_85_1_85_8&#39;)"><span class="hl_infix"><span class="mpre">`deepseq`</span></span></a><span class="mpre"> </span><a href="#loc_45_25_45_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_25_45_27&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre"> </span><a href="Control.DeepSeq.html#loc_85_1_85_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_85_1_85_8&#39;)"><span class="hl_infix"><span class="mpre">`deepseq`</span></span></a><span class="mpre"> </span><a href="#loc_45_28_45_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_28_45_29&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Control.DeepSeq.html#loc_85_1_85_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_85_1_85_8&#39;)"><span class="hl_infix"><span class="mpre">`deepseq`</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a nameless non-summer timezone for this number of minutes</span></span><span class="mpre">
</span><a href="#loc_49_1_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_18&#39;)"><span class="mpre">minutesToTimeZone</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre">
</span><a name="loc_49_1_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_18&#39;)"><span class="hl_fundecl"><span class="mpre">minutesToTimeZone</span></span></a><span class="mpre"> </span><a name="loc_49_19_49_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_19_49_20&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> </span><a href="#loc_49_19_49_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_19_49_20&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a nameless non-summer timezone for this number of hours</span></span><span class="mpre">
</span><a href="#loc_53_1_53_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_16&#39;)"><span class="mpre">hoursToTimeZone</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre">
</span><a name="loc_53_1_53_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_16&#39;)"><span class="hl_fundecl"><span class="mpre">hoursToTimeZone</span></span></a><span class="mpre"> </span><a name="loc_53_17_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_17_53_18&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="#loc_49_1_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_18&#39;)"><span class="hl_varref"><span class="mpre">minutesToTimeZone</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_53_17_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_17_53_18&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)

</span><a href="#loc_56_1_56_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_6&#39;)"><span class="mpre">showT</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">NumericPadOption</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_56_1_56_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_6&#39;)"><span class="hl_fundecl"><span class="mpre">showT</span></span></a><span class="mpre"> </span><a name="loc_56_7_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_10&#39;)"><span class="hl_vardecl"><span class="mpre">opt</span></span></a><span class="mpre"> </span><a name="loc_56_11_56_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_11_56_12&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Data.Time.Calendar.Private.html#loc_34_1_34_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Private.html#loc_34_1_34_6&#39;)"><span class="hl_varref"><span class="mpre">show4</span></span></a><span class="mpre"> </span><a href="#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_10&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_56_11_56_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_11_56_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_56_11_56_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_11_56_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Text representing the offset of this timezone, such as \&quot;-0800\&quot; or \&quot;+0400\&quot; (like %z in formatTime), with arbitrary padding</span></span><span class="mpre">
</span><a href="#loc_60_1_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_22&#39;)"><span class="mpre">timeZoneOffsetString&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">NumericPadOption</span></span><span class="mpre"> -&gt; </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_60_1_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_22&#39;)"><span class="hl_fundecl"><span class="mpre">timeZoneOffsetString&#39;</span></span></a><span class="mpre"> </span><a name="loc_60_23_60_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_23_60_26&#39;)"><span class="hl_vardecl"><span class="mpre">opt</span></span></a><span class="mpre"> (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> </span><a name="loc_60_37_60_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_37_60_38&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> _ _) | </span><a href="#loc_60_37_60_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_37_60_38&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a href="#loc_56_1_56_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_6&#39;)"><span class="hl_varref"><span class="mpre">showT</span></span></a><span class="mpre"> </span><a href="#loc_60_23_60_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_23_60_26&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">negate</span></span><span class="mpre"> </span><a href="#loc_60_37_60_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_37_60_38&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">))
</span><a href="#loc_60_1_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_22&#39;)"><span class="hl_fundecl"><span class="mpre">timeZoneOffsetString&#39;</span></span></a><span class="mpre"> </span><a name="loc_61_23_61_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_23_61_26&#39;)"><span class="hl_vardecl"><span class="mpre">opt</span></span></a><span class="mpre"> (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> </span><a name="loc_61_37_61_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_37_61_38&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> _ _) = </span><span class="hl_char"><span class="mpre">&#39;+&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a href="#loc_56_1_56_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_6&#39;)"><span class="hl_varref"><span class="mpre">showT</span></span></a><span class="mpre"> </span><a href="#loc_61_23_61_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_23_61_26&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre"> </span><a href="#loc_61_37_61_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_37_61_38&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Text representing the offset of this timezone, such as \&quot;-0800\&quot; or \&quot;+0400\&quot; (like %z in formatTime)</span></span><span class="mpre">
</span><a href="#loc_65_1_65_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_21&#39;)"><span class="mpre">timeZoneOffsetString</span></a><span class="mpre"> :: </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_65_1_65_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_21&#39;)"><span class="hl_vardecl"><span class="mpre">timeZoneOffsetString</span></span></a><span class="mpre"> = </span><a href="#loc_60_1_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_22&#39;)"><span class="hl_varref"><span class="mpre">timeZoneOffsetString&#39;</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> where
        </span><a name="loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> </span><a name="loc_68_14_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_14_68_18&#39;)"><span class="hl_specname"><span class="mpre">zone</span></span></a><span class="mpre">@(</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> _ _ </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) = </span><a href="#loc_65_1_65_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_21&#39;)"><span class="hl_varref"><span class="mpre">timeZoneOffsetString</span></span></a><span class="mpre"> </span><a href="#loc_68_14_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_14_68_18&#39;)"><span class="hl_varref"><span class="mpre">zone</span></span></a><span class="mpre">
        </span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> _ _ </span><a name="loc_69_28_69_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_28_69_32&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">) = </span><a href="#loc_69_28_69_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_28_69_32&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The UTC time zone</span></span><span class="mpre">
</span><a href="#loc_73_1_73_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_4&#39;)"><span class="mpre">utc</span></a><span class="mpre"> :: </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre">
</span><a name="loc_73_1_73_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_4&#39;)"><span class="hl_vardecl"><span class="mpre">utc</span></span></a><span class="mpre"> = </span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;UTC&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-# CFILES cbits/HsTime.c #-}</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/LocalTime/TimeZone.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 1, srcSpanEndLine = 76, srcSpanEndColumn = 145}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/LocalTime/TimeZone.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 1, srcSpanEndLine = 76, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/LocalTime/TimeZone.hs&quot;"><span class="mpre">foreign import ccall unsafe &quot;HsTime.h get_current_timezone_seconds&quot; get_current_timezone_seconds :: CTime -&gt; Ptr CInt -&gt; Ptr CString -&gt; IO CLong</span></span><span class="mpre">

</span><a href="#loc_79_1_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_13&#39;)"><span class="mpre">posixToCTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">POSIXTime</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CTime</span></span><span class="mpre">
</span><a name="loc_79_1_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_13&#39;)"><span class="hl_vardecl"><span class="mpre">posixToCTime</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">floor</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the local time-zone for a given time (varying as per summertime adjustments)</span></span><span class="mpre">
</span><a href="#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="mpre">getTimeZone</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre">
</span><a name="loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="hl_fundecl"><span class="mpre">getTimeZone</span></span></a><span class="mpre"> </span><a name="loc_83_13_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_17&#39;)"><span class="hl_vardecl"><span class="mpre">time</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">with</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (\</span><a name="loc_83_29_83_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_29_83_33&#39;)"><span class="hl_vardecl"><span class="mpre">pdst</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">with</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> (\</span><a name="loc_83_52_83_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_52_83_58&#39;)"><span class="hl_vardecl"><span class="mpre">pcname</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_vardecl"><span class="mpre">secs</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get_current_timezone_seconds</span></span><span class="mpre"> (</span><a href="#loc_79_1_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_13&#39;)"><span class="hl_varref"><span class="mpre">posixToCTime</span></span></a><span class="mpre"> (</span><a href="Data.Time.Clock.POSIX.html#loc_39_1_39_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.POSIX.html#loc_39_1_39_22&#39;)"><span class="hl_varref"><span class="mpre">utcTimeToPOSIXSeconds</span></span></a><span class="mpre"> </span><a href="#loc_83_13_83_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_17&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre">)) </span><a href="#loc_83_29_83_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_29_83_33&#39;)"><span class="hl_varref"><span class="mpre">pdst</span></span></a><span class="mpre"> </span><a href="#loc_83_52_83_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_52_83_58&#39;)"><span class="hl_varref"><span class="mpre">pcname</span></span></a><span class="mpre">
        case </span><a href="#loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_varref"><span class="mpre">secs</span></span></a><span class="mpre"> of
                </span><span class="hl_num"><span class="mpre">0x80000000</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;localtime_r failed&quot;</span></span><span class="mpre">
                _ -&gt; do
                        </span><a name="loc_88_25_88_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_25_88_28&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_83_29_83_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_29_83_33&#39;)"><span class="hl_varref"><span class="mpre">pdst</span></span></a><span class="mpre">
                        </span><a name="loc_89_25_89_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_25_89_30&#39;)"><span class="hl_vardecl"><span class="mpre">cname</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_83_52_83_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_52_83_58&#39;)"><span class="hl_varref"><span class="mpre">pcname</span></span></a><span class="mpre">
                        </span><a name="loc_90_25_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_25_90_29&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> &lt;- </span><a href="Foreign.C.String.html#loc_138_1_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_138_1_138_12&#39;)"><span class="hl_varref"><span class="mpre">peekCString</span></span></a><span class="mpre"> </span><a href="#loc_89_25_89_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_25_89_30&#39;)"><span class="hl_varref"><span class="mpre">cname</span></span></a><span class="mpre">
                        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">TimeZone</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_84_9_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_13&#39;)"><span class="hl_varref"><span class="mpre">secs</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre">) (</span><a href="#loc_88_25_88_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_25_88_28&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_90_25_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_25_90_29&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">)
        ))

</span><span class="hl_comment"><span class="mpre">-- | Get the current time-zone</span></span><span class="mpre">
</span><a href="#loc_96_1_96_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_19&#39;)"><span class="mpre">getCurrentTimeZone</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">TimeZone</span></span></a><span class="mpre">
</span><a name="loc_96_1_96_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_19&#39;)"><span class="hl_vardecl"><span class="mpre">getCurrentTimeZone</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">getCurrentTime</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">getTimeZone</span></span></a><span class="mpre">
</span></div></body></html>