<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Unsafe #-}
{-# LANGUAGE NoImplicitPrelude, MagicHash, DeriveDataTypeable #-}
{-# OPTIONS_GHC -funbox-strict-fields #-}
{-# OPTIONS_HADDOCK hide #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  GHC.IORef</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow 2008</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  see libraries/base/LICENSE</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  cvs-ghc@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  internal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (GHC Extensions)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The IORef type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module GHC.IORef (
        IORef(..),
        newIORef, readIORef, writeIORef, atomicModifyIORef
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IORef.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IORef.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 8, srcSpanEndLine = 26, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;GHC.STRef&quot;"><span class="mpre">GHC.STRef</span></span><span class="mpre">
import GHC.IO
import Data.Typeable.Internal( </span><a href="Data.Typeable.Internal.html#loc_196_7_196_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.Internal.html#loc_196_7_196_15&#39;)"><span class="mpre">Typeable</span></a><span class="mpre"> )

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- IORefs</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |A mutable variable in the &#39;IO&#39; monad</span></span><span class="mpre">
newtype </span><a name="loc_34_9_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_14&#39;)"><span class="hl_tycondecl"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_34_19_34_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_24&#39;)"><span class="hl_condecl"><span class="mpre">IORef</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">STRef</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">RealWorld</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IORef.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 45, srcSpanEndLine = 34, srcSpanEndColumn = 65}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IORef.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 45, srcSpanEndLine = 34, srcSpanEndColumn = 53},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IORef.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 5"><span class="mpre">deriving( Typeable )</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- explicit instance because Haddock can&#39;t figure out a derived one</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre"> (</span><a href="#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
  </span><a href="#loc_34_19_34_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_24&#39;)"><span class="hl_conref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><a name="loc_38_9_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_34_19_34_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_24&#39;)"><span class="hl_conref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><a name="loc_38_20_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_20_38_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_38_9_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_38_20_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_20_38_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Build a new &#39;IORef&#39;</span></span><span class="mpre">
</span><a href="#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_9&#39;)"><span class="mpre">newIORef</span></a><span class="mpre">    :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_42_1_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_9&#39;)"><span class="hl_fundecl"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a name="loc_42_10_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_10_42_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_91_1_91_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_91_1_91_7&#39;)"><span class="hl_varref"><span class="mpre">stToIO</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">newSTRef</span></span><span class="mpre"> </span><a href="#loc_42_10_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_10_42_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \ </span><a name="loc_42_40_42_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_40_42_43&#39;)"><span class="hl_vardecl"><span class="mpre">var</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_34_19_34_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_24&#39;)"><span class="hl_conref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><a href="#loc_42_40_42_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_40_42_43&#39;)"><span class="hl_varref"><span class="mpre">var</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Read the value of an &#39;IORef&#39;</span></span><span class="mpre">
</span><a href="#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_10&#39;)"><span class="mpre">readIORef</span></a><span class="mpre">   :: </span><a href="#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_46_1_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_10&#39;)"><span class="hl_fundecl"><span class="mpre">readIORef</span></span></a><span class="mpre">  (</span><a href="#loc_34_19_34_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_24&#39;)"><span class="hl_conref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><a name="loc_46_19_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_22&#39;)"><span class="hl_vardecl"><span class="mpre">var</span></span></a><span class="mpre">) = </span><a href="GHC.IO.html#loc_91_1_91_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_91_1_91_7&#39;)"><span class="hl_varref"><span class="mpre">stToIO</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">readSTRef</span></span><span class="mpre"> </span><a href="#loc_46_19_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_22&#39;)"><span class="hl_varref"><span class="mpre">var</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Write a new value into an &#39;IORef&#39;</span></span><span class="mpre">
</span><a href="#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_11&#39;)"><span class="mpre">writeIORef</span></a><span class="mpre">  :: </span><a href="#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_50_1_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_11&#39;)"><span class="hl_fundecl"><span class="mpre">writeIORef</span></span></a><span class="mpre"> (</span><a href="#loc_34_19_34_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_24&#39;)"><span class="hl_conref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><a name="loc_50_19_50_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_19_50_22&#39;)"><span class="hl_vardecl"><span class="mpre">var</span></span></a><span class="mpre">) </span><a name="loc_50_24_50_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_24_50_25&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_91_1_91_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_91_1_91_7&#39;)"><span class="hl_varref"><span class="mpre">stToIO</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">writeSTRef</span></span><span class="mpre"> </span><a href="#loc_50_19_50_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_19_50_22&#39;)"><span class="hl_varref"><span class="mpre">var</span></span></a><span class="mpre"> </span><a href="#loc_50_24_50_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_24_50_25&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)

</span><a href="#loc_53_1_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_18&#39;)"><span class="mpre">atomicModifyIORef</span></a><span class="mpre"> :: </span><a href="#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_53_1_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_18&#39;)"><span class="hl_fundecl"><span class="mpre">atomicModifyIORef</span></span></a><span class="mpre"> (</span><a href="#loc_34_19_34_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_24&#39;)"><span class="hl_conref"><span class="mpre">IORef</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">STRef</span></span><span class="mpre"> </span><a name="loc_53_33_53_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_33_53_35&#39;)"><span class="hl_vardecl"><span class="mpre">r#</span></span></a><span class="mpre">)) </span><a name="loc_53_38_53_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_38_53_39&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_53_48_53_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_48_53_49&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">atomicModifyMutVar#</span></span><span class="mpre"> </span><a href="#loc_53_33_53_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_33_53_35&#39;)"><span class="hl_varref"><span class="mpre">r#</span></span></a><span class="mpre"> </span><a href="#loc_53_38_53_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_38_53_39&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_53_48_53_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_48_53_49&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span></div></body></html>