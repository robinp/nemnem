<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Trustworthy #-}
{-# LANGUAGE CPP, NoImplicitPrelude #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  GHC.IO.Handle.FD</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow, 1994-2008</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  see libraries/base/LICENSE</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  internal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Handle operations implemented by file descriptors (FDs)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module GHC.IO.Handle.FD ( 
  stdin, stdout, stderr,
  openFile, openBinaryFile, openFileBlocking,
  mkHandleFromFD, fdToHandle, fdToHandle&#39;,
  isEOF
 ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 8, srcSpanEndLine = 26, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Show&quot;"><span class="mpre">GHC.Show</span></span><span class="mpre">
import Data.Maybe
import Foreign.C.Types
import GHC.MVar
import GHC.IO
import GHC.IO.Encoding
import GHC.IO.Device as IODevice
import GHC.IO.Exception
import GHC.IO.IOMode
import GHC.IO.Handle
import GHC.IO.Handle.Types
import GHC.IO.Handle.Internals
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 18, srcSpanEndLine = 38, srcSpanEndColumn = 27}, srcInfoPoints = []}) &quot;GHC.IO.FD&quot;"><span class="mpre">GHC.IO.FD</span></span><span class="mpre"> as FD
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 18, srcSpanEndLine = 39, srcSpanEndColumn = 40}, srcInfoPoints = []}) &quot;System.Posix.Internals&quot;"><span class="mpre">System.Posix.Internals</span></span><span class="mpre"> as Posix

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Standard Handles</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Three handles are allocated during program initialisation.  The first</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- two manage input or output from the Haskell program&#39;s standard input</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or output channel respectively.  The third manages output to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- standard error channel. These handles are initially open.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A handle managing input from the Haskell program&#39;s standard input channel.</span></span><span class="mpre">
</span><a href="#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_6&#39;)"><span class="mpre">stdin</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_6&#39;)"><span class="mpre">stdin</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_52_1_52_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_6&#39;)"><span class="hl_vardecl"><span class="mpre">stdin</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
   </span><span class="hl_comment"><span class="mpre">-- ToDo: acquire lock</span></span><span class="mpre">
   </span><a href="#loc_96_1_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_14&#39;)"><span class="hl_varref"><span class="mpre">setBinaryMode</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">FD.stdin</span></span><span class="mpre">
   </span><a name="loc_55_4_55_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_4_55_7&#39;)"><span class="hl_vardecl"><span class="mpre">enc</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Encoding.html#loc_133_2_133_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.html#loc_133_2_133_19&#39;)"><span class="hl_varref"><span class="mpre">getLocaleEncoding</span></span></a><span class="mpre">
   </span><a href="GHC.IO.Handle.Internals.html#loc_618_1_618_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_618_1_618_9&#39;)"><span class="hl_varref"><span class="mpre">mkHandle</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">FD.stdin</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;stdin&gt;&quot;</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_157_4_157_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_157_4_157_14&#39;)"><span class="hl_conref"><span class="mpre">ReadHandle</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_55_4_55_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_4_55_7&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">)
                </span><a href="GHC.IO.Handle.Types.html#loc_398_1_398_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_398_1_398_18&#39;)"><span class="hl_varref"><span class="mpre">nativeNewlineMode</span></span></a><span class="hl_comment"><span class="mpre">{-translate newlines-}</span></span><span class="mpre">
                (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_84_1_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_19&#39;)"><span class="hl_varref"><span class="mpre">stdHandleFinalizer</span></span></a><span class="mpre">) </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A handle managing output to the Haskell program&#39;s standard output channel.</span></span><span class="mpre">
</span><a href="#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_7&#39;)"><span class="mpre">stdout</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_7&#39;)"><span class="mpre">stdout</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_63_1_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_7&#39;)"><span class="hl_vardecl"><span class="mpre">stdout</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
   </span><span class="hl_comment"><span class="mpre">-- ToDo: acquire lock</span></span><span class="mpre">
   </span><a href="#loc_96_1_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_14&#39;)"><span class="hl_varref"><span class="mpre">setBinaryMode</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">FD.stdout</span></span><span class="mpre">
   </span><a name="loc_66_4_66_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_4_66_7&#39;)"><span class="hl_vardecl"><span class="mpre">enc</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Encoding.html#loc_133_2_133_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.html#loc_133_2_133_19&#39;)"><span class="hl_varref"><span class="mpre">getLocaleEncoding</span></span></a><span class="mpre">
   </span><a href="GHC.IO.Handle.Internals.html#loc_618_1_618_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_618_1_618_9&#39;)"><span class="hl_varref"><span class="mpre">mkHandle</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">FD.stdout</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;stdout&gt;&quot;</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_158_4_158_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_158_4_158_15&#39;)"><span class="hl_conref"><span class="mpre">WriteHandle</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_66_4_66_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_4_66_7&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">)
                </span><a href="GHC.IO.Handle.Types.html#loc_398_1_398_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_398_1_398_18&#39;)"><span class="hl_varref"><span class="mpre">nativeNewlineMode</span></span></a><span class="hl_comment"><span class="mpre">{-translate newlines-}</span></span><span class="mpre">
                (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_84_1_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_19&#39;)"><span class="hl_varref"><span class="mpre">stdHandleFinalizer</span></span></a><span class="mpre">) </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A handle managing output to the Haskell program&#39;s standard error channel.</span></span><span class="mpre">
</span><a href="#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_7&#39;)"><span class="mpre">stderr</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_7&#39;)"><span class="mpre">stderr</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_74_1_74_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_7&#39;)"><span class="hl_vardecl"><span class="mpre">stderr</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_comment"><span class="mpre">-- ToDo: acquire lock</span></span><span class="mpre">
   </span><a href="#loc_96_1_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_14&#39;)"><span class="hl_varref"><span class="mpre">setBinaryMode</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">FD.stderr</span></span><span class="mpre">
   </span><a name="loc_77_4_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_4_77_7&#39;)"><span class="hl_vardecl"><span class="mpre">enc</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Encoding.html#loc_133_2_133_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.html#loc_133_2_133_19&#39;)"><span class="hl_varref"><span class="mpre">getLocaleEncoding</span></span></a><span class="mpre">
   </span><a href="GHC.IO.Handle.Internals.html#loc_618_1_618_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_618_1_618_9&#39;)"><span class="hl_varref"><span class="mpre">mkHandle</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">FD.stderr</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;stderr&gt;&quot;</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_158_4_158_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_158_4_158_15&#39;)"><span class="hl_conref"><span class="mpre">WriteHandle</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="hl_comment"><span class="mpre">{-stderr is unbuffered-}</span></span><span class="mpre"> 
                (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_77_4_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_4_77_7&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">)
                </span><a href="GHC.IO.Handle.Types.html#loc_398_1_398_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_398_1_398_18&#39;)"><span class="hl_varref"><span class="mpre">nativeNewlineMode</span></span></a><span class="hl_comment"><span class="mpre">{-translate newlines-}</span></span><span class="mpre">
                (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_84_1_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_19&#39;)"><span class="hl_varref"><span class="mpre">stdHandleFinalizer</span></span></a><span class="mpre">) </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

</span><a href="#loc_84_1_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_19&#39;)"><span class="mpre">stdHandleFinalizer</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_124_6_124_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_124_6_124_14&#39;)"><span class="hl_tyconref"><span class="mpre">Handle__</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_84_1_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_19&#39;)"><span class="hl_fundecl"><span class="mpre">stdHandleFinalizer</span></span></a><span class="mpre"> </span><a name="loc_84_20_84_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_20_84_22&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_84_23_84_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_23_84_24&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = do
  </span><a name="loc_85_3_85_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_5&#39;)"><span class="hl_vardecl"><span class="mpre">h_</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_84_23_84_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_23_84_24&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
  </span><a href="GHC.IO.Handle.Internals.html#loc_490_1_490_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_490_1_490_17&#39;)"><span class="hl_varref"><span class="mpre">flushWriteBuffer</span></span></a><span class="mpre"> </span><a href="#loc_85_3_85_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_5&#39;)"><span class="hl_varref"><span class="mpre">h_</span></span></a><span class="mpre">
  case </span><a href="GHC.IO.Handle.Types.html#loc_128_7_128_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_128_7_128_13&#39;)"><span class="hl_varref"><span class="mpre">haType</span></span></a><span class="mpre"> </span><a href="#loc_85_3_85_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_5&#39;)"><span class="hl_varref"><span class="mpre">h_</span></span></a><span class="mpre"> of 
      </span><a href="GHC.IO.Handle.Types.html#loc_155_4_155_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_155_4_155_16&#39;)"><span class="hl_conref"><span class="mpre">ClosedHandle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
      </span><span class="hl_vardecl"><span class="mpre">_other</span></span><span class="mpre">       -&gt; </span><a href="GHC.IO.Handle.Internals.html#loc_718_1_718_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_718_1_718_16&#39;)"><span class="hl_varref"><span class="mpre">closeTextCodecs</span></span></a><span class="mpre"> </span><a href="#loc_85_3_85_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_5&#39;)"><span class="hl_varref"><span class="mpre">h_</span></span></a><span class="mpre">
  </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_84_23_84_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_23_84_24&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.Internals.html#loc_344_1_344_20" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_344_1_344_20&#39;)"><span class="hl_varref"><span class="mpre">ioe_finalizedHandle</span></span></a><span class="mpre"> </span><a href="#loc_84_20_84_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_20_84_22&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- We have to put the FDs into binary mode on Windows to avoid the newline</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- translation that the CRT IO library does.</span></span><span class="mpre">
</span><a href="#loc_96_1_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_14&#39;)"><span class="mpre">setBinaryMode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FD.FD</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
#ifdef mingw32_HOST_OS
</span><a name="loc_96_1_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_14&#39;)"><span class="hl_fundecl"><span class="mpre">setBinaryMode</span></span></a><span class="mpre"> </span><a name="loc_96_15_96_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_17&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> = do _ &lt;- </span><span class="hl_varref"><span class="mpre">setmode</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">FD.fdFD</span></span><span class="mpre"> </span><a href="#loc_96_15_96_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_17&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
#else
</span><a href="#loc_96_1_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_14&#39;)"><span class="hl_fundecl"><span class="mpre">setBinaryMode</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
#endif

#ifdef mingw32_HOST_OS
</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 1, srcSpanEndLine = 104, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 1, srcSpanEndLine = 103, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 103, s"><span class="mpre">foreign import ccall unsafe &quot;__hscore_setmode&quot;
  setmode :: CInt -&gt; Bool -&gt; IO CInt</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- isEOF</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The computation &#39;isEOF&#39; is identical to &#39;hIsEOF&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- except that it works only on &#39;stdin&#39;.</span></span><span class="mpre">

</span><a href="#loc_114_1_114_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_6&#39;)"><span class="mpre">isEOF</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_114_1_114_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_6&#39;)"><span class="hl_vardecl"><span class="mpre">isEOF</span></span></a><span class="mpre"> = </span><a href="GHC.IO.Handle.html#loc_150_1_150_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_150_1_150_7&#39;)"><span class="hl_varref"><span class="mpre">hIsEOF</span></span></a><span class="mpre"> </span><a href="#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_6&#39;)"><span class="hl_varref"><span class="mpre">stdin</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Opening and Closing Files</span></span><span class="mpre">

</span><a href="#loc_120_1_120_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_21&#39;)"><span class="mpre">addFilePathToIOError</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre">
</span><a name="loc_120_1_120_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_21&#39;)"><span class="hl_fundecl"><span class="mpre">addFilePathToIOError</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">fun</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">fp</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ioe</span></span><span class="mpre">
  = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 121, srcSpanStartColumn = 5, srcSpanEndLine = 121, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 121, srcSpanStartColumn = 8, srcSpanEndLine = 121, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Handle/FD.hs&quot;, srcSpanStartLine = 121"><span class="mpre">ioe{ ioe_location = fun, ioe_filename = Just fp }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Computation &#39;openFile&#39; @file mode@ allocates and returns a new, open</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- handle to manage the file @file@.  It manages input if @mode@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is &#39;ReadMode&#39;, output if @mode@ is &#39;WriteMode&#39; or &#39;AppendMode&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and both input and output if mode is &#39;ReadWriteMode&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the file does not exist and it is opened for output, it should be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- created as a new file.  If @mode@ is &#39;WriteMode&#39; and the file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- already exists, then it should be truncated to zero length.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Some operating systems delete empty files, so there is no guarantee</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that the file will exist following an &#39;openFile&#39; with @mode@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;WriteMode&#39; unless it is subsequently written to successfully.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The handle is positioned at the end of the file if @mode@ is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;AppendMode&#39;, and otherwise at the beginning (in which case its</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- internal position is 0).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The initial buffer mode is implementation-dependent.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This operation may fail with:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * &#39;isAlreadyInUseError&#39; if the file is already open and cannot be reopened;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * &#39;isDoesNotExistError&#39; if the file does not exist; or</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * &#39;isPermissionError&#39; if the user does not have permission to open the file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note: if you will be working with files containing binary data, you&#39;ll want to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- be using &#39;openBinaryFile&#39;.</span></span><span class="mpre">
</span><a href="#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_9&#39;)"><span class="mpre">openFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">IOMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">
</span><a name="loc_150_1_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_9&#39;)"><span class="hl_fundecl"><span class="mpre">openFile</span></span></a><span class="mpre"> </span><a name="loc_150_10_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_10_150_12&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_150_13_150_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_15&#39;)"><span class="hl_vardecl"><span class="mpre">im</span></span></a><span class="mpre"> = 
  </span><a href="GHC.IO.html#loc_279_1_279_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_279_1_279_15&#39;)"><span class="hl_varref"><span class="mpre">catchException</span></span></a><span class="mpre">
    (</span><a href="#loc_183_1_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_10&#39;)"><span class="hl_varref"><span class="mpre">openFile&#39;</span></span></a><span class="mpre"> </span><a href="#loc_150_10_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_10_150_12&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_150_13_150_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_15&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre"> </span><a href="#loc_291_1_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_28&#39;)"><span class="hl_varref"><span class="mpre">dEFAULT_OPEN_IN_BINARY_MODE</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
    (\</span><a name="loc_153_7_153_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_7_153_8&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Exception.html#loc_221_1_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_221_1_221_8&#39;)"><span class="hl_varref"><span class="mpre">ioError</span></span></a><span class="mpre"> (</span><a href="#loc_120_1_120_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_21&#39;)"><span class="hl_varref"><span class="mpre">addFilePathToIOError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;openFile&quot;</span></span><span class="mpre"> </span><a href="#loc_150_10_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_10_150_12&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_153_7_153_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_7_153_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;openFile&#39;, but opens the file in ordinary blocking mode.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This can be useful for opening a FIFO for reading: if we open in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- non-blocking mode then the open will fail if there are no writers,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- whereas a blocking open will block until a writer appears.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Since: 4.4.0.0/</span></span><span class="mpre">
</span><a href="#loc_162_1_162_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_17&#39;)"><span class="mpre">openFileBlocking</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">IOMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">
</span><a name="loc_162_1_162_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_17&#39;)"><span class="hl_fundecl"><span class="mpre">openFileBlocking</span></span></a><span class="mpre"> </span><a name="loc_162_18_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_18_162_20&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_162_21_162_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_21_162_23&#39;)"><span class="hl_vardecl"><span class="mpre">im</span></span></a><span class="mpre"> =
  </span><a href="GHC.IO.html#loc_279_1_279_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_279_1_279_15&#39;)"><span class="hl_varref"><span class="mpre">catchException</span></span></a><span class="mpre">
    (</span><a href="#loc_183_1_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_10&#39;)"><span class="hl_varref"><span class="mpre">openFile&#39;</span></span></a><span class="mpre"> </span><a href="#loc_162_18_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_18_162_20&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_162_21_162_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_21_162_23&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre"> </span><a href="#loc_291_1_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_28&#39;)"><span class="hl_varref"><span class="mpre">dEFAULT_OPEN_IN_BINARY_MODE</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">)
    (\</span><a name="loc_165_7_165_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_7_165_8&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Exception.html#loc_221_1_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_221_1_221_8&#39;)"><span class="hl_varref"><span class="mpre">ioError</span></span></a><span class="mpre"> (</span><a href="#loc_120_1_120_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_21&#39;)"><span class="hl_varref"><span class="mpre">addFilePathToIOError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;openFile&quot;</span></span><span class="mpre"> </span><a href="#loc_162_18_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_18_162_20&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_165_7_165_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_7_165_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;openFile&#39;, but open the file in binary mode.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On Windows, reading a file in text mode (which is the default)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will translate CRLF to LF, and writing will translate LF to CRLF.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is usually what you want with text files.  With binary files</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this is undesirable; also, as usual under Microsoft operating systems,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- text mode treats control-Z as EOF.  Binary mode turns off all special</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- treatment of end-of-line and end-of-file characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (See also &#39;hSetBinaryMode&#39;.)</span></span><span class="mpre">

</span><a href="#loc_177_1_177_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_15&#39;)"><span class="mpre">openBinaryFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">IOMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">
</span><a name="loc_177_1_177_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_15&#39;)"><span class="hl_fundecl"><span class="mpre">openBinaryFile</span></span></a><span class="mpre"> </span><a name="loc_177_16_177_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_16_177_18&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_177_19_177_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_19_177_20&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> =
  </span><a href="GHC.IO.html#loc_279_1_279_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_279_1_279_15&#39;)"><span class="hl_varref"><span class="mpre">catchException</span></span></a><span class="mpre">
    (</span><a href="#loc_183_1_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_10&#39;)"><span class="hl_varref"><span class="mpre">openFile&#39;</span></span></a><span class="mpre"> </span><a href="#loc_177_16_177_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_16_177_18&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_177_19_177_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_19_177_20&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
    (\</span><a name="loc_180_7_180_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_7_180_8&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Exception.html#loc_221_1_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_221_1_221_8&#39;)"><span class="hl_varref"><span class="mpre">ioError</span></span></a><span class="mpre"> (</span><a href="#loc_120_1_120_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_21&#39;)"><span class="hl_varref"><span class="mpre">addFilePathToIOError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;openBinaryFile&quot;</span></span><span class="mpre"> </span><a href="#loc_177_16_177_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_16_177_18&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_180_7_180_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_7_180_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">))

</span><a href="#loc_183_1_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_10&#39;)"><span class="mpre">openFile&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">IOMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">
</span><a name="loc_183_1_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_10&#39;)"><span class="hl_fundecl"><span class="mpre">openFile&#39;</span></span></a><span class="mpre"> </span><a name="loc_183_11_183_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_19&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a name="loc_183_20_183_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_20_183_26&#39;)"><span class="hl_vardecl"><span class="mpre">iomode</span></span></a><span class="mpre"> </span><a name="loc_183_27_183_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_27_183_33&#39;)"><span class="hl_vardecl"><span class="mpre">binary</span></span></a><span class="mpre"> </span><a name="loc_183_34_183_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_34_183_46&#39;)"><span class="hl_vardecl"><span class="mpre">non_blocking</span></span></a><span class="mpre"> = do
  </span><span class="hl_comment"><span class="mpre">-- first open the file to get an FD</span></span><span class="mpre">
  (</span><a name="loc_185_4_185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_4_185_6&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre">, </span><a name="loc_185_8_185_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_8_185_15&#39;)"><span class="hl_vardecl"><span class="mpre">fd_type</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">FD.openFile</span></span><span class="mpre"> </span><a href="#loc_183_11_183_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_19&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a href="#loc_183_20_183_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_20_183_26&#39;)"><span class="hl_varref"><span class="mpre">iomode</span></span></a><span class="mpre"> </span><a href="#loc_183_34_183_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_34_183_46&#39;)"><span class="hl_varref"><span class="mpre">non_blocking</span></span></a><span class="mpre">

  </span><a name="loc_187_3_187_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_3_187_11&#39;)"><span class="hl_vardecl"><span class="mpre">mb_codec</span></span></a><span class="mpre"> &lt;- if </span><a href="#loc_183_27_183_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_27_183_33&#39;)"><span class="hl_varref"><span class="mpre">binary</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.html#loc_133_2_133_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.html#loc_133_2_133_19&#39;)"><span class="hl_varref"><span class="mpre">getLocaleEncoding</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- then use it to make a Handle</span></span><span class="mpre">
  </span><a href="#loc_213_1_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_15&#39;)"><span class="hl_varref"><span class="mpre">mkHandleFromFD</span></span></a><span class="mpre"> </span><a href="#loc_185_4_185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_4_185_6&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><a href="#loc_185_8_185_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_8_185_15&#39;)"><span class="hl_varref"><span class="mpre">fd_type</span></span></a><span class="mpre"> </span><a href="#loc_183_11_183_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_19&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a href="#loc_183_20_183_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_20_183_26&#39;)"><span class="hl_varref"><span class="mpre">iomode</span></span></a><span class="mpre">
                   </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">{- do not *set* non-blocking mode -}</span></span><span class="mpre">
                   </span><a href="#loc_187_3_187_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_3_187_11&#39;)"><span class="hl_varref"><span class="mpre">mb_codec</span></span></a><span class="mpre">
            </span><a href="GHC.IO.html#loc_360_1_360_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_360_1_360_12&#39;)"><span class="hl_infix"><span class="mpre">`onException`</span></span></a><span class="mpre"> </span><a href="GHC.IO.Device.html#loc_71_3_71_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Device.html#loc_71_3_71_8&#39;)"><span class="hl_varref"><span class="mpre">IODevice.close</span></span></a><span class="mpre"> </span><a href="#loc_185_4_185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_4_185_6&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- NB. don&#39;t forget to close the FD if mkHandleFromFD fails, otherwise</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- this FD leaks.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- ASSERT: if we just created the file, then fdToHandle&#39; won&#39;t fail</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- (so we don&#39;t need to worry about removing the newly created file</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">--  in the event of an error).</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Converting file descriptors to Handles</span></span><span class="mpre">

</span><a href="#loc_213_1_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_15&#39;)"><span class="mpre">mkHandleFromFD</span></a><span class="mpre">
   :: </span><span class="hl_tyconref"><span class="mpre">FD.FD</span></span><span class="mpre">
   -&gt; </span><a href="GHC.IO.Device.html#loc_139_6_139_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Device.html#loc_139_6_139_18&#39;)"><span class="hl_tyconref"><span class="mpre">IODeviceType</span></span></a><span class="mpre">
   -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- a string describing this file descriptor (e.g. the filename)</span></span><span class="mpre">
   -&gt; </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">IOMode</span></span></a><span class="mpre">
   -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">--  *set* non-blocking mode on the FD</span></span><span class="mpre">
   -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_107_6_107_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_107_6_107_18&#39;)"><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span></a><span class="mpre">
   -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">

</span><a name="loc_213_1_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_15&#39;)"><span class="hl_fundecl"><span class="mpre">mkHandleFromFD</span></span></a><span class="mpre"> </span><a name="loc_213_16_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_16_213_19&#39;)"><span class="hl_vardecl"><span class="mpre">fd0</span></span></a><span class="mpre"> </span><a name="loc_213_20_213_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_20_213_27&#39;)"><span class="hl_vardecl"><span class="mpre">fd_type</span></span></a><span class="mpre"> </span><a name="loc_213_28_213_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_28_213_36&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a name="loc_213_37_213_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_37_213_43&#39;)"><span class="hl_vardecl"><span class="mpre">iomode</span></span></a><span class="mpre"> </span><a name="loc_213_44_213_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_44_213_60&#39;)"><span class="hl_vardecl"><span class="mpre">set_non_blocking</span></span></a><span class="mpre"> </span><a name="loc_213_61_213_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_61_213_69&#39;)"><span class="hl_vardecl"><span class="mpre">mb_codec</span></span></a><span class="mpre">
  = do
#ifndef mingw32_HOST_OS
    </span><span class="hl_comment"><span class="mpre">-- turn on non-blocking mode</span></span><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">fd</span></span><span class="mpre"> &lt;- if </span><a href="#loc_213_44_213_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_44_213_60&#39;)"><span class="hl_varref"><span class="mpre">set_non_blocking</span></span></a><span class="mpre"> 
             then </span><span class="hl_varref"><span class="mpre">FD.setNonBlockingMode</span></span><span class="mpre"> </span><a href="#loc_213_16_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_16_213_19&#39;)"><span class="hl_varref"><span class="mpre">fd0</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
             else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_213_16_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_16_213_19&#39;)"><span class="hl_varref"><span class="mpre">fd0</span></span></a><span class="mpre">
#else
    let _ = </span><a href="#loc_213_44_213_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_44_213_60&#39;)"><span class="hl_varref"><span class="mpre">set_non_blocking</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- warning suppression</span></span><span class="mpre">
    </span><a name="loc_222_5_222_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_5_222_7&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_213_16_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_16_213_19&#39;)"><span class="hl_varref"><span class="mpre">fd0</span></span></a><span class="mpre">
#endif

    let </span><a name="loc_225_9_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_11&#39;)"><span class="hl_vardecl"><span class="mpre">nl</span></span></a><span class="mpre"> | </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_213_61_213_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_61_213_69&#39;)"><span class="hl_varref"><span class="mpre">mb_codec</span></span></a><span class="mpre"> = </span><a href="GHC.IO.Handle.Types.html#loc_398_1_398_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_398_1_398_18&#39;)"><span class="hl_varref"><span class="mpre">nativeNewlineMode</span></span></a><span class="mpre">
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = </span><a href="GHC.IO.Handle.Types.html#loc_406_1_406_21" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_406_1_406_21&#39;)"><span class="hl_varref"><span class="mpre">noNewlineTranslation</span></span></a><span class="mpre">

    case </span><a href="#loc_213_20_213_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_20_213_27&#39;)"><span class="hl_varref"><span class="mpre">fd_type</span></span></a><span class="mpre"> of
        </span><a href="GHC.IO.Device.html#loc_140_5_140_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Device.html#loc_140_5_140_14&#39;)"><span class="hl_conref"><span class="mpre">Directory</span></span></a><span class="mpre"> -&gt; 
           </span><a href="GHC.IO.Exception.html#loc_217_1_217_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_217_1_217_12&#39;)"><span class="hl_varref"><span class="mpre">ioException</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">IOError</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="GHC.IO.Exception.html#loc_273_5_273_22" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_273_5_273_22&#39;)"><span class="hl_conref"><span class="mpre">InappropriateType</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;openFile&quot;</span></span><span class="mpre">
                           </span><span class="hl_string"><span class="mpre">&quot;is a directory&quot;</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)

        </span><a href="GHC.IO.Device.html#loc_148_5_148_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Device.html#loc_148_5_148_11&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre">
           </span><span class="hl_comment"><span class="mpre">-- only *Streams* can be DuplexHandles.  Other read/write</span></span><span class="mpre">
           </span><span class="hl_comment"><span class="mpre">-- Handles must share a buffer.</span></span><span class="mpre">
           | </span><a href="GHC.IO.IOMode.html#loc_28_57_28_70" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_57_28_70&#39;)"><span class="hl_conref"><span class="mpre">ReadWriteMode</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_213_37_213_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_37_213_43&#39;)"><span class="hl_varref"><span class="mpre">iomode</span></span></a><span class="mpre"> -&gt; 
                </span><a href="GHC.IO.Handle.Internals.html#loc_671_1_671_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_671_1_671_15&#39;)"><span class="hl_varref"><span class="mpre">mkDuplexHandle</span></span></a><span class="mpre"> </span><a href="#loc_222_5_222_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_5_222_7&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><a href="#loc_213_28_213_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_28_213_36&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a href="#loc_213_61_213_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_61_213_69&#39;)"><span class="hl_varref"><span class="mpre">mb_codec</span></span></a><span class="mpre"> </span><a href="#loc_225_9_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_11&#39;)"><span class="hl_varref"><span class="mpre">nl</span></span></a><span class="mpre">
                   

        </span><span class="hl_vardecl"><span class="mpre">_other</span></span><span class="mpre"> -&gt; 
           </span><a href="GHC.IO.Handle.Internals.html#loc_661_1_661_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_661_1_661_13&#39;)"><span class="hl_varref"><span class="mpre">mkFileHandle</span></span></a><span class="mpre"> </span><a href="#loc_222_5_222_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_5_222_7&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><a href="#loc_213_28_213_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_28_213_36&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a href="#loc_213_37_213_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_37_213_43&#39;)"><span class="hl_varref"><span class="mpre">iomode</span></span></a><span class="mpre"> </span><a href="#loc_213_61_213_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_61_213_69&#39;)"><span class="hl_varref"><span class="mpre">mb_codec</span></span></a><span class="mpre"> </span><a href="#loc_225_9_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_11&#39;)"><span class="hl_varref"><span class="mpre">nl</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Old API kept to avoid breaking clients</span></span><span class="mpre">
</span><a href="#loc_251_1_251_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_12&#39;)"><span class="mpre">fdToHandle&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre">
            -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="GHC.IO.Device.html#loc_139_6_139_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Device.html#loc_139_6_139_18&#39;)"><span class="hl_tyconref"><span class="mpre">IODeviceType</span></span></a><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- is_socket on Win, non-blocking on Unix</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
            -&gt; </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">IOMode</span></span></a><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- binary</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">
</span><a name="loc_251_1_251_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_12&#39;)"><span class="hl_fundecl"><span class="mpre">fdToHandle&#39;</span></span></a><span class="mpre"> </span><a name="loc_251_13_251_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_13_251_18&#39;)"><span class="hl_vardecl"><span class="mpre">fdint</span></span></a><span class="mpre"> </span><a name="loc_251_19_251_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_19_251_26&#39;)"><span class="hl_vardecl"><span class="mpre">mb_type</span></span></a><span class="mpre"> </span><a name="loc_251_27_251_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_27_251_36&#39;)"><span class="hl_vardecl"><span class="mpre">is_socket</span></span></a><span class="mpre"> </span><a name="loc_251_37_251_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_37_251_45&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a name="loc_251_46_251_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_46_251_52&#39;)"><span class="hl_vardecl"><span class="mpre">iomode</span></span></a><span class="mpre"> </span><a name="loc_251_53_251_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_53_251_59&#39;)"><span class="hl_vardecl"><span class="mpre">binary</span></span></a><span class="mpre"> = do
  let </span><a name="loc_252_7_252_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_7_252_14&#39;)"><span class="hl_vardecl"><span class="mpre">mb_stat</span></span></a><span class="mpre"> = case </span><a href="#loc_251_19_251_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_19_251_26&#39;)"><span class="hl_varref"><span class="mpre">mb_type</span></span></a><span class="mpre"> of
                        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">          -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
                          </span><span class="hl_comment"><span class="mpre">-- mkFD will do the stat:</span></span><span class="mpre">
                        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="GHC.IO.Device.html#loc_152_5_152_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Device.html#loc_152_5_152_16&#39;)"><span class="hl_conref"><span class="mpre">RegularFile</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
                          </span><span class="hl_comment"><span class="mpre">-- no stat required for streams etc.:</span></span><span class="mpre">
                        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_257_30_257_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_30_257_35&#39;)"><span class="hl_vardecl"><span class="mpre">other</span></span></a><span class="mpre">       -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_257_30_257_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_30_257_35&#39;)"><span class="hl_varref"><span class="mpre">other</span></span></a><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
  (</span><a name="loc_258_4_258_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_4_258_6&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre">,</span><a name="loc_258_7_258_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_7_258_14&#39;)"><span class="hl_vardecl"><span class="mpre">fd_type</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">FD.mkFD</span></span><span class="mpre"> </span><a href="#loc_251_13_251_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_13_251_18&#39;)"><span class="hl_varref"><span class="mpre">fdint</span></span></a><span class="mpre"> </span><a href="#loc_251_46_251_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_46_251_52&#39;)"><span class="hl_varref"><span class="mpre">iomode</span></span></a><span class="mpre"> </span><a href="#loc_252_7_252_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_7_252_14&#39;)"><span class="hl_varref"><span class="mpre">mb_stat</span></span></a><span class="mpre">
                       </span><a href="#loc_251_27_251_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_27_251_36&#39;)"><span class="hl_varref"><span class="mpre">is_socket</span></span></a><span class="mpre">
                       </span><a href="#loc_251_27_251_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_27_251_36&#39;)"><span class="hl_varref"><span class="mpre">is_socket</span></span></a><span class="mpre">
  </span><a name="loc_261_3_261_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_3_261_6&#39;)"><span class="hl_vardecl"><span class="mpre">enc</span></span></a><span class="mpre"> &lt;- if </span><a href="#loc_251_53_251_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_53_251_59&#39;)"><span class="hl_varref"><span class="mpre">binary</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.html#loc_133_2_133_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.html#loc_133_2_133_19&#39;)"><span class="hl_varref"><span class="mpre">getLocaleEncoding</span></span></a><span class="mpre">
  </span><a href="#loc_213_1_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_15&#39;)"><span class="hl_varref"><span class="mpre">mkHandleFromFD</span></span></a><span class="mpre"> </span><a href="#loc_258_4_258_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_4_258_6&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><a href="#loc_258_7_258_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_7_258_14&#39;)"><span class="hl_varref"><span class="mpre">fd_type</span></span></a><span class="mpre"> </span><a href="#loc_251_37_251_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_37_251_45&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a href="#loc_251_46_251_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_46_251_52&#39;)"><span class="hl_varref"><span class="mpre">iomode</span></span></a><span class="mpre"> </span><a href="#loc_251_27_251_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_27_251_36&#39;)"><span class="hl_varref"><span class="mpre">is_socket</span></span></a><span class="mpre"> </span><a href="#loc_261_3_261_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_3_261_6&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Turn an existing file descriptor into a Handle.  This is used by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- various external libraries to make Handles.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Makes a binary Handle.  This is for historical reasons; it should</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- probably be a text Handle with the default encoding and newline</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- translation instead.</span></span><span class="mpre">
</span><a href="#loc_272_1_272_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_11&#39;)"><span class="mpre">fdToHandle</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Posix.FD</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">
</span><a name="loc_272_1_272_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_11&#39;)"><span class="hl_fundecl"><span class="mpre">fdToHandle</span></span></a><span class="mpre"> </span><a name="loc_272_12_272_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_12_272_17&#39;)"><span class="hl_vardecl"><span class="mpre">fdint</span></span></a><span class="mpre"> = do
   </span><a name="loc_273_4_273_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_4_273_10&#39;)"><span class="hl_vardecl"><span class="mpre">iomode</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">Posix.fdGetMode</span></span><span class="mpre"> </span><a href="#loc_272_12_272_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_12_272_17&#39;)"><span class="hl_varref"><span class="mpre">fdint</span></span></a><span class="mpre">
   (</span><a name="loc_274_5_274_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_7&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre">,</span><a name="loc_274_8_274_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_8_274_15&#39;)"><span class="hl_vardecl"><span class="mpre">fd_type</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">FD.mkFD</span></span><span class="mpre"> </span><a href="#loc_272_12_272_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_12_272_17&#39;)"><span class="hl_varref"><span class="mpre">fdint</span></span></a><span class="mpre"> </span><a href="#loc_273_4_273_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_4_273_10&#39;)"><span class="hl_varref"><span class="mpre">iomode</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">False</span></span><span class="hl_comment"><span class="mpre">{-is_socket-}</span></span><span class="mpre"> 
              </span><span class="hl_comment"><span class="mpre">-- NB. the is_socket flag is False, meaning that:</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">--  on Windows we&#39;re guessing this is not a socket (XXX)</span></span><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">False</span></span><span class="hl_comment"><span class="mpre">{-is_nonblock-}</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- file descriptors that we get from external sources are</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- not put into non-blocking mode, because that would affect</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- other users of the file descriptor</span></span><span class="mpre">
   let </span><a name="loc_282_8_282_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_8_282_14&#39;)"><span class="hl_vardecl"><span class="mpre">fd_str</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&lt;file descriptor: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_274_5_274_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_7&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&gt;&quot;</span></span><span class="mpre">
   </span><a href="#loc_213_1_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_15&#39;)"><span class="hl_varref"><span class="mpre">mkHandleFromFD</span></span></a><span class="mpre"> </span><a href="#loc_274_5_274_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_7&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><a href="#loc_274_8_274_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_8_274_15&#39;)"><span class="hl_varref"><span class="mpre">fd_type</span></span></a><span class="mpre"> </span><a href="#loc_282_8_282_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_8_282_14&#39;)"><span class="hl_varref"><span class="mpre">fd_str</span></span></a><span class="mpre"> </span><a href="#loc_273_4_273_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_4_273_10&#39;)"><span class="hl_varref"><span class="mpre">iomode</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="hl_comment"><span class="mpre">{-non-block-}</span></span><span class="mpre"> 
                  </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- bin mode</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Are files opened by default in text or binary mode, if the user doesn&#39;t</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- specify?</span></span><span class="mpre">

</span><a href="#loc_291_1_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_28&#39;)"><span class="mpre">dEFAULT_OPEN_IN_BINARY_MODE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_291_1_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_28&#39;)"><span class="hl_vardecl"><span class="mpre">dEFAULT_OPEN_IN_BINARY_MODE</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span></div></body></html>