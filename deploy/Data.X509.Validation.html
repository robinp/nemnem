<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.Validation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- X.509 Certificate checks and validations routines</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Follows RFC5280 / RFC6818</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.X509.Validation
    (
      module Data.X509.Validation.Types
    , Fingerprint(..)
    </span><span class="hl_comment"><span class="mpre">-- * Failed validation types</span></span><span class="mpre">
    , FailedReason(..)
    , SignatureFailure(..)
    </span><span class="hl_comment"><span class="mpre">-- * Validation configuration types</span></span><span class="mpre">
    , ValidationChecks(..)
    , ValidationHooks(..)
    , defaultChecks
    , defaultHooks
    </span><span class="hl_comment"><span class="mpre">-- * Validation</span></span><span class="mpre">
    , validate
    , validateDefault
    , getFingerprint
    </span><span class="hl_comment"><span class="mpre">-- * Cache</span></span><span class="mpre">
    , module Data.X509.Validation.Cache
    ) where

import Control.Applicative
import Control.Monad (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import Data.Default.Class
import Data.ASN1.Types
import Data.X509
import Data.X509.CertificateStore
import Data.X509.Validation.Signature
import Data.X509.Validation.Fingerprint
import Data.X509.Validation.Cache
import Data.X509.Validation.Types
import Data.Time.Clock
import Data.Maybe
import Data.List

</span><span class="hl_comment"><span class="mpre">-- | Possible reason of certificate and chain failure</span></span><span class="mpre">
data </span><a name="loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tycondecl"><span class="mpre">FailedReason</span></span></a><span class="mpre"> =
      </span><a name="loc_48_7_48_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_31&#39;)"><span class="hl_condecl"><span class="mpre">UnknownCriticalExtension</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ certificate contains an unknown critical extension</span></span><span class="mpre">
    | </span><a name="loc_49_7_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_14&#39;)"><span class="hl_condecl"><span class="mpre">Expired</span></span></a><span class="mpre">                  </span><span class="hl_comment"><span class="mpre">-- ^ validity ends before checking time</span></span><span class="mpre">
    | </span><a name="loc_50_7_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_15&#39;)"><span class="hl_condecl"><span class="mpre">InFuture</span></span></a><span class="mpre">                 </span><span class="hl_comment"><span class="mpre">-- ^ validity starts after checking time</span></span><span class="mpre">
    | </span><a name="loc_51_7_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_7_51_17&#39;)"><span class="hl_condecl"><span class="mpre">SelfSigned</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- ^ certificate is self signed</span></span><span class="mpre">
    | </span><a name="loc_52_7_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_16&#39;)"><span class="hl_condecl"><span class="mpre">UnknownCA</span></span></a><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- ^ unknown Certificate Authority (CA)</span></span><span class="mpre">
    | </span><a name="loc_53_7_53_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_7_53_23&#39;)"><span class="hl_condecl"><span class="mpre">NotAllowedToSign</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ certificate is not allowed to sign</span></span><span class="mpre">
    | </span><a name="loc_54_7_54_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_7_54_21&#39;)"><span class="hl_condecl"><span class="mpre">NotAnAuthority</span></span></a><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ not a CA</span></span><span class="mpre">
    | </span><a name="loc_55_7_55_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_23&#39;)"><span class="hl_condecl"><span class="mpre">AuthorityTooDeep</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ Violation of the optional Basic constraint&#39;s path length</span></span><span class="mpre">
    | </span><a name="loc_56_7_56_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_19&#39;)"><span class="hl_condecl"><span class="mpre">NoCommonName</span></span></a><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ Certificate doesn&#39;t have any common name (CN)</span></span><span class="mpre">
    | </span><a name="loc_57_7_57_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_18&#39;)"><span class="hl_condecl"><span class="mpre">InvalidName</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ Invalid name in certificate</span></span><span class="mpre">
    | </span><a name="loc_58_7_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_19&#39;)"><span class="hl_condecl"><span class="mpre">NameMismatch</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ connection name and certificate do not match</span></span><span class="mpre">
    | </span><a name="loc_59_7_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_7_59_22&#39;)"><span class="hl_condecl"><span class="mpre">InvalidWildcard</span></span></a><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^ invalid wildcard in certificate</span></span><span class="mpre">
    | </span><a name="loc_60_7_60_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_7_60_29&#39;)"><span class="hl_condecl"><span class="mpre">LeafKeyUsageNotAllowed</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ the requested key usage is not compatible with the leaf certificate&#39;s key usage</span></span><span class="mpre">
    | </span><a name="loc_61_7_61_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_31&#39;)"><span class="hl_condecl"><span class="mpre">LeafKeyPurposeNotAllowed</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ the requested key purpose is not compatible with the leaf certificate&#39;s extended key usage</span></span><span class="mpre">
    | </span><a name="loc_62_7_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_16&#39;)"><span class="hl_condecl"><span class="mpre">LeafNotV3</span></span></a><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- ^ Only authorized an X509.V3 certificate as leaf certificate.</span></span><span class="mpre">
    | </span><a name="loc_63_7_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_17&#39;)"><span class="hl_condecl"><span class="mpre">EmptyChain</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- ^ empty chain of certificate</span></span><span class="mpre">
    | </span><a name="loc_64_7_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_18&#39;)"><span class="hl_condecl"><span class="mpre">CacheSaysNo</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ the cache explicitely denied this certificate</span></span><span class="mpre">
    | </span><a name="loc_65_7_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_23&#39;)"><span class="hl_condecl"><span class="mpre">InvalidSignature</span></span></a><span class="mpre"> </span><a href="Data.X509.Validation.Signature.html#loc_42_6_42_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Signature.html#loc_42_6_42_22&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureFailure</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ signature failed</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 5, srcSpanEndLine = 66, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 5, srcSpanEndLine = 66, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Val"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A set of checks to activate or parametrize to perform on certificates.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It&#39;s recommended to use &#39;defaultChecks&#39; to create the structure,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to better cope with future changes or expansion of the structure.</span></span><span class="mpre">
data </span><a name="loc_72_6_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_6_72_22&#39;)"><span class="hl_tycondecl"><span class="mpre">ValidationChecks</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">ValidationChecks</span></span><span class="mpre">
    {
    </span><span class="hl_comment"><span class="mpre">-- | check time validity of every certificate in the chain.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the make sure that current time is between each validity bounds</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- in the certificate</span></span><span class="mpre">
      </span><a name="loc_77_7_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_7_77_24&#39;)"><span class="hl_fielddecl"><span class="mpre">checkTimeValidity</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | The time when the validity check happens. When set to Nothing,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the current time will be used</span></span><span class="mpre">
    , </span><a name="loc_80_7_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_7_80_18&#39;)"><span class="hl_fielddecl"><span class="mpre">checkAtTime</span></span></a><span class="mpre">         :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | Check that no certificate is included that shouldn&#39;t be included.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- unfortunately despite the specification violation, a lots of</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- real world server serves useless and usually old certificates</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- that are not relevant to the certificate sent, in their chain.</span></span><span class="mpre">
    , </span><a name="loc_85_7_85_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_26&#39;)"><span class="hl_fielddecl"><span class="mpre">checkStrictOrdering</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | Check that signing certificate got the CA basic constraint.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- this is absolutely not recommended to turn it off.</span></span><span class="mpre">
    , </span><a name="loc_88_7_88_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_25&#39;)"><span class="hl_fielddecl"><span class="mpre">checkCAConstraints</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | Check the whole certificate chain without stopping at the first failure.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Allow gathering a exhaustive list of failure reasons. if this is</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- turn off, it&#39;s absolutely not safe to ignore a failed reason even it doesn&#39;t look serious</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- (e.g. Expired) as other more serious checks would not have been performed.</span></span><span class="mpre">
    , </span><a name="loc_93_7_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_22&#39;)"><span class="hl_fielddecl"><span class="mpre">checkExhaustive</span></span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | Check that the leaf certificate is version 3. If disable, version 2 certificate</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- is authorized in leaf position and key usage cannot be checked.</span></span><span class="mpre">
    , </span><a name="loc_96_7_96_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_18&#39;)"><span class="hl_fielddecl"><span class="mpre">checkLeafV3</span></span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | Check that the leaf certificate is authorized to be used for certain usage.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- If set to empty list no check are performed, otherwise all the flags is the list</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- need to exists in the key usage extension. If the extension is not present,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the check will pass and behave as if the certificate key is not restricted to</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- any specific usage.</span></span><span class="mpre">
    , </span><a name="loc_102_7_102_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_7_102_24&#39;)"><span class="hl_fielddecl"><span class="mpre">checkLeafKeyUsage</span></span></a><span class="mpre">   :: [</span><a href="Data.X509.Ext.html#loc_43_6_43_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_43_6_43_21&#39;)"><span class="hl_tyconref"><span class="mpre">ExtKeyUsageFlag</span></span></a><span class="mpre">]
    </span><span class="hl_comment"><span class="mpre">-- | Check that the leaf certificate is authorized to be used for certain purpose.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- If set to empty list no check are performed, otherwise all the flags is the list</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- need to exists in the extended key usage extension if present. If the extension is not</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- present, then the check will pass and behave as if the certificate is not restricted</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- to any specific purpose.</span></span><span class="mpre">
    , </span><a name="loc_108_7_108_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_7_108_26&#39;)"><span class="hl_fielddecl"><span class="mpre">checkLeafKeyPurpose</span></span></a><span class="mpre"> :: [</span><a href="Data.X509.Ext.html#loc_124_6_124_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_124_6_124_24&#39;)"><span class="hl_tyconref"><span class="mpre">ExtKeyUsagePurpose</span></span></a><span class="mpre">]
    </span><span class="hl_comment"><span class="mpre">-- | Check the top certificate names matching the fully qualified hostname (FQHN).</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- it&#39;s not recommended to turn this check off, if no other name checks are performed.</span></span><span class="mpre">
    , </span><a name="loc_111_7_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_7_111_16&#39;)"><span class="hl_fielddecl"><span class="mpre">checkFQHN</span></span></a><span class="mpre">           :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 112, srcSpanStartColumn = 7, srcSpanEndLine = 112, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 112, srcSpanStartColumn = 7, srcSpanEndLine = 112, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A set of hooks to manipulate the way the verification works.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- BEWARE, it&#39;s easy to change behavior leading to compromised security.</span></span><span class="mpre">
data </span><a name="loc_117_6_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_21&#39;)"><span class="hl_tycondecl"><span class="mpre">ValidationHooks</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">ValidationHooks</span></span><span class="mpre">
    {
    </span><span class="hl_comment"><span class="mpre">-- | check the the issuer &#39;DistinguishedName&#39; match the subject &#39;DistinguishedName&#39;</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- of a certificate.</span></span><span class="mpre">
      </span><a name="loc_121_7_121_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_29&#39;)"><span class="hl_fielddecl"><span class="mpre">hookMatchSubjectIssuer</span></span></a><span class="mpre"> :: </span><a href="Data.X509.DistinguishedName.html#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.DistinguishedName.html#loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> -&gt; </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | validate that the parametrized time valide with the certificate in argument</span></span><span class="mpre">
    , </span><a name="loc_123_7_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_23&#39;)"><span class="hl_fielddecl"><span class="mpre">hookValidateTime</span></span></a><span class="mpre">       :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre"> -&gt; </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
    </span><span class="hl_comment"><span class="mpre">-- | validate the certificate leaf name with the DNS named used to connect</span></span><span class="mpre">
    , </span><a name="loc_125_7_125_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_7_125_23&#39;)"><span class="hl_fielddecl"><span class="mpre">hookValidateName</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">HostName</span></span><span class="mpre"> -&gt; </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
    </span><span class="hl_comment"><span class="mpre">-- | user filter to modify the list of failure reasons</span></span><span class="mpre">
    , </span><a name="loc_127_7_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_7_127_23&#39;)"><span class="hl_fielddecl"><span class="mpre">hookFilterReason</span></span></a><span class="mpre">       :: [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">] -&gt; [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
    }

</span><span class="hl_comment"><span class="mpre">-- | Default checks to perform</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The default checks are:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Each certificate time is valid</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * CA constraints is enforced for signing certificate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Leaf certificate is X.509 v3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Check that the FQHN match</span></span><span class="mpre">
</span><a href="#loc_138_1_138_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_14&#39;)"><span class="mpre">defaultChecks</span></a><span class="mpre"> :: </span><a href="#loc_72_6_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_6_72_22&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationChecks</span></span></a><span class="mpre">
</span><a name="loc_138_1_138_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_14&#39;)"><span class="hl_vardecl"><span class="mpre">defaultChecks</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 138, srcSpanStartColumn = 17, srcSpanEndLine = 148, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 139, srcSpanStartColumn = 5, srcSpanEndLine = 139, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509"><span class="mpre">ValidationChecks
    { checkTimeValidity   = True
    , checkAtTime         = Nothing
    , checkStrictOrdering = False
    , checkCAConstraints  = True
    , checkExhaustive     = False
    , checkLeafV3         = True
    , checkLeafKeyUsage   = []
    , checkLeafKeyPurpose = []
    , checkFQHN           = True
    }</span></span><span class="mpre">

instance </span><a href="Data.Default.Class.html#loc_38_7_38_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_38_7_38_14&#39;)"><span class="hl_classref"><span class="mpre">Default</span></span></a><span class="mpre"> </span><a href="#loc_72_6_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_6_72_22&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationChecks</span></span></a><span class="mpre"> where
    </span><a href="Data.Default.Class.html#loc_40_5_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_40_5_40_8&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> = </span><a href="#loc_138_1_138_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_14&#39;)"><span class="hl_varref"><span class="mpre">defaultChecks</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Default hooks in the validation process</span></span><span class="mpre">
</span><a href="#loc_155_1_155_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_13&#39;)"><span class="mpre">defaultHooks</span></a><span class="mpre"> :: </span><a href="#loc_117_6_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_21&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationHooks</span></span></a><span class="mpre">
</span><a name="loc_155_1_155_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_13&#39;)"><span class="hl_vardecl"><span class="mpre">defaultHooks</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 16, srcSpanEndLine = 160, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 156, srcSpanStartColumn = 5, srcSpanEndLine = 156, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509"><span class="mpre">ValidationHooks
    { hookMatchSubjectIssuer = matchSI
    , hookValidateTime       = validateTime
    , hookValidateName       = validateCertificateName
    , hookFilterReason       = id
    }</span></span><span class="mpre">

instance </span><a href="Data.Default.Class.html#loc_38_7_38_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_38_7_38_14&#39;)"><span class="hl_classref"><span class="mpre">Default</span></span></a><span class="mpre"> </span><a href="#loc_117_6_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_21&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationHooks</span></span></a><span class="mpre"> where
    </span><a href="Data.Default.Class.html#loc_40_5_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_40_5_40_8&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> = </span><a href="#loc_155_1_155_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_13&#39;)"><span class="hl_varref"><span class="mpre">defaultHooks</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Validate using the default hooks and checks and the SHA256 mechanism as hashing mechanism</span></span><span class="mpre">
</span><a href="#loc_171_1_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_16&#39;)"><span class="mpre">validateDefault</span></a><span class="mpre"> :: </span><a href="Data.X509.CertificateStore.html#loc_16_6_16_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateStore.html#loc_16_6_16_22&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateStore</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ The trusted certificate store for CA</span></span><span class="mpre">
                -&gt; </span><a href="Data.X509.Validation.Cache.html#loc_50_6_50_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Cache.html#loc_50_6_50_21&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationCache</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ the validation cache callbacks</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">ServiceID</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ identification of the connection</span></span><span class="mpre">
                -&gt; </span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ the certificate chain we want to validate</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ the return failed reasons (empty list is no failure)</span></span><span class="mpre">
</span><a name="loc_171_1_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_16&#39;)"><span class="hl_vardecl"><span class="mpre">validateDefault</span></span></a><span class="mpre"> = </span><a href="#loc_186_1_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_9&#39;)"><span class="hl_varref"><span class="mpre">validate</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_23_7_23_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_23_7_23_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA256</span></span></a><span class="mpre"> </span><a href="#loc_155_1_155_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_13&#39;)"><span class="hl_varref"><span class="mpre">defaultHooks</span></span></a><span class="mpre"> </span><a href="#loc_138_1_138_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_14&#39;)"><span class="hl_varref"><span class="mpre">defaultChecks</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | X509 validation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the function first interrogate the cache and if the validation fail,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- proper verification is done. If the verification pass, the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- add to cache callback is called.</span></span><span class="mpre">
</span><a href="#loc_186_1_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_9&#39;)"><span class="mpre">validate</span></a><span class="mpre"> :: </span><a href="Data.X509.AlgorithmIdentifier.html#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">HashALG</span></span></a><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ the hash algorithm we want to use for hashing the leaf certificate</span></span><span class="mpre">
         -&gt; </span><a href="#loc_117_6_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_21&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationHooks</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Hooks to use</span></span><span class="mpre">
         -&gt; </span><a href="#loc_72_6_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_6_72_22&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationChecks</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Checks to do</span></span><span class="mpre">
         -&gt; </span><a href="Data.X509.CertificateStore.html#loc_16_6_16_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateStore.html#loc_16_6_16_22&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateStore</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ The trusted certificate store for CA</span></span><span class="mpre">
         -&gt; </span><a href="Data.X509.Validation.Cache.html#loc_50_6_50_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Cache.html#loc_50_6_50_21&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationCache</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ the validation cache callbacks</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">ServiceID</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ identification of the connection</span></span><span class="mpre">
         -&gt; </span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ the certificate chain we want to validate</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ the return failed reasons (empty list is no failure)</span></span><span class="mpre">
</span><a name="loc_186_1_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_9&#39;)"><span class="hl_fundecl"><span class="mpre">validate</span></span></a><span class="mpre"> _ _ _ _ _ _ (</span><a href="Data.X509.CertificateChain.html#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_28_21_44&#39;)"><span class="hl_conref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> []) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_63_7_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_17&#39;)"><span class="hl_conref"><span class="mpre">EmptyChain</span></span></a><span class="mpre">]
</span><a href="#loc_186_1_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_9&#39;)"><span class="hl_fundecl"><span class="mpre">validate</span></span></a><span class="mpre"> </span><a name="loc_187_10_187_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_17&#39;)"><span class="hl_vardecl"><span class="mpre">hashAlg</span></span></a><span class="mpre"> </span><a name="loc_187_18_187_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_18_187_23&#39;)"><span class="hl_vardecl"><span class="mpre">hooks</span></span></a><span class="mpre"> </span><a name="loc_187_24_187_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_24_187_30&#39;)"><span class="hl_vardecl"><span class="mpre">checks</span></span></a><span class="mpre"> </span><a name="loc_187_31_187_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_31_187_36&#39;)"><span class="hl_vardecl"><span class="mpre">store</span></span></a><span class="mpre"> </span><a name="loc_187_37_187_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_37_187_42&#39;)"><span class="hl_vardecl"><span class="mpre">cache</span></span></a><span class="mpre"> </span><a name="loc_187_43_187_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_43_187_48&#39;)"><span class="hl_vardecl"><span class="mpre">ident</span></span></a><span class="mpre"> </span><a name="loc_187_49_187_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_49_187_51&#39;)"><span class="hl_specname"><span class="mpre">cc</span></span></a><span class="mpre">@(</span><a href="Data.X509.CertificateChain.html#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_28_21_44&#39;)"><span class="hl_conref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> (</span><a name="loc_187_71_187_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_71_187_74&#39;)"><span class="hl_vardecl"><span class="mpre">top</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)) = do
    </span><a name="loc_188_5_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_5_188_16&#39;)"><span class="hl_vardecl"><span class="mpre">cacheResult</span></span></a><span class="mpre"> &lt;- (</span><a href="Data.X509.Validation.Cache.html#loc_51_7_51_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Cache.html#loc_51_7_51_17&#39;)"><span class="hl_varref"><span class="mpre">cacheQuery</span></span></a><span class="mpre"> </span><a href="#loc_187_37_187_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_37_187_42&#39;)"><span class="hl_varref"><span class="mpre">cache</span></span></a><span class="mpre">) </span><a href="#loc_187_43_187_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_43_187_48&#39;)"><span class="hl_varref"><span class="mpre">ident</span></span></a><span class="mpre"> </span><a href="#loc_197_9_197_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_20&#39;)"><span class="hl_varref"><span class="mpre">fingerPrint</span></span></a><span class="mpre"> (</span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre"> </span><a href="#loc_187_71_187_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_71_187_74&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre">)
    case </span><a href="#loc_188_5_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_5_188_16&#39;)"><span class="hl_varref"><span class="mpre">cacheResult</span></span></a><span class="mpre"> of
        </span><a href="Data.X509.Validation.Cache.html#loc_32_7_32_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Cache.html#loc_32_7_32_26&#39;)"><span class="hl_conref"><span class="mpre">ValidationCachePass</span></span></a><span class="mpre">     -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
        </span><a href="Data.X509.Validation.Cache.html#loc_33_7_33_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Cache.html#loc_33_7_33_28&#39;)"><span class="hl_conref"><span class="mpre">ValidationCacheDenied</span></span></a><span class="mpre"> </span><a name="loc_191_31_191_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_31_191_32&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_64_7_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_18&#39;)"><span class="hl_conref"><span class="mpre">CacheSaysNo</span></span></a><span class="mpre"> </span><a href="#loc_191_31_191_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_31_191_32&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">]
        </span><a href="Data.X509.Validation.Cache.html#loc_34_7_34_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Cache.html#loc_34_7_34_29&#39;)"><span class="hl_conref"><span class="mpre">ValidationCacheUnknown</span></span></a><span class="mpre">  -&gt; do
            </span><a name="loc_193_13_193_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_13_193_27&#39;)"><span class="hl_vardecl"><span class="mpre">validationTime</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getCurrentTime</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_80_7_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_7_80_18&#39;)"><span class="hl_varref"><span class="mpre">checkAtTime</span></span></a><span class="mpre"> </span><a href="#loc_187_24_187_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_24_187_30&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre">
            </span><a name="loc_194_13_194_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_13_194_26&#39;)"><span class="hl_vardecl"><span class="mpre">failedReasons</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_208_1_208_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_11&#39;)"><span class="hl_varref"><span class="mpre">doValidate</span></span></a><span class="mpre"> </span><a href="#loc_193_13_193_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_13_193_27&#39;)"><span class="hl_varref"><span class="mpre">validationTime</span></span></a><span class="mpre"> </span><a href="#loc_187_18_187_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_18_187_23&#39;)"><span class="hl_varref"><span class="mpre">hooks</span></span></a><span class="mpre"> </span><a href="#loc_187_24_187_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_24_187_30&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre"> </span><a href="#loc_187_31_187_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_31_187_36&#39;)"><span class="hl_varref"><span class="mpre">store</span></span></a><span class="mpre"> </span><a href="#loc_187_43_187_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_43_187_48&#39;)"><span class="hl_varref"><span class="mpre">ident</span></span></a><span class="mpre"> </span><a href="#loc_187_49_187_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_49_187_51&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre">
            </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_194_13_194_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_13_194_26&#39;)"><span class="hl_varref"><span class="mpre">failedReasons</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="Data.X509.Validation.Cache.html#loc_52_7_52_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Cache.html#loc_52_7_52_15&#39;)"><span class="hl_varref"><span class="mpre">cacheAdd</span></span></a><span class="mpre"> </span><a href="#loc_187_37_187_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_37_187_42&#39;)"><span class="hl_varref"><span class="mpre">cache</span></span></a><span class="mpre">) </span><a href="#loc_187_43_187_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_43_187_48&#39;)"><span class="hl_varref"><span class="mpre">ident</span></span></a><span class="mpre"> </span><a href="#loc_197_9_197_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_20&#39;)"><span class="hl_varref"><span class="mpre">fingerPrint</span></span></a><span class="mpre"> (</span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre"> </span><a href="#loc_187_71_187_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_71_187_74&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_194_13_194_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_13_194_26&#39;)"><span class="hl_varref"><span class="mpre">failedReasons</span></span></a><span class="mpre">
  where </span><a name="loc_197_9_197_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_20&#39;)"><span class="hl_vardecl"><span class="mpre">fingerPrint</span></span></a><span class="mpre"> = </span><a href="Data.X509.Validation.Fingerprint.html#loc_33_1_33_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Fingerprint.html#loc_33_1_33_15&#39;)"><span class="hl_varref"><span class="mpre">getFingerprint</span></span></a><span class="mpre"> </span><a href="#loc_187_71_187_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_71_187_74&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre"> </span><a href="#loc_187_10_187_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_17&#39;)"><span class="hl_varref"><span class="mpre">hashAlg</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Validate a certificate chain with explicit parameters</span></span><span class="mpre">
</span><a href="#loc_208_1_208_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_11&#39;)"><span class="mpre">doValidate</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
           -&gt; </span><a href="#loc_117_6_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_6_117_21&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationHooks</span></span></a><span class="mpre">
           -&gt; </span><a href="#loc_72_6_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_6_72_22&#39;)"><span class="hl_tyconref"><span class="mpre">ValidationChecks</span></span></a><span class="mpre">
           -&gt; </span><a href="Data.X509.CertificateStore.html#loc_16_6_16_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateStore.html#loc_16_6_16_22&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateStore</span></span></a><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">ServiceID</span></span><span class="mpre">
           -&gt; </span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
</span><a name="loc_208_1_208_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_11&#39;)"><span class="hl_fundecl"><span class="mpre">doValidate</span></span></a><span class="mpre"> _              _     _      _     _        (</span><a href="Data.X509.CertificateChain.html#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_28_21_44&#39;)"><span class="hl_conref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> [])           = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_63_7_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_17&#39;)"><span class="hl_conref"><span class="mpre">EmptyChain</span></span></a><span class="mpre">]
</span><a href="#loc_208_1_208_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_11&#39;)"><span class="hl_fundecl"><span class="mpre">doValidate</span></span></a><span class="mpre"> </span><a name="loc_209_12_209_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_12_209_26&#39;)"><span class="hl_vardecl"><span class="mpre">validationTime</span></span></a><span class="mpre"> </span><a name="loc_209_27_209_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_27_209_32&#39;)"><span class="hl_vardecl"><span class="mpre">hooks</span></span></a><span class="mpre"> </span><a name="loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_vardecl"><span class="mpre">checks</span></span></a><span class="mpre"> </span><a name="loc_209_40_209_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_40_209_45&#39;)"><span class="hl_vardecl"><span class="mpre">store</span></span></a><span class="mpre"> (</span><a name="loc_209_47_209_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_47_209_51&#39;)"><span class="hl_vardecl"><span class="mpre">fqhn</span></span></a><span class="mpre">,_) (</span><a href="Data.X509.CertificateChain.html#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_28_21_44&#39;)"><span class="hl_conref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> (</span><a name="loc_209_74_209_77" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_74_209_77&#39;)"><span class="hl_vardecl"><span class="mpre">top</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_209_78_209_84" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_78_209_84&#39;)"><span class="hl_vardecl"><span class="mpre">rchain</span></span></a><span class="mpre">)) =
   (</span><a href="#loc_127_7_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_7_127_23&#39;)"><span class="hl_varref"><span class="mpre">hookFilterReason</span></span></a><span class="mpre"> </span><a href="#loc_209_27_209_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_27_209_32&#39;)"><span class="hl_varref"><span class="mpre">hooks</span></span></a><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_214_9_214_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_9_214_21&#39;)"><span class="hl_varref"><span class="mpre">doLeafChecks</span></span></a><span class="mpre"> </span><a href="#loc_212_11_212_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_11_212_13&#39;)"><span class="hl_infix"><span class="mpre">|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_218_9_218_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_21&#39;)"><span class="hl_varref"><span class="mpre">doCheckChain</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_209_74_209_77" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_74_209_77&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre"> </span><a href="#loc_209_78_209_84" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_78_209_84&#39;)"><span class="hl_varref"><span class="mpre">rchain</span></span></a><span class="mpre">)
  where </span><a name="loc_211_9_211_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_9_211_21&#39;)"><span class="hl_vardecl"><span class="mpre">isExhaustive</span></span></a><span class="mpre"> = </span><a href="#loc_93_7_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_22&#39;)"><span class="hl_varref"><span class="mpre">checkExhaustive</span></span></a><span class="mpre"> </span><a href="#loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre">
        </span><a name="loc_212_9_212_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_212_11_212_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_11_212_13&#39;)"><span class="hl_fundecl"><span class="mpre">|&gt;</span></span></a><span class="mpre"> </span><a name="loc_212_14_212_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_14_212_15&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_374_1_374_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_11&#39;)"><span class="hl_varref"><span class="mpre">exhaustive</span></span></a><span class="mpre"> </span><a href="#loc_211_9_211_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_9_211_21&#39;)"><span class="hl_varref"><span class="mpre">isExhaustive</span></span></a><span class="mpre"> </span><a href="#loc_212_9_212_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_212_14_212_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_14_212_15&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

        </span><a name="loc_214_9_214_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_9_214_21&#39;)"><span class="hl_vardecl"><span class="mpre">doLeafChecks</span></span></a><span class="mpre"> = </span><a href="#loc_269_9_269_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_9_269_20&#39;)"><span class="hl_varref"><span class="mpre">doNameCheck</span></span></a><span class="mpre"> </span><a href="#loc_209_74_209_77" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_74_209_77&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_273_9_273_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_18&#39;)"><span class="hl_varref"><span class="mpre">doV3Check</span></span></a><span class="mpre"> </span><a href="#loc_215_19_215_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_19_215_26&#39;)"><span class="hl_varref"><span class="mpre">topCert</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_279_9_279_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_9_279_24&#39;)"><span class="hl_varref"><span class="mpre">doKeyUsageCheck</span></span></a><span class="mpre"> </span><a href="#loc_215_19_215_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_19_215_26&#39;)"><span class="hl_varref"><span class="mpre">topCert</span></span></a><span class="mpre">
            where </span><a name="loc_215_19_215_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_19_215_26&#39;)"><span class="hl_vardecl"><span class="mpre">topCert</span></span></a><span class="mpre"> = </span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre"> </span><a href="#loc_209_74_209_77" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_74_209_77&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre">

        </span><a href="#loc_218_9_218_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_21&#39;)"><span class="mpre">doCheckChain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SignedCertificate</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">SignedCertificate</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
        </span><a name="loc_218_9_218_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_21&#39;)"><span class="hl_fundecl"><span class="mpre">doCheckChain</span></span></a><span class="mpre"> </span><a name="loc_218_22_218_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_22_218_27&#39;)"><span class="hl_vardecl"><span class="mpre">level</span></span></a><span class="mpre"> </span><a name="loc_218_28_218_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_28_218_35&#39;)"><span class="hl_vardecl"><span class="mpre">current</span></span></a><span class="mpre"> </span><a name="loc_218_36_218_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_36_218_41&#39;)"><span class="hl_vardecl"><span class="mpre">chain</span></span></a><span class="mpre"> = do
            </span><a name="loc_219_13_219_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_13_219_14&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_297_9_297_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_9_297_27&#39;)"><span class="hl_varref"><span class="mpre">doCheckCertificate</span></span></a><span class="mpre"> (</span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre"> </span><a href="#loc_218_28_218_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_28_218_35&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre">)
            </span><span class="hl_comment"><span class="mpre">-- check if we have a trusted certificate in the store belonging to this issuer.</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_219_13_219_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_13_219_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_212_11_212_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_11_212_13&#39;)"><span class="hl_infix"><span class="mpre">|&gt;</span></span></a><span class="mpre"> (case </span><a href="Data.X509.CertificateStore.html#loc_33_1_33_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateStore.html#loc_33_1_33_16&#39;)"><span class="hl_varref"><span class="mpre">findCertificate</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">certIssuerDN</span></span><span class="mpre"> </span><a href="#loc_232_17_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_17_232_21&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">) </span><a href="#loc_209_40_209_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_40_209_45&#39;)"><span class="hl_varref"><span class="mpre">store</span></span></a><span class="mpre"> of
                </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_222_22_222_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_22_222_39&#39;)"><span class="hl_vardecl"><span class="mpre">trustedSignedCert</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_305_9_305_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_9_305_23&#39;)"><span class="hl_varref"><span class="mpre">checkSignature</span></span></a><span class="mpre"> </span><a href="#loc_218_28_218_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_28_218_35&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre"> </span><a href="#loc_222_22_222_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_22_222_39&#39;)"><span class="hl_varref"><span class="mpre">trustedSignedCert</span></span></a><span class="mpre">
                </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> | </span><a href="#loc_302_9_302_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_9_302_21&#39;)"><span class="hl_varref"><span class="mpre">isSelfSigned</span></span></a><span class="mpre"> </span><a href="#loc_232_17_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_17_232_21&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_51_7_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_7_51_17&#39;)"><span class="hl_conref"><span class="mpre">SelfSigned</span></span></a><span class="mpre">] </span><a href="#loc_212_11_212_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_11_212_13&#39;)"><span class="hl_infix"><span class="mpre">|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_305_9_305_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_9_305_23&#39;)"><span class="hl_varref"><span class="mpre">checkSignature</span></span></a><span class="mpre"> </span><a href="#loc_218_28_218_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_28_218_35&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre"> </span><a href="#loc_218_28_218_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_28_218_35&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre">)
                        | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_218_36_218_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_36_218_41&#39;)"><span class="hl_varref"><span class="mpre">chain</span></span></a><span class="mpre">        -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_52_7_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_16&#39;)"><span class="hl_conref"><span class="mpre">UnknownCA</span></span></a><span class="mpre">]
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         -&gt;
                            case </span><a href="#loc_235_9_235_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_19&#39;)"><span class="hl_varref"><span class="mpre">findIssuer</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">certIssuerDN</span></span><span class="mpre"> </span><a href="#loc_232_17_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_17_232_21&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">) </span><a href="#loc_218_36_218_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_36_218_41&#39;)"><span class="hl_varref"><span class="mpre">chain</span></span></a><span class="mpre"> of
                                </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">                  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_52_7_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_7_52_16&#39;)"><span class="hl_conref"><span class="mpre">UnknownCA</span></span></a><span class="mpre">]
                                </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_228_39_228_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_39_228_45&#39;)"><span class="hl_vardecl"><span class="mpre">issuer</span></span></a><span class="mpre">, </span><a name="loc_228_47_228_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_47_228_56&#39;)"><span class="hl_vardecl"><span class="mpre">remaining</span></span></a><span class="mpre">) -&gt;
                                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_251_9_251_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_9_251_16&#39;)"><span class="hl_varref"><span class="mpre">checkCA</span></span></a><span class="mpre"> </span><a href="#loc_218_22_218_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_22_218_27&#39;)"><span class="hl_varref"><span class="mpre">level</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre"> </span><a href="#loc_228_39_228_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_39_228_45&#39;)"><span class="hl_varref"><span class="mpre">issuer</span></span></a><span class="mpre">)
                                    </span><a href="#loc_212_11_212_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_11_212_13&#39;)"><span class="hl_infix"><span class="mpre">|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_305_9_305_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_9_305_23&#39;)"><span class="hl_varref"><span class="mpre">checkSignature</span></span></a><span class="mpre"> </span><a href="#loc_218_28_218_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_28_218_35&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre"> </span><a href="#loc_228_39_228_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_39_228_45&#39;)"><span class="hl_varref"><span class="mpre">issuer</span></span></a><span class="mpre">)
                                    </span><a href="#loc_212_11_212_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_11_212_13&#39;)"><span class="hl_infix"><span class="mpre">|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_218_9_218_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_21&#39;)"><span class="hl_varref"><span class="mpre">doCheckChain</span></span></a><span class="mpre"> (</span><a href="#loc_218_22_218_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_22_218_27&#39;)"><span class="hl_varref"><span class="mpre">level</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_228_39_228_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_39_228_45&#39;)"><span class="hl_varref"><span class="mpre">issuer</span></span></a><span class="mpre"> </span><a href="#loc_228_47_228_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_47_228_56&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre">)
          where </span><a name="loc_232_17_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_17_232_21&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> = </span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre"> </span><a href="#loc_218_28_218_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_28_218_35&#39;)"><span class="hl_varref"><span class="mpre">current</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- in a strict ordering check the next certificate has to be the issuer.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- otherwise we dynamically reorder the chain to have the necessary certificate</span></span><span class="mpre">
        </span><a name="loc_235_9_235_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_9_235_19&#39;)"><span class="hl_fundecl"><span class="mpre">findIssuer</span></span></a><span class="mpre"> </span><a name="loc_235_20_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_20_235_28&#39;)"><span class="hl_vardecl"><span class="mpre">issuerDN</span></span></a><span class="mpre"> </span><a name="loc_235_29_235_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_29_235_34&#39;)"><span class="hl_vardecl"><span class="mpre">chain</span></span></a><span class="mpre">
            | </span><a href="#loc_85_7_85_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_26&#39;)"><span class="hl_varref"><span class="mpre">checkStrictOrdering</span></span></a><span class="mpre"> </span><a href="#loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre"> =
                case </span><a href="#loc_235_29_235_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_29_235_34&#39;)"><span class="hl_varref"><span class="mpre">chain</span></span></a><span class="mpre"> of
                    []     -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not possible&quot;</span></span><span class="mpre">
                    (</span><a name="loc_239_22_239_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_22_239_23&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_239_24_239_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_24_239_26&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) | </span><a href="#loc_243_9_243_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_9_243_31&#39;)"><span class="hl_varref"><span class="mpre">matchSubjectIdentifier</span></span></a><span class="mpre"> </span><a href="#loc_235_20_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_20_235_28&#39;)"><span class="hl_varref"><span class="mpre">issuerDN</span></span></a><span class="mpre"> (</span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre"> </span><a href="#loc_239_22_239_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_22_239_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_239_22_239_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_22_239_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="#loc_239_24_239_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_24_239_26&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
                           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                                          -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
                (\</span><a name="loc_242_19_242_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_19_242_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_242_19_242_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_19_242_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_242_19_242_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_19_242_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_235_29_235_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_29_235_34&#39;)"><span class="hl_varref"><span class="mpre">chain</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.List.html#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_261_1_261_5&#39;)"><span class="hl_varref"><span class="mpre">find</span></span></a><span class="mpre"> (</span><a href="#loc_243_9_243_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_9_243_31&#39;)"><span class="hl_varref"><span class="mpre">matchSubjectIdentifier</span></span></a><span class="mpre"> </span><a href="#loc_235_20_235_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_20_235_28&#39;)"><span class="hl_varref"><span class="mpre">issuerDN</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre">) </span><a href="#loc_235_29_235_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_29_235_34&#39;)"><span class="hl_varref"><span class="mpre">chain</span></span></a><span class="mpre">
        </span><a name="loc_243_9_243_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_9_243_31&#39;)"><span class="hl_vardecl"><span class="mpre">matchSubjectIdentifier</span></span></a><span class="mpre"> = </span><a href="#loc_121_7_121_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_29&#39;)"><span class="hl_varref"><span class="mpre">hookMatchSubjectIssuer</span></span></a><span class="mpre"> </span><a href="#loc_209_27_209_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_27_209_32&#39;)"><span class="hl_varref"><span class="mpre">hooks</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- we check here that the certificate is allowed to be a certificate</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- authority, by checking the BasicConstraint extension. We also check,</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- if present the key usage extension for ability to cert sign. If this</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- extension is not present, then according to RFC 5280, it&#39;s safe to</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- assume that only cert sign (and crl sign) are allowed by this certificate.</span></span><span class="mpre">
        </span><a href="#loc_251_9_251_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_9_251_16&#39;)"><span class="mpre">checkCA</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
        </span><a name="loc_251_9_251_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_9_251_16&#39;)"><span class="hl_fundecl"><span class="mpre">checkCA</span></span></a><span class="mpre"> </span><a name="loc_251_17_251_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_17_251_22&#39;)"><span class="hl_vardecl"><span class="mpre">level</span></span></a><span class="mpre"> </span><a name="loc_251_23_251_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_23_251_27&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_88_7_88_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_25&#39;)"><span class="hl_varref"><span class="mpre">checkCAConstraints</span></span></a><span class="mpre"> </span><a href="#loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre">)          = []
            | </span><span class="hl_varref"><span class="mpre">and</span></span><span class="mpre"> [</span><a href="#loc_258_17_258_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_17_258_28&#39;)"><span class="hl_varref"><span class="mpre">allowedSign</span></span></a><span class="mpre">,</span><a href="#loc_261_18_261_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_18_261_27&#39;)"><span class="hl_varref"><span class="mpre">allowedCA</span></span></a><span class="mpre">,</span><a href="#loc_264_17_264_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_17_264_29&#39;)"><span class="hl_varref"><span class="mpre">allowedDepth</span></span></a><span class="mpre">] = []
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (if </span><a href="#loc_258_17_258_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_17_258_28&#39;)"><span class="hl_varref"><span class="mpre">allowedSign</span></span></a><span class="mpre"> then [] else [</span><a href="#loc_53_7_53_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_7_53_23&#39;)"><span class="hl_conref"><span class="mpre">NotAllowedToSign</span></span></a><span class="mpre">])
                       </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (if </span><a href="#loc_261_18_261_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_18_261_27&#39;)"><span class="hl_varref"><span class="mpre">allowedCA</span></span></a><span class="mpre">   then [] else [</span><a href="#loc_54_7_54_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_7_54_21&#39;)"><span class="hl_conref"><span class="mpre">NotAnAuthority</span></span></a><span class="mpre">])
                       </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (if </span><a href="#loc_264_17_264_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_17_264_29&#39;)"><span class="hl_varref"><span class="mpre">allowedDepth</span></span></a><span class="mpre"> then [] else [</span><a href="#loc_55_7_55_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_23&#39;)"><span class="hl_conref"><span class="mpre">AuthorityTooDeep</span></span></a><span class="mpre">])
          where </span><a name="loc_257_17_257_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_17_257_27&#39;)"><span class="hl_vardecl"><span class="mpre">extensions</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">certExtensions</span></span><span class="mpre"> </span><a href="#loc_251_23_251_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_23_251_27&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">
                </span><a name="loc_258_17_258_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_17_258_28&#39;)"><span class="hl_vardecl"><span class="mpre">allowedSign</span></span></a><span class="mpre"> = case </span><a href="Data.X509.Ext.html#loc_73_1_73_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_73_1_73_13&#39;)"><span class="hl_varref"><span class="mpre">extensionGet</span></span></a><span class="mpre"> </span><a href="#loc_257_17_257_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_17_257_27&#39;)"><span class="hl_varref"><span class="mpre">extensions</span></span></a><span class="mpre"> of
                                </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="Data.X509.Ext.html#loc_114_20_114_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_114_20_114_31&#39;)"><span class="hl_conref"><span class="mpre">ExtKeyUsage</span></span></a><span class="mpre"> </span><a name="loc_259_51_259_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_51_259_56&#39;)"><span class="hl_vardecl"><span class="mpre">flags</span></span></a><span class="mpre">) -&gt; </span><a href="Data.X509.Ext.html#loc_49_7_49_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_49_7_49_27&#39;)"><span class="hl_conref"><span class="mpre">KeyUsage_keyCertSign</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_259_51_259_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_51_259_56&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">
                                </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">                  -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                (</span><a name="loc_261_18_261_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_18_261_27&#39;)"><span class="hl_vardecl"><span class="mpre">allowedCA</span></span></a><span class="mpre">,</span><a name="loc_261_28_261_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_28_261_35&#39;)"><span class="hl_vardecl"><span class="mpre">pathLen</span></span></a><span class="mpre">) = case </span><a href="Data.X509.Ext.html#loc_73_1_73_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_73_1_73_13&#39;)"><span class="hl_varref"><span class="mpre">extensionGet</span></span></a><span class="mpre"> </span><a href="#loc_257_17_257_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_17_257_27&#39;)"><span class="hl_varref"><span class="mpre">extensions</span></span></a><span class="mpre"> of
                                </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="Data.X509.Ext.html#loc_98_28_98_47" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_98_28_98_47&#39;)"><span class="hl_conref"><span class="mpre">ExtBasicConstraints</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a name="loc_262_64_262_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_64_262_66&#39;)"><span class="hl_vardecl"><span class="mpre">pl</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="#loc_262_64_262_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_64_262_66&#39;)"><span class="hl_varref"><span class="mpre">pl</span></span></a><span class="mpre">)
                                _                                  -&gt; (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
                </span><a name="loc_264_17_264_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_17_264_29&#39;)"><span class="hl_vardecl"><span class="mpre">allowedDepth</span></span></a><span class="mpre"> = case </span><a href="#loc_261_28_261_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_28_261_35&#39;)"><span class="hl_varref"><span class="mpre">pathLen</span></span></a><span class="mpre"> of
                                    </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">                            -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                                    </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_266_42_266_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_42_266_44&#39;)"><span class="hl_vardecl"><span class="mpre">pl</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_266_42_266_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_42_266_44&#39;)"><span class="hl_varref"><span class="mpre">pl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_251_17_251_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_17_251_22&#39;)"><span class="hl_varref"><span class="mpre">level</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                                            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

        </span><a name="loc_269_9_269_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_9_269_20&#39;)"><span class="hl_fundecl"><span class="mpre">doNameCheck</span></span></a><span class="mpre"> </span><a name="loc_269_21_269_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_21_269_25&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_111_7_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_7_111_16&#39;)"><span class="hl_varref"><span class="mpre">checkFQHN</span></span></a><span class="mpre"> </span><a href="#loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre">) = []
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              = (</span><a href="#loc_125_7_125_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_7_125_23&#39;)"><span class="hl_varref"><span class="mpre">hookValidateName</span></span></a><span class="mpre"> </span><a href="#loc_209_27_209_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_27_209_32&#39;)"><span class="hl_varref"><span class="mpre">hooks</span></span></a><span class="mpre">) </span><a href="#loc_209_47_209_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_47_209_51&#39;)"><span class="hl_varref"><span class="mpre">fqhn</span></span></a><span class="mpre"> (</span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre"> </span><a href="#loc_269_21_269_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_21_269_25&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">)

        </span><a name="loc_273_9_273_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_18&#39;)"><span class="hl_fundecl"><span class="mpre">doV3Check</span></span></a><span class="mpre"> </span><a name="loc_273_19_273_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_19_273_23&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre">
            | </span><a href="#loc_96_7_96_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_18&#39;)"><span class="hl_varref"><span class="mpre">checkLeafV3</span></span></a><span class="mpre"> </span><a href="#loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">certVersion</span></span><span class="mpre"> </span><a href="#loc_273_19_273_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_19_273_23&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre"> of
                                        </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">{- confusingly it means X509.V3 -}</span></span><span class="mpre"> -&gt; []
                                        _ -&gt; [</span><a href="#loc_62_7_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_16&#39;)"><span class="hl_conref"><span class="mpre">LeafNotV3</span></span></a><span class="mpre">]
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = []

        </span><a name="loc_279_9_279_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_9_279_24&#39;)"><span class="hl_fundecl"><span class="mpre">doKeyUsageCheck</span></span></a><span class="mpre"> </span><a name="loc_279_25_279_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_25_279_29&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> =
               </span><a href="#loc_291_17_291_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_45&#39;)"><span class="hl_varref"><span class="mpre">compareListIfExistAndNotNull</span></span></a><span class="mpre"> </span><a href="#loc_282_17_282_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_23&#39;)"><span class="hl_varref"><span class="mpre">mflags</span></span></a><span class="mpre"> (</span><a href="#loc_102_7_102_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_7_102_24&#39;)"><span class="hl_varref"><span class="mpre">checkLeafKeyUsage</span></span></a><span class="mpre"> </span><a href="#loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre">) </span><a href="#loc_60_7_60_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_7_60_29&#39;)"><span class="hl_conref"><span class="mpre">LeafKeyUsageNotAllowed</span></span></a><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_291_17_291_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_45&#39;)"><span class="hl_varref"><span class="mpre">compareListIfExistAndNotNull</span></span></a><span class="mpre"> </span><a href="#loc_285_17_285_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_17_285_26&#39;)"><span class="hl_varref"><span class="mpre">mpurposes</span></span></a><span class="mpre"> (</span><a href="#loc_108_7_108_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_7_108_26&#39;)"><span class="hl_varref"><span class="mpre">checkLeafKeyPurpose</span></span></a><span class="mpre"> </span><a href="#loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre">) </span><a href="#loc_61_7_61_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_31&#39;)"><span class="hl_conref"><span class="mpre">LeafKeyPurposeNotAllowed</span></span></a><span class="mpre">
          where </span><a name="loc_282_17_282_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_23&#39;)"><span class="hl_vardecl"><span class="mpre">mflags</span></span></a><span class="mpre"> = case </span><a href="Data.X509.Ext.html#loc_73_1_73_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_73_1_73_13&#39;)"><span class="hl_varref"><span class="mpre">extensionGet</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">certExtensions</span></span><span class="mpre"> </span><a href="#loc_279_25_279_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_25_279_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre"> of
                            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="Data.X509.Ext.html#loc_114_20_114_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_114_20_114_31&#39;)"><span class="hl_conref"><span class="mpre">ExtKeyUsage</span></span></a><span class="mpre"> </span><a name="loc_283_47_283_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_47_283_55&#39;)"><span class="hl_vardecl"><span class="mpre">keyflags</span></span></a><span class="mpre">) -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_283_47_283_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_47_283_55&#39;)"><span class="hl_varref"><span class="mpre">keyflags</span></span></a><span class="mpre">
                            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">                     -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
                </span><a name="loc_285_17_285_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_17_285_26&#39;)"><span class="hl_vardecl"><span class="mpre">mpurposes</span></span></a><span class="mpre"> = case </span><a href="Data.X509.Ext.html#loc_73_1_73_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_73_1_73_13&#39;)"><span class="hl_varref"><span class="mpre">extensionGet</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">certExtensions</span></span><span class="mpre"> </span><a href="#loc_279_25_279_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_25_279_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre"> of
                            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="Data.X509.Ext.html#loc_145_28_145_47" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_145_28_145_47&#39;)"><span class="hl_conref"><span class="mpre">ExtExtendedKeyUsage</span></span></a><span class="mpre"> </span><a name="loc_286_55_286_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_55_286_66&#39;)"><span class="hl_vardecl"><span class="mpre">keyPurposes</span></span></a><span class="mpre">) -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_286_55_286_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_55_286_66&#39;)"><span class="hl_varref"><span class="mpre">keyPurposes</span></span></a><span class="mpre">
                            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">                                -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- compare a list of things to an expected list. the expected list</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- need to be a subset of the list (if not Nothing), and is not will</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- return [err]</span></span><span class="mpre">
                </span><a name="loc_291_17_291_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_45&#39;)"><span class="hl_fundecl"><span class="mpre">compareListIfExistAndNotNull</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">     _        _   = []
                </span><a href="#loc_291_17_291_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_45&#39;)"><span class="hl_fundecl"><span class="mpre">compareListIfExistAndNotNull</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_292_52_292_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_52_292_56&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre">) </span><a name="loc_292_58_292_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_58_292_66&#39;)"><span class="hl_vardecl"><span class="mpre">expected</span></span></a><span class="mpre"> </span><a name="loc_292_67_292_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_67_292_70&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">
                    | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_292_58_292_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_58_292_66&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre">                       = []
                    | </span><a href="Data.List.html#loc_412_1_412_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_412_1_412_10&#39;)"><span class="hl_varref"><span class="mpre">intersect</span></span></a><span class="mpre"> </span><a href="#loc_292_58_292_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_58_292_66&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre"> </span><a href="#loc_292_52_292_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_52_292_56&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_292_58_292_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_58_292_66&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre"> = []
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                           = [</span><a href="#loc_292_67_292_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_67_292_70&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">]

        </span><a name="loc_297_9_297_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_9_297_27&#39;)"><span class="hl_fundecl"><span class="mpre">doCheckCertificate</span></span></a><span class="mpre"> </span><a name="loc_297_28_297_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_28_297_32&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> =
            </span><a href="#loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="hl_varref"><span class="mpre">exhaustiveList</span></span></a><span class="mpre"> (</span><a href="#loc_93_7_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_22&#39;)"><span class="hl_varref"><span class="mpre">checkExhaustive</span></span></a><span class="mpre"> </span><a href="#loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre">)
                [ (</span><a href="#loc_77_7_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_7_77_24&#39;)"><span class="hl_varref"><span class="mpre">checkTimeValidity</span></span></a><span class="mpre"> </span><a href="#loc_209_33_209_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_33_209_39&#39;)"><span class="hl_varref"><span class="mpre">checks</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ((</span><a href="#loc_123_7_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_23&#39;)"><span class="hl_varref"><span class="mpre">hookValidateTime</span></span></a><span class="mpre"> </span><a href="#loc_209_27_209_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_27_209_32&#39;)"><span class="hl_varref"><span class="mpre">hooks</span></span></a><span class="mpre">) </span><a href="#loc_209_12_209_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_12_209_26&#39;)"><span class="hl_varref"><span class="mpre">validationTime</span></span></a><span class="mpre"> </span><a href="#loc_297_28_297_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_28_297_32&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">))
                ]
        </span><a href="#loc_302_9_302_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_9_302_21&#39;)"><span class="mpre">isSelfSigned</span></a><span class="mpre"> :: </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
        </span><a name="loc_302_9_302_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_9_302_21&#39;)"><span class="hl_fundecl"><span class="mpre">isSelfSigned</span></span></a><span class="mpre"> </span><a name="loc_302_22_302_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_22_302_26&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">certSubjectDN</span></span><span class="mpre"> </span><a href="#loc_302_22_302_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_22_302_26&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">certIssuerDN</span></span><span class="mpre"> </span><a href="#loc_302_22_302_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_22_302_26&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- check signature of &#39;signedCert&#39; against the &#39;signingCert&#39;</span></span><span class="mpre">
        </span><a name="loc_305_9_305_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_9_305_23&#39;)"><span class="hl_fundecl"><span class="mpre">checkSignature</span></span></a><span class="mpre"> </span><a name="loc_305_24_305_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_24_305_34&#39;)"><span class="hl_vardecl"><span class="mpre">signedCert</span></span></a><span class="mpre"> </span><a name="loc_305_35_305_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_35_305_46&#39;)"><span class="hl_vardecl"><span class="mpre">signingCert</span></span></a><span class="mpre"> =
            case </span><a href="Data.X509.Validation.Signature.html#loc_53_1_53_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Signature.html#loc_53_1_53_22&#39;)"><span class="hl_varref"><span class="mpre">verifySignedSignature</span></span></a><span class="mpre"> </span><a href="#loc_305_24_305_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_24_305_34&#39;)"><span class="hl_varref"><span class="mpre">signedCert</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">certPubKey</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.X509.html#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">getCertificate</span></span></a><span class="mpre"> </span><a href="#loc_305_35_305_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_35_305_46&#39;)"><span class="hl_varref"><span class="mpre">signingCert</span></span></a><span class="mpre">) of
                </span><a href="Data.X509.Validation.Signature.html#loc_37_7_37_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Signature.html#loc_37_7_37_20&#39;)"><span class="hl_conref"><span class="mpre">SignaturePass</span></span></a><span class="mpre">     -&gt; []
                </span><a href="Data.X509.Validation.Signature.html#loc_38_7_38_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Signature.html#loc_38_7_38_22&#39;)"><span class="hl_conref"><span class="mpre">SignatureFailed</span></span></a><span class="mpre"> </span><a name="loc_308_33_308_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_33_308_34&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_65_7_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_23&#39;)"><span class="hl_conref"><span class="mpre">InvalidSignature</span></span></a><span class="mpre"> </span><a href="#loc_308_33_308_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_33_308_34&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | Validate that the current time is between validity bounds</span></span><span class="mpre">
</span><a href="#loc_312_1_312_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_13&#39;)"><span class="mpre">validateTime</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre"> -&gt; </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
</span><a name="loc_312_1_312_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_13&#39;)"><span class="hl_fundecl"><span class="mpre">validateTime</span></span></a><span class="mpre"> </span><a name="loc_312_14_312_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_14_312_25&#39;)"><span class="hl_vardecl"><span class="mpre">currentTime</span></span></a><span class="mpre"> </span><a name="loc_312_26_312_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_26_312_30&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre">
    | </span><a href="#loc_312_14_312_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_14_312_25&#39;)"><span class="hl_varref"><span class="mpre">currentTime</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_316_10_316_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_10_316_16&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre"> = [</span><a href="#loc_50_7_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_15&#39;)"><span class="hl_conref"><span class="mpre">InFuture</span></span></a><span class="mpre">]
    | </span><a href="#loc_312_14_312_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_14_312_25&#39;)"><span class="hl_varref"><span class="mpre">currentTime</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_316_18_316_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_18_316_23&#39;)"><span class="hl_varref"><span class="mpre">after</span></span></a><span class="mpre">  = [</span><a href="#loc_49_7_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_7_49_14&#39;)"><span class="hl_conref"><span class="mpre">Expired</span></span></a><span class="mpre">]
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">            = []
  where (</span><a name="loc_316_10_316_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_10_316_16&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre">, </span><a name="loc_316_18_316_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_18_316_23&#39;)"><span class="hl_vardecl"><span class="mpre">after</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">certValidity</span></span><span class="mpre"> </span><a href="#loc_312_26_312_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_26_312_30&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">

</span><a href="#loc_319_1_319_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_9&#39;)"><span class="mpre">getNames</span></a><span class="mpre"> :: </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])
</span><a name="loc_319_1_319_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_9&#39;)"><span class="hl_fundecl"><span class="mpre">getNames</span></span></a><span class="mpre"> </span><a name="loc_319_10_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_10_319_14&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> = (</span><a href="#loc_320_9_320_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_9_320_19&#39;)"><span class="hl_varref"><span class="mpre">commonName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.String.html#loc_67_1_67_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.String.html#loc_67_1_67_22&#39;)"><span class="hl_varref"><span class="mpre">asn1CharacterToString</span></span></a><span class="mpre">, </span><a href="#loc_321_9_321_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_9_321_17&#39;)"><span class="hl_varref"><span class="mpre">altNames</span></span></a><span class="mpre">)
  where </span><a name="loc_320_9_320_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_9_320_19&#39;)"><span class="hl_vardecl"><span class="mpre">commonName</span></span></a><span class="mpre"> = </span><a href="Data.X509.DistinguishedName.html#loc_44_1_44_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.DistinguishedName.html#loc_44_1_44_13&#39;)"><span class="hl_varref"><span class="mpre">getDnElement</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">DnCommonName</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">certSubjectDN</span></span><span class="mpre"> </span><a href="#loc_319_10_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_10_319_14&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">
        </span><a name="loc_321_9_321_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_9_321_17&#39;)"><span class="hl_vardecl"><span class="mpre">altNames</span></span></a><span class="mpre">   = </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> [] </span><a href="#loc_322_9_322_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_9_322_18&#39;)"><span class="hl_varref"><span class="mpre">toAltName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.X509.Ext.html#loc_73_1_73_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_73_1_73_13&#39;)"><span class="hl_varref"><span class="mpre">extensionGet</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">certExtensions</span></span><span class="mpre"> </span><a href="#loc_319_10_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_10_319_14&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">
        </span><a name="loc_322_9_322_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_9_322_18&#39;)"><span class="hl_fundecl"><span class="mpre">toAltName</span></span></a><span class="mpre"> (</span><a href="Data.X509.Ext.html#loc_188_26_188_43" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_188_26_188_43&#39;)"><span class="hl_conref"><span class="mpre">ExtSubjectAltName</span></span></a><span class="mpre"> </span><a name="loc_322_38_322_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_38_322_43&#39;)"><span class="hl_vardecl"><span class="mpre">names</span></span></a><span class="mpre">) = </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_323_19_323_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_19_323_28&#39;)"><span class="hl_varref"><span class="mpre">unAltName</span></span></a><span class="mpre"> </span><a href="#loc_322_38_322_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_38_322_43&#39;)"><span class="hl_varref"><span class="mpre">names</span></span></a><span class="mpre">
            where </span><a name="loc_323_19_323_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_19_323_28&#39;)"><span class="hl_fundecl"><span class="mpre">unAltName</span></span></a><span class="mpre"> (</span><a href="Data.X509.Ext.html#loc_181_7_181_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_181_7_181_17&#39;)"><span class="hl_conref"><span class="mpre">AltNameDNS</span></span></a><span class="mpre"> </span><a name="loc_323_41_323_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_41_323_42&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_323_41_323_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_41_323_42&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                  </span><a href="#loc_323_19_323_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_19_323_28&#39;)"><span class="hl_fundecl"><span class="mpre">unAltName</span></span></a><span class="mpre"> _              = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Validate that the fqhn is matched by at least one name in the certificate.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The name can be either the common name or one of the alternative names if</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the SubjectAltName extension is present.</span></span><span class="mpre">
</span><a href="#loc_330_1_330_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_24&#39;)"><span class="mpre">validateCertificateName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HostName</span></span><span class="mpre"> -&gt; </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
</span><a name="loc_330_1_330_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_24&#39;)"><span class="hl_fundecl"><span class="mpre">validateCertificateName</span></span></a><span class="mpre"> </span><a name="loc_330_25_330_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_25_330_29&#39;)"><span class="hl_vardecl"><span class="mpre">fqhn</span></span></a><span class="mpre"> </span><a name="loc_330_30_330_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_30_330_34&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> =
    case </span><a href="#loc_334_10_334_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_10_334_20&#39;)"><span class="hl_varref"><span class="mpre">commonName</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_56_7_56_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_19&#39;)"><span class="hl_conref"><span class="mpre">NoCommonName</span></span></a><span class="mpre">]
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_333_14_333_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_14_333_16&#39;)"><span class="hl_vardecl"><span class="mpre">cn</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_337_9_337_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_9_337_18&#39;)"><span class="hl_varref"><span class="mpre">findMatch</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_342_9_342_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_9_342_20&#39;)"><span class="hl_varref"><span class="mpre">matchDomain</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_362_9_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_9_362_17&#39;)"><span class="hl_varref"><span class="mpre">splitDot</span></span></a><span class="mpre">) (</span><a href="#loc_333_14_333_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_14_333_16&#39;)"><span class="hl_varref"><span class="mpre">cn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_334_22_334_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_22_334_30&#39;)"><span class="hl_varref"><span class="mpre">altNames</span></span></a><span class="mpre">)
  where (</span><a name="loc_334_10_334_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_10_334_20&#39;)"><span class="hl_vardecl"><span class="mpre">commonName</span></span></a><span class="mpre">, </span><a name="loc_334_22_334_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_22_334_30&#39;)"><span class="hl_vardecl"><span class="mpre">altNames</span></span></a><span class="mpre">) = </span><a href="#loc_319_1_319_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_9&#39;)"><span class="hl_varref"><span class="mpre">getNames</span></span></a><span class="mpre"> </span><a href="#loc_330_30_330_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_30_330_34&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">

        </span><a href="#loc_337_9_337_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_9_337_18&#39;)"><span class="mpre">findMatch</span></a><span class="mpre"> :: [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">] -&gt; [[</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]] -&gt; [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
        </span><a name="loc_337_9_337_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_9_337_18&#39;)"><span class="hl_fundecl"><span class="mpre">findMatch</span></span></a><span class="mpre"> _   []      = [</span><a href="#loc_58_7_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_19&#39;)"><span class="hl_conref"><span class="mpre">NameMismatch</span></span></a><span class="mpre"> </span><a href="#loc_330_25_330_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_25_330_29&#39;)"><span class="hl_varref"><span class="mpre">fqhn</span></span></a><span class="mpre">]
        </span><a href="#loc_337_9_337_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_9_337_18&#39;)"><span class="hl_fundecl"><span class="mpre">findMatch</span></span></a><span class="mpre"> _   ([]</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)  = []
        </span><a href="#loc_337_9_337_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_9_337_18&#39;)"><span class="hl_fundecl"><span class="mpre">findMatch</span></span></a><span class="mpre"> </span><a name="loc_339_19_339_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_19_339_22&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> (_ </span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_339_27_339_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_27_339_29&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_337_9_337_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_9_337_18&#39;)"><span class="hl_varref"><span class="mpre">findMatch</span></span></a><span class="mpre"> </span><a href="#loc_339_19_339_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_19_339_22&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_339_27_339_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_27_339_29&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

        </span><a href="#loc_342_9_342_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_9_342_20&#39;)"><span class="mpre">matchDomain</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
        </span><a name="loc_342_9_342_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_9_342_20&#39;)"><span class="hl_fundecl"><span class="mpre">matchDomain</span></span></a><span class="mpre"> </span><a name="loc_342_21_342_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_21_342_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) </span><a href="#loc_342_21_342_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_21_342_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = [</span><a href="#loc_57_7_57_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_18&#39;)"><span class="hl_conref"><span class="mpre">InvalidName</span></span></a><span class="mpre"> (</span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><a href="#loc_342_21_342_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_21_342_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)]
            | </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_342_21_342_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_21_342_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;*&quot;</span></span><span class="mpre">                 = </span><a href="#loc_353_9_353_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_9_353_22&#39;)"><span class="hl_varref"><span class="mpre">wildcardMatch</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_342_21_342_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_21_342_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
            | </span><a href="#loc_342_21_342_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_21_342_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_362_9_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_9_362_17&#39;)"><span class="hl_varref"><span class="mpre">splitDot</span></span></a><span class="mpre"> </span><a href="#loc_330_25_330_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_25_330_29&#39;)"><span class="hl_varref"><span class="mpre">fqhn</span></span></a><span class="mpre">            = [] </span><span class="hl_comment"><span class="mpre">-- success: we got a match</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                     = [</span><a href="#loc_58_7_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_19&#39;)"><span class="hl_conref"><span class="mpre">NameMismatch</span></span></a><span class="mpre"> </span><a href="#loc_330_25_330_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_25_330_29&#39;)"><span class="hl_varref"><span class="mpre">fqhn</span></span></a><span class="mpre">]

        </span><span class="hl_comment"><span class="mpre">-- only 1 wildcard is valid, and if multiples are present</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- they won&#39;t have a wildcard meaning but will be match as normal star</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- character to the fqhn and inevitably will fail.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- e.g. *.*.server.com will try to litteraly match the &#39;*&#39; subdomain of server.com</span></span><span class="mpre">
        </span><a name="loc_353_9_353_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_9_353_22&#39;)"><span class="hl_fundecl"><span class="mpre">wildcardMatch</span></span></a><span class="mpre"> </span><a name="loc_353_23_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_23_353_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- &lt;star&gt;.com or &lt;star&gt; is always invalid</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_353_23_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_23_353_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> = [</span><a href="#loc_59_7_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_7_59_22&#39;)"><span class="hl_conref"><span class="mpre">InvalidWildcard</span></span></a><span class="mpre">]
            </span><span class="hl_comment"><span class="mpre">-- some TLD like .uk got small subTLS like (.co.uk), and we don&#39;t want to accept *.co.uk</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_353_23_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_23_353_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_353_23_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_23_353_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_353_23_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_23_353_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> = [</span><a href="#loc_59_7_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_7_59_22&#39;)"><span class="hl_conref"><span class="mpre">InvalidWildcard</span></span></a><span class="mpre">]
            | </span><a href="#loc_353_23_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_23_353_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_353_23_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_23_353_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_362_9_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_9_362_17&#39;)"><span class="hl_varref"><span class="mpre">splitDot</span></span></a><span class="mpre"> </span><a href="#loc_330_25_330_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_25_330_29&#39;)"><span class="hl_varref"><span class="mpre">fqhn</span></span></a><span class="mpre">) = [] </span><span class="hl_comment"><span class="mpre">-- success: we got a match</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                                      = [</span><a href="#loc_58_7_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_19&#39;)"><span class="hl_conref"><span class="mpre">NameMismatch</span></span></a><span class="mpre"> </span><a href="#loc_330_25_330_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_25_330_29&#39;)"><span class="hl_varref"><span class="mpre">fqhn</span></span></a><span class="mpre">]

        </span><a href="#loc_362_9_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_9_362_17&#39;)"><span class="mpre">splitDot</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
        </span><a name="loc_362_9_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_9_362_17&#39;)"><span class="hl_fundecl"><span class="mpre">splitDot</span></span></a><span class="mpre"> [] = [</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">]
        </span><a href="#loc_362_9_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_9_362_17&#39;)"><span class="hl_fundecl"><span class="mpre">splitDot</span></span></a><span class="mpre"> </span><a name="loc_363_18_363_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_18_363_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  =
            let (</span><a name="loc_364_18_364_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_18_364_19&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">, </span><a name="loc_364_21_364_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_21_364_22&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">) </span><a href="#loc_363_18_363_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_18_363_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> in
            </span><a href="#loc_364_18_364_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_18_364_19&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (if </span><a href="#loc_364_21_364_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_21_364_22&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> then [] else </span><a href="#loc_362_9_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_9_362_17&#39;)"><span class="hl_varref"><span class="mpre">splitDot</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_364_21_364_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_21_364_22&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | return true if the &#39;subject&#39; certificate&#39;s issuer match</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the &#39;issuer&#39; certificate&#39;s subject</span></span><span class="mpre">
</span><a href="#loc_371_1_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_8&#39;)"><span class="mpre">matchSI</span></a><span class="mpre"> :: </span><a href="Data.X509.DistinguishedName.html#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.DistinguishedName.html#loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> -&gt; </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_371_1_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_8&#39;)"><span class="hl_fundecl"><span class="mpre">matchSI</span></span></a><span class="mpre"> </span><a name="loc_371_9_371_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_9_371_17&#39;)"><span class="hl_vardecl"><span class="mpre">issuerDN</span></span></a><span class="mpre"> </span><a name="loc_371_18_371_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_18_371_24&#39;)"><span class="hl_vardecl"><span class="mpre">issuer</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">certSubjectDN</span></span><span class="mpre"> </span><a href="#loc_371_18_371_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_18_371_24&#39;)"><span class="hl_varref"><span class="mpre">issuer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_371_9_371_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_9_371_17&#39;)"><span class="hl_varref"><span class="mpre">issuerDN</span></span></a><span class="mpre">

</span><a href="#loc_374_1_374_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_11&#39;)"><span class="mpre">exhaustive</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 373, srcSpanStartColumn = 15, srcSpanEndLine = 373, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 373, srcSpanStartColumn = 23, srcSpanEndLine = 373, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
</span><a name="loc_374_1_374_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_11&#39;)"><span class="hl_fundecl"><span class="mpre">exhaustive</span></span></a><span class="mpre"> </span><a name="loc_374_12_374_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_12_374_24&#39;)"><span class="hl_vardecl"><span class="mpre">isExhaustive</span></span></a><span class="mpre"> </span><a name="loc_374_25_374_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_25_374_27&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre"> </span><a name="loc_374_28_374_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_28_374_30&#39;)"><span class="hl_vardecl"><span class="mpre">f2</span></span></a><span class="mpre"> = </span><a href="#loc_374_25_374_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_25_374_27&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_375_9_375_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_9_375_13&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre">
  where </span><a name="loc_375_9_375_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_9_375_13&#39;)"><span class="hl_fundecl"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a name="loc_375_14_375_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_14_375_16&#39;)"><span class="hl_vardecl"><span class="mpre">l1</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_375_14_375_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_14_375_16&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre">      = </span><a href="#loc_374_28_374_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_28_374_30&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre">
            | </span><a href="#loc_374_12_374_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_12_374_24&#39;)"><span class="hl_varref"><span class="mpre">isExhaustive</span></span></a><span class="mpre"> = </span><a href="#loc_374_28_374_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_28_374_30&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_377_38_377_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_38_377_40&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_375_14_375_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_14_375_16&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_377_38_377_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_38_377_40&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_375_14_375_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_14_375_16&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre">

</span><a href="#loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="mpre">exhaustiveList</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 380, srcSpanStartColumn = 19, srcSpanEndLine = 380, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation.hs&quot;, srcSpanStartLine = 380, srcSpanStartColumn = 27, srcSpanEndLine = 380, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">])] -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> [</span><a href="#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">]
</span><a name="loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="hl_fundecl"><span class="mpre">exhaustiveList</span></span></a><span class="mpre"> _            []                    = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
</span><a href="#loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="hl_fundecl"><span class="mpre">exhaustiveList</span></span></a><span class="mpre"> </span><a name="loc_382_16_382_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_16_382_28&#39;)"><span class="hl_vardecl"><span class="mpre">isExhaustive</span></span></a><span class="mpre"> ((</span><a name="loc_382_31_382_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_43&#39;)"><span class="hl_vardecl"><span class="mpre">performCheck</span></span></a><span class="mpre">,</span><a name="loc_382_44_382_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_44_382_45&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_382_47_382_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_47_382_49&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
    | </span><a href="#loc_382_31_382_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_43&#39;)"><span class="hl_varref"><span class="mpre">performCheck</span></span></a><span class="mpre"> = </span><a href="#loc_374_1_374_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_11&#39;)"><span class="hl_varref"><span class="mpre">exhaustive</span></span></a><span class="mpre"> </span><a href="#loc_382_16_382_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_16_382_28&#39;)"><span class="hl_varref"><span class="mpre">isExhaustive</span></span></a><span class="mpre"> </span><a href="#loc_382_44_382_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_44_382_45&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="hl_varref"><span class="mpre">exhaustiveList</span></span></a><span class="mpre"> </span><a href="#loc_382_16_382_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_16_382_28&#39;)"><span class="hl_varref"><span class="mpre">isExhaustive</span></span></a><span class="mpre"> </span><a href="#loc_382_47_382_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_47_382_49&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    = </span><a href="#loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="hl_varref"><span class="mpre">exhaustiveList</span></span></a><span class="mpre"> </span><a href="#loc_382_16_382_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_16_382_28&#39;)"><span class="hl_varref"><span class="mpre">isExhaustive</span></span></a><span class="mpre"> </span><a href="#loc_382_47_382_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_47_382_49&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
</span></div></body></html>