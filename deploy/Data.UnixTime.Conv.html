<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings, ForeignFunctionInterface #-}

module Data.UnixTime.Conv (
    formatUnixTime, formatUnixTimeGMT
  , parseUnixTime, parseUnixTimeGMT
  , webDateFormat, mailDateFormat
  , fromEpochTime, toEpochTime
  , fromClockTime, toClockTime
  ) where

import Control.Applicative
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 8, srcSpanEndLine = 12, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">
import Data.ByteString.Unsafe
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 8, srcSpanEndLine = 14, srcSpanEndColumn = 27}, srcInfoPoints = []}) &quot;Data.UnixTime.Types&quot;"><span class="mpre">Data.UnixTime.Types</span></span><span class="mpre">
import Foreign.C.String
import Foreign.C.Types
import Foreign.Marshal.Alloc
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 8, srcSpanEndLine = 19, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;System.Posix.Types&quot;"><span class="mpre">System.Posix.Types</span></span><span class="mpre"> (EpochTime)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;System.Time&quot;"><span class="mpre">System.Time</span></span><span class="mpre"> (ClockTime(..))

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLi"><span class="mpre">foreign import ccall unsafe &quot;c_parse_unix_time&quot;
        c_parse_unix_time :: CString -&gt; CString -&gt; IO CTime</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 26, srcSpanEndColumn = 64}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 25, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLi"><span class="mpre">foreign import ccall unsafe &quot;c_parse_unix_time_gmt&quot;
        c_parse_unix_time_gmt :: CString -&gt; CString -&gt; IO CTime</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 1, srcSpanEndLine = 29, srcSpanEndColumn = 78}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 1, srcSpanEndLine = 28, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLi"><span class="mpre">foreign import ccall unsafe &quot;c_format_unix_time&quot;
        c_format_unix_time :: CString -&gt; CTime -&gt; CString -&gt; CInt -&gt; IO CSize</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 1, srcSpanEndLine = 32, srcSpanEndColumn = 82}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 1, srcSpanEndLine = 31, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-time-0.3.0/Data/UnixTime/Conv.hs&quot;, srcSpanStartLi"><span class="mpre">foreign import ccall unsafe &quot;c_format_unix_time_gmt&quot;
        c_format_unix_time_gmt :: CString -&gt; CTime -&gt; CString -&gt; CInt -&gt; IO CSize</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Parsing &#39;ByteString&#39; to &#39;UnixTime&#39; interpreting as localtime.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper for strptime_l().</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Many implementations of strptime_l() do not support %Z and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- some implementations of strptime_l() do not support %z, either.</span></span><span class="mpre">

</span><a href="#loc_43_1_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_14&#39;)"><span class="mpre">parseUnixTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Format</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre">
</span><a name="loc_43_1_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_14&#39;)"><span class="hl_fundecl"><span class="mpre">parseUnixTime</span></span></a><span class="mpre"> </span><a name="loc_43_15_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_15_43_18&#39;)"><span class="hl_vardecl"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><a name="loc_43_19_43_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_22&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">useAsCString</span></span><span class="mpre"> </span><a href="#loc_43_15_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_15_43_18&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_44_25_44_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_25_44_29&#39;)"><span class="hl_vardecl"><span class="mpre">cfmt</span></span></a><span class="mpre"> -&gt;
        </span><span class="hl_varref"><span class="mpre">useAsCString</span></span><span class="mpre"> </span><a href="#loc_43_19_43_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_22&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_45_29_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_29_45_33&#39;)"><span class="hl_vardecl"><span class="mpre">cstr</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_46_13_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_16&#39;)"><span class="hl_vardecl"><span class="mpre">sec</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">c_parse_unix_time</span></span><span class="mpre"> </span><a href="#loc_44_25_44_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_25_44_29&#39;)"><span class="hl_varref"><span class="mpre">cfmt</span></span></a><span class="mpre"> </span><a href="#loc_45_29_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_29_45_33&#39;)"><span class="hl_varref"><span class="mpre">cstr</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">UnixTime</span></span><span class="mpre"> </span><a href="#loc_46_13_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_16&#39;)"><span class="hl_varref"><span class="mpre">sec</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Parsing &#39;ByteString&#39; to &#39;UnixTime&#39; interpreting as GMT.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper for strptime_l().</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; parseUnixTimeGMT webDateFormat &quot;Thu, 01 Jan 1970 00:00:00 GMT&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- UnixTime {utSeconds = 0, utMicroSeconds = 0}</span></span><span class="mpre">

</span><a href="#loc_56_1_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_17&#39;)"><span class="mpre">parseUnixTimeGMT</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Format</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre">
</span><a name="loc_56_1_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseUnixTimeGMT</span></span></a><span class="mpre"> </span><a name="loc_56_18_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_21&#39;)"><span class="hl_vardecl"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><a name="loc_56_22_56_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_25&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">useAsCString</span></span><span class="mpre"> </span><a href="#loc_56_18_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_21&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_57_25_57_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_25_57_29&#39;)"><span class="hl_vardecl"><span class="mpre">cfmt</span></span></a><span class="mpre"> -&gt;
        </span><span class="hl_varref"><span class="mpre">useAsCString</span></span><span class="mpre"> </span><a href="#loc_56_22_56_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_25&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_58_29_58_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_29_58_33&#39;)"><span class="hl_vardecl"><span class="mpre">cstr</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_59_13_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_13_59_16&#39;)"><span class="hl_vardecl"><span class="mpre">sec</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">c_parse_unix_time_gmt</span></span><span class="mpre"> </span><a href="#loc_57_25_57_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_25_57_29&#39;)"><span class="hl_varref"><span class="mpre">cfmt</span></span></a><span class="mpre"> </span><a href="#loc_58_29_58_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_29_58_33&#39;)"><span class="hl_varref"><span class="mpre">cstr</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">UnixTime</span></span><span class="mpre"> </span><a href="#loc_59_13_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_13_59_16&#39;)"><span class="hl_varref"><span class="mpre">sec</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Formatting &#39;UnixTime&#39; to &#39;ByteString&#39; in local time.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper for strftime_l().</span></span><span class="mpre">

</span><a href="#loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="mpre">formatUnixTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Format</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="hl_fundecl"><span class="mpre">formatUnixTime</span></span></a><span class="mpre"> </span><a name="loc_69_16_69_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_16_69_19&#39;)"><span class="hl_vardecl"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><a name="loc_69_20_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_21&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> =
    </span><a href="#loc_93_1_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_21&#39;)"><span class="hl_varref"><span class="mpre">formatUnixTimeHelper</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">c_format_unix_time</span></span><span class="mpre"> </span><a href="#loc_69_16_69_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_16_69_19&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><a href="#loc_69_20_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_21&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="mpre">formatUnixTime</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Formatting &#39;UnixTime&#39; to &#39;ByteString&#39; in GMT.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is a wrapper for strftime_l().</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; formatUnixTimeGMT webDateFormat $ UnixTime 0 0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Thu, 01 Jan 1970 00:00:00 GMT&quot;</span></span><span class="mpre">

</span><a href="#loc_81_1_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_18&#39;)"><span class="mpre">formatUnixTimeGMT</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Format</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_81_1_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_18&#39;)"><span class="hl_fundecl"><span class="mpre">formatUnixTimeGMT</span></span></a><span class="mpre"> </span><a name="loc_81_19_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_19_81_22&#39;)"><span class="hl_vardecl"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><a name="loc_81_23_81_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_23_81_24&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> =
    </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_93_1_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_21&#39;)"><span class="hl_varref"><span class="mpre">formatUnixTimeHelper</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">c_format_unix_time_gmt</span></span><span class="mpre"> </span><a href="#loc_81_19_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_19_81_22&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><a href="#loc_81_23_81_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_23_81_24&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_81_1_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_18&#39;)"><span class="mpre">formatUnixTimeGMT</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Helper handling memory allocation for formatUnixTime and formatUnixTimeGMT.</span></span><span class="mpre">

</span><a href="#loc_93_1_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_21&#39;)"><span class="mpre">formatUnixTimeHelper</span></a><span class="mpre">
    :: (</span><span class="hl_tyconref"><span class="mpre">CString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CTime</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CSize</span></span><span class="mpre">)
    -&gt; </span><span class="hl_tyconref"><span class="mpre">Format</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_93_1_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_21&#39;)"><span class="hl_fundecl"><span class="mpre">formatUnixTimeHelper</span></span></a><span class="mpre"> </span><a name="loc_93_22_93_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_22_93_31&#39;)"><span class="hl_vardecl"><span class="mpre">formatFun</span></span></a><span class="mpre"> </span><a name="loc_93_32_93_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_32_93_35&#39;)"><span class="hl_vardecl"><span class="mpre">fmt</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">UnixTime</span></span><span class="mpre"> </span><a name="loc_93_46_93_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_46_93_49&#39;)"><span class="hl_vardecl"><span class="mpre">sec</span></span></a><span class="mpre"> _) =
    </span><span class="hl_varref"><span class="mpre">useAsCString</span></span><span class="mpre"> </span><a href="#loc_93_32_93_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_32_93_35&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_94_25_94_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_25_94_29&#39;)"><span class="hl_vardecl"><span class="mpre">cfmt</span></span></a><span class="mpre"> -&gt; do
        let </span><a name="loc_95_13_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_16&#39;)"><span class="hl_vardecl"><span class="mpre">siz</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">80</span></span><span class="mpre">
        </span><a name="loc_96_9_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_12&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre">  &lt;- </span><a href="Foreign.Marshal.Alloc.html#loc_96_1_96_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_96_1_96_12&#39;)"><span class="hl_varref"><span class="mpre">mallocBytes</span></span></a><span class="mpre"> </span><a href="#loc_95_13_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_16&#39;)"><span class="hl_varref"><span class="mpre">siz</span></span></a><span class="mpre">
        </span><a name="loc_97_9_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_12&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_93_22_93_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_22_93_31&#39;)"><span class="hl_varref"><span class="mpre">formatFun</span></span></a><span class="mpre"> </span><a href="#loc_94_25_94_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_25_94_29&#39;)"><span class="hl_varref"><span class="mpre">cfmt</span></span></a><span class="mpre"> </span><a href="#loc_93_46_93_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_46_93_49&#39;)"><span class="hl_varref"><span class="mpre">sec</span></span></a><span class="mpre"> </span><a href="#loc_96_9_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_12&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_95_13_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_16&#39;)"><span class="hl_varref"><span class="mpre">siz</span></span></a><span class="mpre">)
        </span><a name="loc_98_9_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_13&#39;)"><span class="hl_vardecl"><span class="mpre">ptr&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Foreign.Marshal.Alloc.html#loc_174_1_174_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_174_1_174_13&#39;)"><span class="hl_varref"><span class="mpre">reallocBytes</span></span></a><span class="mpre"> </span><a href="#loc_96_9_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_12&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><a href="#loc_97_9_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_12&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a href="Data.ByteString.Unsafe.html#loc_248_1_248_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_248_1_248_24&#39;)"><span class="hl_varref"><span class="mpre">unsafePackMallocCString</span></span></a><span class="mpre"> </span><a href="#loc_98_9_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_13&#39;)"><span class="hl_varref"><span class="mpre">ptr&#39;</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- FIXME: Use unsafePackMallocCStringLen from bytestring-0.10.2.0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Format for web (RFC 2616).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The value is \&quot;%a, %d %b %Y %H:%M:%S GMT\&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This should be used with &#39;formatUnixTimeGMT&#39; and &#39;parseUnixTimeGMT&#39;.</span></span><span class="mpre">

</span><a href="#loc_109_1_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_14&#39;)"><span class="mpre">webDateFormat</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Format</span></span><span class="mpre">
</span><a name="loc_109_1_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_14&#39;)"><span class="hl_vardecl"><span class="mpre">webDateFormat</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;%a, %d %b %Y %H:%M:%S GMT&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Format for e-mail (RFC 5322).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The value is \&quot;%a, %d %b %Y %H:%M:%S %z\&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This should be used with &#39;formatUnixTime&#39; and &#39;parseUnixTime&#39;.</span></span><span class="mpre">

</span><a href="#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_15&#39;)"><span class="mpre">mailDateFormat</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Format</span></span><span class="mpre">
</span><a name="loc_117_1_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_15&#39;)"><span class="hl_vardecl"><span class="mpre">mailDateFormat</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;%a, %d %b %Y %H:%M:%S %z&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- From &#39;EpochTime&#39; to &#39;UnixTime&#39; setting &#39;utMicroSeconds&#39; to 0.</span></span><span class="mpre">

</span><a href="#loc_125_1_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_14&#39;)"><span class="mpre">fromEpochTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">EpochTime</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre">
</span><a name="loc_125_1_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_14&#39;)"><span class="hl_fundecl"><span class="mpre">fromEpochTime</span></span></a><span class="mpre"> </span><a name="loc_125_15_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_18&#39;)"><span class="hl_vardecl"><span class="mpre">sec</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UnixTime</span></span><span class="mpre"> </span><a href="#loc_125_15_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_18&#39;)"><span class="hl_varref"><span class="mpre">sec</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- From &#39;UnixTime&#39; to &#39;EpochTime&#39; ignoring &#39;utMicroSeconds&#39;.</span></span><span class="mpre">

</span><a href="#loc_131_1_131_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_12&#39;)"><span class="mpre">toEpochTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">EpochTime</span></span><span class="mpre">
</span><a name="loc_131_1_131_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_12&#39;)"><span class="hl_fundecl"><span class="mpre">toEpochTime</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">UnixTime</span></span><span class="mpre"> </span><a name="loc_131_23_131_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_23_131_26&#39;)"><span class="hl_vardecl"><span class="mpre">sec</span></span></a><span class="mpre"> _) = </span><a href="#loc_131_23_131_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_23_131_26&#39;)"><span class="hl_varref"><span class="mpre">sec</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- From &#39;ClockTime&#39; to &#39;UnixTime&#39;.</span></span><span class="mpre">

</span><a href="#loc_137_1_137_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_14&#39;)"><span class="mpre">fromClockTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ClockTime</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre">
</span><a name="loc_137_1_137_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_14&#39;)"><span class="hl_fundecl"><span class="mpre">fromClockTime</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">TOD</span></span><span class="mpre"> </span><a name="loc_137_20_137_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_23&#39;)"><span class="hl_vardecl"><span class="mpre">sec</span></span></a><span class="mpre"> </span><a name="loc_137_24_137_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_24_137_28&#39;)"><span class="hl_vardecl"><span class="mpre">psec</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">UnixTime</span></span><span class="mpre"> </span><a href="#loc_139_5_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_9&#39;)"><span class="hl_varref"><span class="mpre">sec&#39;</span></span></a><span class="mpre"> </span><a href="#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_10&#39;)"><span class="hl_varref"><span class="mpre">usec&#39;</span></span></a><span class="mpre">
  where
    </span><a name="loc_139_5_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_9&#39;)"><span class="hl_vardecl"><span class="mpre">sec&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_137_20_137_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_20_137_23&#39;)"><span class="hl_varref"><span class="mpre">sec</span></span></a><span class="mpre">
    </span><a name="loc_140_5_140_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">usec&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_24_137_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_24_137_28&#39;)"><span class="hl_varref"><span class="mpre">psec</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000000</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- From &#39;UnixTime&#39; to &#39;ClockTime&#39;.</span></span><span class="mpre">

</span><a href="#loc_146_1_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_12&#39;)"><span class="mpre">toClockTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">UnixTime</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ClockTime</span></span><span class="mpre">
</span><a name="loc_146_1_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_12&#39;)"><span class="hl_fundecl"><span class="mpre">toClockTime</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">UnixTime</span></span><span class="mpre"> </span><a name="loc_146_23_146_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_23_146_26&#39;)"><span class="hl_vardecl"><span class="mpre">sec</span></span></a><span class="mpre"> </span><a name="loc_146_27_146_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_27_146_31&#39;)"><span class="hl_vardecl"><span class="mpre">usec</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">TOD</span></span><span class="mpre"> </span><a href="#loc_148_5_148_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_5_148_9&#39;)"><span class="hl_varref"><span class="mpre">sec&#39;</span></span></a><span class="mpre"> </span><a href="#loc_149_5_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_5_149_10&#39;)"><span class="hl_varref"><span class="mpre">psec&#39;</span></span></a><span class="mpre">
  where
    </span><a name="loc_148_5_148_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_5_148_9&#39;)"><span class="hl_vardecl"><span class="mpre">sec&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">truncate</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre"> </span><a href="#loc_146_23_146_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_23_146_26&#39;)"><span class="hl_varref"><span class="mpre">sec</span></span></a><span class="mpre">)
    </span><a name="loc_149_5_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_5_149_10&#39;)"><span class="hl_vardecl"><span class="mpre">psec&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_146_27_146_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_27_146_31&#39;)"><span class="hl_varref"><span class="mpre">usec</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000000</span></span><span class="mpre">
</span></div></body></html>