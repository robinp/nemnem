<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.Cert</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- X.509 Certificate types and functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.X509.Cert (Certificate(..)) where

import Data.ASN1.Types
import Data.Time.Clock (</span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="mpre">UTCTime</span></a><span class="mpre">)
import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">, </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="mpre">(&lt;*&gt;)</span></a><span class="mpre">)
import Control.Monad.Error
import Data.X509.Internal
import Data.X509.PublicKey
import Data.X509.AlgorithmIdentifier
import Data.X509.DistinguishedName
import Data.X509.ExtensionRaw

data </span><span class="hl_tycondecl"><span class="mpre">CertKeyUsage</span></span><span class="mpre"> =
          </span><span class="hl_condecl"><span class="mpre">CertKeyUsageDigitalSignature</span></span><span class="mpre">
        | </span><span class="hl_condecl"><span class="mpre">CertKeyUsageNonRepudiation</span></span><span class="mpre">
        | </span><span class="hl_condecl"><span class="mpre">CertKeyUsageKeyEncipherment</span></span><span class="mpre">
        | </span><span class="hl_condecl"><span class="mpre">CertKeyUsageDataEncipherment</span></span><span class="mpre">
        | </span><span class="hl_condecl"><span class="mpre">CertKeyUsageKeyAgreement</span></span><span class="mpre">
        | </span><span class="hl_condecl"><span class="mpre">CertKeyUsageKeyCertSign</span></span><span class="mpre">
        | </span><span class="hl_condecl"><span class="mpre">CertKeyUsageCRLSign</span></span><span class="mpre">
        | </span><span class="hl_condecl"><span class="mpre">CertKeyUsageEncipherOnly</span></span><span class="mpre">
        | </span><span class="hl_condecl"><span class="mpre">CertKeyUsageDecipherOnly</span></span><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Cert.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 9, srcSpanEndLine = 32, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Cert.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 9, srcSpanEndLine = 32, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Cert.hs&quot;, srcSpanStartLine = 32, srcSpanStart"><span class="mpre">deriving (Show, Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | X.509 Certificate type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This type doesn&#39;t include the signature, it&#39;s describe in the RFC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as tbsCertificate.</span></span><span class="mpre">
data </span><a name="loc_38_6_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_17&#39;)"><span class="hl_tycondecl"><span class="mpre">Certificate</span></span></a><span class="mpre"> = </span><a name="loc_38_20_38_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_20_38_31&#39;)"><span class="hl_condecl"><span class="mpre">Certificate</span></span></a><span class="mpre">
        { </span><a name="loc_39_11_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_22&#39;)"><span class="hl_fielddecl"><span class="mpre">certVersion</span></span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                    </span><span class="hl_comment"><span class="mpre">-- ^ Version</span></span><span class="mpre">
        , </span><a name="loc_40_11_40_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_21&#39;)"><span class="hl_fielddecl"><span class="mpre">certSerial</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- ^ Serial number</span></span><span class="mpre">
        , </span><a name="loc_41_11_41_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_11_41_27&#39;)"><span class="hl_fielddecl"><span class="mpre">certSignatureAlg</span></span></a><span class="mpre"> :: </span><a href="Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureALG</span></span></a><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ Signature algorithm</span></span><span class="mpre">
        , </span><a name="loc_42_11_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_11_42_23&#39;)"><span class="hl_fielddecl"><span class="mpre">certIssuerDN</span></span></a><span class="mpre">     :: </span><a href="Data.X509.DistinguishedName.html#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.DistinguishedName.html#loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ Issuer DN</span></span><span class="mpre">
        , </span><a name="loc_43_11_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_23&#39;)"><span class="hl_fielddecl"><span class="mpre">certValidity</span></span></a><span class="mpre">     :: (</span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">, </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">)     </span><span class="hl_comment"><span class="mpre">-- ^ Validity period</span></span><span class="mpre">
        , </span><a name="loc_44_11_44_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_24&#39;)"><span class="hl_fielddecl"><span class="mpre">certSubjectDN</span></span></a><span class="mpre">    :: </span><a href="Data.X509.DistinguishedName.html#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.DistinguishedName.html#loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ Subject DN</span></span><span class="mpre">
        , </span><a name="loc_45_11_45_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_21&#39;)"><span class="hl_fielddecl"><span class="mpre">certPubKey</span></span></a><span class="mpre">       :: </span><a href="Data.X509.PublicKey.html#loc_31_6_31_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.PublicKey.html#loc_31_6_31_12&#39;)"><span class="hl_tyconref"><span class="mpre">PubKey</span></span></a><span class="mpre">                 </span><span class="hl_comment"><span class="mpre">-- ^ Public key</span></span><span class="mpre">
        , </span><a name="loc_46_11_46_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_11_46_25&#39;)"><span class="hl_fielddecl"><span class="mpre">certExtensions</span></span></a><span class="mpre">   :: </span><a href="Data.X509.ExtensionRaw.html#loc_29_9_29_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.ExtensionRaw.html#loc_29_9_29_19&#39;)"><span class="hl_tyconref"><span class="mpre">Extensions</span></span></a><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ Extensions</span></span><span class="mpre">
        } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Cert.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 11, srcSpanEndLine = 47, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Cert.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 11, srcSpanEndLine = 47, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Cert.hs&quot;, srcSpanStartLine = 47, srcSpanSta"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre">   </span><a name="loc_50_14_50_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_14_50_25&#39;)"><span class="hl_vardecl"><span class="mpre">certificate</span></span></a><span class="mpre"> = \</span><a name="loc_50_29_50_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_29_50_31&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_99_1_99_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_24&#39;)"><span class="hl_varref"><span class="mpre">encodeCertificateHeader</span></span></a><span class="mpre"> </span><a href="#loc_50_14_50_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_14_50_25&#39;)"><span class="hl_varref"><span class="mpre">certificate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_50_29_50_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_29_50_31&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> </span><a name="loc_51_14_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">           = </span><a href="Data.ASN1.Parse.html#loc_39_1_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_39_1_39_18&#39;)"><span class="hl_varref"><span class="mpre">runParseASN1State</span></span></a><span class="mpre"> </span><a href="#loc_88_1_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_17&#39;)"><span class="hl_varref"><span class="mpre">parseCertificate</span></span></a><span class="mpre"> </span><a href="#loc_51_14_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_54_1_54_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_23&#39;)"><span class="mpre">parseCertHeaderVersion</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Parse.html#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_54_1_54_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_23&#39;)"><span class="hl_vardecl"><span class="mpre">parseCertHeaderVersion</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_118_1_118_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_118_1_118_21&#39;)"><span class="hl_varref"><span class="mpre">onNextContainerMaybe</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_34_29_34_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_34_29_34_38&#39;)"><span class="hl_conref"><span class="mpre">Container</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) (</span><a href="Data.ASN1.Parse.html#loc_65_1_65_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_65_1_65_8&#39;)"><span class="hl_varref"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_56_9_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_15&#39;)"><span class="hl_varref"><span class="mpre">getVer</span></span></a><span class="mpre">)
  where </span><a name="loc_56_9_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_15&#39;)"><span class="hl_fundecl"><span class="mpre">getVer</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><a name="loc_56_24_56_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_24_56_25&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_56_24_56_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_24_56_25&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
        </span><a href="#loc_56_9_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_15&#39;)"><span class="hl_fundecl"><span class="mpre">getVer</span></span></a><span class="mpre"> _          = </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unexpected type for version&quot;</span></span><span class="mpre">

</span><a href="#loc_60_1_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_22&#39;)"><span class="mpre">parseCertHeaderSerial</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Parse.html#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_60_1_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_22&#39;)"><span class="hl_vardecl"><span class="mpre">parseCertHeaderSerial</span></span></a><span class="mpre"> = do
    </span><a name="loc_61_5_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_6&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ASN1.Parse.html#loc_65_1_65_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_65_1_65_8&#39;)"><span class="hl_varref"><span class="mpre">getNext</span></span></a><span class="mpre">
    case </span><a href="#loc_61_5_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> of
        </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><a name="loc_63_16_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_16_63_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_63_16_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_16_63_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
        _        -&gt; </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;missing serial&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_61_5_61_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><a href="#loc_67_1_67_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_24&#39;)"><span class="mpre">parseCertHeaderValidity</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Parse.html#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> (</span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">, </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">)
</span><a name="loc_67_1_67_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_24&#39;)"><span class="hl_vardecl"><span class="mpre">parseCertHeaderValidity</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Parse.html#loc_93_1_93_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_93_1_93_17&#39;)"><span class="hl_varref"><span class="mpre">getNextContainer</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_68_9_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_20&#39;)"><span class="hl_varref"><span class="mpre">toTimeBound</span></span></a><span class="mpre">
  where </span><a name="loc_68_9_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_20&#39;)"><span class="hl_fundecl"><span class="mpre">toTimeBound</span></span></a><span class="mpre"> [ </span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> _ </span><a name="loc_68_34_68_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_34_68_36&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre"> _, </span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> _ </span><a name="loc_68_51_68_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_51_68_53&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre"> _ ] = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_68_34_68_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_34_68_36&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre">,</span><a href="#loc_68_51_68_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_51_68_53&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre">)
        </span><a href="#loc_68_9_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_20&#39;)"><span class="hl_fundecl"><span class="mpre">toTimeBound</span></span></a><span class="mpre"> _                                    = </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bad validity format&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- | parse header structure of a x509 certificate. the structure is the following:
        Version
        Serial Number
        Algorithm ID
        Issuer
        Validity
                Not Before
                Not After
        Subject
        Subject Public Key Info
                Public Key Algorithm
                Subject Public Key
        Issuer Unique Identifier (Optional)  (&gt;= 2)
        Subject Unique Identifier (Optional) (&gt;= 2)
        Extensions (Optional)   (&gt;= v3)
-}</span></span><span class="mpre">
</span><a href="#loc_88_1_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_17&#39;)"><span class="mpre">parseCertificate</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Parse.html#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><a href="#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre">
</span><a name="loc_88_1_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_17&#39;)"><span class="hl_vardecl"><span class="mpre">parseCertificate</span></span></a><span class="mpre"> =
    </span><a href="#loc_38_20_38_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_20_38_31&#39;)"><span class="hl_conref"><span class="mpre">Certificate</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_54_1_54_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_23&#39;)"><span class="hl_varref"><span class="mpre">parseCertHeaderVersion</span></span></a><span class="mpre">
                </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_60_1_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_22&#39;)"><span class="hl_varref"><span class="mpre">parseCertHeaderSerial</span></span></a><span class="mpre">
                </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">getObject</span></span></a><span class="mpre">
                </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">getObject</span></span></a><span class="mpre">
                </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_67_1_67_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_24&#39;)"><span class="hl_varref"><span class="mpre">parseCertHeaderValidity</span></span></a><span class="mpre">
                </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">getObject</span></span></a><span class="mpre">
                </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">getObject</span></span></a><span class="mpre">
                </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">getObject</span></span></a><span class="mpre">

</span><a href="#loc_99_1_99_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_24&#39;)"><span class="mpre">encodeCertificateHeader</span></a><span class="mpre"> :: </span><a href="#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">]
</span><a name="loc_99_1_99_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_24&#39;)"><span class="hl_fundecl"><span class="mpre">encodeCertificateHeader</span></span></a><span class="mpre"> </span><a name="loc_99_25_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_29&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> =
    </span><a href="#loc_101_9_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_13&#39;)"><span class="hl_varref"><span class="mpre">eVer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_102_9_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_16&#39;)"><span class="hl_varref"><span class="mpre">eSerial</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_103_9_103_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_15&#39;)"><span class="hl_varref"><span class="mpre">eAlgId</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_104_9_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_16&#39;)"><span class="hl_varref"><span class="mpre">eIssuer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_106_9_106_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_18&#39;)"><span class="hl_varref"><span class="mpre">eValidity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_108_9_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_17&#39;)"><span class="hl_varref"><span class="mpre">eSubject</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_109_9_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_16&#39;)"><span class="hl_varref"><span class="mpre">epkinfo</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_110_9_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_14&#39;)"><span class="hl_varref"><span class="mpre">eexts</span></span></a><span class="mpre">
  where </span><a name="loc_101_9_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_13&#39;)"><span class="hl_vardecl"><span class="mpre">eVer</span></span></a><span class="mpre">      = </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_34_29_34_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_34_29_34_38&#39;)"><span class="hl_conref"><span class="mpre">Container</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) [</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_39_11_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_22&#39;)"><span class="hl_varref"><span class="mpre">certVersion</span></span></a><span class="mpre"> </span><a href="#loc_99_25_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">)]
        </span><a name="loc_102_9_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_16&#39;)"><span class="hl_vardecl"><span class="mpre">eSerial</span></span></a><span class="mpre">   = [</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_40_11_40_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_21&#39;)"><span class="hl_varref"><span class="mpre">certSerial</span></span></a><span class="mpre"> </span><a href="#loc_99_25_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">]
        </span><a name="loc_103_9_103_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_15&#39;)"><span class="hl_vardecl"><span class="mpre">eAlgId</span></span></a><span class="mpre">    = </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_41_11_41_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_11_41_27&#39;)"><span class="hl_varref"><span class="mpre">certSignatureAlg</span></span></a><span class="mpre"> </span><a href="#loc_99_25_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">) []
        </span><a name="loc_104_9_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_16&#39;)"><span class="hl_vardecl"><span class="mpre">eIssuer</span></span></a><span class="mpre">   = </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_42_11_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_11_42_23&#39;)"><span class="hl_varref"><span class="mpre">certIssuerDN</span></span></a><span class="mpre"> </span><a href="#loc_99_25_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">) []
        (</span><a name="loc_105_10_105_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_10_105_12&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre">, </span><a name="loc_105_14_105_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_14_105_16&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre">)  = </span><a href="#loc_43_11_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_23&#39;)"><span class="hl_varref"><span class="mpre">certValidity</span></span></a><span class="mpre"> </span><a href="#loc_99_25_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">
        </span><a name="loc_106_9_106_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_18&#39;)"><span class="hl_vardecl"><span class="mpre">eValidity</span></span></a><span class="mpre"> = </span><a href="Data.X509.Internal.html#loc_19_1_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Internal.html#loc_19_1_19_14&#39;)"><span class="hl_varref"><span class="mpre">asn1Container</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_39_21_39_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_39_21_39_36&#39;)"><span class="hl_conref"><span class="mpre">TimeGeneralized</span></span></a><span class="mpre"> </span><a href="#loc_105_10_105_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_10_105_12&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                                           ,</span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_39_21_39_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_39_21_39_36&#39;)"><span class="hl_conref"><span class="mpre">TimeGeneralized</span></span></a><span class="mpre"> </span><a href="#loc_105_14_105_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_14_105_16&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">]
        </span><a name="loc_108_9_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_17&#39;)"><span class="hl_vardecl"><span class="mpre">eSubject</span></span></a><span class="mpre">  = </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_44_11_44_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_24&#39;)"><span class="hl_varref"><span class="mpre">certSubjectDN</span></span></a><span class="mpre"> </span><a href="#loc_99_25_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">) []
        </span><a name="loc_109_9_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_16&#39;)"><span class="hl_vardecl"><span class="mpre">epkinfo</span></span></a><span class="mpre">   = </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_45_11_45_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_21&#39;)"><span class="hl_varref"><span class="mpre">certPubKey</span></span></a><span class="mpre"> </span><a href="#loc_99_25_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">) []
        </span><a name="loc_110_9_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_14&#39;)"><span class="hl_vardecl"><span class="mpre">eexts</span></span></a><span class="mpre">     = </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_46_11_46_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_11_46_25&#39;)"><span class="hl_varref"><span class="mpre">certExtensions</span></span></a><span class="mpre"> </span><a href="#loc_99_25_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_29&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">) []
</span></div></body></html>