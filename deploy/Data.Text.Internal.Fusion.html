<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, MagicHash #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Text.Internal.Fusion</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) Tom Harper 2008-2009,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) Bryan O&#39;Sullivan 2009-2010,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) Duncan Coutts 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Warning/: this is an internal module, and does not have a stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- API or name. Functions in this module may not check or enforce</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- preconditions expected by public modules. Use at your own risk!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Text manipulation functions represented as fusible operations over</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- streams.</span></span><span class="mpre">
module Data.Text.Internal.Fusion
    (
    </span><span class="hl_comment"><span class="mpre">-- * Types</span></span><span class="mpre">
      Stream(..)
    , Step(..)

    </span><span class="hl_comment"><span class="mpre">-- * Creation and elimination</span></span><span class="mpre">
    , stream
    , unstream
    , reverseStream

    , length

    </span><span class="hl_comment"><span class="mpre">-- * Transformations</span></span><span class="mpre">
    , reverse

    </span><span class="hl_comment"><span class="mpre">-- * Construction</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** Scans</span></span><span class="mpre">
    , reverseScanr

    </span><span class="hl_comment"><span class="mpre">-- ** Accumulating maps</span></span><span class="mpre">
    , mapAccumL

    </span><span class="hl_comment"><span class="mpre">-- ** Generation and unfolding</span></span><span class="mpre">
    , unfoldrN

    </span><span class="hl_comment"><span class="mpre">-- * Indexing</span></span><span class="mpre">
    , index
    , findIndex
    , countChar
    ) where

import Prelude (Bool(..), Char, </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="mpre">Maybe</span></a><span class="mpre">(..), Monad(..), Int,
                Num(..), Ord(..), ($), (&amp;&amp;),
                fromIntegral, otherwise)
import Data.Bits ((.&amp;.))
import Data.Text.Internal (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">(..))
import Data.Text.Internal.Private (</span><a href="Data.Text.Internal.Private.html#loc_34_1_34_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Private.html#loc_34_1_34_8&#39;)"><span class="mpre">runText</span></a><span class="mpre">)
import Data.Text.Internal.Unsafe.Char (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_40_1_40_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_40_1_40_4&#39;)"><span class="mpre">ord</span></a><span class="mpre">, </span><a href="Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10&#39;)"><span class="mpre">unsafeChr</span></a><span class="mpre">, </span><a href="Data.Text.Internal.Unsafe.Char.html#loc_58_1_58_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_58_1_58_12&#39;)"><span class="mpre">unsafeWrite</span></a><span class="mpre">)
import Data.Text.Internal.Unsafe.Shift (</span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">, </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">)
import qualified Data.Text.Array as A
import qualified Data.Text.Internal.Fusion.Common as S
import Data.Text.Internal.Fusion.Types
import Data.Text.Internal.Fusion.Size
import qualified Data.Text.Internal as I
import qualified Data.Text.Internal.Encoding.Utf16 as U16

</span><span class="warning" data-warning="DeclDefaultDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusion.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 1, srcSpanEndLine = 67, srcSpanEndColumn = 13}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusion.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 1, srcSpanEndLine = 67, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusion.hs"><span class="mpre">default(Int)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Convert a &#39;Text&#39; into a &#39;Stream Char&#39;.</span></span><span class="mpre">
</span><a href="#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="mpre">stream</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="hl_fundecl"><span class="mpre">stream</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_71_14_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_17&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_71_18_71_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_21&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_71_22_71_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_22_71_25&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a href="#loc_74_7_74_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_11&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_71_18_71_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_21&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Size.html#loc_65_1_65_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_65_1_65_12&#39;)"><span class="hl_varref"><span class="mpre">betweenSize</span></span></a><span class="mpre"> (</span><a href="#loc_71_22_71_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_22_71_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_71_22_71_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_22_71_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)
    where
      !</span><a name="loc_73_8_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_8_73_11&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre"> = </span><a href="#loc_71_18_71_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_21&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_71_22_71_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_22_71_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
      </span><a name="loc_74_7_74_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_11&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> !</span><a name="loc_74_13_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
          | </span><a href="#loc_74_13_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_73_8_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_8_73_11&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre">                   = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">
          | </span><a href="#loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDBFF</span></span><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5&#39;)"><span class="hl_varref"><span class="mpre">U16.chr2</span></span></a><span class="mpre"> </span><a href="#loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_80_13_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_15&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre">) (</span><a href="#loc_74_13_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                  = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10&#39;)"><span class="hl_varref"><span class="mpre">unsafeChr</span></span></a><span class="mpre"> </span><a href="#loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><a href="#loc_74_13_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          where
            </span><a name="loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">  = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_71_14_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_17&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_74_13_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            </span><a name="loc_80_13_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">n2</span></span></a><span class="mpre"> = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_71_14_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_17&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> (</span><a href="#loc_74_13_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="mpre">stream</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Convert a &#39;Text&#39; into a &#39;Stream Char&#39;, but iterate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- backwards.</span></span><span class="mpre">
</span><a href="#loc_86_1_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_14&#39;)"><span class="mpre">reverseStream</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_86_1_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_14&#39;)"><span class="hl_fundecl"><span class="mpre">reverseStream</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_86_21_86_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_21_86_24&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_86_25_86_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_25_86_28&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_86_29_86_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_32&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a href="#loc_89_7_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_11&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> (</span><a href="#loc_86_25_86_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_25_86_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_86_29_86_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_32&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="Data.Text.Internal.Fusion.Size.html#loc_65_1_65_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_65_1_65_12&#39;)"><span class="hl_varref"><span class="mpre">betweenSize</span></span></a><span class="mpre"> (</span><a href="#loc_86_29_86_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_32&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_86_29_86_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_32&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)
    where
      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_89_7_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_11&#39;)"><span class="mpre">next</span></a><span class="mpre"> #-}</span></span><span class="mpre">
      </span><a name="loc_89_7_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_11&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> !</span><a name="loc_89_13_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
          | </span><a href="#loc_89_13_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_86_25_86_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_25_86_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre">                    = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">
          | </span><a href="#loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDC00</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDFFF</span></span><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5&#39;)"><span class="hl_varref"><span class="mpre">U16.chr2</span></span></a><span class="mpre"> </span><a href="#loc_95_13_95_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_15&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre"> </span><a href="#loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><a href="#loc_89_13_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                  = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10&#39;)"><span class="hl_varref"><span class="mpre">unsafeChr</span></span></a><span class="mpre"> </span><a href="#loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><a href="#loc_89_13_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          where
            </span><a name="loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">  = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_86_21_86_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_21_86_24&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_89_13_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            </span><a name="loc_95_13_95_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_15&#39;)"><span class="hl_vardecl"><span class="mpre">n2</span></span></a><span class="mpre"> = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_86_21_86_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_21_86_24&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> (</span><a href="#loc_89_13_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_86_1_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_14&#39;)"><span class="mpre">reverseStream</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Convert a &#39;Stream Char&#39; into a &#39;Text&#39;.</span></span><span class="mpre">
</span><a href="#loc_100_1_100_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_9&#39;)"><span class="mpre">unstream</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_100_1_100_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_9&#39;)"><span class="hl_fundecl"><span class="mpre">unstream</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a name="loc_100_18_100_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_18_100_23&#39;)"><span class="hl_vardecl"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a name="loc_100_24_100_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_24_100_26&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_100_27_100_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_27_100_30&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="Data.Text.Internal.Private.html#loc_34_1_34_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Private.html#loc_34_1_34_8&#39;)"><span class="hl_varref"><span class="mpre">runText</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_100_45_100_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_45_100_49&#39;)"><span class="hl_vardecl"><span class="mpre">done</span></span></a><span class="mpre"> -&gt; do
  let </span><a name="loc_101_7_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_7_101_11&#39;)"><span class="hl_vardecl"><span class="mpre">mlen</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Size.html#loc_138_1_138_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_138_1_138_11&#39;)"><span class="hl_varref"><span class="mpre">upperBound</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_100_27_100_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_27_100_30&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
  </span><a name="loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="hl_vardecl"><span class="mpre">arr0</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Array.html#loc_115_1_115_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_115_1_115_4&#39;)"><span class="hl_varref"><span class="mpre">A.new</span></span></a><span class="mpre"> </span><a href="#loc_101_7_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_7_101_11&#39;)"><span class="hl_varref"><span class="mpre">mlen</span></span></a><span class="mpre">
  let </span><a name="loc_103_7_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_7_103_12&#39;)"><span class="hl_fundecl"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a name="loc_103_13_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_13_103_16&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_103_17_103_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_17_103_20&#39;)"><span class="hl_vardecl"><span class="mpre">top</span></span></a><span class="mpre"> = </span><a href="#loc_105_9_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
       where
        </span><a name="loc_105_9_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_105_15_105_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_15_105_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> !</span><a name="loc_105_18_105_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> =
            case </span><a href="#loc_100_18_100_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_18_100_23&#39;)"><span class="hl_varref"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a href="#loc_105_15_105_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_15_105_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
              </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">          -&gt; </span><a href="#loc_100_45_100_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_45_100_49&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="#loc_103_13_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_13_103_16&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_105_18_105_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
              </span><a href="Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21&#39;)"><span class="hl_conref"><span class="mpre">Skip</span></span></a><span class="mpre"> </span><a name="loc_108_20_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_22&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">       -&gt; </span><a href="#loc_105_9_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_108_20_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_22&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_105_18_105_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
              </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a name="loc_109_21_109_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_21_109_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_109_23_109_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_23_109_25&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">
                | </span><a href="#loc_117_23_117_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_23_117_24&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_103_17_103_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_17_103_20&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre">  -&gt; </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusion.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 32, srcSpanEndLine = 115, srcSpanEndColumn = 0}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusion.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 40, srcSpanEndLine = 110, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusio"><span class="mpre">{-# SCC &quot;unstream/resize&quot; #-} do
                               let top&#39; = (top + 1) `shiftL` 1
                               arr&#39; &lt;- A.new top&#39;
                               A.copyM arr&#39; 0 arr 0 top
                               outer arr&#39; top&#39; s i</span></span><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; do </span><a name="loc_115_35_115_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_35_115_36&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Internal.Unsafe.Char.html#loc_58_1_58_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_58_1_58_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeWrite</span></span></a><span class="mpre"> </span><a href="#loc_103_13_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_13_103_16&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_105_18_105_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_109_21_109_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_21_109_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                                  </span><a href="#loc_105_9_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_109_23_109_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_23_109_25&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_105_18_105_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_115_35_115_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_35_115_36&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
                where </span><a name="loc_117_23_117_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_23_117_24&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> | </span><a href="Data.Text.Internal.Unsafe.Char.html#loc_40_1_40_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_40_1_40_4&#39;)"><span class="hl_varref"><span class="mpre">ord</span></span></a><span class="mpre"> </span><a href="#loc_109_21_109_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_21_109_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre"> = </span><a href="#loc_105_18_105_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = </span><a href="#loc_105_18_105_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
  </span><a href="#loc_103_7_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_7_103_12&#39;)"><span class="hl_varref"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a href="#loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="hl_varref"><span class="mpre">arr0</span></span></a><span class="mpre"> </span><a href="#loc_101_7_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_7_101_11&#39;)"><span class="hl_varref"><span class="mpre">mlen</span></span></a><span class="mpre"> </span><a href="#loc_100_24_100_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_24_100_26&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_100_1_100_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_9&#39;)"><span class="mpre">unstream</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;STREAM stream/unstream fusion&quot; forall s. stream (unstream s) = s #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- ----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Basic stream functions</span></span><span class="mpre">

</span><a href="#loc_128_1_128_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_7&#39;)"><span class="mpre">length</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_128_1_128_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_7&#39;)"><span class="hl_vardecl"><span class="mpre">length</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Common.html#loc_305_1_305_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Common.html#loc_305_1_305_8&#39;)"><span class="hl_varref"><span class="mpre">S.lengthI</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE[0] </span><a href="#loc_128_1_128_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_7&#39;)"><span class="mpre">length</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Reverse the characters of a string.</span></span><span class="mpre">
</span><a href="#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_8&#39;)"><span class="mpre">reverse</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_133_1_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_8&#39;)"><span class="hl_fundecl"><span class="mpre">reverse</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a name="loc_133_17_133_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_17_133_21&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_133_22_133_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_22_133_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_133_24_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_24_133_28&#39;)"><span class="hl_vardecl"><span class="mpre">len0</span></span></a><span class="mpre">)
    | </span><a href="Data.Text.Internal.Fusion.Size.html#loc_157_1_157_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_157_1_157_8&#39;)"><span class="hl_varref"><span class="mpre">isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_133_24_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_24_133_28&#39;)"><span class="hl_varref"><span class="mpre">len0</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.html#loc_72_1_72_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_72_1_72_6&#39;)"><span class="hl_varref"><span class="mpre">I.empty</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    = </span><a href="Data.Text.Internal.html#loc_78_1_78_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_78_1_78_5&#39;)"><span class="hl_varref"><span class="mpre">I.text</span></span></a><span class="mpre"> </span><a href="#loc_138_6_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_9&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_138_12_138_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_12_138_16&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><a href="#loc_138_18_138_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_18_138_22&#39;)"><span class="hl_varref"><span class="mpre">len&#39;</span></span></a><span class="mpre">
  where
    </span><a name="loc_137_5_137_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_10&#39;)"><span class="hl_vardecl"><span class="mpre">len0&#39;</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Size.html#loc_138_1_138_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_138_1_138_11&#39;)"><span class="hl_varref"><span class="mpre">upperBound</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Size.html#loc_129_1_129_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_129_1_129_7&#39;)"><span class="hl_varref"><span class="mpre">larger</span></span></a><span class="mpre"> </span><a href="#loc_133_24_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_24_133_28&#39;)"><span class="hl_varref"><span class="mpre">len0</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
    (</span><a name="loc_138_6_138_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_6_138_9&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre">, (</span><a name="loc_138_12_138_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_12_138_16&#39;)"><span class="hl_vardecl"><span class="mpre">off&#39;</span></span></a><span class="mpre">, </span><a name="loc_138_18_138_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_18_138_22&#39;)"><span class="hl_vardecl"><span class="mpre">len&#39;</span></span></a><span class="mpre">)) = </span><a href="Data.Text.Array.html#loc_182_1_182_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_182_1_182_5&#39;)"><span class="hl_varref"><span class="mpre">A.run2</span></span></a><span class="mpre"> (</span><a href="Data.Text.Array.html#loc_115_1_115_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_115_1_115_4&#39;)"><span class="hl_varref"><span class="mpre">A.new</span></span></a><span class="mpre"> </span><a href="#loc_137_5_137_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_10&#39;)"><span class="hl_varref"><span class="mpre">len0&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_139_5_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_133_22_133_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_22_133_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_137_5_137_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_10&#39;)"><span class="hl_varref"><span class="mpre">len0&#39;</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_137_5_137_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_10&#39;)"><span class="hl_varref"><span class="mpre">len0&#39;</span></span></a><span class="mpre">)
    </span><a name="loc_139_5_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_9&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_139_11_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_13&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> !</span><a name="loc_139_15_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> !</span><a name="loc_139_18_139_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_21&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_139_22_139_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_22_139_26&#39;)"><span class="hl_vardecl"><span class="mpre">marr</span></span></a><span class="mpre"> =
        case </span><a href="#loc_133_17_133_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_17_133_21&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_139_11_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_13&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> of
          </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_139_22_139_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_22_139_26&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre">, (</span><a href="#loc_142_21_142_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_21_142_22&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">, </span><a href="#loc_139_18_139_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_142_21_142_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_21_142_22&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">))
              where </span><a name="loc_142_21_142_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_21_142_22&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> = </span><a href="#loc_139_15_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
          </span><a href="Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21&#39;)"><span class="hl_conref"><span class="mpre">Skip</span></span></a><span class="mpre"> </span><a name="loc_143_16_143_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_16_143_18&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre">    -&gt; </span><a href="#loc_139_5_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_143_16_143_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_16_143_18&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> </span><a href="#loc_139_15_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_139_18_139_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_139_22_139_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_22_139_26&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre">
          </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a name="loc_144_17_144_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_17_144_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_144_19_144_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_19_144_21&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> | </span><a href="#loc_139_15_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_151_19_151_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_19_151_24&#39;)"><span class="hl_varref"><span class="mpre">least</span></span></a><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusion.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 37, srcSpanEndLine = 149, srcSpanEndColumn = 0}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusion.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 45, srcSpanEndLine = 144, srcSpanEndColumn = 61},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusio"><span class="mpre">{-# SCC &quot;reverse/resize&quot; #-} do
                       let newLen = len `shiftL` 1
                       marr&#39; &lt;- A.new newLen
                       A.copyM marr&#39; (newLen-len) marr 0 len
                       write s1 (len+i) newLen marr&#39;</span></span><span class="mpre">
                     | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_156_19_156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_19_156_24&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_144_19_144_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_19_144_21&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> </span><a href="#loc_139_15_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_139_18_139_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_139_22_139_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_22_139_26&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre">
            where </span><a name="loc_150_19_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_19_150_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Unsafe.Char.html#loc_40_1_40_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_40_1_40_4&#39;)"><span class="hl_varref"><span class="mpre">ord</span></span></a><span class="mpre"> </span><a href="#loc_144_17_144_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_17_144_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                  </span><a name="loc_151_19_151_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_19_151_24&#39;)"><span class="hl_vardecl"><span class="mpre">least</span></span></a><span class="mpre"> | </span><a href="#loc_150_19_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_19_150_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                  </span><a name="loc_153_19_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_20&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_150_19_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_19_150_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">
                  </span><a name="loc_154_19_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_19_154_21&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_153_19_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_20&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre">
                  </span><a name="loc_155_19_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_19_155_21&#39;)"><span class="hl_vardecl"><span class="mpre">hi</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_153_19_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_20&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3FF</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDC00</span></span><span class="mpre">
                  </span><a name="loc_156_19_156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_19_156_24&#39;)"><span class="hl_fundecl"><span class="mpre">write</span></span></a><span class="mpre"> </span><a name="loc_156_25_156_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_25_156_26&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_156_27_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_27_156_28&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> </span><a name="loc_156_29_156_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_29_156_30&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_156_31_156_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_31_156_34&#39;)"><span class="hl_vardecl"><span class="mpre">mar</span></span></a><span class="mpre">
                      | </span><a href="#loc_150_19_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_19_150_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre"> = do
                          </span><a href="Data.Text.Array.html#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_158_1_158_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeWrite</span></span></a><span class="mpre"> </span><a href="#loc_156_31_156_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_31_156_34&#39;)"><span class="hl_varref"><span class="mpre">mar</span></span></a><span class="mpre"> </span><a href="#loc_156_27_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_27_156_28&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_150_19_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_19_150_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
                          </span><a href="#loc_139_5_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_156_25_156_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_25_156_26&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a href="#loc_156_27_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_27_156_28&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_156_29_156_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_29_156_30&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_156_31_156_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_31_156_34&#39;)"><span class="hl_varref"><span class="mpre">mar</span></span></a><span class="mpre">
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
                          </span><a href="Data.Text.Array.html#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_158_1_158_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeWrite</span></span></a><span class="mpre"> </span><a href="#loc_156_31_156_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_31_156_34&#39;)"><span class="hl_varref"><span class="mpre">mar</span></span></a><span class="mpre"> (</span><a href="#loc_156_27_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_27_156_28&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_154_19_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_19_154_21&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre">
                          </span><a href="Data.Text.Array.html#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_158_1_158_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeWrite</span></span></a><span class="mpre"> </span><a href="#loc_156_31_156_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_31_156_34&#39;)"><span class="hl_varref"><span class="mpre">mar</span></span></a><span class="mpre"> </span><a href="#loc_156_27_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_27_156_28&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><a href="#loc_155_19_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_19_155_21&#39;)"><span class="hl_varref"><span class="mpre">hi</span></span></a><span class="mpre">
                          </span><a href="#loc_139_5_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_156_25_156_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_25_156_26&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a href="#loc_156_27_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_27_156_28&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_156_29_156_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_29_156_30&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_156_31_156_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_31_156_34&#39;)"><span class="hl_varref"><span class="mpre">mar</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_8&#39;)"><span class="mpre">reverse</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Perform the equivalent of &#39;scanr&#39; over a list, only with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the input and result reversed.</span></span><span class="mpre">
</span><a href="#loc_169_1_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_13&#39;)"><span class="mpre">reverseScanr</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_169_1_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_13&#39;)"><span class="hl_fundecl"><span class="mpre">reverseScanr</span></span></a><span class="mpre"> </span><a name="loc_169_14_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_169_16_169_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_16_169_18&#39;)"><span class="hl_vardecl"><span class="mpre">z0</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a name="loc_169_27_169_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_27_169_32&#39;)"><span class="hl_vardecl"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a name="loc_169_33_169_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_33_169_35&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_169_36_169_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_36_169_39&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a href="#loc_172_5_172_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_9&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_57_15_57_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_57_15_57_17&#39;)"><span class="hl_conref"><span class="mpre">S1</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a href="#loc_169_16_169_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_16_169_18&#39;)"><span class="hl_varref"><span class="mpre">z0</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a href="#loc_169_33_169_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_33_169_35&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre">) (</span><a href="#loc_169_36_169_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_36_169_39&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- HINT maybe too low</span></span><span class="mpre">
  where
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_172_5_172_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_9&#39;)"><span class="mpre">next</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_172_5_172_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_9&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_57_15_57_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_57_15_57_17&#39;)"><span class="hl_conref"><span class="mpre">S1</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a name="loc_172_18_172_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_18_172_19&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a name="loc_172_24_172_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_24_172_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a href="#loc_172_18_172_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_18_172_19&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_57_20_57_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_57_20_57_22&#39;)"><span class="hl_conref"><span class="mpre">S2</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a href="#loc_172_18_172_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_18_172_19&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a href="#loc_172_24_172_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_24_172_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    </span><a href="#loc_172_5_172_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_9&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_57_20_57_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_57_20_57_22&#39;)"><span class="hl_conref"><span class="mpre">S2</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a name="loc_173_18_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_18_173_19&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a name="loc_173_24_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_24_173_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = case </span><a href="#loc_169_27_169_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_27_169_32&#39;)"><span class="hl_varref"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a href="#loc_173_24_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_24_173_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
                              </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a name="loc_174_37_174_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_37_174_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_174_39_174_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_39_174_41&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> -&gt; let !</span><a name="loc_174_50_174_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_50_174_52&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_169_14_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_174_37_174_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_37_174_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_173_18_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_18_173_19&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
                                            in </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a href="#loc_174_50_174_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_50_174_52&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_57_20_57_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_57_20_57_22&#39;)"><span class="hl_conref"><span class="mpre">S2</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a href="#loc_174_50_174_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_50_174_52&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a href="#loc_174_39_174_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_39_174_41&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">)
                              </span><a href="Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21&#39;)"><span class="hl_conref"><span class="mpre">Skip</span></span></a><span class="mpre"> </span><a name="loc_176_36_176_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_36_176_38&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">    -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21&#39;)"><span class="hl_conref"><span class="mpre">Skip</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_57_20_57_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_57_20_57_22&#39;)"><span class="hl_conref"><span class="mpre">S2</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a href="#loc_173_18_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_18_173_19&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_53_21_53_24&#39;)"><span class="hl_infix"><span class="mpre">:*:</span></span></a><span class="mpre"> </span><a href="#loc_176_36_176_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_36_176_38&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">)
                              </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">       -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_169_1_169_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_13&#39;)"><span class="mpre">reverseScanr</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Like &#39;unfoldr&#39;, &#39;unfoldrN&#39; builds a stream from a seed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- value. However, the length of the result is limited by the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- first argument to &#39;unfoldrN&#39;. This function is more efficient than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;unfoldr&#39; when the length of the result is known.</span></span><span class="mpre">
</span><a href="#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_9&#39;)"><span class="mpre">unfoldrN</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_185_1_185_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_9&#39;)"><span class="hl_fundecl"><span class="mpre">unfoldrN</span></span></a><span class="mpre"> </span><a name="loc_185_10_185_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_10_185_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Common.html#loc_733_1_733_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Common.html#loc_733_1_733_10&#39;)"><span class="hl_varref"><span class="mpre">S.unfoldrNI</span></span></a><span class="mpre"> </span><a href="#loc_185_10_185_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_10_185_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_9&#39;)"><span class="mpre">unfoldrN</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ** Indexing streams</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ stream index (subscript) operator, starting from 0.</span></span><span class="mpre">
</span><a href="#loc_193_1_193_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_6&#39;)"><span class="mpre">index</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_193_1_193_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_6&#39;)"><span class="hl_vardecl"><span class="mpre">index</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Common.html#loc_860_1_860_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Common.html#loc_860_1_860_7&#39;)"><span class="hl_varref"><span class="mpre">S.indexI</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_193_1_193_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_6&#39;)"><span class="mpre">index</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The &#39;findIndex&#39; function takes a predicate and a stream and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returns the index of the first element in the stream</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- satisfying the predicate.</span></span><span class="mpre">
</span><a href="#loc_200_1_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_10&#39;)"><span class="mpre">findIndex</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_200_1_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_10&#39;)"><span class="hl_vardecl"><span class="mpre">findIndex</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Common.html#loc_893_1_893_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Common.html#loc_893_1_893_11&#39;)"><span class="hl_varref"><span class="mpre">S.findIndexI</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_200_1_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_10&#39;)"><span class="mpre">findIndex</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ The &#39;count&#39; function returns the number of times the query</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- element appears in the given stream.</span></span><span class="mpre">
</span><a href="#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="mpre">countChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="hl_vardecl"><span class="mpre">countChar</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Common.html#loc_934_1_934_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Common.html#loc_934_1_934_11&#39;)"><span class="hl_varref"><span class="mpre">S.countCharI</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="mpre">countChar</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Like a combination of &#39;map&#39; and &#39;foldl&#39;&#39;. Applies a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function to each element of a &#39;Text&#39;, passing an accumulating</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parameter from left to right, and returns a final &#39;Text&#39;.</span></span><span class="mpre">
</span><a href="#loc_213_1_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_10&#39;)"><span class="mpre">mapAccumL</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)
</span><a name="loc_213_1_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_10&#39;)"><span class="hl_fundecl"><span class="mpre">mapAccumL</span></span></a><span class="mpre"> </span><a name="loc_213_11_213_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_213_13_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_13_213_15&#39;)"><span class="hl_vardecl"><span class="mpre">z0</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a name="loc_213_24_213_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_24_213_29&#39;)"><span class="hl_vardecl"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a name="loc_213_30_213_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_30_213_32&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_213_33_213_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_33_213_36&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = (</span><a href="#loc_215_10_215_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_12&#39;)"><span class="hl_varref"><span class="mpre">nz</span></span></a><span class="mpre">, </span><a href="Data.Text.Internal.html#loc_78_1_78_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_78_1_78_5&#39;)"><span class="hl_varref"><span class="mpre">I.text</span></span></a><span class="mpre"> </span><a href="#loc_215_6_215_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_6_215_8&#39;)"><span class="hl_varref"><span class="mpre">na</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_215_13_215_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_13_215_15&#39;)"><span class="hl_varref"><span class="mpre">nl</span></span></a><span class="mpre">)
  where
    (</span><a name="loc_215_6_215_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_6_215_8&#39;)"><span class="hl_vardecl"><span class="mpre">na</span></span></a><span class="mpre">,(</span><a name="loc_215_10_215_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_12&#39;)"><span class="hl_vardecl"><span class="mpre">nz</span></span></a><span class="mpre">,</span><a name="loc_215_13_215_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_13_215_15&#39;)"><span class="hl_vardecl"><span class="mpre">nl</span></span></a><span class="mpre">)) = </span><a href="Data.Text.Array.html#loc_182_1_182_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_182_1_182_5&#39;)"><span class="hl_varref"><span class="mpre">A.run2</span></span></a><span class="mpre"> (</span><a href="Data.Text.Array.html#loc_115_1_115_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_115_1_115_4&#39;)"><span class="hl_varref"><span class="mpre">A.new</span></span></a><span class="mpre"> </span><a href="#loc_216_13_216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_13_216_17&#39;)"><span class="hl_varref"><span class="mpre">mlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_215_44_215_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_44_215_47&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_217_5_217_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_10&#39;)"><span class="hl_varref"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a href="#loc_215_44_215_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_44_215_47&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_216_13_216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_13_216_17&#39;)"><span class="hl_varref"><span class="mpre">mlen</span></span></a><span class="mpre"> </span><a href="#loc_213_13_213_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_13_213_15&#39;)"><span class="hl_varref"><span class="mpre">z0</span></span></a><span class="mpre"> </span><a href="#loc_213_30_213_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_30_213_32&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
      where </span><a name="loc_216_13_216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_13_216_17&#39;)"><span class="hl_vardecl"><span class="mpre">mlen</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Size.html#loc_138_1_138_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_138_1_138_11&#39;)"><span class="hl_varref"><span class="mpre">upperBound</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_213_33_213_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_33_213_36&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
    </span><a name="loc_217_5_217_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_10&#39;)"><span class="hl_fundecl"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a name="loc_217_11_217_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_11_217_14&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_217_15_217_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_15_217_18&#39;)"><span class="hl_vardecl"><span class="mpre">top</span></span></a><span class="mpre"> = </span><a href="#loc_219_9_219_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
      where
        </span><a name="loc_219_9_219_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_219_15_219_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_15_219_16&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> !</span><a name="loc_219_18_219_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_18_219_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> !</span><a name="loc_219_21_219_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_21_219_22&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> =
            case </span><a href="#loc_213_24_213_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_24_213_29&#39;)"><span class="hl_varref"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a href="#loc_219_18_219_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_18_219_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
              </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">          -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_217_11_217_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_11_217_14&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre">, (</span><a href="#loc_219_15_219_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_15_219_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">,</span><a href="#loc_219_21_219_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_21_219_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">))
              </span><a href="Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21&#39;)"><span class="hl_conref"><span class="mpre">Skip</span></span></a><span class="mpre"> </span><a name="loc_222_20_222_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_20_222_22&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">       -&gt; </span><a href="#loc_219_9_219_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_219_15_219_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_15_219_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_222_20_222_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_20_222_22&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_219_21_219_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_21_219_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
              </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a name="loc_223_21_223_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_21_223_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_223_23_223_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_23_223_25&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">
                | </span><a href="#loc_232_23_232_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_23_232_24&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_217_15_217_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_15_217_18&#39;)"><span class="hl_varref"><span class="mpre">top</span></span></a><span class="mpre">  -&gt; </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusion.hs&quot;, srcSpanStartLine = 224, srcSpanStartColumn = 32, srcSpanEndLine = 229, srcSpanEndColumn = 0}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusion.hs&quot;, srcSpanStartLine = 224, srcSpanStartColumn = 40, srcSpanEndLine = 224, srcSpanEndColumn = 58},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Fusio"><span class="mpre">{-# SCC &quot;mapAccumL/resize&quot; #-} do
                               let top&#39; = (top + 1) `shiftL` 1
                               arr&#39; &lt;- A.new top&#39;
                               A.copyM arr&#39; 0 arr 0 top
                               outer arr&#39; top&#39; z s i</span></span><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; do </span><a name="loc_229_35_229_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_35_229_36&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Internal.Unsafe.Char.html#loc_58_1_58_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_58_1_58_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeWrite</span></span></a><span class="mpre"> </span><a href="#loc_217_11_217_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_11_217_14&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_219_21_219_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_21_219_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_231_27_231_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_27_231_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                                  </span><a href="#loc_219_9_219_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_231_24_231_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_24_231_26&#39;)"><span class="hl_varref"><span class="mpre">z&#39;</span></span></a><span class="mpre"> </span><a href="#loc_223_23_223_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_23_223_25&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_219_21_219_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_21_219_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_229_35_229_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_35_229_36&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
                where (</span><a name="loc_231_24_231_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_24_231_26&#39;)"><span class="hl_vardecl"><span class="mpre">z&#39;</span></span></a><span class="mpre">,</span><a name="loc_231_27_231_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_27_231_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) = </span><a href="#loc_213_11_213_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_219_15_219_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_15_219_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_223_21_223_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_21_223_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                      </span><a name="loc_232_23_232_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_23_232_24&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> | </span><a href="Data.Text.Internal.Unsafe.Char.html#loc_40_1_40_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_40_1_40_4&#39;)"><span class="hl_varref"><span class="mpre">ord</span></span></a><span class="mpre"> </span><a href="#loc_231_27_231_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_27_231_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre"> = </span><a href="#loc_219_21_219_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_21_219_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = </span><a href="#loc_219_21_219_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_21_219_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_213_1_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_10&#39;)"><span class="mpre">mapAccumL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>