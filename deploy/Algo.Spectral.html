<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Algo.Spectral ( spectral ) where

import Data.Vector.Unboxed as V

import Data.Bits

</span><a href="#loc_9_1_9_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_1_9_9&#39;)"><span class="mpre">spectral</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Vector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_9_1_9_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_1_9_9&#39;)"><span class="mpre">spectral</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_9_1_9_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_1_9_9&#39;)"><span class="hl_fundecl"><span class="mpre">spectral</span></span></a><span class="mpre"> </span><a name="loc_9_10_9_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_10_9_12&#39;)"><span class="hl_vardecl"><span class="mpre">us</span></span></a><span class="mpre"> = </span><a href="#loc_9_10_9_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_10_9_12&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_781_1_781_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_781_1_781_4&#39;)"><span class="hl_varref"><span class="mpre">V.map</span></span></a><span class="mpre"> </span><a href="#loc_13_7_13_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_7_13_10&#39;)"><span class="hl_varref"><span class="mpre">row</span></span></a><span class="mpre"> (</span><a href="Data.Vector.Unboxed.html#loc_528_1_528_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_528_1_528_11&#39;)"><span class="hl_varref"><span class="mpre">V.enumFromTo</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="#loc_11_7_11_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_7_11_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))
    where
      </span><a name="loc_11_7_11_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_7_11_8&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Data.Vector.Unboxed.html#loc_255_1_255_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_255_1_255_7&#39;)"><span class="hl_varref"><span class="mpre">V.length</span></span></a><span class="mpre"> </span><a href="#loc_9_10_9_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_10_9_12&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">

      </span><a name="loc_13_7_13_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_7_13_10&#39;)"><span class="hl_fundecl"><span class="mpre">row</span></span></a><span class="mpre"> </span><a name="loc_13_11_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_11_13_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="#loc_13_11_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_11_13_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="Data.Vector.Unboxed.html#loc_1105_1_1105_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_1105_1_1105_4&#39;)"><span class="hl_varref"><span class="mpre">V.sum</span></span></a><span class="mpre"> (</span><a href="Data.Vector.Unboxed.html#loc_786_1_786_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Unboxed.html#loc_786_1_786_5&#39;)"><span class="hl_varref"><span class="mpre">V.imap</span></span></a><span class="mpre"> (\</span><a name="loc_13_39_13_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_39_13_40&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> </span><a name="loc_13_41_13_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_41_13_42&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_15_7_15_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_13&#39;)"><span class="hl_varref"><span class="mpre">eval_A</span></span></a><span class="mpre"> </span><a href="#loc_13_11_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_11_13_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_13_39_13_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_39_13_40&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_13_41_13_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_41_13_42&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) </span><a href="#loc_9_10_9_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_10_9_12&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">)

      </span><a name="loc_15_7_15_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_7_15_13&#39;)"><span class="hl_fundecl"><span class="mpre">eval_A</span></span></a><span class="mpre"> </span><a name="loc_15_14_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_14_15_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_15_16_15_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_16_15_17&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
        where
          </span><a name="loc_17_11_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_11_17_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_18_11_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_11_18_12&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_15_14_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_14_15_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          </span><a name="loc_18_11_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_11_18_12&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> = </span><a href="#loc_19_11_19_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_11_19_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
          </span><a name="loc_19_11_19_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_11_19_12&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_20_11_20_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_11_20_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_20_11_20_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_11_20_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          </span><a name="loc_20_11_20_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_11_20_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_15_14_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_14_15_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_15_16_15_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_16_15_17&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">

</span></div></body></html>